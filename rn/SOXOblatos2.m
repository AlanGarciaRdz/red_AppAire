function [Y,Xf,Af] = SOXOblatos2(X,~,~)
%SOXOBLATOS2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:39.
% 
% [Y] = SOXOblatos2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.5406482345315582;1.8652489020214464;2.174972490899584;2.8593122945079652;-0.94246715459420782;0.4292544915639061;-2.6731506890940744;-1.3683068511684129;1.0401219650463016;-1.6925738499618794;1.0953386313341289;-1.7832613242888962;-0.50948138827008138;-1.459427126245963;-2.9182299978537127];
IW1_1 = [0.432328816413171 0.44432622759042417 2.1898962055216731 2.3652384429781037 -3.9114194647000837 0.80966776596542012 -0.906343536799608 1.6443740761652519 -1.0340389625325697 -1.8847448566988203 2.1425487424346557;-0.32063311989917032 -0.1041421118911513 -0.28320195647554519 -0.9833538045516288 0.022865130007011743 -2.2380286964095357 -0.24400805309231416 0.44059880800535478 -1.0579511165928899 0.094157238027614179 1.8104040443778375;0.16370896728322962 -0.047378653499705485 -1.0211465868689982 -0.34927664617344417 -0.19705879441221283 -0.54687329617761093 1.4509602650671509 -0.67108052190553957 0.042134255624204045 0.14224347643162016 0.97181737193773532;-0.86809925637025986 -0.07712789036947143 -1.4860543858497481 -0.63285564288553653 3.0832053074628449 -0.57973382041315968 1.1848324379177375 -0.63235431417667975 0.5318921333360298 0.1113726942119352 -0.12869112068661298;1.4851326070554569 -0.29032679425142394 -0.31344262940752954 0.030366293299092982 0.459942554149395 -0.99989523614343701 0.13724080623322291 -0.90693897982660787 0.34605891647636872 0.17345539975131125 0.3157050540855017;0.31364809719600789 -0.29735541905318114 0.12882461185730765 -0.46719283630610731 0.17820591182369774 -1.087841575242015 -0.20652959879200514 -1.8795641435883026 1.3441555369583069 -0.070348622123035026 -0.82850606924860803;1.5614637582266002 2.388874403739683 -0.39174371552110376 -3.6274852908257875 -0.56448445682829429 1.0920754506803501 0.86293227894444891 -0.47765010859754364 1.3988369076389371 0.2532221278720394 -1.5227124988474907;-1.662445260441004 1.9660223302754536 0.38139148744569629 0.82116757690133457 -0.99525700276313911 0.7283959920284826 1.8093109052884948 1.535753488915385 -0.94840884053841068 0.51396176793437831 -2.8274441005136923;-1.9498606447991123 1.1974948950164375 0.72227408615493471 0.7325763527482192 -0.14319004891349379 0.19292267993835083 0.15111719077039343 -2.2690797382708188 1.0749957847438905 0.31985051037209156 0.52879760808666054;-1.5681313679438804 0.052124475065661625 -0.75222195722965712 -1.5602375630395289 -1.0168895141379859 0.2725317815379702 0.37993626825628973 0.60221362546600099 0.1594791583880027 0.78055754097183472 1.6887443370964583;0.60757548596065991 -0.08055193669718802 0.2980222360926375 0.23053273001395175 0.13766768076461577 -0.25960035257659675 0.30631295734924824 0.030338057901378473 1.8235864579600005 0.07502324081096387 -0.41321531825127816;-1.093884234330126 0.22562245750065979 -1.3139925101518288 2.0073603985681263 -3.2114692823059667 1.3116440408109651 -0.19726744806957255 -1.3466680632693997 0.27883227921867643 1.2230135361449779 3.0778985891960979;-2.3303117065054022 2.5825163513392493 1.0674594199721938 0.72382486214111108 -0.91162271570689479 1.0226791310166785 0.94546833462226176 1.1784694585254403 -0.70681823251858655 -0.27524097570551898 -1.5120249498943894;0.46669437069114927 0.2323878502912799 0.20131232813077071 -1.020424996640791 -0.48287760115651945 -2.4915855626499459 0.48355925642842129 0.72320135176277811 -0.63079945223281741 0.48901685962989772 1.0904496750872099;0.4568552706235407 -0.012990396058550763 0.98062172434970296 -0.53454440219055011 0.013685340156985547 -2.011826156020549 -0.22704184380074982 -2.1827709766964691 0.40772692587977383 0.59033781619619186 0.53801084569062219];

% Layer 2
b2 = [1.8906963639118799;-2.9390686626075491;-1.5000280715912242;2.0355735875481438;1.1575353304900042;1.3665616064828821;-0.24889737291190431;-0.11032104734877475;0.67148864220323423;-0.16121628665512894;0.70666626867853166;-1.2379967305502382;0.3931685184145256;-1.5033089993965401;-2.3482220137652576];
LW2_1 = [0.15610409550572191 -0.25059443998305064 0.19479312407448701 -0.0079494373327612666 -0.59449579528476226 -0.28711896675978693 -0.085283805056379364 -0.42287655640194333 1.0101710950837663 0.52855729446269606 -1.1156255714698176 -0.4700929672016726 0.31624987696388712 -1.7287723094066698 0.9272095812529666;2.5584126704587655 2.3573484131178213 -1.2102982513168303 2.7699697648569863 -1.2566597706897185 1.4210095971191767 1.6130960664455782 -0.20260700391682213 -3.170007652848462 0.33738421345667108 -1.1312343116863848 3.8870394298233544 -0.14502438318347011 -0.34248325804279522 2.5815283253683163;0.32969939973378976 0.32181832444994357 -0.45653283192241151 0.68463175093571915 0.74088261961142665 0.72587609517064788 0.11318273152632684 0.044106903182460036 -0.048655437888878814 -0.027070494589424968 -0.5805118219913048 -0.10019784806704783 0.30045358599803434 -0.059609441787426769 0.51791038386896215;-3.6915950670725528 0.92247010224939396 1.2760036152693834 -0.1304400135775477 -0.49116780999808568 0.48625869164811281 -0.74223015895664179 3.591982184114531 -0.22673718030080231 0.054304510732118172 0.13630365494734314 -0.68195361420939049 -3.4324378988829078 1.774807871312738 -1.2601405801463879;-1.6294492596519354 0.04630253357236265 0.078704393442689147 0.15341481364371817 -0.011667316909991628 -0.37517083320441258 -0.76818678831116838 -0.79924766169686856 -0.50380936831670875 -1.2390899951456342 -0.13315274699371044 -0.098440725778412785 0.56363233291054271 1.059320501261996 -0.21273251881500804;-0.31913266624604064 -0.37887813918991187 0.36989806918721291 -0.2825504797932431 0.44597734329126421 0.29355091441891218 0.36768603240358144 -0.32488432583167687 -0.2055377086928869 -0.62094684979221215 -0.41638841854867137 0.47546406601132074 0.30579271863959512 -0.20012702672720445 -0.23975915579996071;0.064758090663426485 0.18590420585689857 0.66718615410453286 -1.0388216386910245 0.2683383286006305 1.0604358473608138 0.30093013700526466 -0.69918949201993885 -0.045995799142890467 -0.53912554093191845 -0.47173088508715427 0.98832220876730659 0.40392496652699422 -0.62805920037186636 0.8776461387627511;0.038035137600008102 -0.005983511911134623 -0.37255675911641817 -0.077450364811442809 -0.32759357968103009 -0.070534680421448545 -0.81386367514977576 0.18610454301583843 0.90454569454643385 1.1791805683196777 0.38063169867273428 0.35707234736205168 -0.08185579816334311 0.01442326891972906 0.81794788922787587;-3.1260248748152333 -0.85320993289462188 0.20550604335627881 -0.023556450845672622 -0.60856490692754595 1.9288915881890529 -0.61843563707543703 1.1005381169847481 1.6368155264108437 -2.7571946857778022 -1.6395547745071106 -3.4719936310980772 0.75360111146869435 -0.4595504672536207 -1.2942520657788701;-0.48989568701324054 0.70987315781997862 -0.17670617666966204 -0.04808109525749249 -0.50106194553841055 0.15051693116456388 -0.083578410427654834 0.64563538861335179 0.29486180048395955 -0.73461853932287535 0.11539608721678615 0.0047739109267430496 -0.38229685683709574 -0.035283679382184102 -0.86962172049739672;-1.5216066516343336 -0.060863394114743438 0.098499559783602447 2.1593218076703953 -0.77578182638733661 -0.46723159483992477 -1.0074263505830483 -0.080921847194899879 0.30298821464348435 -0.35279160752530186 -0.54425871892833855 -1.1234431319270317 0.12578957145136255 0.084985114784133453 0.52900820654598002;-0.17651404433775728 0.42275354477829652 -0.39352694727783694 0.19469977812842326 0.026833052969725671 0.053865800456149575 -0.55546057429553264 -0.47941489422210037 -0.5057390230036295 0.022227418036777448 0.35792256753818941 0.28071855901916243 -1.0036386138452431 0.26426874353898605 0.47716735821994344;0.2708826719260925 -0.4081692043040247 0.55628343237559286 0.82623184524626903 -0.49830165995883335 -0.9278853841998157 -0.13337530263520178 0.48248444383460315 -0.0056433865100622323 0.3049208168212974 0.26424456788003486 -1.0936224972178885 -0.19666851551891368 0.27129007666780602 0.78858495116406746;1.1905141248916133 0.096673164735610856 1.3501168212446379 -2.4956111023777487 -0.40529688327203722 0.1604249628775333 0.8536971939962914 0.8582919203595113 0.56525877904896082 0.6393250173733489 0.98561747237912634 0.38796231238399703 -1.0087683474642168 -0.083845811996210898 0.49101613622679863;0.019150760619242604 -0.2045524328407024 -0.65506157940505205 1.315719898972755 0.70140773935043521 0.91234735304013515 0.71317171514841793 0.40254761000744294 -0.083260432049503785 1.4013740760620901 -0.40391691685620812 -0.042258204110753983 -0.04391191023778037 -1.3202170494001499 0.69384421171918953];

% Layer 3
b3 = 0.69341870994537913;
LW3_2 = [-0.060265733172258099 4.0321521879799436 -0.16969230854301959 -1.3749685756009069 0.60090819019491037 0.19561051858220591 0.20354830061924445 0.093467857324654069 3.2421023459891436 0.35545305257326387 0.8322360039956882 0.037792386549710281 0.23311489981978251 0.91981110656773457 0.52959596964192601];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
