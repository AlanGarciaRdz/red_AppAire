function [Y,Xf,Af] = O3oblatos2(X,~,~)
%O3OBLATOS2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:44.
% 
% [Y] = O3oblatos2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.100381449508131;117.647058823529;0.0560224089635854;13.1578947368421];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [2.1782560362406009;1.3567211267694079;-1.8652810393073211;1.7070187111924426;0.45744857651888327;0.60991339793873467;-0.45550285192227719;0.06284819475608476;0.44707819655411629;-0.52338812681174185;0.55596051640714095;-1.314728518323562;1.6155021825974023;-0.14020117436400165;2.450427274941108];
  IW1_1 = [0.18611033266159374 -0.67585334271937481 1.1591650791472088 -0.1040677726041738 0.022830244095907115 1.3354106404994697;0.10539453443436056 -1.4961860343226392 -0.37361569980486631 1.2886022836010955 -0.37049246215504905 -1.9800588915059423;-0.43659995232200499 -2.8127844947225595 0.87813831373150841 0.045411853000803373 0.31139781777589121 2.4150962756712979;-1.2489304061523896 0.70907768212663913 -0.13953719529281769 0.31211901545659498 1.3341812913624367 1.3366945454571384;-0.13705808614042617 -1.0574994777044853 -0.35665614553259867 -0.51575351554881887 1.7826583697970471 -1.0744530178498446;-0.80089542803489988 -1.2290093623685008 0.59387478778036851 1.0650614178587137 -0.055222187258804921 0.1028740762074556;0.53200903033672464 -0.88263933787630988 0.78335908260437026 -0.42403532527782406 1.7569270381105471 0.63669275775051681;0.32573997127464982 -0.077738471568757531 -1.0588842664960305 0.85147088320203868 -1.759908690078624 1.0186419745493123;-3.6165993635755451 -0.27245761549313569 -1.087754093722461 -0.42992590588098173 0.16765957866294873 -0.34487900029401281;-1.6103407422891827 0.69449124495570069 -1.3254652753149558 0.50670039748781226 1.1890408033759272 1.1611600041793166;0.10982517784083354 -0.86737674397313369 0.39683765214635847 0.95241543249285932 -0.54753868359556612 0.31949784527400332;-1.3577301128449524 0.463626231015487 0.23496334371009608 -1.4151908991009792 -0.12348064097284529 0.91196440001780954;0.65295543411784795 -0.12113672349018381 0.70847284613710726 -1.0374341160385987 -0.61363573818551009 -1.3537309108592632;4.4419026471640546 -0.049261544453301817 -0.55280275973690107 -0.17434921121830474 -0.20590351665614812 -0.37591863099106548;0.72445740219838139 -1.2777902351218626 -0.84677980563510702 -0.82200619283636178 1.1601656957030755 0.39407055739625496];
  
  % Layer 2
  b2 = [-1.9726284083296872;-1.4566652934544884;1.2943162893588118;1.2628237802100339;-0.44677449528097485;0.9192027160119951;-0.54765350651825784;0.14386993326411107;-0.13673741051702135;-0.37286877939830976;-0.6383297220617471;0.88331708933114006;0.93549854788354725;-1.5001274376021236;-1.6757269580919536];
  LW2_1 = [-0.08251206880044995 -0.76941301297872711 -0.42530175734304188 0.22751838956515824 0.42610752064618884 -0.34955906912511514 0.14398712579159575 0.15624805168004999 -0.55647826236748499 -0.66802384092628719 0.098795937177742738 -1.2655231863283067 -1.1646219298363305 1.0076775204025836 0.20546628703772113;-0.49942472689674894 -0.31267963484306649 0.58789102967141471 -1.0736578186262331 0.6277135623516239 0.26669320368426752 0.75694743567311851 0.12429990371379246 -0.52689560480537756 -0.73006469643790517 -0.61967855651217263 -0.15625319187593745 0.40943247704187313 -0.29717920567122225 -0.43108707467392404;-0.21159388882236929 -0.38168919537646956 -0.01017445911635172 0.72832894146865312 -0.32531150398562148 -0.14324279867897327 -0.63385754815263939 0.2725678389837623 0.35042219661833018 0.71836211843023678 -0.82502533834103586 -0.6375420744565955 0.021706411489107937 1.2010207604590197 -0.48988042693138195;0.1024902381965969 -0.8677728296831333 -1.0560417685232308 -0.01302386600722286 0.26630022493555416 0.2031622602465501 -0.36878699222260125 -0.09275815622566258 -0.3564188063472255 1.6698133109546422 -0.07024155604163404 0.62825248753832663 -0.045601536719307563 -0.6412599363277689 1.1671122573792159;0.32115618976834887 0.36726954419772562 0.48151073244219439 -0.50899643127958749 -0.20611334390257255 0.26071431201601669 0.21658856394551926 0.39048183862387514 0.51349767005151248 -0.85477898318446843 -0.37028995001232651 -0.36628764056627022 0.55589049650732159 -1.0432015792720548 0.55545133776819922;-1.6758795334597654 1.4071216945774978 -0.78637724553184052 0.94343339567115259 -0.55680397149210525 1.5286132567860125 0.41011150199154239 0.5700730568128678 -0.35697576658053271 1.1948477855498885 0.84023072406806054 -1.1921605198798104 0.42018827872238329 0.53773050488763774 1.0201578872956145;0.39762832449522928 -0.70762848663011246 0.5245711738219021 0.37023540153071421 -0.32495077467042394 -0.33118867592941564 0.60109637763244117 0.72652684154367952 -0.43652487448788002 0.28138699586626842 0.23464663717662301 0.079319629466165442 0.17456082741999163 -0.48786140452361698 -0.85210709188137856;0.43050566503110682 -0.69713375187923998 0.42387275544915831 0.72732321348399387 -0.57165378507430953 -0.35363282778708499 0.0013001995007834496 0.11496213661386273 -0.26973318324515871 -0.46224065539453379 0.38089453510420807 -0.67932950796628266 1.0977545391765493 -1.2325973299625583 -0.031851433202363166;-1.0005633224792718 -0.92921762867625923 -1.1251455284032956 0.34747855397704341 -0.16027925878099469 -0.23091147892867467 0.38659565666893347 0.21737323069199455 -0.35748666749754221 0.098267309747978177 -0.186010386990585 -0.46510315946481473 0.40049032538098778 -0.78452367747006801 0.18694253478962491;-0.18590860761013969 -1.4483305158720918 0.67978614059412357 0.37081436464362638 -0.15374042101372806 0.16496247357049387 -0.37545768279960268 0.18603101852213821 1.6078552095357603 -0.42665498648258321 0.16653148064279133 -0.63813556320747888 0.71273778611041183 -1.1516544911412616 -0.9640198830326735;-0.4625122777204157 0.22192051428614581 0.4746387418059233 0.13528401595832551 -0.28417841006796768 0.35456376277607876 -0.39240444406648328 0.17749956786943002 0.46092272362051417 -0.22649113431506221 -0.21800295869886341 -0.25535586538130345 -0.6964192625115635 -0.58141212291339339 0.26240922568565084;0.49538171146109611 0.93310750284404431 -0.65194163183828713 0.28145297707639327 0.25541687543596708 0.074214334461900122 -0.1471230578086575 -0.037338616431569251 -0.8061350040473626 -0.8701464520336456 0.40102921389089924 -0.51718448963729569 -0.48268057808687165 -0.66790221806656858 0.54364024985322446;0.27504888234370223 -0.80861812802853361 -2.124166146221242 -0.10143219105916058 0.49273011402643774 0.6258885039420935 -0.58985268977760363 0.2124041296784806 0.1972769506768528 1.713276341856709 -0.59769608898223814 0.2706038762460134 -0.17504066651470943 -0.47745153279089358 0.11940304873569711;-0.61190410775288373 -0.14908879150523022 -1.4028005290582219 -0.5310034565864582 0.90077917977419986 -0.20633168827790377 0.48432709192512197 0.22973896360472409 -0.5090513965530844 -0.19076667318739265 -0.23350965651989292 0.1905182059946714 -0.64145317089849729 0.029822605268486665 0.20780962292999897;-1.0848126853000328 0.64665147326013916 -0.52361345091712819 -1.2382165408023378 0.24344561504513307 -0.51510990720087557 0.56359590816762239 -0.24138945558308267 0.39579229370969599 0.46838066037405229 0.60820947880969745 0.088945426615970491 -0.079065923713984257 -0.15660295609036984 0.34961965311789689];
  
  % Layer 3
  b3 = -0.8726699664858919;
  LW3_2 = [-2.0012008956601828 1.3075486417430651 0.30429118723021814 -1.2268335726331006 -0.95399679159547124 1.5029696616599144 -0.06327991631832483 1.5896316529485781 -0.75888735515367733 -1.3876761512008258 1.5566449151752164 -0.74659640539775374 0.97258489549636873 1.9484123103315978 -1.1667399603023885];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 13.1578947368421;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
