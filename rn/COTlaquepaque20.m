function [Y,Xf,Af] = COTlaquepaque20(X,~,~)
%COTLAQUEPAQUE20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:16.
% 
% [Y] = COTlaquepaque20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;14.7058823529412;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.448430493273543];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.6106568051652519;0.63915748305247966;-1.8925356319911624;2.6321938069913906;2.7605551551084262;0.16235443468760222;-0.20069135975335661;1.1287912171907473;0.53017611883408777;-0.16987302293394987;-0.71958366101075222;-3.481890644438971;-2.4336348969552457];
IW1_1 = [1.7547739144711243 -0.3734722002103506 -0.30658652028125133 -0.64742049418865122 -0.25822256643914526 0.81542296596271135 -1.7285072239170254 0.23051352138831918 0.011590677813135282 0.32726785961553778;-0.091944818419604529 -3.1670699515471599 -0.15953762380096165 -0.36060248722430166 0.11286982234650086 0.63928711199976751 -0.45576396386590845 -0.20964654498936153 -0.12718864349576198 0.1695453539943573;0.18593769968033139 -0.081360767236367454 -0.51810658359272233 0.2500382038241844 -0.21339645531806037 -0.30968831939615854 -2.3552000323086055 0.21147097419674366 0.095857399008025299 0.19175925778575126;-1.5965940032227681 0.12879223430353004 0.041776643408021681 -0.16188398888372954 0.58951073770159801 -0.85543516641879802 -0.73665665698177707 0.19003581234033839 0.91446577684399921 2.1113178347261989;-3.9072509867422669 1.6030260178273252 3.5615408573953395 0.75362906292885223 -0.36455381126077946 1.2679268849734691 3.2501912041845618 -0.37540134589858504 1.0198087068067394 2.1414941480043033;0.024351926638894666 -1.8997764608132384 0.0066671417377418968 -0.10477599331814688 -1.6226929041357769 0.35202230169611137 0.29277743472719142 0.46342829096019295 0.35163165272695968 1.4280304651330189;-1.0147542301949335 -0.29684485048571518 0.1360962983320784 0.018928258972598762 0.20868968284141282 -1.099553443813776 -0.17763671522679689 0.020380472580096953 0.16089789617337794 0.038898264179733459;-0.22514635823280996 -0.52682074295350256 0.42151903380688172 -0.22465053017759073 0.13188652303233067 -0.22579946241133758 -1.4597183161027329 -0.082697893450522253 0.10315661078007517 0.97666567625153544;-0.75477161076987453 0.18540682508856604 0.60785609587965439 -0.17880354170963941 -0.0073228812470623739 0.1169106280091627 -0.72893636745356505 0.033122394251894179 0.088850638955928388 0.44809970365993557;0.22739486092049166 -0.68480047444028136 -0.58516539239183152 -0.098953201646472588 0.2083795718559498 -0.83163479464591528 1.0630013448248097 0.17364637418617634 0.076769610787266879 -0.50952522405132561;-0.67103239271605186 0.1346616144427463 -0.86741252294188154 0.30274761601934047 0.074415543126863035 -0.73996849412018062 1.1554401978477582 0.0008659316998656096 -0.19175190979973317 1.7859768369460121;-2.3630622287853802 -0.67440260509516037 0.090577022287057316 0.26552103184236187 -0.27818479386311062 -1.3916797759052837 0.41037845984727606 0.020195595158335106 0.113496306247251 -0.34425073475390877;1.1884729766604714 -1.6093757140464338 0.17863280297350728 -0.85320406556613915 0.8536725125411555 0.76302897470933828 0.23078865597428394 0.37912500946973826 0.06855036524737021 0.55727926300565722];

% Layer 2
b2 = [-2.6337979335396424;2.3220310786316292;1.250035940118682;-0.068413679520200388;1.4261898856219064;-0.99109220807230025;0.77758356436017462;-0.52243707258697147;-0.061995421327344202;-1.8883922878544803;-0.64320425486777788;-1.370701276375333;-2.169796171786349];
LW2_1 = [2.1505477946645364 -1.3841813589317968 -0.97667348414689448 0.39290227128218319 1.045021774387052 -1.1601252687385868 1.0911857513736418 0.11361064825675658 -0.71545944204239398 0.35627416093415148 0.20058314678426611 -1.9019380204019392 0.15971897025609263;-2.5182027205413262 -0.52234626504334636 -1.6271548824539843 2.0334769411721263 -0.20764847158408747 1.4349543519258861 -1.0997758977108223 -0.29741678584157866 -0.69802667202136992 -0.59524896851651898 1.3521864163099937 1.2410885218910479 -0.81089702457191226;-0.93189364235139105 -1.6953790445100698 0.33323739216301906 0.030641113875253121 0.046188033576921937 -0.42715579923717706 -1.1422635447085769 0.1951963500962611 1.2067881437486276 0.20532634289429386 -0.48996171381264547 0.075590521591279894 0.83837021013375113;-0.17179005622824828 0.51373129405064422 0.43318408844795553 -0.74884345300215016 0.5278325173450541 -0.5734694063807616 -1.4399653469680855 0.27476455660612431 0.50504294118598902 0.38283464542511081 -0.054385834531500005 -0.80995141797366177 0.9172925257893787;0.94126860095144682 0.025686908568398153 0.89594043588050176 -0.26490510130775241 0.55575025587784477 -0.72299767897099809 1.8231858948224964 -1.0319178833939728 -0.62122254980588676 0.16064995976116017 -0.15463878005550599 1.3065974998532974 0.42874714124992819;-1.3220828749824025 -0.69049324104336518 1.4168733940848337 -0.6524503714321227 0.26938713637441453 -0.18983344230232463 -0.19698414845475448 0.61365053536140401 -0.003800739015454066 -0.27482290169984558 -0.6699423897211505 1.4252499479680032 -0.79839191377494223;0.74489776371169603 1.0556818650894744 -0.96667706719903457 -1.1573624526390522 0.059586707862121502 0.39293130245273833 1.0822037660264361 0.60149249585775333 -1.4527827429861702 -0.49399558291683127 0.44730520542545316 0.67829466736734201 -0.18184426686414226;-0.51635019102679469 -2.1939541294163019 -0.92612689459779718 0.81084517971788128 -0.053521368988581189 -0.076391728701831543 0.15461547751193322 -1.8024081465829618 1.3046509583186094 1.1832329481227657 0.15157679949389058 -1.7533718085712531 -0.4218967394112188;1.0823260819807339 0.55083135861401744 1.5298900052382063 -1.9464828477423144 -3.0750663622690286 0.019832537250501443 2.1207442808842618 -1.9080348424944296 -1.1072326213611574 -1.684577965597243 -0.98443955394936089 0.26451043410004399 0.37473060989359941;-0.39577134898739519 0.071385514852400578 -2.7631435069334684 1.4116326315190415 0.74094452767662089 0.81102128185212363 -5.3639056164884806 2.2879128007432592 2.8454045459660993 4.0730901564157351 3.0775268299604699 -2.2284050050545332 -0.89713508428494393;-0.57971933602671555 0.42097582272480838 1.5620252919057629 0.75923668252529164 0.19839184860671061 -0.3201838142611575 -0.94863612315735346 -1.5620444423812185 0.16390440391729483 1.1319866927451514 0.80067667200077197 -1.467881655797274 -1.0683285755822125;1.4211637822617673 -0.15984923057804662 -2.1447341698295528 1.3480337931184101 -0.71420978203685215 0.81027332406053099 -0.26509262776406844 -0.37472325562070746 -0.4948280686391775 0.49318223863054117 0.056417868586281075 -2.2801554335815233 -1.1912721743237309;-1.8580649801083964 -0.056719063329180357 -0.69271203923462876 0.78336219795536854 -0.45529369054386959 0.60020093473500757 -1.6020073181869279 1.011131967873468 0.19403694792083012 -0.55347954467643035 0.25378488355584194 -1.3274007794482574 -0.069896255733364734];

% Layer 3
b3 = -0.94353906636447871;
LW3_2 = [-0.3487101092401973 -1.0177608620185821 1.2245229026905478 -0.88959029675361012 1.4363412883299276 0.96988253398267665 0.96332784730027776 -0.66124469702150834 0.38977033972014286 0.87194688706196954 0.39603798706048016 0.89208925169673225 1.5523908304304042];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
