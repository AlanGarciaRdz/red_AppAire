function [Y,Xf,Af] = PM10Atemajac2(X,~,~)
%PM10ATEMAJAC2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:54.
% 
% [Y] = PM10Atemajac2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00968992248062015;166.666666666667;0.0561797752808989;0.00614628149969269];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.9722558301824495;-2.7310605531630894;-1.2861140080153179;1.4828506813359554;1.7487419115912455;0.70427707147704721;-0.42332724623381718;-2.2251253634010038;-1.7572634862890404;-1.5489554720905456;0.88605834286373153;-0.20717579239747402;-0.45900600654831925;-1.5020234944100228];
IW1_1 = [-0.039950122073559219 -2.5477016620534725 1.1743774255247241 0.30040911185781444 -1.4512217853053055 -0.20947663028054367;0.61996280842231921 -4.0793534471774722 0.14822132764797025 0.18885795554272392 0.2641077461287884 -0.51258434383904361;0.40355412971917148 -2.7595053395065223 -0.71890357393608872 0.024923923814714463 0.30109639855521447 -1.0043824287034551;-0.13706964459660442 -1.3740859415245297 0.072236409872895757 0.13248939642194618 -1.3964207817667644 0.30913405195302884;-1.3456671159764486 -1.7335794990075217 0.16843043091900173 -1.2568640073395634 1.162982349473225 0.017332132565572908;-0.23595989651126342 1.7076110148429611 0.62979104574862732 -0.13752900189553482 -0.53345016163664694 0.009430583138974942;2.4622580557042379 0.25989339804116302 -1.6421538499735175 0.3254773232548458 2.025996655460899 -0.096356471859830067;0.10593428082495604 0.69397086325955237 -2.5285229279434511 0.24172735096532486 -0.24891418773524515 -0.43733515095795522;-1.9709967699928796 -0.99473968696935533 2.1585444498773696 0.14981379281823839 1.8518784357048987 0.57789397345656068;-0.073916938580843791 -0.86800038009106595 -1.8436909134512438 -0.0065280972351835914 0.85553503742352888 -0.00088287019355447541;0.0050939091724530681 -1.786937742827567 0.15037848009881552 0.041679368929828667 1.1397106829246035 0.31556879943723781;-0.10165544953635092 0.091010801504453315 0.84546096691821482 -1.911004646544344 -2.3117678000421087 -1.7121722763307585;-0.37937888858987295 0.028219522596629406 0.61125296981569688 -0.88453181091987743 -1.2325114958008869 1.5993891226850965;-0.12300081682707628 -1.7451326139339454 2.1605256686272813 -1.5480550955147261 -2.866600475367949 -1.0632412501536901];

% Layer 2
b2 = [1.3618025676304015;-1.3677042963175099;-2.1359166429877394;0.94039311196055286;-0.072114582890436207;-0.97631072603752922;0.86850643759406276;1.2959498443791753;-0.45236639158009184;-1.5192087764961557;1.7716391506298295;1.2615021467549108;2.0669791150941541;0.42242151842165448];
LW2_1 = [-0.38028969199332452 0.015568831544595402 -0.63790405068261657 0.058915517008905016 1.3631812081060508 1.42300288419159 -1.0222996065836814 0.18044834683950414 -1.1284947081822707 1.1366600739207773 0.15969362257088626 0.097201305634426277 -0.45720842110404208 1.1003599281849303;-1.6263937884322945 0.41818803460214377 1.3869450580234859 1.1756920720244326 -1.3257673340629237 3.009169301155576 -0.031935990525701674 -0.044913788504178653 1.4552737077343278 0.48577399025816986 -1.5068119892274399 -0.40855223854462702 -0.20270454649836661 -2.5560504205265864;-0.044534405433426023 0.37816486516718806 -0.11051723172248944 -0.62129632529602996 0.70673884831698253 0.16267914138832118 -0.77642633717028964 -0.022286150070372227 -0.96479627380490984 -0.2456706682447124 -0.25174989463340602 -0.49640990353450898 0.64682413931486782 0.30081544703830421;0.37169270477328531 1.5017889201123718 -0.37556191766170699 1.0638511629582807 0.38554331629772942 4.3806886410141654 0.76902453733248843 1.8779680002967447 -1.3561918238966235 0.67647402934469691 -0.31345428860158542 -0.0033215692208900596 -0.01477633077442209 -0.54164374095435042;0.86686881345245304 0.46880088476587989 0.45335919693198756 -1.2215014988687967 1.5796331316069929 0.075266081563627851 -0.48557207976316613 0.7188891500397484 -0.64778413693208514 0.20436021987898675 1.049681009355365 -1.2801181066081371 0.93842273461348913 -1.0170587959261088;1.5396703839740671 -1.3125943130716313 -1.660644403562505 -0.39764361022400141 0.59248877228246011 -3.0244988404086701 -0.085247583340018598 -0.77808153674793901 -0.50451080995225184 2.1411161300632631 -0.26262129183836247 0.17209764217278634 0.026640920178828482 -0.23334704230884426;0.86498128680859465 0.82219848711392685 -1.4199145028882447 0.58511153948045191 -1.7121705102874931 0.52406357518830693 -0.91280678654191805 0.58268738003577136 0.29127904352162648 1.1063948716924301 2.447608015877226 0.35729280203535707 -0.46455432951211945 -0.48732413515814044;2.3650569978583706 -0.45032457255726188 -0.16832542057587196 -1.1619644453470201 0.7928094020285964 0.023923609710069099 0.53189882539250455 -0.59740381156527456 0.40070999162018323 -1.5686790862118369 -0.65616789885867444 0.69863509184428252 0.097904806420728713 -0.49220031584724511;0.14385072725483197 0.52332387526026969 0.33154363839087408 -0.77723178159911621 0.53355733131737304 0.17903851595736547 0.0020752630613947538 -0.55779759098453063 -1.5097967299283341 -0.72994958374553476 -0.049568913393191194 -0.10067070768101993 -0.013092053601869321 -0.07654913221377474;0.78796710130068326 -1.039181296638954 -0.19298672722644533 -1.1727141060583022 0.060044432262900724 1.3685936140360964 0.11328433161538017 -1.61691357031295 -1.0789345156082564 -1.4931753647322936 -0.056818851901988619 0.22593686839218866 -1.3816279539850951 1.4682361320923019;0.68513387066475884 0.66548906036692557 -0.54074995471165743 1.5386700012434753 -1.8038615601664389 1.0313455176604311 -0.3991500715894899 -0.45609619532336887 0.53175435904171253 0.39775466244670454 -0.63968256509732613 0.2083152658903315 -0.63492883210859608 0.18241351473368106;-0.55368611171165316 -1.0330753252795131 -0.8214478021007533 0.66958924935629549 1.1813279339235845 -0.96411533793252024 -2.3468617054200456 -0.02017731323052931 0.035787378847051146 1.5375175845619202 1.1212262306729273 -0.78700214771532406 0.72243768885359694 -0.64069211726957764;1.3022244818716093 -0.18298074192584138 -0.76610251773633486 -2.1664200812116139 1.7903736564779513 3.1460147586139415 0.55558745374575347 -0.22609137990368763 -0.85958518233763159 0.33859289399284825 -2.3411694688090186 -0.031024933297965952 -0.59901970629354295 -0.16524331867599923;1.6874976511631876 0.74512769116848865 0.4250833569735275 -0.67102824986048226 -0.6694963630231664 0.82635572718443173 0.68420004728903216 1.2600487781213949 -1.2201123982316453 -0.49294884511484094 0.73155276935017655 0.40513047597899821 0.087753009486935041 -0.92921470732637967];

% Layer 3
b3 = -1.2291256004014885;
LW3_2 = [-0.34390425197134106 -0.26396774140185891 -0.43448817542798401 -0.24162104146711 0.12225514655364171 -0.4356406006590422 0.26890438428571695 0.2249515658950795 0.63435071236513518 -0.067776305065822079 0.11345100106888789 -0.10112285374949843 0.33705594941631556 -0.46148508025429841];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00968992248062015;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
