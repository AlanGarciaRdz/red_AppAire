function [Y,Xf,Af] = SOXAguilas9(X,~,~)
%SOXAGUILAS9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:19.
% 
% [Y] = SOXAguilas9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.1365836380229561;-1.7274811128963634;1.6398627560282446;2.0902340640765349;0.12070358223056601;-0.29333069818463936;-1.4317378359607704;0.80984283485700514;-0.82374304132110798;0.58045082870942288;0.89241299610721503;-1.8964218038637135];
IW1_1 = [0.31220150594698071 -0.017620866391524811 -0.44972364050488578 -0.27489078057328198 0.077970754366218156 0.74771655856459973 1.0107716848509773 -1.242472005150971 1.3756258209264631 0.27862523550547669 0.080562949358089969 2.1498361984453935 -1.8623019702546255;-0.031236890719305396 -1.2052603565790585 0.32113173739404249 -0.2992870870634472 0.083848634667009161 -0.11386666800329873 0.59095962790780387 -1.2839100353110842 -0.15761424900674681 -0.29137987415104905 0.36250610399642796 0.75476197590536021 -0.82062434955320074;-3.1650376945285137 -0.58276358110319704 0.54178755108247623 -1.3388666118535895 -0.68079888522044141 0.1091271323016734 0.37642127006723708 1.3003835059345932 0.0028544680966013092 -0.4375232369250226 0.24672641533326969 -0.89900648582578169 -0.042771029571047517;-1.0377524821943178 -1.1298345067385269 1.2922074698565964 0.20733621899426274 1.3286478232756014 -1.2588345547658717 -0.89056473624210319 -0.25120570915759155 -1.1116902976202971 -0.20517438477582484 -0.18948583931357718 0.97904303337051202 -0.62025187384951508;-2.7986840095854286 -0.20404790296255387 0.20589610988125143 0.22649787403399299 0.14560006453084356 -1.4097439216522976 0.52103619405554802 0.067658361834819672 -1.2649049052741899 -1.5891432094857687 0.23962716704259646 -0.78004209730417584 0.18560117515938046;0.0078897692315550577 1.2236058565079471 -0.33605129716559479 0.33330263767638479 -0.13191211593078003 0.12234599011621462 -0.5414801998688239 -0.53266536817140508 0.1517561316740425 0.25189237440119128 -0.31560430697204955 -0.76492701188147982 0.79808249405113107;2.3126786362524268 0.074574379730918738 0.39340125899652645 -0.73864496790563117 0.12914769038025053 0.58050311035730362 -0.64552044685513787 -0.44737827103407002 0.75056040877047092 0.77130675978223151 -0.2424010649640084 -0.51972993992724914 0.40894466605588481;-0.69899421314700216 0.027993266306337153 -0.38759412739977012 0.71415289887180888 0.84345608221397217 -0.57768098253722777 -0.21352077311107467 -1.4857850920137099 0.5693163086405979 -0.35749232786160756 -0.014009365307127116 1.1298066882845557 -0.55423554494525873;-1.6815262250637293 -0.11662238179279952 1.1857709539221797 -1.3682968832563174 0.64392678928547431 0.066530860841805151 -1.3247181593475181 0.49966980230467006 0.52532183205128768 0.38019342860329242 0.21666576868358062 1.7786026273560798 -1.1450386945507909;1.0010136654064072 0.72544930327754464 -0.036138873337638835 -1.177779617772106 -0.22761610878203653 0.59045314052994735 -0.4781137571571234 2.7679316984783471 1.0246356414336166 0.28125196612306536 -0.289006437240453 -1.1299567472311176 1.0154274759741209;-0.084772183733864442 -0.36205385637132875 -0.65561673501787254 0.88579153056493076 -0.95404984422812289 -0.14503388081091123 1.6532375611687393 1.1313318294770327 -0.04063400363854195 -0.76868649575669057 0.74789473417521501 0.78029689530677293 -0.57926435971812529;-0.40315176377701645 -0.11922283947710299 -0.44002933656841753 -0.36210627288747554 0.63767940715008431 0.29397968562091986 -0.69131033707876988 0.13668367808372245 -0.097354508084342192 0.12628206321432811 0.19479658326440052 0.075922502414792509 -0.70366569889373087];

% Layer 2
b2 = [1.508871450394714;1.6877410382745592;-1.2188928410485205;-1.8567963315277189;-0.94126321382576905;0.19418721051395141;0.31173439748627674;0.68256487271950317;0.9289097671946579;2.5764147072755752;1.9994839892569838;1.3469456973515901];
LW2_1 = [0.52730184619771325 -0.17614679808298878 1.4414709933359799 0.073612753894564842 -0.18958815720221645 0.57572304854557377 0.10964589408309869 1.0206584511426717 0.67062100790976842 0.17570124567533424 -0.64851176328789273 0.21770199909230292;-0.37294335955445884 -0.034754436806697896 0.60430216704624895 0.65585618292281811 -0.072812054055258757 0.32735958833319839 -0.93657428165701528 0.1209426192353099 0.41854689255866906 -0.63197033906926026 0.33239038225451689 -0.018463156729399494;1.0497731519590343 -0.30468656606296374 -0.45859950886671125 0.15165646329215463 0.62144049445370231 0.58938785834010476 -0.38699646485350125 0.97571212550823339 0.62419678885774244 1.0126040013783553 -0.45576754202648478 0.34189407897934709;0.28313595404599939 -1.2300373719567246 0.052791791831380316 0.22399838814395834 0.037258753839754161 -0.49941157453786678 -0.68916185340941094 0.79481446035192782 0.5307740043429755 0.77138169207979379 0.052433460976368682 -0.065380425250986737;-0.60225104528583273 0.42087448101979574 -1.3806781945123288 -1.0155223886979665 0.046783102251965192 0.45010217938301278 -0.84388023111229249 -0.043241360365515291 -0.47989833761207024 0.54445746308498666 -0.85103878121411447 1.41562868654754;-0.40020016067884678 0.48535756245650324 -0.25630166417294403 -0.32904955652961776 0.26358073529021858 0.50787042420705508 0.27608786771906824 -0.0087142432321985451 0.00021402322090355308 -0.35244381117327755 -0.36378764979552208 -0.01061547121448609;0.62671070547709185 -2.0861459446208688 0.38689973026028623 0.49792051912218427 -0.39723196164133434 -1.7623911164137733 -0.1092812076328856 -0.2949705378495952 -0.54520889409489626 0.43786917773110162 0.5643197264559775 0.30986894017727706;-2.5498938033919352 -1.0755639395315568 -0.52281112029754928 -1.8620587836836271 1.2923422465166197 -2.7329373879750083 1.0598674700529813 0.91538578033110463 1.3332213194753135 -1.0256945684229539 -1.6313400242918448 -2.0050874478783731;-0.57626440862535833 0.2415038264457971 -0.29065247254484639 -0.28453506995935818 -0.78214837211266963 0.76603470214290992 -1.4583406334068336 1.9926798204485434 -1.9993711468814162 -0.29068622695082225 -1.0414271579215129 -0.53169891816536552;-0.56227054581229685 3.4055076780480524 -0.91550364680399499 1.0421085039506879 -1.0758499571771278 2.6740949429980838 -1.8275249458262983 0.54094594216465974 0.20247406501504284 0.65999265621259362 0.12990011961287704 -0.60218268649994433;-0.39833002896838476 1.1119012245567186 -1.8579194168196338 1.4650882848512794 -0.9810027621681503 1.4954718662146627 -1.3976554204545315 0.74744607199343538 -1.1145784981461206 0.079021710332531955 0.29787527269458247 0.073745165207078106;0.21196606917340122 0.50483620393753159 -0.026262272839609198 -0.0029909510665279554 0.10758929610677202 1.126045935469733 0.1092621575765382 -0.18166066331198544 -0.2493338691831139 0.17940282682615041 -0.2482835097120169 -0.058514404343042614];

% Layer 3
b3 = 0.3978781508211448;
LW3_2 = [0.11299536855716072 0.25296888067597639 -0.3000561598419661 0.60728592848028384 0.24768738460573583 0.74420927504760859 0.33958234139135024 -3.0561895306532554 2.6686019119175 -2.2610474689072402 1.6513717741338128 -0.71697028983521627];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
