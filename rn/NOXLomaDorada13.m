function [Y,Xf,Af] = NOXLomaDorada13(X,~,~)
%NOXLOMADORADA13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:24.
% 
% [Y] = NOXLomaDorada13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.00280033604032484;0.0179856115107914;0.0558659217877095];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.1355622548899131;-4.1160153739793079;1.4438655707922805;3.2844103937123172;0.45217122136696114;-2.6419263889568478;3.162905397219165;0.43911112004632025;-2.5194808323258502;-1.4614736937276476;2.8723866502109829;0.57332753918032797;-2.8228506090021401;4.2460680706101988];
IW1_1 = [-1.6891425577059047 -2.6164788890635644 0.52713447319195927 0.48123652970839448 0.51542310651181467 -0.15787203340724409 -0.097986653095891441;2.6670467680120979 1.324824874788612 -2.0425933684076192 -1.1093694183185445 0.091081951932288324 0.79605331732431261 2.1066671799060179;-2.4573449940895888 1.8233924784285462 1.0996429974641213 0.16302310244341589 0.014087000711868783 0.74453842004872961 2.1559596949630975;-0.89869351813881471 3.0176462553371692 -0.3916211007525795 0.96806861234674224 0.58616423223030167 0.18882827118910492 0.2091096880618411;2.3607908926372496 2.5728283433429251 0.77904781465351769 0.721393774204661 -0.073207830189584572 0.42993701422722125 -0.59861665438122236;1.5198784202945521 0.050922612260014738 1.0175435395650949 -2.0674937117055703 1.1762728174199812 -0.50002108027060921 -1.3317844037876894;-4.765399931045267 0.84516806742480377 0.23135445392612139 0.074371442641498781 -0.2235746373670888 0.68245734728041907 -0.13153419087519591;0.028241330365376443 -1.6016230150164761 0.14633855870446014 0.37746208406172493 0.34663322937286495 0.8656659461243289 2.1232780643454867;-0.74122768498359726 1.2496042613865588 -1.5994445992320432 -2.1513831140220105 0.4292598983980096 -0.89703667827331268 -2.2346732026057183;1.2319931602496188 0.4533784124238695 -1.0273802438620077 -1.1520969169148731 -0.61514888450697069 0.14891014626351767 -1.0024343916383129;0.016741968977405135 -4.0768566817126191 -1.5818051250917284 -2.3035890324361241 -0.75622897402181355 1.339407653326697 -2.4588419609926095;1.0060253946728921 0.2968913989115734 -0.19515321244436326 -0.32763543542722695 -0.35372248538203122 -0.62220511536156164 -0.76092549424997236;0.025972025353333303 6.2736382222141929 1.4263321841498009 1.7551118124544132 0.13026464213830447 0.48840778723019718 1.7170999739575055;-0.53625897313850235 -0.33548582300773527 -1.6855651911306382 4.1426485973822915 -1.1125718602720085 0.27352429527102268 -1.474030616271969];

% Layer 2
b2 = [-1.9713494242274752;1.0981265819537089;1.7799721398044119;-1.7954413434652785;-1.6652757517978558;1.717059473793253;0.5777309420815615;0.59976424671453699;2.6510190897089787;-1.6352509936746327;-3.3269152963844331;2.691960766574987;0.199330311518957;2.00456370967603];
LW2_1 = [0.72124946138237989 -0.21737677829319901 -1.8602974757661113 0.44974608959542961 -2.0332991851439361 -1.974781094021504 -0.94831321916482236 -1.1477386258063147 -0.3694264136855499 0.26909116464235155 -0.35837370713443628 -2.4074224650412899 -2.2498822622402788 -1.1602265710376156;1.3247706202477656 -0.51442839002416907 0.099161355924670597 1.2562464487830736 0.17825082947521287 -1.1381136946098631 -0.88527661708422223 1.7316028585140733 -0.38260661775639904 0.57908449036165732 -0.89542691209071401 2.3238334690516238 1.1162377249325155 0.90756128457659935;2.5042017924185123 1.2712283841877747 1.3702052554668596 -0.021663977612487666 1.3970484364490712 -2.003903778683596 0.55702150092664637 -3.0394026855425635 -1.2091338632718758 -0.42465206363620189 0.12541002411525898 -0.71449112557275685 -0.36651672813565667 0.024527944701702005;1.670404004139989 -0.33963703926720512 -1.501893949051134 1.2156753424455493 3.8706400932628671 -2.1673178807739979 -1.8702378092501695 3.9852087411966908 2.2631233178948897 1.4153012015875983 0.024658648569098468 -1.9042524734324628 1.6995073214012533 -1.7021251113580931;1.5892466690659408 0.38486506764305511 -0.41994546391914944 0.99791499911006387 1.0616299658425752 -0.78012707207997067 -2.0683708062309303 -1.0331621409224943 -0.17124342161197789 0.29328840552641527 1.6411596749554689 -2.6008740468990355 0.34876161726142996 -0.62140568229998405;-0.49712431196506746 -0.3512701387749837 1.6588589912774072 -0.17381207557024134 3.149261077928621 1.1233403943243898 -0.73882050996628557 1.7925623851115819 0.4831949401542075 0.98560321065324108 2.6197330274864323 -0.83879650059854005 0.85883925212956891 -0.037586506747210403;-2.0980379927089645 -0.43166381890111849 -1.0527461816657819 -0.75554457415882781 -1.892230350026991 -1.8725872446181375 0.8233749457983407 1.3368253054704553 0.89400362299294445 0.02789804668054981 1.1492512578794607 0.5905638332544636 0.80388198681789136 -0.99808332521566134;-0.0065760140687693598 -0.09781955169484742 -0.42998648162658037 -1.1198468171623839 0.035909569209661957 -2.10060506011353 0.60425315530735046 0.25036848586545396 0.20408368783452399 -0.18497143849011333 0.71762375346714657 0.78452476240591107 0.23516479514089353 -1.4930149842804072;3.1518015957780765 -2.4396591254669779 -2.2559831121421281 1.8066512766125322 1.9518120605750591 -1.0625166237018846 2.6110542529422571 4.0371249945155174 -0.17747496522752013 3.2241948966512517 2.2893095732978086 0.62849133012997838 1.5455711639546923 -1.2197603782415178;-2.1104236861839514 -1.2122700821541978 -1.1396080415695464 0.13762009517482027 -2.158799190660563 0.96855254955484371 -0.62395592146887735 2.1968610403366919 0.76564614461496039 0.36840385351983246 -1.2224803644078088 0.44426998336940132 0.87515879569671751 0.55810954540651447;-1.866911181740047 0.62166803143032034 -1.3025057832713414 0.68794300460863678 -0.60184425796850005 0.67447505268162422 1.0392720388960059 -1.0798382168132641 -1.3748981176279638 -0.34074471126278955 0.42244181299997458 0.081502787043598868 1.0540274551879862 0.23372221454593409;-1.6259888745381559 0.021477585955418169 -0.12714312076292875 -1.6762598987455468 -0.78472192047765266 -0.13911199834949564 2.1885588720428339 1.129564320871919 0.13417483612696995 -0.3306021842668509 -1.3774662101736628 1.6788314008881964 0.016056685124030051 -0.51888458503623336;0.29598386549356787 -0.4863335892719477 -1.9882613157295945 0.5467106893334881 -2.1639537737859897 -1.5817399168231236 -1.0014983775702375 -1.3779075037993906 -0.37695018831587346 -0.32814660144694052 -2.1381620820479119 -1.2987625864912975 -1.1377813006854489 -0.31540162005715455;1.1215745402782 -0.63892293302316783 1.0332865732658643 -0.04313612179318662 0.55876498634601424 -1.7076809744995058 -0.8318736229164172 1.0476061941047148 1.5175082551520407 0.32533384755189904 -0.27216098785012338 -0.70518546997419385 -1.0518774256751842 -0.89063467141849428];

% Layer 3
b3 = 1.9520090296293822;
LW3_2 = [-0.39169184767896287 -1.2386131083683645 0.60190893600120232 0.39567291597528553 -2.2100495300626544 0.25237311008934077 -0.79651936354485109 1.7145526791447412 -2.3862176948982836 0.54013157510418075 -1.1795301655599459 -2.0656159293861611 0.528780319073056 -1.1256674752485387];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
