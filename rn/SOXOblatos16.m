function [Y,Xf,Af] = SOXOblatos16(X,~,~)
%SOXOBLATOS16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:41.
% 
% [Y] = SOXOblatos16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.0606309306805848;4.6488565223781286;-2.3256158431756693;-3.9764496142964139;-2.3816762276644203;-1.5690636206410882;0.4945825325081456;-1.3756012781339622;1.6082199276415801;0.34450458163567799;-2.7265233343548574;-1.5721128879885005;1.8076518982594714;-1.3516474088806862;-2.4716670798820051];
IW1_1 = [0.25233946319649975 0.019340902362819802 -1.4154875798112434 -0.43176337636407092 -0.23260145045609198 -1.0887878048278523 -0.09608519290860025 0.7747920595047858 0.17378480352355591 0.0075122830494270413 -0.3340517671280388;-0.4537395759808317 0.60758670954378058 -0.94555779836251119 0.18283913482958011 5.2980854843510885 -0.086353168230355548 -0.92177187974419761 -0.97869513156767696 0.21103391554153236 0.13751951299892193 -0.12952551846179469;4.3617944536285718 -0.33835419619749896 -0.85821627555766233 -0.24062730431882806 0.47695993168097617 -1.0753967454415376 0.32363418597659177 0.3233995216808021 0.090073770223275007 0.0030752773927078033 1.0304499361017585;0.88395569387742157 0.49876434710957801 -1.7251285648840251 0.021169755246075964 -1.5690992942470783 0.94065764914159034 2.4505113027316634 2.155589262485694 0.46963909485589972 -0.4965068192258541 -1.3840890260958894;3.1145224890771122 0.46965614665768862 1.9193155720927679 1.2254140783830936 -3.1080255015080316 0.39400118378270127 -3.4811550918399861 -0.20508091472809165 0.3767704041632452 0.73380275136013395 1.2796281568097339;0.53153489211589822 -0.6554298345059415 -0.22226599773411659 -1.2402299238088266 1.0322804228640443 1.5802810961787737 0.11579670899925665 0.15003650026038531 0.86347141317533604 0.39271946672842833 -2.0421801702811546;-1.1933137779989476 0.065281764728484681 1.0568912021696297 -1.9402518930050023 0.096364140598646536 0.94703144837534814 0.45819540789450097 0.78536116411915624 -0.3425113227042158 -0.46470426877961213 0.53141387326810507;-0.81453955891611241 -1.4518767905110994 1.6343190372234404 -0.72068120804005165 -0.71487849519175661 1.9105469815457099 1.9757631404056946 0.68127792021879774 2.9147999033481886 -4.7343413832892169 3.8829118902975037;-1.1102898360187674 -0.20793933045113297 2.325149709027527 1.1157141116358908 0.46889746003654043 0.44380949703750533 -1.1117905599879898 0.98865400863230013 0.013080276478375209 0.13533791553161056 -0.2285920738935466;0.38308636368142834 0.1203581757226736 -1.6077827872103021 -0.21946301271842514 0.77276295874130607 1.4588899425231032 0.17133747894553925 0.84797530870342097 -0.96481359828371116 -0.4161888039283993 0.35896188061082734;-1.2159213632336257 0.14326300766755418 -1.3437621721223234 -0.011165299421147593 -0.88001983846918119 -0.064539647017475957 -0.67013392505687086 0.54426639012437883 0.20537702415641873 0.18883406515968815 0.16692505478961495;0.040244800190556235 -0.12448553997481936 0.41548015594312315 -0.64895440187439257 0.14409849449993511 -0.23014266510191853 0.63369847293200687 0.5128567486690081 -0.39829125273718763 0.37410510843676892 -0.28444749169556693;0.19507210807023645 1.0952845188537041 0.92652104545587644 1.4944572961252183 1.9971078785214589 -0.96772840899219159 -0.38361316462900608 -2.4160082745667437 -0.086261493431087147 -0.73508257749566641 -5.4864067749603924;-2.3471063562719912 1.9470056415751358 0.23971588727068499 1.294645306795716 0.71010781231961861 2.6816588144984252 -2.0164578976416481 1.5756956707787588 -0.37191995067758526 0.92714498261803013 0.37024075342487228;-1.0501706162167677 -0.51669883986662812 1.6015211605686688 -2.5880038226462729 1.0866938312421783 0.052772860443039707 -0.48490915034946058 -1.4412373246056158 0.36009932740225054 0.24982651711162651 0.59047849076754511];

% Layer 2
b2 = [5.5034220343814519;2.6906922704787117;1.8233462098520681;0.46330012823526473;1.1584766118379539;-0.490297738477947;-0.22513195290254129;-0.34836518964834856;-3.6097349137494286;-0.31976921199431668;1.2056762821340108;0.2826596121199369;-1.7407198103882229;-1.5558081138501008;-2.3244657576838619];
LW2_1 = [-1.682293045349708 -1.8966154868783167 2.3041747320758494 -5.7397109036260128 -9.7277568557831682 3.2582174043574366 -3.7320610758439861 4.096194221387047 1.4461263927494219 1.8130261344545759 -3.4526680464890442 -1.9748120057321239 8.2175750944825054 4.1674100831434497 -3.0108323842694644;-1.1856760347818713 0.16911209581868103 -1.2185559825510466 0.38880788907526881 0.48225715474813163 1.5419796588755619 1.5131865975064385 0.35031457256715276 0.91354909974313914 0.76659367740456552 0.81001635010700468 -0.042394867059557931 0.47836484121229905 -0.41831003647696441 -0.66991888505563002;-0.97024075483048966 0.35505547464454568 -1.1387732641615236 0.42354631452783215 0.51408853416708367 1.4261258300630184 1.4534715287408615 0.6997621889002853 0.63075004941418167 0.78468910185770668 0.45280226316515715 -0.74380202009365115 0.66163170798410942 0.68184168407284951 -2.3920970760167668;-0.61359378555680855 3.2405564251521146 1.3635886006787588 0.15801683032425143 -1.2573793007005896 0.10728332654129169 0.62050067209323267 -0.63597445051151802 1.6664981902822642 -0.15865680736504437 -0.26126013225677108 0.27014394280046855 -2.6212566012841028 -0.93027265562497463 -3.8802071536711162;-0.77024571955032084 0.047274907776217845 -0.45116138759826774 0.059355880673515833 -0.5768576352315864 -0.21458874348710921 0.35825455902120845 -0.44469610943046151 -0.14953067712854709 0.33094792237402093 0.12369980327258684 -0.81438696890292994 0.64382239743713265 -0.75395284306040899 -0.45179138005670105;1.0160236685378079 -0.091340691943731428 0.28607041210275175 0.13586127978940629 -0.35887762442226517 0.62595549721190769 -0.38833989938691782 0.59013851305971932 0.6050172458945785 -0.042328650067385884 0.25931135524473892 0.96780912237192673 -0.56417114396596124 -0.60360389970117534 -0.39354596071093406;0.48307394224880285 -0.1850588087108016 -0.42199191723612978 0.23581683088036204 -0.43049250766847014 -0.10251458050280934 -0.069221077176331303 -1.5810917378192071 -0.50564317724253227 -0.31606854760253106 0.056679937420511778 0.88827844236322551 0.24611554970538027 0.049504581603799211 0.6616194270769663;1.3383790239677535 -1.0803414454813154 0.46134317771640476 -0.26805865929789463 1.2268179156414609 -0.77868128668723802 -0.070152824740407724 -1.062359536133429 -1.0624497392452084 -0.4921144688191153 1.4983980826032501 0.53386828621851734 -2.4614429439931946 0.3209463872894428 0.60208248302904621;0.38448232602936294 0.90980032348497264 -0.55882247770942362 -0.51356571542166374 -1.9817236817416037 0.58353557746180162 -1.5222308510446469 -0.24912952078775374 -1.653004099864912 2.3922647860958381 2.0545410970222218 1.075869784588154 0.19434792960363928 -0.2564277949199496 2.5009126420232795;1.9720741413363436 -0.92024178590599437 -0.4943575426432727 -0.8165353587716504 1.0642255044469986 0.3678871960256101 0.35030271163752158 0.31554462075361955 -0.95667843434816613 -0.64029170641669109 0.084979876835917179 1.4967178513108423 1.8342790497458004 0.48755594760630383 0.72046056430293515;-0.49910588996295036 0.29301270080110775 -0.089494652020945281 0.044536747001041661 0.10679276145800744 -0.13114405901066045 0.32586085117662938 -0.0033452834919622254 -0.075239157063815995 -0.088419781731625263 0.25658030102855417 -1.1181955620176907 0.1393801282524128 0.022715288131289514 1.3322652144217599;3.2724343562771701 0.023368046730294148 -1.0971589953599048 -0.28799495808872777 -0.38629294672480469 0.27945170348918064 -0.92497569450097961 0.20415893991314607 -0.78470180714869342 0.66908335072385761 -1.5830315247719144 -0.12670548147266586 0.10055691467375996 -0.32070778785642862 -0.34438720746346602;0.31810454633483953 0.75684023140914847 -1.14419992730709 -0.38318124961334304 -0.55282644846708284 0.33334499566134934 -0.66808109199015164 0.29916179383493324 -0.71847948082369217 0.87124722826356849 -0.39945216881212875 0.45076743405363923 0.11224037736122192 -0.526136537186081 0.66533935729529026;-0.38883400299534721 -0.98422754939513446 0.18469228513399968 0.30364088767967468 -0.14563647321452317 0.75913279626235819 -0.45210565502558242 -0.46942483091248555 -0.28182514133083225 -0.5945159179549967 -0.13752107685847142 0.06896357301683656 -0.1799629306782215 -0.56483432893012198 0.24958746758717676;0.23390915755728908 -2.4900366001038834 -0.96252103988595983 0.48076697121138801 1.1102113384712247 0.060545769147296168 -0.26788917080999969 0.38469140362727383 -0.36607791011118901 -0.19095882351046597 -0.24434188124770809 1.272238188742709 1.8938793748762848 0.3911982237111073 0.074340787408151018];

% Layer 3
b3 = 0.11956509115756747;
LW3_2 = [-1.1194017418023059 0.37100626547743532 -1.4304330983999278 -1.8589416681484692 0.79212122742471625 0.28256240315985454 -0.031059141285484395 -0.618776244562802 2.1995181922030866 -0.92340829229047294 1.1535905336803158 0.13209608257785896 -0.11514000235735523 0.15018296144557225 -2.1323637756214091];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
