function [Y,Xf,Af] = NOXAguilas8(X,~,~)
%NOXAGUILAS8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:12.
% 
% [Y] = NOXAguilas8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.44754809988751143;-3.2042061679554541;-1.1804354591342505;1.993263454621315;-0.89125359492676259;1.9110845881731608;-1.1043616678108692;-0.21610546187143559;-0.41395352571609345;-0.9879514982479527;0.88755231831602022;4.182837202496823;-4.426841262981525;5.6900476659982475;1.7188094887525021];
IW1_1 = [0.24965650687702176 -0.13272727480592933 -0.28845036918929579 0.56547464925091173 -0.76670550433687568 0.36076584024159841 -0.33546550100442812 -0.76260536298528903 -0.1403569510087456 0.24912889633305194 -0.0013520517942059483 0.56256396511191764;0.55076919228470345 0.52154683790701029 -0.71662400501821999 0.051206123206403165 -0.45492543808356789 -0.74688144950092861 2.0175345408417948 -2.6806564840841944 0.13027388434776965 0.48396167262670875 -0.060989397715131066 0.78661569344884719;1.0088822524904453 1.0725051472059703 -0.50603059718909471 1.1562622109613152 -0.041439412096758735 -0.82995360164861354 -1.3401792996841582 -1.0660620882815752 0.11092354444392066 0.45529206574185632 -0.1156672397957775 0.010151268359938063;-0.64444720430651226 2.1696223233705489 0.23025515549396908 -0.12281566314449625 0.36158234717701937 0.3699088693920618 -0.5692761643161216 -0.87076775623947555 -0.093957069218296399 0.051779391637312128 -0.22633985730257558 0.24029871672637498;-0.0041323147545821101 0.05371290136903549 0.32959267364061612 -0.19934445750275787 0.21891302585012851 -0.62164431163829714 1.2964029755121542 0.22312413673669687 0.72992815343708506 -0.21966168357839774 0.10518998496775078 0.2358071279251247;-1.5250235933022025 1.8234055596883811 -1.3661734229318112 0.026448475271952258 0.50315340882577486 1.9699473186829475 -0.14706594204600915 -0.42288505233362683 0.07518833468477884 -1.2009450858697908 -0.014475929752962876 1.0632925914626861;0.34342435282958211 -0.93973634024438146 0.0090426895072106411 -0.68805227496719101 0.68318492971347755 -0.35491934909763462 0.40454322168387347 -0.52657555457742578 -0.46156421618597165 0.10186442389066036 -0.072968825100584805 0.55855121307349864;1.3733819028971719 -0.42164903276574162 0.18923275565733083 -0.57029019933377578 -1.5957545387997305 0.21620761509299133 0.21483239290530917 0.57199977390331214 0.010820411590631854 0.19508646103954624 0.11807858877991756 -0.29565834847733813;-0.17002376334567632 -0.069421492228457074 0.13054937448964848 -0.14917872297193141 0.88336166064436039 -0.33338763337884786 0.63417958471729841 -0.28332818546301469 0.31985442841223827 -0.53722279979718046 -0.018730120350042595 -0.088056966730719485;-0.93619183542903051 1.1616212504461829 0.14994988956766533 -0.51086865189804365 -0.17603008419766036 0.21131398797114515 0.93874810325544666 0.072000629853860618 0.12804622556984768 -0.13375711636794246 0.019049128941734741 0.68676341900816307;-0.093122693260002484 1.1640733150718998 -0.42154073876107673 1.1312260623310639 -0.16041438462235383 -0.24607229832558153 -0.31376500511015437 -2.0129238959535103 0.089216207779550458 0.45709761927704662 -0.17853313060244497 1.1998403702007521;1.2819129487830354 1.588559040794455 0.81734021865453754 -1.6073585285280632 0.82877036560548767 0.51697994420254645 -0.83865407070854603 -3.4335552275164423 -0.016588207896326666 -0.43820892219209084 0.34280454270395672 1.3419111143179479;0.14855114456818805 -0.051249645214238616 -0.81373986863675074 -1.6298810408390676 0.36789860598711982 -2.8744459447227206 -1.0239207331012214 -0.91043894112817114 0.28473804535089631 0.20984998967346685 -0.2570917332839005 1.0032373123783132;0.54600672853930743 5.6392773211693434 -1.3481259459356485 -0.8211882209875444 0.17781339863370346 0.74216360763156386 0.74215826506545168 0.63692221984952957 -0.47209106741494672 -1.082239983849562 -0.65102100658385531 1.1682214795310801;1.6018538609133277 0.3673178642408369 0.45296864564722061 -0.51928121721428255 0.66976172610634144 -0.41096248388061729 0.47912298857976771 0.453618103777709 0.26474398829818591 0.045683537433770412 -0.040533387874140056 0.38197380965738686];

% Layer 2
b2 = [-0.498463501250199;-0.46586846415936295;4.5534755784520513;-1.7874682242711069;-0.025110108352953884;1.2617152902548991;-0.46771473663711788;1.0407666407883354;-0.99864034029421211;-2.4016902720582016;-0.82384347364092936;-0.48434665393010073;-3.326426511581428;3.1014021970554935;3.4057463026258126];
LW2_1 = [0.35967916399749161 0.48474434458431165 -1.1234160805651252 -0.94153128705562272 -0.20670598205638913 -0.21095875229004377 0.35756969656269738 -1.4500730227420116 0.057499783974544957 1.4844316162967375 0.15945220934348966 -0.89687109943026877 0.31891927284443977 0.21057396923838656 -1.9507579059079971;-1.6199365944182413 1.3145753292792719 -1.8027454551730364 -1.2247396622177826 -0.64100139009635737 -0.23162872050659936 -0.50649016931864232 0.15787125189487378 -0.59106269230362773 1.5774018909082479 -0.086161311301060667 1.1933595069320451 0.84458520826846806 -1.3895457889776592 -0.97283406032722208;-0.82908336833282259 2.0766135422542313 1.6153067965512933 4.2385266656001095 0.9548379562250352 2.3840137884087431 1.0439601375675995 1.7089938983179513 -1.3128273596217885 -1.8872309136325445 -1.454933210391508 -0.78385491693439935 -1.0434945624822443 -1.4338677149161814 3.1867479286745795;0.49469033783901295 -0.17277515694971785 -0.50710147362862812 -0.16559685563649779 0.29450858806080249 -0.0060661813915711465 -0.12575484798205544 -0.38668020788404506 -0.036356614077867708 -0.88124564171088082 0.16120148100360915 0.73570985091370911 0.033913103549884541 0.031591390636920763 0.45928882329869586;0.84019364470154312 -0.74825698078495873 0.35508326364095566 0.83288127047097216 -1.0455255869048135 -0.28738361476019325 -0.20262291160246709 0.85277586986515563 2.2444153257483652 0.65564795526429542 -0.43161414873390536 -1.5411669056052761 0.30664974652222754 0.79415027440566432 0.2967678718045208;-0.031163317643149249 0.47118200848198227 0.37705323435596566 0.7466046949018641 0.11089739426825559 -0.010789809032361198 0.51987033511531544 0.056449949243709233 -0.13076939609091776 0.16041039742861876 -0.35373019641537512 -0.47425000711114151 -0.23376129183729008 -0.34716005275963602 -0.0013478549902721029;-0.09268306624277188 0.35512712823682085 0.083410340612049494 -0.48808010257044232 0.23827280635449122 -0.027204196759904802 -0.17238580461096378 0.55272805518426893 0.515413089975017 -0.92918673722387779 0.17322192981728141 1.1881871473683672 -0.53580353978457607 -0.3630959219887514 0.5342135201617727;0.76163377372434604 0.53306297887690635 -0.06151589245719994 1.2376522502950034 0.20325634905079396 0.20441914755259166 1.7309832674178138 -0.7910920296153392 -0.13331920431186983 -0.23557922291430766 -0.20160459202147687 -1.3840398505059686 -0.06889086685019824 0.7684298089801157 -0.026654183968369941;0.079229735553821359 0.76124406830853353 -0.043066506433302038 -0.1732168250821399 0.56357670315713604 -0.13520754424478459 0.32572885195393025 0.22578093992679238 0.29339654238200896 -1.5353998327463692 0.0090973399908147769 1.344029431321297 -0.77038143432203843 0.27423891784285653 0.5540661344249016;-0.67976353854126781 0.1470214583110965 -1.0388770439693065 0.93502733252267245 0.68420056297164544 -0.63386447724752826 0.25857890443281062 -0.063889588089988125 -0.75454083537478178 -1.5098589614689206 0.4319596930502424 -0.017693111959941454 -0.47472168294897987 1.0996995797728688 0.30484139711709807;-0.82807013548203434 -0.62816044649937008 -0.56665183630093918 -1.787580511135058 -0.1347136031183655 0.11084734005106871 -0.8872130282892029 -0.012193516149201805 -0.59900052569568141 0.16661913757038438 0.98307978285398412 0.76283347013893288 0.27454303045361 0.047130628432118918 -0.44869053205397291;-1.7044206752146374 1.1893413476369967 0.14132346669453633 -1.2440045724922582 -0.028613887669703304 0.38104037708682276 0.72307630171849757 2.2989923347439953 -1.3654871327396023 1.9104598013710068 -0.93123333751488557 -0.30902934590784137 1.1079952559697475 0.09171432260112948 -2.049407334541637;-0.3679526467598368 -0.18961735193210408 0.44596988635271084 -1.0580518791011979 0.56473085853991689 -0.12559330019134071 -1.5855976201309885 -0.44275406840803605 -2.2031844006775563 -0.21252327879318578 0.31477908116758418 0.11194742964611332 -0.32677728849489784 0.11684051591994968 0.085251565712070418;0.55693597572512965 -0.87302401689862463 1.5061022595877422 1.6442567771952634 0.56133717384424298 0.023598940453648548 -0.10754838142708172 0.97792649992794178 -0.11476223936220845 -0.57611295020725983 -0.67383740008924531 0.071437259344477713 -0.23052777238113462 -2.9321135846081838 0.76874172040933597;1.3249457239488909 -0.73069749638195358 0.78208813561554835 2.2824960575790043 -0.24035356286335194 -0.069731573106510472 1.8555870436699577 0.4532557480601182 1.7218071225447087 0.54940540325450915 0.13777517486974217 -0.66319487749929062 -0.80538154579390864 -0.199910743751155 1.3976166063383149];

% Layer 3
b3 = 0.0028446318128855265;
LW3_2 = [-2.4193821663887332 -0.86282383448018196 -3.8802835953141832 1.9849447913317138 0.70711453270175562 4.1266181889799043 -1.7951204233561233 -0.67556650449296829 1.3809967436229316 -0.54870697094635601 1.785464063486317 -2.708016437149745 -0.84406644492205352 -1.1991814940033587 -2.2867861905904516];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
