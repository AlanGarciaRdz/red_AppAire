function [Y,Xf,Af] = SOXSantaFe9(X,~,~)
%SOXSANTAFE9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:50.
% 
% [Y] = SOXSantaFe9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.434784567400728;-2.8271928717497676;-1.8572861976381105;0.78502028331609897;0.03273816798015472;2.2576541495923306;-0.81817747233601712;-0.88670936453317784;0.60005976204995182;1.2985669295529241;0.66378107012022269;-1.6384468300544919];
IW1_1 = [-1.1347251966012384 0.85028737837611612 0.24840762232694902 0.58827359055313377 0.21660075036370785 -0.5254329212074984 0.56688739355324402 0.76032544916385192 -0.6873122558184892 -0.77242418775718813 -0.56494484433386638 0.072115280998904963 -1.0726483078839681 1.0077073792060656 -0.15243133782393753;0.34271208069525277 -0.65021238256082237 -1.3033854896098376 0.16705106526564414 -0.56624544997330262 0.077539257787037602 3.1852898981489806 1.3890001265389174 -0.10090054323333482 -1.7488420186747762 -3.1873292831409401 5.6016286039808421 -1.724714191837512 -0.14384387965732942 0.98687502312471043;-0.72058957961410286 0.12045170136408992 -0.36203414849669513 -0.59884110066663299 -0.23891280314196178 -0.17261561903467598 0.054411174575386065 -1.1950496817288034 0.67661656968741213 1.3717984967278685 -0.2612604205848017 0.12993972013248789 0.69555051985877314 1.0886179085381031 -1.715310487576422;-0.90008379694558582 -2.0479254548345946 1.0700922239631681 1.0704671798010139 -0.76193630026382242 0.20110116728836122 0.7185295382776028 0.16386834553172352 1.9334072137148253 -1.7455725224784637 -1.3184855199399639 0.87312271504768235 -0.46384899702596394 1.0523773587875989 -0.15016556744335405;-2.9495282606784818 0.20542297191794262 -0.7994154569657822 0.4077485535734095 -0.097417118405794825 0.51240384349761592 0.17495508766622159 0.13946983994913556 -0.80341276350206892 -1.3816109288972263 1.0820518700049735 -1.4698828287597541 1.4283760729723585 -1.9955203161730972 -0.44416004782578083;-0.47651468355201998 -0.018947610194588828 0.0047614807461080141 -0.099517755714921469 0.21256823349484763 0.17422882538237566 -0.21700898810979213 0.01890867507689447 -0.045867403299419109 2.2359579166402508 0.16931626388214768 0.019184678786888273 -0.021417115692485021 -0.0007019952210790591 -0.41081668694955092;0.25373788951084436 0.10403459024281503 0.020348037154772146 -0.47741648456029429 0.81063195693018641 0.54769214854632908 -0.85752988184539836 0.16909232297115809 -0.33526724280952414 -0.82845842500712619 0.56583759497191743 -0.066505969760730407 0.011902196295097756 -0.16929338006760289 0.14351496634344316;0.0061987115857276703 3.2316187311181475 -0.52963582509796858 1.5887794744957233 0.52899175851300329 -1.2930397609429827 0.35757301076511128 -0.40444399628311184 0.6551520896163241 -0.7942240761037227 -1.0429455134810612 -0.7407548058242851 -0.13036305719468627 -0.0481422027126766 0.48408263127663109;0.54804728459726126 -1.1119489855577462 -1.6891605784430606 -0.48527633086016186 0.63585255223733683 0.42489774428369981 0.81565367029569502 0.012974683254918823 0.43911325378758176 0.34061466915199579 0.25215009202011995 0.64450844496921866 0.054164586041498874 0.64502869994210865 0.99018930542634598;0.72702238093330041 0.21359873371017477 0.042997560185297212 -0.12490667422136342 0.052416096759902511 -0.083136592568627793 -0.17091542606083157 0.039445080645688899 -0.3600442107271053 1.4008221937793521 0.083120541269162213 -0.090888881184253825 0.11618395444292384 -0.14686535047700902 -0.12361390938645525;2.2239632481715783 0.24920991254976219 0.69588057589266572 -0.17926532843915224 -0.073584977526338149 0.72066024586458943 -0.6888208083941747 0.20274344775728165 0.76416774307101798 0.66646730722919112 -0.56332001942436183 -0.2161289057211665 -0.76596550135354236 0.31098206629255903 0.52256053324049212;-0.69106839043656276 -1.6470860768576905 -0.11575221161202146 -0.28855373016292774 0.34182849718968988 0.38379975187442167 0.6058685507416669 -1.2294243783236356 -0.35704442511638079 0.40973854155161271 0.70068654415548626 0.90689014093343656 0.25009980511832403 0.084397023099706731 0.071880099186108493];

% Layer 2
b2 = [1.788023051626431;2.96935258310475;-1.1050656755436894;0.83902695805582128;-0.46615945385284047;0.024871141162592106;0.1389071350748331;-0.71789301733548494;1.0361928974598407;-1.1323948741673995;-1.6174439875286954;-1.4632175008054762];
LW2_1 = [0.10235506239701553 -2.4569292994790164 -0.088019200747950041 0.092185549026729499 0.90879857864382629 -1.8033625888420546 0.45574015106493637 -0.81100037917656986 0.26840997921803622 -0.33117137140252423 1.8874822778023976 -0.83132625258450821;-1.3877958958229746 -1.8657778798063505 -1.3948226095072027 1.8003410075998136 -2.6253094123424106 0.843487945346313 4.0485778393095471 1.6984707564259012 -1.9598755021031971 1.2094307672983544 -3.1924474121824686 -1.2151168821077667;0.53170791392095018 0.39803543194923657 -0.18446214120980389 0.24342839445597639 -0.54379506184037019 -0.28728188730887455 -0.42209744337729693 0.58133019342699266 0.61445103159216585 -0.33398441039837445 -0.80982582175652595 0.7170990530882454;-0.0059046795240020045 1.5541622329418014 1.564007402025664 0.066578154904663733 0.79555414261145097 0.48666135658681103 -0.32577704898424648 0.19234675714143035 0.82426853389980348 -0.63383059203055525 -0.48651252252327726 0.46187451839057009;-0.19903867856023549 -0.097356173988632985 1.2030626954974031 0.16282326371408987 0.034531597601878197 -2.2523372617409061 0.81908725928886683 -0.019471649230034607 -0.34507498550927079 -0.47820310415580392 -0.49139239468331242 -0.74157851551606435;-0.34406546140939853 -0.38952411520068458 1.4309300543319472 0.49284922856566549 0.17501530276653843 -1.2630481213325535 0.7463465639968867 0.29293210973647837 -0.10027940590472828 1.2927261974390973 -0.4748940505684679 -1.0284173614271921;0.3908030432112562 0.4256107196482487 0.50723718870034673 0.13442387536800793 -0.13801475663367585 0.60931925144943266 0.52583218413806532 0.51477397396498636 0.16388120784306295 0.38912891354201673 -0.55448643281422394 0.61305687723810676;-0.19177683193126288 -0.13486701889121047 0.40004052405442203 -0.14637723554563509 -0.65972946975140889 0.28244971474073216 0.4401038937479187 -0.31442846819056014 0.76133351185314535 -0.19669351949214131 -0.83311616115239129 0.35609091618031791;0.65612991282224309 -4.1899900068469229 0.82947206625398495 1.6580897377778838 1.037521184470809 -1.28231796303794 -0.031050930687068823 -1.5230725042992259 0.0791662419922778 1.3929866030308125 0.099329645922594578 -0.16892188439570033;-0.44734851142826226 0.31547971841041678 0.78074442673186029 -0.059389404432726549 -1.4633339913440218 1.0831092437247902 -1.3849778928934329 -0.4415229555195031 0.42713304752189174 -0.29466466880790187 -0.37441817997281768 0.81925095913105672;-0.67395735299383863 -0.2962794195949176 0.29538262068225934 -0.46877721929040811 -0.76778076865837197 -0.6149145693215754 -0.011733420621228608 -0.33009917389452192 0.69155834567819763 -0.30382997298809683 0.17679336006445112 0.7445965142019304;-0.41422634842892786 0.015791086660974916 0.28445521695707215 0.1228182791350344 -0.23366847788932166 1.7471623709646702 0.23577890099214138 0.53081129241315661 0.61450244356737926 0.4874128317294153 -0.75108856207460084 -0.72303448670267889];

% Layer 3
b3 = 0.67852306394212969;
LW3_2 = [2.3445704551791202 -2.4119151180177756 0.10646629549338371 0.44525041017371314 -1.2740676914315945 0.17242676814898986 -0.29413181509737363 0.54968978446956263 -1.9822438779281781 -1.0745761434357135 0.71984559679979299 0.28650647935169421];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
