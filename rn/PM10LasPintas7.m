function [Y,Xf,Af] = PM10LasPintas7(X,~,~)
%PM10LASPINTAS7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:28.
% 
% [Y] = PM10LasPintas7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.0251256281407;14.7058823529412;0.0179856115107914;0.00280033604032484;0.0558659217877095;0.00576368876080692;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.5099337766524528;1.1272255901916042;2.0547121973072926;-0.092291290745573462;2.6091150574341651;0.26415493994078959;1.5508260576407809;-0.037239910290349496;-1.0460062301845301;-0.28857715742380796;2.5545331634330681;-3.8811528844938565;-0.6494733897604531;1.2346129863548259;-16.13725182081415];
IW1_1 = [2.2937752524521655 -0.38969758314238301 -5.769301445424043 2.1392878547977903 -0.20833773516535029 0.95551646538345525 -2.5757147254602288 -0.15970786702543202 -1.7080312817337082;-0.25923316894987136 -0.16346306760625742 0.23662549135898026 1.13877374212493 -0.026381859131931883 -0.10220139445588904 -0.50864233280342941 0.19860477563358228 -0.59684493466025312;-1.3958324007965655 -0.78050801714055207 0.49763739617316177 1.9171991613685926 0.80065275218027987 -1.2980255580741189 -0.78979146668146605 -0.40111610153325161 -1.702209266296735;0.9684185606576311 -1.8757300643962462 -0.50458226803965256 1.0608345261336607 0.052690782937564198 -0.67702584256409704 0.2423802156436157 -0.023113771152760476 -0.28312139691054661;2.6113553371372982 0.081732176333307496 0.37793322880194585 0.68750992235010178 1.0277464065328772 0.01689989494076068 -0.15333056546146911 0.059520987772997136 -0.76736561623163435;-2.7400788761220625 -0.69706347742723396 1.0837118101288827 0.25807353982727921 -0.11650922060270848 1.6021642987673352 0.51013207810564032 0.17906063512031462 -1.6292165413494903;1.2132612746080835 -1.4239912515180968 0.83823105026599964 0.82042790320273662 1.5565440816371974 0.20821906717427829 2.1655662859639908 -0.10101908168039971 0.11078672883098195;0.38017610512451611 0.68555071939896794 -0.19435493247057373 -1.5747526307172302 0.29494144846339387 0.26555739877024992 1.4933541060242028 -0.010574779004324103 -0.12828991865319625;-0.030650735411861883 -0.11060526950922661 -0.24035894177305403 0.2241274439056038 0.3146859985946 -0.75870162526452023 0.45407161161269116 0.036909567395521703 -0.20271461607563268;-0.66461475373172119 -0.71384014841681442 0.087938093308181753 -0.53222231202836501 -0.40645841346570782 -0.36936799194807796 0.0028059049191212892 0.047811197945775041 0.37791390606368036;-2.8949286154568847 3.3878763737030715 -1.5829287859054084 2.3060448507110682 -0.41441555708339545 -0.079559233292590986 2.9161383564647578 0.18860424689264571 0.67005619873222289;-0.59128001455425994 0.04869943637586574 0.089375207942957544 -0.78479793321167968 2.4722212881832246 1.6811617254301261 1.7103332385824643 -1.9640256949776291 -3.9353630968854771;-1.5966423134534702 0.83453574846645895 0.93239865587778004 -1.6764440448321225 0.068096947519408327 -1.0035170919071412 -0.56520634555052296 0.19735192369118648 -0.16319484293065753;-0.71416022831846315 0.73175283364347665 0.47136788791249368 0.089136435064457259 0.50509961574354201 0.18731807424892849 -0.83511138274173313 0.29268285254492477 -0.11143205022151044;-0.80406052229105274 -0.39016437969984119 -15.406531170825758 0.60467329598096986 0.066988817446738305 -0.17557388709110602 0.25525181385916729 0.00466493699407122 0.52682435793508908];

% Layer 2
b2 = [-4.1225269246133118;-1.9089229134990287;5.2704699112160336;1.8603607575384349;-0.97981989125270863;-1.3617378012182451;2.1961674696603497;0.46500284408655462;0.79370553037383951;4.1254257997629509;2.3142149554799105;-0.61564019056226771;-6.0793659041260817;-7.1248978751157601;2.0953553277109678];
LW2_1 = [-4.4153393862540309 -2.3027315031557367 -1.8034968454923594 0.45998473419582997 -0.47528734305397946 1.1603672964960297 -0.097705416518177018 -0.95146481946451877 2.0000405689893586 0.62071506190075731 2.117271197113423 -0.1946827675627584 0.63788594476897797 0.40518160972140521 -0.15034154852442036;-0.54493338585019091 -2.5546314709369216 2.2044833504127683 0.29082158163228133 1.2586206696845577 0.33134039258451714 0.82815382912140001 0.73175715447273049 4.0134650279091835 -0.82853567053646393 -0.88936099910811761 -0.71494875961369309 -0.76281186126059874 2.9914579998575692 -1.2414445684764246;-1.7640189762578109 1.8205517832762073 -1.5419202787361432 -2.7268836814612287 -5.602668978783047 -4.0491044748026663 1.1840134515311005 -2.5040773621214845 1.072614562988186 4.5767945354678394 -0.38903888695859268 0.7284240379443494 -4.9329597122474063 4.6677946395697516 -3.7171217276085642;1.8419310476562476 5.5580018410618184 -1.8438310041762758 -0.59345814535193198 -3.2419162088125395 -3.9911292191736951 -1.7005388033732662 -7.8694613208421877 -5.2212501666313873 1.3321127478796375 -1.4522225065209142 -0.54360176264856253 2.6168331151961737 -2.2347808344282889 -3.1564883969078386;2.7182591426285638 -2.1229872951225635 -1.7196610660501432 1.6800307324286061 -0.5588859522669426 1.9314218022507148 0.24453559091618807 3.7088169419503614 0.57176939214574429 0.17553877912836399 0.95394620884977688 -1.1025892454089592 4.0850243949165437 -3.247756491087876 0.16808421987318656;0.27063740260341596 2.0014547833012708 -1.7095383949106047 -0.61497346286705479 1.0176591660170564 0.049723582314165765 -0.23064684326673668 -0.30681857387192429 0.46058593777592277 0.88879292555241496 -0.11632535806843171 -0.013799530608130921 0.74088875210520677 -0.76943743772845608 1.1998799576928414;-0.061338635148887183 0.033521488402890036 0.40719410024736485 -0.65770519808210526 -1.5647807727710514 -0.11838737523877388 -0.067504718322745322 0.44347132334103134 0.75333244390543619 2.6358251842001366 -0.51528027943962162 0.079275203119329132 -1.6606140029345522 0.66136825934098031 1.3526556819873767;1.332913885604901 5.2333954822744335 -4.2372649868581744 0.48803478773200948 -0.45083149176399429 -3.45000105512087 1.2209278201257041 2.8524176947718787 -5.5816815949906164 2.1509317520038964 -0.47663549698213931 1.145280989057528 3.5191631881432945 -2.7523222850366298 1.3138681100209857;-0.9435561879873664 -0.12726190310718735 0.55166615659490803 -0.49635465604850432 -1.032154519811979 -0.26645152500005254 0.42806215653362534 -3.9355088337249153 -0.45833763726365506 -0.83341891056312356 0.37369483245327045 0.17726833311214205 0.8845632838960803 -0.81615803699861278 -3.4800036370714396;-0.16666462921623448 -1.1259777353784473 -0.91282486690784637 0.98964380410218633 1.0182613001547607 -0.39145306298426857 0.11035341395021012 -1.8350688335673566 -0.12328484758729276 -0.013621935555225321 -3.4944710427732324 0.33374450646880954 0.46378420734421044 1.3295131015556585 -1.7528549993619689;-0.88084580358476883 -5.4201800624192273 3.6019742490325988 -5.3684423195087509 4.2042555457912787 -0.48319719150138402 3.5868288770372638 -3.0767335631380686 -0.50827620275809127 3.6160053206099523 1.6134072721935426 2.0241472153867832 -1.8626874067176751 1.6430672535620048 3.010586884896393;-0.41977948659809583 -0.73276775221845436 -0.11373196342804405 0.6989752914482944 1.3432662894381067 -0.25841649913127507 -0.40709682189236496 -1.3107750620859013 -0.26660590674887458 -0.97221436659572769 0.45216613339975603 0.0092028437629802437 0.64980782651681879 0.14953177862516312 -0.63645915997424996;2.9917915847990932 4.1152264494212405 0.58363877964915645 0.81368967363132594 1.5274508273108136 0.82730182571408439 1.7071613492648108 0.87924910910321041 1.7985144484874283 -1.272877605280174 1.1634922620529233 1.1181087064123674 0.51745419987752506 3.4587518154926675 -6.3122574783368224;0.9467181247831401 0.32675525083385737 1.8965348704440892 1.1647082670330859 1.4059690895161774 1.0237224761315897 1.0437076005107988 -2.119170007099993 -3.5718415366452749 0.36956837648130275 0.14261246061795438 -0.40379411422642614 0.073339219893689148 -0.30063336763016801 -3.8866925160999646;-2.5518517624131345 2.7875558520106085 -2.7004239206168106 -0.90927804591013373 -0.66005155305785357 0.1173511332086776 4.7397487484323957 -5.8250881284607514 1.0841720602248694 -5.9331210763895754 -0.15793901395799487 -0.88836339125757724 5.0411309474109824 -6.0313735081192181 -6.481059497460909];

% Layer 3
b3 = -3.9168239299986349;
LW3_2 = [0.17816047283317277 -0.14525895462240615 -0.13023649043618546 -0.041684241756075255 -0.065225647810615781 -3.5695024532516815 0.32875587153140656 0.048764598861686159 -0.22630960829148941 -0.24486271317970251 0.032887048904232115 0.57578869976826663 0.071124637562258314 0.17194585994321826 0.13002581200843183];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
