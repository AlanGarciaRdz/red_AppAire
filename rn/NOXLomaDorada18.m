function [Y,Xf,Af] = NOXLomaDorada18(X,~,~)
%NOXLOMADORADA18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:25.
% 
% [Y] = NOXLomaDorada18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.00280033604032484;0.0179856115107914;0.0558659217877095];
x1_step1_ymin = -1;

% Layer 1
b1 = [4.177088666529106;2.2775757497758904;0.71288422290604714;3.8967851398611475;1.1394071770420013;-0.40458498118670355;6.1491973069605939;-2.4278383967286103;-0.40151856980724254;0.38284144315718016;-1.0068525971334348;-3.0240156931600755;-5.1809449582504401;2.4477168548982919;1.4209078269608444];
IW1_1 = [-0.37795116316854743 0.3285608432914518 -0.6596006049473937 3.6037683005212129 -0.0054046460352947159 -0.47981821250569667 -0.47166144264964721;-2.7777622192877089 0.29409271759037869 -2.3086833885450289 -0.35738773650483513 -0.98895582776384705 -1.3070398180834335 1.2761648840933837;0.18462559927041111 6.2135812970243585 2.4457707952392314 -0.30825103744670035 -0.50286414197848606 0.40845343831189479 0.07565305846438386;-5.2364994007573413 -0.0057104893994397825 -1.2073757016638058 -0.44877986958863225 -1.962606469919846 -3.2622259283189816 -1.0612261424208063;1.2354264841236602 -0.58330318385894553 2.4215402854050669 2.4794139260377643 0.072331821982650341 0.39624348432889694 -1.6062383133767331;0.28992971249263083 -1.8567126314709401 0.61243998678857869 0.8153923013496861 0.14704329875030353 1.0137509402920779 0.86237564806602229;-7.7616663678447777 -0.8865836585412491 -0.31508636275367125 -0.98171119334929469 0.006099849925579227 -0.081235387365314854 -0.85922575059358808;1.0044508941287613 -1.1408372765310975 1.656186545912103 2.2961806467553116 -0.05307457076930279 -5.2844887580670754 0.45215238626558751;0.39097095394651271 -0.87878903167641453 -0.28684985739950097 0.27767223818857756 0.11428082535683101 -0.2324274122131329 -0.0033043636722981089;0.21138059152787306 0.48974780672621754 0.8287470537570395 -0.82610695800662381 -0.27348437583452406 0.5123925445680716 0.093452384513158557;0.95820752428863143 2.5926306718289993 0.37379406316256197 -1.9838803693097784 0.59426446653902243 -0.69941934011761775 -0.9468570929000939;-1.0005712195370169 0.76764832689240292 -1.4690470684761967 0.076878896212496592 0.79866589539712851 -1.4232098356542389 0.71813532320097317;-4.0251815699545634 -0.88580241204358068 -1.2736661616826459 1.7543630951222824 0.85097373086031125 -0.34684405145861275 2.227883734008834;0.66197028613682551 2.0248827326080874 1.5371456376747155 0.60034552796946727 -0.81012239466531044 0.2163856293119984 0.24069487335978018;1.6969718055923633 0.60553546579504292 0.23761760866669843 -0.72573897052095782 -0.03221376462094247 1.0110152517615387 1.1824713773249353];

% Layer 2
b2 = [-3.7727908149042237;2.7576986406831434;1.6003056292047215;1.552387423250706;-0.96074725681973572;3.1024485742401549;-1.2579872576723017;-0.72977480027073094;1.173860047619576;-1.337863041828343;0.49960551937154146;-2.4975408006352016;-0.56181730648236672;-2.3305490548340337;1.8180964544048113];
LW2_1 = [0.2477999120920969 -0.98052233086522245 1.6919245112952146 0.95013332073103596 -0.48823664331357791 -0.73799145993095017 -0.18184961377307726 -0.052753160016600534 -0.39971666366149472 -0.94690230784194163 -0.25168679522715059 0.25208919967316634 -0.1214564284118715 0.50602468791319932 0.86622777589083055;0.36385200684150498 1.5727423589545497 1.0998563641772747 -1.09803607228581 0.91445623571612789 0.87522184297816175 1.1844155914954075 0.03572751105812752 -0.40525013589840181 -1.3440458726969087 -0.0045594775831197098 0.23321492664179266 1.5436130219065343 -0.093587230459458493 -0.58919977526721523;-0.34724071143033569 -1.1541940903382069 0.44986128011049065 1.2294130549311479 0.70574024123494294 -0.17972513445518684 -1.5220651540181929 0.38906074836281845 0.83529009665998699 0.89072397288965532 0.015621072940902304 -0.25622077599524584 -1.469192472128384 -0.78352811690750113 -0.30238197552025736;0.29994764804902052 -0.31557735206088777 -0.064196518947964992 0.2318689990730039 -0.88091129360847198 1.6079136920814729 -0.93227244304638468 0.60296688402041188 0.82523001151699338 -0.74309867259887663 0.33528994938127638 -0.088571899422896228 -0.1986303719849338 0.35891372821414474 -1.0393499750030391;-0.65244493258637881 -1.3994361300251268 -0.76491539425557042 0.43109948097115558 -1.3334062751528977 -0.38932540599114068 -0.32025959862849313 0.49682381683660148 0.023344263235521426 1.0594513604735489 -0.11029057560991457 -0.06240934646373178 -0.24471023150267984 0.17319668900664881 0.5174240505685942;-0.68586175807683691 0.89084716608859693 0.92636000128359919 1.9693471466752657 1.9072107212574385 -0.3618761703008746 -1.6207034014166066 1.6725136999913748 1.1183201013826967 -1.0372277674572632 -0.24817829614330486 -1.4209063052078308 0.16774139019258974 0.29067859429552578 -0.58241138824897054;0.53968653690339685 0.60632314363534945 0.3991443973909386 -0.72576108341126067 0.39762812753405119 0.25675146865508158 0.29532989862952208 0.9289763047647811 0.19847665396749692 0.61701418786408413 0.26410714313989825 -0.36744894928695687 -2.3441826741307024 -0.44044081101143834 -0.91971736840206431;2.3804336713814691 0.67351729985520548 -1.0048047612221072 -0.78378556583730319 0.0075047980256141844 0.65816613089152209 -0.05745240789830669 0.98517667934109798 -0.35370481482713018 -0.5395036906238434 -0.24989010135422751 1.7042585300192057 -1.0535980979128654 -0.28834101684114455 -0.46495434304016064;0.42540249493989302 1.8414848952759884 0.57264159409394377 -0.35164252029083226 1.9871874117438872 -0.23993491749351353 1.8825868617346637 1.2324062854924911 -1.2850341038787834 -1.5471258405853205 0.077536987534422563 -1.1441911852079316 -0.43209031559216809 -0.21694378348410781 0.5754998879110339;1.8735781987126328 -1.8807220090050134 0.88731106587555986 0.02335199504942724 -0.66053850328452168 1.2516018741729535 0.65403212254869159 3.8980602796597061 1.6245731506019001 -1.0307930482424872 0.098980056166261585 -0.54775067348201545 -5.6330845680697488 0.59175317441234077 -0.89275434492339378;0.48711171800980596 1.2735603314686859 -0.24423210306350146 -1.3262343315305309 -0.37525811078527854 1.7205974041167509 0.74975903966781909 2.0490885203864453 0.63732197005635927 -0.097272035158804698 0.16990203495717313 -0.60218337469593763 -0.68176738630115419 0.046421884948105771 -1.5297463822948294;1.4506233318952066 -0.92642701061035537 -0.85260127860153556 0.23229178728044622 -0.085560164563852667 0.35541054148828416 0.81688767159779285 -0.033630058763590626 -0.56792873019903867 -0.45719649406308527 -0.2764177723483503 1.63217276582224 -1.7078437743057411 0.052560708784361955 -0.84774884115820803;0.97461717725381269 0.4153773661272937 -0.66499725042352775 0.047913909452848437 -0.17993199688650982 -0.21395949470170009 0.57376773805788417 1.6555176381570589 1.1412090578180079 0.67230347318752337 0.032862545010092947 0.34336814579716585 0.24322661031232162 1.1406838317654626 -0.24829578106387296;1.3232544641051336 -0.10038453257277649 -0.91864146402550673 0.62306226939265774 0.17942739118485057 -0.58659445963205126 0.37535311222143786 -0.42660424179353268 1.492131710965898 0.23389699597831504 -0.23706313746124902 -0.43648505159441475 0.54242150301892478 0.32105439391009327 0.52047263728197102;0.53737498507138115 -1.2681005066065203 -0.4892912975825805 1.3217819956783652 0.4320516597269799 -0.52138569318090511 -1.2689004098854781 1.5100956914596235 1.5876593977025841 1.0291121675649153 0.13322918108307347 1.001776657565624 -1.2513218239327564 0.81690602524276301 -0.24434254619152562];

% Layer 3
b3 = 0.81216586933050827;
LW3_2 = [-0.81100271518262113 -1.6789981517722503 1.6772681294561353 -1.4153197881275714 -2.6746506751340866 -0.71767911574406507 -1.7664464719728856 -0.99007903576019918 -1.7681711990887303 0.62787689181245088 1.2028848817764295 1.0885196918488207 1.8920291551807351 -1.0923778407310996 -1.3948828700650036];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
