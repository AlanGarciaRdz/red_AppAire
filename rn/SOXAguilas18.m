function [Y,Xf,Af] = SOXAguilas18(X,~,~)
%SOXAGUILAS18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:20.
% 
% [Y] = SOXAguilas18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.6248208876671995;1.8235305087405955;-1.6836209268390856;1.867454407434689;-0.22798355875874765;0.85628950075553445;0.23570938816727963;-0.092983676287145683;-0.054888755544650697;-0.39948941341512884;1.1809072112852186;-2.7969961830008927;-0.9927938454165357;-0.73493353732738687;1.7732822297913748];
IW1_1 = [0.59743365296197581 -0.28651073361565699 0.18485103417196397 0.33989121347990547 0.23561854872214083 0.32703536012997686 -0.53521526264743202 -1.1409577415837084 0.15514077257542963 0.58865526883507702 -0.13496425505292908 0.027021741915277842 0.4928156585913831;-0.68903821957283318 -0.55127551847520839 0.19083050212872515 0.21773042282971775 -0.36760156191436011 0.27233451797822583 -0.32717278601051175 -0.56771013369756973 0.61303643376622996 0.17096615811796004 0.3037440437864109 0.016572537921027516 0.022839836840608904;0.94719444289510557 -1.1704390548348427 0.023528856252884048 -0.057529857525502812 0.41287517254368483 0.36041679049754871 -0.22110990404406736 -0.35680485644917304 -0.18186474985172718 0.052894306718383147 0.63100403900717916 0.45331542129113495 0.16205286250813225;-0.0032433839960414323 0.45519861937962375 0.30914326893043798 0.1015222567513748 -0.10262093626300922 -1.5739260460690554 -1.5958527797907884 0.54880314213153303 -0.94001305384720024 -0.35925068418534661 -0.24644277005313348 -1.2344234318267864 1.2263032632184572;0.48157556433049131 -0.21111285008279995 -2.0412240382219213 -0.16835991051675153 0.24260315774923596 -0.31016330991996494 0.041196457320732544 -0.56035230637412925 0.028696109606357212 -0.63736566456560872 -0.55056301301199528 1.2522695058486677 0.78842680032548151;-1.2198800833362002 1.4838273132338418 0.61006659114091055 0.48394180684314014 0.66004755240692381 -1.2199521976664169 0.5189293853682474 1.1853523091881195 0.73033551862446655 0.021363910198017751 -0.21354534994821062 -0.32860674588165673 0.015987702792285046;-0.51809005794013396 -1.7302268479470599 0.10599338776254055 -0.15183317993267045 0.84435528941142346 -0.98109658763573937 0.91585117169689523 0.26491178408041577 0.19674431464023201 -0.002878879080490831 0.83225263606085287 0.21648351976285746 0.56501176111051765;-0.67808123148634492 -0.70921315717228428 0.45761733605301974 -0.5935960214680428 0.34704090997810083 0.40105092487709759 -0.24644189708011785 0.67933294117824738 1.1276501772389231 -0.08693843407654854 0.0080762526271643542 -1.2561297719403213 0.69225011628997069;1.7649620858605015 -0.2332134002664884 -0.94268747705494882 0.58392113098167442 -0.16156147313935582 0.25739479913451785 -0.4058970421288825 1.2128008417421985 0.63634056124592631 0.22551901192143339 0.16668614703481061 -0.71815825795912369 0.87024789710931438;-1.5735473861819149 -0.091639998542088152 -0.36525808417593481 -0.22140096308170837 0.27548428154127247 -0.019352157613396023 -0.071649797680620492 1.4964988347865993 1.0976287613235363 -0.44729981756648973 -0.38317289486953715 0.91682633617211295 -0.69186394363351955;2.0480791386647446 1.9116254364683001 0.092334837932509239 0.33225259107169425 0.11460970738153735 -0.3721362899682269 0.35250663993086817 1.3026271978339397 0.75400382458784354 0.063107817619158763 -0.38192296818591476 -0.59521947573016365 0.36728101721713585;0.0075391965639775502 0.33614751308350116 -0.38107319452896382 -0.078735770444487402 0.24745331884583938 -0.04332223813402919 0.029546206545679077 -2.4662026613829058 -0.11816539949610624 -0.12649950504810351 -0.015691499120078587 -0.86900812893602963 0.23888889214157744;-0.39535105356512967 -1.087037395494822 -0.052400894559437888 0.18228036345371321 -0.075804554558542514 0.0076035633780847656 -0.12083901393448507 1.1911486212351137 -0.69114543786109961 0.071740727539721633 0.22443450176848756 0.19223637119187045 0.4817779196486246;-1.0267870447528082 -0.15797152184718116 -1.0825564558650127 0.23658019581741144 0.35387575710819635 0.70773028335626642 -0.91144475415727655 0.89537822647967436 -0.78884696924225184 0.20441270105320702 -0.10873138721581004 -0.95840544136576944 -0.81695439276504334;0.61706692458671508 0.18661939204295724 -0.11207195628188465 -0.96084455646143185 0.37811034503806051 0.31627819108568417 0.16878996220762132 1.8802403947730228 -0.92102137969970899 -0.32149041683635426 0.22278156157530293 -1.896572817489047 1.0790554808301753];

% Layer 2
b2 = [1.9472113767635941;1.5621700045853915;1.4868390490724051;0.98772774581026013;-0.29092151095588376;-0.26471188399254342;0.18993944944278493;-0.053304419006720116;0.091186823533774081;-0.45019492573024972;1.9052205368818409;-1.0964862799571276;1.2216442532097385;-1.1004809381742355;-2.0638957107646903];
LW2_1 = [-0.81919417634542835 -0.4042970715938301 0.30633070058770767 0.11347268728864929 0.38235935751420952 0.46918422420347999 0.0051694313571497008 -0.98973478068496556 -0.7542926394259033 -0.30285793910319836 -0.12484701508119922 0.0076326388386311686 0.37618904962508726 0.97777266048671185 0.24224666863126709;-0.33788228240466023 -0.032099762716369606 -0.16947789499350999 0.088432466667370271 0.022937255744723495 0.3076645724634447 0.097456209935810403 -0.44827377185936884 -0.57493052584665927 -0.047764772271378625 -0.48201218969039028 -0.71889070133533928 -0.71148719921429415 -0.44833768647537148 0.68011928598078208;-0.1353029011087678 0.40126321477575017 0.39394908813566654 0.42421156876595628 -0.30469406341299843 0.33446933333366952 -0.10680285325639452 -0.44934052200556118 0.20171836339768182 -0.53704707389891437 -0.59791375330505081 -0.40472934601243066 0.47365012299593962 0.19108372402321114 -0.48841111865876102;-0.35151353523496354 -0.51677384759826483 -0.62451496976024501 0.51867361421929192 -0.75355316196222477 0.57578779856538165 0.16873975264742436 -0.41895530137362497 0.85251626695119764 -0.050441072494609773 -0.33275040211542284 0.17556879379241444 0.59477939819767733 0.42709325256047415 0.12282233434257864;0.2828547007249681 0.97868335727338074 -1.0120352252647995 0.15753180976531816 0.028590608327381042 0.40333628477528594 -1.1950314029647242 -1.1325223241501288 -0.64969017438102039 0.19314507955614932 -0.83932354657509189 -0.065321851027638336 -1.0641502412133268 -0.053670574157062931 -0.014379497673217681;-0.41317947858967269 -0.13609659920923151 -0.20969238711491758 0.22264650250940271 -0.097776553187029186 0.86468227787355012 0.1341271198566106 -0.018430518155781811 0.8533866935676615 0.85653958202329861 -0.0067667743476791317 -0.75601154059023012 0.54693378977539797 -0.86744583519158303 -0.017877795754827064;0.13057154610589641 0.88455567534919255 -0.77529121453962901 0.40009600201711842 0.056454608893686468 0.55486634173396709 -0.15343365130334627 -0.58015627603479603 -0.15872815503228602 0.029433622811312003 0.32450643776182786 0.16623234697621356 -1.0857253225092824 0.061710649285550749 0.32405890927184755;0.23197137611093102 -0.31733760377381653 0.72028163470645357 -0.38590694148833843 0.075677736327399617 -0.26862922096601061 -0.15384469136357631 0.43497573678356305 0.12503459776251818 -0.040723307222289791 0.41359520023175378 0.24400244616130456 0.68727704572048576 -0.41490487640077101 0.38800620174179812;0.65214436384852414 -0.32288285124234428 -0.10460736794679371 0.24764412621897777 -0.1476427845842016 -0.3193500232342491 0.26476001654843534 0.16611905302515056 -0.18500238160892604 0.032412352516105303 0.27223246070626295 0.81562821958859233 0.37988366038935883 -0.15296394961468196 -0.29895043769035573;-0.26018869872815803 0.21304761148075346 0.43668545273481807 -0.18990946012797599 -0.48007350056892206 0.54834963594586816 0.12502051489117275 0.8091713369712783 -0.3926606957481571 -0.27644529528631734 -0.052231453130078105 0.47638012361670784 0.36649955354991748 -0.2089377965686125 0.82947493911171044;0.26088353467448011 0.79632710066041756 -0.30525151492220748 2.7080263337154813 -1.445928773552223 -2.0055950388915162 -2.1501203000203271 0.23061850547184176 0.43594535867871914 1.7107278891787083 -2.0231015262716219 3.0175411251335018 -0.13135341345351992 -1.5319824022205208 2.6086539747787874;-0.25911518448159532 -0.0083727297840151191 -0.71893728919801314 -0.46614213963266898 0.33952095145863331 0.11814894494938924 -0.40659789357863085 -0.45693462806591006 1.2544254550274418 0.54442533961803208 -0.37903903526032579 0.41726873457466052 0.077218588866270241 -0.26301305693926214 -0.33048881224596083;0.40703011729477195 -0.030274508057951025 -0.32420485333050697 0.34359236210280653 -0.051930449683620594 -0.15552005920033118 0.33792178696928798 0.60815623076174097 0.89619482348765556 0.16475622644237387 0.72602686103072434 -1.4294823003094452 -0.24249444766089234 -0.12751791096689899 0.6680666562488129;0.20562182014516672 1.1113066271073062 0.017551002115507114 0.62549005989228368 -0.12098401681095899 -0.17437369487433305 0.12661103309381361 1.0205548819404573 -1.1174111015688213 -0.45188681752188842 0.10651720843637408 -0.24559892098515668 -1.4630335939632535 -0.21917040089499701 0.34016247744581979;-0.50311904929479101 -0.031194874753008705 0.65734791621636146 -0.071185778057812926 -0.78615167797188423 1.3140000668234608 -0.0279141733950653 -0.75539097678837341 1.6459979571574177 0.73219701109360413 -0.63212893116101354 1.1977211731151707 -0.28081800021599806 -0.45448746832661446 0.058252020222932036];

% Layer 3
b3 = 1.0125727861836549;
LW3_2 = [-0.41837058031644314 0.79281512632001916 -0.41000517630175881 0.079191043332123179 -0.25802703304160673 -0.087744326634005873 0.067710098877624858 -0.97216562253728167 -0.31192604977971494 -0.046545131027057679 -2.8132035000464573 0.17283522590078676 0.11060348533677182 0.80350509175773188 0.92805427526492723];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
