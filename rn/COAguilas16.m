function [Y,Xf,Af] = COAguilas16(X,~,~)
%COAGUILAS16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:20.
% 
% [Y] = COAguilas16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;0.281968137600451;0.304971027752364];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.1878768961227917;-0.5050375919132124;-1.2159822048780973;-1.1928024619249946;1.8188226076388398;-1.5352556380117672;-0.54154169093250959;-1.1982244740610644;-0.85063209695462105;1.8973248099647992;0.80508076005132634;1.6713582767421267;-0.55879035828522949;1.8131420212486595];
IW1_1 = [2.2629475611019396 0.14563017156221458 0.27989086711660666 -0.053433743190775443 0.16209777597070352 0.30980996883989226 -0.7624911087687043 0.33164971029442775 0.40604405223619072 -0.27219456500924355 0.093201591266384609 -0.10995944535545414;0.5252918555145879 0.71830559544152561 0.99484914125472224 -1.0262261488910722 -0.060841219993767785 1.0667938267850912 0.31482464236560948 -0.11509197467936969 0.3304247287723695 -0.063308551361749649 -0.3988610004195498 -0.14347138897672193;1.2817658440220903 0.64527241985718331 -1.3191522365065058 1.165950531323573 0.49805740734013138 0.19495895884138847 0.24320576608331301 0.057149958760833716 -0.4637809007574355 0.76911121872641131 0.14334429159126313 -1.1101947900245421;0.1010374793260701 6.2469230454475984 -0.53254519586426718 0.94163572603851009 0.046158657819486235 -0.057059342412810153 -0.529003012977736 -0.099562445051981002 0.22240810017043905 0.12888136015366322 0.42519650938457298 0.17224488438245947;-1.9428771554193198 0.30841324110487073 -0.80351532171405982 1.1232805826831296 -0.072378269617955238 -0.18242944124397931 0.87592883186841197 -0.47735574723082408 0.075250429420650133 0.1656519149715194 0.18381427485057047 -0.28593639553568101;1.3643659879027479 -1.9654981276378596 1.2449509066889084 -0.21220818130829122 0.015377129440897726 0.30526670426691493 -0.64198869974900163 0.58636665898029861 -0.31701822410594338 0.3267379333800039 -0.60829555097381283 0.38104691507434807;-0.06488468014612235 -0.23466975176280602 -1.5168784121565779 -1.3363687710973045 0.28838665244665684 -0.93562357364914006 2.3029527838304977 -1.2014378063827083 0.53622601598320785 0.060693265819928233 -1.0399255404597869 0.069639461940088784;-1.0100402363393164 -0.12935004914074028 0.34251964705098026 -0.3418846954797774 -0.31120076909287009 1.5063606357038206 0.28351225777502997 -1.1054432243058763 1.0368941609406819 0.17748300220899543 -1.2768116962048506 -1.5704131891501678;1.7773907472942172 1.2421609481083844 0.44748705456240412 -0.39055271753281801 -0.10942610742252114 0.27505292820154459 -0.63653003913917283 0.89445451367285855 0.097806941269146602 0.14373495506138251 0.14834369388396962 1.1813072283137227;-0.16559705827660212 -3.5953306996016696 0.38516036309714341 0.48605209570542574 -0.65445764574150722 0.31201729322651839 -0.96593478989031512 0.20998315369196399 0.61732837615766378 -0.18820880717859531 0.29135745860914319 -0.084875475190624244;1.3763382656117633 0.40428412333242414 -0.4678976487780459 1.3729649221554379 -0.47033037426005919 -0.8560425011997721 -0.71790832084676315 -0.2193320659029942 0.50464815220232806 -0.24864901203012602 -0.075656463898548854 -0.18881576935616384;0.25300430149247788 2.4139510831909421 -0.62163332524661707 -0.34059346607071528 0.36279840469149888 -0.56762274417377845 0.21646626968090596 -0.6585985409569215 -0.24422067655808513 0.045896858814146201 0.10012309496017689 0.14261637931434254;-0.9645686445208671 -0.084224865655453063 0.69106071820845316 -1.3754338394448715 0.84946413605435622 1.1243869923342413 0.61599319318521428 1.3762153967693553 -0.62131902589093724 0.088808118098121128 0.010719717218386011 0.44234297810050144;-0.72257684341444706 -0.21449778316406548 3.2216793466911904 -0.13028747017485581 -0.34655699028292342 -0.33629724987289888 -0.35544644380533691 -0.021550221804688734 0.32851689412845753 -0.17048653357647772 -0.0023979412139871932 -0.14643103714999095];

% Layer 2
b2 = [1.7504243919020641;0.69185137223682736;-2.2048268957801098;1.0456097103459125;-0.87995070047131907;1.4593063181349455;-0.49485146882772779;0.83887537397427481;0.32964820067325623;-0.53441136865359318;1.2940337043797165;-1.4775459212278257;2.6722454853412221;-1.7837895538422581];
LW2_1 = [0.43380635024198416 -1.0200180769940168 0.7230689004591313 -0.5134193772469251 -1.4624100900775376 -1.1628706532262738 -0.73084218245776666 -0.10855143623600605 2.1479277273044195 0.36599406599625256 0.72423909504290263 -0.72162226059694468 1.0600125803582978 -1.0095655132844132;-0.9252611726705241 0.17937292346457689 0.61533482984219667 0.37117604377655056 -0.59041533347100805 -0.70251034743976204 0.11142031089325068 -0.1955955617816002 -0.11292793062765577 0.056388944175228259 -0.021824741192319402 -0.23690139142301142 -0.20600855561121414 0.63843928243175108;0.73291028154902693 -1.7836485875440646 1.3560931443544246 1.7948666357031897 -1.236393292416595 -1.1001500927646859 0.76110236320966873 0.13067124365564498 -0.29820481823856376 1.1347769252338546 0.18248965041454157 0.077624487081255758 2.2385164782244287 1.1375463280271074;-0.81982896371771574 -1.2292454379850977 0.017681631782197581 0.36409631661750397 -1.0086009475393538 -1.0836371940368283 0.15311523759430121 -0.13327725326819306 0.90491805119250057 0.095898584028429046 -0.52551059588060955 -0.67717969993991056 0.43972768081197711 -0.27658001132355481;-0.51815204791339986 0.85988536370268132 -0.76118824717812328 0.88768338211673803 0.64549420189149131 -1.2970527288764151 -0.49196030601504798 -0.011784892874039412 0.25640941270761286 -0.36893101696978081 0.78788191643981853 -0.0017094939504863176 -0.56373829878476922 0.22983693817920781;-0.19706845389561115 1.0397204380253078 -0.39521269915299995 0.29267632637833063 1.1407400092774549 -0.68576432189904424 -0.13257915949195193 -1.1652941353345274 0.57816163558544131 0.79170559544409236 1.6076440240178085 -1.365794780608133 0.65847253516087256 -0.7367117008478502;-0.5535208206502138 -0.75953104291157103 0.59234136734811293 0.14656252856288859 -1.2057844123969583 0.88069299925196087 -0.071414396216961953 0.4094615778284888 0.33895550474475356 0.63539207205688564 -0.068949737473630424 -0.29706012940788362 0.30106116835895658 -0.59606904590100085;2.5679765849193497 -0.53306989801570781 -1.4397573594965383 -0.106518451581542 1.1402220945303172 0.66080498095872409 -0.037846158512705397 0.24159987406386615 0.2846520489470602 0.12358972952593875 -0.66327188867876274 0.31156173294346345 -0.04369931635861065 -1.1479683989413463;-0.59926265629172204 0.62013577415276777 -1.0402157753368995 1.7111180665927772 0.11236892605481551 -0.042178861654063322 -0.18905880463150174 -0.15005626465248328 0.092639930458754668 -0.013369416777046155 -0.28176144951801824 1.165267654112691 -0.93609260565813246 -0.10671585338433018;-0.552033019537022 0.45521059498538635 -0.58700230758820626 -0.45841479083733405 0.62235362953400075 0.4200467640724837 -0.30293563161695236 -0.25368659659610576 0.069387170443247756 -0.71603810513984678 0.17022541926649809 1.2587219398095846 -0.47586579767252818 -0.35998668797159455;0.39798178694925396 0.65875669165601702 -0.55864530341821994 0.57897490318402978 0.16453043905074161 -0.25328778085273262 0.66096638807126762 -0.16426742505337186 -0.37628115292541015 0.19508407975172914 -0.32963064363131334 0.46569096774188223 0.48336503916690954 0.41803154754669136;0.8301756963280007 -0.49614995324167455 1.3823575546189506 0.11219985845503819 -0.69549315185438976 -1.5761293686501352 0.12075024837196711 -0.29331301667376186 0.36487630499073292 0.78485870430155302 -0.94195623133248019 0.61823445270538802 1.1984837602896377 0.4973365856789862;-0.045051522739646008 -1.2259567233359114 -0.58658099820895082 -1.0180944758523727 0.2829282728949013 -0.15411103801494577 0.038287770555797754 1.2478329823199157 1.4051725342281656 -1.187595628368407 -0.054676975912086728 0.030395471168279568 0.71939077709069121 0.67631266365861809;0.1773395534992806 -1.6912875043398845 -0.59860967210889093 -1.0015088394089784 0.90816396430810808 0.53124195216896386 -0.11876258245768802 0.15316574536525318 -0.83537203379362546 -0.43344985862036095 2.5777213997533308 0.011804129266170277 0.19392964241551158 -0.40702434858673059];

% Layer 3
b3 = 1.4621413003944608;
LW3_2 = [-0.12468808435861672 -1.5737326533524736 2.1572319830932893 0.18165704639875749 -0.33709804441796115 -0.39279185014256512 -0.40401537874304938 -0.62020079798127037 1.1274621983142175 -0.88675339416760668 -0.31616499229137024 -2.2453635015307309 -1.1109734802215521 -0.12066185516360477];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
