function [Y,Xf,Af] = PM10Atemajac21(X,~,~)
%PM10ATEMAJAC21 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:59.
% 
% [Y] = PM10Atemajac21(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00968992248062015;166.666666666667;0.0561797752808989;0.00614628149969269];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.6869218877976202;1.2714603006180947;-0.45514497816856353;6.0568103944868152;0.18503501298428879;0.90899055179755284;-1.4304742241027151;-1.0623677058915664;0.46357928179860536;2.4078654926293783;4.1221888387998202;-0.78731988917033124;2.5758124311998909;-0.14169922514243521];
IW1_1 = [-2.6396379003954031 1.7724035238484077 -1.0797163436079162 -1.3902166282056521 0.19283514678709585 2.737034396146294;-1.1304299516299008 -0.30053306637721844 -0.96674118650625906 -0.98171714209967176 -1.9387081643055197 0.77147283317629811;-0.11291413031372273 -0.67044062897518297 0.52457073507417462 0.20164820076145457 -0.43905167396016315 -0.18145987552550191;-5.2400439310250473 0.78944491336702705 -0.7384122010266434 -0.069062145730082347 -4.4021638161876933 0.48493131192515193;0.45881893268096963 -1.5487688639232842 -1.2373640722769104 -1.0406711591979401 0.66144278164632908 0.66320866761549513;-1.1895703238293029 -1.5330613824214869 1.6185585128616846 0.28491379565015695 1.1695968627858637 0.053131374286563643;-0.0032671488674924365 0.86388615538875535 -1.037301225356617 -1.2211375271240708 1.1970541166479391 0.96707979678108369;-0.39389147115445367 -0.95238068645617835 -0.20999987561552588 1.0595474548939114 0.54132370591494383 0.26990263356507671;0.47935356306067461 -4.0703550856941231 1.0746414981987547 -0.20094185771579628 0.0060441172259165822 0.23426002091073383;1.579470692715303 0.75912327805313784 1.1646532269733267 -0.43604756815373397 -1.2769869857010114 0.1309179801375705;3.6269100152023777 -0.062488000207817918 -0.023998656840861304 -1.3745991557102537 -0.68987530664021279 0.16959864675133723;0.098132169140035558 0.70627194494550793 -0.76312861088825379 -0.54472765961923264 -0.46542163587184587 0.21606346807084803;-0.064372545458707658 0.057442588229354268 2.1496365064439322 0.2662836763525947 0.1272699899645485 -0.077881077927513434;0.31183551708767709 0.034073146697899521 -0.041507349622217346 -0.94684071843313744 1.8469771047501931 0.87895143439343804];

% Layer 2
b2 = [-0.58301144255911419;3.5214772256894005;-1.1739507344808704;-0.57608673429115198;-0.99023512381122669;0.013150582131096586;1.1813236461697845;-2.3585459336241179;-5.1954721618721136;-0.88648299684697718;-0.29660091926665855;-2.6327694668093331;2.540742403894702;-2.5294977067017435];
LW2_1 = [3.6965503445544292 0.78892197847552281 -0.83253525787712879 -2.1694057138611544 -0.55985309852475229 -0.16155063343413528 -0.96804871261112901 1.9829101004641276 0.43901241945733621 0.21398801726873809 -0.459611698251298 -0.61195072077202328 -2.5542818427616223 1.4929681748187293;-0.13709227025615706 -0.63707454884216119 -0.18466980912409167 1.6107467187755433 -0.57226195509703581 1.8957933078807176 2.241430766841042 0.16620269911927626 1.3568486212728446 0.57319540325841811 -1.3041547392177413 0.96445025703393117 0.085377123941432626 -3.3116055675917497;1.5194814523164326 2.9618311190383286 -0.14994464268483029 0.49192839730665355 2.3571833616618316 1.3385368467078331 0.48719002153219726 0.94970983591242319 0.24802233486533248 -1.4023985758311439 -0.63267664130630386 1.8737817861104462 -0.48923447305608991 -0.90401542914064881;-0.63326458216455128 0.42486246499020608 1.4010521575437318 -1.7542285829226123 0.40664571985758385 0.6911788553360011 -1.5260488207765071 -2.7162531856973051 1.208378212463538 2.8515189624477455 0.49615492073029682 2.384148402519473 -0.31671657675125642 -0.42557127895664421;-2.2759248892968609 -0.13528224235067343 0.15733716007789783 -0.44539211202718532 -0.31817407985969759 0.43080204286316387 -1.7284120708992192 0.12155536474816386 -1.7497852774692992 0.21040188392243989 -0.62356643946899837 2.1088377508592653 2.2549357338652261 3.1773429554566852;0.68945234359243579 -2.0868968897355478 5.176438555663669 0.64391718990111846 2.1522755277818475 -0.89702479274593627 3.1615697402217982 -3.0361010559995187 -1.0349459237519665 0.40984650415248813 0.48327917490621813 -4.1405012256615308 0.016968785501587688 -2.072196492303525;-0.25278225723810799 1.0519445128613636 0.068284567908958205 0.038874072308009017 -0.29267630359666175 0.97646513633073695 -1.1125346733050763 1.5005979963939222 -0.24981264390339275 0.89533901473949484 -0.31034517162511593 1.1002796316845238 -1.8045680516847948 0.76803694432137104;-3.1805955507130323 -2.7386165478462794 -1.8942271102615107 2.0890263181068693 3.5840715028897474 1.2171795127306486 6.3259798526076496 3.4081602101881039 0.65296399718437692 2.508964890343917 0.51453181197091846 -0.054697748367641436 0.78202882401406359 -0.13790505846524886;9.6152206264081155 -0.35995295522576309 2.9587145117828659 -0.23829243448328979 1.025683807237866 -3.635742861252075 -0.25291260628228757 -0.89911293201509701 1.7235362005328796 -3.0116999051818296 0.20483540827479751 -2.7449312560421402 -0.48430651362764088 1.3172797968117744;1.0457818115349864 -0.67937460008781425 -0.80270264122102153 -0.74052857714239806 0.68121547895937751 0.027172064508748147 -0.06807088857090618 -0.041338464529574528 1.1390332832919499 0.14882635358233323 -1.8526871994950871 1.0800780906653649 5.2128344210048017 0.5104457413624417;-0.57318185685334888 -0.52700122134502769 -1.2533502732649173 3.8611255433419283 1.3031098740694733 1.3290487095888956 0.1406665650125011 0.57997821425393936 -0.83240772240895844 1.8360363027426669 -2.4782587272913092 -1.0142462255386586 -2.6327096537948158 -1.127386000873732;-0.064333473398835189 -0.1618746947206223 0.49019956240444351 3.3378178607152686 1.2295235796060013 -2.3503193594646921 0.25829883917860824 -0.76315444089387408 0.191593823285646 -4.1026057504945506 -0.01855083114829241 1.1965746789553147 -1.975233095060775 -1.2547480806004225;1.7999736419607966 1.2561262316832771 -4.5447675496206106 2.5817870487833487 1.7919005019497027 -2.7380073994570115 1.0383025671024368 3.6155624255054675 -4.0697902095678629 -1.9078708585028266 -2.4564802714253524 0.29363834301468628 1.5938452748588827 2.6426510332656736;-2.3832820814315139 -2.8537858551552246 0.27618229823551749 3.3432358803271707 -1.5640872213992518 0.76457894375803293 0.18297789311328008 2.8113878330840856 -0.53719123032909211 2.0378581605791313 -0.43409607271184414 5.3500908437838115 1.3608247150118697 1.4209960848388341];

% Layer 3
b3 = -0.077883517457054172;
LW3_2 = [-0.092533418883763402 -0.1386452394543011 0.00018086063221454344 -0.066724298296752887 -0.26198398223515668 0.29105810248311925 0.53916553432501413 -0.016717417148888213 -0.22819184614001828 0.40444615552382635 -0.29804937960194 0.17417204702625136 0.13883576634660719 0.77988902145990258];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00968992248062015;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
