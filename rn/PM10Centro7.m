function [Y,Xf,Af] = PM10Centro7(X,~,~)
%PM10CENTRO7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:03.
% 
% [Y] = PM10Centro7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.281968137600451;3.74531835205992;0.00773694390715667;45.4545454545455;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.5291609403311295;5.578026607110151;1.8849110100123203;3.5829694712686759;10.349150988917048;1.9072623444189938;-0.32158469183950089;0.46837223040859377;1.0429039206519344;-6.1402556415459859;-0.24495111030839523;-2.1655639572101344;-2.3963934731584127];
IW1_1 = [-1.4581446108706473 -1.5412392183632575 -0.15659115275448085 0.18075986111231393 -2.2066521125147416 -1.2806782425434229 0.77398895657683631;-1.7884182092625827 -2.4914067029337366 2.2256899858616648 1.2897823328657088 -2.249430167849495 1.8469116563520454 0.59468163344468872;-2.0162768544238503 -0.51303840377235888 -0.82421602317461851 1.2789819593966074 2.0811524631594005 -0.98248502482106903 -1.328425439565518;-3.8876685262499073 -2.726897486794341 -3.6445500430827908 2.2778824954281358 1.5472090574419739 0.2103706437870175 -1.7244493117936432;0.67167536262649319 0.12611925305772956 1.22211608133306 -0.29589991280614047 -1.4846735872996115 10.78318144685346 -0.35664361838815517;0.34747168082104934 -0.41580988838070715 3.3673933170185606 0.47547780813934465 -2.5976138407274352 0.18757401382136407 -0.38102793831503889;0.53152839981505318 0.58739221113873108 0.20737590163262565 -0.33687968253758188 -1.1210732042382221 -0.5845045764572061 -0.34537455571030878;0.71887612203831652 -0.41871729557202891 -0.22491264064891342 0.071999686110066741 -0.23870584156789326 0.59153416936254921 -0.01839489134901522;1.0041489270112196 1.7240885377155784 0.25286016081820806 -0.071117848598124506 -0.55531715959130157 0.60387078786951964 -0.69787458110076428;1.1146217539452139 -0.66168638323342088 0.20460781623581312 0.44452600461629749 0.64877164425614797 -5.4305864584945249 -0.32270326711739111;-0.82709143328653012 2.2298428499401513 1.4360332827482132 -0.54990859197047703 0.26389957706897488 1.4239996075572869 1.1745193203011701;0.11247486371501417 -1.1791289336798059 -0.20017383602253147 0.44120040750257633 1.7348181781704866 -2.9560780272239526 0.35645134493106223;0.72874866919771319 -2.8605591013874254 -0.25111463776854481 -0.047526977000294353 0.1423462194689068 0.50818028391532943 0.0038789943227335155];

% Layer 2
b2 = [2.0579934715564514;6.917301910448721;2.0275815141676072;-0.9180903361556193;2.5671033004909662;-1.2991508642003509;0.1159275688849548;1.4187327330568928;-0.63436114218930884;0.20872439210872268;1.0168230928810469;-1.0551113923030979;-2.471307160681389];
LW2_1 = [-0.27099091014334709 -1.1792599953848903 0.30886348445708328 -1.5134682267777808 0.21310548802794682 0.11345076275299917 -1.2134710625067686 -2.5418000443032982 -0.40001207339557254 -1.4120373695437334 -1.0514900051305256 -0.25447183824730574 -0.0066829494664337854;0.26612851127642023 0.93084634607805228 1.5528787724988016 -1.1138764536113335 2.5451605322102289 -0.20120462466257533 -3.5618335265306937 -2.675767774852762 2.9581936517752236 1.2572300793674498 -1.2622602788215804 3.9188099316384255 0.21512323091288571;6.4035581502126453 -0.18378740156002824 -2.8807279904959571 1.2937742229802485 1.0629450807028811 0.48415601786885099 4.4087287640548576 -4.1239614089722014 3.7216097994634962 2.1601059865486207 0.7762895781282424 1.1966503698219939 -0.6362394933513007;0.19743479768150662 -0.52633898912709942 0.1377460544192482 2.1191812640493488 -1.4427629581954182 0.20161689114727349 0.10172226369050633 1.715036380563977 2.2551542737219576 0.016796131629157933 1.4215608258722652 1.3320706717774389 0.91037634376008802;0.084452690932112204 -1.4800393838479793 -2.0371225621992535 -0.58402444779617391 -4.6037329641716456 2.5050485196223224 -2.0594164681429401 1.8071392912514477 3.3733674294855214 1.9432898342711313 -0.84853132629574657 -1.0647431805547669 1.3497559676798567;-2.3457818426516224 -0.78618076858219366 0.051884490842302067 -2.503201266015957 0.25901227557106643 0.49772025581876378 1.5766504838118485 1.1830279360863651 -3.6547305878796372 2.1392065223352144 -0.48147550930974092 -0.16266936626502276 -2.5639151045237707;-0.53979071495420983 2.1137499256445644 1.3982566957987459 -0.98030042125503569 3.1215880344853302 -0.96110992453901889 -0.56562652597806851 -0.061025581213314084 -1.0545037317453758 -4.7365044477227496 -1.264710741846139 1.6749734611247169 0.10728768711004563;-0.27259346523984346 0.53504961292311659 -0.12219880438008798 1.8427632791107069 2.5649866993494501 -1.0018877378052917 0.75517408973817268 -1.6286199886991932 -3.7318736200141669 1.2651479004771351 0.075044379886208226 -0.30424397475050635 -0.33673258953167967;-1.0095218143908389 -2.3533990445479618 -0.83447138762583717 1.1896341081625452 -1.5699561851742949 1.5273592912792167 1.193904960422735 0.54037930660023337 -1.7638637920846825 3.4421277338244622 2.7599604181039501 -0.8191088303287728 -1.3682141242397379;-1.1899411198575707 0.48842257137071093 0.24792522222500213 0.020844752408644571 -0.076690705420491084 0.58330613629030093 -0.13778601265899013 4.4309749017489848 1.4682181823809017 4.1151494735272136 1.0440841492611341 -0.91635288951707539 1.6856660531862575;-0.82887896801995098 0.13006614563079183 0.46528992446679251 -0.11921011756205731 -0.14345498513507013 -0.42142344266413018 -1.8367406343886599 1.5333745146271625 -1.1786735606707597 1.501461181827664 -0.50636612590302255 -1.2652220770862121 -0.84488287449975941;-0.40311084874983483 3.898320034021066 -1.9239958836025415 1.9483520565209576 -2.360395533474716 0.93945856930047211 -0.56539879755826716 -3.6096572229045867 -1.4154567644711669 1.2452269988153253 0.31884529690110452 -2.0126903220580705 1.7337419002706509;1.1690431945080664 1.8532555745188823 -1.5807613786269505 1.2550416944006753 -1.1408532942703828 -0.7909827701817963 0.47869903796109298 0.9894553601611259 -0.13188297803037394 -1.3247087646694047 -0.86408988812799103 0.080043929081161161 -0.56591021591032542];

% Layer 3
b3 = 1.0085865055916168;
LW3_2 = [0.38996989621637157 -2.296541325372067 -0.17865408595052867 0.18577512823309369 0.1152885923065063 0.25336496940095843 -0.50449286386253789 0.38939715505233324 -0.97714950159337177 0.1806889615264208 -0.32326997179973282 -0.14202832944487856 0.20537100147733195];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
