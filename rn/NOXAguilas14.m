function [Y,Xf,Af] = NOXAguilas14(X,~,~)
%NOXAGUILAS14 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:13.
% 
% [Y] = NOXAguilas14(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.8270133210176431;2.8521217620969566;1.8114460995139077;-1.6923957074690903;0.82929002441894151;0.75926203695984507;0.30569444115635208;-0.42836837221724805;-0.85675689491065266;-0.92855319676928971;-0.24644059293786544;0.5598671233542013;-1.5151179475375083;1.5948525609134108;2.3251738956908521];
IW1_1 = [-0.061956591015509474 -0.73142451085345095 -0.056176787091958752 -3.1737827870065787 -0.39921323685281151 -0.087465326264034624 -0.5107132421122007 -0.38586188958157502 0.15039203039610621 -0.13257369654493978 0.31532295273796151 0.12025610470644622;-0.39283189270868113 -0.47749835165147125 -0.40532914117226204 -0.44079913435651108 0.37545763221418427 0.40884162589074474 1.466993041372239 -0.045859935630747597 -0.23267923989128209 -0.48099714031009699 0.1327802346411282 1.1559405339513464;-0.25972158065912898 -0.89254971087956259 0.30092266212338659 -0.043883040061516054 -0.47334877961425204 -0.65622356228732881 0.034963500442817125 1.9972414473868381 0.18436984815050134 -0.1195598744126236 -0.49469782817990388 1.0794057306637814;1.7066333812289809 -0.37225577464017878 0.087921770201407234 -0.50692354132507522 -0.55257513785607526 0.91235547710944165 -0.17109657002928863 1.8078464697805425 0.11312354309445335 0.33208027506300802 -0.54962145988642697 1.2698640426521262;0.28279087656748869 0.92327749408820792 0.25401399525785218 0.29676538800309626 0.091806069548640096 -0.88411842674979024 0.64342766506312266 2.7037614843659323 0.36490388500505566 -0.044040321164938966 -0.51066790515794835 -0.17515833023831767;0.80414689212897239 -1.0156367419416323 1.2247659986008583 -1.1137569988691032 -0.60117416205752416 -0.76465186759565751 0.55900512921248235 0.65181073557573976 -1.3361774872314391 0.88683858614324107 -0.91160000731413515 -0.46925052158771002;0.42018560256951143 -2.1345369530847402 -0.012291038962280093 0.21362511330519249 -0.41277498742225927 0.30101011817551226 -0.59300646886480812 -0.28814496156366293 0.17469089919491215 0.086333639310414906 -0.31833279405001735 -0.15929650828794267;1.3586361396822373 0.852599992655797 -0.58363797899368353 0.25143967450880089 -1.2631543522956954 0.43105962368022338 0.24213408641633655 0.54916620080443368 0.56399090086278569 -0.84395997466047257 1.1267865329711777 0.52979812466133991;-1.5211984356517072 -2.3811309217876913 0.26252967465359273 -1.163355025540165 -0.58818765073636825 -0.19034852949150408 -0.43055360260151093 0.92854128742104591 0.28205902185134057 -0.28036409670068574 -0.10544295274278394 -0.095342121693016882;-1.2363611247511874 2.0174472850139105 0.32592027150072911 1.1157223437223662 -0.53063780452715092 0.35455992030907452 0.6889242913219602 0.035195041333662129 0.66545298732677094 -0.82398572425463845 -0.2113146370063452 -0.55327469933203643;0.24140706284597369 -1.4278358362155228 0.8133195298702377 0.6185659590155812 0.1352175210925454 0.11158369441656857 0.14956480693232344 0.41883351019186155 -0.077744866028608584 -0.41922746083489576 -0.36677039238179099 -0.40817673961681206;-0.23673953245476459 0.047378046884127785 0.11290096085410284 -1.1532645837184285 0.73854878669051727 -0.45718472654421421 0.12582255057231762 -0.96989145009766364 -0.087935552130112463 0.38986895253394144 -0.39084421186993706 0.11240583021340063;-0.15257843444672781 0.39243054023298457 0.54290059690541492 0.72301188469484723 0.74158488998038596 0.47509109673160654 -0.61889921855035401 0.44714506332919135 -0.34209646642044594 0.71789323480800815 0.350105387753535 0.43515727532939091;0.46133820572340611 -1.7525833794178998 -0.64791419773664083 -0.86564536575432194 0.062319400062490538 0.76475449204239998 1.3472405819940059 -1.9520223776966688 0.26979016159800989 -0.21735994639492073 -0.40891977167236726 0.87626425644796213;-0.20130269869833259 -0.44043181036162143 0.23285148876609085 -0.1869777825904507 0.24142769439392212 1.5920704617470833 -0.74251916010869989 -0.23150583234366312 0.044321833404721206 -0.56188587932434542 1.0312940063247873 -0.27993093874624092];

% Layer 2
b2 = [1.8825308193958592;-1.5692411093947229;1.1775106177317605;0.6137237673971202;0.98702986239169976;-0.79368444051159359;-0.22873397626704811;-0.030046737689013926;-0.85006272316473175;-1.4956895569338895;0.71103800365818015;1.1507147133127829;1.2061931931237988;-1.309227840351987;-2.1215610997651009];
LW2_1 = [-0.7480072854771983 1.5730315210063106 -0.28605064637672989 -0.13403508736377437 1.1582728688272976 -0.45864609242620336 0.91613717147241036 0.11174899136307569 -0.8588472137997053 -1.8368345727813913 -0.25643111536407082 0.023254603494926192 -0.64395418494526313 -0.69569129333406587 -0.52096606280268509;0.083563946200594291 -0.84695768758981538 -0.03105124837679181 -0.081301666318719462 0.2768952429240647 -0.2022222269870978 -0.58636280784504313 -0.085911672721569396 0.49700355378393479 0.23225665480027866 0.66013237010899994 -0.81776784408221881 -0.29429985615867854 -0.99645532154269367 -0.87420694397904775;-0.10693162864237143 0.066657593321869532 -0.20488626799058807 -0.39076402973411495 -0.057213817819118502 0.70781692142442099 -0.38503504461437604 0.39477795580907482 0.024722594758100735 0.069757179175230305 0.74227944304452254 0.60493758626028205 0.24910113865073599 0.68163922663298793 -0.5451196210675382;-0.36696410010532488 -0.14323052274889078 0.1381479690667976 -0.32489092165688299 1.3088318515003776 -0.038946622186355986 -1.2979698332894611 -0.22688730220981951 0.73340112324679729 -0.33289920742035722 0.045699082033766915 -0.31285370454671491 0.73284923292545601 1.3215681742186223 -0.33627349980351479;0.70840806836185255 0.20443410029495371 0.28420905376609851 0.75845789371626626 0.24443445540995717 -0.82407668749439 -0.37307514164138755 0.29030518224314894 0.3534163164692094 -0.22648186491608865 -0.13700205725529446 0.13082693359160885 -0.44330406920099108 1.2884247607649155 1.2383573622181907;0.75275288371515336 0.30435861664566671 0.03558570213174491 -0.21238345251712668 1.4242453411951872 -0.89098388638434467 -0.10078538155141822 -0.23924905132557536 0.47045140400011376 -0.063533566800198643 0.68164522399080474 -0.96812667221249249 -0.059189547985895014 1.2007655035399516 0.79977965254887529;0.62401815829841734 0.36726350579064404 -0.29994240852865889 0.34083042318400802 -0.52322613398862772 -0.013413236375352472 0.4840786142987562 0.18289827613492188 -0.82909984077759025 -0.43960348394293353 0.72808398199750779 0.41225942639009405 -0.41142300172943419 -1.0749014150243368 0.1556331698872736;0.020573057862337346 1.367859705874553 -0.12750312377459389 -0.43016752077065473 0.4891347917454999 0.3305876488281797 1.8877050968233822 -0.11451311670669734 0.81351476456864469 -0.32314897636170631 1.2426815162830798 0.034970961845483844 0.014499294986698894 0.38325536030001878 -0.17520475067601063;-1.1894215553857315 -0.35964578515516377 0.28631817088280842 -0.090888972650484623 -0.051294902494039445 -1.3776392541968003 0.62143994900360655 -0.35279769193933846 1.0595803207706742 0.16406438580503327 0.048149791686206617 0.34100187083732419 0.40471887823934416 0.73960205834138415 0.54785510023393935;-1.1146415178719749 -0.56594225828042821 -1.3386272624529856 1.3747900546703529 0.12103118457777878 -1.4986284462714909 0.34603313445866435 -1.282533070756398 1.9818652745005196 1.4484362878656576 0.19529772797449696 0.36119207239193524 1.0536033486188212 -2.0354870941474785 -2.0494709275976541;0.0050097322495949691 -1.6701252918447647 0.3122756020387461 -0.61234836962318973 0.26612662363306999 0.30026102677249539 -0.92777236520812112 0.80344804553412952 -0.47137302750723498 -1.244590479768118 0.80286880467081767 -0.32607700356610492 -0.28968261372150245 -0.059679568717984952 -0.26796423613477599;1.1799443213604264 -0.32349523223471405 -1.0526782350854387 0.69393189617728357 0.58324039026303498 -0.37137493027307689 -1.5621413005142191 -0.028672516213187157 -0.81016465083755185 0.35872695916185421 -0.56633310574017903 0.026012647640221223 0.13851811586495832 -0.58708776940194873 0.0015690774871701813;-0.0050500204248487002 0.28286722890703403 0.33424675188251407 0.0365283236810858 -0.10704033440095589 0.52162372087543529 0.29198317578115057 -0.21198778453805325 -0.36838199049594877 0.46059753830228667 -0.62234047455183128 -0.43186741613487956 -0.068989556773599831 0.074118461425014964 -0.43727366246262511;-0.33656552444979748 0.28528172842809785 0.59276493084824144 0.12967722379304086 -0.4219314203495233 0.71626970159717507 -0.23885782746416956 0.12851532664788051 -0.046492259075337487 -0.19538725742492632 -0.03775833564978353 0.035266167162222375 0.34010760985372723 -0.36442618810161992 -0.50699260631337695;-0.56393372146673371 -0.79533193742188169 0.26035186955691264 -0.23412710954870103 0.67885094374634036 -0.59270018768233634 0.51616870265881376 -0.3094397871816128 -0.14654903744753692 -0.27010818494621502 -0.57946795230844916 -0.32053888096192745 -0.33324348501384149 -0.55418652835394155 0.16301092313131479];

% Layer 3
b3 = -0.17068090723846932;
LW3_2 = [-1.4082529505697845 -1.3893271637212745 -0.85242127036036763 0.49183887285071071 -0.43188438031050125 -0.34004433834480874 0.53722001997963664 -1.2021088458777658 0.30190061866766676 2.14045067798124 0.26614209803002026 -1.3303128397944628 1.1241092143800544 -0.85258834615171597 -1.0765651184949763];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
