function [Y,Xf,Af] = PM10Oblatos1(X,~,~)
%PM10OBLATOS1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:21.
% 
% [Y] = PM10Oblatos1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.1544117377507548;2.2807826900921406;0.91436943695452766;-0.38851012418625946;-0.80404212416963006;-0.95101877819561931;-0.61329082886612218;-0.13659859251157869;-2.8671933516451107;4.1503920941713472;-1.3511863337452079];
IW1_1 = [-0.07871030514624261 1.5742335584732114 -1.7342172014907538 -0.19525896504215134 -0.29217910666897712 0.053645831132680587 -0.34932042718866257 -1.3685856489231152;1.9400285605727552 0.53956932671208346 -0.20829386826315294 0.66466184171720188 1.9096609119266834 -0.40287849455446317 -0.20571015833255282 -0.73295158857070097;-4.6235636325528722 2.0825178525494095 -1.9124009633085348 -2.4954654365780495 -1.8773572989776204 -0.46281594753371508 0.14014412953858851 1.3068005834822307;-0.3357375297870771 -0.36372876126815029 0.58815100565990219 -0.078678038151885704 -0.25252510756575608 -0.63322439091730498 -0.44002694587737684 -0.39731168819444118;1.3379548393304344 1.3055916267676773 -1.573833051396627 -2.801130066940055 -0.39433865890688802 3.0966590302536483 2.2476872034246846 1.0851008804658122;1.6545377094453251 0.46911616729735417 0.92509895163207878 -4.0205655196739318 0.60623751248475188 0.85617989443886178 0.28201785184427214 1.4122911268205725;-0.93548881155479169 0.098790624204586119 -0.57838362689889733 1.8887425703850023 -1.8970615809669971 0.92462868374540919 0.3858007744283749 -2.7296235227709138;-0.40059075945766587 2.050208540411977 -1.1330124985133359 2.2524196305830331 -0.24438777015216834 -0.45937127691367596 -0.38149228029554788 -1.4268576468159762;-4.4990556947062634 -0.035947119447238537 1.3493235994320849 -0.019316369852752313 -2.0778138090631129 0.1174415001697155 0.75374609297340067 -0.031008928425371597;3.9017775234823358 0.35423753187512602 0.65919910397710124 4.4896690362715956 -1.1248065508335681 -0.716421431763403 -1.5424471887791118 -0.6795293940268029;0.91161468266534895 0.12556311691439065 -0.9877235428528639 -1.0047639442839915 0.18846734624973277 -2.6554514143798351 -0.19113547954518087 2.7146289276111628];

% Layer 2
b2 = [-4.8518540240267267;5.4777834431507157;5.171010795448443;0.7430445027703525;0.40885858009252662;0.41605303948057981;-0.35660788486022132;-2.6177100571437841;1.0903555820517248;-0.8993507661453356;-4.0408778282259901];
LW2_1 = [2.6162375081991347 -1.3410722040207967 -0.89712882131804972 0.44664669422781811 -0.38333785756904337 3.5334130158451291 0.059657256010893632 0.97549544156040269 0.73045835355032829 0.32600083104478872 0.59001831658257498;-0.23274634833446484 -0.34635284003281552 1.5329644631513621 -0.41006905522294113 3.4915697349813883 0.79804815758117942 1.617607008922016 0.77109391243902881 0.51512632552156001 1.3492166484816497 -1.3600038391747395;1.8970667452628245 -2.1573766775887293 -2.1095582353385893 -3.451382694452553 -0.33887262725180051 1.2048965272841712 -1.3048404555073572 2.0673954115372539 -1.2196590404198455 0.95513828355436392 -0.2978599770122437;-0.72189675976962864 -0.66819833668900497 3.2776682705882059 -0.45747795115248358 -1.1311556166843135 -1.4031338124189499 -2.7848822377790476 -2.5428376593671835 -0.71795566664263799 0.64094799315960094 -1.5559916063507897;1.2283292847402267 1.0898571871829386 1.8589494780540758 0.52261635158997799 -1.7565625468531565 0.46678046658520078 -2.0865648526471423 -1.7364389667040228 0.9524482619293404 0.4003081206588438 -1.0903481457892548;1.6393690292393286 -2.5357277227401993 -0.25750347059985756 -1.2008957599024017 -0.74624815339745587 0.70275327941347399 -0.34661457427035364 -1.582433866762849 1.1873712077657868 1.9390566304050325 -0.58845227578929815;0.5583580510275481 0.82623717232209182 -0.91953224303670655 2.8718393678787466 0.97479553502576244 -0.0060720740431965611 0.11064379631900649 -0.14308856650110918 -1.8586138154066854 -1.2250221892873596 -0.50306460168850986;1.685685509639312 -3.5122058609667488 0.33066738473621343 0.93615318828349858 -0.011461364841010048 1.3843010602291412 -0.039781243561138963 -2.5086994317306113 0.70836664031588215 1.8901295781105478 -2.3026587940095844;3.3361046988206939 0.76096991794940816 -0.10837445489355374 1.4484352814829484 -0.024255079109145865 -1.8498606503563519 -1.8587725771229371 1.485893769030739 -0.42076443806600972 -1.5748806985891193 -2.6839532357625697;-0.20745582994812078 0.78279178465992261 -0.90526140479384321 -1.1298990222532312 -0.033014874860012401 -0.64654622887182733 1.5046311621423332 -0.27328463355812083 -3.2368178759542108 -1.7780353738450172 0.70646613976707906;-1.5894273606108671 -2.5311151418357567 -0.28082448430512508 1.9577007459319855 -1.2919186428193086 3.1821277241929065 0.49136573641835157 2.6156516193729358 -3.6994926300700324 -0.98556553829639792 -1.7079549036725621];

% Layer 3
b3 = 2.6110228903706658;
LW3_2 = [1.2328631219792348 -2.0953489767186126 0.067786287012559024 0.071617331923664679 -0.058532153437879479 -0.2146786702896733 -0.22175737871616552 0.11916357770814164 -0.029551530808265482 0.11855534028969326 0.1905134489444103];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
