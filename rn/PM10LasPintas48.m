function [Y,Xf,Af] = PM10LasPintas48(X,~,~)
%PM10LASPINTAS48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:32.
% 
% [Y] = PM10LasPintas48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.0251256281407;14.7058823529412;0.0179856115107914;0.00280033604032484;0.0558659217877095;0.00576368876080692;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.9291728533937851;1.1783909824798053;0.56743411831542123;0.76060115397803529;-2.1338588546744472;1.3508609143701031;3.1304107349894452;0.93807467165854674;-2.0376823874570444;-0.29957153646042656;2.5964162597497125;-0.6400038795197811;1.2868832649717752];
IW1_1 = [-1.6756083655181246 -0.14384363619204699 0.55404242324987518 -0.37295615264376847 0.84543153279881578 -0.077705752399395089 1.5006915453510781 0.043181563401047326 0.29276653367314398;-1.6980674971599563 0.039791073282364905 -0.15148513868788718 -0.29965691752627988 0.003146231522672259 -0.11302759676131675 0.47756315090014545 0.069319680129992969 -0.39754295142364593;-0.013315932448924997 -0.97001103533911015 -0.099849841704523823 0.83258263133203381 1.1493177502137693 -0.47682513110828645 -0.55144310515626371 -0.15750951558722268 0.13460954875906339;-1.0590886919725255 -0.41585239989688982 -1.377317506692056 0.36417552599574848 0.61079967399040225 0.052628898202606633 0.23101662883498189 -0.10827723448682956 -0.21762739058507588;2.6514699099347143 0.90474112328799872 -0.61043211283378485 -0.6510172331571018 -1.7018649009785787 -0.44235072019499611 -0.15478628864815411 0.022093627242069071 1.2270108431540441;-0.12576157049146033 2.2658866870275065 0.031973903415465924 1.0226081797704987 -0.2205234281851397 0.34850050975581881 0.1287652529852841 -0.11552824485413732 -0.20431995319014493;0.44132108358439648 0.32643139170986074 -1.1164402916030205 2.8294356219982473 0.96691347704325281 -0.36183531887031789 1.4967942283259281 -0.06605077069906172 0.46434072565572615;-0.73034326697207042 0.26732254632500413 1.2486493772131824 -0.13231218072564829 0.77690653579030955 -0.52466572074852769 0.452531755640181 -0.053679824940241053 0.66087154919451674;-2.3429661365112424 0.84045016249281634 -1.1853868228016193 0.57367562319986942 0.7266349159869967 0.016721673981403867 0.61656390809535389 0.026442084743851492 0.49284791066720263;0.09579231015238994 -0.22185812417726539 1.4581491243194336 -0.23301012373560606 -1.0516639178521543 0.35170247355710449 -1.8229801096906635 0.084985363589778054 -0.55094775106038474;2.317461474204709 0.27089117869059554 1.473808367228773 0.099278125056573657 0.35798161177416876 -0.33438156583790946 -0.0531412219411578 -0.2124071043090846 -0.088493835466895557;0.58268077109736516 -1.4910353273476089 -1.1834900577282492 0.69412571930483069 -0.70022416026927503 0.42076301783964232 -0.0017960323678182788 -0.05984438322145233 -0.40061249105544511;-3.7986014916087267 0.31053617379886839 3.3269562993638506 0.59168155641747588 0.54294865657782387 0.20877701036724713 0.68936408891380141 0.21083942190312924 0.5181186963649681];

% Layer 2
b2 = [2.9579267245265131;-0.70280724067043765;0.37299198458811261;-0.70573389891438998;-0.96104267283340683;-0.082596460598737806;-0.06771053294446383;0.42562559186399218;-0.4135571929937038;-2.0989011823005894;-0.26802519982722478;-2.5418109464368257;2.0593023052454003];
LW2_1 = [0.85522021679304727 -2.7476795046029125 -1.6864714624807171 -1.3847316346095015 -0.61240801201858763 -0.82365936819971775 1.7365556712902452 1.9823515819444251 0.1876557272442553 0.13661621837717064 0.02696874502610452 0.45814271462849709 -0.51874420452200176;0.61047285557637387 -2.103861073820692 -1.1140666409682236 -0.71962675046304725 0.49408943354942086 -0.82595880683933465 0.87394763529456754 0.28674782477136773 0.9346239891649859 -0.36776067520438915 -1.2773558744826086 -0.087437513821538027 -2.0471171965049231;2.4116340253088846 -0.33877733009021627 0.16686918061590894 -2.2173264732979896 1.0780503570924769 0.064871975863602951 0.29406111117342215 -1.0484229855933012 0.21246699767472188 -0.85106748138223864 2.1057914134637361 0.4611665011633303 0.90095716368126533;0.076775012191302755 -1.1794467921598817 0.50035911149578005 1.5537320595850834 1.2954638378265302 -0.86434030046201171 1.1905551017757663 1.6244646986322737 0.043375183970630345 1.2508425117034414 -0.75451046133433397 1.1335083596172479 0.1982770251738;-2.6343264947884708 1.8225965392044183 -0.33058618018691677 0.045223914689710584 -1.1142942632576205 -1.9380908325553712 1.0573215923102 -1.5952460492269667 1.5330002688939379 -0.57663702894824242 1.1244739939536925 0.019197530955478888 0.8725235592892262;-1.7731899236753372 0.50810271019070197 -0.68155296466334281 -0.46999737967801047 -0.99946279938960991 0.19913422144154727 0.17255186465680702 1.5157209802875649 -1.0448437030872029 -0.70090614171426713 -0.26776793026590923 0.38651648643168041 -0.20227546787168887;0.077504988755681375 -0.086042784323125954 0.56272086897245954 0.54879076817242034 0.26280150006507719 -0.10718274782006351 0.3689772631272949 -0.47464925843248157 1.1914316762226882 0.3198434118523461 0.73506464314057041 -0.16654197592269057 -0.065243265725526342;3.4966613773897035 -0.47737863869169789 0.13257198785129587 -2.8293478188261605 1.5878578375576509 -0.025864466995736222 0.26540828693332508 -1.4779363835379575 0.35077368870839259 -1.0852210844282508 2.8674184305287134 0.62093881000073947 1.2083366158377493;-0.96557213672176112 0.5434156318506066 0.45145842693541921 0.66194432242946821 -0.047169012681731154 0.15905901139428616 0.28715303888382337 0.056648597811774386 0.62312840676333148 0.37152160433149878 0.44676427471879526 -0.17417781150724115 0.013583429264743881;-0.37234200934374584 2.5801014098635648 0.50454612927068487 -1.6603867401726631 0.11322433312590834 1.0966806098601927 -1.5592934056850121 -0.9413942872308958 -0.071080217786751151 -1.8881202061933458 0.75614137583373342 -1.1289878205118522 -0.10301219376358474;0.44706559378392141 -0.32480903722605553 0.21226801706746753 0.20796208686116133 0.43100049869038409 -0.54824963218178535 -0.042024904177132186 -0.14820721407114607 0.82229596992820164 -0.045234629110411269 0.93750137041023907 -0.21380456139318038 0.38381595111813521;0.38832614166007279 2.1122214341128931 -0.69533403301873242 1.5302738013145403 -0.93429002353996071 -0.11608900041493045 -0.55323578256903727 0.41583635407353953 -3.4719852185208815 -0.16183456670980556 2.2296928806437681 -0.43095741824593231 3.0674159306461659;-1.0556585538708827 0.90255351705618059 0.51822157160915017 -1.1626433376617997 0.29888258179681182 1.1493352125868199 0.0856832604388226 0.51110196077036241 -0.96760333721556724 0.3214007090733354 -0.40260926185188378 0.66083250964962581 0.34535578904405245];

% Layer 3
b3 = -0.35186369885057461;
LW3_2 = [0.48572654825273542 0.87908248130807309 2.9857323410773642 0.42980782227481851 -0.27900912013162044 -1.0299609285881886 -1.7976678704560669 -1.9208843241763367 2.4636979451153809 -0.58828031288073279 -1.1778693165058463 0.65318964249263312 -0.88162085180431149];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
