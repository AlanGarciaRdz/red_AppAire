function [Y,Xf,Af] = COTlaquepaque18(X,~,~)
%COTLAQUEPAQUE18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:16.
% 
% [Y] = COTlaquepaque18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;14.7058823529412;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.448430493273543];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.7037791901779384;1.0366136544245008;-0.5252409097667069;0.87072074320975601;1.7899174145319261;-0.41467587910027343;3.681382993036963;-5.1170953380769735;2.4477407050618831;-1.5049261409076544;-0.54398199851616591;1.3115595123452948;1.6933258095463741;2.2906015493607348;3.1599380958109489];
IW1_1 = [1.5563269920964098 -0.045218929439081505 -0.0294939941029152 1.075379423425606 0.38104555730610312 0.77223650852732384 -0.020716837540048133 -0.28279914122666622 -0.92806057586513624 -0.10754411799731979;0.49204025429203407 -0.54930317260010852 0.23964021591500811 0.28554770159917275 0.12283769423794651 0.45384812712151368 1.8508816923397653 0.19025598571514513 0.033923815019589749 0.091244481796504212;0.19562843280669812 -3.0483700824848921 -0.43661583277746013 -0.28548772093213587 -0.58361201537621199 -1.0056955233212188 0.29794748966663659 0.020567215046669397 -0.23449173425027711 0.19407977549301744;-1.8372305798972741 0.078867627585808453 -0.071274569230810381 1.034711188449472 0.084908492066260902 0.3397150193465085 -0.60976734537668986 -0.0020702408792622161 -0.012522353144912006 0.72595181346078097;-2.6993518893632276 -0.55803427481118906 -0.44098951280357906 -0.24043559931453501 1.7661678675850021 0.91336420465092805 -0.11965173824991514 -0.88770331130378421 -0.70631466453477731 -1.2787980160242347;0.13729956388824452 2.4080399383841775 -0.15080592921058347 0.11633601332688563 -0.1264709674920457 -0.16949888727594128 -1.5666591591443326 -0.0029521178135157016 0.049383333047293185 0.028725738776139802;0.2883762677486042 0.1486195332100172 -0.56728100826889072 -1.9599294590921685 0.053407975868124381 2.064032885315954 0.38168899485974456 -0.081114784238118798 -0.1821554575093296 3.9010653100890229;-0.67375626340164319 -0.21152866832835293 0.020880606671119111 0.44674345272001059 0.05755316525691196 -0.62156089804544268 -0.097040816287669251 0.04281171209892369 0.14530102846313442 -3.9383004350758961;3.0092336925874088 0.27536738256140153 -0.35311506779547452 -0.51525318620680594 2.6753749819293491 -1.1311697098173299 -0.079944612380056457 -0.7642195896976387 -0.52936942394591069 -0.98366688054313578;-0.71784168045100927 2.7829188886460701 -0.25337328773500367 -1.6446340575898124 0.41527499474811197 0.59892633754660796 -0.11335988157197764 -0.073562162933535749 0.41459076170071024 -1.1970920016126483;-1.1511443219187734 1.0840006002139797 -0.39931998500701776 0.74158979498441113 1.0407521165845852 1.608572510491562 2.5047654117718148 0.087184690486854829 0.4564377427865795 0.81205882879075675;0.094340592890544681 1.0339127511989785 0.0083280061287282006 0.99745669299045847 0.14130830925220708 0.4414835742905388 -0.78527528166949045 -0.11356342527774001 -0.054282918038648299 0.0069655958391543621;0.32286840530292926 0.38496979439353862 -0.95632884136226137 -1.9995844818560806 0.17428336665025135 -0.49262950117060816 1.3067919365137961 0.40720928095876119 -0.76891927211315447 2.7057070536845598;-0.17682501289775818 -6.7283449639222663 0.37269592878548141 -0.041581038239773709 0.78634356866470057 -0.2488737056933179 -0.45753453773446123 -0.25269721168821346 -0.19485588810533797 0.42753627799537597;0.56000716005292528 0.23435258176167159 2.4256503471562962 -1.2017632171242398 -0.024729151735668906 -0.0053033816704865129 0.44681993970682488 -0.56514311880462986 -0.082785320895885334 -0.93334678997335252];

% Layer 2
b2 = [-2.5622288267455375;-2.5497663664627828;1.8221829592957879;1.5396329527190054;0.32568866557595499;0.54545363001029779;0.40003591448912523;0.52758284969026137;1.1890629172686116;-1.0256661764557931;0.56145741533414717;0.68825469444607412;0.21900640246458461;-1.4810421896586508;0.58039006688212347];
LW2_1 = [-0.21350016353570037 0.081956723326378281 0.20856119388820671 -3.0352765416806839 0.037697527677282183 -0.16677368983950597 0.82414281283476187 0.99740086554968099 -1.484629829815642 -0.9773209210261069 -0.84372229052568337 1.1982037588558021 -0.36880089104199948 -0.39192915245608057 -0.89090068116186416;0.093671965552230896 -0.30590239086304311 1.2699193751894897 1.3326086384673188 -1.2566532313781551 -0.81681332916891003 -0.54247665395561051 -1.9536702581950773 0.99790095257172351 0.88153493322774246 -0.19741513723038873 -0.3096058431666695 -1.1759841996387026 -0.89898337772972325 0.16360685621903359;-0.51380544291274177 0.13059143304330253 0.42904506088276723 0.26601380889297421 -1.1468360621979738 0.5368358811244156 -0.7381247358868136 0.56912933850185166 -0.51696783859221063 0.10639719623723208 -0.1557809148897269 -0.44266862876262869 0.5666239273067365 0.074095047993130422 0.36582851252526805;-1.0388639798058439 0.88339525800677576 -0.42881083029584172 0.82447062950136585 -1.0316211465589178 -0.36018322605836139 -0.73284579377312853 0.10272910637730598 -0.15839457281059263 -0.40091985796701435 0.06222539524149312 0.52800019913551566 -0.30776372063820029 0.044014119257197865 0.70786169278924094;0.30646228211648852 0.13661979798375398 0.48849726498801949 -0.42102441450085959 0.39145232273807523 0.037500017991151387 -0.41420636712412956 -0.4815248706036328 -0.40924161821236338 -0.50152433403616714 0.58445639222735168 0.17696588751405964 0.32937358964466373 -0.30193044886943915 0.54230038915209045;-0.22419336476818269 0.20131284445734321 -0.52284635414179359 0.66133615593788242 -0.39097073389712866 -0.52462961918863904 0.032307617651990889 -0.87064654412129672 -0.36546397760948568 0.51197000771967838 -0.11859108143642441 0.70814239600352324 0.41132481594955378 -0.58897081245219152 -0.91413409543727131;-1.0242227611250603 0.13748232838565758 -0.41907987178616624 -0.034654990174767732 -0.38364359117607538 -0.0098513573807201549 -0.64931006897989796 0.84173356424907686 -0.78843794691540714 -0.47910469320614529 -0.46807084129385135 0.63356311580450042 1.1708143417406414 0.30508491158293233 -0.26235416725495714;0.49942765879143569 -0.16923782218557729 0.21693754843167154 -0.29249591907984929 0.18187917657161667 -0.23550016537613416 -0.013619984292706193 0.58744340694685326 -0.044104368503337849 -0.23736181866432524 -0.10729170436171707 -0.36586624140009644 -0.47455717202287445 0.55066692456547073 0.18799779289507931;0.66071500115778536 -0.46036161962771682 1.42532008248035 -0.6460487235858493 -0.076602211802275569 1.6267930796099936 0.071846927084414064 -0.56867193730861576 1.3204535977544352 0.46152674522961201 1.4467202688480316 0.27506015125096467 0.85516448106004728 -0.21618918542750801 -0.97779059978190686;0.0024870089121490704 1.9882942634506102 1.2928488825143793 1.0166401475896116 -1.0968881182116235 1.0540980763245771 1.225243601677203 -0.50824624457817125 2.3060175563805978 0.47054932535507166 -0.64449241011766212 0.13766278252639125 -1.0556287828516966 -0.29075496777971083 -0.60805736187313431;-0.58124190174339985 0.64425374787623091 0.18864390789042682 -0.19949567470914717 0.54631914280895988 -0.85738022058196683 0.19628746178893813 2.2973823981829993 0.4975016618559116 -1.224851110435099 -0.26970585798275931 -0.13197735589453519 -0.12266015262394703 -0.97016182535187689 1.3718499355080804;1.4196240808709089 -0.65557750438812268 0.73396886557052199 -0.48273702759550363 0.58015789287163566 0.11789377742443172 0.30668564589934955 -1.0459424647020561 0.069022737985565685 0.36871328645719453 0.54019127242098808 -0.72685735834422283 -0.3691373232302147 -0.43013726311732808 -0.70157605519553157;-1.0858650824882328 0.9903084324830953 1.6563199722333666 -0.5811215700332556 1.0618064909236344 1.8732655512387468 0.72249732280026113 -0.035926721140695381 0.41097769494340058 -0.43963101122726911 -0.24325561949258398 1.8952843023119983 -2.4111776636536435 0.59943513432009854 -1.2090461981285898;-0.096788788980960896 0.54332891764349989 1.3841045535968992 0.026897989140848667 -1.2913527955517363 1.011636686161562 0.086744776983875144 0.47739789743542149 1.883939554591697 0.73334232182957726 0.8090832114675941 0.31881556369622194 0.90729196281105595 0.26417466694495517 0.48485267364747126;0.24824549679224012 -0.12128709178036325 -0.88049407912274902 0.48194163454554756 -0.026578998482196126 -0.96102200788819792 -0.84237753852523867 -3.6559796600447223 -0.79749920920057737 -0.11020272095915803 0.17537062139213461 -0.88389079703012285 0.70384593721901068 0.31773876877146284 -2.0350391028422967];

% Layer 3
b3 = 1.2800886692469589;
LW3_2 = [0.8838181602139874 0.71603499097272483 -1.0925968077949233 1.0637996306865909 -1.5006829360154839 -1.97559400167059 1.7007037211265024 -3.1916672863093694 -1.1722964090439174 -0.24983359346257722 0.65918702274579954 2.1213567388550065 0.39264820496535635 0.68910696422472717 0.85661826796761198];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
