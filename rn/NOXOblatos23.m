function [Y,Xf,Af] = NOXOblatos23(X,~,~)
%NOXOBLATOS23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:35.
% 
% [Y] = NOXOblatos23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;-10;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;4.05679513184584;0.195790504160548;0.00618238021638331;117.647058823529;0.141843971631206];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.88656767293363647;0.1702106298475137;-0.55333232175410241;0.712982111373339;-2.8764462464182854;0.95072797199260817;1.2243111205266377;-0.49358716824931403;-1.2080777748080769;-0.86928737733477679;-2.0711930916278245;-1.7270906087247628];
IW1_1 = [0.19352159998893459 3.8487241053746266 -1.0685955842172588 1.410217486182008 -1.2873959752620532 0.48977545635873021 -0.18197542527986948 0.41920433521953493;0.38802233723235424 -5.2132510035050483 0.041389339257487001 1.4137879975956471 -1.1941023781535813 -0.52995307526776214 -0.58836693170577381 -0.49716646444042556;0.48507597672878616 -1.1983686760980081 -1.2192450220165207 0.55763324094387445 0.49153510288702557 1.5913473011877124 1.7020879376997948 0.43706222076088519;-1.3352462140238957 0.79318636899344286 -1.3757847262821221 0.53034785362666437 -0.41260690245869758 0.0344077537973521 -0.64190981975624739 -1.4253239365259565;4.5554555995618395 -0.16059283940785246 0.73798666125025958 -0.19248970365655471 0.34960315480540505 0.32319537788835923 0.60563803510586089 0.50238465594003401;0.42809239293082785 6.4192917111221837 -0.81110024809032311 0.49164695813779602 0.44571160674921922 -0.058669981601551513 0.187878524895287 0.1133692891492861;3.1681796229748418 0.29239548971679302 -3.4310884502631991 1.7487221961564043 -0.48508120070558169 -0.33444171012231849 0.47513423723956993 0.91390976151621817;-0.47207705951848034 0.26861403899130543 -0.05486755492720663 -0.074291359673137103 -0.6943019279169127 -1.8735840549922773 -1.2481879290909661 0.00026966150217942741;-1.0813595813211159 -0.28856345922111454 -0.26784766281166894 -0.076178651539570319 0.35998410591849062 0.59832741603877926 -0.077623701100624304 -0.46386335633712716;-0.38428933862445358 -1.7934949596083574 -1.992634813688279 0.8314398237611601 -0.99429023810060446 1.1816862068812626 0.014882364640020213 -0.40302482162048886;-0.48538257197684709 -0.021022447804100723 0.7529985273626032 0.039612991400249847 0.11994132780295894 0.7401537280073065 0.69724914272107852 0.9708875869349376;-1.478458308456474 -0.9777365207032076 -0.73807240728958523 -0.57606152416589596 -0.22430391310789086 1.111224397204543 1.4639402408367876 0.90821002874234491];

% Layer 2
b2 = [1.5606155371597223;-1.7014115558783574;1.2077994308615705;-0.46674260851144878;0.23433496795962819;-0.30997468854594884;0.30054818900150848;-0.54256023291402566;0.60834662757229885;-1.0905144847528694;-1.1325574324107597;-2.3681138593532745];
LW2_1 = [-0.59043965539065368 -0.24259964311949722 0.76114838740819168 -0.17037972008720714 0.52375893470968726 0.28959557798004554 0.0015858214140941698 0.32914572003017739 0.012187892284553289 -0.44166598263595169 0.59475134853859446 0.45127970230494496;0.750107001534013 -0.90651735662419874 -0.61346436339420496 0.24869163070449335 0.99756524688254877 0.22985193071145493 -1.169864104588463 0.64526120455153491 0.86749499746752634 1.578254298296776 -0.45382366794592544 1.1882256802678619;-0.68757579443790551 0.3886366751417194 -1.3192300375481054 -0.66997125335445273 0.74005954993106093 0.2208531951909449 -0.20360320204656271 0.52426900719739677 -0.17638789544516681 -0.73522345306004744 -0.3083954282949371 -0.17228017541079579;0.40157297606093001 0.10029358195742988 0.61907953017042927 -0.69650273127032114 1.5389000939930961 0.69469759741741044 -0.6731083276224199 -0.72321576199142568 -0.12233339235626271 0.69070858836761673 -1.0167373365097356 0.10325609896895574;0.27631252277591251 -0.036859941756247766 -0.010162303273235446 -0.33990554506972093 -0.82960945928343921 2.1358246916268424 -1.1790526912477395 -1.2320065505777837 -1.3604157900179623 -0.16643627115393106 -0.48537307366004112 0.14046642402796292;0.20618965488534943 -0.35928662637626285 -0.60002504928622036 0.39799900294396084 2.0308611607831741 -0.49863713509703494 -0.80801365179935103 0.36124650499185779 -1.0750252201050201 0.25409925002575962 -0.53399280521103731 1.3794626690971497;-0.83955302108721908 -0.86025427839521595 -0.39556350550896169 0.90340669426703979 0.91239455263202551 -1.499320817652753 0.58309746788447392 0.084815267671481717 0.72423328878323101 -0.9591986631740006 -0.56771700353689447 0.67689432629602952;-0.23894386005283869 0.98866874567160701 -1.2855898679549689 -0.39674252714196584 -0.84505439503415647 -0.72818777930741629 1.4105616685873912 0.50522355944844499 0.95493305075577517 -0.25771564736210995 0.056838179333324884 -0.49189337097245978;0.367363160834835 -0.13433057691610892 -0.29880858780799407 0.19470160869605896 2.258510198806337 -0.34883473175760216 1.2166409848162405 0.52478438111075587 1.854373691479027 -0.038865075067305133 0.041734851085273604 0.67345926309450055;-0.83142735891302011 -0.89162625151882324 0.39101406497277896 -0.46839761837261357 -1.4666290494825274 -0.52568529331359515 1.4708580507367592 0.20431550466693235 1.4337671350814873 -0.72940779504826614 0.53439648255290195 -0.59262737214530814;-0.91451014892132199 -0.27138126999896961 -0.39997759706517766 -0.25387810050837034 0.18652352367346262 -0.23081599393248023 -0.47525164821375382 -0.59319564466536334 -0.19867027075146337 -0.65954589448265277 0.48571912464235256 0.18840123473181486;-1.0822569730361873 0.4151493083378931 -0.63276315069720612 0.59405004721140364 -0.41186889942121069 -0.49082729849732382 -1.1422435304294967 -0.54054102790890668 -1.3020854092313778 0.42584800995350325 0.71523268854269451 0.20822022856928685];

% Layer 3
b3 = 0.23374898124420604;
LW3_2 = [-1.0721771436080809 1.2480617664931222 -0.75361535291289594 0.92934688431713164 0.25734106163372594 2.2471154787832681 1.558089703432384 0.68964863121773434 -2.5775521605163432 -0.91576957405715709 1.1340300629470146 -1.7391408783664362];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
