function [Y,Xf,Af] = SOXSantaFe23(X,~,~)
%SOXSANTAFE23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:53.
% 
% [Y] = SOXSantaFe23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.5047197500521734;-0.69572795914680552;-1.2551840901329823;-0.33820080722274543;0.49168100517225177;1.0309646744206129;-0.14463015719979339;0.050747809128604174;0.068804222060955225;1.0278491627245014;1.0087951689303067;-0.99276668215133856;-1.4812880807492605;-1.3667943573783654;-1.7257555249885326];
IW1_1 = [0.54132604679384655 -0.0036824762439030718 0.093441553134080049 -0.35702855118710347 0.049132277806465813 -0.58125277035146894 0.63355947066951501 0.0021383736237980001 0.19004587951948243 0.85105796688838542 -0.38251512390412784 0.26191014047626826 -0.21088242078908731 -1.2934074637103021 0.31484697064560063;0.26858799277136386 0.4523613869926299 -0.061608872148086163 -0.051360601486101873 -0.069865363636059469 -0.59049567069563791 0.64060700790233871 -0.089963340578776405 0.47551802098354484 0.57402658487347791 -0.0080856367196342552 -0.50602752762433523 -0.065099425268004427 -0.035665761119371753 0.11509414767112155;1.3681694930598605 0.022249702120820565 0.28211960485292242 -0.0016328401051338148 0.11374536603265255 0.11395733946584094 -1.9139442329037273 -0.061391366020257097 -0.16863814382894307 -1.41555070591212 0.21377091086986044 -0.60218791256550974 -0.075990489059776706 0.99164627055105281 0.7075471611770725;0.39973779390586062 0.39140045321521899 -0.81297360460898127 0.10511317753224418 0.091670566074828291 -0.21436044878482957 0.33310844188770722 -0.15728105707135756 0.77200126604003305 -0.16096212467732413 -0.94911437239850316 -0.052274454484249555 0.46200040122129171 0.2473429105472717 0.31412751057403582;-2.198169528915169 0.56168979589618306 -0.083384556979877331 -0.40940515785955578 -0.13258153915474966 -0.30707736804575514 0.38275469903719067 -0.61996102737322434 0.80767768644432059 -0.47021253800593787 0.22727414047772973 1.0418521914115513 -0.082645513943449156 -0.34771651155066668 -0.61569172346353707;0.17303353967470081 -0.1525360871839565 0.31134504383234507 -0.0013657308667015516 0.22777468749692847 0.21065013863195681 -1.1767934172070851 0.16128456047997919 -0.70986364775589061 2.7105771925903195 0.041345567998945829 0.0054551102239391823 -0.20242385693729384 0.17619480234352519 -0.34874272960073005;0.21686311540918479 0.038888161857661765 0.12902156936084197 -0.20430876854975699 0.32761759854984734 -0.26024503814025951 1.2591345389551596 0.081491337836824024 -0.39486099260915491 -0.27523446027988019 -0.12962566812657536 -0.32486354755766461 0.42444983066484854 -0.066358957153349163 0.032326082612521026;-0.4343531454870308 0.99405818581869088 0.092313129170519467 -0.63941843959565559 0.59266822964688637 0.093410767756102464 -0.73182549987367107 0.69882435225434325 -0.28893418646252439 -0.30018506128679562 0.015930880347642905 -0.45290847382599236 0.53714386342564857 -0.75524253301928979 -0.66498996169708047;-0.098513430870988947 0.66808017184274437 -0.14170010964207358 -0.0041077496262291718 -0.3833235486229789 -0.2476463319043459 0.55578434013156452 -0.32228450153147647 1.348747067392478 1.0026751998376631 0.53105000122820123 -1.0122776731294709 0.46335406153462089 0.056086211423058238 0.14896751174170875;-0.72048483084134918 -0.059184600131669131 0.34817704356971568 -0.93817330409718014 -0.53053501347263321 -1.2351134510643489 -1.6762211480201805 -0.21828420373560264 -0.064336672045411242 1.3716955828728075 0.20368389162563241 -3.8756328011962702 2.6921003126595231 1.0110467491343849 0.13160477622560895;-4.7951274105551462 0.179009887061265 1.0472362487264275 0.65303190899321872 0.44146106771255494 -0.86316777502199549 0.37296403666211764 -0.080874334945095647 0.053128879003842104 0.096671771305628193 -2.0136532102817708 -3.222022488160186 -0.79295207985104132 0.64211303538573428 1.7922597946009495;-0.63756756974382511 -0.35060740113678973 -0.065906900235801411 0.30893150027292171 0.024922947265635237 -0.22125763224969733 0.25985851009860816 0.24232985689451497 0.44789566724304641 -0.14782147793040062 0.08715221989150268 0.36724562310339232 -0.57805427099857709 -0.413435671637784 0.59551626465009588;-1.7330161615268311 0.41472407603093603 -0.30023614032818968 0.21858703775964819 -0.32768677777319088 0.47911725371643765 -1.5987274615449123 -0.21685139397531331 0.92144362601588825 0.39411482658883895 -0.57316928136065848 1.1831129923785513 -0.088632136544237336 -0.68298753395497847 0.39781977824356263;-0.58326794473709864 0.38682586083395643 -0.40459823657386645 0.27704030381013101 0.10221142666386723 0.16674616012875476 0.088492363970491539 0.064596273778334753 0.03996905853821122 -0.48917204297854727 0.99159419561597428 0.68053053439191269 -0.15934027307165999 -0.91281729580379845 -0.22311108742545471;-0.30430864659066703 0.05231656401555166 0.25067930116563841 0.50327308490397649 -0.4580915182896772 0.20795145830993639 0.15064652670187292 0.57770077285911248 0.74261920580929941 0.40264794328969722 -0.60644734281405599 -0.39213782526502311 0.72006025615020397 -0.1232674340472116 -0.27122924080244848];

% Layer 2
b2 = [1.5657450000075273;1.4129777756381572;1.1958000944527158;1.2016069287824218;0.75182358295819063;-0.43096883374985934;-0.43883154007979147;-0.43073856398396804;0.52268115141690441;-0.33455061940610326;0.71458432614379819;-1.1565051070087784;-0.89970175317370316;1.4711828476633677;-1.4974024869097486];
LW2_1 = [-0.16316919413870662 -0.3547781915351863 0.6441608104166604 0.64537928378428899 0.062331371092161462 -0.17624962656844911 -0.73660152353367547 0.25350619346084563 -0.58311607345463856 -0.47923321188944407 0.60967044791280911 0.073253173308106101 -0.39069531712419181 -0.043328088974388154 -0.12716477819097532;-0.4348833419930086 0.34259999629096072 0.16894881950737253 -0.54379330224810352 -0.066251678906218525 0.22881826714906869 0.59927286139917391 0.42002340862347348 -0.48183945938778194 0.13124211202401412 -0.0068914479192852471 0.48748335274218069 0.67964834308714261 -0.39855346012962417 0.63723152406579986;-0.017455373775230897 -0.05712181610629493 0.57537423482961858 -0.23345519639906528 -0.85004395746873962 -0.18941833544159434 0.83967024451025241 0.47092612230700198 0.38417277051292337 0.097656512348868921 0.72175120883609123 -0.0030734318070695481 -0.62487473321993259 -0.10474511196150066 -0.35837015091942115;-0.44749214849076652 -0.60950012338234205 -0.45177350266066868 -0.56898736430995112 -0.55921983003928111 0.029322877243206313 0.3531989966952086 0.51037010132467886 -0.23355979940218491 0.27560684503210481 0.28338207340576932 -0.54245763176158335 0.084290116045461508 -0.14954782115737833 0.46167036317679633;0.29439270708370735 0.18080228729424652 -1.1957128267698551 0.64009301495194959 -0.75584309015467177 0.18457127509615384 -0.23546852979856456 -0.32590988093632428 0.24197664745999509 1.377875576941451 1.8730004912228904 -0.21193839863910927 -0.49243719642967448 -0.0064972958304540841 -0.20945203281006841;0.43948491503378584 0.1091494089342617 0.26093674191410299 -0.053796103065135645 0.57887106170292602 1.5077161929732104 0.24471840248147794 0.44248105055292836 -0.70267732249772763 -0.10196001476765151 0.12450163583422855 0.48485571099833968 0.60059472463450514 -0.24008349888635899 0.20721679856462141;-0.047359018381419114 -0.78886118562125729 -0.45819818514151339 0.59059711472363619 0.3938849898151261 1.4138362370729249 0.060652515915904787 -0.0098589506925235021 0.80689911294667127 0.34778425851798306 -0.31065990298055579 -0.50619316399393144 -0.16198220418767956 0.20147323127447403 -0.013307779093421108;0.41342484367098675 0.46729470195543871 1.3345112360930698 0.34278755322795301 -0.11882612528550635 0.61192212751784758 0.74319540845350851 -0.36410234012557524 -0.77957885421307571 1.0608650954830512 -0.99092017130288645 0.20443254784786571 1.1926581353725894 0.33602239478892704 0.61945553189263936;0.61944125945276984 0.04321732021663139 -0.20756118383245337 0.33566775443591723 -0.53421830841504114 0.38559597119449207 0.73365943108165099 -0.22445131021718656 0.12094618534829632 1.6597479771044596 0.7968037556096208 -0.68757072593836566 0.36042511256434573 -0.051201958357206652 0.0034001391197696559;-0.49584938277308083 -0.51535911336234108 1.0216636152074807 -0.46299843266881879 0.39331409477098439 0.3497274992865308 0.29634373120102875 -0.26360697211764217 -0.14456498961248485 0.2976941289338067 0.97373229849498999 -0.0056905680882152667 0.7372457715128663 0.17985580376707899 0.35027274939896325;0.067925772740962717 -0.47503945512074375 -0.49420725107403451 0.42750480648300426 0.1626358621134405 0.020301244968950673 0.24411966761388701 -0.51320534070132118 0.9145192203461181 0.48398721386039284 -0.31107760300816306 0.24937922160703577 -0.46474011857821551 0.54297393949563866 -0.46579069146627328;-0.72399476804926677 1.0577697603678367 -0.23886130759894408 -0.74426787414224083 0.29351368311041248 -0.68913780756577292 -0.9641938799069667 0.38764202775802825 -0.48218583598670856 -0.88101299849000281 -2.1238500028205585 0.5115604199501711 0.29772560464841935 -0.69186245818336611 -0.14376969986943083;-0.30694070700323561 -0.62549184194623841 -0.24762112253549126 -0.42152865749049373 0.47808263149544733 -0.5535042549359418 -0.69346066814454765 0.67961487225509609 0.35403352619445633 -1.8499755944155265 -1.7733931120025257 -0.24280487589221922 -0.60998577424952793 -0.3287315667673254 0.17448463699984293;0.53185115855749654 0.86348118863797563 -0.52384687155693033 0.69769548766510292 -0.90902355302979942 0.50234077212660599 -0.076580906173811691 -0.66001812174560714 -0.39138467929396215 2.2192205144575778 1.9162001249170446 0.20378187600339959 0.76868872509425346 0.21030959705580807 -0.26987888619682571;-0.43249396408986862 0.50108285691537602 -1.2031213451360239 1.2698987293349244 -0.70139520896746677 0.72621072099990769 -0.36576854081638316 0.0315895298983776 0.17760123993070975 0.66385433209319678 -0.57582985958196686 -0.27045492868904408 -0.20837930029913357 -0.4323541144324895 -0.48880121530639009];

% Layer 3
b3 = 0.89182488940558269;
LW3_2 = [-0.98932535128624555 -0.1586634402331111 -0.25325129881109371 -0.12402294108836277 3.0565823284087523 -0.51138749030209829 0.72498974954227136 1.0633774415272734 -0.64850756022589851 -0.46921259631820705 -0.48575264393247602 1.230098892127844 -1.6930211516775175 -2.4194766654803281 -0.52034106508600819];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
