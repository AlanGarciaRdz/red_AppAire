function [Y,Xf,Af] = PM10Centro20(X,~,~)
%PM10CENTRO20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:06.
% 
% [Y] = PM10Centro20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.281968137600451;3.74531835205992;0.00773694390715667;45.4545454545455;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.7256525814514563;-8.0290445922752269;-3.318276087806372;1.5143965418589602;0.56468157789328566;-0.68381210097980227;0.75540833226285131;1.277506809009892;1.0370431365197212;-0.3894689770594339;1.3161489879656616;-0.010079283412342656];
IW1_1 = [1.8212862078206962 1.8025013423270388 0.48020475759691134 -0.89142139841911627 0.8111345861551531 -1.152048126212736 -0.12376685951018575;-2.7029561551440109 0.051700544259840775 2.2075875321750997 0.45124249217707546 -6.1157967586323227 -2.8763329409147396 0.89412773073688723;1.791427417472343 0.40141966723299488 -0.21368337891171954 -1.4369873087518141 -0.36698829494418983 -0.38702159095526756 -0.10543455699699711;-2.4281285745954504 1.2053759529589929 0.45672410678569553 -1.1206559671490091 -0.29983147976124902 -1.2606452237590913 0.67154463764982075;-0.55383106371207647 1.9145725787798906 -0.67152195302304363 -0.60943503170991919 0.25288091907962562 -2.0988004202893999 -1.277573851417817;-0.83610373312599273 -0.087617396769937225 -0.36898356977783942 -1.2525984875635163 1.3150615387763813 -0.45006557815791282 0.45317457215817791;-1.333031668056337 0.72180577354812792 0.075312992366729614 -3.0229169990891447 -2.1737671040516635 -0.020284629253074365 -2.0156433184134812;-0.80428679933349412 -1.643990805686276 -1.217795559252876 -0.37036255277894675 -0.73884703811746433 1.6893203427423951 -1.3289973786752283;0.27087025492992861 4.8659772006417139 -0.24437116547099696 0.91076578946846753 0.026687920517704251 0.99652644001246282 -0.27317527860870022;-0.63156362885616313 1.2953437575322575 -0.6238773801183809 -0.17188829247165963 0.9046489355571361 0.13387935291566935 0.22350878071725028;3.3499611557900351 2.4749044012078749 0.46962471432302766 0.96493721198007532 -3.1528474930507375 -1.6341363662209014 0.40285978278556484;0.56380633233701838 1.6295218604002233 0.24268745250331736 -1.7033357108535514 0.4433453986791655 -0.38644290925327185 -1.2116443489017503];

% Layer 2
b2 = [-1.8498012461896141;-1.734446096976533;0.34253772094099388;-0.95875462728957173;-0.50658213731170643;0.00098620254157755043;-0.43715430427981405;-1.3393071536350409;0.62282712618714664;-3.6606279312921499;0.091527669871689782;1.695800820869183];
LW2_1 = [1.553163971167002 1.3938677672483213 -3.1108873734051166 0.71608036657162355 1.4017699665321983 -3.7321950556415553 2.3051867711990144 0.8861530736527603 -1.3179263823223393 2.4185643461052067 -0.3660237176513762 -1.2597388663246738;1.7166320567325788 -0.31104961478578874 1.2910761561870987 -1.1701589300719935 -0.85244702158876462 -0.44045260454368129 -0.091976871997287574 -0.43436951502855981 0.84906769178265507 0.70567945641833663 -0.70685664213840937 0.38005587494808035;0.69836883629779645 -2.2366474704245278 0.29431938924673823 1.8889998210231391 -1.6803392730369509 0.64245732939907985 -0.10152616943306651 -0.87202781086901116 1.4023620908348429 -2.0985478407560283 -0.30790315288328352 0.23460340125520707;1.1976998632575138 -0.94791322901603703 0.15102199991378601 -0.80715555480225054 0.45381466679348509 0.085646547478539323 -0.16880063519810928 0.57316382786821907 1.0039000409103744 0.37794835531608539 -0.5075325297996538 1.0049499708863558;1.2329531545131003 0.15864411780562507 1.5068777055130738 -1.7191820058581588 0.014787927394030655 -0.6593633834314131 0.1376042281892616 -0.38077856721155656 -0.61736944568514152 1.0018848844497075 0.59584500837322407 -1.1140874411751784;-0.18615716005886915 0.47261888608796154 -0.93265994800574781 -0.62883611294118946 -0.38867999759167648 1.6321911692274576 -0.51279507582776518 -1.6990494315845259 0.22736724097136751 0.50692448107229204 -0.34888263010997606 -0.69128382501385621;0.72032174971992657 1.0629516267232868 1.3799471034626991 -1.0140310776935888 0.3814573262065184 -0.44123139626877672 -0.80132164198593592 -0.7597299517654803 0.24710496499477316 0.080596512058598607 -0.3777479098402815 0.53426876013764124;0.559769814990698 0.20467464217566275 -0.30603047530346189 -0.51047674452050884 0.32337333247756628 -0.42767613067308063 -2.3092467998257691 1.7856617550381013 1.4192433903473389 -1.1863757243367696 -0.88252304659101055 -0.074951908801008368;1.8958967294394662 -0.096669617698600746 3.9150843648188434 -3.4850465724879656 -0.14263676044711016 -0.1529388024549605 0.73151376776531318 -1.6802297195180851 -0.58754758902619808 -0.43830023327472062 0.26439762225576402 -2.0809276802642098;0.032069448484905047 -1.3976029346221095 -4.0628581580716316 -0.0093370498379294203 -1.7705002174037177 1.8799761647852657 0.60215124313779367 -0.6315350756696626 1.0452628672799487 -1.115673123083792 -0.38903895152836038 -0.21410054079687185;0.77398521657929242 -3.5062248429540248 -1.449178107243462 0.78793333425149559 -1.505218845016993 -1.6317248304629164 -1.5473910769507389 -1.4576580800519794 0.36637387882890787 -1.322398736594383 0.94270099705640509 -0.79817958055744265;0.41512777524917432 0.47681244646141974 0.055184770878090053 0.53626285686734609 1.3949645251776477 -0.10530138664503923 -0.50963975644293946 -1.0172718524790909 -1.4309605721351408 -0.2843282945817206 1.6832772844902355 0.87150602592539572];

% Layer 3
b3 = -0.26319132649299831;
LW3_2 = [-0.21148563661559205 -0.60825491965162914 -0.086638879272579405 0.034226535666363536 1.2427706281968245 -0.17123089886922421 0.62476016769735732 -0.26362798751490629 -0.52224103998610105 0.15916856162353538 0.13969179625662512 0.027604090298006832];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
