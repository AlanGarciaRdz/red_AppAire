function [Y,Xf,Af] = PM10Oblatos3(X,~,~)
%PM10OBLATOS3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:21.
% 
% [Y] = PM10Oblatos3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.3660748483635277;6.5382975541502386;2.7752208705887895;0.3830864849918259;0.57538827606124821;1.06662307396474;-0.045717042481686024;1.0678588087933552;0.89829717559231603;0.20357600276744303;2.1256768171712355;1.6871467254101129];
IW1_1 = [-1.0059566159992945 -0.57743103174176813 -1.3659129256119638 0.19968826673904985 0.78859571076325885 -0.55836946972850898 0.051502741329158747 1.5710122550211738;-6.2161033653241287 -0.33509668168279921 0.68864015580899451 -0.61582662610248018 -0.75799383794034858 0.068093029195256977 -0.086274593497987773 0.34870866414594676;-0.6929175053557981 -0.70652386513780729 2.0139577846511756 1.4225365856237555 -0.36326624514562567 0.12488287248914892 -0.20053903466735779 0.81927589604114237;0.27967520018060549 0.83872336939899494 -0.52948675278273549 -0.17495175647269001 0.45478805490536639 0.18307158758304617 0.21874725515508098 0.35235534351466291;-0.42526370468570318 0.050271447578588403 0.59341880317122919 -0.24225551567167672 -0.026209874450469711 0.14095926245988519 -0.055615772502284652 -0.2949731358365808;-1.6263786518864065 0.40796751810463661 0.2771547604506473 -0.60362314262257222 2.5434049900278608 -1.2916100507184205 -0.063911676400433215 0.14685911670045837;-1.0967678877967397 1.7791941153533488 0.82791245126333701 -0.92773372337706461 0.67038202914998679 -0.51343244807114841 -0.15130724859956268 -1.0570694390387365;0.52634798452299125 4.8353955826359281 -1.2130950335182262 0.098382220891988476 -0.081779320197013089 0.38963441394021547 0.22972007913808626 -1.4102411276821267;1.1833544390497381 1.0412623165310821 0.15627808593409626 -0.11181795953752381 0.64212934448750592 0.56490369710148758 0.14021147071034229 0.6614986362868035;0.51461006651452734 -0.64360183518494274 -0.37098921996062373 -0.34874338855738385 -0.0057860974799437727 1.7309055148490384 0.09060335603521967 -0.93657960760477255;1.4358413088059492 -0.71031020573461523 1.4403898169798626 -0.1913436744146822 -0.17088799236680532 -0.75262453736294455 -0.069108147521839247 -0.077634094632394859;1.5985851667856965 1.2096576382270938 0.44770577650527998 -1.7291484567374737 0.1950667801293475 -0.98999650012405638 1.112987739171033 0.1919690882080769];

% Layer 2
b2 = [-0.44046463909303957;-2.8195064039529329;-0.2416323068831675;0.44014917362413525;-0.43007067787693393;-0.43827166468828793;1.5631762622863894;0.53460920631853148;-0.12345316091162969;3.8474312809828088;-6.5391768700498778;2.6787144919278849];
LW2_1 = [-0.11115889330121233 0.27251118113210998 -0.15634334166103422 0.29037033837952303 1.8870380525381845 -0.35660354084189366 -0.092558665488730887 -0.8047594376206243 0.079179369026858959 0.28697742409953836 -0.18048813263617794 -0.10086766655958178;4.9200187731159151 -5.6929003080255658 0.41066236547212592 -2.6001653939124978 0.45365986420338278 -2.0021652529121066 1.4775152418068154 0.73134959198390115 0.61383982193967435 -0.034218113790844662 1.489716473891171 -0.054176195752324449;-0.51528343623440731 0.15144327743529062 1.8207509991633051 0.73562594852645047 1.5209570292060131 0.28959814328388128 1.4437681604294406 -1.1439423807970606 0.88733832635770316 -0.94956111632922069 0.35800231982112901 0.27783158483620252;0.6222108729643574 0.19187206492799053 -0.7685146849745127 1.3786904505946673 1.4503064586712013 -0.042125054219103418 -1.0298577847157706 0.77029088035383564 0.71389816643089632 0.27456722761658647 3.3605598505195871 -0.39434240471516169;1.0476549462766955 0.45382759428206382 0.37257859189453307 -2.3884275955581908 1.9967444607349889 -0.99515794538654156 -0.14363051205840602 0.79130776020895077 2.1017513137523314 -0.76679468406016471 -1.5824268193401867 0.76780608635943204;0.72161803762927368 0.021738274391944187 -1.7276264882185373 -0.44403871836843739 -1.3233022184982977 -0.37045932538755016 -1.3893940183062985 1.1525210793491998 -1.0643971348878243 1.0698432399322892 -0.16323539715943813 -0.26681791175305358;0.40902393493685019 0.26853969139180178 0.36635505189715262 -0.72200236061807666 1.4194083950040588 -0.30438925579113618 -0.4953591090373069 -0.4707968504730346 0.67028165656783956 -0.60104393057489947 -0.40285788055374233 -0.086276531636484133;0.49519649851547176 -1.0579408949383513 -0.62050855453631881 0.96838891217831879 -0.43052777833897571 0.930600401544185 -0.29879349211150102 -0.15913693832232714 -1.0886565710566005 -0.42236369124111284 1.8160681637570639 -0.99722152141775655;0.50981438603628504 -0.15087297711934608 0.25148025249497064 -2.1182994874451508 -2.451832276648751 1.5460041918815792 0.054101605495705252 -1.1124228596690022 -1.5994176682071795 0.75652440821808931 -3.3606721891587039 0.82215416424715226;-0.26627838619349198 -0.57805862522470319 -0.47620386129929959 -0.93887173430100601 -1.7371440974103156 0.56758724023784168 -0.10151953732376404 -0.02244736807078394 -0.10050771655142146 -0.85704595631027547 -0.25618123687045979 -0.20198746913378873;0.37793992055504599 0.84785593101322787 0.9405735289350704 0.43578284471642192 2.2890331317067689 -0.95850351161416036 0.1086103549558509 2.2070164575051923 0.60569219335542201 1.0217952238581105 0.13658106252763413 0.49876325354632328;1.6042854366543273 2.99837375804176 -1.3823999756963488 -4.4731044269614504 0.71057488020790815 0.19604802598363719 3.3073584829027292 0.26867471846416452 3.2118188168941808 -0.44730619909431307 -1.3015722249846231 -0.9776859737866459];

% Layer 3
b3 = 1.6280961234775864;
LW3_2 = [-0.91819040281197173 2.5530812197497639 -2.2665781268524299 0.30114940909900129 -0.73418157275127915 -2.1589958776913303 1.6636683700984594 -0.52114523522788903 0.17879814051278997 -3.2425939248576623 -1.2208369812545219 0.52522421166649524];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
