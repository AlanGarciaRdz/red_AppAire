function [Y,Xf,Af] = NOXAguilas12(X,~,~)
%NOXAGUILAS12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:13.
% 
% [Y] = NOXAguilas12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.59485169173854646;-1.4483408229995292;1.0564590713658082;1.5705528696448625;2.0205031068918733;-0.93200193663695929;1.1822106627521991;0.75020920070449559;-1.3730233829181788;2.8084549586522032;-4.3477906212575359;-3.7210083372905167];
IW1_1 = [0.40840556084008139 0.80637649843570114 -0.32012020711698669 1.6251116206403247 -0.41228869406599628 0.89634277468906465 0.074522864959879809 2.1612745614286912 -0.38565598650986677 -0.40144321223651053 0.16069454279662218 -0.47749923280011641;1.1711445327356571 0.43005658067736002 -0.08259451076071897 0.45900704181985508 0.10101548627777063 0.72590293091744207 -1.645680311194323 -0.19385775288545704 -0.7105592434674104 0.49518354095839717 -0.33320799307958116 0.3074698977164001;0.86458435122092969 0.34456201390886654 -0.64297258653331191 -0.19508773342976748 1.4621858231477927 0.89196132788459326 0.71276795268493365 -0.036010546857812145 0.99330328971589366 0.074228983320724723 1.0218345116824288 0.44007905598877395;-0.63843743213295023 -0.25357999321384633 -0.24982727281138908 -0.08960042693186826 0.36279415643494473 0.31231307999544522 -0.19518118058489786 0.27629541387783246 0.23260750485409282 -0.26370511425818499 0.42496219142080383 0.019162916780743323;-1.8184958589321092 -0.72520537115324324 -1.0171391909303953 0.36560129577215261 -0.10351071340458304 -0.99942332842385384 2.0994205162965502 0.93173023932456356 0.95020445113660423 -1.1180273923642048 1.1268686950502944 -0.5898891705203676;-0.051985423810375367 1.2881897221799257 0.37856472039583983 -0.66026123531061953 0.5155015875131721 -0.24613135591801191 0.58466329900473601 -0.32505809269998065 0.050758193012282272 0.90613353641443095 0.28481505666560508 -0.33498519455458708;1.5810189700557835 0.057565825354082209 -0.024483570781864385 -0.72410494972717132 0.36220170245353778 -0.62332508930915476 0.56506355572352895 -0.19316663248728347 -0.015269700841673468 -0.55081415868701822 -0.03170912944400997 0.60886999095568306;-0.21211594565653641 0.5947049564632032 0.1688138853235695 0.16169757490551509 -0.0988870089373933 0.14015394128703923 -0.0025045328942329653 -0.11400671206317356 -0.12792063906489637 0.24345757198324347 -0.041258428416603432 -0.23299367273656948;-1.0732951493826162 0.52074570955387534 0.37045762592709103 -0.25277609750995172 0.10074872239775058 -0.46618027485809377 -0.15014569687439169 -0.3118469982497224 0.093912014622611728 0.23526680654015955 0.069969491582947838 0.046952511695006645;0.14574980493490083 -2.4822266038142518 -0.30983374033804661 -0.21584827044901633 0.041060389098647107 0.64046062199479226 -0.17463559083424771 0.069170828382980831 0.10626481092074209 0.79988343473462542 0.0026587281700316706 -0.50562519585467147;-0.24454579732501738 1.1356358330326182 0.40259907307000892 -4.2677756815546291 -0.029229503933465757 0.27137965057354202 0.20114744654418912 -0.13395732497398449 0.04168997925078604 0.5065178181968728 0.13875874677486574 0.18439272162008824;0.25253641532781185 5.2184712364171491 0.052489437642856754 1.0126482839126674 0.053140770683050786 -0.29107009072937801 -0.084239588522442357 -0.12422968704910202 0.10111480940735552 -0.066695405615498124 -0.032473310456145058 -0.1433311322078385];

% Layer 2
b2 = [-1.4346339822383367;-1.5616580924671073;1.4870299392252304;-0.011607272592628644;-0.54431745520700625;0.39505578223230381;-0.4160860545510463;-0.07022861983172303;0.65482569445190675;0.13646383548463034;-1.6258508098311213;-3.5227487495736098];
LW2_1 = [0.53187756165546762 0.43633905562623854 0.29764246622944934 0.16032642518856868 0.45195511346303846 0.1203631070509226 -0.23572280755496999 -0.32286162076450275 -0.030358853081463522 -0.16798070236412321 -0.047809752614034036 0.47286384437143258;0.086312648758316013 0.78050798690806611 -0.22563841659386494 1.221568875095387 0.75015176192936739 0.45993447511597779 0.62828358192282663 1.2004325746396023 -0.006058001983147137 0.92226211226083921 -0.031744644110341572 1.1573321122098212;-0.12269978474257999 1.0022787963196782 -0.4938692986465481 2.2390634710142585 0.66445491269128609 0.89760117293173003 -1.7479612291180513 1.577390281520815 0.18415174109023946 -1.491008413579527 -1.0129750942719324 -0.62299820785132476;0.011213169653744652 0.21847063343398748 0.14567717516412915 -0.72418106896127588 -0.037010887429837477 -0.30664523767772206 0.27475280436840777 -0.66759309536337996 -0.058768128842698421 -0.83891454377820485 0.018902439619793862 -0.89856685266437486;0.85526184549485273 0.72631060011269932 0.21379976107495338 -0.13422074642262719 0.38355759106056397 0.94448203786939 0.046238351552744 -0.81767533815822624 -0.42464267816517604 -0.26117787708191326 0.65326514465066987 -0.20237928694486909;-0.51733036652746356 0.66747777921825613 0.093975275420368043 0.70285178315741459 0.50883480732351538 -0.57491111449551935 0.51028892491297184 0.67069157485238473 -1.3167567338847135 -0.51003734341175189 1.213255131091461 0.9088022931131039;-0.77952048336047919 0.82084324450949298 0.017811888809089911 0.61106747020832564 0.55144607445246419 0.066117013933975149 0.31168428320057029 1.292927425931709 -2.6174761620137041 -0.93977663472116368 1.0484420371390544 0.47133187716072927;-0.18955705391503108 0.67420943212614382 0.2995985711376129 -0.39802690111846528 0.17269159057751085 -1.6950261606376495 1.1890960219920703 -0.010963223191584276 0.75958722272028423 0.91249282694731781 1.9764102417686626 0.071204221760085715;-0.23282802851608306 -0.3831373796421691 0.2796184687700623 -0.55880865815884906 -0.46802169443608643 -1.5215694326320142 0.33678563886333085 -0.47888037324572408 0.75568910238182518 1.0418874326059997 1.858360450157079 0.1993032309103745;-0.104404469548471 0.99191956261073821 -0.58623020993892194 1.1271029428296271 0.041300241643627639 0.091630963318079364 -0.75157905290548888 -1.6699160964814028 0.7675172023063267 1.3219484559861956 0.66703990644957656 0.66378877116404444;0.036024937191988252 -0.11411147261598202 -0.62232226180507111 -0.074699680585573483 -0.49802276572783238 1.560223092541317 -1.7225502725909949 -0.71691770356409901 -0.55616966673020285 0.091833998554757323 -1.9816380076856159 -0.77892009562388687;-0.22744229663516066 0.91247389755903607 0.48644241868303761 -1.2610387799765226 0.69976258198702734 -1.0345480248946843 0.57364233765294859 1.3157137832755936 -0.92727677182384316 1.4132843072952126 0.23219497015144178 0.47568645132350851];

% Layer 3
b3 = -0.0041249109971058665;
LW3_2 = [-1.1076100934843611 2.3708250279915251 1.5756600319805649 5.038821923335048 -1.4395529449953837 1.9306685513341506 -1.4041147286139284 -2.9264384456056076 3.0009449176608611 -1.12703493517856 1.7034721669686588 2.1484206648070252];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
