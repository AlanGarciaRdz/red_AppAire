function [Y,Xf,Af] = O3lomadorada22(X,~,~)
%O3LOMADORADA22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:41.
% 
% [Y] = O3lomadorada22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;17.6991150442478];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-4.5164229521270745;3.9353588047761328;-1.1022809046750544;1.5813010594277999;-0.26648602273734939;-1.1507181370903183;-1.8903266890379733;-1.3339120391329378;0.91287702686175709;-1.0685403813741152];
  IW1_1 = [2.9999107666802542 0.99347112645514435 0.27350020156935428 0.42110282990690462 0.26643545270913294 -0.73515787426283996 -0.82015090512703359;-0.69588179801658268 2.3928340883582999 -0.17779109325933629 0.83565186568102601 -0.022903612122150384 0.2657910445754349 1.1386409174489858;1.5672713054237437 0.15573873187630977 -0.36340953779428498 -0.12482989588975217 -0.099656291721969353 0.067470012222594022 -0.71425391743670996;-2.7413453284435292 1.040629129242675 0.91906166397529632 -0.61176784157081243 -0.52754166357893006 -0.90657861417888941 -0.66563082039137833;-0.14922076691049441 -2.6048624828305535 1.3576054851343278 0.92867920539677451 -0.58875015351261317 0.38095569581389116 1.7161278310131662;1.5370176071022963 -0.18225387309280078 -0.67156148589350095 -0.18447869845877049 0.45042046637088778 -0.049802933975762985 0.35722772721946155;-0.38555783851195202 1.0721151058627665 0.75827782733582483 0.18624445068069179 -0.95582998181176437 -0.28957830302854126 -1.0762609930577154;2.7967952906783289 0.24441110323281792 -0.9009908723023089 1.4022195362874388 0.50315696773591845 0.058769639334429323 0.2208333382260132;2.4040335462113398 -0.026921249007740247 0.099190151651337322 0.21784467738654106 -0.24395760001356628 0.054047791402475995 -0.14040553916681425;-0.21440901021325001 -0.15660953634317687 0.31555693993517375 -0.28641586013863041 0.16206668237667649 0.3190982058253698 0.092351422561957219];
  
  % Layer 2
  b2 = [2.0124546226656794;-1.6922690737692903;1.1146309490632496;1.19488947433813;1.4406397291359649;0.44566984111553554;1.4970817177447837;1.313619409627278;-1.24190699382336;1.3086557941373242];
  LW2_1 = [-0.74133135490293844 0.5729230264153925 0.089070797970848409 0.28637279462509491 -0.17203997003720928 -0.84114284356448343 -0.46928305718275737 -0.28502966545602071 0.93262959884002961 0.72734406657850548;-0.16851619049701638 -1.1488441778835758 -2.2865026241735791 0.43560537974487745 -0.80491368809464914 2.217226637575997 0.98528808292427428 0.18081963194124395 1.2477339685291766 0.32557572516810929;-1.1703298887533815 -0.14479058473321577 -3.2025599602577661 1.1063081300450575 -0.82891240505956576 0.16979366518465491 -0.38967700285947987 -0.046965576943112222 -0.73972612955485884 0.17481791894461943;-0.11748284963336315 -1.6217562570853581 0.75295328771441106 -0.43255905390241595 -0.077960984471050959 -2.587919079070732 0.27165813872248873 1.7690545232053045 0.44979502092923013 -2.1557158052020196;0.10451494847546172 -0.96262901491341635 -1.2357170582112309 -0.84350642107408313 0.12412269612364986 1.1669127106500168 0.76255366685588266 -0.060932025866566167 0.76720914143968266 -1.6930390656851044;-0.66440239306955695 0.099620046068654114 2.4053036986262488 0.56263357703537775 0.15872262583741462 -1.7407219752425869 -0.29966273300263857 0.53007382148328386 -0.90410705480419795 -0.48556781584908915;-0.72599137022901561 1.7732148418973941 1.3252222044950597 -2.8206791414808969 -2.4639458974088289 1.2203147333367552 0.48587847921921085 -0.19272795967180126 0.37579453200432372 -0.033299318751523338;-0.69379086441241355 -1.0934103018628361 0.34806105563657486 1.2701867358331309 1.7072413798194177 -0.87438257218870075 0.31911371872312344 2.1831471561571805 -0.78462747606893724 -0.81025490815767531;-0.55432723002991902 0.1071740156501573 -0.17251936828438261 0.17992351006001397 -0.56908985959257108 0.9944460866603676 0.080129286826049348 -0.76364835993826319 0.79161472588252502 1.2814108661758148;1.2706614150931692 0.010206904947677157 -0.12313019509177388 -0.58785910325829072 -0.55137368387773811 1.5168412019280031 0.0038957918178280926 0.39387020288253538 2.2914629667856179 0.71887670813942905];
  
  % Layer 3
  b3 = -0.71558780730759031;
  LW3_2 = [-0.78785927161527292 2.2706796296318035 1.041958144630883 -1.2087033043360578 0.67128349133233545 1.5843453139241332 -0.39882950899938974 -1.0139723310599744 -3.096549526652614 1.2572375977416097];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 17.6991150442478;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
