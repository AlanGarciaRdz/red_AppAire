function [Y,Xf,Af] = NOXLomaDorada15(X,~,~)
%NOXLOMADORADA15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:24.
% 
% [Y] = NOXLomaDorada15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.00280033604032484;0.0179856115107914;0.0558659217877095];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.9017312884987869;1.2595703523526427;5.1799533766548489;-1.6638358329719789;2.1125204033724754;-0.086438538914863389;-0.89864570739117899;-0.017255503202461619;0.46137687355033036;-0.56160116198443832;-2.3664924978849409;-2.5291556687512835;-3.5675735101072403;-2.3688945690091052];
IW1_1 = [0.11154635076388261 -6.2449296498241882 -0.10663150920282445 -0.041711714066132728 0.24803347326911468 0.11062028219897867 -0.4491124203946687;-2.5408144807729869 0.59209964923329228 0.16744007401239935 -3.3643873937255941 -0.41334531056167023 -3.7559391722770101 0.72130012781265962;-1.6407257670429436 0.56568987299515061 4.9524687113459125 -1.4067591866247693 -0.70831113470873175 0.73986395576636299 1.4655070299467268;0.69535965772460639 -0.21622169910885577 0.17573483525672526 -0.63934847542689865 -0.089984424888812808 -0.30445598439007171 -1.5935535340126357;-5.3772928396139381 4.4597318332299549 1.4408812267096802 1.2296257680009228 0.25411480204801262 3.0327993382064982 5.2200107340343038;2.5565218661004447 2.4375249542975843 -0.17566100936660595 0.61106603910177482 -0.0034722925103020143 -0.43048623445018042 1.2404818467201804;0.0039862252625750515 -2.6976607738039688 0.017440325394004971 -1.1774468484710774 -0.62306367978675903 2.4787931650838551 6.5112646161858061;-1.9138386816571482 -1.8978092691917743 0.0710694769748174 0.25090546909406819 -0.15233289935323521 0.75738040618389069 1.71482867822018;0.33752502077834062 1.4599840105231028 -0.42420338051631007 -3.1939381926005552 2.6684611413614236 -1.6197869410438075 -3.8104193425509743;0.28075351906571044 -2.1460947202787697 -0.75360824802087634 0.46044388937983349 0.90320800821301672 -1.4325756711010842 -0.81981250888904744;-0.69700179123440309 0.19468151245812682 0.76658246124004481 2.5770011241685049 -3.2801719077197675 0.81830928565891714 0.77484587011092088;-0.81441173749536444 -4.27551255668119 -1.0933350889042257 0.21339634474957758 -0.062997934183324736 -2.5073977856699901 -0.29555125713056318;-1.8089005921946926 -0.33448902453695845 0.10252155916484813 1.6051608026398285 0.16036257369096829 -5.4964034211124222 -1.474318366572247;-0.32880465075813509 -2.3180451182450019 -0.51196059820460738 -1.7295395011354844 0.66863952262044002 -0.44150136350405861 -0.58775634784751896];

% Layer 2
b2 = [2.7773613630920448;-4.3197040975025764;5.1650960625566471;2.4137510554533952;-0.85252250388169604;-0.54879058667724867;1.3510744101753847;-1.2605258673809441;-0.18895278450075681;-1.4950451424445763;-2.2170891462560047;-2.897116435604179;-1.3599114541741528;-1.8027274958133075];
LW2_1 = [0.60819369170945992 0.030989022251657269 0.31969989076006011 0.095193931097933338 -0.17854238794382607 0.1110403168412612 -1.3204494367661614 -0.97425990304893495 0.12313122573060724 0.52136648278730346 -0.062138415277034537 -0.035049990014837412 -0.30296736331528212 -0.53472039927860571;-0.96900984897179221 -1.5835588950673998 2.724650403091573 -1.0737073777729604 0.50068516791675366 3.2632250057988115 -0.14908795402010108 1.3088362147242234 -0.036873895262590273 1.0644503787454556 -0.58439472557383765 0.055548620224355805 0.50290395432121726 2.7641356932223387;-0.26018537760931199 -0.62707702862130166 -1.038876534821684 -1.7217324776269358 -0.50004459861618389 -0.51051626868926092 0.11133894291870253 0.140085103323834 0.027234709151256198 2.2224702745272018 3.9942556355498464 0.09287876525412439 -1.3471259036420105 -2.9048332517166733;-0.51496288096360432 -0.12440234936884216 0.041621290424509946 1.4052461896664663 0.35672187070830996 0.12308321919177338 0.74724303188262575 -0.17392355361802075 0.028444827270535194 0.012904725762107286 0.44599775829478022 -0.52168739912465967 -0.20156699088481569 1.5811242364638451;-1.2878129793754916 0.44063106828478049 -0.65198738630767727 0.62678890118231012 0.35663334768013077 0.19776253482068556 -0.057629750117857932 0.60409175812206817 0.050687317667159469 -2.0125747749883751 -0.51203089930650125 -0.049276205209392708 0.62819851018775053 2.5732962569959938;-0.92738999455450244 -0.26570292871263307 0.53791643581063098 0.63026980059278037 -0.0065957287115429118 0.50510832282190288 -0.31877830203895624 -0.066170408826236052 -0.26775541406458259 1.3670815366125226 -0.32048121159811399 -1.2355063724866908 0.076624120154550793 0.61877099178313089;0.95495971106376298 0.079979759646647719 -0.64317406327929094 -0.57961915876453207 0.15627075490427847 0.067138073847752847 0.36750532984330697 0.37930937229470607 0.36038863353807887 -1.3895829080001758 0.2012714696499503 1.3183883516741817 0.56339064532110439 -0.10251606400435578;-0.34242938969604531 -0.39409329532322129 1.325051937863708 3.7383004155112696 0.61116331194181139 -1.1538248076586897 -1.1348415759844812 0.67190156539527568 -0.6286392227965768 -0.64436535897270719 -0.52494454864089934 0.46438496565150456 0.22157444892490558 0.4326118663340387;-1.6766447945715122 0.26969851519330645 -1.5988841205188864 1.806221842948952 -0.050387186405524392 0.034930259757649719 -0.52362051554499844 0.066006160949324946 -0.58798567790545775 -3.2032315542800913 -1.0817832828642793 0.69225967870317129 -0.58518044729441154 1.4155291755533583;-0.87925108214115977 -1.3275516519982622 -1.5353746684371561 0.65813017099117055 -1.5413513791942042 2.465687944707303 -1.1478510873703731 0.83677279486784251 1.0317670427574315 0.35568811178886434 0.77750858886605712 2.4844647449489345 1.2238369506346127 0.92493395266325551;-0.94028122610875409 0.3030045257316909 0.85004266456078015 -0.10168195783985445 0.11397558700328629 -0.59734278043310618 -0.11419831355673454 -0.80826416037661641 0.17413457333651686 -1.0217416123768328 0.50570934523104805 0.44745885629173604 -0.23241221331999939 0.9242628561016244;-0.25847067292575571 1.0742229868097448 -1.4089283133306334 -1.8037707787603161 -0.99003051034710687 -0.0174461489710162 -1.6661844606811647 2.5393739438067384 0.22252292715248476 -1.301332134601813 -1.2489717973371877 1.0847969753231292 1.3089507833889884 -2.0435997615718735;-3.6116173823019286 -0.12184269795117122 -0.37084246020873207 0.4671073074863864 0.43176157707137547 0.2880255743709807 -0.2042398487318032 0.65190111320969368 0.049503971778564269 0.69066839359178978 -0.84313101162637605 2.3728924684359658 0.11038930803074797 0.58321359287778107;-0.9797649280021461 -0.16945620874658437 1.4736539761153771 0.26265785892876425 0.30996090906520035 0.32153114575556124 -0.22985864101690326 -0.48503499425667385 0.18156075687370488 0.063325553824092273 -0.069293342545304337 0.92859181590044304 0.33493199767011178 0.30747132131132737];

% Layer 3
b3 = -0.074473213638783509;
LW3_2 = [1.424236343571927 4.2821822548647788 1.6803700898941163 0.29372676903224698 2.4213414371066433 -3.248727684026032 -3.284951102591553 0.77639883978938129 -0.61870024942037749 1.1416704237245796 -2.0554620625049216 0.19647900126878137 -4.026044444284544 1.9280032047400326];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
