function [Y,Xf,Af] = COAtemajac48(X,~,~)
%COATEMAJAC48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:28.
% 
% [Y] = COAtemajac48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.8423200315807193;-2.1954580641429695;-1.2147632962515478;1.3176734921141857;1.7656923689926813;-2.0111922424259823;-0.87335286917260768;-0.21224110633966597;-0.89646798617116685;1.2048283460128744;0.10301039463038539;0.86936675127084662;1.6889076440385562;-0.37679317127258433;-3.218333663028329];
IW1_1 = [0.042973247027199485 1.2229570493859254 -0.78371078608887856 0.14330425923659226 0.27734823194752956 -0.65945684236815805 2.3996653248954178 0.16469583141925881 -1.8317521969620807 0.022844762820047569;0.063605164985398407 -1.5389831435969572 1.361132412977099 -0.094224539828757267 -1.0439131977561982 -0.33254388551245972 -1.0986272029927648 -2.2696671575486045 -0.1983815351798135 1.4643411100704142;0.82941191939833647 0.37419581336096247 -0.23711674685573192 -0.19517524616429294 -0.22652673563675899 0.84334830424602703 -0.22354935601742934 0.23259420790058832 -0.10070630073508759 0.39155313742801134;1.1363972224441612 0.45120659902314181 0.90765636792355597 -0.84672412857559731 -0.054542492606814992 -0.28106390380527441 -0.48331694512776291 0.71655592332388174 -0.18829695736900751 -0.27584347849070534;-1.0144222655939523 -0.026275244323131892 1.3809469658871432 -0.11855752490785312 -0.27460719745060663 0.46949011461039047 -0.50036632168660522 0.50270125443895353 -0.18561985475754195 0.49458403864396683;0.18171934950092369 1.7883030381416192 0.07775974403433461 -0.91037214272585798 -0.25737792210961669 -0.1069971891067789 0.023333304260501314 -0.52358011937736526 0.3585106908084198 -0.001996371851210725;0.15058660889201733 -1.3891527667657966 0.065245904375795846 -0.70786291575666349 -0.17511442418055478 0.22326168779068939 -0.16796764308089757 0.14177663922811576 0.28060415371234759 -0.029783634456946331;1.0319582880060885 -0.99947568571776679 0.19665570663204873 1.0386393795962947 -0.14055683225051158 1.0174103767947713 -0.061407465151169377 -0.43043865791927116 -1.1444859098907827 -1.73628139922967;-0.10754147491088832 0.84766483950848448 0.030924954856711335 0.24944466900925805 1.4509379934978883 0.4805211394484758 2.1296604831247365 2.0924413987396533 -0.70602851094848362 -1.4357869803934755;0.015860197704678065 -1.8853372318330024 0.012495319655097613 0.83480340430822442 0.28000592416497927 -0.61171447975765958 0.1682561919062775 0.72493562097957476 0.091021960019579545 0.15363053193480031;0.37581399147577932 0.34670933795766373 -0.94249037236782163 0.49359063500940648 -0.0058554898385374064 0.74333745268510609 -0.37011003723974178 0.80535472695781274 0.3712443918384507 0.54631412994721706;1.4482392075843937 1.620077568880482 0.93258012908690113 0.16701400203241745 0.097014176620857095 -0.31057628185455266 0.51663473501523249 0.23925840678199894 0.19260018305602442 -0.68714645290920595;0.13918273989479929 -0.80132831246702108 0.43812113976822237 0.1666065826082524 0.047614791597180038 -0.12875021279821935 -0.24311528694261836 -0.17095069666256935 0.025395663791018562 -0.18350574693474847;-0.23097335125416199 1.4507617036939904 0.59633825708092303 -0.20704868855231601 1.0862586501534286 -2.4609354759263522 0.68115688647626649 -3.634330005766039 -0.79659847574411446 0.65085938362349038;-0.48828878146302118 0.086716645161389716 0.85478699984253681 -0.55818957981458062 -0.51576907592840859 -1.5380238446475401 0.80730544098166734 1.1559285419963732 -1.8465651962009482 -0.46483832770335326];

% Layer 2
b2 = [-2.3459388645994457;1.9785846379517242;-1.5851559507622166;1.4787222805020104;-0.47367189343078492;0.81944876826161894;0.71001428616220885;-0.66667291949244212;0.19813715333533483;0.47269320941920301;-0.70541577291297419;-0.37286758338989406;-2.8968085143377946;-1.701070885895746;-1.308219245157896];
LW2_1 = [0.78998959768982269 0.9505101280250271 0.12039602480473793 -0.54476790027862576 0.79809871474991589 -0.013762436424797984 -0.74864219660647968 -0.28318162052364571 -1.2094937651601538 0.071115070426072513 -1.1933266691781816 -0.50419743965026542 -1.3425976400418227 0.66505079163817182 -1.309968687162087;0.08230843512292578 -0.55197455741757617 -1.9835507873195808 1.6185847500230879 -0.64557887191913343 0.8993229779568831 -1.0352145295369255 -0.080915961150458654 0.61383559197884774 -1.2020913491754865 -0.20550830723142641 -0.64604086755552059 0.66266472245785013 -0.69135483637031037 0.85331892540252752;0.43469480834378671 0.18638729415585317 0.70831789042012472 -0.53077271004320192 0.28490703455126876 1.1038518683935206 -0.24845009931355935 -0.37647747594441455 -1.0288570688944478 0.024649339342023225 -0.61082265905530309 -1.2205718018451053 0.71917665749649407 0.35707016413295417 -0.23192810638352124;-0.1900531707032051 -0.25847923286570279 -0.24866273730907779 0.044594872594648102 0.35159199214938625 -1.7811610797057413 -0.93709583050606227 -0.3090095600868108 0.094823760545383953 -0.29184626757130899 -1.2269623805209129 -0.5474022972305761 -0.11437517992547508 -0.19390675097659368 -0.20610059646479048;-0.041430070695346086 0.27471791631749065 -0.38436475489161592 0.15601495435058116 -0.35085426814385873 0.6868781932168101 1.2434634879315696 0.1757431889700998 -0.23770089099989716 0.8393716711994057 0.32195294572513916 0.44199681817570885 -0.51730725483092632 -0.40348651578391331 0.93116308341519638;-1.3819958923943918 0.17498426167764347 0.26399945754175258 -0.34076894108271527 0.58950149374546901 1.0633744825115197 0.95763802985306734 0.32422415413861333 0.87933598375261524 0.37563944123351817 -0.50356560905116832 -0.70593777206507469 -0.22082991018935647 0.78591794831402917 0.051759306989643254;0.80884700622875139 1.0943773487703898 -1.1662133190595436 -0.28806799951652862 1.2727371023010126 -0.13466976719997278 0.47826633670978064 0.44087188235657832 0.48666544491211822 0.65766797880895955 0.663737975721028 1.2599321764240214 0.40604439291884992 0.042487560601586739 -0.89859248908393397;0.28667247138148932 0.24923434538604614 -1.2265678852554327 -1.6009918007889947 -0.12357673577610359 1.1797921798022615 -1.0074837754587711 1.53149172973573 -0.84273167140696237 -0.81740730652719695 -0.70252335466268845 -0.10230384127396398 -0.4047186133016068 1.1144428815452769 0.16441763804245896;-0.59935934344451025 -0.46787380561094716 0.73926972594926788 -0.35311377973509123 -0.65726934935428172 0.77488994932980848 -0.29277256560560755 0.23440266917670022 -0.24309769463539699 -0.32396808435881763 -0.88934788358063155 -1.3459616188737871 -0.34008006709430533 -0.45206838555723411 0.25562015064716537;1.2096709761701638 1.025729288539682 -1.5696454249889971 -0.7628982670185136 1.1193960154884333 -0.00033351314096863316 0.67708594887721729 0.72797149673746298 -0.4992878878263563 0.73308431459032952 0.68262094117392058 1.0970479243018731 -0.27222396415878902 -0.27737548997890182 -1.3026239950872647;-1.2257777827329353 0.29589754454160766 0.94393159156192841 -0.8438234132806558 0.18582895256003332 1.8644169550442076 1.5824443840094302 0.080930805785966606 0.34597571357343276 1.0743511265641681 0.69112643809262631 0.91100043369103334 -0.4395397198581924 -0.32476723050037909 0.37032765692921499;-1.2680408540289427 0.59329071169637038 0.16976329436155019 -0.21467269716447385 -0.13293924508282695 1.7104078874471373 2.9240220398230226 -0.23953239183629754 0.85037331324230236 -0.66089211850942309 -0.97286089045893354 -0.36458082961102195 0.86666063203808863 0.94440370853331101 -1.8957866870787032;-0.1431380767946715 0.10237011856881625 0.80697121856151632 -1.4650752445538187 -0.33452489345733927 -3.0023556410303232 2.1524007491614872 0.24939733127195118 -0.97058951637944468 1.1112569432427526 -0.98419307955598856 -0.3326443184634536 -0.74822705007060597 0.079398868746464762 -0.29666589670321725;-0.42589318286205874 -0.038008848278217322 0.91705245277174563 -1.6524047253992165 -0.23813103854968967 -1.4453831485507393 1.8191050158698432 0.29599191409288572 -0.42991782989051003 1.1981777267199192 -1.0378742009676238 -0.41548879144645307 0.12813272454636898 0.24436485923310849 -0.41391214205009613;-0.2730489882933913 1.7805304989006927 -0.53262726357616741 0.76276111330252949 -0.2832101564986147 1.5084485317281429 -1.2453976321032258 0.70123344413245814 -0.22116002023469966 -0.86632735466729294 -0.22192609348293657 0.34902599886217017 -0.39703928564317625 0.82889728796911233 1.0372853844210397];

% Layer 3
b3 = 0.026586371096927287;
LW3_2 = [-1.8799091579014733 -1.149197210928157 1.0751975375254283 -1.667076635251544 0.54001435320572932 -0.33268426019582326 1.1239468603337563 1.164970044747033 0.34361651509419461 -0.61191096602349448 -1.0439641678811291 0.14863778278078055 -1.5439337005620526 1.4101421490145767 -1.2414282156277421];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.201288244766506;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
