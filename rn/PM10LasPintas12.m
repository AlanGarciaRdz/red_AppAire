function [Y,Xf,Af] = PM10LasPintas12(X,~,~)
%PM10LASPINTAS12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:29.
% 
% [Y] = PM10LasPintas12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.0251256281407;14.7058823529412;0.0179856115107914;0.00280033604032484;0.0558659217877095;0.00576368876080692;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.0627271319250198;0.88470779837866775;-12.205940333054345;1.8061063484234745;0.16002610360173461;0.5891535127990194;-0.35987292305525387;-7.6044021611639971;0.8784928822356266;-0.77958942218053684;-1.5438453174380988];
IW1_1 = [0.57792319966401173 1.0234803232620686 0.24141495294752977 0.01700602440039618 0.24547619149694572 0.10379350576353502 0.82258485952938076 -0.029450897733344063 0.4160996667548042;-2.1840089182331734 -0.37701454304363524 -0.25553293135328986 0.046028405323478225 0.83916561396008704 -0.013294959149684708 1.3270521487649527 -0.18181470135045896 -0.40780847258830527;-0.22686983164794958 0.34680880971417866 -12.623779129946563 0.82660628442546347 -0.81417790019911351 -0.025960429747231333 -1.3468304460380229 -0.10965893888687704 0.60092085000637441;-1.7306985205966019 2.099578222643975 -1.2325093668392575 1.1507227776278968 -1.3271258132759203 0.49807372973906566 0.63173226227649193 0.34041025698078392 -0.13750306223539435;0.72031948660144862 -0.50397976835600755 0.56373017333922049 -0.35756932052504925 0.50572377054804452 -0.38454920106572327 1.2170173839064609 -0.04208785942020532 0.41863165521106904;0.61020561297704956 -1.2336448310354315 0.2114577378196873 -0.23743937367748166 0.49695565869496749 -0.10818903303521059 -0.24999889818153337 -0.13788700850464686 -0.53091623365320306;1.2011251129531824 1.5736908409140753 0.15492332391151639 0.066600880518089586 0.59494480218708157 -0.0043822989306343514 0.1984679514937428 -0.10672530037065787 -0.2314238752700041;-0.73897138246030292 0.41462359314223712 0.16382252078977355 -7.3213317302735268 -0.7314258924510274 0.054304273083154761 -0.66352002256463216 0.0010584588229177929 0.55932678812961223;-2.9239671310658899 -0.13153210479455157 0.62574514794657721 1.0016051100661609 1.0886418823873709 -0.05346220118640721 -0.69475841495318014 0.019420535519538831 -0.94979325081660404;0.5278786133471286 -0.25768928236228805 -0.21689066047742617 -1.4995978650794362 0.9400995697997494 -0.1517980137033918 1.8263735583675804 0.16991083519402633 -0.59656032019093674;-0.064312116560895818 -0.62294858005924425 0.75144527435954545 0.16945571838326967 0.50764772421189519 0.15075235698898376 2.2147056225089528 0.057652742271898823 -0.068954959415830366];

% Layer 2
b2 = [5.7339242689211014;-0.933881292184772;4.6602720139024383;-2.7187718313191707;0.19593887645671448;-0.45021242874264544;0.54981639020813755;-1.4006487665239231;3.1690036885477926;-1.7330375074783895;2.9859810560920672];
LW2_1 = [0.90544387250744485 1.410876404027527 -0.23294178361760837 0.29993169125134223 -1.4085874199135504 -0.4886107145135441 -1.3998145288306461 4.5687484992555012 -0.52267864186739998 -4.6709389705301287 -4.7406045907059662;0.77657782496826011 -0.77686892499336258 -0.019851805316851216 0.82099699294308104 -0.36136281630812717 -1.0351531684486861 -1.9194909471162283 -0.35060283221961924 -0.3777158643452333 0.20605518751062593 0.542662143266886;-0.81747262846250168 -2.3657844125668923 1.728186150155731 -0.25576930694179162 -0.84935489669240904 0.46981399999598378 -0.38637223624785383 3.3335251024298089 0.73401112702166127 1.9952026288948435 1.0492268937839289;-3.5907652956159999 -5.2225750348854172 2.5976300131919952 5.1611038287218456 2.3778940682415213 -0.32009237814467933 4.7519358485230478 -0.16157737624715993 4.4989795149699363 1.3643945807663229 1.8580512455649212;6.6285111203491107 4.7411374255007903 -0.058207471383283929 -1.7594936327995045 -2.39975738497809 1.843312561421611 -3.1626915036091696 1.4490484714753025 -2.2451045965807621 0.2334325973472528 -0.35772476054013413;1.3994891106938916 0.0744610201069794 0.018561234901678488 -0.50718146675532039 0.42834056821031397 -0.42198684848009876 -2.0312178935575935 -0.23197980609083202 -0.33376619241268918 -0.070335930834495519 0.42120061532464897;8.3587665786003011 1.5860056441692729 3.1414460034933436 -1.8044270384920205 -1.3862181599362831 2.6750364813721754 -5.246214808539416 3.4527751263255295 -0.049277844159165703 2.3872585370552248 -2.5160008878508289;2.2586856429860367 -0.41408988070249597 0.89689669636897595 -0.76439276391873767 -0.35527807773265024 2.6754450623102652 -1.9212250262565207 -0.39636532391545465 -0.2328088862278706 -0.20777351307383879 1.1928531103081015;1.0972511432161598 -4.2565347325372063 3.0156248832897612 4.489972354521262 3.1407726182606086 4.309220521327199 -3.019853024464199 1.945897124391806 -0.71269186687602881 0.90183104783274137 -4.4581738174184808;0.15832530374694184 1.6899971101721212 -1.9896602610327796 0.43011515648312387 1.4725336189003499 -0.77407734104216031 0.60556442395442966 -2.6410761588617269 -0.37491537548121279 -1.8628677929427286 0.86828997441543454;0.24620584692507649 2.5612707050783214 0.63308426174083421 -2.2847279024126057 -0.3864346740157536 2.385496939204593 1.6187041639748512 0.6389240346863071 -0.59019461223870651 -0.22026250071213871 1.5670922978209554];

% Layer 3
b3 = -0.34484352933220652;
LW3_2 = [0.33777335224354643 0.93924183493956925 0.66229818046591926 0.55461832853474424 0.85414163822661726 -0.50733274753901147 -0.55785506818882269 0.54708644566736409 -0.2088593761714102 0.81924997952683987 0.45121474444847848];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
