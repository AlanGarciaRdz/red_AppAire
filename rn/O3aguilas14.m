function [Y,Xf,Af] = O3aguilas14(X,~,~)
%O3AGUILAS14 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:34.
% 
% [Y] = O3aguilas14(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;5.42005420054201;35.0877192982456;0.0561797752808989;0.00588581518540318;11.7647058823529];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.6441665066418141;1.5917136714886011;1.331680993484941;-2.4806108517932675;1.3213412876316881;-0.0086658058730024572;-1.3702083691058;-1.2782587594740291;-0.23983002991726049;1.3559646184884346;-1.3870255933337869;1.6708406483883294;2.2742952342150669;-3.3414944100609127];
  IW1_1 = [-0.71923293457398263 -1.7971332470121704 -0.45943046779533692 0.022656044830328591 0.51897240155397628 -0.25459404960897525 -1.6848512565077669;-0.22439351106423028 -3.0648745649262121 1.4110721741903398 0.38840298816531554 1.0991044089361925 0.44880355669841887 0.69302784344484025;-0.91431146608352287 0.54802562305758706 -0.20370847940441505 0.27173964649776983 0.2489508968065352 -0.10961351046991964 -0.58981482078964953;-0.14396375056179711 1.2675167003657621 -0.72363579523538346 0.095687208117589545 -1.1955456286222115 -1.7657862638437893 -1.4048787948624066;-1.9314627315526993 -0.57392011573363511 0.21645619251708526 -0.099738817121067191 -0.47623647241394462 0.081500409661666093 -0.85287006795012577;2.4929930781624883 1.2254560144002251 1.11682768735003 0.47460171256723849 1.6584603367756596 -0.042897483780045376 -1.7770233516782346;0.73296884528093142 -0.14395005921573731 -0.028226674145130706 0.4746756222447559 1.1687260346539532 -0.27028348495888688 0.65734557295760065;-1.6520707466981994 2.5679014493967145 -0.55412455340039168 0.6575086115577492 0.81735532482628492 -0.080941547090760957 0.029159474178331035;-0.13647819754116924 -1.0384121121405683 -0.94668346405485349 0.47804557393356706 -1.4409326328762848 1.2754872411608766 -2.3981317035674605;0.57923741267371653 -0.54165700106422687 2.5603988292483271 -0.36184206936575247 -0.76059388784654447 -0.3642617204028738 -1.3930462025091275;-1.7625703557673453 -0.12122966544668237 0.25013765054743048 -0.18311408962783343 -1.1995139822556471 -0.15232988022438604 1.6939580837402104;0.55427087504244166 -1.3079951735092277 -1.2214197364258492 0.46759041833256343 2.3914392649462743 -0.85646721890036615 1.7794614126015069;3.0285991767767246 -0.58450930704775739 -0.12189519721916708 -0.054257802455053225 -0.66340920973553741 0.093445725912878572 1.1333168933717337;-2.1348950687485329 0.82147968716036257 -0.19553935011220602 0.10317215637460155 -1.9969700127199672 -0.19358999630983037 0.54570052252051637];
  
  % Layer 2
  b2 = [-1.7666482680838511;1.6887110923692707;-2.6251233785467152;1.5482579525803533;0.29191759181307941;0.25032372956264959;-0.52023811182515012;-0.97632743960095369;1.1483685548765907;-0.041478936621947446;1.8461975359416423;-0.82464390937722465;1.4054816787039712;-1.7555343937770034];
  LW2_1 = [1.1738010572069482 0.25358804953458564 -0.48631194110105219 -0.57533789063491636 -0.21313287080695645 -0.66275796608289683 -0.048968319580375237 -0.21959233960463836 -0.35997853612150793 -0.097143882837464168 0.31212425390806764 -0.61694102275756357 -0.27983038124579723 0.6604444582738116;0.86809872076244632 1.6186931238150386 -0.37810715166610032 -0.50663665507430244 -0.62789231726407146 -0.80619798007093302 -1.3874605611987934 0.95580443664147241 -0.52437633356433822 0.86574341831085377 -0.36394000716391917 0.49550377262066408 -0.14496928780009186 -0.30849300283413805;-1.3672311330340321 0.051321061819224363 0.28409457727065812 -0.73001334737320944 -0.31517643445441684 -0.87848130268938185 0.48443712405668926 0.3959076499195453 0.1543110776284341 1.2022419242826174 -0.46840275074776294 0.83492567078179658 -0.96780467903897904 0.39245527575402112;-2.2839426569420143 -0.25258560831674498 0.52642896785441795 0.26673429124386411 -1.2708370917183747 -1.6047499599782127 -0.17066506458013025 -0.47532319197731532 -0.27936203499264689 0.32041967184960501 -0.55645160543503225 -1.7720310435175524 -0.031734682259242974 0.051523384863829132;-0.5164666400587683 -0.69389108888797713 0.85424731250057939 -0.1772611427196823 0.89319438021885578 0.4333417285130039 0.39635598259736066 0.010219729084907342 0.059881827852746344 -0.36224116321670757 0.051251905032995163 0.29795280715343586 -0.74470020690026639 -0.015022438267826281;1.5492887451308557 0.87766228454941764 0.54364307636582165 -0.36854772348298964 0.10971262761899125 -0.24564378793418012 -0.847852146094347 0.46345237080875024 -0.44592205942316554 0.30564495224269078 -1.7145574398688606 0.31017318797861937 -0.060259363708630428 0.78644791641440659;-0.18708152617700133 0.1597833685155772 -0.57822876233638554 0.921618758641638 0.9631184549079248 -0.20165135070684692 0.8904850801054085 -0.22197897057487354 -0.61757182223391871 -0.48956558627271735 -0.2413104217378696 0.53999486539042818 0.70084204743404477 -1.2562342785577201;-0.1801899289818967 1.0194484580377292 -0.30261993146905469 -0.4088269403075846 -0.33499205001516641 -0.98354658137008744 0.67763425409881206 0.14997586365935139 -0.55699827543913194 0.98912609614653468 0.73973493371963706 0.16980076528419338 1.6635031478456437 -0.020066291287358692;0.97081931022955525 -1.3821239622074961 -0.22011145172967764 -0.2924907383533184 0.7950651497554394 0.86306892695599402 0.084406546713357511 0.84701578239553199 0.3306803459433203 -0.98916162555865517 0.68202098227804164 -0.26797062653225323 0.26239294311542705 -1.1475523219928849;-0.44505669349286869 -0.088701930404788951 -1.0291296899550981 -0.48484380324143062 -0.75094930950987016 0.56354240888296825 -0.59558033129803911 0.51035249972984631 0.12056692576955859 0.30559756285513873 -0.090187980740209173 0.5740233873680769 1.1273351650127477 -0.28161234202014146;2.5877905052359851 0.26233850740254405 -0.31255234685922051 -0.17796356634306654 -0.03416204516710733 0.67189943384427264 -0.63690885359558724 -0.4530285997959953 0.051585084575548432 -0.2439845145317463 -0.18928639145353468 -0.021974264393254016 -0.16413381301762703 -0.085225275369445214;-0.4275945419048725 -0.024152786376803535 1.4842905475655033 0.17142456604345765 0.79266652175482688 -0.26428904946225734 0.41126757638372946 0.074800611296524891 -0.34741589490250563 -0.22682776201614399 1.0532364923333153 0.092156692827334352 -0.058715761448753345 -0.52155514558947613;-0.0054430988940973868 -0.80733790008554562 -0.063257973827663086 -0.6248829075808866 0.32434280263765142 0.55718377311361578 -0.83171059986213014 0.72230544921461981 -0.047038012231052515 -0.33276697291018542 -0.67459761483533065 0.17429100779170673 0.1299608927965597 0.48106027247307176;-0.27516651270457082 -0.14875294207289319 -0.61561760052963255 -0.83232955156731225 0.70686903171962434 -0.63765816472913295 0.87385470048997615 0.9673574069733567 1.7113646379833254 1.2858560403963011 0.98819043811215268 1.0018838771962209 -0.3477819773132661 0.87453652789825409];
  
  % Layer 3
  b3 = -0.88934693971496537;
  LW3_2 = [0.44250527980098897 0.6656705588204187 1.0189101339292963 -0.17830553738802413 -0.87617212222111707 -1.1434820702343247 -0.19290373296730778 -0.64562242267153569 -0.60139722559665165 0.30091006337892651 0.58115238854297668 0.99252942900806995 1.1755528052081414 -0.86984137608170875];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 11.7647058823529;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
