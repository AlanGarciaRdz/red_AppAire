function [Y,Xf,Af] = COAtemajac5(X,~,~)
%COATEMAJAC5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:22.
% 
% [Y] = COAtemajac5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.4706931552400491;4.2383435362186059;0.5447392085535423;1.2697671629203255;1.3436915331665924;-1.9470987574877423;-0.61605590850950143;-0.0093677330565218736;-1.9033460041985768;-1.3049735125696538;0.50036909756668657;-0.1322914903848097;0.93166910569817929;2.256611769416089;-4.8338063654852119];
IW1_1 = [-0.86161239324840522 0.13133250593745721 -1.8874951817796848 -1.2359443845683711 0.49550890335607317 1.2046133648024493 -0.95916591501730286 -0.56595071540348785 0.44932570697475721 1.4617051350872154;-0.089107220675312793 -0.26802941101672795 0.072709688486587709 0.10511234950755749 0.19139107650608733 -1.2074287305268723 0.5054572706201963 0.31811146327335144 -0.33511295261868923 3.4890636587425132;-0.49091345456601099 0.2238536435304482 -2.2288066287634298 -0.086032244208157332 0.46255804496041458 0.72648910410873069 2.1606756956736444 1.3419581798674003 0.21573378092468745 1.4158528273084428;-1.4301182294582329 -0.19452976594277577 0.052459892838187097 -0.085891693593980786 0.11835863835071865 0.44576978262684119 -0.074044839938407006 0.19963295705508427 -0.20035290320369237 0.58254536859051387;1.6127861868212645 -2.5092055355914296 1.7826484346020792 2.422081896803788 -0.66456058131456286 0.3213083691231905 -0.32590484151640386 1.0674672780458032 0.47185412320635356 0.62848029443600728;1.4403494821068012 -3.6953523864207791 -0.028618651663079003 -1.5616824467914854 0.030149502832868044 0.026347502875567193 -0.34561764843624593 0.25476697717360269 0.30478375691131682 -0.26983848899784058;-3.2160929001970673 -0.92291268263977688 -2.8676139141973249 -3.9481869842301798 -0.23749866457684654 -0.58223703348026201 -0.99497347844986339 2.0574201706876876 2.3720218663421804 -0.60235337085430163;-0.62678681265955771 -0.165549670799951 -0.64852609006512485 0.10744771898512914 0.27596497190085612 -0.21027234584625915 -0.83598165416357939 -1.2319089006664374 0.099580531540213443 -1.2824944979025916;0.9447796918711665 1.9863264103634144 -0.40220850494999755 -0.49813213908739412 0.044073724048052793 -0.085081422031714815 -0.41853708047623039 -1.2779266405111316 -0.18311455878406396 0.11996993166644103;-0.69959518078937855 0.9000948914799286 0.34914359924958294 -0.25645932355809709 -0.00052709458060204613 0.097516483280954788 -1.6257667890247092 -1.0805281414878747 0.52023464311833645 -0.82426170841422364;1.1426524704545293 -1.8515958070670466 -0.012045264555265847 -0.23515228418766571 0.35638217172074638 -0.18661561210768446 -0.13941108717830286 -1.1067726559978379 -0.29769426657205117 -0.39459596366012373;-1.393407672121884 -1.0880469473141969 1.4434877967670348 0.42078976889620934 -0.44346054336779367 -1.2882536121503585 -0.87457834711246041 -0.99557297324666361 0.34801197114979204 0.65479674938982246;0.62580255968179965 -0.29909566048914488 -0.58653359388858839 -0.16733629558169039 0.59974162238535755 -0.73236136922687567 0.79784201853813586 -0.94085078697489399 -1.0123182740438823 -0.24801723436086895;-0.4020141183829673 0.059341178049564944 1.4490781344088048 0.40869968675263652 -0.094511739470556771 0.025646690996008085 -0.83695647907084447 -1.6674292471996621 0.16790246893580835 -1.1275610315708338;-0.11130458440323268 -6.2505367571766577 -0.50582479487115062 -0.70629773905747073 0.035635159041508165 0.12564931208872529 0.069455268596746306 -0.36637208224205475 -0.038530472949213745 0.01145971368637588];

% Layer 2
b2 = [3.5472658019149028;-0.35377401809994385;3.9861978237280269;-1.4264677593786106;3.6043581731396741;1.1431704657914696;-0.66948490303555541;3.9130389559545122;-0.098996592358311181;-0.43544608132211571;3.1141164369838479;-1.2518133565348488;1.2222519272496455;1.6376184112317467;1.5083641022106911];
LW2_1 = [0.5366194573262757 1.0986857103705645 -0.13067977106145692 0.16794201322951671 0.04858870376298928 1.3321134607998433 1.6800146727934333 -0.91065872945751869 1.066703749371537 -1.3769757932651729 5.1944220275551753 -1.5024825539965914 -1.1018325975844039 1.6376958290715316 -1.6382791882976013;1.837036246306035 -0.31832314958130936 0.29867765184750095 -1.1112110280305274 -2.2466691257162141 -2.5406766864272985 -0.74422478384861779 -1.8080226764814185 -3.6321060555913829 0.47473030897200186 -0.59421585218604156 1.7058283324575017 0.44518056643216231 0.04778825546185328 0.2257599728626086;-1.4088995767015102 0.94446518444182193 -1.3567704026770251 1.1489701947124804 -0.16375533930702496 -1.0136538680005234 1.8149474432123427 0.71889758938701187 4.211015616661939 -1.7678987955834236 4.1262094754431091 -0.61267229185654315 -2.1531811737610962 -1.5567464072367116 -2.5088406207110578;-1.2729174666023095 0.83671758647249006 -1.0024382721393972 0.66033418134413258 -0.40729247271051655 0.45113310251760186 0.96987874172842803 0.15156012937859592 -0.27269452359876067 -1.3558471261884557 -0.95845018920428282 0.15163233995441824 -0.58076562016136979 0.45732335284943704 -0.70584121444378567;-2.1786961985751754 -0.07431545151257235 -1.1361742645040394 0.38967114500256156 -0.61458138831897469 -0.37796093778626877 -0.23773816665632452 0.25831096884487315 0.1863183834455571 0.24085638738985235 -0.097588452900178785 -0.1431337710748305 -0.42905335632837216 -0.28135189900006619 -1.1598179638582848;1.2106465677329368 -0.80364334961609962 1.4078352209818106 -0.39492082982455989 -0.8757437155701665 1.7721284575852985 -2.9124067760266819 -1.9132911806527679 0.31414809291717055 1.5655859279062367 -2.5295292752985614 -1.3619952878613488 1.2174562487866818 1.5684469884669359 -0.1768996019031866;0.32209721270238201 -0.12511689636279513 0.30392301147533168 -0.25250192452562864 -0.54623277690774985 0.46557108071303044 -0.28873113197115868 -1.6094380806710797 0.30126713426668911 0.73083462353247131 -1.0715912337221289 -0.41675489681072059 0.67410472748801509 1.6294139282659947 0.091342052356186976;-1.0411896839414443 0.86040308663654408 0.5481380861829902 3.5508628750737574 -1.834004627755301 0.7764929641909194 1.6034248161357036 0.84797519363369678 -1.2483890792829133 -0.3788527017844221 -4.0345508465670497 -1.385494435671456 -0.8014913519755642 1.1822787976335398 -1.2563096854863507;1.7051875394084728 -0.36145602712244501 0.41649396853816473 -1.1172857899956683 -2.329860328148198 -2.6647034294854173 -0.87679669236983659 -1.5927740050600661 -3.5932182389726277 0.52354201373734777 -0.36596862179549278 1.7706202776278577 0.41885135270909846 -0.19201040748495171 0.21776565258207586;1.866867725361897 0.0081909686172436814 -0.073490440964537551 0.59253880553920424 0.37350372544145033 0.17976051697955536 -2.1887080274798367 0.42783169998276049 0.74722325291706315 0.24619588127260636 0.004304111391467396 -0.52524045987707435 -0.17273349060628762 -0.10435082975133073 -0.67756712880721714;-0.49553516814050835 0.81574981465394047 -1.1687684415358306 1.0283341057616893 -0.082729886102779385 -1.9927757386782659 1.7505009625256707 0.63858721214586711 4.057284599614893 -1.6232064662927288 3.8083434842792605 -0.49317089588600937 -1.9933977869888235 -1.296299430491858 -1.2802217113004291;1.3579728695877213 -0.87678657399099658 -1.1925962583814578 -4.0243021557245324 -1.35568281276195 -1.8055955159493948 -1.2267893305242108 -1.333323730051156 -2.5365260265184668 -0.10089127264328597 1.4513723452053042 1.4775977157422566 0.31076042397138914 -1.4557475059130276 1.2351855481121268;-0.26246799461209291 0.051329911677658692 -0.12445415020424547 0.17785018329105629 0.55862853201859985 -0.39417836987191457 -0.0038322614607353856 1.6203240025201608 -0.4271095070901812 -0.58100224748235019 1.0352248579677998 0.41261694346885563 -0.592237236133347 -1.6968327035307855 0.20311345071455331;-0.72265079311537739 -0.48659618485343525 0.73910302926513283 -0.44400467381677533 0.1250507008495251 0.58813027872905765 0.72893854374308298 -0.24110552128389023 0.041844098591843175 -0.11580796470627189 -0.3318095506539499 -0.0018159721854435315 0.045096786299766656 0.67396126939960155 -0.93424307338533907;1.3617632726405318 -0.72274107493095108 0.88573235125387395 -0.51515868254961517 0.40117393250982242 -0.31763056299007397 -1.2764164515375807 -0.25027578767740666 0.21034437176203716 1.2704542642593795 0.75045513952235088 -0.17804475469625722 0.54725668983384768 -0.27900111432218894 0.75946276035753502];

% Layer 3
b3 = 0.57572356000476443;
LW3_2 = [-1.9385465686403061 1.3734607131984684 1.9650746186789951 1.6639421386735314 0.24353797469746166 0.13870699957458377 -2.5950112834913499 1.6216906100306925 -1.3360324238229007 -0.27508584427408683 -2.6939668142794728 1.4308671490149574 -2.4100102984840803 0.74610172711832379 2.0156045134899951];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.201288244766506;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
