function [Y,Xf,Af] = SOXVallarta13(X,~,~)
%SOXVALLARTA13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:06.
% 
% [Y] = SOXVallarta13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;10.4712041884817;0.00782778864970646;0.0208333333333333;24.390243902439;0.02710027100271;0.00630517023959647;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.9275758002874221;-1.1628415780954868;-1.475332557154684;2.3924504842872918;0.80858292191513326;2.9271803615317817;0.16560600409614434;0.75710128234736618;4.2638426384320871;2.8976828221912703;4.2829108985884092];
IW1_1 = [-3.3427337263247097 0.3248565380514804 0.81929177781682527 -0.81299985917492379 -0.23950184444385397 -0.032126238800713372 -0.70762588460031695 2.5318627466272003 0.011591606117392609 -1.6799288439591731;-0.048337008392821103 0.014768442517604816 -0.10483425110191803 0.09017255222404523 0.038479026952984052 -0.022836320330269652 0.061758175293995722 0.1004083656336489 0.0028911620842755853 0.13058208619942377;-1.0890956218153007 0.60403304007425429 0.67298325067686837 1.2839046854710661 0.34914377777621397 2.2168219424396156 0.17466339952951634 0.46727231924275558 0.55993649156820657 -0.8605337148594383;0.50926353873918129 0.41012665451234687 0.51341986202664602 1.7835227237072535 0.31983676543614264 0.3701353765971887 -0.15953399158754289 -0.074633911451215743 0.55828038007980041 -0.085885790313440194;1.5521883616435854 0.86703088189061428 1.5785096219312478 0.65144773568823144 0.22974816015407806 0.71802715233627368 -0.35515882364960849 1.8148261571921089 -0.11127359894442192 -1.6596671601180129;2.7363920179524439 -0.56134111050697733 0.29606466207650328 -1.0791472655262775 -0.17850880413771436 -0.99991917099592142 1.8750379941747874 -0.8016816846764917 -0.0090023909197452148 1.4162963402967159;1.6753441502212858 -0.33063333791671901 5.2292527083652462 -1.4436049113774085 -0.79271734140720385 -2.0962856732723854 -0.3333731623882254 -5.201217048589756 -0.14111688211726045 -1.1003815373746468;-8.7917273921293564 0.083609475182024121 2.3372742774646729 -0.36820850633952085 1.4486391263679237 0.61446115961109093 -0.7490803453414302 1.0246244504879307 0.13167010456988601 -0.48003484471614222;5.6305292054725227 0.24622811189788779 -1.541537760358433 1.183736217456665 1.2742544963691835 -2.4715031822401539 -3.3210841313788122 -5.0919781232903478 -0.73545795866921426 6.1347522878456369;0.26828377951579319 -0.034419200812564943 -0.31055914015768354 0.10849686333646719 0.11931956149833792 -0.16349008441433929 -0.28817950865865344 -0.15983004212554464 0.19624046685274488 1.2356909279648227;1.5275750790980409 0.83611429015858763 -0.86538312609996171 1.2816823124855623 -0.052336894233271571 1.4970103057722652 2.3933137328907574 0.9026674436010621 -0.084371674310941155 -2.3438231355370496];

% Layer 2
b2 = [-1.6232598630694026;2.1974782806387072;-3.1091570674305351;1.5989726398047623;1.0228896260057714;0.32355042569773362;-0.6517047143246828;0.58601369624972011;1.3174817533961714;1.912633756685399;-2.1974677335917612];
LW2_1 = [-0.61734387445343875 1.2986574771836386 0.35718691824727217 -0.41122194553475377 0.026197080284552809 0.82252489938355167 -1.5656969600391824 0.87383637120125368 -0.25207198904546468 0.45577175317422269 0.52260632329285528;-1.2342268222981312 -0.8731066606780975 -2.1917873345777488 -0.46347096503352642 -0.61623166304953669 -1.1208511963334176 -1.1020551300028272 2.4601810567088198 0.278557804533269 1.5070243426495606 -0.28635394886088478;2.0610962968425532 1.0205380702143716 0.53278203569966831 0.79494605379315764 1.0131497655817925 -1.4450124144682195 2.3169906279456622 -5.3480329157992683 -3.1871725723234796 -0.25807815092470698 -0.8740206611737833;-0.30249154229798259 0.030708626868074837 -0.3834531582913106 0.8316555854092188 0.60855236768097121 -0.41115299487255763 1.7698790848370667 -0.66228071682126344 0.31284957244842521 1.3364467110346219 -0.12651293586423676;-1.9839533708532828 0.61108695507738453 0.42216393852940653 -0.80376009252406888 -0.76554897363363195 0.5959360221101434 -1.9464087778180674 -2.4671559823958504 -0.3480902300118337 1.4658044940114627 0.20508611411920882;-2.4426621620153113 1.9043617811476348 1.8063891894413611 0.60952171011038558 0.87537253045707442 -0.52657947737691757 2.0575143355463985 -4.4554348388662346 0.77461612929688139 -1.1645401172444922 -0.51128468396975502;-0.63734847144191697 -0.20543645261599972 0.72306012394852226 -0.88614870817797253 -0.86766564545140945 -0.73298886083697912 -0.34601329497725242 -0.53576279497414214 -0.45020217719686945 -0.41217225855380812 0.47430095342453565;-2.3546003755341238 -1.154546285907178 -0.55087320454658217 0.74102893667114034 0.76611412004669499 -0.72498016480785044 2.0236829874243032 2.5138488828978964 0.32336616426293757 0.90780356419753461 -0.28690707839600055;1.0064950830005868 -0.87873814174552778 -0.73313175353377613 0.84082589325736723 -2.8987445921229749 0.35395981919036029 -2.3259334546723678 2.0495233014558316 -0.8356220645408271 0.74977792454783554 0.49210627202043994;1.2198340436061734 -0.80471095759758338 -1.1541800782923393 1.0681285196379933 1.558558523807934 5.1695351131306237 -0.95717624637508236 1.2745911898613083 -0.45786578264928346 -0.2512288315557642 3.1510852470886022;0.28569898978324842 -0.020324837774802051 0.36327285815155275 0.49240587335274499 0.81977160162573615 0.9977968966044336 0.84470194106833729 -0.90589768833421946 -1.7099230982269558 -0.35093657512815146 -0.20383669427956602];

% Layer 3
b3 = 0.69676289385163781;
LW3_2 = [1.147202767070866 -1.7639627836729761 2.5370291679697985 0.89111324781590417 3.5347948258008204 -3.5420124640543915 0.079584528920758874 3.5184258283048853 -0.055273988797819862 -2.0488350397334623 -1.5164647242189857];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
