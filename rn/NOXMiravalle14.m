function [Y,Xf,Af] = NOXMiravalle14(X,~,~)
%NOXMIRAVALLE14 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:28.
% 
% [Y] = NOXMiravalle14(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;2.48447204968944;15.3846153846154;0.0208986415882968;0.056980056980057;0.0063552589768033;0.141843971631206;5.12820512820513;4.16666666666667];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.3763998601341081;0.38597251511353342;-0.094246580338592401;2.3770175768489312;-0.14335240374826508;-0.40676388270804464;0.56017935752052561;-0.51671557413717717;-0.93822144127049956;-1.0877773481128061;5.7386761658643222;9.2832571157027992;-3.8285136413726644];
IW1_1 = [0.18579100533374082 5.9718796317516105 0.020409324429597357 0.56893056375934647 0.23274415863681663 2.6256442339493136 0.01762130094757642 -0.19964910284503753 0.91331431903662919 -0.20780461637034264;-1.2673125598227413 -1.9976951022502694 0.37571348007639999 -0.82712986309298364 -0.92040428075770031 0.41288550683239156 -0.37349730943920595 0.31566691481946424 0.43579802684876906 0.52902718164563811;-0.14194181308484258 -1.3586013302182451 0.97149479589841503 0.034553606761029879 0.8860532175173137 3.3259064728150207 0.22349636132833811 -0.13613144592704321 -0.020756955622327135 -0.64557293417252648;-2.6541868453686672 0.25281917381066094 -0.62970097862688323 -0.37389290756662319 0.51851652190186959 0.65513998034425713 -0.26907499854691608 -0.48922671006390783 0.76327104929290412 0.13522723816368012;-0.17723919843102903 0.78521673051284213 -0.47432002287881292 -0.12572566643264366 0.71278597076592931 -0.28468541723314239 0.18208347274636968 -0.14733121343729216 0.080647858983723092 -0.28766398744204663;0.1068025117912003 -3.0475163809976751 0.13089672087015561 0.38650613798388189 -1.9276690101701228 -0.62800567153143516 1.8319604005464838 0.13051529045281723 -0.48063357605063756 0.0065477573316162496;3.4382265478088661 -0.54683306617653127 1.0752531961192759 -1.5518615211379621 1.8235720843461252 1.2832787057364052 0.32810723966579375 0.25948691405414642 -1.175720306250333 -0.1343973962785909;0.087943380166216667 -1.699059445104445 1.4506434740079692 0.74427852260620853 -0.98434761724986763 -1.2177421299077984 -0.76722046519780529 -0.15348874813931615 -0.32008620531671295 0.63234720135415279;-1.6171186839729719 -3.4339805001362449 -0.55545480211450438 2.1196743454902269 -1.8863322992350728 0.35345558522709092 -0.81316610791387467 -0.67704920159884685 -1.5156653110591103 -0.35029899165643252;-0.50922090962583766 1.5356730388722049 -1.1174436193349635 -0.23598097030886467 0.68468410233266364 -0.5354196100149764 0.20576288816995889 -0.23993754710785364 0.099609047117655586 -0.32721040901258097;0.2975893652104496 8.2890893069303324 -0.17533197486378513 -1.1952626282848846 -0.43656458546872645 0.10552436564620113 -0.7974669002580177 2.2243902691999504 -0.52548099521494995 0.17387315532437875;0.66370849840617074 -3.1751452103029196 -0.26531260828876785 0.93557413673318857 4.0341487453881166 -2.3161662135652987 -0.88116776213472026 -0.67523608926773215 0.19259690708546218 2.2550500591749865;-0.6445845119040613 -0.31495130505724839 2.1220069128024739 0.72599148017928572 -0.20558003220161378 -1.7920138104006762 1.3420427483950235 -2.5994774160912564 -2.2640714184711759 -0.23210449882890391];

% Layer 2
b2 = [5.2898665634260649;-1.7456456748771705;1.6888929017935235;2.7433447225968881;-1.0322142093681064;2.4781158769576486;0.39856267683899921;2.9951790744493292;-0.50419325284560967;1.4042533833547843;1.8520876250572478;-1.3437092986592911;1.7949177057215651];
LW2_1 = [-0.6853409362133881 2.5581250056967373 1.7355794859026268 -0.3319475934294866 1.646142200724162 -0.49006889879621196 -2.5923368957299835 -0.57596443143745257 -0.14258772312506093 1.5737639451739014 -1.4129442428597445 0.85521737238893381 0.14573252622862343;0.77662321474810914 0.02711035621995931 -1.7325625267367133 -0.9601729547484813 -2.5030306687643979 -0.21087568390284903 -0.72029192493288863 -1.0697394875946784 0.17644819012976409 -0.17588485149975905 2.5318699680137629 -0.6239125346856077 0.95870794143369265;-1.1741856406889124 -0.72599248410770512 0.51418187893028366 3.7741221514209999 -4.5462487661064408 0.2622385417718805 0.29902378186136513 2.2708445792247227 0.67582209597050702 3.7971882172497282 -1.4750007833534289 0.48244757830294122 -0.22920822619329406;-1.3890188190174331 0.50348559092576961 0.60159394956424928 0.92464321882343303 0.18535552742293707 1.0875830188535542 0.053486441882104482 3.4893343944594926 0.030684337097210693 -0.58616895062254815 -0.15089814474818172 1.0760846963997166 -0.39748510416431371;-0.68977818396848123 -0.33048283220562197 -1.7227866251946848 -0.48179061589177302 -3.4724816880065479 -0.10815004224468422 -0.50286297254672419 -1.5951379064923097 -0.88498032912769442 0.89670740203699606 0.92606581978926805 -0.63070991967376189 1.1511591918231585;-0.77920339600363031 0.0062072444609123888 0.65882303854915791 -0.77844469635299252 -1.755440781024846 0.67243082681544364 0.17926658473963769 -0.49108339179662674 0.24290117131273303 1.1710989404613534 -2.7018075742777206 0.42705482802632033 -1.1740140809324766;0.81486040850838481 0.1914156442907386 1.6550627794969803 0.76932094856052258 2.07795981329653 0.30218927494749187 0.40729990035792329 1.1654683753081325 0.64673420155108652 -0.40743589738599412 -0.78020419284845632 0.92618995519514535 -1.1950384776229444;-1.4094658981488815 0.06080114003331942 0.90445570212036475 -0.14259434047465017 -2.9772881559720918 -0.45910249025047062 -0.70867835004811797 0.03666384793503813 0.7969742208030528 3.4792517211624108 -2.3281741603906378 0.030954173331391072 -0.67713635731041866;0.54953921310063902 0.2806186350041569 -0.27317035322805022 -1.5937972200336687 2.1782938958729638 -0.1500364814182589 -0.43200889688229893 -0.9666579935020928 -0.32179451621549804 -1.0585984114933997 0.58294487557293029 -0.37579542840244851 0.74129746320923418;-1.0569627291620474 0.026574899599339834 0.84476384317309505 -0.69361798069302394 -1.7997557114888796 0.80837463521922492 0.056066576502325174 -0.84583412195538366 0.16486271146420153 1.1122630658693371 -2.2812633839796179 0.62743047077759195 -1.0919476398959997;-0.81721692656401124 -0.13693354976151192 1.4837723659215456 1.0057117385489542 1.2368160694177197 0.21964480919341756 0.87358431795804059 1.1210944727061651 -0.43237391087039484 0.7343540528434026 -2.5097593694599918 0.83108762052596408 -0.96750651563072299;2.0523761775918188 -0.6110079471555111 0.66642562312888209 -1.8311560437676342 2.7221297714194272 2.8237892587581181 -0.78448847190389759 1.8051562651676385 -1.3370375939447365 -0.18285677726824154 2.5831414168393922 0.40676271421936616 1.3801903616286124;1.2782125255630292 0.47218244306437024 -0.41655452615136335 -0.45039565807659909 -0.44621486200818372 0.25949648092274574 0.25453900893775727 -1.1342370679787634 0.51409949502431918 1.8030803988622133 0.10708430201435024 -0.014193354487919314 0.64811893531709097];

% Layer 3
b3 = 0.025354254177118719;
LW3_2 = [-0.98670061506512741 -2.4035204081996686 0.59249256568687658 0.81713282068746995 1.6895903866410078 2.6059287921261194 1.6933885735655811 -0.3676959366379996 1.4730028403368696 -2.5566594408097365 -2.3302062095205396 -0.33154722939258496 -0.046990095494270891];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
