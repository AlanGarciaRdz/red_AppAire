function [Y,Xf,Af] = NOXTlaquepaque5(X,~,~)
%NOXTLAQUEPAQUE5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:16:17.
% 
% [Y] = NOXTlaquepaque5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.03490136570561;19.6078431372549;0.0212539851222104;0.0523560209424084;0.00632111251580278;0.294117647058824];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.7688271636381732;1.1328339178718181;2.1709838904345697;2.519277556293162;-3.2876766387444172;-0.61079975424334931;2.7253171369263542;-0.14712580476381576;3.9239201833489048;1.5977609509340227;2.9054888576070055;-1.557150057358569;4.5270284622914758;-3.3864607262001245;-5.1838104182337394];
IW1_1 = [-1.5170005603619099 -0.045318439420405497 -0.69795268887860318 -1.2374763353125244 0.74105037509422 0.28366758054345653 0.77532982880085632 0.47366457143781632;-1.8728614875379155 0.061290625074462049 -0.71467200474054338 -1.4366461074036514 4.3531399574491454 0.67312276000212323 0.13600887234676612 -1.6197280900979316;-0.17623663592800656 0.24152947495893187 -1.4100597525111782 -1.3095486706678425 0.37929670993402137 -0.14621709640089181 -0.14702971043632032 -1.163787233738828;-1.3844396002773731 0.46611020157292454 -0.091442074982495278 0.77470697160190738 0.69551269623892342 0.18923684909468158 -0.36203257793991889 0.71969197083175651;-0.0044360313751100888 -5.0997062503534742 1.1178971916408396 -0.84194456895026892 0.14146831647864047 0.60482968316205366 0.1901033854064639 -0.39576096223213542;0.13546685972410127 2.9474939136466096 0.3300019057337289 0.1303758820799559 -0.10056327314188948 0.077606771503281255 -0.076211694254922774 -0.34636669158519262;-2.437893828595445 0.94657517425908522 0.49574631976160671 -2.5330988813264752 1.2709544875478473 0.99531474984947677 0.79920688321968525 1.2537648840038187;-1.0660470044269748 0.94893682412656144 -0.65379038419969093 0.41381266407097977 0.28293556054924074 -1.0907173456107873 -0.81280773343560764 0.30809727483552291;0.25491455019137182 4.4531896890010172 0.26858313974669035 0.393878994063459 -0.59312645432792976 -0.44802953080447749 -0.11877712976816003 0.18587042329626172;1.1612273345766859 2.959545673730855 -0.62762265264553918 -0.22646659847655026 0.88468743480761391 0.83338682647380979 0.009179047404331819 2.8906314869510101;1.349941364888116 4.3803677787594202 -0.31716302872383878 -0.064796028049469476 1.8964568530500592 0.40320901018088151 0.0018247374487742676 -0.61824426448414871;0.71987495663574974 -0.43072467795944452 1.8632619767000633 1.54777068980462 -1.6758355143071144 -0.16446672112551919 -3.829043799943622 -0.25278701968590284;2.8157753647670285 -0.19748188225847343 -1.1029634993145427 0.42294900612318648 -0.3730723716776338 -1.2410501838377983 -0.31676454572354035 3.3509759134776438;0.4700317126766006 0.0012566628126788049 0.43475007080172962 -0.7760750808727126 -3.546003792090989 -1.8992501816976717 -0.086447463785463655 1.4664464274881446;-5.5234323024442027 -1.5080421940958717 -0.70443253788193205 0.67242794675996254 1.3128629380633969 -2.2837179546264919 0.70979607894844987 0.42137328887968856];

% Layer 2
b2 = [-3.5200348849149452;0.5829803046366584;-1.8903039415880207;-0.13446646581036056;-1.749992396506568;0.29674998040857181;0.69630760252106394;-0.28762131065295493;-1.1638841985743835;-0.052837816679983912;-1.7852663167280667;-1.7040158060110289;0.88285928939061009;0.79671002055729601;-1.4922821908669663];
LW2_1 = [2.5844013745948669 -0.65118748273258953 -1.6239095677683224 1.3251505928693916 -0.29636506955726871 2.438916019425676 -1.5234078340552935 0.17812253546117424 -0.43856521863569081 -2.1145893362814205 0.1820995122489672 -0.18834325920775385 -1.2708097119000081 -0.48294767073462613 0.39773885782491092;-1.3392251638008619 0.43791723737641469 1.6699122623603573 -0.24796757310849532 -0.14775031481244139 0.88653513064789691 -0.093380140436182035 -0.058608266718228642 -1.7292627353415715 -0.30394241520888393 -0.50276215282846781 0.086271841962451079 -0.34556126676534926 0.43626346165586499 -0.27777911334377803;-0.039164846068646827 -0.89998153273943327 -0.57616411654313937 -1.9365192389871071 -0.094460327151079757 2.5003919244109531 -0.045171358940952012 0.25671153868276231 0.9781667859279144 -2.1607652271892128 0.20883266192442398 -0.20812077013025998 -1.354375394972017 -0.94393072588311533 0.38722057930033188;-0.25426208812086415 -0.57301963997958605 -1.5258117804929061 -0.27913982461328563 0.33568551420057946 -1.5678813168745351 0.018776128615696813 0.14890816508865062 -1.1264809884050966 -0.28917556393226507 -0.52378876861471901 -0.13580540025565951 0.038303707667764225 -0.82342462283917239 -0.01260017574670938;0.32156217713938923 -0.077734961499793198 -0.87210406826200826 -2.1064863896394943 0.6091652026940958 -0.1767910743421188 -0.19064912619345942 0.37168344561875688 0.33420102402897517 -1.7617612361748189 -0.68858445075304275 -0.59257369206943611 -0.52218982211276943 0.17187919127228152 0.28396841754693491;1.3406728019314402 0.35801688176802587 0.4068893235939281 1.2856900987403528 1.1527861893444369 -0.14132092342088426 -0.80262557793050715 -0.32233656122710558 0.44878089900677015 -1.300067358705824 0.68153489407147583 -0.28352714244860949 -0.2979192095922108 -0.98618863573165794 0.53580889451852709;-0.0379144269798391 0.26514559838885149 0.4460928868836056 -0.035058807072292315 0.37906475591953565 -1.0868632275385177 -0.26729697389679902 -0.1096300656762616 1.8073408378665379 0.46031921755061672 -0.97455725860349696 -0.14502184168812193 0.66432857595977624 0.68008810117956531 0.16563804016987166;0.4507951036468737 0.096487345795452109 -0.10255058893680991 0.32786149501861889 2.3216086796497901 -1.1586192820881984 0.57638270574325945 0.1146253304926336 0.76543090294568039 1.5981802941537038 1.8772286439633339 1.0974066407505019 0.025619465370226663 0.60932018430214496 -0.46555044043316385;-1.218422263930129 0.0013082486879399096 -0.85907824676110467 -0.46945100471356349 0.31572990080543389 1.4767743088310696 0.33979385831439757 0.31380612442068323 -0.030183096431660013 -0.45684425854785288 -0.31983060990812484 -0.64768946829259333 -1.0614747590628386 -2.7161333347337275 -1.2484862127416121;-1.7458204479826296 0.15298030631186249 -0.54609886133701591 2.0389122339742758 1.4135616246081044 0.4126866031398182 0.31018993942062478 -0.85583829711379245 1.4443478085584203 -1.6879308231100636 0.46245585093114555 -0.72542737827221482 -0.32429296201692304 -1.1192423914032192 -1.794228007178438;0.54679620697505416 -0.23964217271995644 -1.075876458773114 0.025037028615435292 0.32045720433061475 1.4279089186443217 0.3728570629259404 0.24254379828753322 -0.92400991006129718 -0.53463817746896269 0.66681957418506599 -0.39212601914290751 -0.95170377261548766 -1.7876567599174873 -0.88671661633784093;-2.2765469257701492 -0.70038965128507569 -1.2382661064587392 -2.6197622412199517 0.93701481338369197 3.0186355916869201 -0.2371235498360427 -1.0601570312018447 0.59810146000689901 -2.3878465951390386 1.5483156484327119 -1.556095397741184 -0.14028180451930128 -0.98823955411734199 1.4526387412684276;0.96506848868650263 -0.45434563341467971 -0.7987671818121892 0.11812474516447322 0.97823132042887795 -1.0908860431039038 -0.4273311424667921 -0.24109815233539356 2.6856491838469383 0.37345843644150489 -1.1226398946052125 -0.30864289292112818 0.86502349311074822 -0.21307635261361346 0.21295174135325112;-0.13802979284586425 -0.96651902136909851 -0.49141440745940718 1.061279762970468 0.11779651598280064 -0.75959435603690917 0.82465354419100823 -1.0127269483216521 0.17829270709397763 0.3112066463917042 0.51247883455720233 -0.17923449341254394 0.53988856742798852 -1.2839366505671239 -0.26305097332445648;0.34541055217380723 -0.13804722163645691 0.067366615845791192 -1.7907304154270272 -0.2379418177327482 -0.039941961535986961 -0.24123142211709911 0.22805547609667848 -0.55766664600136273 -0.62318660006195703 -0.90990340572737438 -0.2525849015879601 -0.253931835395238 -0.14934410524623021 0.13667686062349504];

% Layer 3
b3 = -0.93774330222310232;
LW3_2 = [-4.8219964933393751 -1.6469628978677691 5.1443967748254096 1.6348212130274844 1.5554981645338137 -0.99841278616193696 -2.8994684896249789 0.054714803966501024 1.0318377594740997 0.86421486121274926 -1.508321943755164 -3.1605060669818852 1.6429788936700023 -2.058149299400394 -1.6232745844472776];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
