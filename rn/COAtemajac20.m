function [Y,Xf,Af] = COAtemajac20(X,~,~)
%COATEMAJAC20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:27.
% 
% [Y] = COAtemajac20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.8930836953384951;-3.0878146045295152;0.99137151765833431;2.7789057053787691;0.409912287649352;-0.056939603383801426;-0.28391287559000389;-0.79152422877724049;0.19157066420627297;-0.11783082725503619;1.2679522602329303;1.1961732095721065;1.8113694034020595;-3.2902536107497649;-2.3969827430139214];
IW1_1 = [1.5241504405789656 -1.0762952054578023 1.0209637199269774 -0.8781706800529675 1.6744996431337009 -1.0376884126545063 -1.5688274595701897 -0.61850026254325519 -0.70477282670668107 0.39565177484482011;1.3901187896217948 2.5934293452471064 1.3279185734655754 0.77627016825052386 -0.32928574154842799 -0.96322908361954374 -0.41492829676147747 0.076143099599429304 -0.19943649015281945 -0.23714202988913416;-0.12513672992890731 -3.5549923476181027 0.88379659081647044 -0.17496253105835044 -0.074150668921907373 -0.28099293052493807 -0.1460109371463858 0.15325769944014631 -0.18329505967389845 -0.10836154808953127;0.26738163831638895 1.6827782017659074 0.88244273387490779 0.31244096991464498 0.32893759474406026 -0.71863118463774356 -0.42980510131764038 -0.71052956220046126 -0.32291713811950457 -0.69131362365391402;0.81970199103979435 0.59625370191902738 0.80136818924477549 0.82405276843930042 -1.0944128873697512 0.28072438085019663 -0.42180809506442624 -0.94781517882518673 -1.1796155827695014 0.23408658759403161;0.87995152886114725 -3.0103377506655797 1.2410739176371866 0.81077184441238026 0.16688665414511297 1.2990463423719609 -0.26430501681604723 -1.6740614368170192 0.092215691469049996 0.43356825308204155;0.53617659613517932 1.5317758364257201 1.6228479884177562 -0.44271383961482169 -0.84023988368663494 1.4253529891606249 -1.0154095945147539 0.56411556135218122 -0.61764085322373086 -0.017333760409238737;3.6237091483325754 -0.92884216709462386 0.73515676686182985 0.6144443005061313 0.59841716929976407 -0.094833198652430686 -0.51948766173117455 -2.5540589106887039 -0.61944274819645595 0.2803793269014464;0.3004474585493177 -0.038747581333853004 -0.22694635913122663 0.28536691353387206 -0.27048679726132424 1.1758649597975748 -0.17152517323408811 -0.59182454665787132 -0.25033621721854266 0.39299902044642215;-0.73298840342180727 0.29117380447466701 -1.6811931514175997 0.092665900151724961 0.10296826877535212 -0.54189601197171333 0.81144640909605426 0.74440059474698284 -0.53996531374575008 1.4660197290533659;2.8132474492782382 -3.1494067559546082 -1.149052934990199 0.2108618430193738 0.2500723512455631 0.12744563644910187 0.51100255243207426 0.40453124968028353 0.86450778107207582 -0.52474002323300983;1.3606263119654074 0.19915367560194383 0.64598091020139659 -0.0072815364251627365 -0.23567000582350295 0.57215548076339739 0.47150852295763002 0.44147832251470343 0.14412283044284468 0.76012295133455798;1.2411198065292652 1.7421962481196953 -0.85069433643012404 0.93852392872568724 0.41878925191826188 0.43047238580077279 -1.0230162794779727 1.6495436511847119 -0.17763570326071895 -0.42926230776380281;-0.044269941321312352 -0.10649527907308698 -0.60235596719347317 0.4336416983250056 0.16940555139435062 -2.0430946264066749 -0.33485156650615816 -0.24203057895745239 -1.5319259877341029 -1.0005473642858287;-0.93862405866066689 0.23243251945127372 1.1784678866179816 -1.7760256191279771 -0.46104599185653716 -1.4816277644743692 -0.50589207860119401 -1.0118807365144025 -0.60925415421965035 0.14791133601292838];

% Layer 2
b2 = [-1.6136994194570733;1.6527762679740403;1.2348275919285088;-0.87747965929042782;0.95755035983346015;-0.58585153664266587;0.025522114832390471;-0.45342019300592917;0.034622679252428415;-0.416490721361024;-1.389800255858417;0.69403010233067253;-1.7034601528063005;-1.9180395315352134;-2.6951532231707951];
LW2_1 = [0.75375134562670676 -0.18242491229585628 1.9799602431924967 0.18256066236106303 0.55422838070910341 0.37322997376225697 -0.17438827077483737 1.0123785431662879 1.4069863694975333 -0.72810965689045237 -0.92413904893887444 -0.27840342345003449 0.40207553748772373 -1.3417446574160192 -0.56225733212971518;-0.2803373977159721 -0.95874861583185245 0.31646006867065257 -0.055870120588876027 -0.4762528992222288 0.26428473854160967 1.1422422990444028 0.054356895588028475 0.18607940673203122 0.10911299945598567 0.13934259132878446 -0.052020703904175167 0.3313653522481772 0.41872224589533813 0.26194402216756868;-0.31736932695453196 0.36234851758298192 1.2695326766379902 0.1979145567542813 -0.39143731056112485 0.84685830954792563 -0.56767813932628874 0.31878174491770306 0.16232314144373677 0.426967502544913 0.33438228764047001 0.49080581537494439 -0.37551604174920322 -0.29726098800279499 -0.3734403219941263;0.73804930706806871 0.02996842673159493 -0.026666415661677823 0.45852681375013493 -0.33256271576516783 0.32580660194188782 -0.27335267584873879 -0.91808006169106648 0.37070573402089335 0.42584769101060543 0.61472557007245265 0.44098454520769004 -0.66114237300223555 0.17563126651936159 -0.52252394158442739;-0.19583420470771637 -1.0097472306577897 -2.5908538518414237 0.62636828079381068 0.027175484423900925 1.2514903732332772 0.75603291632742264 -0.1248047568451911 -0.34507944795562173 0.85639901231420368 0.43326501425778624 -0.13491991124175071 -0.19205287091173301 0.57012615244835363 -0.050975110321578671;1.0299970857008629 2.5884268290395513 -0.84252276585603381 0.38717174053797404 -0.46516439802521503 0.3033416957011198 -0.13384992468842505 0.021204245712904218 0.40022359952319275 2.1403566810934054 0.14665075298401217 -0.45243859531935376 -1.1165009995092257 -0.33929387331442706 0.65600712846970433;-0.22425016050635921 -2.3199977952931183 -2.8081603446930448 0.43415692947584211 0.13858058447555988 1.233411416964618 0.56096661309521645 -0.041652469149108619 -0.59857479797110835 0.68125896736663882 0.26805548174866867 -0.097617463321988618 0.0061331886231246417 0.47556044126067032 -0.011659428292147465;-0.063792810173327552 0.44529398651645613 -0.61535868880480726 -0.32770904507512882 0.033153075789170393 0.96758948801185463 -0.38425489010677893 1.3761031018507277 0.61696804162469965 0.016954751468624917 0.37245036308398977 -1.1615804830122636 -0.13916616205827251 0.78760964210699813 0.17394829141028662;0.13007984452445703 -0.31655549067229499 -0.33672209230766104 -0.3803157494902602 0.49342354799897953 -0.26668431178760599 0.44354049263116685 0.20428980848828759 -0.52300781411614683 -0.51133216980530161 -0.65140088331394208 -0.24212603441555391 0.26775038487144515 -0.27145012682144531 -0.11579761366076796;-0.77412854893105065 -1.8009323999805218 0.71982542996054621 0.83897038509366351 0.22056073177928626 0.71327522952644151 0.16889670618012026 -0.033586827191767393 -1.2382779038325269 0.047707517692391982 -0.90189428694537632 0.59613913827478804 0.044453570627166962 0.021526741300922966 -1.1669800606205332;0.26938179789296224 0.81921939963104196 0.48116093809095245 -0.34222733159202068 -0.74156699409798887 1.228861925189086 0.55297606095165652 1.2527462455326102 1.3578954450744487 0.039607595326870179 -0.3688649762693762 -0.39728768145575361 -1.1593208864116906 0.45163472473672983 -0.60198546859410218;1.059551208178569 0.68928053657187527 1.8145155502321006 0.13113631923239522 0.35406509767455097 -1.1958312012734138 1.3867992925799149 1.2880983896680864 0.75722875305168258 -0.47020490313476931 -0.43943140688825055 -0.33559726633790654 -0.087534636214475006 0.9682444688152364 0.55399099743608105;0.20498485064228222 1.529333559316612 -0.40422687585277767 0.80305576304472781 -0.62391544155006762 1.141099992399313 1.095937952286729 0.86084684181427917 0.13843308636920826 1.1189199144769475 0.42652206799542669 0.90322524009324379 -1.1070117124185641 -0.39297187355326663 0.36037162896753183;-0.74144562319306284 0.33469941362032257 0.50832461429812992 0.13899945810804382 0.54452146315254291 -0.84208697101158536 -1.5983616618552849 0.099719634960716508 -1.4268049181010811 0.019990848971727683 0.64282965454918306 0.65467704101437674 -0.31823891342334421 0.1004460631589431 0.47066114938650977;-0.70706768085540961 0.44893406415862452 0.12848551575311254 1.2878157972953388 0.21478966517588399 0.48603000323622053 -1.0002064578145478 2.5780330615159746 0.32099614437175866 0.77406313941080762 -0.059316834920861067 -2.4289037033594818 -0.92292068727670951 -0.39935437013985325 -0.57404255141943272];

% Layer 3
b3 = 0.08814776255622514;
LW3_2 = [0.13389514099291538 0.66310168334373099 0.17100467090455659 0.16961855855046856 -0.99413940672924395 1.032430835431843 1.059810298325311 -1.344598551554669 0.39362318010095343 -1.3931006415827634 1.1390308510435485 -0.14564375330716772 -1.6282945616489071 0.12301620942104369 1.0670848132226962];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.201288244766506;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
