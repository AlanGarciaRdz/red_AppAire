function [Y,Xf,Af] = COOblatos9(X,~,~)
%COOBLATOS9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:53.
% 
% [Y] = COOblatos9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.0110049570717186;-1.2338688738649719;0.10937230784289585;0.048688879027480217;4.2544697891196472;-1.5353000999434778;-1.9449692762723645;-1.7360782548621234;0.054668512348886554;-0.70560819171304923;-0.031937849619266906;1.3205150097999947;-1.1090113759158242;2.5896491569437461;-4.405815651850812];
IW1_1 = [1.3120865993737256 -0.35724701481367782 2.3599980838461954 -0.66991511520829805 -0.30551277281338701 -0.045661649624045446 -1.2838455964811404 -0.31367900300400348 -0.10909786452869956 -0.45748207311309302;1.7263121701728568 -2.0577865771913584 0.16641968958625791 -0.49836734456060389 -0.15756394153508085 -0.76919167181775217 -0.054562294723929233 0.12507472957673282 0.26963600214930228 -0.80246726362450005;-0.11597072415806105 2.5122572855778609 -0.5123132694558068 -0.35053842412053843 -0.016773609268022054 -0.61236788365052852 -0.44725876370678119 0.38564760619129579 0.66218689848121914 0.2799483738384278;2.0428022835649058 -0.04003095086682603 0.018465979849794173 0.5639484874951548 -0.78823075695386191 0.56948871514901933 0.48862864841803844 0.47626814353382263 0.19772702692934899 0.56472135867222994;5.6244582397084111 0.12786316012474011 1.7818914679304207 -0.23649540386529797 -1.5085422818756682 1.0778963951658864 0.012302852322358282 1.3486400512284182 -0.34768387093981917 0.047201079586164471;0.53300331691969893 0.79863265399829875 0.034173941771201921 0.16758254669582848 -0.10633757426796901 1.4407805167195893 -1.0525321311187319 2.5654166382604497 1.2088331303028361 0.012279782658068644;0.12582634800539755 0.92360060561491375 -1.3966821301475743 -0.66279983294522604 -1.443091359175845 -0.25936090780523019 1.1292625375458583 0.86454036936989542 -0.26285567002395821 0.32785284838108647;-0.054640818156637995 2.3716883339014987 -0.40984201418656757 0.18828261872246568 0.30541653311035061 -0.28775364349779686 0.26992793621920141 -0.1826829600961358 -0.18554636781379402 0.033488870585075783;-0.50030280631353363 1.0041816047665584 3.0671309864012253 -0.92757064130899147 -0.359768320848604 -0.69519363043582949 -0.66082377091675537 -1.0701009966521671 2.6288313575779703 0.047527795917424384;0.88141595172178266 0.21369270733192408 1.4781787182512216 0.23736793687198754 1.124556341524809 -1.5867999723652144 -1.2226467560139826 -0.33975075484834721 0.39631845866067217 -0.64867950317611123;-1.5279621741321932 -0.91136110002753723 0.017741389676145997 -0.71669477256730163 -0.87061532134720321 -1.0480914227598148 0.19211936294202275 -0.58087857719220493 0.14104421121631489 0.27251100172178561;-0.60200391050266544 1.7573544658124149 1.201771745750605 0.41476567744286297 0.18417092251095649 2.0468607333408002 -1.7922931104713156 -0.44153270914739068 -0.53254524040117168 -0.82156496674362378;-0.11814355513763981 0.10087287410622123 1.4490258329757073 0.99407596059664705 -1.5588335555550303 -0.0090445952468718033 0.30470550113158812 -0.0075380788682523764 0.84365926304342276 0.039116083848020892;-0.15545677626235577 3.9120853878941095 -0.97881602244323074 0.15295955119732468 -0.46540400704453744 0.30363134234251982 -0.3183967040538665 0.090083212754833566 -0.261044274684952 0.44571805862615721;-2.2828691483784107 0.30982477874399339 -1.6278740215422864 0.38489002119241988 0.11654578529585395 2.0395608810555022 -2.1843146460368055 0.14735544468190812 0.10864565566233944 -0.47508655331772942];

% Layer 2
b2 = [-1.6533296847356571;-1.5772161478794444;-0.8021543591399285;1.3848097125093894;1.2028485278333831;1.6936219539068686;-0.11837881605981576;0.057350560130153952;-1.0266563359319623;-0.010448823669630111;0.28045933053588823;-1.9448293947155972;-2.108059616113366;-2.2701928377570084;2.0805100918707389];
LW2_1 = [0.46966352069507966 -0.75817294439191818 -1.0343974051131761 -0.24637655144919146 -0.26977173969870116 0.33786312072048186 0.67652772259419092 1.7550071459988998 0.22869733483880203 0.25803295285595584 -0.42126208456137837 0.45321828223756577 -0.54604291572415975 -0.4075196821095749 0.086077820736183794;1.1617527915694112 1.7184907802749818 0.67077116672423964 -1.0803131726855992 -0.55507812923282174 -0.05718125784759294 -1.7254979511855362 1.6583983443017249 -0.76093290886254672 -2.0337600892183691 -1.1030797804977979 -1.3353243014973002 -0.11723418525463283 -0.35852349570112446 1.2830078253592223;0.53265124050580581 -0.15589514829540399 -1.0957842273213332 0.90346364317075778 -1.6791063469236747 -0.81491046132990053 -0.93245371550407541 -0.76821740559902496 0.73924583687944445 -1.9050377032272179 0.95481227486817488 0.28910541153868635 0.29724659989954288 1.0144437451949879 0.46576098788397224;-0.59887733545089716 -0.7815699137736698 -2.2590342757215085 0.24644437135837474 1.3382496073768664 1.5140240158243872 -0.36942429552902895 1.279400978232049 0.70103523871756823 0.21870888997814458 1.5420370262794016 -0.24373490874098624 -1.4862555275808655 2.2270099655565039 -0.30989087805521259;-0.94123916302557808 0.50263814134115847 0.062846400547894837 1.0689181951854743 -0.27052636769903671 -0.57261984540271926 2.188546902340843 -1.0242782533861909 -0.21619051002565165 2.9753980498042178 0.70490927417523497 1.3290382163442422 -0.019183198048542301 -1.2400200403602413 1.819832104439568;-0.95481710828389266 0.77012051202015619 -0.63397234155025839 -0.63309893834860698 0.038401970979699648 0.42089782145508142 0.19667683415575768 1.6948119674430293 0.045129175216176549 0.49817822735285411 -0.087065979957229228 0.28372187842313873 -0.33448401946240164 -0.8849450390269481 -0.11229774098152986;-0.84133084764718835 -0.33107152071732548 0.59139073510482676 -0.056596309136378614 0.88092239763961333 0.27741793133513826 0.787563268546011 -0.4819332633969694 -0.24246252441267596 -1.1279002062584098 -0.62989130214464817 0.30505569289915258 0.87297022186696649 -0.99124495200391083 0.61355453926878289;-0.77818910268708807 0.88168629266931497 0.055999718872673299 0.73185115443994031 -1.7405802468412241 -0.063638511336379017 0.52696722365295856 0.68865323727905248 0.07612695190068744 -1.5903581802295701 0.64911981656866347 0.5982758856270336 0.73134397136854956 0.084963185548977832 -0.47817431039399699;1.0773000614021466 1.7879577701716154 0.45969020110835995 -0.34895700962810716 0.37584047005534199 -0.119427234527619 -0.59416002923225919 1.0788285505347588 -0.14206913287050024 0.085081436599366914 -1.3301229091600324 -0.94223574051426617 2.1054194331107143 0.013917308137296358 -0.601348492100236;0.58076433979000763 -0.66534364778977328 0.076128856118517982 0.15526408555965984 -0.3266266640651726 -0.19127439250808537 -0.24156129756939376 -0.78942100239433477 0.030234619416577485 -0.00035617755349244551 -0.53021629904141909 -0.3362139866800441 -0.22794674810981397 0.1057475425143668 0.24685867480357468;1.3366114945784398 0.022770659073064484 -0.059155057023218729 -0.61833544321354494 -0.47960222805205788 0.25257653557951798 1.2141222366666513 -0.091832766927491469 0.13980303160994212 -0.001278511758171107 0.20898687631052948 0.46624642946176786 -0.87913065837526982 0.59355534153438427 0.10720835381795499;-0.016175387118387466 0.2033105570248393 0.26209159308741259 -0.2617198522646117 1.8791814417691795 0.02145484244829543 -1.2046986342410306 -0.57467711027765256 -0.12696023171781007 -0.011020145709190465 0.32950195406571986 -0.22847739794204744 1.2046680203165461 0.81241813286524778 -0.75637807209499897;-0.2240398782262687 0.30548485820827254 -0.15517797084680807 -1.7180677429574296 -0.47348261331445357 -0.054263735474327203 1.4545909411843714 -0.31524414318547189 -0.22608885102564802 1.1678652072536373 0.056190041445024458 2.1912005533651842 1.5721924599106845 0.20046605807610579 1.3243521648626;-0.6788914859937496 -0.021201992836686973 0.33126906456855021 0.87573047778283453 1.3868474457681284 -0.43900031985453553 -1.6476449701829716 -0.42779626788881875 -0.088812558331566011 -0.22994769698721126 0.73409118688512354 -0.37345161607312805 1.3048001380002157 -0.46144242295905608 -0.40553183378466318;0.020936664845051106 -0.49753426660144978 -0.25667919938864636 -0.44453525296577889 -0.22666592930867907 -0.0091274824371763985 -1.3412288113415491 -0.12334210400576433 -0.098984189863200608 0.33409096274135952 0.34260665606670665 -1.0570745689620646 -0.1315631903065127 0.71581994329659782 -1.0667747060096131];

% Layer 3
b3 = 1.0585058845402804;
LW3_2 = [2.3512818281117558 0.55791840786864511 -0.13056451270193098 -1.1870040006136122 0.24666544164126569 0.54020810505327588 0.13122863337075674 0.30807873528752694 -1.9746154110635785 1.0224707322168574 0.4688225766158548 0.43048538265212105 -0.3415366122997327 0.52187843633323006 0.32798494347257517];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
