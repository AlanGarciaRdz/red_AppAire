function [Y,Xf,Af] = NOXLomaDorada23(X,~,~)
%NOXLOMADORADA23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:25.
% 
% [Y] = NOXLomaDorada23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.00280033604032484;0.0179856115107914;0.0558659217877095];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.0168064350116541;1.9885777556779458;1.5536466571334295;-0.99184074930840094;-2.0080100280444135;0.78908183854428815;0.50161522130066905;-0.23684897537172866;-0.14911239609114305;-0.71517824837085908;-0.91919129035725466;1.7598429526589248;-1.3225314686108967;2.1676776402327613;-2.1360773823004711];
IW1_1 = [-1.1944928028548447 -0.78233865992880247 -0.6233110067897395 0.18957893544406268 -1.4626217172479208 -0.58455463995506407 1.4422828757520472;-0.95510891483544291 0.44041524023936734 -0.26003319867078573 -0.37774933927751703 -0.72618791225566393 1.9009928491365975 0.023680019843319546;-0.94485287681769448 -1.2722993433855962 0.095473846048922395 0.43900014584492597 0.29459868108075166 -0.35651482579957811 1.5411166449786848;0.84087096103977566 -0.37291785070374922 0.99589080351844961 0.98620354684161582 0.98509195374779002 0.027104660962745088 0.8367219483711712;2.8600522137866267 -1.270689084296406 -0.10093500771906584 0.26004555579597366 1.0033623038544259 -0.39988316980516342 0.25550210731873596;-1.2408315404210883 -0.57820829093597736 -1.311024021024354 -0.40289745569249952 0.10655736414949672 -0.32826402494407603 1.8096845022390913;-0.30100972975801094 -0.05144439880053793 -1.1549926923955209 1.3324933712827276 -0.96546035916217887 0.98207764591128432 0.40679820623820728;-0.73086840527080776 -1.0641955352870387 0.64228318712338084 0.34057772111062928 0.20460705447775929 0.69635911547267082 -1.4449508238900364;0.92364037082161465 1.4161469634469075 -0.23570128691586723 1.5530184018528173 0.3638636724049007 -0.36390788929342827 -0.40001900796899703;-0.63792522035808175 0.18052518980318469 -0.85988819084696344 -1.1759552878862609 -1.1112787105007051 0.88602616188441974 2.0775163383861646;-1.0566423936911389 0.50481970363823714 1.0755438576298311 0.19143274707957336 1.0004504270824039 -0.18654929723720878 0.082891353917494331;1.5438414816381274 0.01776689509362861 -0.037277132941878136 -0.71343582947633943 -0.029602607032343235 0.95755561146582024 0.91550115817355759;-0.3582663517768121 -4.3836392710919521 0.19887813739218646 -0.31932115130073019 -0.040260109168974691 -0.25801885976369671 0.14827869581476139;1.0993144241741395 0.67825092987284552 0.44573654489209424 1.5386158586524816 0.60156764260107654 0.93105979438056607 0.80515357586136516;-1.8344012001491254 0.29721629568179347 0.64429585511290599 -0.20025350558579585 -0.35453431036524685 0.27452654403499471 -1.0364580282019402];

% Layer 2
b2 = [1.3706531219300186;1.2266457825612622;0.87375082351905153;0.66541580233369679;-0.78175885200282724;-0.63202807957236329;-0.15410590686808617;0.27079172369529142;0.072854652596000546;0.39063580461524272;-0.68728397760387061;0.71056649502833669;1.1382135234204731;1.5643426554937128;-1.7657119487779667];
LW2_1 = [-0.23237269591696919 -0.62533379769668374 -0.15585867967800401 0.64307951477174563 0.52862579080363625 1.0808306153391058 0.2743834374593378 -0.21447196776164365 -0.1553278082802885 0.9267831008103441 0.78901378594065807 -0.093072306878405148 -0.85581639401911169 0.26329520658195149 0.17170239232071691;-0.35975656186357591 -0.31774883436730328 0.7345346548256223 0.87650789146044994 -1.0479775313335362 1.1713447072676351 -0.061479313067355899 0.16096431925786309 -0.55776056023076626 -0.70898143763347066 -0.46668703987597765 -1.1004430314634981 -0.65547708752024203 0.36109257254231308 -0.32956417844833757;-0.58107184788204713 0.29440149686828121 0.35757348972636399 0.057649822503739304 -0.82015454688497869 0.20868651206993322 0.76867441743020493 0.70095355405776227 0.31557337867082075 -0.43445909770323465 0.16278601795083952 -0.26244479629693834 0.42347021241672117 -0.46775249499242522 0.04384323110796013;-0.97782790603485914 0.16508227358221594 0.33267942519667243 0.35203323310614215 -0.0062845248030429825 -1.3758994673791876 -1.3426972972425291 -1.1312679496214539 -0.2402705180576456 0.29448253578337075 -0.56201629384869201 -0.51162683904528294 0.59601780175923647 -0.4444808380135627 0.4567705360748705;0.22335066578816246 -0.15383134259147163 0.18150550434139007 -0.51299494207818697 0.81521872689994657 0.41154694000876002 -0.30128803751246119 0.46950483729807679 -0.67323960578514608 0.28959639675011817 0.30955076120712355 0.3218456278324619 -0.77373757152007827 -0.80442968621399591 1.1578959681276835;0.6154114352941199 -0.72499848671136879 -0.3712928344432212 -0.55321411158038258 0.10898482288134273 0.070816994142303996 0.86672054243585372 0.15640680230063758 -0.78897958141136759 0.21348756043120984 0.3594379193860755 0.22491181331857504 -0.48852068504323748 0.07422875535387588 -0.39832988689646492;0.64762809271501631 -0.16145176241275003 -0.45771335192580953 -0.49137146152775435 0.61516262161901158 -0.75438679726675872 0.65488063348069747 0.75001904922326446 0.63513236166992604 0.71732948257880602 -0.6929518423205131 -0.21400236531411793 -0.25161263750519886 0.37797656728889456 0.13682900191234301;-0.88825287699888067 0.74348789693158235 0.12427132793606373 0.12113704917649015 0.52371172097367624 0.28395936156270524 -0.028698381945847104 0.84988035698282338 -0.47358180859606791 0.12837906943825095 -0.24740941321128851 0.034698654434008561 1.109411630164302 0.20789375768422277 -1.0383334220240592;-0.27207084415903859 0.91503026652632824 0.70668547811050397 0.33315580495706809 -0.045949307960414562 0.20666101317751412 0.83031100280640591 0.74982428947392221 0.35634121577344591 0.26110344717443557 0.60831432486121417 0.21547724011891981 1.2756149643517218 1.1412005756313317 0.010089551547883824;0.060913939114373331 0.14475405199472208 -0.74856321087613165 -0.48063038722351642 0.18285827142240335 -0.96572510532097589 -0.44632768038996684 -0.21547903423365664 0.40171431554568909 -0.57801917952285276 0.022506042504063645 0.2296838754358736 0.026649213341283073 0.96554488552330497 -0.66722040987988773;-0.30456408518170436 -0.93669427522518911 -0.84465811389101975 0.65938424889783853 0.27791280369800697 0.09384988242808523 -0.11410782763786687 0.36515720901568161 -0.46254066123379467 0.86388235107328804 -0.040949564036074512 -0.19856646959930013 1.3166048861441146 -0.74278572358285555 -0.81888146917838156;0.10933008190764183 -0.039208747669623373 0.22083555344484454 0.81074697847579791 -1.8228410190821531 -0.35617854544927474 0.17084989418445531 -0.21862442642526822 0.48731782410082786 -0.52980248355576431 0.97195630953162804 -0.24678760416209589 0.014297824967106871 -0.14445355419423231 -0.11838998401108972;0.48482940256197371 -0.34094843034953692 0.093017581959034368 -0.10898178546444758 1.6303089694704695 0.23108358481842711 0.067893812361702138 -0.4753259105930458 -0.44599326258187449 0.40414042031461295 0.038146258949285132 0.19913543574192039 -0.93340680065164239 0.47110455442341931 -0.040238057586070998;1.2003132455727892 0.17152598615519835 0.49215247379828608 0.75277593392942177 -0.98958053842928206 -0.74851121653273944 1.2451899074189252 -0.054802818527804942 0.81530492540527344 -1.0915194645158035 -0.71770175116201296 -0.98339714969684178 0.62194726711541581 -0.29256393857208435 0.83454085492134789;-0.55340278493420647 -0.7152655516441806 -0.33711726463514785 0.29659819760002515 0.27571387922711743 0.40600074256290009 -0.12940951543444826 -0.2795461590895173 0.15544128195275364 0.27193732404378335 -0.62913955713396474 -0.16799952883703331 0.012655661303060291 0.080591956873399789 0.87932743475734265];

% Layer 3
b3 = -0.70596948144912908;
LW3_2 = [-0.65815096818609964 1.1377397490735355 -2.2226321018838591 -1.0126780394488226 0.7332925086947637 -1.1035258569242403 0.86769455655940364 1.4887501614761609 -0.55283617376262983 -0.56621868932253494 1.2400503502356135 1.1670597770804754 1.8851976708543741 1.148428117502629 0.83952533698509058];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
