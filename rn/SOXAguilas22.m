function [Y,Xf,Af] = SOXAguilas22(X,~,~)
%SOXAGUILAS22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:21.
% 
% [Y] = SOXAguilas22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.8751275201168704;-1.9286347485345103;-0.94559302679456447;-0.94601562442244691;-0.95685653640670421;-0.40181345297294396;-1.3196094371072762;-1.0116174284599224;0.019887756744989292;1.5594483186120445;2.2725517935442272];
IW1_1 = [1.0299201697230587 -0.35694163519294514 -0.25785265410552954 1.3004126202764132 1.0534317970418041 1.3960460223494118 2.7018110439533101 0.4259186562176982 2.5970717987281362 0.69841612856901514 0.25369376254769699 1.6752980119230445 -2.8843165834018549;0.85047109095268181 -0.057145729074422731 -0.10498966368884723 0.5562203089520994 -0.1728916306755581 -0.051810084144676735 -0.41500716625858686 -1.8918727941041336 -0.11166658279381331 0.20751802211449319 0.069406553387300618 -0.062740591966401582 -0.1323669196317982;-0.061789468661376482 0.28092012308998709 -0.13498666372687418 -0.81068721124046872 0.21486130938658504 -0.48082634158377158 0.5096344696775631 1.9628474757606882 -0.25811190953845292 -0.17476760189540655 -0.45443901853450308 -0.30997860689177059 0.37494991958550211;0.83702887686390959 0.14456448554266321 -0.49673389287983583 0.44126841189572691 0.37343005666897666 0.30163266465454397 -0.2790935680014861 -1.1225953772554487 -0.1388166361149753 -0.13819480211515831 0.18567856463837104 0.34227446181243343 1.1470992768891248;1.2071411165735877 0.6020309199641124 -0.31240653276497959 0.53152536356984981 0.34162163630079401 -0.40974649157262533 1.5029106912931933 -1.5243298582462423 0.41397991522230154 -0.50839489134485061 -0.0087868040126688231 -0.46796621554149853 0.46762951170559208;-0.7890996637517812 0.45207444144801667 -0.33059061440232829 0.21227033652587515 -0.20702148995597355 -0.30653690713828297 0.23287875594967791 0.77345298351812619 1.2368579497039416 -0.12915201650913413 0.35067443619967864 -0.93187298741302471 0.35131419193261348;-1.1669706162718776 -0.23235617272627629 0.48409943229448155 -0.74219429804767134 0.11023944756684813 0.28243688892722235 0.069737832792863344 -1.5465654374003188 -0.21808240075050528 0.098077650972607455 0.027494726543612145 0.042400776310855696 -0.48616898526737984;-2.4230636708085966 0.41689714423181606 0.099538132016709663 -0.25411700674322041 -0.011182477877496466 -0.44501975145526268 0.81001245919992693 0.22858891689850422 1.7089720793460874 -0.3431750641921843 0.51174876563672289 -1.2314641013322878 0.3757094273656848;-2.7028997444671043 -0.10541618206552331 -0.18671530835725039 -0.22827712936158939 -0.21555607804653251 -0.077289151225155422 -0.64696075913462336 -1.043502281449566 0.32440180326774831 0.10532901068524501 -0.56336794563630033 3.0701727739290683 0.031086845429850147;-0.02465699649204715 0.13473948914375905 -0.68017422503990888 0.43298532753489977 -0.33900305634442179 -0.092748134447159736 -0.42238806235381593 -0.58854756829930299 -0.37817379778989152 -1.1930334866862786 0.55333786405071528 0.44539063247788996 -0.28933539771919553;1.5670277481899075 -0.18977326589798205 -0.76669447977729865 -0.1257957770150864 -0.42686216078822292 0.4876838650911251 -0.55756375819804938 -0.043960262357434159 -0.15758356640553553 -0.18372749156879675 -0.39846699416780179 0.37012522299133921 0.8389151491457898];

% Layer 2
b2 = [1.7113723648313655;1.38447903050341;-1.1963804331474563;0.74813305154225573;-0.567581017718779;0.12875172550367908;-0.096101889644537919;-0.81956503358115618;-0.93358826016620167;-1.4231669689503228;-2.2076084294920726];
LW2_1 = [-0.3916321994339475 0.17547235647388029 0.10363365254770604 0.73592475132814861 -0.16573788000955061 -0.73460477501830257 -0.81292609211651901 -0.13893138978594741 -0.4155355514523224 -0.39825754428893878 -0.35417614069861364;-0.45560325367564519 -0.14680268747338776 0.38435214572340848 0.27769963522994157 -0.54722774663970242 0.17062310929303096 0.43477864681753664 -0.60375882812550441 -0.047164916696577734 0.46734709191120721 -0.19724275388540524;0.45409139702316587 0.11943243368867215 -0.18175194523336394 0.18950071837909907 0.26113646905023857 1.1145327512301288 0.5503897146395762 -0.53074456570653727 -0.55622703514447236 -0.37361267764224643 -0.56523963484776218;0.14876994718700995 0.951812893297455 0.93079075315971171 0.54622797570021331 0.072539917012520577 -0.45725928414457867 1.0178851127548045 0.65289893462526027 0.041129638513596703 0.64210057299546031 -1.0240026628313443;0.93487481920895799 0.38703521867193108 0.33116764525371589 -0.36477538351856664 -0.33636194515822904 0.63508473105363283 0.094768325282042987 0.54952067237056068 -0.16566391036407868 -0.51495049766258538 -0.53981738399543455;-0.33301099077358459 -0.92337184781499471 -1.255604393953818 -1.1563222424935828 0.27804115668991852 0.45505616666716925 0.34521764765383445 1.579570984806232 0.65320269654896257 -0.23199972988243517 0.87945143624779565;4.0862419416462084 -2.052120666699123 0.7443173866851468 -0.48289933753611414 2.5466709046914171 -0.3427559207900574 -2.1352525238792293 -2.140793737653095 4.0733402132197085 0.37773073143190455 -1.7201555628298246;-0.81375421534154624 -0.43521777428099928 0.27036132845475397 -0.4878952153730014 0.75379822706367627 -0.32009193078796672 -0.33053100989925882 -0.32837103021526398 -0.022519165294370515 0.70266279419058908 0.068035296542436605;-0.29979890779770135 -0.38688982976557601 0.089521262544965369 -0.1414148460857384 0.37354975645303262 0.3205563473243378 0.20994549641237972 -0.25439592350332935 0.16380569695202812 -0.18755404179023363 0.95529714840826685;0.0035951408361035138 0.34185412268063892 -0.59190113269143385 -0.77333967911697887 -0.70763193497385546 0.4070204960684588 0.13438755774277775 -0.41199278849160337 0.3078862349200282 0.69575449620470264 0.14623653251145624;-0.035304423330435132 0.41146148253402698 -0.36560975348746244 -0.19426080326313783 0.51848881013427217 1.7276756352191394 -0.82644607511120161 -0.71755827471994138 -0.69188804521705494 -1.2461195100000813 -0.72327398879531735];

% Layer 3
b3 = 0.29323208901957659;
LW3_2 = [-0.34807554458770729 0.8109364908835649 -0.5763037515409245 -0.52932313492390393 -0.66042133380206824 0.32864005368307292 2.5048202522709873 0.16122218065519517 -0.79123766565545617 -0.27271293198193347 1.058304591922876];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
