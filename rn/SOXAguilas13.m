function [Y,Xf,Af] = SOXAguilas13(X,~,~)
%SOXAGUILAS13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:19.
% 
% [Y] = SOXAguilas13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.2035754569109272;2.7613038194654527;2.0614450052191615;1.3687941448643972;-0.11907355631544959;-0.46650018072415556;0.43579815825096968;0.51443959732261391;1.5361329310577601;-1.2134371010073104;-0.53498493355565313;1.8682521292138399;1.5979607222945158;1.8278522323081292];
IW1_1 = [1.6533759288155285 0.1818599865917358 -0.11558358225038584 0.4297646522166117 0.17938888620773716 -0.16185975714413564 0.19544817344030382 -0.01472832830877603 -0.26672443090760162 0.14178759621412498 0.087434529817763937 0.86039389024349877 -0.97373337326274823;-0.092242356405582301 -0.0054329937324825422 0.052438295093024896 -0.024905478409522432 0.03381486484136019 -0.084255436957534152 -0.0045935865607560147 2.397501865712889 -0.0071041906371450206 -0.11190690498398376 0.035844578935010765 0.030492739609716185 0.10777691987769744;-3.2591141739080882 -0.5105447487356608 -0.28737470779143276 -0.63862441399575243 0.36788780243576341 -0.48379963742059306 0.53690393736823638 1.344016777875624 1.2088171696614385 -0.28165983164152186 -0.10587318525598335 -0.73477650268581152 0.25381435202991254;-0.53023813649645724 -0.31664986141102541 1.8434852213416182 -1.800965926250748 0.73975084773409006 0.06778399215778956 0.13597773876869113 -1.420042549863189 -0.34705403693483372 0.4357335116683218 0.11854110759516763 0.16397659490752647 -0.42130422821457625;-0.57268521146034557 0.91838535416740719 -0.24404932721572317 0.6049235896137104 0.49558068643002445 -0.78184627167976561 0.2101452469771572 1.286801040008587 0.21665258908844187 0.029391341724046498 0.0248587091900336 0.11064213172122445 -0.69422310287702371;0.57160312233988819 -0.83992998473588043 0.14114840293127859 0.40089952372634569 -0.12273133274918896 -0.46406281077371359 1.3296044290754829 1.4218619735495284 1.087486478904611 0.43580637870844996 0.09950027482822861 3.7569781934663289 -2.4733242306678167;1.4764720439646239 -0.48970716877064324 -0.29749543808955431 -0.5745143439020256 -0.49782428732885364 0.93019482760840966 -0.081727611518704557 1.1091222593548886 0.50422301489215982 0.69889320634582741 -0.078406151846114464 -0.30371251386274689 0.3638577489354432;0.48132836676178559 -0.42193147530181346 0.17551607422232093 -0.6417805071128232 -0.50413036129108757 -0.2081272958475171 0.18058280141921082 -0.66662047266813285 0.21258845578963498 -0.50019942975620812 -0.44720356016071733 -0.59045561286245973 -0.65756773374144672;2.5584849068033648 1.2349847946501378 0.31990424515304683 0.70117269381347169 0.46096196900964276 -0.55450450355115299 -0.10651049732230164 0.017631900299100146 -0.60710755778828385 0.061104115175456546 -0.086824199780421663 0.39166985155106909 -0.12397806431354834;-0.47409039409727616 -0.40676216473401028 -0.093749220211208378 -0.072906018722579458 -0.25931387538850048 0.61417765111391487 -0.54766919715187101 0.46216517246992389 -0.61706086707901342 1.0498681278844015 -0.21579226693137885 -0.11214884955043589 0.14705641398052441;-0.17874413257774388 1.5916411557331467 -0.22389197792755861 0.52504099511696878 1.1606497736557693 -1.3676014298181618 -0.0076419964377409666 0.17231233693010065 0.025683776453356306 0.086475794072098502 -0.21153407437630445 -0.66312117053307751 0.067212430895941547;2.5117207057752355 0.6392858732252612 -0.05070842348767568 0.63694145573104533 0.48652091097232025 -0.15126669659937808 -0.13812446370391182 1.6181164958556356 -0.57720983178216756 0.13139150241374903 -0.13578589373727121 0.00068561881837301934 0.031439887968718577;0.46091414549359422 0.53414177643927363 -0.43754901078087777 -0.29816874551117123 -0.56711670522515867 0.69154560818737809 0.17652802188484365 -0.93983485304004077 -0.65404715090005028 0.1453568946655634 -0.64790107087219295 -0.16496457407770437 -0.51595103255693986;-0.2009082812151933 0.64417367265858105 -0.50061666863185084 0.69483194397745796 -0.56859994366670197 0.34521027602769194 0.40051438895512165 -1.3182479435257883 -0.23624297110154099 -1.1923941476540012 -0.42597287574888781 0.27388780332931689 0.32181426838099914];

% Layer 2
b2 = [-1.3781691664701026;-1.8080784457694601;-2.2011379649130038;-0.87513976744088462;1.0751920622020312;0.64336853329344912;0.091241485120820351;-0.32332621944129247;-0.11494796959438444;0.16210838509230435;1.1114231024930856;-1.3130726706863596;2.1144647009994166;1.5309737645528796];
LW2_1 = [0.34725849799884539 -0.22599721792303185 -0.58761451410758103 -0.46168828566184766 -0.091422408482066717 0.13474059209012931 0.05457777525985387 0.44834961406802465 -0.94847803227875316 0.23930421156215609 -1.0718550394936681 0.10172771719346042 0.21567010651313528 0.64519474952273159;0.19936039691075691 0.1776716976027565 -0.54121048200038813 -0.41432502254511422 -0.32375308677558778 -0.7502408405149259 0.66993548621834664 -0.041087968946237195 -0.059212212026256691 -0.3970962397659048 0.50015805859590823 -0.35097570816851414 -0.41078288982405764 -0.64942557452377281;1.1915992263899611 -0.50113286572523086 2.2207036337294666 -1.6406454411230456 1.2993387836637273 -1.5072465120131471 0.45811483672140535 -0.74040523298295158 2.0444220474590526 1.7326197652033333 -2.504767949571614 1.6237822829094173 -0.10918518935150202 -0.63409956163540127;0.81226091112375953 1.1643053560601877 0.081573596425109807 -0.85536626121514059 -0.21616770154545198 -2.2650696249243754 -0.33441114596380794 -0.74385439323544167 -0.44976986799763397 -0.075992703130789319 0.83009705364121367 0.61049670922322907 0.43945313568913258 -1.0514505545454786;-0.35835843675793422 0.82008927724902003 0.84012379270249526 0.37314548195210528 0.89706345116677866 0.05708188194045101 -0.038072480338428451 -0.16736775348082122 0.184213520902584 -0.23209564426045759 0.72733876819490484 0.83471131698911782 0.20825072804859249 -0.58833857505657827;-0.25588154784206174 -0.84800154609017564 -0.055346302355441038 -0.38229367475526815 -0.27593649769763556 1.3996151358274795 0.92061303807597339 0.7135483651129525 0.712887672082683 -0.9538308939836313 -1.090697791853753 -1.4799418403129712 0.66943084152748022 -0.18736744851200401;0.28282753456346671 -1.6850088011746132 0.1376852279654967 0.70493301893547133 0.352382889779916 0.21276026259966641 0.26643116554172391 -0.083891540639229725 0.43705850887005498 -0.061064843281369893 -0.92976270409030837 -0.53440731696869659 0.68343613838623851 0.85272152559846559;-0.050018683119399804 0.51209722558574167 1.0165687546041444 0.66983263231733714 -0.80670058567450031 -0.22728409897283833 0.44270895825215478 0.3521725518773694 0.48438118722641788 -0.10045307301998986 -0.40353588931359763 0.43421969431867452 -0.69509978499997704 -0.21476305288027789;-1.2622260851047808 0.089220030066814268 0.59894901803394585 -0.39439599209435366 -0.14339183255375249 1.2884965572134299 0.28218602451829977 0.60032973068492634 0.18885525239987233 0.045655491636086343 -0.7391136997062383 0.46393170511875959 -0.077944251948361104 -0.39114995320498097;0.62440523239043977 0.034983310785420267 -0.64881117108240327 0.25281331512508837 0.55102564999350023 -0.61674539230187353 -0.12099088749622505 0.13718773062052655 -0.15769523648063741 0.22561332390898703 0.143510236553619 -0.44245316720053512 -1.1808715226895035 0.60955559311069141;-0.058423695546797501 -0.38143053844451402 0.64007271360214923 -0.22712823892936601 0.14288862228664329 -0.019068683197076018 -0.0065099012987300305 0.72785546190171757 0.46305843373468869 -0.66243002236608595 0.45653457006339071 0.76201797395777793 0.13129957914025089 -0.13482085417714876;-0.65806052055682018 0.78979697521039138 -0.071002490565833298 0.32627195182066576 0.3573884827008133 0.058703780754968606 -0.91331223192234101 -0.44539658003305749 -0.75679093993638058 1.0603788353633612 1.0888547792875451 1.5204877619114578 0.23762987211194442 0.60921444187223983;-0.13603169691138586 1.6851036734508935 -0.64527664754966285 0.69650392225480806 0.28803621830009479 -2.7394810001668923 -1.2640149427898022 0.0064262229229576171 0.54142845551286756 -1.2530664669873011 0.69520168489429879 0.62584001185876759 0.7743250285019686 -0.20305969277793379;0.038926009608176604 0.17054213646622318 -0.35144025829679054 0.82015478536604336 -0.32710627552773752 0.36593787870637096 -0.0021984871113993193 0.17115284574344097 -0.28052912154384335 -0.16327204537298434 0.23149285069765857 -0.46922724437743252 0.094418450879260596 -0.61912356622769571];

% Layer 3
b3 = 1.1387917951192703;
LW3_2 = [0.23480299837320784 -0.5058895370584281 2.0818576293162576 1.8431866946266833 0.33414435180031088 2.7411923297474905 1.3647782047979189 0.88026948229765678 0.35187987622415412 1.2313319260619584 0.3140753495489309 2.5031086822787634 -1.7611867180605958 1.1847484612764885];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
