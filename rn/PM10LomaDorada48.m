function [Y,Xf,Af] = PM10LomaDorada48(X,~,~)
%PM10LOMADORADA48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:14.
% 
% [Y] = PM10LomaDorada48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.3852479583533683;1.5734424254397734;3.7737325821964536;1.8072035212901316;-2.554182869603002;2.415835718570587;0.63532554196398738;0.090231930124865259;-4.5208142746787301;-1.7003828054248966;1.8301981769416291;2.1521533741888841;2.487828031206782;-5.1920120421423617];
IW1_1 = [0.20830979028494132 -2.7112546938785558 -1.5433658483746231 0.97614700873850435 -0.13251940928232991 -0.76762493772214568 -0.59222015133520967;-2.5167110370686872 -0.1399823196461939 -0.16876605738293704 0.10082581605851537 -0.34470059885750443 -1.1095635268939528 0.35462189002069838;-0.65736688957674283 -0.21637533749581853 5.4462954488071329 -1.0479111419744811 -0.64319427144416164 -1.1118244880154118 1.5381742396151308;-0.55591162508247338 -2.3058658016469482 -0.039367562121764725 0.38366578986103356 -0.28106156193032883 2.7623728303156718 -0.62654495335742966;-2.0398831791380285 0.01677993288288622 -1.832869261582033 2.8418295555630166 0.22132249810580523 -3.4169543495962875 0.15294617018913229;0.25169942614599305 -0.77112406735894101 -0.22421413792669215 0.61734163164641509 4.0407877119219622 -1.1262195573735347 -1.6474556492084269;-1.020481333423753 1.2024016960369213 1.2634165483424307 0.9394597328261205 -0.59453446345032357 -0.91954937434096151 0.40584904998381632;-0.96460043011513419 0.59857097240235424 1.4436689433648697 -1.6801442747082802 -0.5593789042040771 -0.25729445183302979 -0.27299653127949924;4.0414902213190906 -0.18087593532164323 -0.65305817359685936 0.21577964810949535 -2.4558408589504146 -3.5597938076557947 1.0602784774974578;4.7475341733092344 -0.45474142582825594 1.6863978362995762 -1.3846241520637066 -0.13642992565818798 -3.6200844422351484 -1.5758559065822015;1.163373780719537 -1.2047873847901318 1.7363670057543565 -2.9330533587330572 -0.19697210248242397 2.1693336268351673 0.21038826851230008;0.62652925015729888 0.91799193137489865 -2.6029395938298601 -1.5784109834066598 0.80933657556978944 1.2354698267054638 5.0650031052176523;0.22744056236756857 -0.93870295206714449 -4.3533720910291791 0.89491739820643168 3.1608185233900019 -1.3595623948562416 3.0349727739158547;-0.1269307224922929 1.0596854066121371 1.1289074353557098 1.86864639260626 -1.3859252048203774 -0.74832923138198781 -1.1168491714185222];

% Layer 2
b2 = [-1.0782898125225169;3.5641310798759793;0.95014051802159571;1.2369419963466202;-0.91012184117404815;-0.42003078588718834;0.064222014371472402;-0.49496848093036033;0.94151769794239859;0.69162463506292493;-2.9477973190945042;0.45912617247906939;-2.2054976816193008;1.7357179222788712];
LW2_1 = [1.5428538790413895 2.2099832900404546 -0.26130841232884144 -1.7871331745151247 -1.1728727578095632 -2.2172230695095823 0.68559833471675669 -1.0706457311015312 1.1565576314235895 1.7891965257506253 -2.1556368820789538 0.081111375963943369 0.81024003099927677 0.61704734817301965;1.426873648910403 -3.9357605921670911 -0.38235709386327793 -0.67676402431194804 -3.0047458015273687 -2.9124289091499787 -1.6632216555223751 3.3096595876593402 -1.0902089991211685 -1.4514693731459591 -1.0037476853808556 0.47358327639335013 -1.1323325384768059 -2.9569190083889305;-1.2424684928298579 -4.0735854367827296 1.5114695669369653 -0.26549779583822597 1.9745739988415574 -1.7901176725187107 0.57257157706126627 2.3201931248325232 0.83370804818750788 2.6162225778997499 -1.1896464820809971 -2.6106631293763014 0.23433343580959978 -0.14903904262275219;-0.36786752037909382 -1.301484405305809 0.57413551918066363 0.4312191340778922 -1.0887682712591773 0.24690045401113964 -0.51202925043670899 0.16109202683785312 -0.79726300656299842 -1.6726559089040574 0.54815209222903905 -0.55439594635348444 0.33007826528191148 0.15207375675172255;0.53366497893694287 -1.2256526484297761 0.38409662169957948 0.39264936284904223 -0.64050541634508684 -0.10755007469996057 -0.06839708415659769 0.6600283076036193 -0.29591703025480937 0.11626315567995346 -0.6525617356493395 0.059832276450480094 0.23864265468561804 -1.2348098424116425;-1.1149628803173752 2.3399098375315295 0.43794228445411026 -0.34521861071617693 -1.0771866936027095 -0.7833993843950855 -0.28209428637862766 -1.1031148571585312 0.53279503471806677 0.073697905351209528 0.098730114486133738 0.10258440920603584 -0.12574734499568085 -0.55870744579684761;4.0520403544301855 3.7726061662510628 -1.5700073604699121 -2.3859176064494019 -0.4191981180902663 -0.068639479349883237 1.2857943780197616 0.76137765589392292 2.4597164492218888 -0.68184016227906286 0.35302956629721999 -1.3129509693628885 -1.2788186013769711 -0.69003118715877321;0.21623875286262526 -1.4554641309840997 0.86183366122830618 -0.037470874127424149 1.2211509890474248 0.82787556676979202 -0.07816564439109755 -0.034731238753869492 -0.74627472183989663 1.7652703841300217 -1.2453904293474964 -0.32801343098319802 0.7291225718945471 0.44905258755841015;0.02985000464639697 -2.9768929741636714 -0.50286605210808244 -1.4702420482995813 0.27330640262156525 -0.23199477529314372 -0.024063537377625094 1.0214891052116157 0.54773143029411908 -0.7341812689162226 1.430246498009611 -0.41069253500094738 -0.020140909693649654 -0.42751137496439728;0.46602440242674226 -0.92902190681938979 0.25959992037316609 0.23023430448642412 -0.6562330894960885 -0.13326715985881063 -0.095125549121908903 0.68468116842804083 -0.1742349505673913 -0.057241155011735573 -0.4309990649107906 0.078949395278479079 0.1230090184120563 0.69478260981385853;-0.35768714850714589 1.4605987447825817 0.01425929098075724 0.18628879116126115 -0.16267452178832123 0.042109054044505025 -0.48346577064137386 1.5495173181121553 -0.81214745805547794 -0.38142290224448594 0.16545255566544109 0.45458245521486085 -0.4131742800693341 1.4307521368412814;-0.85395190042304958 2.9888971734127381 -0.097587470458117748 -0.57278015778576441 -1.0055735922202391 -1.0316458381894131 0.3874298729130165 -1.1887151822820889 1.0715436541265155 0.069370677356371008 0.73026199922995394 0.2813909159378713 -0.35679008885203939 0.2008170742627523;-0.12728160463180374 3.9346767550463686 -0.23112073096952465 0.63461887254245719 3.3134294317907975 -1.0876459288901532 -1.1771266809734149 1.3925516370423461 1.898097126978185 0.69204615963141625 -0.72466109337819284 1.010300218284357 -0.55599232452008951 0.34912763393763824;-1.1797924363920884 0.14466922224467496 -0.36422838591401591 0.46892721219088412 0.87060737061018367 1.5858819461539837 0.83255397371140782 -2.7352417918555592 -0.80595236181527952 0.14923868912556545 0.59501726676286915 -0.28704551388476801 0.013539740689140076 -0.56163654917727535];

% Layer 3
b3 = -0.80428679100982758;
LW3_2 = [-0.17021816095383902 0.14572646924403765 -0.026704793782345238 -0.34332220710641648 2.6935066851009366 0.71746106867949178 0.071967759664724323 -0.18668854494663287 0.20761090812753641 -3.0893597640556263 0.72846435341678861 -0.57397835577141154 -0.14417779422723687 -0.21602557539827658];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
