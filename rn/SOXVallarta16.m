function [Y,Xf,Af] = SOXVallarta16(X,~,~)
%SOXVALLARTA16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:07.
% 
% [Y] = SOXVallarta16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;10.4712041884817;0.00782778864970646;0.0208333333333333;24.390243902439;0.02710027100271;0.00630517023959647;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.363406142417805;1.4075045082847142;-2.8369755589142045;-1.4231190164521179;-1.2911722555991452;-3.1282731785402005;-0.18562297479301476;1.2317079594202403;4.3793423202427544;2.9082722135246653;-3.3589781824588711];
IW1_1 = [0.54099634253299989 0.3959824673931806 -1.5241639356962602 -0.10877142088459646 0.18585212719645905 0.29625331052147547 -0.67774769288994419 0.073950314556015667 -1.3008768350345585 0.36282451068960547;-0.55714125340385634 0.63892495063016441 -0.73030223867213295 -0.19528820496292104 -0.37824217294269324 -0.064554840707733416 -0.5986923652205971 -0.87682878991612745 0.68391283048836116 -0.24725467558310169;1.9390291855252506 -0.53397976272126146 -0.15796028323624348 -0.48891488554588874 -1.2754265604151453 -0.9815578681239201 0.74777499937911729 -0.82893142739269221 1.495470982629415 -0.34034591400419939;3.6640988786964281 0.88227655735920296 1.2501225193240884 0.51404301809026542 -0.24274084221587516 -0.44894430113416728 -0.50431423015228571 -0.96543782441834447 -0.65383538016932707 0.069291206622564244;3.5004653515445416 0.11916606855240217 0.31109986208081764 -0.53773221360482615 0.45577702795929226 -0.66548706009175684 -0.050683940384890047 -2.7771011501135536 0.33707490442030386 1.223496425467467;-2.3899329056767673 0.10875264139574611 0.53894946806980903 -1.4844917348333611 -2.1276853676740539 -0.79242455021666858 -1.0706048542671043 0.44057044558831709 -0.98420589877646114 0.28415837596657578;0.0014427531617845768 -0.34724493842441106 -0.4663287012688338 -0.64013855333758063 -1.2118908242494204 -0.47900249544775564 2.1462924959750951 -0.15832133103208509 1.5987639783215237 -0.15642307574523134;-7.9084475041874729 0.11226662035237621 -0.19197028882916964 0.25769731536868978 1.8512616868871878 0.9137856046705557 0.16560371321048264 2.8314738253476781 -0.082875583820027771 -0.70299615116219882;1.2985952923083122 0.23140716406774137 5.5225666152494295 0.17314867224722696 -0.15945111114932173 -0.4820680632577527 -0.88901080044500325 -1.4242414790579463 -0.219989349510189 0.1923140291483863;3.0093902087692479 0.027101736681764972 0.77669408557276376 0.16736042653785382 -1.0649013098308449 -0.81657591706515764 2.2278566607787766 -0.97229070411119145 -0.051409463268345668 1.1422712514453663;-2.7171134324429174 0.0091767914597898348 -0.62097309343662965 -0.27089833589600482 -1.2079401227149196 -0.51839208805413561 -2.0502598790472626 1.5622698819321001 0.38016764828045724 -0.52682007298969091];

% Layer 2
b2 = [2.6435557922536286;-0.85147126912668925;-0.71293447360143891;-0.35375027328037001;-0.26727135148344411;-0.66344043681577747;0.79770598960261907;-0.76114486808683002;-2.0712650444934333;4.0592316815117302;1.7678607347595963];
LW2_1 = [0.2440387896594545 0.34993227800941706 -0.26264388088488366 -0.29386338368261533 -1.4731753839356054 1.9962817266052992 0.27915636160107199 -1.1450392128874649 -0.49310175406881679 -0.99265444854659091 -1.3007748069480198;1.2256766691932586 -0.52194836825772306 0.2125038909907267 2.4242910511720446 1.0331409509814997 0.58382191925102211 -0.043353271346335098 1.0442447098857031 -0.23776476975312261 -1.2376688838903949 0.26188947192963141;0.95857161304637062 -0.26009824007092081 -1.3938154340694975 0.38203656516494161 -0.10267271498233357 0.80906321738045961 0.62971987008479968 -1.1738672522328781 -0.78659984616779521 0.84542649963018668 0.9208907794058997;0.70267073521754386 0.98317541798233654 -0.2271931490064262 0.52098169496506164 1.0267854353807917 0.9090273600328761 0.42851960321092891 -1.3628289295357854 -1.4472898449709812 1.2081659151945532 0.07173993330860548;-1.1644655403408997 -0.22276322228773543 -0.13518902577505842 -0.088600587010989773 1.0713990892320961 0.54758879486244882 -0.059978907760292875 1.1419945963184437 -0.57750888564171599 -0.7084311561803488 0.62610127586430209;-0.2642246634111115 -0.97522748951969629 -0.53327611744976799 2.3532423108834171 1.0911478512181125 0.50690167489432447 0.61290262010309648 -1.2687829607824186 0.075124829103820637 -0.88574428272157479 1.3500324495279992;1.256406849046344 -0.23251335284442359 -1.3373771650324069 -2.4911113517810302 -1.413247341648082 -0.56791137662245816 1.0802502181713196 -1.4086567343411294 0.76971563927204778 0.38732739662245508 0.73487374377123293;-0.8627179764217815 -0.260043473994862 0.32346405838466252 -0.62191291979727015 2.230008543927779 1.1675831952664026 -0.064370996367195371 -0.73203223387037097 -0.18579041821208098 -2.6099314756982182 0.28301071467649586;-1.2818769073668235 -1.1457122271903266 1.8063424160382744 -0.21603258575014594 -0.90918840555305447 0.089515472343790092 -0.44102010378991108 -1.6866347556448817 0.72847357637145671 -1.0960952706138916 0.51610453509380538;2.5151736831475526 2.9348592930108635 -2.1809554883500453 3.4834649894560452 -3.9832614967304725 3.7303041944431237 4.0374335201054592 6.6751192907132584 -3.8933501526838619 5.7104259500100412 -5.1341068479831344;0.52846475749254529 0.55764283077976462 0.4954288969941531 -0.62082335565413471 -1.2770776535603692 -0.99956807645312351 -0.53360631023470839 -1.0203623497984944 0.74627199906069297 -0.75708969169304119 -0.19271992458183734];

% Layer 3
b3 = 1.3265757048784033;
LW3_2 = [0.45369518212772392 -2.5660003308783814 -0.046322437024170764 0.070055215581145788 0.33738209643176542 1.5773917632222159 -1.0690898958958479 1.275911048960606 -2.8359711554309337 -5.0083644251521244 1.1324249942988793];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
