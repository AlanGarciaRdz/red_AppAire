function [Y,Xf,Af] = PM10LasPintas14(X,~,~)
%PM10LASPINTAS14 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:29.
% 
% [Y] = PM10LasPintas14(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.0251256281407;14.7058823529412;0.0179856115107914;0.00280033604032484;0.0558659217877095;0.00576368876080692;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.9597199936382217;0.6424429695483368;-2.0091528401025212;-0.98020861619948407;1.112531704671625;-0.15704361847242512;-0.36802485501293103;0.11837922603968687;0.74987477747550757;4.0196582692219263;-0.27923095141426507;15.827793429251862];
IW1_1 = [1.941007391789086 -0.72483151137842394 -2.8107302886321435 1.3648560285622202 0.94492783571089378 2.3512908344755332 -0.71686423383177456 -0.98739132597094736 -0.30092308193124329;-1.9402485309529574 0.11184170184155034 0.12206455621073752 0.35340376761684245 0.62658016026312824 1.2889936671804005 1.1548666735516315 0.21083880722241385 0.0058770854586824824;3.6879227237296353 -2.7310837364540022 -0.26713808107670833 3.321616624621488 -2.8858116409844294 0.42889120364053868 -5.3086429307753509 0.26068351554458197 0.77370216953168913;1.1002242997662717 0.56656028050328255 1.3554491314944999 0.53631277228910568 -0.36741554617477806 0.53992910413015116 -1.3161955286462621 -0.23832513611694789 -2.1188525608502573;0.45188967705004063 2.6137380739853198 1.0237734211689715 -0.17051993275252358 -0.43573819571722916 0.10577660052910463 -0.78720089332362908 -0.035013006928054487 0.2778244894631951;1.4017863586370707 0.45827584145073086 0.90979599214901696 0.056643895808211719 -2.3303069816556747 0.12642593621490045 -1.1692951330070394 -0.13476824832230286 -0.50206397703514261;0.061268005858415991 -0.39989017060235155 -0.10702099853075815 0.31495781930708522 -0.37952655541474478 0.30933782021415623 -1.1632929228101689 0.029401237868564505 -0.053652196661894871;0.46334490366256925 1.5544817202398991 0.56912271348675458 -0.1642583708182582 -0.34025671194831947 -0.023576225749654515 -0.4994728436184937 -0.086299597131090852 0.067120504323710389;-2.320615067648387 1.6157572225186749 0.14097515302333802 1.4252654798277133 -1.6278650786998463 1.960448446952795 -2.5573394209436855 0.0097282915864833411 -0.69461940601901717;-0.11523848661798029 -0.50438554867554108 3.3791790237821124 0.80420959828358596 1.4500020629426693 -0.24992189271970855 2.3602662916955715 0.049891100070893257 -0.30770625920900091;3.2303962091118152 0.31298755055685251 -1.1088349976228844 -1.1084708192238577 -0.11600962872953176 -0.40118704850682718 1.8488930733369648 -0.58021773495032924 0.20435641980320388;0.57900410079893605 -0.063874476370254785 -0.83077680593419512 16.141168442388576 0.16390436657625798 -0.54299248708477044 0.31012024234727975 -0.13001241178442285 -0.18613201352765699];

% Layer 2
b2 = [-1.348243234374509;-0.047054364658205353;-1.1708435814546434;0.21698049470465497;-1.6134123892348953;3.277325887615067;-0.77773353711227822;-0.12905865787878457;2.0688961502812497;-1.3126975430122252;-2.0633319169782256;2.5308597769046584];
LW2_1 = [0.78735256937698439 -2.9245142029643136 -0.31285805014547469 -2.838418426243972 -0.13340105227182322 2.438428147537639 -1.5595926151623496 3.9751332198335922 -0.31471543698993737 1.4846299627675175 -2.8544588268380338 3.0159596255546486;-3.0512754442366679 0.8176006094749666 2.83881260355313 0.73091034191127469 1.1070731573016757 -0.64763065472329895 -3.2631905268224104 0.48794704228654262 0.82974001515317752 0.013965979844061852 1.0119191359404394 1.2162762588307547;0.6343427523247116 -1.6475242324101842 -0.82610771377673731 0.32208973198263813 -0.14598394345318055 -2.2703870162031574 -3.0574403316120891 1.6231535793117307 0.57584089655265713 0.41659173736736038 0.57298587826617053 -2.2233642720533395;0.41505425703518617 0.68740965832495016 0.016905499918222093 -0.52924615365954897 -1.1827163333282968 1.3768932947934318 1.2894578344678322 -1.1104239387908874 -0.64428368268330294 1.507254939795124 -1.8659615911635152 3.1755789768483007;-1.3358588114155199 -0.50026886202307019 0.97291556576674476 1.6073140567081139 0.79470004326349875 -1.7613684435468762 0.49542131627883967 1.1825536454002445 0.56036618990285259 1.8805378269361748 -2.7840637438051705 4.7643686802538632;0.40863741046662344 0.69296588710343587 -0.98241305220098674 -4.5585405094337297 2.4935426685538968 3.2677001048012535 5.7155078488022539 -5.6983497759658919 -0.86650644516605546 -2.4904279455202945 -4.5236301470711116 1.7804722061206635;-3.2478570618778742 0.13949093418457315 3.780825149366247 -0.54835699669504601 0.10854222804099134 -3.4725274423387069 -1.4772874402617311 3.65997184384194 -0.11583368327545973 1.0377167402907954 1.5312426774407568 -1.6077730587080592;-2.530422096678699 -0.13406186106517695 -2.6012108398495175 2.1466569400114603 -0.49394710132777753 0.80217828495969057 5.1769578470363262 -0.71508713189833928 -1.3145061850036741 0.12556646135297206 0.91427073575919449 -0.88587066433630701;1.2870196099773785 -0.54059331450244341 0.50246858654905324 -1.5522485320441821 3.5457263885251242 1.4110912438954684 1.8032342411544391 -7.5067038795953804 -0.47735305660537158 -2.3544379789827263 0.0038402075769677808 1.3205607230630172;1.498615634648671 -1.4597159671226483 1.9034513166304239 -1.7117224013198462 -2.7304705844959445 3.6136820997064865 0.13557892474253422 2.2581049432328157 3.1333671749583054 4.5795642400196348 -1.2033178866824161 2.461880709999845;4.2357375557450219 0.27063023418711951 -3.6529231267292985 -1.1297275832254114 -3.0301835549208245 0.81260338242453023 3.5711879482890501 4.3527324097632327 1.3964655540744273 2.553497708193317 -0.057982776231020446 3.5334968037932888;1.7306734912837898 -0.13244645093057367 -0.52214835662586845 -3.3981347414667242 1.0242677764175547 -0.88646796553203444 3.6204486506393136 0.99292789349901911 -1.4246258160151855 -0.55330710791864846 -0.15574762285879873 -2.9130469465210989];

% Layer 3
b3 = -0.87913949791348145;
LW3_2 = [0.060254619482588721 0.25123150916586917 -0.2591659430327341 0.10499426615412974 -0.12688868879539422 -0.098407963063779483 0.12441548114275515 0.13504608244263749 -0.11207249230589335 -0.098468564944475895 0.23795711799368716 0.13940725577750154];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
