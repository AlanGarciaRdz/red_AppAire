function [Y,Xf,Af] = PM10Aguilas1(X,~,~)
%PM10AGUILAS1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:47.
% 
% [Y] = PM10Aguilas1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.893271370926727;1.784584169879825;-1.2618852940379877;0.89957212800489539;-0.87451185108914065;-0.4193123828301426;0.24244476494032416;-0.38706416700346791;-1.6958119970426129;-0.76957490977950316;-0.43433375125065782;-1.0921199341340431;-0.92438013432155985;2.4687702778585989];
IW1_1 = [-0.35562895936885286 0.82044743440619483 0.51994344527296865 0.70171388461103579 0.76657607021509988 0.2500519071426931 -0.22247869169554349 0.22007612587602621 -0.42946681105230061;-0.054389474679807467 0.8254716461038194 9.3550063491442542e-05 0.0058863469439428282 0.62444202747050959 0.41121604205635232 -0.81256584317456804 -0.33482159176211979 -0.33729606420425257;-0.030384516353186029 -2.044252490681806 -0.60848417019200363 0.62528420743693769 0.41593576821541084 -0.72329609300760966 0.030364151153081061 -0.52870685060749312 0.53092657800545395;-0.90566130227987096 -0.8514615726107656 -0.62134035925439335 -0.46951109422866838 0.16848603477119142 1.0440789224564115 0.26744471243840995 0.02839408448767217 -0.84964853665812279;0.58012080630721641 0.22462358372337021 0.55698180858158208 -0.12209475614113321 0.43049477493842903 0.13422274111196619 -0.34968521420010584 -0.086274437833235157 -0.037117909563021981;-0.053420909296181228 -0.57676133582469757 0.076255572322369042 0.89529592170433425 -0.61141398436909311 -0.28209696874283574 0.52955992206770097 0.16091238458853827 0.25727509794064146;0.15924599968063124 0.14799347631178303 1.3674981729121083 -1.5254834126183583 -0.90850072657840142 -0.45974494135081651 -0.29889954281955888 -0.89541822749684208 0.53588647131291811;0.10999705534174176 0.23865082966638496 -0.28428771922685703 -0.39499237074369048 0.13658089815399954 -0.0089297701490654788 0.65968414866417779 0.27485380037514701 0.15678685207451026;-0.1458144374394921 -0.21100422580774764 0.12079910660254373 -1.3611874908827875 0.1044646878457394 -0.02443113462079529 -0.18421595143389205 -0.075900913020781169 -0.030926340818457153;0.92721547094474721 -0.42866700991986301 -0.5010538175281597 -0.64461062727098095 -0.51558659114389005 0.23115767950125302 0.75308135815011468 0.17302460109432166 0.58140584508389526;0.074677345208055843 0.8655880313305403 -0.14428864372135 -1.0412729355858683 0.82770153449585893 -0.10796971087431194 0.71311775679211553 0.14488397734317088 -0.25036712079777512;0.20470509192415548 -2.869903938215427 0.55326435202365143 -0.76999825319352722 -0.13441467834682852 0.34400558931903868 -0.26160101498751104 1.1200685154057881 -0.46869622225069985;0.76830161948419895 -0.60313951575314872 -0.79230988933955138 -0.81931202378855827 -0.13127958747671772 -0.017656864399798532 -0.71543826021012091 0.11118297507698399 0.87896913510355879;0.88660994111165836 -0.63365179209312805 0.67782263514074814 0.73387307378914746 0.85818288157720213 0.18453134019828871 0.31238834043822378 0.16655633053916186 0.62248564015581487];

% Layer 2
b2 = [-2.6826796829278492;-1.7363526936025218;0.93328292840810512;-0.28559537085772296;-2.3353702204650499;-1.0866442038446131;0.22783463233563725;0.010045073633900631;-0.67265971012325732;0.25758133781096565;0.72998190283775555;-0.079288867706533969;1.6859898729362603;1.3938373960579196];
LW2_1 = [0.49126239945745603 -0.12614935887619461 -0.39070276904254814 0.36279153494527117 -0.54132328969139887 0.89897749413153094 -1.1338568187615061 0.72588718850229206 -1.65471730340441 -0.64784645788315998 0.11843029809392282 1.0441421539800035 1.5192460198396021 -1.92346387664235;-0.17317415489489954 -0.7753970913000251 1.3579880040341934 -1.2276398356775073 0.74194217863895617 -0.21601828798933975 0.51720767588695293 0.91879076495916967 0.25493785631368659 -0.15684489573954949 0.37581258631405762 0.81067970967871872 0.60972429619016855 -0.9814133680797682;-1.1034126757693603 0.36974716001707614 0.0095818318835020188 -0.16026927038291242 0.017618708369768782 -0.59085576366552883 -1.0915409159317002 -1.187697440165872 0.27264169690217332 1.4469514373986185 0.52466435620163288 -0.88132985909230899 0.96835253203631932 -0.27645682944920918;-0.7039235769986415 -0.059363258416209833 -0.36970518564995658 0.92073668183446933 -0.48126959905802058 -0.7218533455050552 0.37621681704177939 0.2546938050416101 -0.19074257507047279 -0.52404280460508457 -0.47619355286001191 0.020152742645292175 0.53637598963041699 0.19161021004754378;0.71779185427747128 0.34606369556829686 -0.066528017149495799 0.077197967133243867 -0.6024767185418507 0.16247508343436143 0.24480222577357666 -0.48153674267294011 -1.2539028639255982 0.051060444230705354 0.29371070664558374 0.1814899186586319 0.18573757151120135 -0.029656609366923294;-0.66511938975778406 2.0659243852410336 -1.5748802396377497 -0.73452513283041732 1.0902861742878796 1.3064519542859143 -0.59915321230155882 -1.0725137308717305 -0.48840677151472284 -0.87789489050897784 0.91312483505660613 0.95788831255106544 0.71297097710860646 -0.67527625087299736;0.74635373933604987 2.3492155572075566 0.88213551299865567 1.66180024412073 -0.55024413346794054 3.5935428199703283 -0.12294356480749098 -0.27972825376344818 0.06411730012267064 -0.19743823757155049 -0.58142278797578062 -1.3509960391962468 0.45651867706839488 1.1186748962585331;0.71283241879279791 0.40473301956507907 0.18443155730603986 1.4396477603947739 0.78587548208622859 1.2153481270444215 0.56186693206103366 1.0478555341529872 0.83555250872691855 0.1775662891995867 -0.65565714708953626 -0.18203666878608124 -0.75849855286086665 0.20881047753068047;-0.83795175892002294 0.91049516935122676 0.69319902735825989 1.2667583428956892 -0.20252651520322565 -0.66201286752800481 0.73648522418671536 0.93832347376420044 0.76940036897136144 0.62166466909304419 0.23649659946118987 -0.19067858174125851 -0.77138502963621736 0.45013987157146873;-0.13978582573482551 -1.4448655857289281 -0.61504354914761228 1.7076482731753533 -2.3749020723474352 -1.8312619236925589 -0.54658289570732388 2.7271685479892169 0.38815407824473419 1.5207230643175484 1.2481618443598435 0.61725658938153771 0.067367280653215067 -0.43261149595764958;-1.9402757972279481 -0.6044528226831597 -0.13608341651786962 0.091663523770645253 -0.66487433628088932 -0.73566234278496512 -0.53538779082574806 0.21936209173126942 0.4782868095550834 -0.73324090151939902 -0.33146328449672491 -0.19086081204828523 0.024226007075449356 0.29849809808857936;1.2662375418787244 0.14529909202479593 -0.22362961756387412 -3.5124853292413554 -2.1516080820917032 -2.2672423110651914 1.7450626004373124 -1.5466469036053121 -0.55976177161557239 0.84602024146078336 -0.46744906769103362 -0.048328120862565667 0.74043187654037157 -0.47531805850624786;-0.26861124154908728 0.0029454245232353308 0.063689181482975837 -0.75396217391341003 0.9226527495153618 0.18391160483387886 -0.18827251417556948 -0.14634263550687754 0.19104819571201445 0.21011178614316003 0.026120120475990691 -0.10312327238863339 0.33284824735588159 -0.1223816537756497;0.6016456437567772 -0.31782897754909056 0.68564524170238927 -0.14449500752420907 2.1866436507966029 0.31903085018329219 -1.9586274992316071 -1.4514500095404732 -0.8542615331195863 -0.71240171278717124 1.7209587868213572 0.40136836455941893 0.59567906345823241 -0.11596302611431079];

% Layer 3
b3 = -0.14245890615973755;
LW3_2 = [0.080332997947547113 -0.068110962042725792 -0.034075849042580326 -0.47037824860381122 1.0542804305270881 0.14123943923852655 0.22910356440837129 0.24486625598553527 0.18867638696917932 -0.083297178004239678 0.37844708087030571 0.011162964828734707 0.41046912633604576 0.037903737333103663];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
