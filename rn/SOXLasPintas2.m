function [Y,Xf,Af] = SOXLasPintas2(X,~,~)
%SOXLASPINTAS2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:43.
% 
% [Y] = SOXLasPintas2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.0179856115107914;95.2380952380952;0.0558659217877095;0.00576368876080692;0.212765957446809;166.666666666667;45.4545454545455;29.8507462686567;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.0190709680002312;1.8650877913295592;-1.3793538142702553;0.57026489329563779;-2.5266631617464581;1.3954226590251857;-0.35297055812062833;-1.1798285476264547;-1.4774089953289684;0.98838277348970216;-2.0600752558248212];
IW1_1 = [1.8692441913443032 0.46320561876773048 -1.8460976128199695 -1.4459101278646829 -0.19857257239122925 1.059096351593158 -1.6355648660304238 -0.66759464881228048 -1.5316888044041912 -1.3287946500065395 2.4929894644910937 -0.28956484390947057 1.0911632241938742;-0.30016996106891047 -0.04984008085968112 -0.75217809393834345 -0.56142925895271401 0.313893366458176 -0.7849954414650967 0.74197346642519924 -0.17779766476970457 -0.61094750626677974 0.012885002144381956 0.36374277839073405 -0.52889340829287534 -0.1882969630153328;-0.54750964139995884 1.6504811734523401 0.12049487813609691 0.22437822883324179 0.84767981501447021 0.09680006783694696 1.2264008548209524 -1.0387912026792034 -1.2337778395949102 -0.85387267880006379 0.89097028226900332 -0.095103541343954615 0.16867525083315765;-2.6964473736552934 1.5838906340644441 1.7413262854312024 -3.6050743910978502 -0.45822636650669313 -0.024506892884537751 1.8181083438003773 -1.0924890920847052 0.66731398211459902 -1.7560057532791409 0.079347446050878845 1.8723527608022761 -0.085159795649522835;-2.1495864767452573 -0.19229983355589611 0.69929314944630294 0.86789972885669486 0.78157661279222646 0.6475302821747293 1.3614215868761033 -0.082132288229501804 0.028199808763716534 1.3081009998113091 -3.3936160611155319 0.22811025909568977 -1.5644661239490305;-5.9680711512631763 -0.9100333412043663 -0.40208100143068271 -0.13203030905872162 -0.15742993041871839 -0.40321313376197732 2.5509501151586562 -1.5693775957374458 0.99047898888451524 -0.225979136333396 2.1893055865343474 -1.6320430197132603 0.49627269369026139;-1.5135184221069227 0.021464659758227325 -0.50882312362737769 0.85044189778862866 -1.4077169337124853 -2.6401080044102425 -0.67013410352485592 -1.2153650235184632 -0.51910224209953548 -0.69820926266786232 1.5380380139392784 0.038904116431193472 0.43861860019765553;-0.080909370166984254 0.2018314011068596 0.23293592893856013 0.12034448720992083 -0.054377237946524007 0.63078982863905664 -0.68284342182441971 -0.34615386534154774 0.39679903277665368 -0.71546392400724335 -0.23079442256638255 0.16599406030834224 0.080752641376916401;0.12277332207349531 -2.5015586253267412 -1.4256784844589272 3.7463964536494512 1.788818389894794 -1.2438718656114509 3.3043263040988036 -0.32716801154793101 -1.1289985871887853 0.29273278414154558 0.33038316261267486 1.7009062581491403 -1.0529414569028885;0.3316661681977508 0.12179922490484285 0.37065767949204809 -0.72054022313242228 -1.6981450370339786 -0.30261831669876532 -2.222992592970678 0.083609527360205715 0.81216328152888484 0.046743598072268466 -0.74145749980366693 0.77147840391542066 -0.45639869977001696;-0.16251186359544159 0.13967975159808435 1.1060595332238268 0.37250873716038491 0.68533870174423539 0.046243635191800338 0.16334921387636986 0.15719938183908552 0.48239223876599957 0.673336720536305 -0.35184048776691695 0.34608048873687941 0.36042290470361593];

% Layer 2
b2 = [2.116052826723156;1.6426229407810902;1.4580562897511653;-0.90064777238322469;-1.0746234334840765;-1.2508704423835904;0.53305914045708758;-0.9998114777299687;1.2627718158599568;-2.5379866032192937;1.3149360756703274];
LW2_1 = [-0.12841560055557583 1.0317959050997365 0.12668443760102255 -0.13026349048467001 -0.26994284964674836 -1.2432431295190418 -0.22209991519750427 -0.0029038195484906749 0.055058638182366358 0.3818713472728833 0.43916540348421679;-0.24025703741271931 -0.59633813319481399 -0.44593314814150098 1.263685846826696 -2.4583475504174257 0.83316561011682899 -0.32616513655879154 -0.62583196071846692 0.87998188781315556 -1.1913456677826646 -0.45442903386785566;0.044105523647518727 0.55804468879632441 -0.11097367197619197 -0.2446645062440459 -0.27803644155730339 0.36893572907572308 0.23582378553708297 0.61007567868862922 -0.012950452398202162 -0.37304133312999077 0.12388714296687808;0.49926655000432291 -0.44988568331714213 0.12406994118426751 -0.32829758027113909 0.38983219379099837 -0.32879183043846094 0.14397824962105013 -0.57517947451214868 0.010616685801084567 2.1424409654731851 0.86264829742550853;0.048395080159337606 -0.86991601471645341 0.13479420721383845 1.0659431474904297 1.184321719033582 -1.0039251170964505 -0.82551362347044832 0.97562935892079872 0.62137122257253041 1.014376340068087 0.64222843069961577;-1.4407458822774737 -0.89401185002111683 -0.42885283856560202 0.2680070803870731 -2.308929509521751 -2.2227224094864853 1.7504693130239015 1.6925390758410093 0.30200169519679743 -1.9853158002482261 1.7509828373650644;0.41008384297826717 -0.031908345252090978 -0.020031045676366641 -0.26527281050286489 0.56644731019134564 1.2536468861206134 0.39193963970449081 -1.1045674642196019 -0.014333393453222057 -1.1469475153512156 -0.68210076715824619;-0.41661916619519135 -1.0274493511780849 0.83768745323433091 -0.16335627749057557 0.45770715576510357 -0.53337757435463895 -0.17271904613321284 0.35685139716423692 0.048053663178144551 -0.30528271499149084 1.1264639574868676;0.8778175917147798 -0.19991435978828073 -0.20315293498392992 0.71495320899321813 1.1053624426765711 -0.62720281049352322 0.38107984235875303 0.012625346902517078 0.27533015955217333 0.8242529363723663 0.46845450166225144;-1.3973624097473825 -0.59627303543923749 0.19149690129181668 -0.058210065192484034 -2.1402649233082105 -1.5945497031158837 0.98409256288279701 0.88265442005144235 0.34637898058634742 -1.1930182508955764 1.1456358158825866;2.6506634087311847 3.704709969896645 -3.1369760892314353 4.1976948318522975 4.295313570362512 -4.4591290061613051 3.6992817540758409 -2.9563065927121177 5.0863364146285344 4.5924097262021428 -2.9869651619373161];

% Layer 3
b3 = 1.2612969352306576;
LW3_2 = [0.87907558924476092 -0.18469158463978308 0.5678563626155595 -0.18716222927443202 0.47270945632224315 1.2327089380056284 -0.12569505917437221 0.40080860857916939 0.08730041484254078 -1.5668523348420653 -2.8685924542093417];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
