function [Y,Xf,Af] = COSantaFe24(X,~,~)
%COSANTAFE24 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:11.
% 
% [Y] = COSantaFe24(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;0.448430493273543;166.666666666667;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.767231370592423;-1.8182884514081425;1.2981223351094735;-1.3736096652455447;-0.83657961311602602;-0.24032611780267835;0.56417401292286518;1.194078957602368;-0.78254460868748299;0.81611546742833352;-0.83577941487991925;-1.2573355152819603;-0.72060896711132194;1.204144673314979];
IW1_1 = [0.15554660559067421 0.0111067631325577 0.87925462389231734 -0.30858348869763208 -0.7301749005125201 -0.24430318696698164 -0.68220201812983072 0.21946553470402766 -0.57560214099825779 0.38224084531303643 -0.78083901162463776 -0.27515902401324094;-0.58172390078038438 1.1478572959442972 -0.38572864196431311 0.85614312597326259 -0.26451598013403532 -0.064701573590499467 0.29644705270547128 -0.37552700967490543 -0.04364260077231942 -0.97657877087284239 0.18011997651697145 -0.53258242444351422;-0.43522532968710193 -0.79384598141851503 -0.24851811608047694 0.52335261409725387 0.14435345509099839 0.27571939617294583 -0.35826043946836528 0.18367347814275831 0.21679050892045218 1.117235212573116 -0.15641316181390993 -0.040577012983792883;-0.089861341321167618 -2.8131521884018511 0.31960819975129456 0.54847768912073991 -0.65491321479363773 -0.50871594368152151 -0.37827887525908455 -0.072731780045633326 0.36383858828358068 -0.021318557240760021 0.13811845445348739 0.16263687806726163;0.2663200456594253 -0.020505699614528604 -0.56378532985833163 0.31472237261256825 -0.025041652469966303 0.22959525940065895 0.080247665927805995 0.6674331897023571 0.013719926696951551 0.43349339935489495 -0.20153109843595687 0.51455907885732033;1.2944083026373774 0.28026155491234339 0.44074642473645731 -0.23573990571583228 1.3239071117293173 0.4858119539873535 -0.24901939646089102 -0.15279416896472547 -0.059368277870301453 -0.20904556026131316 -0.28005353807290101 -0.77783946236086399;-1.3684721596867131 -0.030274028739662451 0.020714470441282922 1.1120134668322474 0.12379372046671254 0.66050442016723321 -0.25169934613691125 0.40892468403747639 -0.34922299386834166 1.192740638763875 -0.15655816977295101 1.6113256369265665;1.8086447122219098 0.95555176335448155 -0.2597090530245792 0.36077464295535389 -1.1430871714259672 -0.47410241093553457 -0.61924040060577357 -0.056536688706582988 1.9481054385816148 0.58920272219984759 0.52496505796884085 -0.49377335151934626;-0.24253699554611774 0.80161007420561448 -0.32106804492123048 0.76956720413402557 -0.25642829607917023 -0.17707298395446217 -0.6983500180808444 -0.16421379060509952 -0.19125110047874486 -0.57624607707637343 0.056606784354683796 0.28025926730015605;-0.2982856364536639 1.5466620749891071 -0.40057265304690609 0.96650174828077096 0.29845306814240147 0.31507593099448089 -1.237915867576044 -0.25333978328154055 0.2940753365826233 2.0939582507604708 0.0023966781371169291 -0.65085903131323963;-1.329640120521647 0.95352920641809902 -0.52631898769636454 0.82279318124982515 -0.36681852798474396 0.065904787110345073 -0.23574952646020889 -0.53082028871291009 -0.49053797485569806 -0.87122208245420374 -0.14944520991220453 -0.37583275043967845;-0.54569858855031828 -2.2046116460635967 -0.20999865867313838 0.23825640998198894 0.32992254806990801 0.28875386164196531 -0.3866448205127696 -0.33428620302326195 -0.1967435131204765 -0.55569504606147013 -0.09600295951990713 0.05660066282545792;-0.79690680674018977 0.76041494586041491 -0.64714706820981382 -0.067229507342916522 -0.59895506636850138 -0.42212733643192119 1.2197096154967428 -0.20021767257980722 0.036856242176413798 0.45479004090222708 0.18154943259905795 -0.36628197712120936;0.57083799529603718 -0.63603362034043132 -0.37253744808826489 -0.35120648876152072 -0.54442932983178327 -0.5753815104259048 0.75069524811273536 -0.62082528855129837 1.0931388693352748 -0.86245087562399314 0.2453372477961597 -0.25385868478021617];

% Layer 2
b2 = [-1.8804717004590425;1.1724931956595828;-0.94902153729315231;1.0395171916682138;0.95590367549651822;0.8099433947719844;-0.67861603439318496;-0.20087276353436043;-0.26678089582645309;0.47653407891350669;-0.71221485526642447;-1.7813736281118664;-1.3857724480852824;1.755974092300951];
LW2_1 = [-0.016946876882633102 -0.35352459496053901 -0.61838066558493487 -0.30156423369159208 -0.29212220739108352 -0.16321296250948322 -0.027063544345900459 0.720991738568173 0.58808976449025874 1.1398654425963002 -0.37686207507741232 1.7858894252973374 -0.012129624395794627 0.070479674948350141;-0.76541544953911844 0.29993449523409987 -0.056467701908087586 -0.25765789206315881 -0.48865940425511489 0.017180787757836116 0.20838769846026872 -0.3986990151939705 -0.070546743153316133 0.51668967863702941 -0.19275795280567931 -0.47626367900543221 -0.18786548145515167 -0.078125907807063119;0.38632689661632991 0.84705828509602255 -0.96980882512052147 -1.1525991617364848 0.42358554658468833 -0.82377838306900952 0.23779609655260428 -0.46108745659443512 0.13500308531906466 0.92602683197180102 0.1193417083748116 -1.179143320553643 -0.89264959900520624 0.5966197395832834;-0.6792106943210281 0.3155095987565405 0.76894093561808807 -0.69945587713922053 -0.27103292077344743 -0.36009758873883951 1.720627229137881 -0.16167666087206456 -0.72075638765110606 1.3909441169480936 0.15363683122012609 0.013707233194810469 -0.14456411648450809 -0.53478737665257337;-0.094921363777566034 -0.66947839958830169 0.89920231383905935 0.67788609776528652 -0.29083547142754079 -0.61499163145617075 0.42730340113113624 0.60848109785666693 0.20563844248801019 -0.07514754864749304 0.64446264060780034 -0.22927103198185192 0.69998205512274281 0.2133834382554366;0.32245785860211029 -0.36374026612801724 0.25942374905378585 -0.92979931844456953 -0.27664944673918201 0.13589854981172636 -0.033690359773133678 0.08102201003983954 0.94048503177908427 -0.23369780056233058 -0.56471187903274533 0.51076369500920293 -1.6912606763596734 0.67768213777057751;-1.2314272945794205 1.0324330924629086 -1.3406224401505804 0.43492018554364686 0.57435698054471229 -0.6255676472758448 -0.98592675190258228 -0.14139731715511755 0.31298532432415538 -1.1776179949556784 -0.029512335271043952 0.064948422922958882 -0.90117841274219879 -0.14286952806284769;-0.53647295754628532 0.20350134610494522 0.067699191679879908 -0.25221399055418159 0.5982743209341681 0.2530235374494777 1.1435632790585484 -0.30504314056435133 -1.0237309034657998 0.71722435372332127 -0.87891544099662189 -0.58348755929857765 -0.25797959994930847 -0.46770282026414867;-0.52622072076479387 -0.52130226670732627 -0.89672970954495956 0.65812050181587178 -0.41836755091118699 0.19471431930821492 0.36654040340524607 0.037608065752581465 0.11595497888746764 0.89446632413749894 -0.72430569113088428 -0.1114507978796319 1.0760922001743864 -1.0620128710740504;0.20081650761808975 -1.4761259769679831 -0.29208715336447721 -0.15432620732813671 0.60769202942419398 -0.088336429023125912 -0.31742868445878952 -0.74933912789488466 0.86917240337209856 0.41447578679222385 -0.49692748193794345 -0.69231173391987699 -0.098963181740869793 -0.10423651597081797;-0.019182389553986382 0.49858852455328895 0.042867157551200359 -1.1174910151166784 -0.96358064743365113 -0.47959315828914095 -0.15897620326558976 -0.16013715725836472 0.72691090693828986 0.53104830692322447 -0.3537303497076042 -0.89037136402657135 -0.29115565391705805 -0.77102157510565505;-1.3416755776317537 -0.29621231815045718 0.55604785051041494 0.63741902070510859 0.64132381954513284 -0.76447518347397114 -1.2924312961799 -0.13091988239485997 0.065027491258675074 0.49544816308987516 0.61810111050819427 -0.92723337510313453 -0.14588200344572255 -0.10349900106747545;-0.064370436187182287 0.2847824562758689 -0.63902636837729798 0.11228962406771974 -0.2205166016525984 0.91025358686868096 0.35667281744633006 0.22645057902660229 -0.34308776226769677 -0.8243191930023549 0.66248134724905006 0.1124313680983082 -0.0043370335110069708 -0.37199773282689941;0.7842474863983343 0.4595104751590785 0.6540356193537229 -0.67264542900452395 0.32270886580058622 0.26202316754072119 0.41550628138605045 -0.25869501477667317 0.35954452573623796 0.54470588444241952 -0.25150116042842197 -0.40598635136298444 -0.17303616796517268 0.64946713654160959];

% Layer 3
b3 = 0.13987441652186725;
LW3_2 = [1.0498342256395892 -0.87679864024531273 -1.0132570913294021 0.19157064892136533 0.1579101245062168 -1.0324842129838665 -0.96252062492358181 0.35970791109756611 -1.1284394987679383 0.64810571036743436 1.4169495440222877 -0.86674956809326176 0.97247883697121507 -0.69894238208983583];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
