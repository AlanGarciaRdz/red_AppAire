function [Y,Xf,Af] = O3atemajac1(X,~,~)
%O3ATEMAJAC1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:35.
% 
% [Y] = O3atemajac1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.201288244766506;4.04040404040404;166.666666666667;0.0561797752808989;0.00614628149969269;9.52380952380952];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.7275232133986593;0.1562886751328188;1.714821702056279;-1.4591416219613553;-1.8399259153854763;0.27196448678878643;-0.68974928186446127;1.2287235955941354;-0.51931530607747967;0.065289074638173378;1.7253309328562574;-1.05776668352376;-1.4899561530358363;1.8287054936096281];
  IW1_1 = [1.7549598508029591 0.26713802995037184 -0.49840978988810625 -0.16402795800630582 0.082988002203855118 -0.18611783240242538 0.17533968094731417 -1.2600187011170687;-0.89736969552515788 0.19914429998410058 1.1264953122895938 -0.89322423538840001 -0.17794626596777732 0.40572640330295229 0.1333601108271332 -1.4529295986799542;-0.17082224021121514 -0.088823225217000243 -0.029631869238278961 0.13118453778794695 -0.025936539794114505 -0.035246075597078978 -0.052651358095864617 1.392257088956089;1.5301808959663079 0.16361765207680704 -0.29406387138799639 -0.2723988636685522 0.10679679263738795 0.0021359567941227741 0.16937943708929157 -0.77365305916153304;1.3230714106216352 -0.92875551482859797 -0.63666441672143459 -0.25007498503983627 0.1519583771679506 0.61436198571742839 -0.24376009039645913 -1.4144152809942458;1.9570351927702514 -0.60788875733457248 -1.1530351695626002 0.187001298837604 0.071944303236252852 0.13455317056914309 0.10335791804506607 1.5977593180131788;0.88118737516523238 -0.44420116203072818 0.35156122816266522 0.10657311344730588 0.070999203014508863 0.50691482232443663 1.0251029774313543 0.65325140969499296;1.2319601737140504 -0.08440055215912641 -0.33098334869089396 0.26090407013789296 0.056965705958846133 -0.91722718235587708 -0.56959045489100868 -1.3841538985822026;-0.085613830997222612 -2.105309906708174 -0.57765311945346742 1.312412271118665 0.34970909916608656 0.058360668492960829 0.26946668562601023 -1.0930712488910566;1.8969587611842522 0.21792587774064098 1.1309577076565618 0.40895511774680221 0.12064003081675355 -0.043775566612967373 -0.19807630262274928 -1.1195269720913126;3.1943464379261552 0.14430855634913387 0.66587375231669865 -0.36340033310133096 0.23928907841884606 0.31972023654473086 -0.077592901141380816 -0.40144395993837984;-2.4297767728732365 -0.17404004383849794 -1.2929073543415246 -0.1998713090345095 -0.13676193561067132 -0.1557820081960947 0.041783282131359241 0.34712650099286574;-0.4697113821682522 0.98502705774008303 -0.56931590843980173 0.83195158776882394 0.13487770777947586 -0.066212823720517788 -0.28573395687492259 0.26893817593362895;1.1607950364068895 0.3058150405415001 0.15911219033629487 -0.23226315723529947 -0.2201240757678232 -0.058261900645312031 0.59122547493636546 -1.4292571975247494];
  
  % Layer 2
  b2 = [-2.1346820158259767;1.5866948197593782;-0.70474118939340313;1.3712291622365171;-1.0952870718797971;0.080710296567908679;-0.23939481497042348;0.077853073257818331;1.2605476963177595;0.45938369664219381;-1.5643058246737904;1.4599149845359174;-1.8438608025471912;-1.7441722175857797];
  LW2_1 = [0.097520896749000066 -0.60014683554494441 0.13386298923140993 1.0638674271516868 -0.08259712975846667 0.8491220925593217 -0.42827198138788636 1.0511905249302302 -0.34582898915490751 -0.57519765373156773 -0.035327396830184085 1.38885941975466 -0.026330472373359504 -0.47491267187279879;0.61257305629587855 -0.058804837436738117 -0.1213720708303424 -1.2620402195760578 -0.14944294232702354 -0.75105466622839068 0.2438370180702088 0.38419488849389144 0.37399887766800349 0.87621348498981211 0.10635625306684721 -0.053235408510917556 0.69835397020882628 0.28193976529827525;-1.0877565733343308 -0.88181523959242758 -1.0125151435819595 0.063865874599369502 0.11252006493514898 -0.76993747879495045 0.47716728779292106 -0.35774399364588827 -0.50758507765819283 0.43176535720913828 -1.1983946676651613 0.80007833351218061 0.13016474588545734 0.89656370772065197;-0.33249341591250359 0.50401521907878843 -0.69870750163316309 -1.1892291178960543 0.46198093445277721 -1.787409939568017 1.2451173040303742 -0.50940117198317547 0.40894696487813947 0.51596335658671932 0.68679158320833045 -2.0914837287433459 -0.057200689266623757 0.71192693337274338;0.077628999710821156 0.90996912969294275 0.58096305069407217 1.3778284498548403 -0.46834543942972423 -0.10467164486510051 -0.61107130794010023 0.88368308944752116 -0.75698163170457933 -0.51179089063468475 -0.24922206106416486 -0.29813547221904474 0.56915030039737058 -0.37206072436654319;0.80267003564879236 -0.99495328217230661 0.69312991089772646 1.0149250599491066 0.9676595437757266 -0.94705287368799318 0.50703870041124788 0.50317624742988964 -0.47476697256203265 -1.0938840917337982 0.011798249046276198 -1.2173092220516657 -0.44893674819334656 0.57814755002894669;-0.2775608657397749 0.86121813879151354 0.74494142061511348 -1.0455091682919624 -0.076288849731640559 -0.11539572669456734 -0.55151803791728293 -0.091970298835247113 -0.12471447976111694 -0.93704621326755366 -0.85980593965382668 -2.1172648230447297 -0.91672473125320186 -0.82811018305313833;0.17404785481438725 -0.012287992071183619 1.0367018240545731 -0.20402762774644617 0.15897545917456718 -0.3276758022115277 -1.1620422527199177 -0.35512267079548798 -0.16809250298753659 -0.29196283553281771 -0.97630127759755236 0.31015976258779621 0.26760738948145002 -0.18318940908398004;0.76712233325304191 -1.0157573604110421 -1.4372323314948592 0.038929003320561734 0.39170382150248428 -0.48514569844772382 0.84915840303465939 -0.36363889419710504 0.22590064199360294 -0.17099436799619916 -1.3926425646192551 -0.65898076597135413 -0.24348467303791288 0.53420782291767244;0.22157959788284642 -0.07645192053891077 -1.0766758268937167 -0.90296806021769216 -0.31522094262230721 0.11015267589813268 -0.15321425407030848 -1.0884488470124265 0.31509883313279219 0.9995422430797597 -0.40504120493351808 1.0494986543520604 0.19646757536969131 1.178641110371869;0.12417600904875682 -0.55256119755515598 -0.15463976048309674 -0.49166145594054422 0.62174180449138228 -0.015752737377072935 -0.20123298261160516 -0.97776936636563783 0.6244844503364233 -1.8271979744465114 -0.059040009993009623 -0.73858479187776127 0.14906454469333641 -0.368548580346309;0.01183862724149775 -1.3365482934216411 -0.10771355334750116 0.5723553794860593 0.1668708256298235 0.6698838151262323 0.44952415557128239 -0.47923161617749199 -0.094589076808865469 -0.49325963736719658 -0.13101923722455733 0.030938755816813549 0.41413738193568533 0.6016066106649266;0.10113415805240682 1.2333858494523431 0.30567582964203699 -0.40614090716372303 0.10899505795827547 0.132035020361738 -0.8853200193301165 0.13361119625110324 -0.052498310422751771 -0.1433012987696119 0.18479961099747888 0.55546919637778691 -0.18989710620410991 -0.48166535994725218;-0.57143070355931858 0.41142251197700141 0.15836303831496168 0.80227759955350075 1.383442546447351 0.99872799748242913 -0.013035321002163081 -1.2760020022650245 0.23780106556359726 -0.051806748526716739 1.0382361657437289 1.483273289588654 0.38303158460157399 0.73210112798879168];
  
  % Layer 3
  b3 = -0.7173342445732741;
  LW3_2 = [-2.8194617761488141 -0.98475109822832441 0.42661122009189778 -0.49170413885027814 -0.33836336488564234 -0.63504870359598431 -0.89149349545946999 0.57195813428608311 -0.56625452983152202 -1.327792874763543 1.7893312029486277 -0.53456503315992121 -0.69138856522318526 -0.21638780028227234];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 9.52380952380952;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
