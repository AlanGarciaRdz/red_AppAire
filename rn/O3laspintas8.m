function [Y,Xf,Af] = O3laspintas8(X,~,~)
%O3LASPINTAS8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:47.
% 
% [Y] = O3laspintas8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.241545893719807;4.5045045045045;0.00280033604032484;95.2380952380952;0.212765957446809;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.8334594019995898;2.6923666497523744;-0.5320996825917117;-0.65200380967975691;-3.6596224344577468;1.2584505254940332;0.20216487292875407;-0.47354424639417847;-1.2853028251081633;-0.14084944888982326;0.41510589552942295;1.4565547532420684;-1.5363730842410952];
  IW1_1 = [-2.4254660938527333 0.065431435334877344 -0.70904105289993813 3.6157446797847719 -1.0240758482452303 1.2314509517167012 -0.219531350334674 -0.9715065409730741;-0.94346111825924084 -0.38919030995086157 -0.78550078882513275 -0.023179528300273693 0.19544620827952008 1.2675070714992838 -0.71850783774760008 2.3074810925321634;0.38170164036065651 1.6934979421227643 0.86953331372140297 0.75361289674739973 1.7315617242877654 -1.7732117663775198 -1.5636661431343437 1.2991841068485996;0.65354959488238251 -2.3830997360505046 -1.0176764528746061 0.072951083135304295 0.68380691648590797 0.23296319942340515 0.095142743683286998 0.77956472319665793;1.4061923970072943 4.1607490728881773 -1.1457038793875483 -1.2733407939774524 -1.3710407195019341 -1.2284020989287572 -0.78312029367457003 -1.6786399989886647;0.92901958652055772 -1.6193482703456556 -0.47057443164735674 0.13152111358610435 -0.66479948800021438 2.5486191270108574 0.019136227074740469 -1.0847350035841636;1.7666028314562985 -0.523936973873534 -1.3022372582930453 1.7141532191537023 -0.97645741878571823 -0.33616138303429521 -0.079436615463366556 -0.25454900684449772;3.996777419498021 0.020651977411582492 -0.60222557473070182 0.37815634491034622 0.17323588993334968 0.029304210092942533 0.023586388478593175 -0.47363041425556895;-2.7421650874626931 -0.01179951066149729 0.39834047118609378 -0.44873477473228085 -0.38988883836399835 0.53660118423220937 -0.058636751276360533 0.43388679595558954;-0.44741894611195365 1.1123684919197367 1.271703611022754 -5.8276929296271991 1.5542268274817059 1.9786216203775919 0.46576839232930628 0.95957347470078236;-1.0056293279192199 1.8907841766087852 -2.6259712164256439 1.5187717959445732 -0.21237230695831058 -0.19353371510822392 0.10645685710011563 0.85219290231391587;1.3856569776037126 -1.1427629050221011 1.0114785357389586 -1.1379515616304123 0.57562535194022735 0.19321062528253183 0.096500242793340255 0.77434915428197237;-0.099439136163072483 0.7286699810399162 0.50948349918917601 -0.0062123073283652727 0.0060524509461758712 -1.343933191023835 0.14190340003339202 0.59508638123589375];
  
  % Layer 2
  b2 = [0.49303899445625843;-2.5312004770481678;1.5843271134930257;3.2614145278361151;-1.7573222096298307;-0.086206754602721453;-1.7653504657612542;2.4773534104794925;0.18133135741181033;2.570678979948926;2.9792951909781169;-1.1936842716003537;1.4957227116928189];
  LW2_1 = [-1.2387742637196735 -0.11254656102553047 0.5121899636638394 -1.3524359389413327 -0.56937416015324804 0.8757950313630084 -0.77913698053545388 1.101978106848744 -0.91983258386579547 0.30606116566335251 -0.45439737548818093 -2.7755404991417763 1.4478785074751899;0.89769220720880294 0.11821805843526692 0.31152425483669249 -0.48761385379834332 -0.10007238994283602 -0.0092838129328799424 0.60052678066130771 -2.0422149013892912 -1.5038666507767449 0.28924563429301792 0.34385851865347461 0.84847976990885299 0.098064413890021365;-1.9336161033314898 0.07557086568274779 0.14663124108447884 -2.0264205551261933 -2.1099464773596734 0.45064608240920351 -1.4324984495814421 1.298071175321474 -0.11204482984124875 -0.5781148226995223 0.82696629238156083 -0.60100463380047231 -2.2416420288489984;-0.98971348751805932 -0.6806948680565964 0.6130866879887279 -1.2939661854626747 -0.5416335565287993 0.88306030017500314 -0.03834082972637981 0.78525822725774586 1.2702470647760842 -0.16965317724042087 -0.44960993914932001 -0.21978053774673356 -0.035072845684577636;1.9395307365903716 1.9391373100624651 -0.7062274491128655 -0.43182064998448122 0.071673910050048667 -1.1565189794851825 0.55779962102973102 -0.49554619939785105 0.4789640458857421 0.21821941868801117 0.11014655635924187 -0.73841584027971185 2.8428887796522435;0.068145468160334982 -0.24682283921500542 -1.1311479434916427 1.1597768736945373 -0.20878979092627231 -0.086785208863325691 -0.23739352509581535 -0.97642578832150684 1.1383748800511173 -0.33464245713446217 0.21736650423750853 1.1219548925989735 -0.39883894905228046;0.75643877496406264 0.41111632978734824 0.23755860136031734 -0.26777197957249133 -0.019548377981548692 -0.16052818535287292 -0.11191615535340965 -0.87521315468254812 1.3345575017072984 -0.19532873851439386 0.14375211981942115 0.19727872367754307 0.23865371518763001;0.59265863877047908 1.4072420610313292 3.0296602579303906 -1.5048238913729532 -1.5768614015028342 1.8400071275034016 -1.9898775907836397 4.7118086510155255 -1.9203971648463654 -0.13261189376994864 1.9858402931553174 -2.1624145462311422 -2.2022523714594766;-1.871540622128228 -2.951643808870251 -1.1317237805716389 0.59317446832196785 -0.12763314054574493 1.7564790718584617 0.69683683518012485 -0.23566606603575802 -0.00042050121801300022 0.86644871752635122 0.077609354060438604 0.04859994035330515 -1.3190810716605506;-0.40766562913350779 -3.839746307948031 -1.1250532457762721 -0.1677291601018247 -0.47914859795075526 1.2525932718682407 0.59629200436256879 0.55076640362103768 1.0196656639571584 0.00899971111682938 -1.1140047669456936 0.30609162432639114 -3.3027834141521311;0.50217729581014958 -1.4621276029509356 -1.5132629847044892 0.63819811880795174 1.2235054073684641 0.06489466546916231 -0.44904836525516584 0.17698185802726094 -3.2702317656674307 0.91242576265485897 0.11813646823359517 -2.5585837620286753 -0.79625169198444568;-0.078668031409344252 0.24721080863281847 1.2950311331930591 -1.3530603367284619 0.23986623977962393 -0.38880601455525465 0.5493282124552743 1.2677281759879269 -1.2970715123796019 0.35127048364270896 -0.22602909030547091 -1.2943238838381697 -1.0406390762590516;1.0119631540468439 0.108802608605329 0.31659707463401454 -0.07540553570735152 0.22284368797296847 -0.036723460768704752 0.17835660701800557 -1.4175349391690728 2.0884517672038405 0.17690355361366125 0.24057321488609032 0.70862581600283092 0.21213926092774288];
  
  % Layer 3
  b3 = -0.11868746886680705;
  LW3_2 = [-0.19433780607442092 1.4041197825704455 2.7213004586676264 -2.7013683568124329 -0.59631595928334669 -2.2394887300329382 1.7676428995121627 -0.27111691372010827 -0.27800678362783043 0.25667967595903851 0.53199083193083696 -1.9878098968123621 -1.4495145101401368];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
