function [Y,Xf,Af] = COOblatos23(X,~,~)
%COOBLATOS23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:57.
% 
% [Y] = COOblatos23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.3314818200927905;1.3328941633849636;-1.3041984553066901;1.3208724425415812;-1.724135122785222;-0.96819135422305658;0.7363235680289113;0.40845839228504138;0.7434143372117813;-1.2777420835036613;0.4725794742688022;-2.2003776784704443;-0.011562947069605312;-5.1845307870695176];
IW1_1 = [0.37278634283671863 3.5563802075187723 1.0170137495018785 0.054003414216962933 0.19385241676447437 0.61262806220720667 0.40567988766175939 -1.4950842931577708 -0.22206358741592286 -1.1017886521569089;-1.3159413533526672 -0.32060410020959645 -0.29765255298171478 0.53322828133441491 -1.216782340047498 -1.5917102314802887 -0.33658984041530016 2.5551417212346363 -0.17134309854944646 -0.46520780936274397;0.10729769921591119 2.3886413143560978 -0.36963677961883945 -0.15895362973165522 -0.84348018476045816 0.22962933402986521 -0.36792812211342224 0.23451433503438446 0.1049894128386369 0.46956279888966956;-0.51007673098372242 1.1792998578848648 0.90882149687687841 -1.8105649832908974 -1.9864450199689103 -0.19622034516778689 -0.79910265429109373 3.5488356642106456 0.30097737705574207 1.233881604356122;0.92763535191200353 0.25331443962010686 0.011740923894610303 -0.3861959942530992 0.72772516454408043 -1.7120164056156866 0.38465560146308958 -0.20767835155769093 0.014816807036507677 -0.691106215729409;0.093586057048690441 -0.25663299277607898 0.38559907313635666 -0.38794547802269347 0.08106347579567233 1.6342990062231078 -0.52277550184105315 2.6569472994062808 -0.015551492834939003 0.057107666567005298;-0.041699244971066578 0.32894182103898462 0.89163544142847151 0.26767647876569906 -1.196552456662402 -0.37847482259600679 -0.028264995982408659 0.71797000708287217 0.094008000999641197 0.00068019200954750822;0.037973708155006447 3.5810888513659185 -0.65171455691833124 0.10072864150263253 0.48792766219007022 -0.050171560003911882 -0.007511032260103627 -0.63670928094654577 -0.056721080618060818 0.28428591707171808;0.72421978767856099 -2.4496273116218044 0.73666541728658552 -0.44333069658314644 0.24017315847606319 0.17526143065220642 0.11614754582691228 -0.22811597947244111 0.072315323520681971 -0.64378569418213738;-0.36887369857800145 -0.0069135862466890591 0.12123653662622851 0.31832562206443615 1.1874250355038791 0.8522649146282516 -0.3389767489603947 0.2946845599338408 0.42742271357694467 -0.43860103745090978;1.08660045453431 0.058567761021967611 0.81810378644108861 0.8665514478521521 -1.4135977993268394 0.36424880423302547 0.72512983893805216 -0.89996833076404115 -0.42530594014553358 -0.10528077133909347;-1.5240223569587414 -0.45261511023955919 -1.673183378998836 0.07563083715941879 0.66196753788899132 0.85133264421552846 0.45332273689858454 0.058609833218436318 -0.17774711970455909 -0.18772369021146879;0.51942002936609943 -0.31310022376841268 0.49611926338681317 -0.56168057881115152 -1.3284901597369732 -1.2516874439544088 -1.1163457358433269 1.4098282583310684 -0.054421821565401041 1.6475136433911539;-5.9286051293437456 0.098627375963728003 -0.022011398953558983 -0.070131018145051113 -0.15374838914487185 -1.0116730089658965 -0.94665606420327864 -2.7894027670983261 0.32541242756720268 -0.095080738476546786];

% Layer 2
b2 = [2.133947480540431;1.8930030630369863;0.43179459124354702;0.43481513437412633;0.079529148580410922;1.2109366986773196;0.56951693765298605;-1.3805140719847746;-0.25225220082189836;0.28142376652863954;0.68798278667814017;1.0876785211613276;0.91734063222081086;-2.8097367606092791];
LW2_1 = [-0.29979547755654834 -0.41945412218802891 1.0131265148064843 0.46079963327129314 -0.027443126976128569 0.10936508963546743 0.80961163928532631 0.6204451048246461 1.3041456140691465 0.97894041063794757 0.89853737636149866 -0.4702683573866554 -0.33570407491352061 1.2807229358675281;-0.16292855623773328 -0.95233043328324163 0.36645063476861256 -0.46268119975553967 0.77517620950788135 0.56388014603345149 0.20600111421340228 0.12478952162928043 1.1227615289557336 -0.96995730042205619 0.44411152973717788 -1.1964269401385015 -0.52642258941574971 0.44302348927647273;-0.82289236153873191 0.4750231583842936 0.9308950258468176 0.21905556981188426 -1.0165110947636873 -0.51402737070848614 -0.88657273449030272 -0.38353058350390168 1.4892889422131392 -0.86030567938553371 0.32838329721202969 -0.73335499079480637 -1.4589293216023071 -0.67228776717538474;0.1112566697971262 1.2831330630856599 0.45193685756603363 0.30681696317124196 -2.6173481902959912 -1.6407477412010802 0.38129061683283771 -0.64188176812720943 -0.24488786773296434 0.80725610140379356 -0.81912083634047073 1.2437309400543524 -0.16346314697513273 -0.3482112963178905;0.17826906957233146 -1.6105634283602157 -1.1137718828608565 1.238393987202544 0.83589820518410618 -0.25376580466671705 0.27122589683225323 -0.97823402023249861 -1.6824211187674092 -1.2089150758420442 -0.46201122694214602 2.1764572428801201 -0.47315376345685367 1.8307970161986558;0.59239221459988767 -0.16646185358552268 1.6357182764380387 -0.42077196491610713 -0.75176119119678131 0.036887048543801183 1.7974999738715305 -0.57329733435691033 2.0844569151521393 -0.14191465366329942 -0.59467418720790066 0.2844413976058412 -0.16870909886144952 -1.2974338809269055;-0.09034194628300149 -0.50906296597258494 0.3947421506628947 1.25210798316767 0.98202246225146284 0.64305775078588678 0.031411434233438965 0.28305963999427097 -0.70546490723297428 -0.651670482959534 0.32409823558659567 -0.78219822956651996 -0.44454547617734341 0.19294721883089308;1.5613753460009665 -0.4078639031526492 -1.4403934062719659 0.28417383728940004 0.45245818855400327 0.031759992818354246 -0.44588595539818704 -0.70590283954568744 -0.40093750063478029 -0.20981010162147332 -0.13592703524227781 0.093359913388426585 0.10101925116632542 -1.0933835008156791;0.24684053581655227 0.60979101690360027 -0.50101934657885461 0.053660310924157642 -0.23828408478188143 -0.069253235293059476 1.5715905838781292 0.89924522889569114 -0.12016434370038352 0.42566297190784896 -0.42705898311485052 0.78480512050283591 -0.020744353549079567 -0.5908834048148901;-0.42947703285674849 0.35868276014603417 0.89186067764155197 0.22862722388765991 -1.1369985775855698 -0.47557341277674214 0.37378262821753716 -0.18240088500905022 1.1765244590698694 -0.086102848820413191 0.38030467128192419 0.6191254260054524 -1.1189053876348503 -0.58104850311551182;-0.11369943342977834 0.05531232651893421 -2.0249040553232014 -1.077344072022985 2.4925699962164116 -0.082873201627050086 1.8320168124494691 1.1425452644934082 -0.04883892466714241 0.060195898609995968 0.53529111979343658 1.1307214806309789 -0.88866050186114265 0.8254255211310213;1.3455063074782219 0.40376062318517109 0.12837485095298254 0.52512846598787766 0.12180131224326764 0.39547582658868735 0.5043652725290394 1.5853556233574693 -0.011571411385672387 -0.29243063956196069 -0.097516028875458516 -0.36952060043012636 -0.27203258123503116 -0.14559429771640103;0.30490154123384872 1.5596156274911583 -0.64444328683252394 0.17071405140391854 -0.95129733756563561 -1.0997244944319722 0.97795163600957813 0.62312189838228504 -0.16071823641456692 -0.53007588677515283 -1.0717937191056701 0.19734897407507562 -0.41888701943636786 0.93963080993639425;-0.061136783033003406 0.36709864472963954 -0.063808054094101077 1.4527936494821629 -0.30073589766311537 0.20772917041487696 0.030179595748306472 -0.57105962681876976 0.95006477442671566 0.91791481079199411 0.46473923385078142 -1.8864531463124261 -0.37569126101077621 -1.8845345493073342];

% Layer 3
b3 = 0.68847968149480065;
LW3_2 = [0.87706128515967585 -0.97214121678460308 1.197522588703859 0.92103133522917524 0.56347674810251269 0.81629337595381379 -1.1010468288739099 1.5825510718537492 -0.46249094627821219 -1.4617060319597435 0.45054876713451142 1.3148939758621971 -0.72565873981185736 0.77473688188087053];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
