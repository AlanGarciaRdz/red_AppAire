function [Y,Xf,Af] = O3laspintas9(X,~,~)
%O3LASPINTAS9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:47.
% 
% [Y] = O3laspintas9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.241545893719807;4.5045045045045;0.00280033604032484;95.2380952380952;0.212765957446809;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [3.289258195206211;0.19744550798617619;-0.8239066400200008;1.1771519794996033;-0.90001257387782307;1.0611344288144628;-0.69320645047581853;-0.16974812739371403;1.0760389148396545;1.2599440319953743;-0.61726047977672494;2.2949434803250561;-1.9018598969767375;-1.0421252508050238;-2.8207128330824616];
  IW1_1 = [-1.3352623628182505 -1.8385892435633804 0.74036647131090749 0.32261591856221694 0.28380164536102692 1.1767410851846376 1.2135542801187715 1.3592617408366221;-0.37502592975876697 -0.26471430552967107 -0.28137179278512703 2.2748042350057025 -1.2206206566391786 -1.4342374540002987 0.098950461530693146 0.45092653551991752;-0.060891407130449896 -1.1795713931241023 -0.2230156935539821 1.4425865554631185 -0.16134853377100811 -0.84563796048367867 0.00063861146406693839 0.61565674196821352;0.50255183965676464 4.7540409084497961 0.19777857034224808 -1.1101345599203283 -0.53924960537152278 0.7570411995457641 -0.19626348266472221 0.66542127678669005;2.0375293801133534 0.15203598015268699 -1.5112974792433378 -0.90833213429319071 -2.5256856774473433 0.57057780320263207 1.4351826604485438 -0.33565929671798594;-1.17576208784077 -0.31368478126820121 0.7671565393597326 -1.785165627026936 1.3890189925769016 0.17933375931313533 -0.10235382279311264 0.70832663876339408;-3.5838961731590762 0.22084771930897765 0.45191131769848014 -1.4027141847506526 0.26457632254577412 0.67186685386086231 -0.33009644963949714 -0.79969759026138565;0.73433202547697274 0.48696452516061756 1.1544943909837129 0.55299926919114328 -0.52157237602908813 -1.8639062262229205 0.34657856158906181 0.2267134440857643;1.4270240506909466 -0.14864309696317898 0.85306729337857146 0.56003028844069169 -0.97484729174732077 -0.57711228196286346 0.063061714819669268 0.085974758863938447;-1.9010283127491054 -3.077778580769245 -0.97826441886986704 -0.80320491181366205 0.044204220198259259 2.0217946615508104 0.42993574089010622 -1.2149219348786398;-0.21342815003274473 -0.55061286773945428 -2.106631983280733 -0.97405285935259511 1.5501969778844888 -0.11101444939790395 0.62294587972861148 -1.4337238617369799;0.62103507210625208 1.4092482313505643 -0.14969646647109022 -1.3048354197853105 0.31948017162666714 -1.4490540527133995 0.69954356892132974 1.8505746808766825;-1.9278103232845387 -0.54437098011094465 0.052731787973938987 -0.35767074263917131 -1.4958279169811126 -0.74729782017419066 0.1150507275628857 -0.66590464308314501;0.26442692276365826 -0.40172224141713681 0.65455122283346723 -0.83081514290798231 -0.11813405053502601 -1.5280610616597641 0.60959605848169696 -0.31026921304717558;-0.84819130537584952 -0.47807129570344092 0.69054163524486623 -0.66802148491005886 -3.1176123230420396 0.61151605033893364 0.40179855253026703 0.13762779057189711];
  
  % Layer 2
  b2 = [1.6878669356680005;-2.1174664835445531;-0.44935910592423978;-1.7353506153463985;1.1206276608160914;0.77815875304737658;0.13852345836387098;-1.0283787798025283;-0.2829985603545937;-1.5467828104622756;-0.77662085288419735;0.28999086176803968;0.81617082484225012;1.2975277966197498;-2.4055700147436556];
  LW2_1 = [0.20878203171041157 -0.37467724840842898 0.24545975602898584 -0.51002974670146783 0.33577792984506954 -0.042462615442184035 -0.21709285957997823 1.0268433099005851 -0.5312061206148847 0.4287867538880436 0.33273989102446055 -0.42012466834521639 0.032389012853490474 -0.84523852587892923 0.29941252424666159;0.29983684369770669 1.5336721952705463 -0.18941919152399442 4.2661567714997926 -1.0730752940679997 -1.6968397441148055 1.3410531931150589 -2.1053345289104843 1.57768164118791 2.7355310816108704 -0.8589676503543674 -3.1394065191104454 -0.89174691750005208 1.3784088652156088 0.90214843915024057;-0.0053880221435253367 0.68302965192650089 -1.0847293453664832 0.044176256795276467 0.29367955143739422 0.35499714909154667 -0.9554294087158286 0.4987211126001414 0.095398329057531844 -0.92038506429436806 0.73378413852893454 0.23151837155579322 -0.49039891216227577 -0.25363756928464948 -0.20195123399856452;0.40850978028112267 -0.26079407860561765 -0.64814437332651287 0.49226030719222558 0.43049428681889462 -0.06312319417331444 -0.39456365662944171 0.15146244048064411 -0.23279481561310944 -0.27497923864840818 0.070451007034349658 -0.40676990429634502 0.15617128060732266 0.17554870860590013 0.15649010566756272;-0.31331968752468203 0.9250894389449853 0.74903617822394175 -0.56142864883855803 -1.0776654981430371 0.62314950763373356 0.027775558526160881 -0.089777805768357394 0.30361384829627097 1.1566945921992673 0.91044799651930775 -0.55655500410305381 -0.91172954610590229 0.13524719503158525 0.91486280562226829;0.12171244492337431 0.66837100143018802 -0.35367156538767247 0.28091258249770445 -0.16977666888838758 0.89230685425302148 0.45746306235101325 1.2155528601377852 -0.25209918374416884 -0.88685991191049485 0.53885083613542217 -0.81151508791418314 -0.29072110205421092 -0.79894103574502562 0.87778982089419721;0.06473484132516108 -0.42006822552935802 0.65637900868432575 0.39967636548177454 -0.30736907960025972 -0.52342194930177255 1.0830685244122711 -2.8650480066503685 0.55691660803890675 0.35678671453328437 -1.6665412491225731 -0.44800833616831059 -0.033083719894073424 1.520966598495795 0.73039020160156054;-0.10374162364636443 -0.42464371012171848 2.3019697592508885 2.9414233085994632 0.41954262052523966 -0.57084324698622957 0.39674947438151575 0.19108524078489145 -0.20469503507480558 0.97221883532531128 -0.43098821260265907 -1.3446538458647546 0.063441754577304138 0.13078768993526316 0.045797297811383766;1.0221916348595956 0.6746168544804324 -0.46955893832323303 1.7222797337093245 0.67966724217898644 0.96533769893473687 0.75362051209170478 1.8205236452957505 -1.2849746590219768 -0.89005244776898051 0.67654273833631073 -0.99721310495209292 0.3839068438650754 -0.77571519825422974 -0.56138797564124354;-0.045769477997806229 -0.72302227771609828 1.3083965882891579 0.091906296363294324 0.39227871542350973 -0.59269893658017825 -0.76922390972897614 0.45494550502724357 0.20896670352421978 1.6561202794752441 0.53661664122760055 1.3675067102488685 0.42912946582408429 -0.73666732662769585 -1.0753502510346586;0.58728227560034885 -0.94249868065332176 0.39773504001409182 -0.6792145847199994 0.96492068964021327 0.72109636607191807 -1.0015925259861473 0.50020244459107188 1.1985242220321872 0.24374627359754319 0.00017161788958150893 0.74349910023473054 0.52376797777797357 -0.85957230424706033 -1.6480719670744339;0.46001037887735863 -1.700545511008519 -1.1021043905141363 -0.49337572952957215 0.29520342685473339 0.23311293993177118 0.2226002048112197 0.94024879147830542 0.056456588718715381 -0.69564783089466886 1.8767383343067561 1.1869716899100176 0.010507703677191303 0.90808177169755766 -0.36923786867548236;-0.84542013687970019 -0.5825410178357816 0.19239872032044572 -0.52444744709308533 0.0010563098980110562 -0.12525238650769208 -1.0428168202399692 -0.62198702579679399 1.2775927488519478 -0.81081466710034278 0.19701508273143373 0.14650359544009381 -0.46606730005543623 0.52802509101721529 0.41592296169518667;0.30862379429777337 -0.080319212345775576 -0.71842043269611378 -0.48168915405744495 0.46088378304406263 0.020307828329097749 0.52587358663219308 0.36289353763683635 0.11580842316788356 0.49430607631477702 -0.5532263083823008 -0.38031022386384367 -0.026992873542805558 -0.41334493096390201 -0.0071936490381349274;-0.33319496625491507 0.67736884621277138 0.32031160750635657 1.1852962270359328 0.10934586753441783 0.45943751307736153 0.092688535059992361 0.27855217725867287 -0.21655132314460043 -0.085061293041076569 -0.53259507049214083 -1.5100489310232121 0.59236530517587127 0.65520205661829412 -1.3186317264158107];
  
  % Layer 3
  b3 = 0.52899508928075589;
  LW3_2 = [-1.7437117890591771 -0.35219272068503304 0.74595887601329824 1.265172819759889 0.56982618032032406 0.97057482789601002 0.52654333703798584 1.6728145570161326 -0.33248870103146416 0.72236048583392953 0.73661663354479001 -0.3047129688418137 -0.89698858181278263 0.57433017323937519 -1.8455670086324707];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
