function [Y,Xf,Af] = O3laspintas1(X,~,~)
%O3LASPINTAS1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:46.
% 
% [Y] = O3laspintas1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.241545893719807;4.5045045045045;0.00280033604032484;95.2380952380952;0.212765957446809;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.9795703709241845;2.1722463599366484;1.185591413172576;1.4903558294877646;0.45754101647830397;-1.5217187655637978;-0.21426624278494918;-0.36250164684536884;1.7345391344832159;-1.0986721135893422;3.6338603023298117];
  IW1_1 = [-0.75104360904961309 -0.94530124513954106 1.3469547225519154 -1.8308482774729871 -0.86347249181489782 -0.16164402037470985 0.24120328632266153 -0.48777085228965733;-3.7779158215395752 -0.10463289106753197 1.3786528697086056 -0.65868012590802871 -0.56920529331115621 -0.025967760292026108 0.42239562484297949 0.26441070870749045;0.94930983812618508 0.30026164650221349 -0.69517767115179341 -0.5706348919386115 0.11155414568066156 -0.90877518690163028 -0.097369817804764391 -0.10476722004057083;0.29546063968788178 0.87083037037304378 -1.3531166428861277 -0.25724213561820991 0.17155177725035586 1.0444686579700699 0.59833708294959176 -1.7404697602712238;-3.1761956896295254 -0.11712793537147605 0.71958328626982726 0.31059037939962131 -0.16513508996055762 -0.0086138086573245495 -0.16445011700807283 1.1521923993474272;-1.8486856802421376 1.6230176385269457 -0.8331932358170312 -0.4766713873979635 0.024098486334886295 -0.10188920280589381 -1.7581007830256816 -1.5403957895050533;0.082392831853108417 0.21395218383043996 0.71321443921070438 0.53560766985170261 0.22430645196563764 -0.014376192576842044 -0.69619743860416217 -2.3768728460813717;-0.026597463074965525 0.02107212159334719 0.01559497368589078 0.011428983116665691 -0.024287022959293286 0.0010245706567220719 -0.076881194027806687 -0.69367083340469171;-0.56606703095265265 2.5694808372486087 0.87481758122901954 -1.0813894730657998 0.85593101310894903 -0.59805066721933364 0.51275509357867977 1.1733249784839233;1.1080241445079508 1.5170278107666666 -1.6957084744434965 2.2868006335990483 1.2553710919600072 0.15067774766682793 -0.21499414018201482 1.9333886043278738;-0.89702180399404075 0.37709842112052139 1.6038105415068296 -0.14361233568095311 1.1012859251979914 -0.40292594292314282 3.0668266293120547 -1.2340515883358347];
  
  % Layer 2
  b2 = [-1.7606625417232502;-2.0840345786278518;0.26704549219376583;-0.2597770541463178;-0.80566670493416859;0.85314143275805887;0.0093466088972508632;-0.14381194867319377;-0.048493438177560633;1.2001729361232911;-2.3900358959499997];
  LW2_1 = [-0.13260203734356779 -2.4720751817637145 -0.19768883424558215 0.1682839105377639 -0.57980861992716648 -0.20508910698860439 0.17260170252811752 -0.10774836071052663 -0.40285920686461424 0.83324626595330686 0.40622375608735933;-0.26668875312035145 -0.37851971887454433 -0.38441061703424678 0.096901670350596797 -1.571177518236835 0.67348196562600215 0.080816817079243958 -0.28241633173093361 -0.26235471156700896 -0.46140425567164478 -0.049262955722295484;-1.0441013850459628 -0.1210977926834144 -0.51369812103253687 0.70184031906449507 0.85617344428137332 -0.81308113748478594 -0.75036292244279656 2.2692362369461616 0.1214439944259031 -0.24631961583708836 0.47018244417155686;1.4697510523312909 0.59711967051904791 1.0020628831321512 0.47678679427248932 0.9677367751958692 0.63633731035754559 -1.1622475720890164 -0.55998079499033282 -0.89046381287923337 0.15210672328066102 -0.15889176723026466;-0.13916852478921013 -0.0089824568362397196 -0.98167851885396806 0.01514114995575171 -0.3383441266530508 0.30075547268728031 -2.1526895251565628 0.62527369464490135 -0.76762392866759543 2.4964964927233622 -0.69017688313087189;0.073878051973725933 0.64146397958715029 0.73891979275024777 -0.059870388662313603 2.1764878817337241 0.35219264659512506 -0.79691524080397924 0.23694537789324846 -0.7544442719267781 -1.760861382819066 0.0047110449931180151;0.45299290789966601 -0.055944830768777029 -0.34146559315770014 0.50175933618018731 0.43685487196641448 -0.5986948625856523 -0.44221988454109873 1.9378346283677694 0.061423751076466346 1.2209629115079537 0.29392768501074645;-0.2556373481892073 0.82351010782042 -1.2346834053901168 -0.0149652629226851 -2.245843252800078 -0.37177323220793179 -0.32887529384822134 0.40056590274425141 -0.2778270029692414 -0.36302999420100779 0.074346315719254361;-0.16517278510767824 2.6570509983884825 0.47947074683210211 1.385464934279226 -0.75138829576581223 0.12297928473093053 -0.09719294386522917 0.30046043980635406 0.53469099839649703 0.18395459416095827 -0.39246585062261474;0.36627193491847243 -1.649079647047913 -1.5929541594015353 -0.60315887924946199 -1.9113338922261269 -0.13442512117307218 -0.02657898276761806 -1.0288645532699185 -0.27424360366313449 -1.7846437942461211 0.1409648704425025;-0.53726371529348049 -0.67941906843821609 -0.5754063394401383 0.07008935706830477 -1.697936586050111 -0.4471601860585484 0.72676176385478231 -1.7073281775080296 0.4507882997059881 0.056719624076057774 -0.10418313327630549];
  
  % Layer 3
  b3 = 0.10492037602774601;
  LW3_2 = [1.6110914774873883 -1.0546226595991883 1.1552785677940263 -0.66739141594698992 2.1793116560930419 1.9409866917927807 -2.1179551064844131 -1.1269869359285014 1.5314880725439664 1.5074978354519426 1.4171836944192431];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
