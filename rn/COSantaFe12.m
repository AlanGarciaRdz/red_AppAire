function [Y,Xf,Af] = COSantaFe12(X,~,~)
%COSANTAFE12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:08.
% 
% [Y] = COSantaFe12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;0.448430493273543;166.666666666667;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.2274575534038545;1.3808857967501371;-0.56784333953781863;3.1743810675514519;0.49402534302213058;-1.6663841645813537;1.8123526772510892;0.94355458943082016;-1.2333258002500329;2.3877842015821749;1.2046884149962565;-5.4416816915039909;-1.8359815337389276];
IW1_1 = [1.702268907645609 2.7127380290535776 0.6889610796653971 0.081386777494745835 1.3460794420085511 0.61099628458564914 -1.4460564624154528 -0.7847086495032991 -0.27056776690026763 0.2331880281840096 -0.53448133267139453 -0.7509121429373079;-0.28973879411151277 3.0721818231781208 -0.056909375255098649 0.79818494428592279 -1.0116306271285564 -0.073227153839192566 -1.1300939775846459 -0.0047879119399778739 -0.53416858944303769 1.1686747556355597 -0.078132734903861495 -0.37596690336476823;0.31529143785797253 1.7756676494992278 0.39556184898508845 0.29852513582501283 0.56128011199892469 0.29152616551531341 -1.6743541805384416 -0.054576985819126511 0.49753073390079527 0.88587585227890275 0.32017700946932448 -0.6189873746749881;-0.94884129309199305 0.10440221033865034 -1.2480284715499339 1.310692617893906 0.86858946739468956 1.3182223722493089 -0.7464706374177883 0.15340531445834762 0.46406450959624657 -0.88340104475937187 1.1338541864459666 -0.52024378788229952;-0.45331252464894672 1.239200648158318 1.0185082200810429 -1.0126836593590205 0.068328211565440972 -1.2595346190585581 1.9962627579953793 -0.56992595335361906 -0.17924687429661637 0.12506035870823232 -1.0686660061127837 0.5641255186673324;1.064632957386731 2.2920188820238372 -0.42886472932623659 -0.83820921836176832 -0.61971954018118514 -0.1034675403265776 0.93636267373806215 0.31905037130235464 -0.66201832114182235 0.48881898248736783 -0.24547257572892769 -0.17820731625330236;-1.6439074500123274 -1.3463907595798106 -0.90660134446715557 1.5017871494435626 0.65139603552775993 -0.28486483422807335 -1.6211285233047368 -0.17021363048270552 0.33053885496231672 -0.16849969018688987 0.007963518676669442 0.034933667556892839;-2.2908348795550024 1.1205997826731571 0.28534432847909147 -0.14798998043979653 0.58255862091868726 -0.11290989901144655 -0.29661345076736623 0.16031291070689319 -0.27613223566280998 -0.066212186880498652 0.10633248891686049 0.22111191812498496;-0.90485484381514314 0.37979904860527547 0.25386335766074031 0.18167418121623202 0.343141142442836 0.13114359821483312 0.71088713512725799 0.43669360304296156 -1.280629246433316 -0.029947346701292024 0.82773999109175844 -0.30252388291333093;1.9652290078702719 -0.24198384169823081 0.8119713822324266 -0.6171558081248335 0.62644036324740904 0.18705794968139511 -0.70711059152081279 0.41428769188911674 0.51892062618770873 -0.63326763290572796 -0.1029633285122093 0.52876633198768175;0.63302845259775775 -2.2517584082111264 0.37340334396620772 -0.58649808661379943 -0.129610776620354 0.49076938217576188 0.070057933261072208 0.084505420176316778 -0.61180184976583352 0.51088399462390988 -0.3672493192251608 -0.70128449943641979;-0.12376458326909048 -0.25918398983968982 1.2468264910867588 -0.64641579568107144 0.0040497609255686655 -0.33675743065165992 0.27739894848809987 -0.15462654272072188 0.31966828929149099 -5.6623567904603398 -0.062574860038456123 0.23218794415112837;-1.32702951160347 0.38938834454483073 0.13024822487604515 0.46788762966595138 -0.69544139248309966 1.0255583101260031 1.1727872958148828 0.029888332919092955 -0.53966005135843753 -1.4105255874440188 -0.49489162763203437 -0.71733494531268116];

% Layer 2
b2 = [-0.47145896794282494;1.5093006426719435;-0.14599319699410648;0.48092848979645797;0.92125433577291571;-1.0942416929093439;-1.8316178857297498;-0.15327679804731259;0.40204803350917928;-0.27589099082927321;-1.4451675929299366;2.0154346019369114;1.7098300376394981];
LW2_1 = [0.92928661950693192 0.55434903016915027 1.401657290061888 0.58957133183582078 0.34470266994859089 1.4338933436346779 -1.0174272184877478 1.4096129215224118 0.5408893836240638 0.58391712385271999 -1.7741262260660877 2.6829809422548059 0.62770617591913058;0.62213536381460699 -0.76966572612564377 -0.074277799085186919 0.28584076100913369 -0.040651407678270857 -0.88823115183188461 -1.958377181687275 2.3217275919518761 0.60507861938591467 -2.1022224851285021 -0.25675914031675995 -1.6427471009379981 0.563779512606563;-0.82200127226921582 -0.12053298246881178 0.50904746199796813 -0.81843104643143472 -0.61829678842194724 1.1266560262317551 1.6045267515691739 0.0031395347154381543 -0.02197675079228675 -0.46222743633000168 -1.7104273802997887 -0.69863358162895173 -1.4587326765317363;-1.9403416084918392 -0.15354775411507526 1.4556456484294364 0.90482466568863051 1.3377319021487359 0.93926473154405388 0.25817200626507381 0.4200931029634713 1.5347194541929423 1.4526640184691093 1.3775114778359556 0.67474219659710133 -0.35126876811736396;0.73685976548201271 0.027531065617927595 0.67001298944622523 1.5270711954982157 -0.66808691513486318 0.61996514168979611 -0.010379230412489823 0.30403893664892334 -0.12279014577888293 -0.38029153435131174 1.4987518615823294 -0.092819446048238718 -1.077847422639221;0.79609180925517853 0.1425006084228552 0.46297356250113747 -0.40759153163535611 -0.32279077684610696 1.3779230135270348 -0.66207837234551215 1.0546788030969616 -0.33532854708098958 -0.26966334894604099 -1.5147372109057795 -0.50897530444438632 0.47752461356875647;-0.19535562225954567 -0.24207128196507333 0.41143885475855907 0.15569459781259989 -0.24363622627345005 0.63951964575829257 0.25397760806212938 0.47313443252987686 -0.61894030833031088 1.6648202422842093 -0.044549899124459981 0.41438583020386321 -0.18616966714756308;-0.14035743303667458 -0.81459925539528699 -0.3617606515601593 0.049508106260556219 0.81613485735708735 -0.82501680733061766 0.14083460199949188 0.36462443656108223 0.51949699297444418 -0.42198283631148942 -0.31634158291801817 -0.38636918639273715 1.3327950523968239;-0.22705927147732236 0.084356076960204099 0.32917410561608729 -0.22916970721671695 -0.36691261249564389 0.094021025267378197 -0.56379628746037747 0.70387523623751358 -0.19211777130520072 0.1748925977164319 0.71600932299170295 -0.42507184627119682 -0.55487114218571221;-0.86147258748625 0.67961879572532258 -1.0907852191401193 0.16898460824241465 0.18480427943870881 -0.24236796132091107 0.67360092639772684 -0.23065197791102104 1.1014777366480322 -2.0153909083536221 0.027456831773456779 0.91783862438843467 -0.67534690734900482;0.69483543973537676 0.34653090509901435 -1.3602362598962758 -1.4394904694624531 -1.4961596269393473 -1.3168008730036462 -2.2056909041732058 -0.65846593496505024 -1.7121864195687473 -1.5288064320473402 0.58428073840846861 -0.52134111798197835 0.37843963954356352;-0.30206903871157847 -0.31969183328076139 0.12615050310298725 1.0443615611788597 0.70010036823290123 0.66973075891896494 -1.1353410423309567 1.4200026945597257 -0.12658569087888516 -0.51237286905490964 0.80346631283567582 -0.58898720353058065 -0.1790631490494653;-0.39194031011351332 -0.31713773218868463 -1.655682146653717 1.9558329986120946 0.91230588704750615 1.4346438867947648 0.46859425617623751 1.9367109688274211 1.1730081649628021 -0.22728071589159154 2.1102617995608357 0.85068482351703334 -0.24583431635746752];

% Layer 3
b3 = 0.16009138480184815;
LW3_2 = [-0.55551259877401193 -0.19471897768954471 0.20029427954042567 -1.8381832305145656 -2.4578597083368114 0.84588254490497328 -0.49827106465601018 0.26459008216270141 1.8285197952069838 -0.23889368021419188 -1.7266473180885467 -1.2430786458646161 1.4048165369109618];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
