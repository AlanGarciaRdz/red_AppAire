function [Y,Xf,Af] = COOblatos1(X,~,~)
%COOBLATOS1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:50.
% 
% [Y] = COOblatos1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.3993992111866584;1.7231851798132045;2.1436174381220647;-2.1585334660958928;0.10113423313555446;0.87771762452629554;-0.38441959118102653;0.5696111362729569;0.037067523838492877;0.73672729343957399;-1.9135526309977706;0.40180495413830791;0.81389359396215766;2.0229070018482083;2.4804043585071662];
IW1_1 = [0.59563895296707769 -0.88171251528781769 -1.0613724742465014 1.3280656014359891 0.43649713717916971 -0.10860788986714466 -0.64862608804358146 -0.63236802410961224 -0.38974571971834227 -0.18808741336871249;-2.0283055481836301 0.96463869096790678 0.89325279127694301 -0.092580641814194203 0.040431073737559296 -0.27938446454993199 -0.93746771624058756 1.495980178206608 0.047432622294118279 0.18858619407592603;0.073370165841493459 0.14529679842897403 -0.35600250824164542 2.3619101524887536 -1.0340536585539899 -0.16210891028616065 0.07592912494893761 1.2542285178311487 0.25447427378776238 0.30790002465675026;0.1890441646116493 0.76475110314451022 -1.898268682588885 -0.58729003493461784 0.25177615401945547 0.29355877209316822 -0.34242347787016675 0.20435856863670354 -0.11859412898084666 0.49217158395428434;0.28540239533239353 0.039095497557235459 -0.68297020526712404 -0.027814126159331383 -0.13049449463423995 -0.48300283340067801 0.1345567107688487 -0.41063144806294982 0.21651970551881297 -0.022178357111154116;0.2614950498423082 -0.98295126127066257 0.27662714693020701 0.72318641981234222 -0.68102801854447692 -0.54206636394733909 0.43671405827908483 -0.92489475873757898 -0.15119528713394079 -0.025107654385750008;0.80379967919213269 0.27743819023694805 -0.20692776972046692 0.24567524873396485 -0.6686942723646383 -1.0879514251657403 0.25500632452204786 -0.22772447865841913 0.59202394027939353 0.060396231443638607;0.71481319086512929 -0.48133482927933108 0.61302613848574572 0.31670632695191453 0.51322075806902834 0.26458318849865892 0.042421036502778182 -0.79930557811889069 0.032680902111340837 -0.19344349675376202;0.99203831931021613 -0.23581299321256874 -0.88748182510445028 -0.60638262802319431 0.2406655155452955 0.85681494932671287 -0.54585126130822492 1.3129927340674805 -0.17071827971056408 -0.047758999636484792;0.52425453151539825 1.8483976574423155 1.8643234499688532 -0.62543542442241029 0.76495187579007307 0.22004314025192098 -0.094429020843354278 -1.2614209575769513 -0.3869041626384967 -0.14512930151529518;-0.0032151166048192069 -1.6823291777139744 -2.1528605325851387 0.85584455256842029 -0.050517224930650063 -0.29127584183614252 0.011331339321964654 -0.040400492956185481 -0.038397611628496843 -0.51044867708981034;2.2164199022764746 0.062401970185185347 -0.66155275868247687 0.3920380898378053 0.045040474427095169 0.11921745874669515 1.2536263207473524 0.38259934415329466 0.33027937824605352 0.52090815600608742;-0.24985323686369448 -2.1692954718609614 -1.6697233197572894 0.4756458691627552 -0.77297681422314601 -1.2372769215496231 -0.057183894138068639 0.57889235418361162 0.44938891247860246 0.58206057707932546;1.5255793004307632 -0.15404367694368953 -1.1353891554346103 0.57082094145398976 1.6347708780059746 -1.0302603462518369 -0.86546568819107372 1.6192304598431375 -0.087071981927935249 1.0195108353800617;1.9656840996917713 0.044014536861195219 1.5585622728057014 0.041727038937956498 -0.61842317034923622 1.1711268192766908 -0.28169929713026609 1.2581719219091962 -0.15654313306316597 -0.10412480289409613];

% Layer 2
b2 = [1.5790691032887967;1.9723773304868584;1.5561072123369706;1.082956926673772;-0.15603104980590773;-0.10999490536906559;0.75142489872232388;-0.39039166547499349;-0.39522348457674411;-0.32892729137033694;0.8806377846701654;0.86363512177816748;-1.375618075377512;2.6812656811777029;0.72468739012435579];
LW2_1 = [-0.014235260246918732 0.8145031359514926 -0.67949583982043005 -1.2952732475943982 -0.43377661479742402 -0.30004519037526617 -0.57005708736577909 1.4511728040290124 -0.70489760117676936 -0.31186309292261388 -1.1387433745985072 0.13015536774833159 -0.42429345386529621 0.77507814197970359 -0.066531880473951741;-0.40870970693006275 -0.3333365450517341 0.13550523886768789 -0.090810829095618495 0.23500349488584238 0.17203232992063355 -1.2069890794578575 -0.51727540291450047 -0.031281276343898864 -1.0934246704952673 -0.96817115893573569 0.64892925682387359 -0.89863611446755209 0.0060385066941295541 -0.9719430690232842;-0.720265786970266 -0.30186999050288499 0.13097261086140685 -1.1185530487642543 -0.54713319257511928 -0.0087525657395553427 -0.38285998294543144 -9.9800518435987431e-05 0.8973223604756263 -0.29994141268127988 -1.1880715491079159 -0.41007737430790858 -0.36599128241716339 -0.71201932400050549 -0.43515783786751627;0.15299113497912278 -1.2276980877281065 0.77998953695429685 0.11966792673459678 -0.37640562787815385 -1.3158722157830109 0.19543462639876807 -1.0083088334041559 -0.7865941049580647 0.73450504481488654 0.43879963304470643 0.44155309409327415 0.9794043167126486 -0.34713188383478866 0.046456252726779973;0.44385122703917934 -0.31949757914905064 0.31612624098734843 -0.49508063542486302 0.49679495218158359 -0.82013577115037339 -0.21034745460968574 -1.0088025131850136 -0.65992083334944363 -0.22831271304385251 -0.39445080208127403 0.33562820268155996 0.14600102423934247 -0.28634997682526625 0.40187060171420758;0.14097362119293239 -0.318431662238361 0.43956515327647316 0.058821253820777686 -0.13296724667586884 0.34992704206625569 0.39525940043710145 0.31839677310112258 -0.025139041302754829 0.073282499579149396 -0.33184473230994477 0.034430468932662071 -0.21643468012765094 0.50647191930062962 -0.75327475068162486;-0.76896670861494609 0.85792717620842485 0.88076233004156923 1.5253357239954519 0.21674088911329628 1.301440740553909 0.22335166864093844 -0.49014683084854627 -0.57164897314889818 1.7819243253991894 -0.078176695143233152 0.1805577897310332 -0.53470237011414024 -0.5531319931589016 0.80914801760057897;0.78092744142745141 -0.24536736060840697 0.010102568264733814 -0.64879186699217151 -0.23184607569898605 -0.2807250688831146 0.60744005662366729 -0.79227720159004866 -0.45280763327689749 0.61273127670541594 -1.4841877950147244 0.36865691171693787 0.49501169707007708 -0.27393165693376914 -0.3191276776753082;-0.61838154971401227 0.6454184315365411 0.79056019253642107 1.2521454570880359 0.95754115934063666 1.0708422916194456 0.017916393926308054 -0.73099821945574583 -0.69012303508841644 2.0679512599951506 -0.28809316615906388 -0.036382189093056849 0.78434685971641727 -0.71837588643955164 1.1533202017163806;-0.68279927782500704 -0.48596550584425197 0.002903645996771495 -0.9628055427106309 -0.038833656284424437 -1.1534986143383574 -0.78650332269669565 -1.3210136458327482 -1.1596704469146006 -0.270307465995553 0.46993770293108333 -0.24399092549296961 -0.66840007143407709 0.53632192072597473 -1.2926349191694704;-0.2284823504503368 0.57440014669892558 -0.79701755759597193 -0.45514128793813502 0.1421814100296816 -0.11374341274371776 -0.38426813502254237 0.57703110676042979 1.3432072653571621 0.2498550235115293 -0.10498880675938808 -0.11196293939367488 -0.49722742737199166 -0.64229943421960844 0.31874643498304417;0.39100398737892222 -0.30984386658767427 -0.80230728587388411 0.87908580371246392 0.53217739267195829 1.0295586428966894 0.19000329121511617 0.21847770800662464 -0.063212225347080098 0.34976645909087639 -0.20033412654462013 0.046114806720628045 0.52682768817840619 0.24037020328045355 1.9176438444776394;0.14124023436144409 -0.054228235895764393 -1.810188732428057 0.38886784528748436 0.16827002506950817 0.41481527368010546 0.51795269183138115 0.040989721087408733 -1.6021284441530279 -0.39867762442667692 -0.0015329825822809201 1.096904612295021 0.1619314179917771 0.73167023183213276 -0.61724771510049448;0.28388581665874918 0.17317143763324555 0.8413803056048389 1.1369351935988392 1.119380517143989 -0.45360991326795164 -0.12740219767940936 1.3493828645198496 -0.10744576755024578 -0.11438288051136469 0.32841615457030837 -0.50887840904184745 -0.49432499897608495 -1.1095984909408754 0.22900116374482193;0.88022567419418263 -0.73582322092879748 0.50128255741145655 -1.2021911482047989 -0.14809724374795538 -0.70251858749757012 0.54630295850111577 -1.3099334299320673 0.66549998165502122 -0.8022294471351854 -1.4318062778130332 0.099655228824269249 -0.60537525481583454 -0.098749072420197315 -0.50537293445162668];

% Layer 3
b3 = 0.33852447029541055;
LW3_2 = [0.63247306906230905 0.60907636185991831 -0.75923690922800335 0.66954208442640772 -2.1652666174444715 -1.6826118951793383 -0.93601125358650594 0.54319208319815038 1.1170499370983584 -0.81822807023471456 -0.65633826071774659 -0.78394219080446503 0.67606038467943519 -1.2806994983740374 0.99267108710516738];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
