function [Y,Xf,Af] = SOXSantaFe2(X,~,~)
%SOXSANTAFE2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:49.
% 
% [Y] = SOXSantaFe2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.981801756683099;1.5771514939368958;-1.1331138503155318;-0.70223477190911476;-0.011244582384547487;-0.53744708690154108;0.47709305046853001;-0.45559539840924457;-0.60183486215390747;-1.1656304882698532;1.3504170516011558;1.868129940929909];
IW1_1 = [0.68744429213374592 -0.49325871372657432 -0.33392142588215878 -0.11502027307729121 0.47177292989737984 -0.25588678478410803 -0.44095489145403816 -0.24510754304444077 0.28273413950378251 -0.39562501264612016 0.026283259187471403 0.4149982314780345 0.2375095273627032 -0.3774943779807195 0.7990565139851642;-0.86341142608776822 -0.013744750243192239 0.13749065576237668 0.24164021121812443 0.30082312099702402 -0.6289233632902812 0.41870145589316266 0.011969913045024436 -0.18610537343341843 -0.3731426729010448 0.53716969956520777 -0.18076878220735446 -0.30570459503522851 0.34891374698580152 -0.43014365399623095;0.12599947522989585 0.73397223040084802 -0.54909718804038798 -0.19152418543513025 0.25493749605249494 -0.13314499103917005 -0.41349898989908701 0.61238300584791516 0.78641883059124496 -0.80826080728731742 -0.10899984296166274 -0.1159554183330281 -0.11664963058105762 -0.4295258597741296 -0.1564973582815167;0.18363310132220351 0.56020908024113747 -0.58830432707237901 0.31796481275726096 0.35089146440536212 -0.15100516691259488 -0.59758323036709182 0.23264391246855359 -0.28931557783407064 -0.9147442258524614 -0.10896250102386347 0.031428977912828428 0.20731516042853759 0.18542068086378596 -0.14696900133292301;-0.052896739796629851 0.59231600292601094 -0.17919720453259974 0.27062045649984395 -0.057655106944611852 -0.32410552766696615 -0.1970284055993988 0.14113485641486662 -0.052859704781458766 1.3725131968188107 0.030717637251362791 -0.12737785349686268 -0.12339756695086943 -0.21987047693348186 0.60669037446748719;1.206857779079195 0.47102634058342624 0.40917812748867466 0.1138376475273033 -0.38874424525337054 0.0014107889701229434 0.11960833819140824 -0.16011034592297863 0.84554109628765184 1.0036337226253191 0.065373891725774347 0.25081250378963005 -0.15420426117063871 -0.5399089474368205 0.6750966632614096;0.21835621670164868 0.046144039289806961 -0.22524410228489267 0.093086171572017956 0.34043347312209293 -0.037402167064372757 -0.15894216608840467 0.12130334777283129 -0.20051926607774068 1.336920042255459 -0.015922759660498633 0.14160015052094033 0.2866439251202898 0.23459448889989332 -1.0514793201816139;-0.22753617329005307 -0.066047621328135547 0.61178967312866983 -0.039836755651562812 0.1880079623866259 -0.76269399403000426 0.68198889225992054 -0.53103262064403478 0.29811900616100667 0.090224141028371396 -0.43182450982224291 0.31141910369015502 0.11830360914995505 0.58342585211712772 0.4175957698848437;-0.4677389808981165 -0.4146078686227494 -0.43261718828198442 -0.41823056363427535 -0.16566766491502494 0.019119054772990432 -0.58055524857386309 -0.27520369546867673 0.0050694150909483641 0.29268655654165326 -0.18622738420690077 -0.33956506146862186 0.016954255733083564 0.26196281956876644 0.11666844647485902;-0.083282038079127485 -1.3393573025538381 0.72360024807024304 -0.30010827227872161 -0.32320511958231546 0.27465024361456147 0.64487156101405807 0.072014428668498692 0.80386250700316941 1.0200161293911914 0.085698089113239617 -0.62188559784698239 0.058565868729272941 0.02436800540587861 0.39064346718498161;0.34457336461851651 -0.11355170407007867 -0.29266239912646308 0.018075928754244557 -0.50812195303899166 -0.58133750160507813 -0.46763208085575447 -0.50654129929537428 0.57436147818626759 -0.10056045043763502 -0.76296712353505802 -0.53079261093196461 0.35172280672485318 0.42724760785784099 -0.34580254907873476;0.52592937334188483 0.11462298444885537 -0.33443093498711707 0.3838855910486112 -0.31884480382530361 0.077804386794157979 -0.59948454426834608 -0.027491014136613562 -0.42994900910580713 -0.5271300754888012 0.25426240198805583 -0.36519326611611197 0.30445491790975016 -0.94695403444552462 0.15215264576113577];

% Layer 2
b2 = [1.4771806573783421;-1.4674605546330222;-1.0450851074940215;0.92834686930471577;0.3765373452223888;-0.0085293938693622468;0.13166577587090428;0.55372622514750158;0.72833075097110056;-0.98262683848543675;1.2307096456498328;-1.6531626878001218];
LW2_1 = [-0.29006500822787695 -0.13077438271618702 0.025477763807662829 -1.0392207626773571 -1.2100411445390167 -0.88923227848413533 -0.25168671040624357 0.45673039880946292 -0.11721872448050315 0.98115401344850162 -0.67056152812147651 -0.63417924939266557;0.062391207292080184 0.59580781391562387 -0.12325152767085348 0.58923510271854362 -0.2447339496049428 -0.52473335196993354 -0.59189224182034927 -0.37730716833530192 -1.2185154548329125 0.67806611321629384 -0.33302737696391971 -0.60318662923974442;0.76879337324343322 0.62183089138241587 0.31255382408935506 -0.51513209288848216 0.21911110382946253 -0.73761530077725435 -0.62191701720697834 -0.48834626360974881 0.55822285967171859 -1.2872614640389786 -0.12815833220666259 -0.010389533025165126;-0.64480111715482413 -0.36821604307045908 -0.12124580963668861 -0.92123822808737488 -0.86440233309388859 0.045783148974513722 -0.13608540525022023 0.30247969307564115 -0.14983365745255872 0.41970383074985768 -0.79633521256673145 0.75683589520365668;-0.20418261048795464 0.0091456927321426663 0.062308656502435784 0.57466429271102981 -0.078313139599162723 -0.0048460381811366348 0.024590963754073852 0.58992781653768256 0.74686751209840541 0.72532183634578651 0.80497044127419326 0.55250327516510933;-0.035600250281783222 -0.088098669986301087 1.0498479205503468 -1.3068448264543495 1.0598733421720001 -0.8047180057241009 0.33636065432866619 -0.09620222096470761 -0.6562072416626914 0.62647648457124039 -0.49921040663579358 -0.80527616731665974;0.0765092458253053 -0.35119179890316227 -0.12944836152875341 0.99804307813203963 0.14426210233603073 1.0682068369770341 -0.61416556616942508 -0.3879674401854587 -0.44945275922579037 -0.81753122556708979 -0.44953322437460108 -0.01329091947615685;0.01414162910407778 0.23735298155914844 0.10015608145527463 0.058104811390949938 0.78033537000254249 -0.82513123790223575 0.43596488486853291 -0.76756821678549081 0.27551054748979387 0.41226780808536545 0.83936779932104089 -0.020135753839013518;0.60782055858506889 0.69458339722914686 0.31697383410109758 -0.10132890862047417 -0.50383231936949924 -0.35341452030989512 0.59087520604411825 0.0085067287894541148 -0.062063801279673078 0.80724501860902587 0.5904527044943032 -0.11370475588237013;-0.56736499727462486 0.67398472265460252 0.5087312757145307 -0.51232571714037123 -0.49545705256847161 0.26825820824303293 0.66209766443172835 0.19544377383896047 -0.6769409890056739 0.68989975641355827 0.04718706971367962 -0.54650530055857727;0.73103653117820222 0.83515030817108171 -0.14829777698156413 -0.055976267129314514 -0.20037789816149107 0.47504593821552854 -0.19617548827637638 -0.2530837633313095 0.35044621108254459 0.95455969099641391 -0.11342069947066838 -0.064921078808803573;-0.4656237280159144 0.11977044735638265 -0.45136339950436233 0.95430472458241944 -0.54851184062210689 0.36688016988248584 0.54324638153569094 0.20329908874051816 -0.96708688945136156 0.67868761342060357 0.14491678004859221 0.47531235587930948];

% Layer 3
b3 = -0.88149517177323045;
LW3_2 = [-1.1486327401171974 -0.57141371789636319 1.381711046559623 1.2799692359839567 -0.72725324638487931 0.99554933116940347 -0.50379472111267376 0.2503806692963495 -0.257309621133402 -0.40091717025445872 -0.57924228017771318 0.98408237102882212];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
