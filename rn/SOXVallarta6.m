function [Y,Xf,Af] = SOXVallarta6(X,~,~)
%SOXVALLARTA6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:04.
% 
% [Y] = SOXVallarta6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;10.4712041884817;0.00782778864970646;0.0208333333333333;24.390243902439;0.02710027100271;0.00630517023959647;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.4337388799048012;3.0580874261362205;-3.0268563911974007;1.4684578830600501;-1.2150203385655947;-0.46875424462538701;1.4198380792479028;-0.39258625830572658;0.86389884305646181;0.093943656422085436;1.3211378350354115;-1.7677593411416943;-2.3637500676636725;-2.8782978669136612];
IW1_1 = [1.7958418973863148 1.4112603880612584 0.61912223756014195 0.81439239351277193 -0.24114527058070631 -0.95712224391578826 -0.72561453738358583 -0.70104672812509838 1.4431568020256915 0.85760323160493412;-1.8321772141758512 0.3637573868955547 -0.38165471044911503 0.37473161512026987 0.049753558135141138 -0.67327416408450469 -1.5108329738370534 -0.064102423058102834 -1.0002001622704042 3.2773129486126886;3.9634982249444088 -0.40169071478560142 -0.81328156866645174 0.7160933604977664 -0.33956421718287827 -0.77390047897756131 1.467221201899003 -3.6829786454819464 -0.18116811747819789 -1.0377033452891733;-0.34181011550348722 0.43112286487894586 -1.4407723811260764 1.4155673653598078 0.88483649404267861 1.1058693008078873 1.4600357384936495 0.10022209329073636 0.42325761690302277 -0.81638463878111378;0.57117441167123995 0.046743760119327266 1.0969901285917212 0.74557161828393093 0.70951290396757449 0.11338390312387897 1.052753453363569 0.081920957343935397 -0.49417243673538025 -0.036322994096779963;-0.14094229911711212 0.52340787465184258 1.4796442577917637 -0.72437519779559068 0.42829760408747375 -0.84690501967890119 -1.1161813549901498 -0.016200700627952813 -0.08593102460332247 0.035857117567975029;1.7948861948196477 -0.10786898958266979 4.4209098449060695 -0.43950839864416574 -1.2660307186597917 -0.63218782358963888 -0.16749515614386989 -1.3627185455552662 0.93020765794472715 -0.16160023967543599;-0.081587513404035528 0.075164100717698759 0.50303298451495992 0.25281988965103203 0.39289113161307948 1.12120029894929 1.3614608232769829 0.33149415289306516 -1.2398266755064611 -0.019338331114095046;4.0447790069202707 0.12143635930512431 -0.23586965507250529 1.5544358654867116 0.81374638872945193 1.0031325417152732 0.16850210000291393 1.5737014928385551 0.73549885483553323 0.37883719083361256;-0.81785338626641579 0.46710760068651275 2.9088868328369961 -0.15733477328509141 -0.0034905464767014827 2.0088317855077054 -0.53866065594284473 -0.75504930081066624 -0.29935512193516856 0.18605550940121893;1.5777588506169236 -0.65480335249119104 -0.0052904405419107303 -1.5362568576053044 0.43853374667573486 -1.6069849560653029 -0.9072531330948872 -0.52822261435722773 2.4196908787611457 2.929268555209656;-1.3347513795458157 -0.47331829569774059 -0.97991208214459735 -0.65727453674461034 -0.68146184578547575 0.25023595506530139 0.52303580473779587 0.3216801264099145 0.31229972095874758 0.14054132320467236;-1.1973874534016968 -0.1376747052797565 0.59192002642675623 -0.17195219987973784 0.63615017880273428 0.51257101804863003 -1.3429071290959864 -1.1916973496623571 -0.26700373917271469 0.22718898882100802;-0.3859053922924584 0.10007720072153595 -1.5617647461584077 0.34961788657763621 -0.26428961051028838 0.69078498714639947 -1.1520352017146658 0.25096615151663698 0.66204634562815434 -0.3271946063558468];

% Layer 2
b2 = [2.8886677039134945;0.77319132786558153;1.1595082634497484;-1.2171072528463773;0.080764487565454263;0.67136208276312404;-0.18632282160964497;-0.84911744446896964;-0.098805486808126147;0.86045581944103211;1.3153343128766743;-1.1986243900798632;-1.7511193632054147;1.6049743839703965];
LW2_1 = [0.71269071192404709 -0.50377888184854847 0.54371731586226457 -0.20940643891986296 -0.96436770481192136 0.79874144711127204 -0.75484472773436317 -1.804472479344041 -0.64557784837089305 0.36599870062876649 0.046733192289580908 1.5678974660900464 0.35933072745937489 0.27990092818535783;-0.37067794893874878 0.30136734754725264 -0.22137074295805184 -0.34728119581732747 -0.20618363707997941 0.9082073913123021 -0.08604397145989727 1.1261834585147752 0.71237036419169031 -0.35022025967739812 -0.13197964310216234 0.80833485715999887 1.214634745654549 0.6096858916409581;-0.20676675732919278 0.46115807149522547 -0.081001373211065528 0.90567521197940648 0.49139427684368314 0.59887010125350149 -0.014449832849760355 0.51901458043951254 1.41483067225855 0.085986198659264684 -7.9528676825101757e-05 0.43009914698623114 0.26956899133154982 -0.22503286083912077;0.42243774453969313 -0.25197867393801959 -0.60222366778736025 -0.26197849459640782 0.1733365219232175 0.2535979694581027 0.48983372012084564 0.29312255239650392 0.036751299993081542 0.46250312983357128 0.15698624038947859 -0.22885968854655248 -0.14315639168134001 0.62440073240901406;-0.17011829071604079 0.44541983974255522 0.22221817251836953 0.46195802820101561 -1.4621533390748469 -0.51494763074560534 -0.48068921483049792 -1.2260688658353271 0.002589597846209421 -0.86033813483576627 0.42780270713752572 -0.13615337796204416 -0.70564334577755838 -5.6227824752255046e-05;0.35032179222646165 0.14193919789625917 0.97950759714571367 0.035203127120706217 0.1471582680052069 -0.873915588590507 -0.15069419242054086 -0.30924722578262287 -0.99040658867695763 0.30365614538488073 0.20851101623329493 -0.99160932240672517 -0.9694583316395563 -0.27601375152540608;-0.44202400189296209 0.16261786466503292 0.26470604615739324 -0.61229120128888193 -0.053539490070623405 0.4636974695063199 -0.32770438004737734 -0.099191698714396509 0.28230855557818263 -0.095263181914145262 0.047190080041257937 0.21827513829848244 0.63139471317766127 1.1072598618038589;0.46654590425619274 -2.0357002288857582 -0.35933841823313339 -0.11671660936778842 1.0207105484750627 -0.77464421031354358 1.5365152318851938 0.92717269928063339 -0.90907917200060662 -0.052659729707081618 -1.4756053050254472 0.96784640015303536 -0.18001850956347068 0.57936257430797555;0.48172585611353747 -0.01523220817495613 0.52274023957376781 0.466639073436657 -0.06119394692959438 0.60845942189565172 -0.94654422626788648 1.1997942850737653 1.6465341341926267 -0.1383765061220536 -0.10275522981216091 -0.55336954599906862 -0.15717666849942702 -0.56640140593855726;0.89040122941251854 -0.63027400984175586 -1.1110286697035348 -0.21417704185977701 0.099719286490834058 0.14990302574681696 -0.52941401261007603 0.2570700377475606 -1.2107275432353286 -0.2873433362558469 -0.17918833376208848 -1.5186703696160704 -1.6804217700972495 -0.31455141878021231;-2.4945904968274411 3.8777775385535689 3.5016396990975478 -1.0301410876835655 -2.6534087046778696 2.264955934918536 -3.3940617614176771 -2.1633645779470982 3.0480111339464382 2.4011304235330888 3.5468328275859013 1.303040672450902 -2.0044840963915931 -1.3157580689499453;-0.45106677855358152 0.25829094234731959 0.34876539758493463 0.50688910676563115 0.15932063155639573 -0.78640416018631376 0.53463787958638398 -0.16928890541356068 0.50606156754592546 0.48415220827339467 0.32386628916972926 0.64020016114174016 1.2832634646476777 0.21655028808098231;0.34231109649708952 0.3366296130311166 0.30894837712979822 -0.87922608716372741 0.85378298502930894 0.65016599637899919 -0.2047534960039778 0.41370334977858714 -0.25318903887704008 -0.09681428379934609 -0.2342511682205734 1.8061551819331576 -0.19550080298759964 0.33905568045554607;0.55883751628881306 -0.22081154411740975 0.81461322093936639 -0.52405424692818181 -0.26711397916184637 -0.49869371313493271 -0.065917826421652476 0.56957599993497043 -0.78689318739633829 -0.19136016635183567 -0.080815396513315582 -0.6173146085996527 0.15311757747718274 -0.355582105897152];

% Layer 3
b3 = 0.96747580467422556;
LW3_2 = [-1.1330821415727181 -0.59618050119349908 0.11796234234422212 0.085750820112921455 0.22490786033712429 -0.88286983629023619 0.45462900943680601 -1.2694200521934189 -0.10494048295517409 0.36600788818956287 -2.6421833996297721 0.34194197680942684 -0.78090972504075984 0.31712049996951219];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
