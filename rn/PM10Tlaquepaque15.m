function [Y,Xf,Af] = PM10Tlaquepaque15(X,~,~)
%PM10TLAQUEPAQUE15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:40.
% 
% [Y] = PM10Tlaquepaque15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.00773694390715667;0.00572573718866304;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [9.7753063792184882;0.6194755875993424;4.5112120477963673;0.63480720414313097;0.60213447752086613;-0.17350088210974224;-0.080257750514947296;0.21375025471208897;-2.4570559729400423;-0.85407977726067907;0.78477357239281609;3.2043048099596971];
IW1_1 = [0.19895359919272379 0.16336050736951041 -0.98556792817164396 0.17520493126018757 5.2565519270894079 -0.39485763201761714 -0.030519880486514286 0.084245760624369948 6.2019961594100455 0.29565926257866076 -1.9044920361093773;-1.1662071574705497 -1.9385288446938909 0.65573248203049772 0.27308274497580387 0.04779829737265423 1.4363346844422069 -0.096735857296108757 0.056092631961976849 0.63016299292581335 -1.2015962635082145 0.83667985189149308;2.2487798535693924 0.48538330595798151 -2.6173970843285095 5.6847800901347334 0.020320222213862094 -4.7286390370073734 0.40389810977583152 -0.21461728324880924 -0.88795771819371105 -1.2752160175103679 1.2269734358265139;0.27687575784053836 -0.52771970591006523 -0.40029274132080556 -0.28242013186786041 0.28457877477939758 -0.65179039520399085 -0.17860657724353732 0.10225420448479694 -0.51213231599078923 0.75449779520771509 0.63463404917640687;0.30727657976255152 1.3784612305603741 0.12890960880444166 0.20423679052705326 0.053321186614223109 0.41267926190613541 0.16751280788508643 -0.49763835334720768 -0.67988049230697301 0.21131813757868156 0.11688464192288009;-0.28364236510579405 -0.46927125051416874 0.1882946687550893 -0.10290630286921798 0.079873931278672192 0.1518945324671675 -0.0084191348870126977 0.054495969356686706 0.25249850317372002 -0.35416578538866117 -0.12232942504698145;-2.0947753720157469 0.5225417321018837 -0.035405159386341062 -0.24165842640583085 -1.7487366202584029 0.19567053845639187 0.057448978068320951 -0.031724312043147927 1.1690746088707591 -0.062021503143995169 0.31381230074502969;-0.86181255205191898 -0.47974601341917406 0.32915866136743144 -0.13802760022056976 -0.71912241413439382 -0.071466194199389807 -0.11177691562070566 -0.11076229403112363 0.35177498611426211 0.19224797594018103 0.33166981753338903;0.31861646113152264 -2.8518032273494449 0.15928111065060169 0.053107465489446351 -0.29762838605944586 -1.2246811488002938 -0.010335615650989925 0.21918532684862413 -0.017285850620866988 -0.057557950551942322 -0.086018808992288434;-2.463080905856565 -0.3855250287024598 0.29209785355758294 -0.45835437239834792 -0.092888088042718614 -0.79399341166776549 -0.23867791075350261 -0.12962205940330124 -0.89428684859573893 0.41881410130363123 -0.27833881855231357;0.0067424581818355568 1.8512222900932238 -0.57163803037772998 -0.39266570047758481 0.15679963746521114 -0.33845571595302032 0.14477845071863468 0.38137830565516273 0.83806353251383692 -0.069860966557230508 -0.12652398978852844;6.5228028037436259 2.422305557581772 -0.87560812289155787 2.7869490131617591 0.15938693570847495 13.065277716659098 -1.1837555228806784 4.1212292787196469 -10.624703216672554 -0.31353592130009306 -1.1455669127491963];

% Layer 2
b2 = [0.28593270334466114;3.1945309758349305;10.267409847863117;-0.88249984041801921;-6.595832747822941;13.108711262985969;-2.74885846389998;-1.9156966392465047;8.8363654889730352;20.67447526964753;-7.6616453746818767;6.97439810225372];
LW2_1 = [-6.1025181012759955 -5.3339174782575478 0.4738833744639338 -2.8051192536771259 0.89535586199516815 6.6915615771933634 -1.9729743483485642 11.693462923419236 -1.2373925691838028 -0.65547893843228688 -1.3876889569807909 0.52557104687619682;4.9533809385332335 -3.3652374343101883 0.83057779845643609 -4.2650276702248382 -2.2348884952961758 -8.0684145258515354 0.49294586322966749 -5.4765180780375973 4.7759082631487511 2.2861075383795852 -2.2169014563614091 0.41945592272732768;0.19487414851430218 2.5259309565829424 7.3624884724672937 2.5145364234466565 -2.2509086209608107 -3.9316024297863787 5.4393698698791093 -5.7810253476698392 0.84162065469408276 14.924714286156123 0.11408032050884703 -0.98933012190163594;0.64956089736698641 2.0467671467315305 0.90662183486686343 -0.28654480437998858 0.12456719989023834 -2.0148626392802003 -0.91339361259049934 -3.0264938229799325 0.63752530570545052 1.608798295425901 -0.15070409493896533 -0.25281380421705635;9.9889937733217273 2.2668247320147081 -0.14373216528648533 -3.3923579167880566 1.7822775359448197 0.34321179306705918 -3.5408434435430354 0.43684304971871085 5.4965054457005627 5.3934776685172299 -0.21217956347341849 -1.7610385443755605;3.2068172289693306 2.6403728634474555 -0.52048339313870418 -1.8374714626222171 -0.58362467000785956 -7.9602269228274993 -7.1823510113735889 8.585425715378225 2.3473418699885427 -10.466713071673759 2.8632879154919766 -1.7765413709766231;2.0619738892106612 2.1780190005054894 -0.34886688957516149 -1.5243481428252741 -0.47314333227869632 -11.509408554292753 -1.4085234949088039 0.79093657611151869 0.089256595963193547 1.4040804501613551 2.3347794621779996 -0.20036399069276176;3.5251498797198662 3.1929670712073968 17.012775850876245 10.237884983769725 -0.56552049780363323 19.194040436525082 9.5012023525229417 -3.1538143282024316 -2.1517238888520374 10.472975156186497 7.0875946813485839 -25.134523775838279;0.56264989577777114 -2.7251430847414162 1.2554129063265915 -0.5437513824570106 6.5988769637396905 9.0924159015754302 5.4836518573869313 -6.5728336895561323 7.2346458431449001 1.9006898132892709 -0.48434470346538605 -0.075868591180082504;-2.5588682044334776 -39.279679602826981 -20.498050416090809 45.634853972984573 -13.935610003817057 47.216255948573227 16.942147976746504 -0.090395721438278828 -4.1253450950743806 -3.2029861335840457 3.7356828434767548 10.689847161475722;0.07682733946663603 -1.0881170458233849 -0.23140484131707739 1.6061830006569631 12.893923086102891 6.5302202336702448 -0.93886806227897857 1.686618203887291 12.786604035642059 -0.37115027524103922 11.874934271552544 0.19797476363739661;19.205005127058516 -24.937958756712415 -6.0503531767436254 -0.49906773252846975 -31.062850108914091 20.708702362840832 0.15080426876082167 3.3920262201500266 -16.09298460958853 20.967646946497901 -0.10345119170080719 9.5775192135631517];

% Layer 3
b3 = 1.8350807579352217;
LW3_2 = [-0.07007450610627286 -0.032729399232948597 -0.092247056756822765 -0.095734687587643433 -0.034869617455943566 0.15669953202853243 -0.11743312825049125 0.019592342448097728 -2.5291784709286693 -0.0047958167998455236 0.25397711234493753 0.0099755667082641972];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
