function [Y,Xf,Af] = COSantaFe48(X,~,~)
%COSANTAFE48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:11.
% 
% [Y] = COSantaFe48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;0.448430493273543;166.666666666667;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.457222070178652;-1.8385150552278615;-2.7372339386632589;0.5059969291595533;0.61691684589532947;-2.0474915916883987;-0.5055627425224053;-0.081592061799129145;-1.8899709717159785;-2.1860487795794046;2.1299303296258043;4.4980744848952776;0.030471238440695016];
IW1_1 = [2.5631073831910469 0.68322714773875948 0.16097584014347927 0.17478165157428308 -1.6712794611023782 1.0313361952843754 -0.476837289347883 -0.18922678344510027 0.86517639920697076 0.031605044065783308 -0.26748728729118559 0.10300497826582854;2.0233788823493764 -0.44027068803181879 -0.83395064064400781 0.85937313936429416 -0.28991509389685943 0.2151814282714441 -0.56846489760467755 -0.10292177307665835 1.0561189395538275 0.21707537132634142 -0.31067057077865357 0.57027186096834048;-0.20442132178566877 -4.8110453549745387 0.081717242586875488 0.097803103416299386 -0.87527790884981971 0.04490483212399006 -0.063743012546228217 -0.029282717763481726 0.34481388959242665 -0.20997734362991413 0.04380468179119526 0.1958844312649641;0.01854200992698548 2.4498426367890631 -0.70158063907476831 0.34270640659899376 -0.37762188551002451 -0.56623348060594048 1.5317394306529764 -0.052097144092923174 0.1571060698918092 0.17694367063983216 0.044022042898174463 -0.40627077415181273;-0.90248748947211133 -0.21889853023623659 0.80428645582755232 0.1590096794325504 0.57621652896322362 2.0347187507218956 0.48987459158676144 -0.31526071862004346 -1.4641733260491998 -0.16059021970647208 0.30456597234961985 0.65815324244935103;0.99969457988121135 0.49254657753417697 -1.2504527461595552 0.68219520749717977 1.1331384282444821 0.79609672322717073 -0.27862792827892446 0.12530406563135485 0.028576699133190123 0.27581823478042272 -0.19220738006570159 -0.39986950067898502;-2.370734609158375 0.068057210372067092 0.40398886893245167 0.19523739388178465 -0.3865612291643078 0.74776136580630204 0.75890463432175326 -0.34346618266555878 -0.73285591838343378 -0.05063611423977684 0.16645889052078958 0.16645571907146361;-0.74381822127318986 3.2368579928394592 -0.31188986184485046 -0.37164514715932506 -0.60689177728226895 0.63997711507262289 1.0515699494254169 -0.11631702928787775 -0.594835427562737 0.48669241850624317 0.14140208559945791 0.24827518926527842;0.22716414705516413 0.64465891883462989 -0.86823172956827244 -2.1726733578026156 0.3268334803262643 -2.6421073097433889 2.4264774938578149 -0.51794065496053188 0.91682785304519621 0.82065758459013405 -0.080011158274485419 -0.079892778982083149;-1.5293730755885449 -0.016679799056116648 -0.34771471875158444 0.69108509760043291 2.0785888114987396 0.64190878565473652 0.19446844605937894 -0.24593642118493381 -3.52254920105073 -1.1240870069291755 -1.2228729697268454 0.54761874488800699;2.5692150258392634 -0.60615505133679048 0.47012066640275241 -1.3922367896367851 0.026060848014844325 0.27000335011584303 0.65385947531405253 0.024832471880879788 0.06151746532396761 -0.26599277347567496 -0.59978747896461393 1.1876769768829181;2.2088520586410487 -0.04102501395479196 -2.0371374091580692 0.8737432966024008 0.23539602140371194 0.28170213650205067 -2.0176120380384241 0.24208380851266911 1.3133554295995351 4.4600625958056037 -0.17611083205293127 -0.2689714859571693;-0.57882088099778595 0.26444446529202936 -0.88782099703459605 0.62084765934872377 -0.34376520656223353 0.81362223743506479 1.2356320786266881 -0.1650062739431678 -0.18490154189917846 -0.17558427126786152 -0.257836897719045 0.3280218502208348];

% Layer 2
b2 = [2.0834951652680527;-1.4695758507646124;-2.8227567948169647;-1.1700843142845414;-1.7489494407751442;-1.0731763414454694;-1.6168023068519228;1.3095883133566366;0.87271325463440741;0.59299552201934713;1.7592103864054964;1.6598896608744935;2.4567552451993313];
LW2_1 = [-1.3509574807111444 -0.72540991931229581 1.9530393606727063 0.17647174299543739 0.38481664952266714 -1.1494849643538962 0.0088600524942514525 0.12126097553086596 0.13430758503810727 -1.4608819035106231 -0.55117951488633965 0.010773636490888305 2.1212159416791927;0.99972020182356303 0.94841610984769842 0.2583007655473652 -1.018329630843642 -0.057774021318554351 -1.8999156563654493 -0.0097962518790224232 0.51529435145249458 -0.32940903527230297 0.52269259560870185 0.2461157599453126 -0.26197722070730289 -0.46028161706895676;0.10991405019941172 -0.66159836551367002 -0.5208774459541724 -0.97875821204123636 0.84445594477788 0.90171524299182093 2.0515636612853667 -2.536935291344546 -0.42126840622615042 -0.98307562750847066 1.9063572275996707 -0.39863575426217057 0.2296279393388953;-0.12738194972239458 3.9057534789213895 0.040087574057103337 -0.83145387298050566 -0.98851866600403504 -0.84221479110655917 0.93256367318685585 3.0789122565637146 0.073418282063926379 -0.45044222807645012 0.1773676473722558 0.47494160622887588 0.082899355179370943;0.68007393533355931 -0.10959197904062121 1.4923914187239895 0.9154064693997459 0.093464806460921673 0.47186925203068486 -1.1885253498879884 0.97303518410550782 -1.8992693554738442 -0.32106007474407428 -0.097644841659493831 -2.9369966388521362 -0.17972607863155537;-1.3658008276277018 1.2869781255040882 0.33255095012673169 -1.4615657741934216 -0.32890302069382432 0.59044897748036473 -0.25432755875906982 0.98643699586831146 -0.22505335679511526 0.58191540141202602 0.012067380721868099 -0.29336499027415019 -0.3533459609478482;-0.46214257963446753 0.14770652286837882 0.10143790620679292 1.3953046491464594 0.23595520562129416 0.24064752543785625 -0.88176550298361434 -0.94850977928761848 -0.11454632141504101 0.028860176675313955 0.74974999505058737 -1.159838506466859 -0.99334286616104661;-1.7039699276503384 -0.26018426880921286 2.4678697861880172 1.2884504572385671 0.6567799412251244 -0.48112010077819722 -0.31644419864021139 0.24365181008743114 -0.48188024880356156 0.39518598066969723 0.47151725809542366 -0.8411342608578064 -0.99271837985510303;0.23130395718725386 -0.088125853000229071 0.32916026057807829 -2.1692215177436016 -1.4873488417827199 0.61795703534963475 -1.6369630340387158 3.2771452451980081 0.47560163017394269 -1.4252904598942346 -0.73739559065172577 0.70085071321605208 -0.10995331541238107;-0.0091037939614493912 -0.18535973387251473 -0.079767714149690264 -1.2516077428419963 0.53175339597929461 -0.61560734263621053 1.42182842751437 0.92352340641584174 0.074046275788149735 0.03950887808054937 -0.64958651267505196 2.3809040479580488 0.66829881833042193;-0.18715420907515351 -0.30009466738170171 0.5891615432833055 -0.10615020135994255 -0.35414906628815912 -1.7267549587945266 -1.7988341281217637 0.52457627703683896 -1.1708717757129539 0.056497633186506913 -0.42525521724654247 -0.84686043967976188 1.2287308708992852;-0.031098393343430841 -0.55802433612676694 -0.08680959502226554 1.6550941392830378 0.21258082995569394 0.51733999313664791 0.17372497486096805 -0.055813624527547248 -0.27525565496591664 -2.1789727567609867 -0.51760866512807657 0.12442675478359032 1.7994240265304158;-0.040485052090943829 -1.4322508220934949 0.37142642327705333 0.22040315797017612 1.1645603665057667 -1.4337697534342928 -0.97567882318319232 0.37758207025803237 -1.0980151209731721 -1.7446949749437697 -0.51950988810192611 3.2579243239320888 0.80317237422341115];

% Layer 3
b3 = 0.67627681576864629;
LW3_2 = [0.34771682727620329 -2.7108909647034656 0.46484448339312306 0.47559904714660739 0.74366680886450165 2.3157246983957025 1.4575461952669511 -1.7252708382576338 -0.15489591039479797 1.371371144187236 2.6224605817232893 -0.16204806097080338 -1.2620597042667061];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
