function [Y,Xf,Af] = O3centro4(X,~,~)
%O3CENTRO4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:37.
% 
% [Y] = O3centro4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.281968137600451;3.74531835205992;45.4545454545455;15.748031496063];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [2.3116497266269436;1.9491767981179451;1.5303046581840114;0.82337614723235442;1.8280542894283427;1.6808214689858529;-0.59822963735310397;1.0845220267656812;-0.93776217330734901;-1.0988301880723772;-0.68171437837306603;-2.793104424323257;-1.2619898001174252;2.410790532165823];
  IW1_1 = [-0.83842900685878918 -0.62359047457325223 -0.59350356347328481 2.6500444991748409 -0.39038731584692404 1.0548191681592514;-0.66363102062115764 -1.0329413165066297 -0.095636746763512068 0.80605027887427483 -0.28356921831557286 1.9674168708871118;0.051551683231394793 0.26619944367024012 -1.2379879617638081 0.63621598547461378 -0.71928712439133502 -0.95139121056485743;1.563613163469481 -0.015880701363157407 -0.12589761702438201 -0.27879054115892266 0.26389414432713804 0.60012753178937206;-1.2369800084609335 -0.9109960669351902 -0.063109865123446351 -0.39829126045775526 -0.0032437252619846391 1.263939104182735;0.20638318947354653 0.51517535229411338 0.75368378018573068 0.86683532960900689 0.69406278211377781 0.7080829350048029;1.6144818349105061 0.36994042071632888 0.036093474859474298 0.062606696953211236 -0.24151998411017445 -1.0750731516740712;0.45193752677462889 1.9903261618199168 -0.042404547797939167 1.2793204458459324 -0.56156326864543327 0.30279870679503051;-1.1632948016605897 1.7709338130684462 0.01171948679717039 -1.7243968703219246 0.08705304333278327 0.4572022418282421;-0.40578682682434114 -0.010648005605630456 0.65419943367232924 -0.91194116158747462 1.6101224482129868 1.1725047094428429;-2.7396429283710506 -0.14722135566252267 -0.4990174792530368 -1.3716691682190589 -0.27448896735326861 -0.41387433135426788;-0.9512804480895648 -1.1348992758488154 0.12871715381075985 -0.17956824358913465 0.20883061760249791 -0.86981573696356396;-3.7245115339892396 -0.026428143227924222 -1.094322983370472 1.5264615313168748 -0.96545150228785459 0.54165017944812222;0.28595600553665051 -0.011000979621351142 0.25473594881160833 1.9106479874051672 0.078196899571804965 -1.9275413411733857];
  
  % Layer 2
  b2 = [-1.8799169243530418;-1.4358757460025684;-1.5802907342781001;0.81248403452340268;-0.29960647162950099;-0.60291366768002319;-0.20535216529450204;-0.062701676431375003;-0.23397864478538807;-1.4109652914601527;1.2064344898521735;1.0810923836086423;-1.3740582569559159;-1.3691004004292302];
  LW2_1 = [-0.026133485764997522 -0.61482510860129225 -0.67882125240421243 0.29805460363612124 0.30095679089091504 -0.054055274481971442 -0.36553870635847358 -0.40965340332549122 -1.7196238173519824 -0.32937694745598162 0.61567669140426573 -0.59724830548697827 0.13264515784630809 -0.89486411970306079;-0.09299946139532185 -0.79209854777613364 -0.17149213860651369 -0.16417401773340082 -0.19963358683676038 0.52881665233553843 -0.76333274379597782 0.44702768342380494 -0.086708061602381731 0.071206035587532329 -0.90443320912854586 0.41086343533129993 -0.62120164525724986 0.19986203412871109;0.12930735530861445 0.35498134619439498 -0.94759546492607394 -0.12210984109512707 0.090339269580529472 0.75291432313822537 -0.14579712807240902 0.23508053523415168 0.31022493734873324 0.078196491434153234 -0.032382411526938541 0.83418324796389887 0.31773427211696315 -0.71122243950228203;-1.297610666582538 -0.10889188858088884 0.60805963431526167 0.30497728421173165 0.15121504268360453 -0.7338173407993801 -0.55979458026726348 -0.27845554064785694 -0.51688925343505943 0.50342599057735149 0.77111877852198984 0.72119536021286323 -0.11673058474452251 -0.15631033700801153;0.25248888911339079 -0.055661048143105067 0.87752836896721154 0.61955507912965813 -0.40778995537164447 -0.79170840562191092 0.8238591181812307 -1.2112167541632091 1.1212325702590664 0.438760462631474 -1.7245543980896645 -0.074968555326447056 -0.68175417060258314 0.043127873545990257;0.17082775026313132 0.41333827471446372 -0.28104527912532035 0.82568800113282925 -0.25738107822486078 0.067933687163467676 0.63520815080999526 -0.016817769896514963 0.3745972425747105 0.30482106864198355 0.040503018084208781 -0.58728272729416875 0.33400807921209469 0.84695525134848448;-0.19374902044601913 -0.77588457066038363 0.24200033706620031 -1.4886357083616233 -0.25057874287817344 -0.29076286742278573 -0.89500208128310232 -0.45293115584016952 0.2858402595455905 0.34096189787357439 -0.55651647376748736 0.69375498493557319 0.49457168206541163 -0.33231887547368311;-0.1957856176977732 0.32800092624520277 0.21115605110670316 -0.41946621991895877 -0.43688107404973431 -0.37364917600426978 -0.48955545800367734 -0.70173242302920791 0.013850198848389086 -0.44383923365610906 -0.31779438581484404 0.2526931523897421 -1.183124398625631 -0.53119897344563305;-1.1640394439281401 0.86867261200110701 -0.45677111168882134 -1.4413467871189174 0.86880121983909497 0.020291752283433381 -0.65098052527893602 -0.75478728089705871 -0.50409329914466527 0.050255273851721509 0.34516069980455705 -0.87929303444175333 -0.38830685274944243 -1.3176135989330149;0.40828113463279864 -0.47428636021117465 -0.72799481763499174 -1.0449027160028228 -0.32469650735758893 -0.11052696489868172 -0.91330765496306765 -1.2953383259040252 -1.6054713357470776 0.209930744400184 0.17298273547642334 -0.18713155496329298 -1.8247865346720578 0.051408023480347315;0.24633952913981416 0.28151077054716206 -0.38793028668255847 0.11893057043900457 -0.67053025584935666 0.22784549464342008 0.60120785913395691 -1.1585354117430613 0.64012200236332095 -0.73644068883487246 1.1590097014743395 -0.44193551098672224 -0.05576096834068256 0.039164468656335806;0.76544103365949911 -0.43409247611830865 -0.63726489800824548 -0.0068322383509322043 -0.63418917940046615 0.38615357667097122 0.92401270950740122 0.47340694470827144 0.48187562854099192 -0.48282330885309582 -0.76582642803502854 -0.1500205952401899 0.047123501807282371 0.40599080867671633;-0.28020284760360814 -0.22693779737143788 0.24592609214634736 -0.79486590867907636 -1.4697843802295301 -0.21820285624046601 -0.13650956613233373 -0.7254334547065987 0.54281678275792722 0.10853183504791412 0.36048484157425931 0.061863032444032018 0.79528011969856227 0.61589438660407814;-0.72422018111736508 0.99587065771298011 0.012185938080281469 0.70414834473265697 -0.89445127731419716 -0.45682959592269828 -0.29224629576106698 0.051570985838406344 -0.32591378316771635 -0.059910689841033142 -0.15896752701944933 -0.22173871686076443 0.71119893757103236 0.61819613149327513];
  
  % Layer 3
  b3 = 0.58525746101216325;
  LW3_2 = [1.4029413499903198 0.19248225802944086 0.7728862192425916 0.30477081028787922 -1.1954365114272645 1.9476645698470543 1.187045094065412 1.0264321678333719 1.1544743583045385 -0.70430211594187353 -0.81022057038700579 1.1554657625107942 -1.268129599272434 -0.95205131616600092];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 15.748031496063;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
