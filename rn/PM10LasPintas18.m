function [Y,Xf,Af] = PM10LasPintas18(X,~,~)
%PM10LASPINTAS18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:30.
% 
% [Y] = PM10LasPintas18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.0251256281407;14.7058823529412;0.0179856115107914;0.00280033604032484;0.0558659217877095;0.00576368876080692;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.8567265241694348;10.399270228382223;3.081877189087336;1.0093338321229921;0.29585390269452794;1.0717912525093409;0.12302631911942855;-1.8543878326973728;-0.92583969502937136;1.231585035342714;3.1463575440614893;-0.26787041587183019;-1.923836687143502;16.348245103893685];
IW1_1 = [-0.19554072058724911 -0.3121642909682788 -0.78807117663845827 -1.7332279833165396 1.023762308202947 -0.68874575369686708 0.78892442272939489 0.030372099168243415 0.13797255767727359;1.8284397478643308 0.34865354014560862 -0.17669064290408476 8.9913910239018122 0.61968790282816022 -0.38092808646361348 0.48429964545682047 -0.19420800037910915 -0.40090581232957423;0.5312363646603937 -2.5027600232255547 1.8205760430543234 0.55238262415843353 0.12793033202224932 -0.022965014451340401 -2.7743570032215961 -1.0161717441228157 -2.467295136440971;-1.5619116922033385 -0.37698786299186771 0.02650595232237847 0.07530412985499442 1.6594098221967142 0.4807131825041594 1.5870874799207437 -0.10219593051813114 0.0069127821641169832;-0.79200321480890112 -0.80852360600396289 0.08212393671943026 0.018029745214721653 0.10048377032655804 0.18933273402427575 0.31095272807864749 -0.06548140981777241 0.049827936460183631;0.36966987947267321 0.65436568863367162 0.37167888488079648 0.28359711572796337 0.60957240676156932 -0.069546206258281312 1.3823144282203119 -0.053058168115122248 0.65104693717912121;0.66256488270886971 2.5619330931284545 -0.69307990232867434 -0.32718881610772427 -0.59012923981828236 0.47256824178673973 0.11951933327969205 0.085283226930310263 -0.2826361567266763;-2.1221514347583139 -0.16113549166129049 -1.6951462263165182 0.1565814720725025 -2.6485981882146898 1.49788037978558 1.6845363160665796 0.46791194321528851 -1.500784091469098;-1.1646938217031872 -0.52126827339545656 0.28487151742176237 0.035309984025132024 0.36014830805194625 -0.40119609506158282 0.018870817884141213 -0.015281556424963644 -0.40595156566461893;1.8358892142023959 0.047963635878484616 0.27128693385434244 -0.10599070791853167 0.74943918316715141 -0.47072932293359082 1.1650070223190179 -0.25734377034975986 -0.62629861385695196;-2.4147699017377686 -0.12513167539768238 -5.1475322088856386 -0.90435403700613703 9.5035871027981536 -4.1229534873849891 -0.76096595530397548 0.80755754637398491 4.8687166304188345;0.2579338610745443 3.5104565200149058 -3.55416603534779 -4.0294587320507773 1.7284288505383847 -2.24304991249041 0.85095379078833977 -2.1342400886082862 0.48423507143075373;0.257765710002682 -1.4576166520076661 -0.10102113436387393 -0.22563686200512112 0.2461098491182771 -0.12219756935810235 0.28540450753102897 -0.020677702454667154 0.17865461068420652;1.9670872797893155 -0.0051107554614216576 15.545347080825497 0.16678539851926566 0.3489671994542532 -0.43983713013079945 -0.16286471918694856 -0.19601614341954787 -0.84234810119085068];

% Layer 2
b2 = [3.0431026381809345;-6.3705769870325666;4.3157870599350696;3.2199143598759852;-0.15536934909301481;-3.7232231745040698;0.49448315812098254;-2.7791426354499627;-4.7173259332226731;-2.9117174835705439;-0.10877701569560549;-0.69447434811662567;-1.5287965860877852;6.3162511843201976];
LW2_1 = [-0.58870487099590507 -2.0876168001255682 -2.8503270484841057 -0.004779205527953273 2.1761627089550242 0.37232001462954178 -1.4529139204255208 0.083004781610467648 1.9109527142105636 0.47574794148253829 -5.4672030340762525 6.4527185131841751 -6.8637196819082185 -2.2474890418317166;-1.1593157344989489 -1.0863519058123146 -2.6804721284719282 6.6008447370675842 -2.2884673621492393 -6.0055713219118925 -1.0119009328665507 -1.0214124271451099 0.62081152057926259 4.946637537658253 0.17199881335547318 1.7747708377856082 4.7633830944926672 6.4984451879621563;0.53700804852480077 -8.7229889967483665 0.17955106751334571 0.68023352765246548 2.6231812177599965 1.5575194849772018 -1.2335624429549472 -0.091106546562361987 -0.232716365214301 1.9756803892313246 -1.9680378209907541 1.5760097094614034 -1.6874450297251149 -1.5062304576731158;-2.7163000017741279 3.2681299067687628 1.629424920024426 -3.5939233982375414 3.1473193672926398 0.39996935291312513 1.111836517096489 -2.0697318355091965 2.5781297816339079 3.5461933560738705 0.67167817209191982 -0.18687786181695795 4.8139620591882384 -8.502914427554245;1.0513842551299601 -4.2653577144527617 0.60203006246616542 1.9503841943669549 -0.87444622057256471 -2.580366539725663 -0.13129747041342071 0.47890791941350019 -4.0076066138077016 5.1558565253689252 -2.8454205941249198 3.7795334789855377 -0.48235312706363731 -2.0226236809220572;-1.2002907339069619 4.1042162325992519 -0.62739757660271633 2.1927019172357807 -2.5856902077313202 0.87202198843206136 -2.1809885372268001 0.71253612137921041 -0.30977197140948864 -0.24866370211564312 0.25656609754733312 -1.3133148595458746 0.72784172146997639 2.4535712601759081;-0.44017151870012072 -2.3694807279577796 2.582662776761707 1.4192312089235728 -7.6479743199332102 -5.6829248802782875 4.0082893024097279 1.5669442348736897 -4.7136817538426561 9.4214698228196756 1.0763171346761744 -2.5473966430279891 1.2897794442699064 -14.889266576904165;3.2644775938842328 -5.2542298854029408 -3.8096300180049241 -1.5396474795607829 -1.3838240088684053 2.0064121646758908 -4.2735618284881873 -2.1234480018505359 -3.2435458923481857 1.9520628746437858 2.8325949219022064 -3.5239495331670336 2.2513683944285932 8.7370858718525746;0.23718657359234843 -0.076658114535437707 0.0038022947309595805 -0.48045595923226309 0.6139033477301632 -0.14707325038207433 -0.63257494342712994 0.27620582838311836 -1.4344509166703356 0.67423160941237237 0.3088505402412009 0.36083959790303255 -1.9191641898204146 -0.2821075479010195;-4.9261760595429367 -3.2332318155810853 -0.48910006933418593 3.1117315233362879 -5.2070295988849962 9.4055880107383789 -5.8254733947012864 1.6649079322241618 -8.4569386670093074 0.88395661149757498 8.5317884045580676 -3.6157072620041291 7.8779454810440477 2.5115849126830709;1.4200533399437489 -0.41195003164634048 1.5178824281144623 6.6288629419254645 -8.9939443522577935 -1.6878019916719584 -4.4303431459217677 7.4288049796904385 8.5947016312678688 5.8345309121614797 0.94372145041694588 0.24194899980954288 -3.0740812398251762 0.55310589086669393;-0.34046505531305093 -1.4008990080608377 0.033663036982170602 1.0290779570139426 -0.68830243217573217 -0.61106419409174328 1.3454196497264219 -0.50394339255864495 0.53428497635754235 2.5040080504651132 -0.93478415139546189 3.1031163707601075 0.92427663912383207 -2.5102751512774391;1.2300067042432217 -2.3729053175366741 -0.2212197503013823 -3.1259567824315786 -0.2680751481338845 4.3189312473099273 -2.4620708945953944 0.23791483099655225 0.76371758520778554 0.030057669939882396 -0.70911605081456319 -0.075561890745166477 -8.8016554587649889 -0.67846047333592252;0.67118596787873674 -1.5269910948993077 -0.070442813815644434 1.4696543935427591 -2.8873502878930219 -0.16210714533395423 -13.234191618241884 0.24337840848815004 -0.39730567607512918 0.41787626395052968 -0.34973816912306105 6.0748204648339375 -2.9334618233624008 -1.0836112670028619];

% Layer 3
b3 = 3.6310250032114637;
LW3_2 = [-0.080746003463556315 0.035105831399259442 0.070164748057957263 -0.049324427641131582 -0.12327328993817117 0.12972115359836223 -0.093411269076895315 -0.036072615124075419 4.0253358987244567 -0.034904047803346973 -0.060548754457050422 0.19004952530215641 -0.077265297335597574 -0.47473101191191364];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
