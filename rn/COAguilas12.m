function [Y,Xf,Af] = COAguilas12(X,~,~)
%COAGUILAS12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:19.
% 
% [Y] = COAguilas12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;0.281968137600451;0.304971027752364];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.647346208632698;0.90492285888810087;-1.2450190673906865;-0.531772704807568;4.6276230915226924;0.99865433311545659;-1.2477836597566832;0.60394380712039542;0.4151108881035927;-1.8614290389962846;-0.15646667190709984;-1.0367297063249497;0.62750566810004682;-1.563566077296785];
IW1_1 = [-0.63416439428064675 -0.41379606310862443 -0.9422433439455401 0.69685360465627399 -0.303292291778267 -0.3009168336841983 0.77112183025076175 0.15046641769504832 0.073999885539885221 -1.039610221225034 1.1263437426307525 -0.53343870601360144;-0.10526162215478524 0.76903483001416828 -0.2521695375810073 1.0029629074808681 0.49478994365985424 -0.33837441938992524 -0.53898696531274382 0.11383664814848214 0.16762011289905926 -0.24050610017182625 -0.005688219320964783 0.1004994343376525;1.3586417956327503 -0.08091079293640227 0.42462714166459142 0.4172090626194298 -0.48402556761865434 -0.011685830925555411 0.35118670201570529 -2.3598735585430566 -0.11154042843179029 0.12041884524911514 0.24001849528955924 -0.08037667775581929;0.14863244781380472 -0.11411767039471413 -0.36726813495645072 0.045767848835661921 0.079571011927370816 -0.067561877422051345 -0.23712610683682525 0.50923252110190953 0.17912672375661517 -0.019146663986025277 0.065580603331673995 -0.061039096588411806;0.0073664958999769981 -5.0651695417437832 -0.043934616314162393 -0.8822814383403832 0.43450136837549214 -0.076875713060023568 0.94444754652194474 -0.061291033734250502 -0.41875177528345764 0.0032715383178568841 -0.3475898031421556 0.10048136991788134;-1.207254388849061 -0.73134332163604288 -0.16451575947318467 0.81054504255004667 -0.35907034137956656 -0.20130566065143898 0.51406233074499985 -0.54718098145258809 -0.09192927517270888 -0.28421483966147676 0.36530143229256118 0.36340997430116295;-1.1459070415872883 2.3371857781878549 1.4037863140670346 1.1426155313231172 -0.64128120703631619 0.5079432157133239 0.45364181559818867 -0.091441713771092406 0.50262606968955914 -0.54080816725108494 -0.78157706521261927 0.19551883298579018;0.47020749552945484 2.5951803109032925 1.3918518311694943 -1.0579061654588209 1.2924023963351465 0.81500708242614306 1.0107564332892418 0.51270314391683813 -1.7762744578366665 0.586538788103248 -0.67833002007885279 1.4598543031427464;-0.88646888361421894 0.95561863252188273 -0.80401456612037325 -0.10509961961699507 0.0037119130724148422 0.15093351245647443 0.59500568053720504 0.84985999551128 0.0021591581856365326 0.30344313291048958 -0.13101831356070018 -0.13843765800565033;-0.3471301420252132 -0.026660272184602981 -1.7148896893148862 -0.24231236664959405 -0.010962841584898507 0.0009409604787586805 0.059281274294066377 0.047663036433514119 -0.2563954962123105 -0.020049341222646202 0.17114475714603422 0.2485209109597552;0.57674754623024727 1.3366206392325937 1.0231340239675928 1.0812975185149782 -0.81958563390652683 0.61792393700020543 -0.06776408186945039 0.13313769043873694 1.1646480228156513 -0.46643566131794517 0.12713382317860075 0.49099248852518501;0.27746611013553057 -0.85509414992760013 -0.0051233970267186534 0.71854228716871404 0.086079357759977382 -0.26792920749559707 -0.93885615423406887 -0.77456359564746458 -0.044074770083195533 -0.53358937859395761 0.070427159811477527 0.45740576806518529;0.93756429987207734 0.25710043324517939 0.063088831765194073 0.20053632102963406 0.089495782424841616 0.23659969691847052 -0.33415790279327917 0.45434111783690861 0.26353474065967109 -0.036043226982479366 -0.24341681031930906 -0.28988767364818208;0.40068293953511025 1.1848456810237626 -0.53284864493434336 0.019664413770814158 -0.21381847392248926 -0.55731041861363584 -2.1545866605030217 -2.4111538593686457 -0.10345195602646474 0.88964607946573226 0.062320360492906957 0.49760205306673294];

% Layer 2
b2 = [1.4227020574901814;0.56412345496028415;-0.76386789900005925;-0.40965634618493529;-1.6164075195023677;-1.4421978279999292;-0.62346228075429633;-2.1267037514315881;1.503863512156778;1.2979381562908079;0.30961504323959338;-1.6630768567321181;-1.6972691743104924;3.2908079074933951];
LW2_1 = [-0.15298471187838589 -0.71306552242588539 -0.98885323666787406 -1.8349218129795732 -0.0078522205818710063 -0.69862199799988911 -1.1050617204439535 0.98052527699550251 -0.42861910542054737 0.82848727369315522 1.5100900520279879 -0.51902780203323262 0.64307562473667079 -0.026056786595378332;0.13601293509659812 -1.518434068096725 0.6328491971582062 1.1480710625323973 0.38902624691654653 -0.1549196266559669 0.98673515884009244 0.32857478676300428 1.6141354217528454 -0.62162191143892309 -0.098878219493181624 0.93071740170365613 0.061693275212640931 0.25742633923977648;-1.0522044056321964 -0.51018315917965062 -0.82645648668074656 -0.17122165825933688 1.5470350594000692 0.84319798740912 -0.014928081821862983 -0.15169093392870653 -1.3791244159300726 0.75524535233224888 0.25506499341023231 -0.89015202260637372 0.33831307029086971 -0.24008982352210237;-0.22170767384173859 0.17227777557393703 -1.04606962842412 -0.28361146016905681 -0.73304640390373255 -0.67686253784764983 0.022785094104879992 0.12636089111657223 -0.14541584876435959 0.63201633175219951 0.65695288088594084 -0.045387876501837579 -0.35444298423864318 -0.11648712296641331;-1.7651137598031419 0.00039150367106471906 -0.82532640039671257 0.28029493767558034 1.9560554384716535 -0.20935380119650004 1.5126453286183812 0.76222081131632624 0.62760970497007895 -1.9002263214923172 -0.34464204589943465 -1.3552093014766697 -0.82052481435370217 0.9118360051708313;1.1690171299823326 0.72569804940379379 -0.62595452850092359 -0.76509068448770534 0.42555901830360893 0.11278061052269513 -0.18787506229116036 -0.16352752778574969 -1.099631558806788 -0.10660664779153661 0.047036011607940922 -0.30706888128542531 -0.47512448755226944 -0.20722787592921355;-2.0747375600686597 -1.4938583037304636 2.2776715229851514 -0.68334674678070029 -0.75633161550116013 -1.0306641430924026 -0.65741788356613062 -0.067871216561178851 -0.68632033418175231 -1.6873437997576772 0.37683164767782712 -3.8674156268889233 -0.72656792303015538 0.77360581474649592;0.085177765273380418 0.70263546530935062 0.39307820571549262 -1.1018251514862445 0.83686218354562336 -0.61068161914715513 0.33717312510348629 -0.55166261456717558 1.0003921545296437 -0.40090426731508461 -0.46166054728741068 0.76157149719375983 -0.11615049141151342 -0.16858963299514937;0.17246475379660542 -1.4107905556353482 1.705396244892196 2.434260364184508 1.210783735629829 1.2375978173979194 1.1402117014946576 -0.69765372996927211 0.059993214630156812 -0.90425942660799985 -0.78176159509452015 -0.029634042285003166 0.07683007206438075 0.048256716209218224;-0.16764379876015489 -0.6131383845509607 -0.71369551253004115 0.066634776023009532 -0.53775910461432574 0.43887941781373652 0.19492734479267887 0.21041389774631378 -1.0591988880342238 0.44217997136246834 0.299086122790581 -0.45102334151111645 0.35574919803894933 -0.090521317172705465;0.13640918419398632 -0.6666441511531791 0.053734255870196354 1.947850690910033 0.82860539294784019 0.89264456760321087 -0.26502929444575174 0.03502467804894728 -0.88071525527286776 0.31582074073251232 0.29090539234494434 -0.94648044585428126 -0.32838627865335568 0.084535196946572938;-1.119131057652385 -0.20320796496481572 -0.20497000118185094 0.51135735028589224 1.7308893044122637 -0.17914912528149815 1.340670847562347 0.70234869890214213 0.97576786059820164 -1.98568635650526 -0.23435590634724263 -0.8052305369225693 -0.4158816542720139 0.80926132587374278;0.36006777724620775 0.55855406933995355 0.94358828785734217 1.287561444944376 0.42173263962728369 1.1094495990394033 -0.20400326375140815 0.14796687510726822 0.5210980651444731 -0.35094038952793799 -0.90873411308191632 -0.013486686814458873 -0.4389609836526836 0.23848215681628382;0.6250993147986077 -2.2290613580641354 -1.0370544356865135 -1.7449861785306737 -0.77908902964185778 0.65675656842869479 -0.22196360862225825 -0.77021554117085234 -0.64563029671301508 0.50488275418738504 -0.93831223584442403 1.3910849812571213 3.0377213699057397 -1.939952470814355];

% Layer 3
b3 = 1.214801618357642;
LW3_2 = [-0.86255417083614228 1.2465819612496303 1.3174965295074745 1.3921493815148134 1.4185230884235005 1.9705137621116686 0.32167665980245363 -2.8706174610261752 0.62825398588400927 -3.479536308668099 -1.5273161447538626 -1.8104190358899279 -1.1370910414739777 -1.6175733521439559];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
