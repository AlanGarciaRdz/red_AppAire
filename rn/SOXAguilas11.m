function [Y,Xf,Af] = SOXAguilas11(X,~,~)
%SOXAGUILAS11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:19.
% 
% [Y] = SOXAguilas11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.1187902087962192;1.4318768343716581;-0.83245865627872351;-1.2313205961774121;3.0842456575522661;1.0480685027427157;-1.4313922179480705;-0.23535939489475077;-1.9652366677744544;-1.4986899246632417;1.079497214143428;1.4123255840758229;-3.0023921144023324];
IW1_1 = [-1.0836070628670378 0.25431995227314264 -2.9466008291744554 0.39613963948273034 -0.81310757138878331 1.0648725145663802 1.3296630903781987 -0.27859071743622771 0.89228726561237592 -0.08574654471211722 0.15063814642175613 -1.0976675187436655 0.023908103260868476;-0.53689440737286698 1.297440293953495 -0.58114991509806779 -0.28995009498072544 0.33812367791263692 0.90809706993771389 0.47950246711690259 0.98215617934876309 -0.29465335531810322 -0.014514236468047774 -0.22400314065587687 -0.89861017645711505 0.30826644105438117;-0.40791464380962617 -0.76889788449619967 0.048555848767457277 0.47702750789763115 0.57090414301669046 -2.2231190519433608 -1.0460206533451839 0.89971014050322606 0.74766841162396025 0.015365358941228417 0.099149785820371539 0.11433652143604214 0.038661296821346253;5.6193360585176109 0.72898869129801225 0.51343426832214123 0.18491438455280326 1.5617801974624126 0.33653788333746421 0.85361992034263445 0.71147987722129091 -1.909165636477995 -0.12986094456185399 0.25342496158535172 1.0710594971656644 -0.28944610595072029;0.27698482372132077 0.033963849258368456 -0.27758667514866375 -0.25852069405216493 0.33959618863728069 0.0029542244342054338 -0.39335450193829674 3.2359289762315901 -0.2746473565613719 0.029609318463467166 -0.079833988875800066 -0.13183834948333609 0.45086670116736977;-0.2931108513939959 -0.012766659406226092 0.33106373317755455 0.26363795223864239 -0.39187547660153044 0.00639919467191526 0.44769465738584685 0.90098228848633488 0.31516010914832909 -0.029067599438599174 0.073608902631539477 0.15692294117970326 -0.51825911598810903;-0.17958185259984813 -0.67955795849416489 -1.075465134075924 -1.8109270580629495 1.1954117565992561 3.2909412409534862 -1.2706934961988294 -0.5454926353449242 2.0517164296059045 2.4103979740709218 -0.68428980987891719 1.2050606430366444 -1.3648431109316175;3.3284459416481327 0.21319021255130927 -0.30066252324174336 -0.4099301758513007 0.86027528154566402 1.2548411538944093 0.71983719629093246 0.48396715682358171 1.0458678236376695 0.080340701573617071 0.13312249722959815 -2.1037227955831415 2.4551357656806809;0.37946733695967499 0.043161594186221716 -0.30559734899377078 0.6171262709928742 1.1637536069693786 0.33757136441669505 1.824054531282794 0.052015485382444743 2.263165360390317 1.1545876140673428 -0.027738486016650077 3.9563470744554885 -3.5057522831213452;-1.9422602525934098 -0.49448625615950831 0.46088320272049371 -1.8967562777003508 -1.506831673983974 0.71123741885477176 2.6334719716614456 0.021819077882811039 1.0088361437690347 -0.44392642969711532 0.38900506401743701 -0.90796736737000705 0.28416253284943055;1.8635117732744984 -0.68783144757538939 -0.27693324559272964 0.76665608561626541 0.65452366959135877 0.38968345102932006 -0.51502789100676849 0.034759656771896075 0.43874280876361071 0.18405537725990559 0.081551800045994272 1.3669186879089443 -0.49275188933361097;0.070416512499328399 -0.20195890161803359 -0.33358649325452466 0.19328530220791434 0.83875888038089996 0.05862819573536978 -0.44218666239555099 0.049433561896128714 2.1383631091068493 0.1011323977236899 -0.032894974333522883 -0.23925221098195476 0.38938413951931095;0.97888874649701296 -3.7613590662644611 0.2733530012793346 -0.58135830526490007 -0.15811413612404995 -0.028692809344344219 0.1459068335757065 0.72648243338071861 -1.4447206615652051 -0.19989725514854767 0.43210537745274286 0.31080193048401727 0.81282483566627517];

% Layer 2
b2 = [3.7912655763628256;-1.4564935693570835;2.5996295319121963;1.7932548268000832;-0.16252171887850497;-0.26986525756862917;1.2504736857965657;0.0014473915873646978;0.41938497334681918;-3.9965980096499893;1.2132206517729434;-1.2825047732011303;2.4311649990312301];
LW2_1 = [-3.0570710721093661 -1.050695536219254 0.76573110160455538 1.6643209551951346 2.7468146706406031 0.32128764687797534 2.821594527830996 -1.69983300470677 -3.7019589647818987 3.1454958076870563 -0.80691334211242183 0.0098906747759958981 -1.3525937851719563;0.10422970997035037 -0.021825053947799218 -0.034317232526384474 0.084959891419819411 -2.2894022096097264 -2.1376646324409641 0.01191117461183442 -0.13295065454231159 0.057955434830580778 -0.14088163451585264 -0.20417042181718831 -0.2252710376396308 -1.9490204987052118e-05;-1.6014695513666246 1.2653760483397141 -0.65534083541387311 0.536720872929211 0.2229901283760049 -2.389837163503592 -1.3108386188301695 0.26068827480894824 -2.4613944791175602 -1.1262617877775321 -0.93163732661809362 3.81971465461088 0.013025450262936791;-0.99295982210275568 0.22413355122838052 -0.5677688601880071 0.41966816876819169 1.1676905397165709 0.23254987724855433 0.36459915060245324 -1.160587069364901 -0.86868489493159695 -0.6518969687757632 -0.48232159779364786 -0.041440207955444848 -0.77417685443815099;1.0817653240785063 0.0051124987453972301 0.63297814936295438 -0.32329488548997648 1.7904155076618189 0.07741757441043344 0.094610383840133927 0.033594352568156086 1.1151353076818546 -0.0047328235943985509 -0.74717807033404326 0.56400852236163634 1.3567769644977914;-0.15040710991663506 -0.55555359613889777 -0.951860333085643 0.84496904216928559 -0.64918828506477211 -0.24069419483795734 0.023344677483597764 -0.31038332261095997 -0.15016631327171898 0.64791439365103198 -0.12226139102080009 0.21109289602810413 -0.16555026756909152;0.018431442233618207 1.6511774128774765 -0.72330061488190778 0.23000465128884695 -0.37284901102595136 0.098222040689400616 0.1054726834032311 -0.91508903812729447 -2.4994360341786463 -0.88701606488305995 0.017305071246004253 0.36599207366003966 -0.3662511658934684;-1.0652943219246613 0.72096697916833041 -0.28919124038727789 -0.52154624610749367 -0.98916922630449355 0.24248172670018708 -0.2827404658476706 0.21794426363537392 -0.046296813680659452 -1.0030748182948832 -0.86601491947568898 -0.60809036311648101 -0.1098449833800012;-1.3489990460745598 0.54142222567529708 -0.2642849118270304 -0.48604777283277945 -2.4450737252278594 -0.12443320023540644 -0.10415828741059732 0.38715687138951582 -1.10275264365042 0.43882479763438798 0.71878096484579679 -1.2936633174388132 -0.7096640066589045;-0.22891099877500284 -0.21243803684830917 3.1033218091789996 -3.6600244522129008 0.72415341007390366 -1.1510057940916252 -0.0015737566035887267 2.7306605975820109 2.073009466788295 3.0140774705785676 2.4209687272898281 -3.1289557063693176 -2.4942353820665222;-0.080899977185288754 -0.049228570943574732 -0.5522871483998848 0.62501439478135257 -0.49229329900277807 -0.019828112733823202 -0.00016434537235164408 -0.11590597655450571 -0.3326487185276692 0.45281411187261256 -0.065641556807081253 -0.81873953336274519 0.63491741934098134;0.8947958495834768 0.21680213293805961 -0.071967017562900304 -0.15996141792114563 -0.095408952125173252 -0.21599016326448525 -0.26066505053971273 0.87406297020517265 0.9760895938365689 -0.49677773864084313 0.74530626074926054 -0.28790812441983815 0.53338958121312463;-0.46954741574285147 1.3102163057658516 -0.37568283643579781 0.56907526154425625 0.039436238319215181 0.11125642581961644 -0.39701170267315988 -2.0485113400842612 -0.99424937491646115 -0.82409884699976232 -0.11240931190512587 0.67845362997583547 0.89995031528617198];

% Layer 3
b3 = 1.0995489635362943;
LW3_2 = [-2.67290952536825 -1.0034474218763241 -1.8484880533525239 -0.535570010810695 -0.20987325233754248 -0.10761285916975499 1.3771707893148732 -0.018654157316475163 -0.1846129734515968 1.0452690293976781 0.12303598926000896 -0.70707688539044267 0.97920097312223631];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
