function [Y,Xf,Af] = COLasPintas7(X,~,~)
%COLASPINTAS7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:59.
% 
% [Y] = COLasPintas7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.241545893719807;14.7058823529412;0.0179856115107914;0.0558659217877095;0.00576368876080692;0.212765957446809];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.6296886576500866;2.5525571858544693;1.2580587204311731;3.0304106662470702;0.44086498679340469;0.60484468767018429;-1.0217622213795405;-0.88430668132838941;-1.9559549312297211;-0.62457117975150322;-3.9686435301832108;-0.99880343727746479;2.891872096458219;-2.6144699096966697];
IW1_1 = [0.93517883719860651 1.044283486511371 -1.0087480849497439 -0.081068843792217474 -0.22978949846715246 0.86214996571190228 -0.21496681401548037 -0.12767185423196678;-1.1054859731657296 2.0980519472585235 0.85652117359138746 -0.26504942312066754 1.0335926260414019 -1.2675068770974605 -0.46691204776117923 0.022298356691003662;-2.3428705808110495 0.0025732518998746075 1.0334378258770067 0.88419867087780257 1.5571788001055971 1.661264778644209 0.21313328235805579 0.52540517160657396;-1.8903150480155744 0.36018466623076972 -0.011003898892549718 0.82423402395389433 -0.31365452264020816 -0.40055274457443113 -0.15113719381964169 0.3018569648079521;-0.39130110696912962 0.26532350932944254 -1.2785592713674563 0.27450912896597823 0.85945349399188975 1.1267807248861643 -0.41268842748578438 0.30814689461311262;0.31929110679721101 1.796643782019447 -0.12916479233886488 -0.27823612356808569 0.44426428065909851 -1.314988999405647 0.43460787759051323 0.047010985313286277;-0.357095440452395 2.9213217527161119 -0.34833397692149881 0.39172765842988733 0.42499254060699859 0.66505469749001722 0.089669777594330577 0.13278502221891256;0.66659914279596022 -0.58403942150319066 -1.4036297948960108 0.72054243244326532 0.76514373773251432 0.92510001505771378 -0.28145770857060104 -0.4959747027244974;-1.0241140423630757 3.1723756564581973 -0.92010856607796498 0.22843400102003328 0.056633081662491237 0.6806573676509946 -0.064510675923590055 0.34011102945975302;-1.5992150962249487 0.091364074100036177 -1.2498526490724704 0.14237725692985764 -0.71898023140782086 -0.85885343015058579 0.2023320966469781 0.2406812122991924;-3.9950577924613802 -0.71283357911823109 0.45862167520829966 -0.30936697395320323 -1.2321145790489054 -0.48185986123176672 0.090855223917382044 -0.36244162747319869;-0.75481417352638702 0.302579007823566 0.33988369063355489 -0.57324356773261298 -0.79731481457078046 -1.2195160690201814 0.080600937315644952 -0.17668469012406476;-0.045372962331228929 3.2629062512258713 0.060933697547785437 0.26397923723810635 0.094967844342708135 0.25111385719517471 -0.13194969874560081 -0.05688591444626323;0.1203979373908944 1.8740395611187417 0.20527300548955063 -0.1333258414791253 -1.2422331766910086 -1.3732698320132024 -0.41568699175818086 -0.39343698542951439];

% Layer 2
b2 = [1.3126550754118134;1.8359369103307703;0.80628579734785044;1.1507306732089915;-0.54775032744154084;-0.64238548838180964;-0.18660700270773561;0.13945354146789243;0.12819422408016845;-1.5470417309308915;0.3115962795972832;2.6675892377137322;1.4577087843131618;-1.5012250705091854];
LW2_1 = [-1.8320761503221263 -0.14765765843518228 -0.42363985620736144 -1.5931983821542917 2.2726337625765027 0.1906995154611312 0.76814111306212352 -0.17870127352786927 0.22791368957245323 -0.222876915115782 -0.67589820143384771 3.3621496160847895 0.18305341317254192 -0.9510946889110683;1.2822272223631834 -0.19591696647080828 0.112040653564891 -0.044322634496661691 0.71484547534557963 -0.5506357677039857 0.86677408595535588 -1.1800599776378506 -0.4575104827694646 -0.6039442934372854 -0.67576988111630643 0.67050482937168154 -0.089205394169062993 0.24733081482111327;-1.4715871030452494 1.3728481029683752 1.1120401900613845 -0.2015510012846663 -1.3623012905299066 0.078020329981494482 -1.8362900939801683 -0.3108517548343579 1.1451278262354341 -0.84902111690912352 -1.2959157047304586 -0.050071310028456745 0.59230665781055958 0.87672406809742986;-1.8119042001899008 -0.14959404403423587 -2.3650770887499877 -0.06535208246070795 -1.8726934943151101 0.28334480111702393 -0.50196820756418981 -0.19115448767399718 0.18741638842646971 -0.76284014694346858 -3.4810671563548357 -1.7252311615305014 -0.56258322781497216 -0.0054638506279000767;0.7530800030381174 0.12435739655788258 -0.1382480715247805 1.6177760285854954 0.77548486322548738 0.080292331370786188 1.1994189567287299 -0.74041880178222763 -0.54776644108570882 1.255623804135745 -0.44426354633835524 -0.44633630571632582 -0.98287079801352517 -0.13956891137192937;-1.5662308851499798 -0.084067801681857207 0.1660929184946372 -0.35413138777911507 -0.62066209425722318 -0.27607263979422997 -0.44078073878459528 0.73118319149468192 0.94101832362384219 0.013829952728200867 0.55759176111374231 -0.26913953391232948 -0.97208160191446058 -0.11716525816149617;0.06518521331481951 -0.9319527629637907 -0.12192135699380952 1.1841396451417443 0.57450184811250793 -0.82605207322493168 1.0104929326397081 -1.613113375004755 -1.052275569960796 -0.90482274247811323 -0.30419979853172818 0.53658790725599415 0.50969830832832885 0.2020880138434859;-1.2478661029189209 0.22359463712929478 -0.2398377867017796 0.37415515021340839 -0.5518871982282989 0.44664596561610292 -0.80000844818098715 1.1395211008948387 -0.18749776237395388 0.47574535576645643 0.411842554911306 0.34579862324459698 -0.073727390377623686 -0.54485139631291912;0.88212980170314814 -0.088299492439002272 0.37862302673652454 -0.34495488533268998 -0.57796456376776972 -0.2899916628282922 -0.74474662816252168 0.52579194783442917 0.49061490800356544 -0.29837484023868299 -0.65473568063358123 0.16643265212162839 -1.0037378623233979 -0.27228769883772763;-0.29111664852073238 0.68270207073327616 -0.60936627356076578 1.2560614064302993 -0.23492787362005291 -0.0041849477740663662 1.0064060845412113 -0.89458695372338537 -0.40508644459250764 1.0547412280209709 0.84132605296988283 -0.56984570640360854 -0.10180898759310557 0.194208689231856;0.26323167758091109 0.46491472362085073 0.058083075932764648 -1.4500871255447767 1.1701809794655176 0.034643006989626815 1.4221684311908251 0.746674766159935 -0.53829112450750949 1.1927554457529987 -0.48287391541379554 0.64094526774961469 -1.6155537240877629 -0.18031039723828748;0.94118248962960982 -0.25287625357187477 0.13862196461071499 -0.83305600125518608 1.1550714392634469 0.45059425540952169 0.037717464752860246 -0.24163806287693909 -0.60284362923144597 -0.47040407236183956 -1.1572731611478093 1.538783306361263 0.74867494116257594 0.92708136328101909;0.89950994425383879 -0.066378637666267018 0.23083678378930791 -0.42326901667663291 -0.063668480902165273 -0.095878557155351304 -0.27914134415161423 -1.143408889497781 1.0678665467290014 -0.85751466755208317 0.39682192994011656 -0.92288931421521481 -0.66447816569770246 0.58406809364991708;-0.64070991029542534 0.48864259238246993 -0.63140146927734186 1.0967745686381389 -0.24301956629924479 0.1234249680230361 0.9142925647643787 -0.47474710871091896 -0.39561214288777796 1.0258320688100422 0.36345402721246289 -0.50695446224376062 -0.81558054936940216 -0.20731411328717506];

% Layer 3
b3 = -0.8377864353500577;
LW3_2 = [-1.7875071115493562 1.0748902973278505 0.27711141574047643 -0.28047666944461186 -0.37926661328178235 3.4616328393444098 -0.57550675466479628 -1.569137638119952 -2.4719672181388681 -1.0608916959995007 -0.83331421974920294 2.3894825035567644 -1.2620293571606034 1.2883774015738383];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
