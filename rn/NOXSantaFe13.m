function [Y,Xf,Af] = NOXSantaFe13(X,~,~)
%NOXSANTAFE13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:51.
% 
% [Y] = NOXSantaFe13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.4617837783584131;-1.3927510609636984;1.3711608048359583;-0.71283908149939512;0.18091299350658413;-0.59831954328492554;0.28111214222369674;0.20716330824151288;-0.1077074966642903;-0.85065242737924451;1.1450104185245686;-1.5278406169285954;2.514778540122836;-1.9121301635767229];
IW1_1 = [0.0082646335776587615 1.0033312274526094 -0.18843292346696916 -0.23955382709591436 -0.45648957756070824 -0.77911870702054153 0.080672181874171481 -0.68235466542314827 -1.1225102856801945 0.19056491411545809 0.45588686347810714 -0.73737824491360848;0.19446970534407793 -2.1221705655869574 0.22413097853827679 -0.70902071023944768 -0.14274518450802459 0.24224350570874567 0.23776648654295757 0.29137405490766749 -0.28967251168212532 -0.40719376746162173 0.37318393452946469 -0.8033221916716492;-0.041737430604425557 0.47462868144612985 0.076897496595383266 -0.47848499361291053 0.065454072278727404 -0.14069578032202198 -0.20474181413321418 0.30728989971018866 0.075138722987619158 1.9279152985946377 -0.40176171312259223 -0.17002216510821463;-0.03804450086433963 0.51068967994798664 -0.12799890210866813 -0.12071848152730416 0.1265230576286433 0.29019053451684618 0.3886360124264866 0.075924949901515285 0.67635242164419995 0.90987451155847654 0.83081838820565346 0.34820531800457361;-0.93641923835119911 -0.23816559447073743 1.0122279569325145 -0.99864239780940645 -1.6602266967638952 -0.069909609472698683 0.11475230787129335 -0.56661681856063995 1.2377081200354765 0.51884623677725228 0.38478902487201372 0.73600125475020883;-1.7954539610872173 2.6119093612080468 -0.69749533759947724 0.038533140451756168 -0.14442979169927517 0.25255361065875731 -0.26351918588818468 0.30499142658446682 0.17892188458482614 1.0448695292973518 0.20499897278193946 0.28485976694874249;-0.12846588454885405 1.2225006485279819 -0.096892177785389985 0.15450488625982819 0.52794075002249141 0.072816904073714522 -0.14447521059423518 0.36651309326642179 -0.47873565614729652 0.98786274819770314 0.19000806791620425 -0.3403851526595888;0.78674133826760217 -1.0722552551624056 -0.47062492441039705 0.84936373284871214 -0.42228484382046427 0.22770214880122869 0.29238160536726759 -0.41365105022690141 0.29983453172781932 -0.88995117884657582 0.49195181170004393 0.39735707633783618;-1.234534267263028 0.21429242665365397 -0.040560525217406364 -0.58392479378058371 1.056039880972411 0.53736787585996304 -0.26375646948744569 0.90408171971063778 -0.36208331050111653 0.31674015495111252 0.2364396040164822 0.25623548432442661;-1.0780370381980189 0.78910234942226998 1.0521441084279792 -0.013441103337132776 0.67140807048716156 -0.026928254279045397 0.63717400617286646 -0.12002267216910067 -1.2669762881628079 -0.14950518740157204 0.033478139328307954 -0.0064159007984605117;-0.1036290633763659 0.46746993214639448 0.63573034466968537 0.20708481796621966 -0.39149478625099587 -0.1518002356496137 0.73076502671447863 -0.94404373320208779 -0.49499453323789577 -0.20815206739235062 -0.85294986333928924 -0.042955586698789357;-0.37971300112730882 -0.25091047600091676 0.11435181968059051 -0.34166128561842896 0.46418453921930908 -0.64132769769781162 -1.2853551392876108 0.43083317749388694 0.59958214615611782 0.76477880684775557 0.51948003113495322 0.015046265173768211;-0.090856534469425612 -3.3075976777961769 0.13581737333661936 0.098668630181453401 -0.034475794746411575 -0.11750234426981292 0.11655528418945572 0.021971295094472296 -0.61367939200526944 0.4428049638541765 -0.05231208156833049 0.033315971073743261;-0.65454765273298687 0.39700181235806176 0.56796110022717716 -0.94434311872974508 -0.23907611762031961 -0.076086948033290344 0.023061891636225788 -0.18386726545586202 0.20185135502759921 -1.3820409726846656 -0.48715382138565011 0.134270240910212];

% Layer 2
b2 = [-1.2613953455606866;-1.9068921641794823;1.6549804249943207;0.89476992249560339;-0.23549162244058622;-0.4559790887325425;0.44150523973691397;-0.35617921806598052;0.60399837877359441;1.0265211889225345;1.2229681841031881;1.2522113525882324;1.5225543106382327;1.112453311018559];
LW2_1 = [-0.0073845713203970556 -0.29650947582507275 0.68338677509544121 -0.21802331218279986 -0.070012369385256096 -0.028753842587398243 1.5990218217539247 1.0254258026258298 -0.95122359860314887 0.17207643865560582 1.0799776314752849 0.27095435704271148 -1.3685069829262069 0.53787965770107815;-1.3001940637890148 -1.7601911122603096 0.07726430167885856 0.1774078104917213 -1.2823988791482293 -0.30131794108586929 1.1886862860746916 1.159141214072241 0.51801841172690755 -0.12960117864451484 0.037895052753892926 0.3845406022138052 1.2757976194009513 0.29954638901453917;-0.41498568008213249 1.5178809063080518 0.17602924411744034 -0.96503471154647735 0.11750897887294975 -0.39221639211067566 1.0272262817003579 0.14676945504742972 0.23646864440914264 0.42606389342926848 -0.51225066258970564 -0.71271283274563568 -2.0076057584261959 0.081982970791504184;-0.16477859807576281 1.1669997992053172 1.2504256754954601 -0.33804580593951294 0.56197167221270006 -0.061321163089631023 -0.97163146729390204 0.13227577573813934 1.5111811207628942 0.45595226063222449 -0.53123412893007826 -0.24874237722572382 1.9895366793494875 0.66123532649577499;-0.59922089472191642 -1.1849996889190182 0.9568882812739945 -0.25713287009368396 -0.47175831349157038 0.11639462621183931 -0.58905459331206966 -0.37059360065225128 0.46868841931355532 -0.17710268964146086 0.67649165507460252 -0.3358438771619478 0.61821112209658136 -1.0810075375018151;0.87842183701084686 -0.6524861251439491 0.21289492567182544 -0.57749555784393436 0.19948768528483385 0.011813079099163459 0.32533201115851307 -0.55225798891800804 -0.60129081416178376 -0.73420960197202223 0.22789811437555685 -0.39062317457497786 0.64412490229374131 -0.47884507027476847;0.51995894608356397 -0.8313479187094448 -0.40739857602240931 0.30869728186550294 0.2333617537528139 -0.71766289892250668 0.70288190778219184 -0.24452014198443187 -0.67931607104528124 -0.667616490209336 0.63619256739494512 1.1144113092041754 -1.1533870679951113 0.3978551968680239;0.46823972413394543 -0.48777713701422243 -0.65346680536889079 1.3185678355423986 0.65014502373361294 -0.61936763333440581 0.072687234858859084 -1.2451096270357322 -1.0480940922595861 -1.0054789937393922 -0.83412321607748829 1.0527822851482167 1.2927140697775972 0.59179114396504118;0.65694705901545236 -0.07445383314104595 0.34833183578955357 -0.34076618860282354 0.47695763458494683 -0.45207150305605831 -0.00051824740206863479 0.13053879487400272 -0.49790812645573973 0.29482855768294819 1.0203876642102887 -0.85029661441713833 -0.040490182716513654 -0.27769483805395023;0.41682713140422356 0.44905614292069934 2.0683529944963639 -0.25434270785700874 0.56540263996908346 -0.046608460917059231 0.41358414096547913 0.13494844575323262 -0.49159978346411226 0.13731829341055829 -0.33712841967601515 -0.55339204505314932 0.23567424569651174 -1.4529280119984544;0.62123851525657137 1.1260123314086778 0.65523192373247474 -0.13053070838446432 -0.37194134067073792 0.8630304446796484 -0.013971725204263832 0.61103920311125137 -0.066220978647518261 -0.24924784893116539 0.014003813688903535 -0.93283962475203719 -0.37165832965016105 -0.79810241807878379;0.66654753489908725 -0.59178140973012527 0.037810932243116907 -0.37013052179289657 -0.44602650245107556 0.59586857533956716 -0.99436837103572984 -0.17864713329452991 -0.19944255223505919 0.1350352767691213 -0.58203864339904998 0.1682171986972702 0.0077125832770025063 0.2172303651769294;-0.19137457288924475 0.29929325606059709 -0.52315941785774567 -0.75234574230180495 -0.28429170482507859 -0.18022272742941853 -0.52222424353714636 0.28021583464147243 -0.42324166603982183 -0.77703692750845321 0.46711555960340084 -0.5883316106850992 -0.70960517884515806 -0.16883492676996836;0.64367063699914839 0.63123626421942824 -0.41747774654321074 -0.52813025739149277 -0.2341961013314337 0.071811344406306682 -0.68299754936737489 -0.30649897067939003 -0.17276729988669579 -0.43093520402781493 -0.050715003251876847 0.087563181790589112 -1.1907280849125621 -0.52739962337622159];

% Layer 3
b3 = 0.99658025176754483;
LW3_2 = [1.9523259250937188 0.98997408221423988 -0.7454561459485034 0.68082911062842988 -0.141413296061177 -0.49659573174225075 -1.1775539562230755 0.39182527868032452 -0.024968541150888396 0.92262515938093348 -1.1279430704224005 -0.075824965795319985 -0.38386510246302069 1.4495136035135598];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
