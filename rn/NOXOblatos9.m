function [Y,Xf,Af] = NOXOblatos9(X,~,~)
%NOXOBLATOS9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:32.
% 
% [Y] = NOXOblatos9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;-10;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;4.05679513184584;0.195790504160548;0.00618238021638331;117.647058823529;0.141843971631206];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.404370951487496;2.0092290302512819;-3.6510746895604442;2.0081072218020486;2.4256097081949535;0.090363835157167255;-1.1050199137145023;0.50133832068494866;-0.10062629941823757;-0.24355658355093626;1.1431036835762618;-1.0040577077816886;0.80237732227866709];
IW1_1 = [0.79684337896064505 -1.7472946722635452 -0.16136915272013075 1.1857512221840227 -0.58900939987035339 -0.14264613292065725 -2.8877614135508809 0.032536298884324036;-0.88288337650371962 -0.25604925989860572 1.3651908522553093 -1.2168426871340725 0.040387470650538736 -1.3897592421786042 -1.6838986868720187 0.75644231401696216;3.0196944440056552 0.045471736024480472 1.4532527056019175 0.18729888721006205 1.4159182381975572 1.3043839031741582 -4.184486138616422 2.7166243220367985;-0.15294702570365071 -3.5639836519381007 -0.60081592951305485 -0.27829197643773623 -0.23409601866634766 -0.27582196579702839 -0.48467450187877692 -0.16366553457574876;-0.11710394222184858 -2.2255329081690816 1.2765796470965163 0.087417236181807495 -2.0112935951875692 -0.021723072897994401 0.21456835633961188 -0.082393803230858112;5.9517569131953882 0.24838482867471212 -0.034332424569296 0.35732915532786474 -4.5726305016762963 -0.038342161050297738 0.58796174195409945 0.34071027556136957;1.5129707898794538 1.9542096004807759 -3.568485232954496 -0.57533628816645688 -0.15575149546883302 1.2248194381505313 1.9957456451538034 1.6736671442910647;-0.79407347304223219 0.076807703250206319 -0.090043584881992378 0.77484819649900993 0.5491758393170697 1.6206294655071964 1.2855168723028363 -0.2511916993004385;0.87634589480028902 -1.3123915676647333 -0.23625070227116501 0.32328718516317717 0.12697108087061448 0.0031559962437722518 -0.24016313384464577 0.012243468610782168;2.1890714129212854 0.073000073740657784 -0.66990328458028958 0.093116350896281896 1.6673360130140018 -0.7617892958359892 -1.9307991984923794 0.55650284559981422;-1.3731557047952285 0.63634513125332048 0.21510560841152748 1.8832918498355116 0.77316906374769478 -0.67577203435306565 0.0051455157815103458 -2.1982408686432655;0.70798100443093914 2.6060230291210695 -0.99956833032459436 -0.56341546826415478 -0.39371475173275244 -0.22513501098204988 -0.46827217315166592 0.27950190628017463;3.1812744615964554 -0.15699838983663369 -0.42039504832488778 0.46513449439496168 0.1755785456303611 -1.6455219539546173 1.0607788550224899 -0.10154581341291276];

% Layer 2
b2 = [-2.1224348213819324;-1.5916843022622373;2.1425893682671564;-1.7410155671823671;-0.40409630755765696;-1.2392341297785361;-1.5480416885815875;-0.6971215557424606;0.093946283191919375;1.2267078283017963;1.5708238550550619;1.7576966100607632;3.2098679471611207];
LW2_1 = [0.73333239127664596 -1.1018957388409967 1.4147768177699487 1.8226448743088879 -1.6545296812587065 -1.1587955733081949 -2.0020361950027832 0.23416501925863703 0.71304875122593625 -0.96101867289410503 -1.711546954709251 0.11219589287864908 -1.2085725931819278;0.21360698147733304 -0.21495711014882771 -0.65077424504910353 -0.043270549516251429 0.65261121089183782 2.1204658568832655 -0.38408144518278975 0.49350194725866303 1.2283518959221644 -1.409478337525305 -0.57531564653828393 0.03912837562571396 -0.45166224561382107;0.4705669920502879 -0.28158609103908827 0.2201076146156444 -0.065480708190023718 0.91777154542249817 -3.3670293396073352 0.45445802443465816 0.096369919433215961 -1.5527628359445775 1.5203332742847839 0.30918533813277793 0.25839538072884133 1.4655522454713261;2.0273056507230609 0.24599398444898413 1.4487700359666269 -1.3970719785447734 -0.31534593438597691 2.9710602505270733 1.6195593913456556 -2.2762835383325943 3.5586902773851992 -1.166934289985474 1.2005609045883983 1.8898345074540879 0.64583148485304154;2.0495267347179391 0.45475035807480124 0.82076538657969256 -0.56205173821897669 -1.5417947873199791 -0.35797084334162177 -1.3666371728336593 -0.49826755848323906 1.7745972783931117 -1.0701671617329582 0.080054748899145711 0.14630640815127643 -0.44000716407830015;-1.7658788266970071 0.99739371089886864 0.35501547606370343 -1.0712291685561541 0.22917428203231141 0.30559182064461687 -0.27556709184705813 -0.87002652795144031 2.8217930522345558 -0.72905631673927707 0.39841763360710669 -0.16192197928372895 -0.86443504029885565;-1.1190698080395745 -1.5567001000632386 0.46750809429766516 -0.40683501572954267 -5.9608833694275249 0.88405308110600556 0.43689067773952683 -2.7699831988648769 2.5095577814037999 -2.8270645128428993 -0.30694219059094391 -2.4989458305114236 -0.9850765235296195;-1.2704833481575399 -2.0144431057560337 -2.158257794264721 -2.0379336335485259 2.0239441456364107 -2.2426231752730632 0.096395157423384989 -1.197628617974158 2.9821278640107378 -0.45146825844019361 -0.23629962057802437 0.24827912767244725 -0.71755411955991377;-1.9904524896586504 2.5309661448072949 -1.3540490323755394 -0.64374733969906994 1.2495177847980203 0.32100819990735946 1.360864459495096 -0.68590154972413531 -1.8860966828852064 1.4268152938396852 -0.4152716364741465 -0.45535281320765858 -2.7110572777031998;0.10331499088631477 0.3997580836615805 0.14038501165702669 -1.3117664935866911 -0.033280918747289182 0.45689283703784689 -0.50529871820768057 -0.75816317717340742 2.5535143628844073 -0.68908345453198971 0.31788578812762008 -0.1114394333256527 -0.81083497681353855;-0.36675196687196399 0.95308100398556594 -1.7418445322207461 0.96241531645543743 -1.4945179807080939 0.61347548583868139 0.22655640246011635 -0.20468191608309394 -0.35823887712750113 0.62725806704073117 -0.18465345959408358 1.5538013762250102 -1.374441733535027;0.37536034996206658 1.0418405998677727 -0.45905179525412876 -0.13214846533364383 3.6389216012664765 -2.0046161697862148 -0.27822551612795932 1.4423468993696491 -1.1999423556283972 0.40463122866898232 0.77364982751526579 0.977465439466771 0.48381186247587227;-0.091252450481981398 1.8025940495618342 -0.44187046076393477 1.060100340401485 -3.5101800478481886 -0.024836556385049315 0.017031194325408533 0.64367119529451688 -2.9262892677250734 1.2820766579613871 0.045844755658433101 0.75715952450635449 0.76839050682680765];

% Layer 3
b3 = 2.7645609683532473;
LW3_2 = [1.3108195744374804 -2.0785723749413441 -1.9594069772681995 0.51037868678680132 -2.1455491823186543 -1.6448863249680101 1.5156118821562112 0.35399736166218226 -1.8578836840430371 1.3508278957474031 0.58051863010823301 1.6213203232292546 -2.9369257395278199];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
