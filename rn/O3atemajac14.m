function [Y,Xf,Af] = O3atemajac14(X,~,~)
%O3ATEMAJAC14 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:36.
% 
% [Y] = O3atemajac14(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.201288244766506;4.04040404040404;166.666666666667;0.0561797752808989;0.00614628149969269;9.52380952380952];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.4954127365004508;2.7575739082550319;-2.1380112962786431;-1.440993097670471;2.0578322225933419;-0.34928350886454362;4.9691480921036861;-1.2887319273860993;-4.3535372028008279;-2.3554391902790299;2.1686487771703282;1.6575147770443883;-0.11798430193663173;7.0659365955347466];
  IW1_1 = [2.1529391063707557 -0.80349864582029873 -0.04107140269203699 -0.30607219589135048 0.27137085356341922 0.72795707067135462 -0.020588859638912039 0.079947043986283661;-1.9480748809261972 0.97473391100949724 -0.89571402696910141 -0.85748416422353191 1.5389272547654644 2.0597398193966749 -0.81167255503092339 0.12177622882344011;-0.023629881202988083 -3.0603670812087556 -1.0311352288276303 0.64382267807290539 0.18812204989004547 0.75727579519684995 -0.10507355548357893 -1.1758556790140258;0.75117486150889834 0.84634459325722244 0.63349486666122867 -0.80073353637268985 -0.41367814232934003 -0.94109695588194775 -0.2483169962491302 -1.8264373468254831;3.4057142582046849 -0.34064684970118403 -0.24868960367077947 -0.61903685962260369 0.3171257491444634 0.73572352982309253 -0.1350486314563642 0.029879226410373657;-1.1785812171395105 1.1262502767615017 0.44014454936623387 -0.22269978737783297 -0.2311801857592948 -0.42916613369125628 -0.053423146735142563 -0.77056886081748488;0.529617255660638 -5.5662364283364569 -0.15159349108720244 0.40392260529265223 0.21078037073310713 0.9534720205029884 -0.022661876147573989 1.8321524439061661;1.0473141726306792 -1.5156979509550836 0.055598177358134833 0.043462775439665501 0.31243833371390423 0.93106808331596191 -0.17672315069066863 0.14606170345266645;-1.249511631679141 -0.8064724640984513 -0.13881180434898271 1.0294802307194699 -0.021895824304887408 0.27893617719000219 0.41540693304362714 -4.1872237807872574;-0.72450976402141587 -4.0747925572822838 2.0230773286184651 -1.0948097209665639 0.58871174715805286 1.9872431089834892 -0.13615547562790151 -1.2232830259809739;0.21095894351286201 0.6919215056806326 0.52497121703736693 0.5747601842547253 -0.14169039564681071 -0.85234044561920119 0.13899144469219948 1.203984278395335;0.24737298002352825 5.0963611188026885 1.9900874055570859 -2.0953154730590735 -0.14640248924827254 -1.3071892285216382 0.06517159323909158 0.38473468642191988;0.57858664900965207 1.896734892737252 -0.36183653060812015 -1.2608326026902039 0.26025351783997414 1.1856718004189817 -0.17169153232326098 -0.72826890037361203;2.4852906891543762 1.2232281257858095 0.49536432943743719 1.8995541043986042 0.65840473685112788 0.32797416242254374 0.45698473767896247 0.93926503328108446];
  
  % Layer 2
  b2 = [4.2392250125988022;-0.11416840760909458;0.98978821261691396;4.2442798710772101;-0.29868433888191642;-0.69445626545785732;0.79203143135666076;-1.7150986815283866;1.1311196307786315;-4.2686891609756765;-0.67172804547044396;-0.91543410645654644;0.058837958973619806;-0.96209217588266471];
  LW2_1 = [2.5799750281942524 -2.0666467703284455 -0.43777298142120796 -2.4396865346359951 0.063837197268075324 2.4067888436214107 0.32715334598193163 -0.19694573706737126 -2.5799578554323723 -0.48870366420699585 -1.0259201063025194 -2.1996317817431246 0.03203408429490999 2.5827276529359273;-0.55848834188533392 1.0188132328057453 -0.81139159688976215 0.57241641199702031 -0.35388294571579831 1.0927756675127724 0.73769050379059375 1.8830839734038838 -0.14718639003323489 -0.022969200950996228 1.2515677301580592 -1.3026762615728849 -0.31402461377438207 0.48520853909810802;1.912029595536773 0.66120039328602542 1.2574618683273633 0.41723347887440665 0.99009615947392771 0.47141243838823255 -0.55356275205123662 -0.57176102184064748 -0.27306610096937906 -0.50431399662929954 0.93093243995902986 0.41234797350591057 -0.35618701803372027 -0.5294326491673077;-1.6666111410651543 1.6134075650306072 -5.67420139906364 1.3855521528686636 -1.6885310249761283 -4.6692765287521514 7.0977094000194976 0.22446195630579252 0.51777258760742684 -1.6849295324438487 0.13128249582399851 4.3805303057066922 0.72235988244044236 -0.39929615091259113;-1.5756446681368823 -0.82471618650666012 -1.3369470915148967 -0.61313848755504885 -0.98227037610116641 -0.70932539013442475 0.35837416795839966 0.4052168771459348 0.26286578688629042 0.55005228106949033 -0.93178884420716801 -0.16966717654620583 0.3631102863870968 0.3844331580054981;3.5421874735412673 -0.43401534560098148 2.2016872441067661 2.9501034645332007 0.67644948218917922 3.2323854634841198 -1.0803561217511466 1.3858290391670418 4.4625487893219624 1.9514762628284208 -1.7967750498548192 3.6847398562326279 -0.99144051605337247 2.0202314457370778;-0.89509138180469483 -0.30625194318273641 -0.76566049658330748 -0.21721752788977997 0.78182686555515835 -0.27080950569553736 -1.0132040523557913 0.51409224372991724 0.14595089404292655 -0.13674047185388979 0.95996672827331109 -1.3151421850758829 1.0408403065811616 -1.1969550510844309;-1.4108094502443529 -0.089017984909708081 1.0361617483685048 1.6134144904171186 -1.7473280458817837 0.57677399022792675 1.8595295185043246 0.75622756458471141 -1.0774007828917385 1.0559099371050333 1.1575960032649333 1.2756857983876577 0.34733096706918481 0.3975254633912978;-1.1926816755152811 0.46909197029619476 1.5212708413283544 0.63235040534825848 1.4736038895547401 -0.057921829276894918 -0.33359250773827154 2.0106992957077363 0.1240100013019869 0.49771162195447255 1.4130219534282504 1.1263328078155634 0.27483989588363361 -1.5553337810625529;-1.8567831284091394 -0.70364006946238089 0.12792296318958002 1.642916308651247 -0.60437142583147374 -1.8983543223467017 -0.22364043386346844 -0.5382264422277101 -0.3599172630734544 1.4293238012450775 0.84649258537977323 0.16878217598600251 0.93087889914103983 2.0400306039648859;-1.1095743463252588 1.1912527732571325 -0.43612884803488461 0.76343778170759902 -0.63109972527425784 0.9728103378689914 0.81776325749124723 2.5192123767911991 -0.099251212886548479 0.20196940051621792 1.7506192007019339 -0.78953272287096987 -0.20491020092047402 0.83514610976887182;-2.2726824812026294 -0.29368941000995719 0.30797044812871754 -0.34463103580619325 -0.65746664279161793 0.74996417928765391 0.71183183338230749 1.4241614898524253 0.1122213780960717 -0.020560075727187328 1.2206631947304347 -0.37179174059855874 1.7417235489795881 -0.33223088308582827;-0.098002730936007587 0.74799320900213928 -1.6489624794509463 0.1994561466280276 0.22349861533613405 0.17032161885643671 2.3273184428106193 0.88647721925895773 -0.16364538074116464 -0.23984989560645814 -0.60296359976827696 -2.6443955070421046 -3.6016055413707133 1.382417989371695;0.57713856162572774 -1.0985814724363836 0.57160613876556421 -0.31123530375918096 0.45982552637501284 1.9754309903594245 1.0667044091610294 1.2273548607536195 -0.20559505561886487 0.44684619856999369 1.359251338172845 1.6408311651475376 1.5716099981511289 0.16926718845434044];
  
  % Layer 3
  b3 = 0.62325414951472136;
  LW3_2 = [-2.2369611103179281 -2.4756244931865168 -1.5358030751119185 -1.3360988605499347 -1.363316026989712 -2.9377923497585003 0.88431135384752269 0.28537574768718582 -0.62866580031154495 -0.37252150611437901 1.6645467220515417 -0.52502520591633972 0.62711748653361532 0.51835727417218957];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 9.52380952380952;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
