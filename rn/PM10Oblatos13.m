function [Y,Xf,Af] = PM10Oblatos13(X,~,~)
%PM10OBLATOS13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:23.
% 
% [Y] = PM10Oblatos13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.1267937651901381;-2.6709185364757966;1.0024183789713366;-3.0603806613308406;-0.36279732573341861;1.3200622222064824;-1.4041581898903952;-0.32224622954537857;-0.3887852756321617;-1.3070683499273019;1.8399494031714896;0.59635366786260757;1.0331501708225543;1.5185672000644268];
IW1_1 = [0.49872558185308269 -0.28421450205649329 1.0655438874102685 -2.2999680877652371 -0.0057317788948315464 1.7691713443513206 0.17513461299449246 -2.1068704992524543;2.2722841128671321 0.22408449780155029 -0.39224148175912665 -0.49866284235764585 0.24343855804275313 -1.7488856034698415 -0.012329671352228557 -0.38103869102186821;1.0221069848208697 1.1481018070032696 0.10354326689626747 1.0935112299885013 -1.076285598254185 1.0205818110916367 -0.33381044873033844 -1.1197848190643001;-0.83388082143538067 0.73243386101192143 1.6555437866474003 -3.4001064586319636 -0.11390617408164838 0.3208107729525847 -0.50773111829352413 0.052285024005822862;-1.576144107845175 1.6749274553283644 2.2384257691990515 -0.7122738509053399 -2.5579646400459208 1.7804314360604909 -0.076046917956378482 0.42625893782673463;-1.7940645989179 2.3796082938741603 0.41439269487340769 1.4545844861364692 -0.55288807150776254 -1.4304398868279551 -1.142109637176935 0.13078542860292089;0.36273569057858135 1.1962763769421962 0.63919737427069856 0.54864158029552945 -0.75504204718500723 -0.057426690097766631 -0.080156899499112727 -0.16907108633430798;-3.5356484924694689 -0.58363113945451539 -0.63966989157235765 -1.163594743553511 2.4413978365709745 -1.8771145686674207 -0.23614436780748244 0.11058537915981445;1.2113140539651137 -0.29748158645778544 -0.007054986094876519 -0.7166497023196019 1.4737107404180951 -1.0650656342666345 -0.89706945455765819 -1.0550688910114203;0.50474462829718458 2.2134026124859476 0.45760098422817386 0.56688669215246512 -0.3893927714148529 0.49512996188122765 0.11723206294364519 -0.37282180059648412;3.0759578351040093 0.47389669822502811 -0.84926701172437569 -2.9872309681885789 1.6967252770841792 -1.4752487354827268 0.49620265527426027 0.84061543454605003;-0.86308808788675007 -0.55993259291332875 -0.81482497612431026 -2.2210726352352235 0.5793547544881843 0.14061291303467657 -0.671284536578306 -0.83862996867038642;0.50785013859906936 1.0281366270462775 -0.84758468719586888 -0.95538536600938584 0.14322364014011513 0.014874868301662545 0.19446513254103481 0.2977478975495314;-0.53418935775284826 2.2329555799195484 0.9259567357357118 -1.0983171644750971 -0.89122265384077715 1.9250994660823599 0.22298668427306712 1.0310854590024823];

% Layer 2
b2 = [-0.91666468930941436;1.174863776752477;-0.047948240893314675;-1.0389038021831478;-2.1110136638666761;0.96555926039145634;0.91929258354828558;0.95829541186583689;0.035491137149811856;0.26563350403232849;-0.57290004089045643;-1.8769911735408129;0.51252465625708277;3.1399297297882662];
LW2_1 = [0.27492956213141739 -0.9717307652896553 -0.75875220893599915 0.18951215690728784 0.058031865436814115 0.45548725370971738 2.1440000580249357 -0.0021394181739890455 0.24510559290509265 -0.89138525570397009 0.80223014480387234 0.14999088989515702 0.91788150931467538 0.18085466000562631;-0.60209905096534744 -0.78664721158776574 0.24684240518984349 1.0905166932062071 -0.27731129503182345 -0.021252180164872344 -0.025341935666469962 -1.1115606321490279 0.57685851845616198 0.27617693344750899 -0.16479566258182798 -0.27054210433658343 0.051827425689008541 -0.046633175425484091;-0.26309114938618816 -0.96450325799971504 -0.25187925618218471 -0.84147235762526174 -0.80032108543409031 2.1405078346253963 0.56006986948738913 -0.63238959778090464 0.38510385732338942 -0.47559935698792533 -1.0481366626307711 1.5178349936724531 -0.9150004024699232 -0.31233546631319586;0.35782532662802069 1.2628748973727222 0.49527776694363951 0.96297437973348832 0.80653405642676679 -1.7666047702265555 0.33715511079650567 0.74123077736274801 -0.40962111331404266 -0.19754186245415312 1.5166841464876279 0.88048391852901331 -0.61504124982416619 0.81087177869626148;0.58376563973344575 -2.9213641302585414 -0.15033455882848276 -0.58018466024205417 0.69834609261106362 0.14308803537931003 1.0226365262164634 1.0188071799926344 -0.68635041601591606 -0.13829435543597571 -0.0078822612562668929 -0.82819316525158548 -0.010536951025265959 -0.3884714869963406;-0.14679140795300011 0.57928587589303604 -0.70252729054601792 0.50067620075452546 -0.20459529259243037 -0.64793801641567728 -0.0075383560033978891 0.53877438257701038 -0.17050852548064774 1.3121980661282278 0.73905830338140655 -0.49716344567077037 1.2551432812309447 0.52459096304074859;-0.17774506974077275 1.0632700865819256 -0.20240349298237931 0.63556081748939941 -0.44696269373821734 -0.44282397468406798 -0.80180494876208874 0.573002102780648 -0.51326371897616563 1.3152218064600472 0.88541096862719459 0.60695603363207806 -0.86684623896012691 0.75315269524835116;0.03427851340580184 -0.36924279284415878 -0.020445970093020113 0.29211046947086072 -0.21596077983887119 -0.19891200752778895 -0.76288665949491397 0.19200275731451988 -0.45379023990222839 0.65195786851174264 0.040224011645630164 0.15819578231695169 0.20192113461595379 -0.074426746783721576;1.2024822374803541 -0.0094829522138050494 0.063621653608138873 2.3034302242258051 -0.92407993704044677 -2.2460328324902106 -0.64400647464892846 -0.2337427133627244 -1.9997183664177309 0.34690180356384959 0.97354154214771926 0.28859032550913621 -0.79102743010553289 -0.51283377424764753;-1.0839924567221502 -2.0695992467461188 -0.034284686345244703 1.6260032837310663 0.11790423118748154 -0.65504636935357508 -1.5289995569266657 -1.6051694339874449 0.75638205632602995 0.82871564704471967 -0.53738094986886398 0.50274052183050411 -0.6673735324871044 -0.27130547479653466;0.27852957830588354 -1.1283883896212143 -0.24179612430325115 0.86469747816679621 -0.34330622272798422 0.75200386500276573 1.5108885599105517 0.042989640836210714 -0.38891353066122791 -0.94624389468714576 0.82367368277769193 0.42478996765131999 -0.18263984065153496 0.19687795242585227;-0.80375170033262211 2.0735621415215242 -0.24223917030055625 -0.88293826566009026 0.14540700645384189 0.044619894386011952 0.69202614364490378 -0.49368618848253437 -1.7543101797032485 -1.2102603447928408 1.9360530016208899 -0.78706399354535395 -0.056213103208009804 -0.35333804508729244;0.15420331939304058 0.63142820568990388 -1.1750069215848991 0.65794114458562591 0.18594937457623451 1.235695902661035 -0.17968058853066965 -0.56838710599823272 0.090119271938917209 -2.1285811825997811 0.80754883931373833 0.74997289254764588 -0.3598789760106868 -0.69614908333388259;-1.5806281818623142 -1.2286719016932552 0.16342241456933249 2.1084927392071227 -0.11792449410385746 -1.9476330443063092 1.1399217812383009 -1.7614618294047013 0.5759941601011489 -0.45859210974163578 -1.3745876966686432 0.62659482089884311 0.38014281493216251 -0.85152218580308381];

% Layer 3
b3 = 0.75788808125268259;
LW3_2 = [-1.2305096945249387 -1.1622228539872583 1.0824091800188744 0.90697362153436745 -0.88787242041856063 1.0298291574121141 -1.0503517846557133 -1.7142817381782909 0.20701191634945038 0.69292607596671496 0.9214394201516044 0.24335397541067491 -0.28626600960053689 -0.32755141409748734];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
