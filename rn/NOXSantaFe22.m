function [Y,Xf,Af] = NOXSantaFe22(X,~,~)
%NOXSANTAFE22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:52.
% 
% [Y] = NOXSantaFe22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.86086896392405077;-2.0628451406629504;-0.80031338746956615;1.6632581410746801;0.66249193084898039;0.49448467608305269;-0.45260232355039698;-0.028073423178747683;1.2970141694083157;-1.4562629864159331;2.1059136441904691];
IW1_1 = [0.46224124490864754 0.37513365059196374 -0.18259096418261053 0.29180374025277933 -0.63433161921931747 -0.017857634010754291 -0.0889936174461608 -0.31829636319217897 -0.0033007670875843283 0.98577021003606924 -0.12533722480608619 0.23013043451413367;0.49899815271657211 0.21727160379833893 -0.07883666339190365 0.070782713035182576 0.99490183914986974 0.5202448471728508 0.10266467456088896 -0.41882842482352595 -0.011057840623353427 -3.0061139469653857 -0.2395993844303615 0.33691608054308014;0.6567897360400109 0.64856896233939987 0.27113537408745564 -0.64012417659750331 -0.50965232861936394 -0.27631270293555799 0.13045057368945706 0.12490643730695111 0.033649828155755207 -1.0877404127255701 0.10689145563898261 -0.12330273788184115;-2.3779343407855782 0.58662773164445525 0.69961818026061051 -1.1362691281995798 -0.087803604651014944 -0.76757483266572946 -0.017100014089891834 0.87478626936965653 0.13761925847821557 -0.11865109015702559 0.73529588776665988 0.043650936411136654;0.33881496296134 4.8556813100839804 0.054523340191229633 -0.18675118967213394 0.10378668841153543 0.0094991850616935568 -0.098505037108577581 0.10493996018006381 0.10521099707744866 0.10608710752405677 -0.073363456389750212 0.32213320984699528;-0.57241949424663163 1.5286386273422803 -0.21814277068655952 0.54991173220897938 0.78651119132642289 -0.23940151559185727 -0.25265998890691127 0.49795711341843024 -0.14277439759241337 0.93734382155042495 -0.27779925229676578 -1.0750630900023006;1.2283001408524827 -1.2429180756160536 -0.63458895471361632 1.7726032925194963 -2.0754965568864092 -1.9580606310462527 -1.5971926357645079 -0.3067454966834523 1.109926331097109 2.6037795758202544 0.37192774466294137 -0.78648540624002228;-0.34702143194101004 -1.066768477978405 0.51996806840698173 -0.36431211564242677 0.28961960775882983 -0.16044173362444542 -0.016093536410379632 0.27562462096688256 -0.033051239077352725 -1.1026648447807073 0.060961721824257478 -0.26657651163525053;1.1056391096138269 -1.8587808812257811 0.084789388306753588 0.11028828217316232 -0.35236730028305452 -0.25266342658766228 0.046681115463492767 0.5594536694900285 -0.16909449280502781 1.1622637106390472 -0.52877598048367802 -1.2188885432806869;0.094152533343806827 0.25774229105710694 0.17152918566143555 -0.51476580893135049 0.23483006463245931 0.096592007909575006 0.60202542507020895 -0.027232452913974525 -0.98749971890810029 -0.12286825333220161 0.51431939164803475 0.78942310577278019;-0.57113903672421951 -1.770524750096883 -0.14639704646446289 0.045769729764961312 -1.1997311471683265 1.234151119626625 0.23102074965195576 0.44450682227615179 0.13243730788464447 1.416391734282515 -0.31448732413712094 1.2822931496215855];

% Layer 2
b2 = [-1.8029996444562539;-1.7509858242193754;1.6051075872675078;-0.36962218572080263;0.22560357723198338;0.080964938916597076;0.96045853833319905;-1.6882628254660892;1.3342841959671301;-1.4718257969207893;2.8579952603670815];
LW2_1 = [1.1522073704328997 -0.088212167551973267 0.22952338473357831 -0.96340821092146323 0.099971284897393237 0.1575214857389638 -0.42179372936309922 -1.276007621650368 -1.0955960292914027 -0.24596102492050398 -0.51257322771528169;1.1969030549544564 0.31189452512855309 0.17407829344464951 -1.6060720603976868 0.32268904631893297 0.065160553397864321 -0.10254091124922234 -1.319683666980169 -0.0053180514830056952 0.74853809483776346 -0.056013437881207426;-1.7439498514133827 0.82336510637460791 0.37695719772134295 -0.23278385187853695 0.82447513736846978 -0.16483732461580194 -0.73947296750519875 -0.43472904993795636 0.2607591208775647 -0.75982752903903583 0.21298187943307956;0.95466943353950606 0.70388738423826902 0.2256323128881059 0.48305138857683361 -0.14312281653496389 0.26050705590203893 0.27481532544040821 -0.25819817873535522 0.26036309147551179 -1.0953783470933356 0.12501083555790418;1.161224016460874 0.48099308607336694 0.7643385505331074 0.59923148902062384 -1.3317712958325936 -0.37361758957346208 0.13810922898246494 -0.082513303717344916 -0.57469708738005343 -0.096552314047681734 0.085117558323285686;-0.0025014593949006236 -0.27891291485145547 -1.7275982749364149 0.11653503242534104 -1.1918239885896065 -1.1579687478295957 0.12538786453388862 1.0293618643084601 0.4125888099176957 0.49185819982324347 -0.064299064577321971;-0.78331897105566128 1.7019509650414164 0.61621310073246538 0.9746317394257733 -1.0246916890239315 -0.11248495728832299 -0.63480011241877632 -0.92289677521146163 0.22090145761321528 -1.7786627205340586 -0.58073263036012979;-1.3082142413171662 -1.0945477333633133 -1.1024804673537081 -1.2898467072019606 0.10396132485518463 0.93852899032560111 -0.27593611896533132 0.57282700644941142 0.0059452698447066271 1.0908807709162571 0.35896269085639865;0.060980617491303749 -0.60463035028207679 -1.0178469297034087 -0.71611829433853147 0.41143547214933424 0.4959341794107206 -0.31639743211540011 0.88540140840086612 0.2054427972882876 0.59128855229329302 -0.10817348202638569;-1.2255020632621387 -0.27963106789825043 1.0014085377683497 0.28917222320698588 1.1171479023280413 -1.2572999957498927 -0.12520732832601739 -0.5778289912648511 -0.46811275667341773 0.83245175593095244 -0.21017743091719132;3.5240111018091165 -0.40284117129494235 0.62096913748593097 2.1731843656229999 -0.10819816514845103 0.77527436406337003 -0.82470041029420826 2.3101441764101258 1.4898935533712301 -0.44563783713726429 -0.46619107661685666];

% Layer 3
b3 = 0.19563208798688445;
LW3_2 = [1.0325960652313801 -0.72166796065055083 -0.79577563476015278 -0.47604371966465986 -1.6105807658098066 0.97371957780892537 -0.56130538263066887 -2.2709752847240385 -0.7352302107438462 -0.25556753821714928 -1.6681746476611283];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
