function [Y,Xf,Af] = PM10Centro13(X,~,~)
%PM10CENTRO13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:04.
% 
% [Y] = PM10Centro13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.281968137600451;3.74531835205992;0.00773694390715667;45.4545454545455;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.2578738297523904;-3.584876543393924;2.753740279038202;-4.8539944454206632;-0.2372086522145678;2.2162312310552092;14.754853493113112;1.31971596802214;-0.16801947389384628;9.8862860611699119;0.91639178089555606;1.2959906144830495;3.5910875551744197;3.4930993017381553];
IW1_1 = [0.75684617506080754 2.5699844361610644 -0.43847805594555012 -0.44097314806056503 0.57316111838430694 -0.8028148984233705 -0.14698316015086774;4.6779007950687781 0.3341829238562834 -0.094730637901441178 0.95218156354487493 -0.1840581669356573 -0.38613326714020901 -0.73256835110300389;-1.7786391474663203 -0.995660473867372 0.33992422423172119 -0.56869280156805335 -0.58462072113734309 0.62436614516637601 0.88928761621916896;2.9154077129025824 -0.51955171167930381 -2.824238889311578 1.7113326937707973 1.913235193720439 1.2570523186614064 -1.87724567147209;0.10577465288046498 1.4424720158227293 0.0040239890054386725 0.018586202920632622 0.80895958979340299 -0.4441314036236535 0.2410647858376288;-0.70963850318579302 6.143847801133826 -0.85336770457958833 0.48048597027435297 -0.80417528525382731 0.53280203226185352 -0.31971858854260665;0.93384824962197732 0.22343151194547287 -0.17829106924364055 -0.58661725238708018 -1.6214198455195812 16.645519619755088 -0.18830896480255796;2.3409190139420994 0.028779635371777874 0.19111731146726291 -0.89372687671288986 -0.91400722574460713 1.7585769681784045 -0.4187765607026076;-0.65958575995015556 -2.0123337794234595 0.053713664929941694 -1.0829530848523845 -0.67209491428288892 0.58854711748626354 -0.78153635825156897;3.4863197997849396 -0.14035026620081048 -0.95304992905344377 -2.9845544726057187 9.8054056414293136 3.3109640376514777 -0.57906829938478743;-2.866850527310342 -1.6692286367487812 0.013631895339942841 -2.2430128752950327 3.4491420708438212 0.54168538166720959 0.54743481646181846;0.58994902181619446 0.057620126950290951 -0.48157115723950333 0.34662085954621646 1.5574661879715979 0.43569937859090746 0.59285117022565104;0.4913919785917783 -0.35443520082959401 0.66483543308198034 -1.9027734569027841 -0.61538426585401318 2.0227453749482476 0.040192798478183966;-0.11769495722886146 1.2388455019924962 -0.096218271490163043 1.653379800289033 0.55232146081850653 2.0473989739595515 -0.5049162422483342];

% Layer 2
b2 = [-2.546665204202796;0.82151128853100175;1.6314241438864259;0.1874590782450451;0.94334400881615055;-2.2888084496945269;0.75871890695141697;2.8876972920020094;-0.17330128106758463;0.5901972715685605;-2.309940535377681;-2.167006655597973;1.8601086850416968;-3.3186365934206425];
LW2_1 = [-0.43536357236563095 -1.6570691448562953 -0.31033007548114072 2.4401958899963776 0.28234161167907523 0.35401818829817633 0.54635672754163078 -3.6234980930524077 2.1127854542318967 0.24726487092753996 -0.44896567907948298 -2.5054484324095458 0.87840286771145115 -0.54463393444239838;0.89026482874537138 0.87109117836129568 -0.48579221560570318 0.25119516889878052 -0.27349095027011028 -0.1924108137471866 -0.048015078516539654 -0.92604263294468558 0.36484404790772534 -0.21711109061700518 -0.17835172112197004 0.29937834843006561 0.1498769508349817 -0.46678459758248519;-1.4181127778664362 -0.11510472424230943 -0.45369439006806134 2.3500042779768426 1.1898024642171356 0.41026550794135708 -0.051810399816910484 0.4607439622247253 -0.69499925076524627 0.31126820052706444 -0.23054684673347201 -0.11054974705085659 2.4600312634777302 0.38035423054311501;-1.0254360346025644 -1.2374023733180999 -1.8431055236590492 -1.6184409271083593 -0.38667304152257503 -0.06367147398979435 -0.83326023162830543 0.42546785603039905 0.41836114320082279 0.25883313826146104 -0.35190116503620356 1.1474444555541059 -0.53960427717957538 0.14345572252144898;0.6773222049669626 2.2085923338435185 1.0234585091817507 -1.0417795357921809 -1.5163775799775983 0.087251445368409744 0.27566594815180712 1.1911022962200488 -0.63409914465599981 -0.15239103491814368 0.13568017606784705 0.47315735776668677 1.143495819806075 0.21129691678235338;-2.5195541900940417 -0.63832632940439193 1.767794286481241 -1.8240985416380373 0.32817660869155829 -0.78750415013566089 1.5090678821324448 -3.2835850377927103 -2.3039710178021222 2.5769267881571669 1.5709909278867491 0.16760350479535535 0.82698076593695824 1.9861692489515923;-1.0339044242040236 -3.7488135251335439 -1.3744236223441677 -2.0813894708437717 0.53358727812243023 -2.4379819877148696 2.0602891137808159 0.66980996112493518 1.2217037737285417 0.47712870241640681 -1.0178096887918724 2.5141145131732023 1.0246904849761655 -2.2823191694110285;-0.91649784904280174 -3.7427013068026285 0.3702229779845409 -8.5630385423873818 3.0551445431857407 -0.34966752208925234 0.54785442651723537 -3.576338536839605 1.6671421020288695 -5.9780791067503642 -1.2253425022081776 -1.2055265190820794 -2.1020774784058629 1.46228087668462;-1.0523985727230005 -2.0248680463467785 -2.8545100340112253 -1.9658718385933236 -1.1513698483615811 -0.1981917209570723 -1.0202503553490712 0.5251254955924245 0.40412693592527921 0.39001901894434099 -0.36540629105980532 1.2573740695918412 -0.28697045520806103 0.31539022433092145;0.40674938404113464 4.4515529409313181 2.4570445046522877 -1.5755013731061942 -1.8996584435497224 0.2717453689215788 -0.015466178477203664 1.4490939098483215 -0.60647980476061347 -0.33592081461696244 0.26390465354599124 1.2836886102369933 1.8529539341881953 0.61267601248985482;-0.99719899857904659 0.38778631306048922 -1.3785140189485459 -1.2021053213063257 -0.73084047019044018 0.76115287024556721 -0.50732440657705047 0.70807761222365462 -0.95781980893085816 -0.57869711706712523 -0.73210638967810238 -0.74047162943545586 -0.026684103963440862 -0.71746623449769908;0.081101734075728973 -0.52234922852375021 1.3802345582923996 1.1776618229736187 0.98377202694055488 0.12631638788238678 -0.61293405075182095 -1.006323703641731 1.3229422337751002 -0.21480252096097846 -0.31540687589751248 0.54295503958550984 0.2525979322045519 -0.53244894533743925;-0.082183001048430487 0.11390683222490858 -0.066432497839754273 0.41775731901410917 -1.0691266129722763 0.2182768571832763 0.55160727864244052 -0.28087572007688094 -0.75742983811295628 0.17989753453867394 0.18261758143512785 0.30746255652372845 -1.4043347189152517 0.50196511737757299;-0.50538401541458722 -1.2827330658524767 -0.5315430884500929 1.7366492130184048 -0.69405659574324929 -0.21584991291078381 0.88775544637968107 1.4428278649431963 -0.40975912924937802 0.66950230708284297 0.34728331220243042 0.88154296191702941 1.3978035716442962 1.1832396167971551];

% Layer 3
b3 = -0.87448039536428868;
LW3_2 = [-0.11207466495282048 -0.96912897898034922 -0.58896112870237072 0.84533500223713254 1.7275877244724129 -0.35342107608902923 -0.26029908042388039 -0.21458201607733238 -0.58130106336385845 -1.1430232279518071 -0.51851321064617706 1.0710378563638394 0.4808432098970824 -0.28795571473153331];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
