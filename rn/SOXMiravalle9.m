function [Y,Xf,Af] = SOXMiravalle9(X,~,~)
%SOXMIRAVALLE9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:36.
% 
% [Y] = SOXMiravalle9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.0208986415882968;90.9090909090909;0.056980056980057;0.0063552589768033;166.666666666667;45.4545454545455;117.647058823529;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.91178466293097404;-1.2721677475908346;1.6831551474960851;4.131212259070443;0.90617227548601154;1.9149702104473167;-0.74888549702084006;1.148319581530064;-4.4668362833805073;-1.3897133848884471;-1.9136673144555199;1.5578262615883254;-0.24061299348829382;-2.5190872383184737];
IW1_1 = [-0.067091890482248923 -0.50401268442864378 0.19403442296192255 -0.20627689172691488 -0.23537106462782195 0.10760752433587015 -0.19590980239247541 -0.39711900175347281 -0.12563868250869625 -0.16844036977098126;-0.70704277682562933 -0.050556177476045981 -0.94936437940348595 -1.6378212090340554 -1.1139277302572184 0.045908759760609381 0.70498493233078818 0.76604373177890861 -0.5454534833932172 0.30656850963376059;-9.6046978436216239 -0.37840710214565126 1.6909289248297863 1.5800621349368165 1.0340359022308756 -0.18254134001003303 0.47817259522772892 -0.28007039788192056 -1.5743789017165126 -2.7315627481623634;-4.413296711202138 5.2881855352522757 2.581574562370923 -0.20984435622235922 5.0354774412216843 -0.034462817411921545 1.4244644344956356 -1.1869579759343711 0.88398275164600471 -2.2342776269157363;0.01788561477924883 -0.48370419436156553 -2.0826212819651815 1.2611022288668372 -1.6380400232417966 0.039145130738855373 1.5171206037737011 0.64462225897176173 -1.9802941933503913 0.37391914388922609;-4.9254271710590913 0.52982238175991847 0.88029141996868598 1.4375906204679347 1.6527794964975089 -0.12854876938969395 0.30002949188627426 -4.6674660228460434 -0.22158712594361157 1.835511471255115;-1.0541301771725382 0.067475664430021828 -1.500155235804959 -0.44438939408774331 -2.0002390225972011 -0.18394866916851396 -0.4479180156269309 -0.8506798929561219 0.89584950708149613 -0.63434997778748514;2.1413380226819299 -0.012094311852853364 -1.2340240054397862 2.2698288924155259 -0.33409696311892761 -0.11789803791693038 0.093638849945532898 -0.68119792368109622 -0.24381801739880166 0.41441994668256965;-3.1711899734270097 0.00046390331904215282 -0.55490937102149185 -0.64786395866858226 -2.0340405597633797 -1.4853044282854084 -0.80407751812489736 -0.63099319067277837 0.82748011375661645 1.1535550226904185;0.080880825792685976 1.1268417753662334 -0.10364584049508413 -0.66623343290789161 0.071758040743520851 -0.3054708731121018 -1.3574528765689784 -0.17848581973090988 0.29176503326363895 0.5967336334341935;5.8259438161408763 -0.21743553113979938 -1.2167228774671366 -2.2340255929168604 -1.8942797296857334 0.14571257722370523 1.1157063933112388 -1.3473875053268307 -0.35260035851402433 1.8098623831072285;0.11268885948934068 0.72591112836787486 -0.22846219992422845 1.7098546748061714 -0.50320626357012832 0.025486513679319853 -1.3164877571880984 0.31870179098633455 0.016748075109791392 0.47503775083882632;-0.54204504415791455 1.4789901774246912 0.65403096952513606 0.63516870027096983 0.41757633188885857 0.13268864510056608 -1.0096852271941548 -0.52131261247244742 0.86122936623044311 0.064466431276891487;-1.1733075353408489 0.49523368291486797 0.21700772181941178 2.4151830267471617 1.2260275892787247 0.07728662161859913 -0.1082006301316175 -2.4744382868892867 0.47934769171409397 -0.36828985070380338];

% Layer 2
b2 = [1.5017938825336248;2.2811130961711434;-2.7230383100313951;-0.049066861806989798;-0.74405863568824504;-0.91133566961746526;2.0182393900946924;-1.8752338942458089;-1.8002625400344709;1.7614239950581831;-2.8842679979451393;1.6197848062457549;-2.2833341656940949;-1.6581658372570263];
LW2_1 = [0.73819989546018661 0.12388208592808581 -0.34744403124555684 -0.17568740188713788 -0.10202024157046771 -0.47288371907238558 -0.79825098950102125 0.56473710932838439 1.0650228382681173 0.51881638605739777 -1.0240153270994434 -1.4956169560568255 0.53904637330164618 -0.022881086899062018;-0.57962249978332281 -0.69879739998946744 -2.759987333394343 0.76843585751362242 -0.85648512121310627 -0.85305410001813287 -0.89657555859176741 0.95077129320537057 -2.7636209045343314 -0.56508508176492078 -2.1516840087621572 -0.37750743472137888 0.24701946034194824 -1.0143352241072263;-0.07714916024984339 -0.78823361130385816 0.99986288148775893 -0.49683967618723279 -0.001426007353552956 0.53414172790551739 -0.35805148620047444 0.65529798908276904 0.032087110353770605 0.1157004483066294 -0.97859926721547785 -1.0159183023708596 0.4554881730347341 -1.0729673092552192;0.52960478142579615 0.35518096368249336 0.19139936913984973 -0.23884662693215492 -0.3185512681791563 -0.41511597152549201 -1.052733446233415 0.96786996046030926 -0.056065286745475236 0.38260286849976022 -0.4183597858798544 -1.2212026081362219 0.46146879821970094 -0.13608796188702676;0.52545784002841645 1.8732703323198976 1.6205297052980225 -0.54245983896554995 -0.61405871709873738 -0.062695871564187891 -0.48851851134515911 1.0269033504114771 1.9855825475814204 0.16093698464194478 -1.3229299012528131 0.29394050426312301 -0.10912911717485671 0.71151827541652191;-1.5821737745327025 0.72000485189328489 2.3296935413641311 0.26244390649873961 -0.29151398615243518 1.616662920505797 0.45527961889885932 -0.46848147895314157 0.47431476179406212 -0.45895153421858964 1.4351679426713193 2.0581416896464266 -0.99354818723429139 0.60255180940727937;3.1012634917414457 0.1944875821204072 -0.3541915551585636 2.2360991007974609 -0.80658471240157636 -6.2254737332784487 -1.9788169019547235 1.9783772909956754 -2.1471601723637059 -2.8758643468304488 -2.1940120427616239 0.35428576769205827 2.2183925373290148 -1.3049320547605148;-0.53459484142076175 -0.54923286059431753 1.017213369237119 -0.16509504850124448 -0.16252137281897583 0.50015445052435259 -0.42209475056819012 0.64593190286346813 0.75547465435536465 0.086139683548927759 -0.70430764747131591 -0.68075438863108062 0.26561809370328959 -1.1426452726748035;-1.6112315881906667 0.084400121343527937 1.8910809868826215 -0.017183983922619824 0.14581588518283808 1.3460831400583986 1.027670309268828 -1.0454681361207689 -1.1786600345394955 -0.53074886807925914 1.0099947767182835 1.9412616237155649 -0.82099429718275008 0.52610802478266261;2.0505600266708948 -0.88292244337185255 1.1211010750152377 1.0118662006465629 0.46352842954380485 -1.2202031980188961 1.4589053044975511 -0.027411231390974813 -1.2157716999068178 0.45574799868059945 0.42047498503699032 -0.8369614699862522 -0.77806244197944474 0.20091350561811744;-1.6117217269924522 -0.55602908394200456 2.1274912787531925 1.9908137931337304 -1.0040658585627187 -1.0074581956962156 -0.38142771897616967 0.8396695246330913 1.0552174572507504 0.032503293704428698 1.1612074830412267 1.6785328570286926 -0.63632027372300515 1.0281721317552246;2.3261031588320251 2.0033125976837507 -1.7655044723996489 0.20790082402403401 0.67442685339854236 -0.47593163739886002 0.28204647072203426 -1.1512970408426162 -1.2958960127674755 0.052990777203038561 -0.7118034760145715 -0.17705753054605122 0.32904308886446015 2.1494550494954012;-1.0614364883883223 0.29021631933650316 2.6740567729220115 -0.7187286455161741 -0.32783193503301966 0.73068338256312948 -0.28928621219245471 0.1408026253993182 1.4624713221871639 0.15703883666855112 -0.14861454168217575 0.4047730439850093 -0.23087023369049711 -0.82852309910225019;-0.54257429308879779 -0.083633699256442734 0.1011949247941417 0.90447743475048603 -0.48319653307632077 0.22346453733753976 0.43147833693486604 0.22350542368314519 0.37397018512534053 0.8880587112065389 0.10805003193293397 -0.47543321850739051 -0.42205751704109901 0.45048317895360107];

% Layer 3
b3 = 0.32048744488849146;
LW3_2 = [0.49380277988098348 -1.2869754998215128 1.477418229148564 -0.5161500235230212 -0.74549149608167053 0.63466001980786368 1.1672607269036994 -1.8092581364882561 -0.66475453280777175 -1.3751071757299582 0.53582098279079859 -0.20477664101908519 0.62479826929475857 -0.41124924920227451];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
