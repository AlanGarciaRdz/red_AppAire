function [Y,Xf,Af] = NOXTlaquepaque48(X,~,~)
%NOXTLAQUEPAQUE48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:16:25.
% 
% [Y] = NOXTlaquepaque48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.03490136570561;19.6078431372549;0.0212539851222104;0.0523560209424084;0.00632111251580278;0.294117647058824];
x1_step1_ymin = -1;

% Layer 1
b1 = [4.0790397750626406;-2.4928362146844774;-2.3939172054131133;-0.22995971216739725;0.53573383550232512;-1.8868910262664194;-0.18544607265954657;-0.71916844575547856;-0.02124311605454008;-0.85743331585073901;-1.766913993275149;3.1679419996406111;-3.0197328193078334;1.2934796353434166;-2.3356897482392669];
IW1_1 = [-2.234202699739555 0.56642595566158416 -0.76978622497050342 1.785055713711744 0.0097750803977468097 1.1725033469035737 -0.061790399564265422 -0.62193322806343376;2.1920285717344661 -0.50023906268000751 -0.10499015616666042 0.61900958856861832 0.33681052660460509 -1.0407893585753145 -0.25546785238768904 -0.054255691606474282;0.66440290597404672 1.8879677155026773 0.071017318116768757 0.16930099329489906 -1.1953434199197115 -0.72891613504050479 0.24734403947197137 -0.054487980730378534;-1.0706382735082975 2.5769030158383872 -0.77024665522664781 0.038974135834782979 0.30245555790328554 1.6772927674784288 0.18233162364079769 -0.25189689242607732;1.1748176037633491 -0.40926812516468919 -1.3882998526687311 0.23371003863751816 -0.18534533185761243 2.4920837153108133 -0.12795169509121376 -0.66823585666891094;-0.011899515330975455 3.6222087130342038 0.19233614434323215 0.13668510316995086 -1.5858798700208494 -0.31409392351364257 0.22610860565170471 1.8094965158889351;0.16248023571481299 1.8082295015348822 2.2402896415848987 -0.025475099783828527 1.0480276467890552 -1.0683539530325208 -0.24224827430507542 -0.88644259297406269;-2.263400455865523 0.80681186059172949 0.99372521730397045 -0.025911593559561297 -2.1453844168149927 -1.2027689768860514 0.21558349781404784 -0.40638000566516286;-0.78235005506259736 0.47131712836476014 0.59185977694770842 -0.080898960282254545 0.28175554084721816 -1.3141158408201112 -0.13953751418340002 0.18509740586499224;0.29058812869746886 -0.49487190514687346 0.73557453056074884 0.41700127807897908 -0.24816086906110363 -2.4385555817557156 -0.18761601601487882 -1.136977795938408;-0.459079862650977 0.47888725374400354 0.46558349738153615 0.74903405067237983 0.68886530220391429 0.53509224982282644 0.025346719224375619 0.41529034865367387;2.6442427467938905 0.079508418801046504 0.5159063458148363 -0.31237753920176814 2.8751174804243926 1.049400418712239 -0.28003149160019342 0.21570450473413766;-0.67750224425427497 -5.7461981014032872 0.095638145576714073 -0.38420380952473177 0.37789389067264345 1.2562248924730286 0.33812866065793551 -1.02149109189191;1.7160529331995937 -1.8316864234083068 0.70740000307594642 0.53113224457628783 -0.54521125032190954 -2.0463669673955152 -0.20971857171850974 -0.1568934693556393;-0.18426948570689894 -1.6026496569354474 -0.52240067812403279 -0.28696371273844934 -0.35045827747674158 -0.55215328412621745 0.24381384334468867 -0.3186854726174646];

% Layer 2
b2 = [-1.8393243978587666;0.70213872268720878;-1.3532911194833439;1.7226846811895482;-1.1394526695709848;0.76751981068995911;0.48413137469494016;0.36494171766233047;0.70808157537116378;0.24878077492986464;-1.1970472683373814;-0.11320173239606723;-1.7962618280392826;1.6427925632991431;-1.7043441186757986];
LW2_1 = [-0.56522572577558639 -1.7456471296313631 0.59351636435814381 -0.17839397252992018 -0.11076829508310854 -0.83909240615618919 -0.56085123069923726 0.16157393126959349 -0.46759567070442765 -1.2028316973866708 0.93462362259064191 0.82412019738070819 0.51096726392570968 -0.33306118880470803 0.1049248433575815;0.54485538159609248 -0.065957525894451308 -1.0140834038769349 1.5447726415013168 0.18101338329162484 0.8906219193398992 0.55553867400222834 -0.80083745561824804 -0.22936139420374282 -0.29230208787890322 0.49452698396603489 -0.1252247894420262 -0.40947951345576589 1.4121534884154967 0.40833593056066381;0.95647865588846548 -0.33843580991205974 -0.07480782651934445 -0.93309431075150406 -0.043534204804350954 -0.10887650400572517 -0.58578474131352254 -0.092798500464733827 -0.004036672099914887 0.036185253604652218 -0.21671892501621173 0.037290569619017479 0.51859592869246796 -0.26605954748958599 0.21356576990556514;-1.7932089499766162 -0.34278560179809747 -0.47704728845001609 -0.51094472841645844 -0.067956430321039915 0.49042729260397433 -0.21622919541445013 -0.75384162614920347 -0.90922174673891587 0.71380286715156782 -0.21951748723956344 -0.64628255928929401 0.94527599687627784 -0.37527058708388245 -0.27295425353255542;1.8566802697816398 -0.31845151155085272 -1.3725149069157536 1.1002302480759067 -0.27556196127570648 1.6592633074025376 -0.50283876433287322 -1.0451902612027695 -0.47465086870232387 0.56414935166609181 0.011940536721244038 0.65024822345999522 0.50989902385397834 0.71255195111782632 -0.10809831760059491;-0.12583719720561637 -0.11577502841636597 -0.86174565457019225 -1.4834940756780153 0.50491392651209743 -0.47342204223680062 -0.80248440437342572 -0.26907504888546352 1.1004143172057941 0.23021903225787224 -0.32377752800425175 -0.65488951934172579 -0.50925553396037648 0.034704005593710327 -0.58658668206265285;-0.78411928414068655 0.23222470857270944 -0.56061451800525086 0.51532549275510176 -0.18698456783386141 0.2648859643804149 -0.085157671878989372 0.46085627201417678 -0.85947736837239919 0.39276642241211046 -0.98848798223679257 0.68009479959784314 0.836561133608829 0.069259933784446892 0.31542943836447324;-1.9877371185383208 0.1453544921939712 1.1897839093681548 -1.0056942439944645 -0.35305132393287092 0.073584892497703891 0.13320539332308576 -0.12688862102753978 0.76152287261329787 0.21366156664292177 -1.0827115559754403 -0.4577612221440806 -1.1203962358670416 -0.5481684647957612 -0.93122630044234322;0.81653423949492054 -0.4719116575200118 -0.23088474450357824 0.89403318404552101 -0.62870375370959541 0.15452307643721275 0.36462423857972004 -0.52288389135137525 -0.39487737346973095 0.044167393509179531 -0.4946980187894251 -0.31035823360211101 -0.65071383962698992 0.24577540969776346 0.25920558503442404;-1.7606450712181561 0.14697680595291804 2.0308118915336406 -0.80368723287847554 1.057190737034128 0.49998912740510582 0.6926024612927848 -1.0773997321045252 -1.6028793846333929 0.072700185507883264 0.62391384987952092 1.066321665314101 -0.87700964252494429 0.14824154337452175 1.4961290857320038;1.442713532544176 -0.52416850611278365 -0.81972606064251441 0.22163409736329939 -0.84571002624839275 -0.70094928511767507 -0.58463528141267451 1.1920955572465504 1.4177077697195835 -0.36097627151209516 0.37034690444877755 1.1237226209187339 -0.34500122891461854 -0.11667567532466208 1.2771541793256582;1.0870812986244305 -0.39246233027488409 -1.5804996779793514 0.3567214049122247 -0.21455624770712969 0.47366083286888278 0.23940557783593877 1.0329548293205537 0.28907059166741783 -0.16071234832420553 0.4749405762212815 0.83260740773264152 -0.5039953804080185 0.0025488943151883298 0.57829947996841236;0.092606916583784754 -0.38136946698143875 0.54504804325833234 -0.39899775606022925 1.1805823452518451 -0.17043026187504898 0.37671763468641101 -0.18985438896542245 -0.15587295144379723 -0.4462555166261401 0.59886875551738705 0.021490502653435634 -0.044938338555370987 -0.87292373957466352 -0.69428699881206712;1.2530583316052879 -1.0640531568243929 0.11955116586875249 -0.13412396679337257 -0.64164047552805392 -0.55107530630885926 -0.42636278065625688 0.83784050875896299 1.2970327747274504 0.57302236937866624 0.073686677696818817 -0.59695076052213758 0.45753211824976642 -0.76327939411460488 -1.4552609762551565;0.38257042087283138 0.3979813399198332 -0.25661527144365226 -0.17512990328413161 1.7666309765576493 0.7062223643096498 0.54510893040798958 1.252913813058977 -1.823612904597816 1.1467518559125021 -0.53844352437387955 1.3234312926331973 0.59282230612472364 -0.207977486493018 -0.9608274068618663];

% Layer 3
b3 = -1.4105565038440759;
LW3_2 = [-0.29562469434636501 1.087610828651304 1.1375946629787133 -1.021550279272599 -0.41893403158354481 0.84952254489275025 1.246387367139161 0.55534860362669236 -1.6273586862550464 0.89301614970341969 -0.63806042713222499 1.4262649712286655 0.45950557090447269 0.92185538590158855 -0.46007381380808021];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
