function [Y,Xf,Af] = PM10Oblatos12(X,~,~)
%PM10OBLATOS12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:23.
% 
% [Y] = PM10Oblatos12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [9.8928148010072032;-2.8311605451676414;0.33615166845151778;-0.95989680418143641;0.14756460685656206;0.95008074549139998;-0.14203737180762543;-0.73276101678375194;-0.044632174445934425;5.4561283555155766;1.1861484013878916;-5.6509119110874098];
IW1_1 = [-5.1335127311317574 0.98252421851190308 6.4069769734959463 -0.86392219645592916 2.3575521312102117 5.8918021850945275 -1.0237973218655658 1.5426242947214053;0.89076083541372375 2.2391902074198726 0.63564361745075915 0.95446052969127593 0.028493837792124492 3.8273461597598875 -0.18048217923238893 0.10863704296993028;1.0014141555564418 0.8839705571586981 3.2921574548231485 -2.9437692561619544 -1.6445436666951376 0.21615749948855756 1.6223686880636243 0.354075340346798;1.1707357971933523 0.73732253051046126 -1.4747024314542179 0.37016818537358431 0.396231488980191 -0.81020759110083862 -0.14196244042713901 1.7143237001045792;0.33662302090051793 0.52904189391458245 -0.64512481683223877 2.8593514792490411 0.078718801695015286 0.7357314116971102 -0.013294091577087606 -0.60307834314658393;-1.4299953769419762 2.5718933718403361 -0.069606777624813876 0.078378463980405072 0.24383564812403247 -1.1188193395928945 0.049489252236003527 -1.0054839644382567;-0.56316903350409464 0.16882244336392449 -7.5037185897683951 0.059084253787892713 9.3481676894077435 -0.14575331306329997 0.37937701146790842 0.43229945574616663;0.11460477368465151 0.57664133610132573 0.81874580612812642 -1.0705017928207552 -0.2206399968638183 -0.14736326165770353 0.064971602827855315 -0.77515443908856052;5.6325938436430469 0.18114630738709567 -0.65988444717542294 2.3026794358859224 -2.9397251051476032 0.44463647449262061 -0.12413019351765549 -0.60305892407287542;0.16664574286367162 -1.1576274882033064 1.9566026569067481 2.9720881445000735 -1.9340361336592384 1.9098754716514899 0.85690739235540814 1.638685451677899;-0.7441673065049107 -1.9426072145475861 -0.81061571288499101 0.13453649595611059 1.2061773704668088 -0.11171949768617034 -0.57679715067594928 -0.048847340197341056;-0.86494526139159489 1.0971711371023511 -3.9886760068031943 1.6266638582958668 -2.6177760989841841 1.085673294589603 1.9582881957055249 0.43413720872121209];

% Layer 2
b2 = [-0.70984267751291841;4.0616878893406474;-5.7646623963999302;1.6425349768023902;0.4152779400281203;0.58173424839883237;0.15869169501173502;-0.25363317238819555;-0.7474404944437314;3.3470030244863862;-3.3659587936238626;0.60874711619231647];
LW2_1 = [0.19627222479182249 -1.6684226517068972 0.14858080830305995 -0.61244529350111965 0.12465069450548841 0.48679672404947855 0.18089888149528896 -0.034739944184723807 0.99103474992864371 -0.19487762367572531 0.48459883503754181 -0.16478585888260922;3.1700540048459613 2.2005832758807427 3.5143470285589378 1.5737956213510873 2.9035363133389485 -3.7283044234296745 -0.48631724973319135 3.3801943498209743 0.75633256305032182 -1.3859187375862279 6.5942746933958167 0.55486131564524976;1.4267174619096183 0.88758141840842908 -1.9317539503053227 1.4816315089807819 -2.1300061873098866 -0.32273454628642417 -0.98195480153071146 3.6848993065819906 4.0350642669124142 1.3799037466130308 0.37988617788146278 1.0499883869426943;-1.1636910573509174 4.385298495301269 -1.6665559652679192 -1.5344701460753218 -4.621182479530944 3.1280435032239362 -1.3210714832784118 0.82597151400403068 1.6375903539608134 2.5538373796397429 0.71954368708935657 0.50000165895299453;4.1682084325837909 0.66842142235582025 -0.76971965155780808 -2.3766953445201526 -5.8624032203351568 -0.066301485885551431 3.8497993686119121 2.6890471853654243 6.750225907645186 0.69197439094165902 0.6635219420741636 3.0134433625946535;-0.098868214121691764 1.635069381801777 -0.076497274297569973 0.8156453218549703 0.03677790640630324 -0.42965214391252765 -0.26519931426795579 0.12567353344757759 -1.0946650511181311 0.1708505095179623 -0.21115811660797348 0.18818989231486283;-1.3199009720967259 -1.4299147189426127 -0.041122471231066743 -4.896503496143283 1.8133509601598579 -0.71224428227595493 -0.40470549470546102 -3.0750280215087678 -2.132124725667397 -2.7726679455410896 -3.157540267118776 -2.7576567114918045;0.66419201527383076 0.58258908836937218 -0.52636591034425373 -0.27132265522164983 0.38745221113592904 -0.5602910512491952 -0.12595430007462954 0.85049277515948185 -0.5919937960475592 -0.54874190741462237 -2.2595076597185981 -1.193170176890394;-4.2910900146040829 3.2020334047674686 -2.0256852498780513 5.2374518852963554 0.44383085420486146 3.2837491742934524 -1.8887579373113477 2.5449227035371678 -3.2841167543290335 2.6418976216845405 1.7295991551031962 0.55495098410910426;-0.91873528461651177 -0.035454548627229548 -0.11966050693971576 -2.454315354826158 0.98175025086583256 -0.78767240844950137 -0.060691211036311171 -1.3347802350067353 -2.473545992168007 -1.3728024996144264 -2.3463149376001295 -0.65251465582535795;0.22572734137640066 0.16005722268720088 1.566639304661201 0.72480213025255635 0.23927988906151346 -1.2050694607750989 0.062525397258249474 0.88277486363526059 2.1148430212167888 0.67401973542536653 3.9900754928359601 1.9132190359960004;0.051497681944122436 0.38630868777147132 0.63668404893499775 -0.1348253603706531 0.36006796975788513 -0.33385617553567792 -0.19004315312072148 -0.40787414493284757 -0.096535054068069018 0.080557882158037719 1.1506002243348914 0.5759693877860188];

% Layer 3
b3 = -1.2375988820431987;
LW3_2 = [-2.9364001436216904 -0.079149936319992939 -0.11059644342461934 -0.11280451656657417 0.13912576532554596 -3.5332822324943849 0.12709465224616542 0.20750786619800143 0.16767293317912749 -0.25903361866696645 -0.13944448155703768 0.36695737445235438];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
