function [Y,Xf,Af] = PM10SantaFe4(X,~,~)
%PM10SANTAFE4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:33.
% 
% [Y] = PM10SantaFe4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;0.00341273633199099;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.8740782687400215;-0.85884923325931961;-5.1782108054542162;-1.5768575688514594;-0.15133170301119719;0.11836893218658912;-8.4814056940714373;4.5282008897025063;0.36780734065136533;-0.52718241730953064;-1.0276171106529046;1.1088216173001118;-2.9975790563333766;3.3389537759868335];
IW1_1 = [1.7381480526701318 -0.059046028133780862 0.53043367707573874 -0.12196290791498227 0.60986684790783308 0.85854643171225942;1.6013153615589621 -0.49337013813966635 0.49435643629692061 -2.0231167818283091 0.43141620132761171 0.23196689231569345;-0.33937957042185318 -6.4222755596029657 -1.7908226758700669 1.6803330159418359 -1.2310385887649429 -0.07308173574571189;1.7448927521856763 -0.013518668736074171 -2.2873786417642634 0.95391649821841762 1.2618829250884833 -0.88784350726747341;1.1483306946343772 -0.65067376872089466 3.857219190374825 -3.9486298592383067 0.25494129826379519 -0.70993877499007696;0.84625373039405027 -3.4506031740546006 -0.32086848208144869 0.75897665364603084 1.9274442409147674 -0.00056601461874246708;8.9147010710077055 0.3373435440296973 -0.37303495215549576 1.1903408151208756 0.35769625693664092 -0.19603944825041775;-5.2110572194820559 -0.048299410729206564 -0.00103890896030236 -1.1759417230498916 -0.37209624733967483 -0.12240979593681034;1.6959507362485855 -1.3407954702056268 -0.73176653982838002 0.47445379226907397 0.15720176953561116 0.22439874662572029;-8.7896661800193332 -0.85680804910126951 -2.8986555431705763 -2.236258757277612 8.5436297540401522 1.4433128670901501;-0.010001386646263221 -6.2824469714337088 -0.2687259046671111 -0.66451991740995098 -3.2638682399874646 -0.13765099252887061;1.1414671461403574 -0.15386818964652221 -0.1527109587994534 -0.7058804412318862 0.13349214323011446 -0.93842979419180395;-1.5759880243970377 0.16671800556768601 0.89102968222213497 -2.1323010676564831 -0.70691372149381237 -0.79058156142207592;4.5760580137293099 -0.22459475814318686 0.28671025119520799 0.72328544508048698 0.41865197191774739 1.3155941224715535];

% Layer 2
b2 = [-1.6593115921737367;1.0774045064681115;0.62442410163920459;0.76943046457360553;3.0711949154838258;0.98411232590542974;1.3713641121118341;0.56875911959181569;1.143903012593638;-0.52973761415167675;-1.3105986322550476;-2.7318959882927527;0.23057478721143268;1.3773680988116279];
LW2_1 = [-0.78940901517157558 0.39093775272079073 -0.03960613685296261 0.22875549380564703 0.082717233530503378 -0.43000955428229548 -2.041161096688934 -1.7993914598331235 1.2493337641840954 -0.32889169116740891 -0.23832123372862676 -0.84259155338729486 0.779351346956762 -0.47030715340264573;1.193756433739656 1.1643396735925768 -1.1359227557720117 -0.5745512072960649 -0.088339433237255016 0.11227101304006355 -2.0123314623368076 -0.15632752650131815 -1.5130209193342949 -0.1105493794725432 -0.41276386647082003 0.5739796601922752 1.6825767677513266 0.079074326048506088;0.80813048800125575 -3.6229298554194052 -1.1376616112224713 0.39061289677501754 1.0058870587961848 1.0251170667954796 -3.0507791873348977 4.0283557698495454 4.0281006425336781 -2.011736668495657 -1.2348758449508701 -0.24273871201127864 1.42423816404496 0.15302726410858822;-0.36056851987119731 -3.447097922499192 -0.58498618860324891 -0.74087836663067852 1.526287708189813 1.4220723024668878 -1.0710797537546071 -0.0073511073509785543 2.4329654077176972 -0.18837892348683841 0.84207198335763744 0.35664748994044426 -1.9183262870786271 0.51478874446512879;0.41521483755680622 -2.7773606269520976 0.43483100188454638 -0.86082550148064096 1.368255538884728 -0.73835929729341665 1.2168883518236457 0.80192515187286351 0.097510869341247544 -0.66739509349086723 -0.73032217195348104 -1.2804787607981878 -0.35285479036432565 1.4146704133782255;-1.3725526093406686 -0.57251378391123364 0.59302383871409281 0.44579972005278401 -0.090600540341962341 -1.0755869613547517 -0.98116374707071019 0.63330432742023257 3.9775048967052617 -0.030757948430122885 0.80924905024348925 0.40057407204991469 -1.6790360059230949 -0.17064837816935485;3.5518766863367124 -3.4766029747396345 -0.88314734846768517 -0.69292226581832039 2.1240654865283641 -0.64407099357558695 -1.5139022659682919 0.54907489040736102 2.6047561263611136 -0.22637692117852126 -0.37630074911660932 0.32920342339598596 0.73519918807322659 0.56362481777563345;-1.4182784461204916 -1.1728560171355269 -0.38299963513753232 4.3888620847843063 0.078484487255886776 0.69023729580347182 -1.091312523647157 -0.31203054365899935 -1.7517199431687218 2.7976834753751754 0.25746334329671239 0.54007881306669625 3.1313403401319735 1.1390896443454963;0.20218364302022829 -1.2307746480048662 1.4070409243570154 0.93092540766726284 0.30523050592629936 -1.2000701017058855 -1.9555139079310209 -0.90594992596818968 2.5661768742046211 0.22972747149435227 0.60133216071034901 -1.5356141973457103 1.7784343081809995 -0.18517655358544902;-0.73493919622714721 0.043966473275818596 0.62223213409609746 -0.26318248604350913 -0.038622084347755367 0.54717224997879588 -1.7182436938397936 0.19951755261086718 0.50768113152370564 0.033109244623650197 -0.24872164673356142 -0.69743597177151673 0.94919007991757032 -0.39593757406372543;-2.7203343920996321 0.78278237870318879 0.89864265977718838 0.40862487267476694 -0.83042133026637899 0.21511808670521818 1.6169167771142459 0.27145405498310848 1.8440036116863527 -0.56551213238007558 -0.44967633883284669 -1.035370898369927 -1.3213996429411519 -1.0039353204353039;-0.12613098426962574 -0.25828195439624002 -0.93609722834787079 -0.82154670008930175 0.7983449389543521 -0.10443101065986803 2.6609094967533728 1.4576934879591188 -0.022177433296132126 0.39531299771655243 -0.22683273224298611 0.70218235131922946 0.18997247457725375 0.59382420544087333;3.621001676355216 -0.29536564047519087 0.3832842896615089 -0.53166949669218144 1.1816285339509083 0.27105141513381753 -0.61191688471511829 1.1782764109767228 2.4663306975079831 -0.22416623249049539 -0.46940299050352308 0.22261515868756238 -0.14767929952230952 -1.0247276053536236;1.8045734375353504 -0.50743925640934395 0.33993213916330861 1.0408821522247385 -1.4440748119683939 0.4941101741225008 -0.78537521668943189 -0.61912563790641539 0.50957121925482884 0.60557830711701499 0.31712600096708116 1.0026608679012403 -1.0549065529223489 0.67583962665680053];

% Layer 3
b3 = 3.468358845728098;
LW3_2 = [1.4595840431583103 -0.2471470310657175 -1.9333797803245822 -0.99559009064878268 -0.31237983129590374 1.217970504047214 0.1340927359496194 -0.10930990904378196 -0.24243112612283649 0.42076263912151934 -0.26813871864657396 1.389696099182836 -0.14087487486016406 0.21566904698823705];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
