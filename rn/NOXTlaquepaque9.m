function [Y,Xf,Af] = NOXTlaquepaque9(X,~,~)
%NOXTLAQUEPAQUE9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:16:18.
% 
% [Y] = NOXTlaquepaque9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.03490136570561;19.6078431372549;0.0212539851222104;0.0523560209424084;0.00632111251580278;0.294117647058824];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.2743982690278712;2.6866072699828161;-0.53033567416554916;2.2942660404259767;-1.0087252072478938;0.21988056843346304;-1.1800617679024494;0.84546282096875602;0.14127313222656146;0.43312810392216772;0.64250276275093521;-1.4257426137177687;1.4723304050541561;-2.0622224897158263];
IW1_1 = [-0.69962158431304267 -1.7768428489920391 0.64835176559521424 -1.4750308071480083 0.14168746062597815 0.26163459658923832 0.55396062726078865 0.049250908856186798;-1.6870438910633279 -0.098266661644266756 -0.028215766738031972 0.55459680291882718 -0.13528488016119794 -1.309314779831527 0.5199286193244238 -0.42906336903401843;-0.042116849946645121 -1.11031722915428 0.49223383044519387 0.46291941926388352 -2.0752346532579047 0.09641357256410385 -1.0940373076515688 -0.18056527886144474;-2.60855046483048 0.1587648953448223 1.3792013773307301 0.39430832040718583 -0.74166020578234926 -0.42095206253226486 -0.10646984872777401 1.1975065045165938;1.0385157223120762 -0.038461173169701462 0.62358170374312627 0.37449884766053881 -3.089024144964104 0.043465627965935727 -0.13744476009951917 0.86535251838340688;-0.099926942250417372 0.028874103038826253 -0.33184448278906653 -0.36157928759665026 -2.7957761833294303 1.8672711908439643 -0.55213651255978635 0.54613223533029609;-1.8606636214651879 0.026047254927931487 0.56188295154510615 0.11588425994205349 -1.9225203257882488 0.35273112037187548 -1.2759977424181395 0.59088848765421942;-0.25346999964520112 -1.6019292591617289 -0.18798425851641659 0.43858521923705457 -0.076339430393984206 -0.44584660933738879 0.13838648155305266 0.080889766449014147;-1.4141820426938516 0.20954801363805281 -0.54252646982313413 2.3515622015304851 0.18121043703432249 -0.092898728866102745 1.2911512544123069 0.092586329371780463;0.16268521072138181 1.510859488438171 0.44316417627069482 1.348828126453735 -0.70024921384091643 0.78999162709975346 -0.14977348685177633 0.36031115073121206;1.2097980403555038 0.69135225697546343 0.090413627034443778 -0.73357322880775599 0.10031328913388657 0.041936042407986839 0.3494708317793434 0.86162799110127886;-0.043706930690059057 -2.8296833164208595 0.76030520701922177 0.29542409615631471 -0.41632151273124024 0.53028444689546861 -0.54089842420157874 -0.90538007644567287;-0.020656512850967756 -0.53069073464369942 0.42525343656726711 0.80840146831090243 0.29169319661256699 1.0896367044988096 0.06028894597887198 0.17942120468955025;0.15344151804499301 -1.69438835962085 -0.54746155417514453 -0.6817817792869767 -0.064814264910761588 0.079115778832556577 0.44470060695171515 0.12071636320251082];

% Layer 2
b2 = [-2.0948896533475692;-1.7158897574253091;1.0649265217512491;1.5592398484132199;0.47382578766223143;0.36094736896599972;-1.155719500395999;-0.052767207316124373;0.26313232486512661;1.7564866164632038;0.55351666100261132;3.6001251091540225;-1.6136829035983251;-1.878407029543806];
LW2_1 = [0.27105685372192578 -0.24998668950916295 0.67975749526403928 -0.420010289655667 0.98024869698854078 -1.0483243929742669 0.16817356200441974 -0.22517364172760707 0.46826155437133221 0.13228681779466836 -0.1438993283437294 0.46660423507728666 -0.67998657904329773 1.5943036660540786;-0.60262793166449857 0.13003315658448206 -0.78266570214785758 -0.1513056485283403 0.47285287017028882 0.075681157298398472 0.91933449835592662 -0.53067588597760706 0.20483783618211496 -0.16359395643593294 -0.72228296725653029 -1.0638158349424804 -0.045678248305347474 -1.1395773683598391;0.0081943538913740732 0.054925879180877449 0.28550405599043016 -0.3362894321374994 -0.010408350009948802 -0.19536531551271918 -0.11621685573206478 -1.0530437313804728 -0.208865243276423 0.020787466458381448 1.0286980395008831 -0.11746238093947287 -0.83249617652033137 -0.6486887272222257;-0.98667241361351921 1.623829082017864 0.14768024961934312 -0.3332508006036613 -0.71860908916226585 0.38715449141212671 -0.23058885274770763 0.68933743889607724 0.012907363786673412 0.08073124845639712 -0.26493811574538084 -0.035380859079398863 0.62104829677258921 0.60472074480551807;-1.7859367972538074 0.74213366349631249 -0.079072180433184799 -0.17526471485340053 -0.42423587660172923 0.28565832989944212 1.0113337368195847 -0.46141873954983681 0.33184928403751934 -0.88336696456061647 -0.36094825604143344 -0.24427820845487003 0.0425502856289059 -0.26689675507971666;0.037784877999223351 0.65491604058083497 -0.4930418908963925 0.16255213805422047 -0.19162700458724893 0.71586493495088743 1.2143114136451583 -0.8943278802110235 -0.25788321288035959 0.40000262282559551 -0.37536899816917468 -0.39691562786889434 -0.17455591264222076 0.52284260572113284;1.6930178990929359 -0.42502579081398123 -0.64371798793001389 0.46456077317032624 0.22548524900923131 -0.73277865937284037 0.2136950336554701 -2.0337485809796756 0.064541830664848698 1.6154592650513442 0.21990275134345258 1.5935374201521411 -2.3558053234264347 1.2520373838219583;-0.088644273654113565 -0.43216244860931741 -0.40904180324238504 -0.096289641306938928 -0.096149098233647395 0.34953892589476915 -0.010119022419846524 -1.4037909192880722 -0.31529209254642093 0.36307962552215028 -0.83975705947567947 -0.35368361828879569 0.80782100332812434 0.45591307714594403;1.0916683824818747 0.3174236398733119 -0.68177474563767881 -1.4445847031791792 -0.60769888547132966 -0.63332029041520754 0.64705495830430704 0.51121339525754728 -0.23750866430446266 1.3089712621151275 -0.54422724444882842 0.45993828488027949 0.13247978645930267 -0.50196776003341548;0.91286777391524465 0.19721410556389465 -1.0600585591179366 1.3399692027644514 -1.3335413237372822 -1.4990806957831195 0.37078022364593333 1.1829768429635301 -0.90018831488897511 2.1335191192274099 -0.47765557305429218 -0.16949253565866312 0.80927545832548642 0.60136723841207562;0.32107809354069022 0.81995360900348002 -0.18161866725539128 0.36266437110532634 0.012583052627839861 -0.23490163433375297 0.43920531518204797 1.2876183657586624 0.54450207967248732 -0.2088822072327173 0.54509836903127584 0.43198044862547497 -1.1616183655534629 0.32478019057899854;-1.3124076312282849 2.7375813437655299 -1.7210440598829719 1.3462484564050443 -0.37911108620116657 2.0430473949027554 -1.1122254623915591 -1.2437660821924479 0.12851071420443066 -1.6234216646107935 -1.0473042216348318 1.1341115618857307 0.68610999286576002 2.0709812147518112;-0.48661972825338196 -0.11321278352979421 1.0457449669045089 1.2071535520296814 -1.3172942031971697 -0.95190290621546836 0.53060910087511071 -0.021347774923167528 0.42909908014773934 1.7573775531542524 1.3216065889714141 1.7345297435961515 0.21050640273339422 1.9325846848097148;0.38923036902630881 -0.28460233018657505 0.72565388464575797 1.5739524754480898 0.53932011529719015 0.69785387808272803 -0.6635971457957397 -0.76138006675503966 0.35872496824693173 -1.4904284319256615 0.56475668887760255 -0.51933192911035941 -0.059680665153875823 0.50935806860639088];

% Layer 3
b3 = 0.98278840650249133;
LW3_2 = [-1.7371442613047241 0.70931900256404357 -0.078033608911035293 2.40542946726729 -0.29738992570321732 0.25972046565617185 0.88044821797552775 -0.84890170277332655 1.3887484162644632 -0.31669578162127643 -0.52460464653030625 -2.5062583051921781 2.0109364392270521 1.2401496504091285];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
