function [Y,Xf,Af] = PM10Oblatos18(X,~,~)
%PM10OBLATOS18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:25.
% 
% [Y] = PM10Oblatos18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.504512308945221;0.55352530923443688;1.3223189978586056;1.1356031312040744;-3.6878196347369259;-1.6501157175166838;1.4603570199367566;1.4691238769133119;2.1259597751360131;0.20183826430661361;1.5680555671024929;-4.4867927744112723;2.3419199105939201;3.9476522040431541;7.4545099797084236];
IW1_1 = [0.77249835966098956 -0.4672808230714588 -0.24927986508738914 1.7594691606046882 -1.5998579753978939 -1.1751021787425813 -0.57957743566954412 1.0045896434000026;-0.77764865199480826 -1.7781068198222016 -0.57023678977481906 -0.42277443347631904 1.4247430010741917 -0.35037422841472959 -0.047680978111466821 0.048274313418488257;-3.4416250892141864 0.66231459317743668 -1.142961422321894 1.215470183506064 -1.0275925414389901 -3.6947618029252784 0.35858606431600903 1.207348134117928;0.1890751199035034 -1.5470103454221458 2.9612680347912232 -0.47431258628826423 -2.5609915543833455 1.6862876181073589 -1.3514337470856501 -0.10906230025030297;3.9419787353281173 -0.46178187580508001 0.0914924531320227 -0.48904732087422331 1.0505991901712501 0.18169799245067719 -0.095721782129224164 -0.70964951066950099;-0.64015862725944916 2.0466049058746907 -3.5729263988302402 1.4059764884173198 0.69984376228626666 0.44634297584149507 0.30210235507585992 0.89911369235612082;-3.3275292862821511 -0.27185128776614792 1.3942683879082578 -0.79723660528339724 1.782739261819946 1.0575091657656774 -0.2076912044760808 1.3024356590280062;-1.0933594822916077 -0.37899235160711825 0.73255785959532638 -3.4516405072308967 -0.63800172977032732 -2.993845076412045 1.2614385954697198 0.40091874062383343;0.40820452058165729 3.6172295166037776 -1.7514386926959278 -0.35967948633335545 1.9995518857645087 -0.33446459025824771 0.46782243949001967 -0.40733613750112324;-2.605940376432887 0.14692641787976327 -1.4292770757062383 -0.017996581374098826 1.6850399062936279 -2.1796053972796665 0.27442805265837916 0.085942439011160124;0.78643157862959912 -2.7404345720312779 -1.4431328813316233 3.9299034848812817 0.7412301423379466 1.1444253286470056 -1.3337756741931657 0.092285016468771852;-3.034235441964245 -0.51635668764582454 1.2560507991358032 -1.1405759844752217 -3.6470029500113545 0.97297855534695399 -0.52079488529836793 1.706503135268413;1.1194256248090817 0.92642946680991944 1.8661096598080724 0.75088250109964594 -1.5482424953806599 0.39995586896472574 0.082440893304198765 -0.7527153019239976;3.197642339158453 -1.0471469061836189 0.81816681607447383 -1.7030179585658485 0.025245360429712965 0.20305649879200527 0.13186945982340026 0.7556558171411043;4.8130132603046123 -2.680714685156135 -0.85616422634214773 -4.027571440402486 4.0832059905247791 -4.6290092362105693 -0.0072098896638089563 -0.10775240391470589];

% Layer 2
b2 = [3.2304075862658119;-1.9846621962036328;-1.5782099746091369;1.2997683785487484;0.94095281946342335;0.82614066991588786;0.77736342925287927;-1.0470967565561087;-1.0875498955009297;-0.94490392457231842;0.55128624076776789;1.6093978622651033;0.77077610263269181;1.7010203731895048;0.40096989277495937];
LW2_1 = [-1.5648710108240738 -0.44724432488855731 0.088702201561164026 -0.264512974369495 2.044949215010639 -0.47772203738161861 0.087386142313618478 0.59057035449562401 0.15564453958338167 -0.24867346854005962 0.74913697219032471 -0.35001385006440755 1.169946613710023 -1.4818402531479689 -1.476989431086138;0.37960301009745362 -0.098440519377830049 -4.4407136104135585 0.1496088971738303 1.5089674582987798 0.16238384092029901 -0.48112434563125933 -0.75066391285154233 0.049091854823205022 1.2964214081469814 0.55373222937248101 1.3986149717942276 -0.015094126283420212 -0.6419753953713353 0.58229054674961411;0.019203979054257039 0.25088335247835669 2.7356724025606463 0.11132019648274566 3.795689651251446 -0.014542936104774445 -0.74391042110780925 2.250602283814739 0.0061553525228937563 0.22187228501529693 0.38851672476966487 0.14805325928423091 -0.17335609752600184 -0.067490388659907613 -0.37948149297329742;0.63068362979436932 1.8963582605407114 -0.41016241605491666 0.19967372694107682 1.595904066079888 1.3905604641434481 1.3491994496023265 -0.31542595438013893 -0.50447143613305723 0.52308977097875087 -0.64433165830661154 -1.3099871757494939 0.46727527905063176 0.20970293284989189 -0.21398699352034389;0.81033869023071103 0.094749997848469672 0.0066409681816843799 -0.11395101894936864 0.48678602385716052 -0.43335688141470674 0.29264617562438261 -0.17918093137067506 0.30785976058686937 0.44849881020887616 -0.01448388948834114 -0.24926826059387158 0.46625702472400654 0.14188734544366807 0.0704470230264269;0.2022842117363646 2.1613188012267499 -0.10300347144562194 -0.48131092878055948 1.4549090064929597 0.96372896868171809 1.0982204228246626 -0.77563472267735267 -0.81467503809553443 0.26383689665521931 -0.66386787683765847 -1.3750957716288839 0.049494085764736732 -0.0032258019876780335 1.2050595616331516;-0.84962500929092355 3.4771583530680714 1.8945577272861633 -0.78909381129843303 -5.1027468639581564 -0.87739823649893756 -4.2188797334892865 -0.9386478778883961 0.56481905451538961 -0.6945802163899546 -1.0578059504595889 1.7157531490603053 0.16600498664679109 -1.0158926419843597 -0.65305380070962227;-0.45684012125048246 -0.14686847714107804 -0.31768302320591879 0.29589962728908925 2.5897171994785615 0.55947300102384745 0.12395032262148961 -1.3046104084566863 0.14516998054362704 0.45019658648053434 -1.2430753545395834 0.44472093151770115 -1.8685297645023238 2.3222875151301108 2.2867602750889757;-0.76864807171882887 -0.35574267765380824 -0.08175252167455492 0.36960733170483362 -0.3860983997103366 0.43121868914792522 -0.16593850933739887 0.2423700054425853 -0.25113873607652953 -0.24140562531821905 -0.05944657196986082 0.38344008346547348 0.50897214239435773 0.079626334817899339 -0.73048639786151259;1.3495632996902347 0.73543495089552091 1.1877622781636346 -0.05597896249047063 1.4550542112131648 -1.6101047764796967 -1.1286993158390892 -0.23405770436748491 -0.15373278724934678 0.80936972558549791 0.10726479538587191 0.39684877739604313 -0.62373974075974636 0.26472719698879027 -0.0029319783972667594;-1.7232334200974391 4.0551095211969166 2.8352763089122579 0.39520754417315251 -3.3346155566890605 -0.80514697777688837 -3.8907768387795238 -2.0947099388498658 -0.070521331663274428 1.9975355968252479 -1.5028106961048506 -0.48523996581766715 0.14110612588594648 -0.45418717886498955 0.96849471752704785;-0.50731752326406654 -1.3997724330961268 -1.0502179812660044 -0.8619038104076191 -1.2427500743776023 -0.41910045465074813 -2.3776590124011494 0.24893823352868683 -0.95518425712915633 3.8795382644573011 -0.067570412508814126 2.6486584615277677 4.6964889975474593 0.99743939277823834 -4.2263561435483048;0.53484248152777558 -0.64086064490616168 0.17032319898778586 -0.17503920963794295 -0.042199762032925067 -0.54067323212183471 1.5305079504428769 0.81195868468656129 1.3472888543365587 0.083503046556405072 -0.061994043513436084 0.83906875462945441 1.7871324226860588 -0.081827384417026541 -1.8956457406430709;-0.74937203558072474 0.13038135630612091 5.0920672338447819 -0.22905590359576294 -1.470282330031661 -0.15802117294343862 0.35954470374189373 0.97365576586129565 -0.026486675087774907 -1.5365136269510813 -0.33389114854984381 0.12714273788684291 0.31642813295216604 0.46506487018665582 1.1242271756279931;1.692170344438457 0.052864468383121518 0.12478419738452275 0.18966277209748414 -3.306720059361727 -1.2712377669484156 -0.97857669115839818 0.70941793036894196 0.37816251372666571 0.77702765107009064 0.73846349544958656 0.40834582853174234 0.096199081066657408 -0.66783571956231713 -0.81418479791044629];

% Layer 3
b3 = -0.10676036900575217;
LW3_2 = [-0.9527094556886313 -1.992532478166092 0.40804527880307767 -0.53462357630725554 1.2635320299861013 0.51518934189964516 0.21479840110404802 -0.54109360305917109 1.0026773976077983 -0.59797263626361974 -0.24808967357735928 -0.14396811846273055 -0.21515534123029956 -2.353300084199156 -0.39529675354382299];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
