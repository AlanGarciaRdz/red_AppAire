function [Y,Xf,Af] = SOXAtemajac8(X,~,~)
%SOXATEMAJAC8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:23.
% 
% [Y] = SOXAtemajac8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;16;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.6845471518022777;1.9641897232598113;-2.5104706304278492;-0.34204081246208756;-2.2184961117891913;-2.7489769677812119;-0.043781590698805758;-0.97943122634317836;-0.79510025970546794;-1.0700262953003095;-0.55146783770383012;2.3689307745835073];
IW1_1 = [-0.40965139113160864 0.44520228744966839 -0.48547384525338139 0.63709062796765714 0.12029887642782969 0.25829354530946741 -0.12932160108276106 0.56449562528915842 -0.36533678812507542 0.080398061759775014 -0.29000055737988906 -0.59538264962314225;0.42856205791558305 1.0842045267844722 -1.9814798103894142 0.11521714298332104 -0.7366474412355819 -0.47207060045746185 0.73010366665694526 1.2632174983129412 0.94877480768809086 0.5653544460217883 -0.37800694340878377 1.61534986015559;0.48666889918308465 3.564221130359027 0.40143411120623462 0.24239170618749101 0.048814084332971637 -0.31196469982284736 0.1695971592104501 0.22609691652849909 -0.27223820835505652 0.67069525439610556 0.24334525533614687 1.5066171551653533;0.16299379405022194 0.97951353659762497 0.42953776121756604 -0.014646766981401473 -0.14692735043505234 -0.50711742797180348 0.23098781210087169 -0.96958968978517113 0.080955235752616844 -0.22577826869785336 -0.18024044484430335 -0.38736930839608424;-1.5026419237041941 -0.019151087048883599 -0.76266323289652815 -1.7093206343316698 -0.16303491400186176 0.074162697903253597 -0.25650422824243152 1.7215661658927794 1.0027768236864625 0.050819625461031047 0.063012039172382836 0.35247058996265113;0.45703396003830954 0.71034397489270329 0.32037117280514354 -2.6254049217420645 -0.85041007287583936 0.36489191934733528 -1.7960108834662019 2.119879389475896 0.24531888173092142 -1.1474908590211699 0.00062751473228355586 -0.47490449286034003;-1.0868206568143695 3.6198661536980477 -1.8629703871791814 0.46531548170616543 0.40838816079805651 0.24677516349029796 -0.32205833204071932 0.93376207712516046 -0.078318755811990964 0.51225540987274953 0.39307283507233293 -1.7825438238290745;0.95826975678596893 0.043230997585723484 -0.58309419287702335 0.22957367041594562 0.049235813495975833 0.26269298649394862 -0.14485236842193155 0.88824389354466082 -0.48787757883228505 0.094898307988786679 -1.1285861062412934 -0.14195141168068803;-0.76334993825287578 1.3415280708036794 -0.0032618884608424607 0.048457337705216402 -0.030009114629454707 0.03384423834111043 -0.50442068998177725 -0.030768383271971664 -0.58277222847488441 -0.25336876354468801 -0.086288410232431126 -0.083845534047517295;0.066086041349236985 0.049936401607433289 -0.4683809808176902 1.1313933321140233 -0.33491719933609604 -0.8519063722090312 1.1733931504522483 1.1027958327207084 0.95358150020418653 0.26148692539933399 -0.79783593761134808 -0.25244514843344101;-0.048620978551302804 0.084062714099767066 0.6520361920834199 -0.049923597940427049 0.035076489857883288 0.042139718368131976 0.24830614883512425 -1.5655133613368015 0.40527397459103881 0.12960785185535667 0.18371621908640384 0.1545534137141292;0.68499429689627234 -0.44062365908301665 -0.52417031796584868 -0.46551891095144954 0.28714967410253461 0.70043869845276052 -0.31867607985199276 1.4983997211012066 -0.2220118892806866 0.32822750294417663 0.29291975884841004 1.4262369156784587];

% Layer 2
b2 = [-4.6397347228182637;-2.9980427001349264;-0.19665213219955913;-1.4441177899518072;-1.0408988101844143;-0.15606728849465024;-0.41301065449261387;0.42029257925254676;1.0791059809286652;0.0055927662432558815;0.81662327084522601;1.5826406557298103];
LW2_1 = [-0.68949695239844966 0.11938082294446993 0.94624268210822438 3.0454126341689021 4.1302245806811619 -0.13164835145529227 -0.079804699440089 2.0678140207226092 -2.1462945806968863 -1.3319218049991142 -0.37438063328741805 1.735076389743311;0.83674808849940396 0.46421987335762549 -0.3363751805399765 0.732786998686344 -0.12597278477418469 -1.2625308285983512 -0.64732023475438272 0.89203567856460841 -0.96295027246785247 -1.2553392082625752 3.4947207057612122 -0.26770825244911789;-0.58155260690338795 -0.63251125252676599 -2.0984468962018963 1.9246105092508983 2.3262660275662848 -0.392973332787728 1.2860395246098164 -1.5130630645309491 -1.7544116313138707 1.1480675298998044 -0.045958973576103339 1.4166598597149094;0.34587296818307856 -0.4049847738567745 -0.34668197556748376 2.1068882135295586 -1.1641915764009385 0.4992232868634715 0.73155260374755271 -1.5464006557851793 -1.4099941508182527 0.12298650374776482 -0.71250942949673701 1.4999742269756693;0.49661938478366496 -0.70318433247101564 0.0031973975243621486 -0.24629694570435046 -0.99029811257476619 -0.37707433990949146 0.22515870645558803 -2.0297562959015174 0.45938601293825998 0.40328812065642528 0.48284698272166016 0.16997496871124296;0.46056557784020408 0.16132611256427964 -0.075271975654627343 1.081012327051772 -0.3470627834046614 0.13757126054419544 0.36612651262227619 -1.2639437731291085 -0.67364635415958851 0.17393805467767537 -0.43816385021382792 0.99473155531579893;-0.34972068663849154 0.18137321629939379 0.28148865079663826 0.0086669820657016422 -1.1227784223895378 0.58068130914663807 0.38493092437496429 0.086892602939587754 -0.35812503594933209 -0.58534575945848644 -1.101260772929435 -0.31282847640172345;2.5455867398279541 -0.95523275738880631 -1.2558870965574074 1.2090172274432904 0.61064463433474803 0.55228522066230568 0.57022660144263115 1.3416079664017573 0.24948270840258452 -0.24999465938168944 0.60057257888953774 -0.35866240293429275;-1.8067777074586535 0.28589953353680631 -0.23807477045640613 -0.84688305351344684 0.26158854269736798 -0.10307218247364902 -0.51647258909904992 0.989876873781249 1.4786468334662466 0.31972351631764701 1.5454894620642072 -0.052322221528269312;0.29749817221346775 0.31492237661773692 -0.26840386852732229 -0.76955141419719109 0.15124828747087055 -0.22950212209416176 -0.41335837817307813 -0.32437381045861413 0.029150401304499668 0.45903530205346804 0.80477005602546303 0.091817703811768403;-0.62146712856104469 -0.51568255754101344 -0.13492038057341779 0.055596300514527949 0.26854424956288242 -0.18746177027966693 -0.096204418422781338 0.23875504282724533 1.2242867013628724 0.14845501659743765 1.0553007635989817 0.035364848056981084;0.044701921344127003 0.23621024742575247 0.058946993223430819 -0.10910398607162103 0.59779864265287819 -0.14184321349242784 0.016035983261212639 -1.7380166637233303 0.68526310685695546 0.55842841122092368 0.80911349596279658 0.73654403368636689];

% Layer 3
b3 = 0.039155629680893575;
LW3_2 = [1.470558160386813 -0.26261977818144761 -0.41756400142821887 -1.1576956535537375 -0.4775133917217127 3.0054739102945551 1.3026234559356289 -0.51395301507818891 -1.4029236559190592 1.6354313409543837 1.6847691870549504 -1.1015385260301875];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 166.666666666667;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
