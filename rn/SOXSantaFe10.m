function [Y,Xf,Af] = SOXSantaFe10(X,~,~)
%SOXSANTAFE10 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:50.
% 
% [Y] = SOXSantaFe10(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.875872551613345;-1.751032457911025;2.0169172632570098;1.1213088879115134;-1.0714447768266904;-0.77216204078510597;1.1067409388965308;1.7474114811038166;-0.17795805235672357;1.7326708047427846;1.2131525523884621];
IW1_1 = [0.50124755490522577 -0.22398434820531837 -0.46975924125400087 0.42697243271535551 -0.2015833662019717 -0.50523371549467522 -0.063601013197606596 0.070535826673847626 0.73785924644166934 0.54404938455477647 0.48243789299033352 -0.082086960685371427 0.67485242742675522 0.1185994636617459 0.18379109318239367;2.8545668791784204 1.4209308368883704 0.44005177190949385 -0.33784582848503319 0.12344410838039063 0.34299999885958138 -0.66168321857709045 -0.3946531448620233 0.5761935952908751 0.18003205921177479 -0.34007648745917507 -0.36727276752862276 1.1539125919515305 -1.0781993238237264 0.98457742069587229;-3.194819140370452 1.4505479455192021 -0.87324023766730008 -0.68733801771722614 1.4646827024046802 -0.2973965037273758 -0.33898342241999446 -0.10219701486793836 -0.34750041756978584 -0.79298316493602194 0.80142345636457446 1.5825237642559478 0.079040142951050357 -0.067055892726681054 -0.93999802799851251;-0.50459421625368617 -0.34361209122695446 0.36054281437402219 -0.19313565889782536 0.7406042697089209 -0.55196305998811968 -3.0686537379633747 -0.26787999452121836 -0.85814599029505256 -0.50498711088907688 3.2469656643280769 -4.36867522354264 2.6334742239679438 1.1028906690924314 -0.47067416139881391;-0.30603085766805571 -0.25967780615737568 -0.11141669283261264 0.086017822293787238 0.13842792485206162 0.13979261048001429 -1.6421891984135235 0.042682753236585637 -0.57795409428666455 1.2088943643514596 0.40836863388864986 -0.047953354519251166 0.3092676411159398 -0.57779485998931501 0.3562749808719014;-0.78542135314373018 -1.6557299658244005 0.95863105565469431 -0.58567137907539735 0.76395239136934567 -0.1398221724015821 -1.1549442148545559 0.3700099993791921 -0.78840907428378293 -3.6358133898814931 0.97449339451236516 2.1592896091560467 -0.90115685818404101 -0.053947830614401143 1.2705794799835461;0.060126759491144675 -0.048189791399912987 0.17132699183717842 -0.27785831264578698 0.91421782496959703 0.12601113715262782 -1.2581355331601878 0.036675663423113562 -0.2379665520854824 1.8970646968113223 0.48885854852762478 0.71485459970190024 0.060769842180346922 -0.35907939264773464 -0.50218952964346741;0.085601027469033697 0.18894396898323271 -0.071431626782723315 0.090031254889706674 -0.72521193963268016 -0.15700306100057171 1.8624341560520219 -0.050055277226345632 0.44647300913423493 1.0344436212614816 -0.58835098601767077 -0.51341891239672921 -0.23811745657441355 0.71070726249278482 -0.67906600046289844;1.5519270068274975 1.8031897844659279 0.15224626793815438 -0.39428443641948424 -0.04207054725602468 -0.079688120080722305 0.76844760862222916 -0.10785808354124168 0.1426266880918102 0.1689205702936587 -0.61182939867363983 0.05497144393237486 0.56743359768888979 -0.44998946473545365 0.51565414024699607;-0.39944789144492926 1.2539564001281109 -0.17405084490887354 -0.55112080917229345 1.4937028167031341 -0.24779753174224783 1.1688263791287532 -0.093790804130839567 -0.30757353855673597 -0.95678608015007272 0.21174578292807766 0.65152379466944466 -0.2139645634798677 0.20364991926745049 -0.46627723264105958;0.17976467716678921 0.40212094791448239 0.82795198732161701 0.48767096052196102 0.6655171900927398 0.35335397009765313 0.50997150036635253 -0.36012250810024893 0.7818716915709778 0.1645378955585487 0.35450273103195906 -0.46949219219808369 0.70573876482991538 0.43888274385292414 0.52510801181848443];

% Layer 2
b2 = [1.4325000340193479;1.343677082248669;1.5091326483679612;1.0363386896235651;-0.30615297231251054;0.016749035019948136;-0.88122846705212543;0.62315650570507575;0.15473953407574295;1.506746964892695;-2.3319812674109324];
LW2_1 = [-0.10578215793642592 0.23653566107491106 0.33211756100579504 0.074170438087786936 -0.79858849981805602 0.25719356618070222 1.4975437401671037 0.38788094114225669 1.083793139138155 1.1982409914337069 -0.19691189917829771;-0.43444674869021438 0.083838177985559093 0.55248644120863488 1.5696396147971876 -0.90712882872363021 0.10891828465443329 -1.4015821703110851 0.19935744406047512 -1.2435114343512812 -0.85211661940207739 -0.30925556288234579;-0.74172415278543991 0.16594077180070918 0.87072923230819266 4.4816748250160483 0.18212251287709325 -4.2696917054220194 1.3984899774738493 -1.0231763464735106 -1.3813888546284641 1.8308442291296592 -0.59439097378597117;-0.57637061475452445 1.7829254884607439 0.6276810412949585 0.3431725558600594 -1.5172365148817648 0.71735512932075896 1.0758814844520586 -0.29986021904854643 0.47777787794611276 1.0972811037117751 -0.10415314357896605;0.53304174037626018 0.015043829753322822 -0.028951635268832581 0.10236260251563678 -0.11620332398265329 -0.13982276197626453 1.2131118417733548 1.0340793881678612 0.058932155046291256 -0.66679985544090126 0.24044277918843918;0.60988687733559321 0.12901650052940536 -0.14409330997651043 -0.18037841546502242 -0.1282292878516576 -0.40384282173853303 -0.35513739598895661 -0.53154856482371493 -0.59231502975740324 0.71563397033363241 -0.3480249585121758;0.17859412800899838 -0.69738400625959263 -1.1082170380078926 -0.59264810385646982 -0.61347581322522149 0.25941764516179239 -0.36868713815713522 -0.3888329437522437 1.3238670841566706 1.5361915457904247 -0.35694057140681057;0.67355577110859821 0.19613212592456702 0.67531711308477593 0.43985427615462003 -0.3404812492146877 0.48710108545612102 0.0028032015646432124 -0.072532695564751851 0.092662383648484795 -1.3446825862696941 0.144210499962872;1.086435810687554 0.83484186007954309 0.31642109475327057 -0.64201708211539499 0.23425484973239283 0.13773342958354734 0.54770808392115722 -0.34384128526213981 -0.88713676913228823 0.074171944028509157 1.034947065217561;0.59029342432255161 -0.15123905169774948 0.0068662544952363472 0.52646739951214794 -0.34042014934664838 0.54895066920770164 -0.41994540252895901 -0.12050893060047196 -0.35392949173304417 0.56224580823939052 -0.12226803874682678;-0.24508189643863726 -0.0026772531026858087 -1.635048465677867 -4.1045347953397853 0.48207469344013976 2.4492944602130882 -1.3521100162007655 0.9817840653022698 -0.20630695100152985 -0.70804573133910076 0.10177733091803415];

% Layer 3
b3 = -0.91397067726920356;
LW3_2 = [0.62320289823814012 0.90788606554089124 -2.6786684239966512 -0.67500153912235028 -0.56649393544938387 -0.6437319987485346 -0.25575104317416009 -0.38128914728156726 0.86466843934677728 -0.8867126062557118 -2.8706994092758142];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
