function [Y,Xf,Af] = COLasPintas13(X,~,~)
%COLASPINTAS13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:01.
% 
% [Y] = COLasPintas13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.241545893719807;14.7058823529412;0.0179856115107914;0.0558659217877095;0.00576368876080692;0.212765957446809];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.3991005979311151;1.3149190848674386;-2.9069012895163482;-1.7841721923230576;-0.43168884691444087;-3.8857881487982051;-1.6798877597601689;-0.25791288808117602;-1.9554828053108697;-0.36697138579487831;0.900996329761513;0.80921334927805466;-3.3135628933107619;4.6465023257469973;-1.596051735410698];
IW1_1 = [-1.3018645343403099 0.30549967056894439 0.86742148453825219 0.35586880122058273 0.30143618706978204 1.7428523834165839 -0.20699570558024447 1.0283456174165564;0.12761677539521105 -0.34736129287523654 -1.6559157589270674 -1.2145759972462591 3.2178233182244442 0.27165869328215064 -0.53623257630770083 0.13889580691253958;0.39982614805899097 0.50813528487911119 -0.61089054730767522 -1.2831906498371011 -0.50155281098518212 1.2660226327592208 -0.22087881530933526 0.20575473925050836;-0.45401582890743686 -1.5896402182310518 0.56730254270384195 -1.910222825279595 -0.042690888988648645 0.09422854122769285 -0.11462708044962194 0.93325656056907236;0.11232456691635472 1.4688692792951619 -0.45498884510898374 0.63502493611185151 -0.16265643914688546 -2.2405380355684512 -0.3451362008288329 0.41464568342953079;0.13534730085390645 5.3188944761891843 0.051091212954777435 -0.088955559808365545 -0.090219015803908689 0.2367747737282872 -0.14690211214517698 0.12985685570836308;2.3091742678276304 -2.0292562152082638 -0.47775309677607269 -0.24133638076124525 0.11386798918565516 0.33310538208214852 0.11114057224001829 -0.48290797958940329;0.30376987044862014 -0.57489564531405557 0.86454976464129629 0.51133680939240411 -0.18149292028521305 -1.0335705548165928 -0.053858181433179969 -1.1131942613748247;-0.63020290507781684 1.42111055229114 -2.2303465648682823 0.91226201760858627 -1.059609375154835 -1.3849099507484919 -0.13063843404982192 -0.02147168835849288;0.7915146783279019 -0.12935843807699027 -2.2689440292264194 1.4824720183376889 -1.8417502818281566 -0.4678855650467888 0.085487619792313257 0.56320193059190571;0.18475820828041814 -2.4893171660922899 -0.18128327908694336 -0.37084254831575258 -0.15640934716249985 0.22949220196179318 0.072956306069862253 -0.16812450302577106;0.072776048256499012 3.0745940284286815 0.95112471747358418 -2.2063292969623109 -0.30989021561662505 0.9343428101226382 -0.22446816209608889 0.078157928355064632;-0.41416110427198827 1.4261248785908829 -0.0012796310275886014 -0.6927710581820401 -0.33915040423215881 3.6723088410788964 0.091508837291068928 -0.1834453441838641;5.5128397770408855 -1.0847958015477464 0.14782328610141499 -0.57428161364423891 0.72769235498136453 0.093372714295988202 0.018199877650194603 -0.12185174682423081;-2.2972010227784221 0.74909337612661386 1.3466670048242255 2.0214191078082333 -0.78277077303561438 -0.44687281990744182 0.85756278357893934 1.042916909257209];

% Layer 2
b2 = [2.7259063315475389;0.50695921884316897;-0.05531444566291259;-0.82719746776139769;2.0612474599044348;-0.38448126937567856;-0.5510949556425514;-1.5125762047956961;-0.1712622551122911;0.20278300122352552;-1.7227813130938574;0.99497083796555352;-1.1918544528318391;2.2330243807968375;-1.642892734908638];
LW2_1 = [-0.03414748811408895 0.99932318520702956 -0.023558219056184 -1.1449197536940821 -0.36001821613970059 0.5561404987746037 -0.15029104937904184 0.29059343109136271 -1.2179805238196788 -0.47942124826822685 -0.059384034482223388 0.30334123339577523 0.6451893664052617 1.6242574044885836 -0.25886164425614977;-0.47214390822802849 0.29879220028369535 -0.22619295324620503 0.85272768991082837 -1.1184723649733479 0.5173579712430405 -0.40368196861161204 0.45706651177041557 1.185787213653984 -0.24040606666437603 0.59500101052896348 0.1096374748686211 -0.49787409877359967 0.6575645876834354 -0.3966748236514962;0.3106590509177295 -0.036875908390042428 0.26456294752132198 -0.13228138750608065 0.1372753559894283 0.68227181796541625 -0.19908923759184829 0.27985782025534195 1.1968309768214109 -0.71886113214251823 0.50874869279707569 -0.48881236478436391 0.37107785244073521 0.0053443876418276803 0.56996950953163183;-0.33099116565078845 0.2368724167616216 2.1399315994027859 -0.12974438525737927 -1.197712365231052 0.74780830805336107 -2.8593632252885426 0.27491037386216399 -1.3272566671834156 0.12694307262872256 0.19834193545481263 -0.2620651133979322 -0.74982385987773292 -3.5061724038551594 -0.5221416715685222;-1.487386933400078 -0.13547333048108767 -0.58680644457741793 -0.22686545479716622 0.17608433924430572 1.5114530777316686 -1.0217103120679962 -1.3941632129394608 -0.82960069374369205 -1.6275586311549841 1.9446945892650418 -0.25566220994013944 0.05970200908371795 -0.4421921121279313 -0.77047321778512079;-0.35201682591806893 0.63727399165392185 -1.1001641720419202 -0.070304715340593432 -0.49706248617335053 -0.083659281171650238 0.65721618427464656 -0.43705073007079898 -0.75286688274750124 -0.26396962303591109 0.66021364436987739 -0.11093760081270961 0.92518805513991187 -1.1374293321048365 0.8795380116097069;1.3901087140257222 -0.2636311448784614 0.17859510890846286 0.0064140809594860956 -0.35991059211037624 0.86252205885893962 0.8594615697402479 -0.017319743993735974 0.090958483100118781 -0.2759021960407762 0.27926311343494237 -0.10051207149228876 0.19075198814136288 -0.6732481177509626 -0.16742541560367447;-0.12782471649963867 -0.49622096090214374 0.5656207224579578 0.29176973757866348 -0.92696117112993215 -1.4364239354888875 -0.33244513150770155 0.32348783522214875 0.91413691062656666 0.081565437363283963 0.13245114608017411 -0.40303644968191699 -0.90874827339348907 0.37892846506223815 -1.1417931723113011;0.40340612142115534 -1.3753666182253259 1.3154005365381227 0.026686051790618392 0.70912452119326774 -1.3028955765209895 -0.39092815562676914 -0.53237444929940858 0.79590516523535493 0.27768614929179991 -2.109750021014686 0.24524346621983639 -0.56583913157767551 4.2673566622992647 -0.44313610213254045;-0.094642820905992797 -0.51386621553482592 -0.20098502652101274 -0.17949741772532576 0.91598112977430302 -0.56018397464905234 -0.90362895209565353 -0.43489850355987431 -0.67858591356260667 0.2247745555064887 1.0093379238341382 0.045200310133613877 0.21729090642928148 -0.58963023903441025 -0.21308806385441681;-1.4149017492307081 0.83435486355595512 0.40323651049900605 0.010425077164477964 0.57409023867200215 -1.8475267735417376 -0.4478240099132581 -0.32104787768275345 1.0935861281336763 -0.90507098487697801 -1.3569694743034877 0.34781917754295016 1.107016715103144 1.716046611648762 1.4534015251992134;0.6232729645170586 0.47450489172558236 -1.0627885997446089 -0.047738986202363158 -0.29822943332306906 1.122487958562683 -0.09825192694961149 1.2233446968752775 0.077967873452936903 0.27485240876238876 -0.059513490767331659 0.38595754588115189 -1.6159370407786815 -0.16706041533856775 -1.7801057486605776;-1.2038454389275168 0.10782581312383943 0.47732534014180134 1.4221372559946222 -0.59329939275904786 -0.49055704039744952 0.67040678067860027 0.6492139608312365 -0.12643476977255963 -0.42617384115577595 -0.77367731094548431 -1.1922913428747115 0.28328784814958402 0.13928887004118262 0.0016949927279654095;-0.49024587797207164 -0.27063434056563807 -0.32144588847388139 0.86420375252034465 -0.33518247599710099 -0.50339791315091076 0.66022837709819604 0.099678663054585143 -1.0173748310642521 0.60009712870972587 -0.065740017938061834 1.1378341317533249 -0.35737577974661922 -0.57533191496663594 -0.31896737571241579;2.5941285069085942 -0.2201495149250848 -0.15738508666086568 0.11281006176532206 -1.0262234691652958 0.37313169871129442 -0.35066150612179114 -0.077571974218592937 2.0034897295929426 -0.65346803460299152 0.67948685529929043 -0.10020783250809627 -0.18835382029326631 -0.76963644552525368 -1.1918413389047215];

% Layer 3
b3 = 0.79230760440796;
LW3_2 = [-0.97021993987305866 1.5029854233867321 -1.6968505534592584 -0.59241440481925889 -0.51386459387857542 -0.43753044294071702 1.2728377030932196 -0.80492776317157655 -0.66114274593674427 1.2549882161029586 -0.67370288762341191 -1.3184244949520469 0.17891753037638758 -1.5135607636077129 -0.51743941986810682];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
