function [Y,Xf,Af] = SOXLasPintas5(X,~,~)
%SOXLASPINTAS5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:44.
% 
% [Y] = SOXLasPintas5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.0179856115107914;95.2380952380952;0.0558659217877095;0.00576368876080692;0.212765957446809;166.666666666667;45.4545454545455;29.8507462686567;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.8866048564810391;-2.2117616103818176;-0.85869196206537812;1.4582445395672798;-0.80628968083577357;-0.86281007155178913;-0.1464943395451053;-0.17899383131200827;-0.93186859144036061;-0.099667194383446442;-0.91680314972362242;0.82802838531051037;-1.4385400589791586;1.0467130108361735;1.8586518669813241];
IW1_1 = [1.2838639975556896 0.2066251579295261 0.7945806214140908 1.1699512233781051 -0.037901380229890855 -1.3025714527752255 -0.53959601049818406 -0.060407332879776968 0.30017434779849117 1.555895484823276 -0.54517288486810078 -0.57599349952864765 0.57904384479949889;3.4867812203878383 0.18333880581499523 -1.7537932108325236 -1.2374736266316086 -1.7851137735054097 3.2133212999576672 -3.9832317765941556 0.45596506274711374 -0.96312746463506049 -0.90950075290957155 0.047979681725257101 0.57317640612495924 -0.52681446616858751;2.7377786046722714 0.012916054283032812 -0.21865078091824719 -0.65817138580419843 0.37835984193219907 -0.71698074347798013 0.67074769445330618 0.01536052701875382 -0.16601556266086076 -0.70711418009732829 0.073773508534492258 -0.78845496676583882 0.50321778998551914;-0.53636641312835165 0.55512714282056297 0.28381807128822406 -0.35356911024208038 0.6103251430166825 -0.1083172016829326 0.91029375702284587 0.12076191625788342 0.31672321228856759 0.025953743191088369 -0.5817298572597952 0.014228206090458363 -0.84502483354196545;3.1074075791780937 1.3089029561399839 0.2987584488810624 1.1354968472954459 -1.1976795876307773 -1.0530813258955409 0.1802263164810719 0.32908022884014182 -1.2493783662929872 -0.16693602902337878 0.6379256946511207 -0.25206725553895082 1.1832929516086852;-1.2433139208318873 0.24394809268633955 -1.1650269000548998 -1.0841056869340284 1.0119920751805496 0.48317678437326861 -0.18169996646939943 0.15562671987385479 0.67272601472111071 -0.41271977681766187 0.11489620470723226 0.15824381961946329 0.89796318758533622;-1.9436640130263969 -0.2435167963429466 0.48311502988971505 -0.10396641392011305 -0.85683146283516531 1.4822948246510814 -0.59779164766329984 -0.0072617404810633689 0.014738240377133602 -0.33069730734842306 -1.4215782456295027 0.24364766993899775 1.071066275668104;1.085756498771018 -2.8533134525449144 -0.54258140258039178 0.22409409804650005 -0.80926817966643039 -0.21797026460423446 -2.6129246536043795 -0.45346775334126105 0.10936058295269499 -0.32532739411650169 -0.29961635974146994 0.039905773735243788 0.36447095310493238;-0.63694343561999067 -0.84059613371323427 0.97461594578508437 0.022150937930759063 0.60585771505325048 -3.289656660365047 -0.60979255911733055 -0.34622567339353633 -0.20367883418976274 -1.110605192080061 -1.0648438993272129 2.0314515393749488 0.57085534999517096;-1.2753106936772545 -1.1582661991355512 0.38827135153431708 -0.39653929969807378 1.3398701908324118 -0.87463381130210727 -0.38838302518683154 -0.16741023242571107 -0.07385767330756951 -0.34862307355434485 -0.34480632159535157 -0.10926365739914128 -0.1566791494508962;-1.5345098096951082 -0.32310979735156892 -0.13493099900078642 0.26854374019546223 -0.66495817728464934 0.1000223152787463 0.01123315202662422 -0.090770320851625147 -0.38723682251832825 0.27900066670507084 0.28101949194421461 0.29106598298251474 -1.373927750229528;-0.52174977155848601 0.3613741136673943 -0.097739341781514541 -0.22453642137923585 0.068610238195765116 0.44466362736963461 -0.22190098642419742 0.087181126871566234 0.19332470109675046 0.026138464904072477 -0.48805521360437509 0.015011544667055815 -0.7167585367832322;0.00046041099221044842 0.37735695766833638 0.28864680303700396 -0.17443438020517071 -0.15685883072087067 0.65649791046908423 -0.49881216106944409 0.21884766781670512 0.73340291921659151 -0.58484592721929207 0.31598117055992303 0.74820442355376227 0.92854799490641859;1.2766748063832236 -0.54262230084551166 2.4844980358881021 -0.42232597001869188 -0.71194530385276633 -2.01207926003431 -0.21993654368536175 -0.116957659552081 0.55171811354769573 0.4920456781602196 -1.3384687622245548 1.2225180109842231 -1.5340650163378795;0.49393149152582522 0.20333148561868231 0.063432636442117538 -0.099800499146578958 0.25269798697146961 -0.26095242566387916 -0.42785010661176748 -0.47242569674377272 -0.9034984182890442 -0.77347128018092715 -0.26127260392974733 -0.40347261370901283 0.29618588289093067];

% Layer 2
b2 = [-1.43328582569451;-0.92359367217310728;-0.99343960475862769;-0.88849303653527334;0.65213364694895215;0.28194039054255959;-1.504664649859573;-0.18938261222469227;-0.30173457287121469;0.36651986645158724;0.92051936601133211;-1.0257016742527831;-1.591465586627608;0.84292812870717382;1.5750841490307703];
LW2_1 = [-0.15015696527840514 -0.51786702265049089 -0.86708052909058964 -0.21788055511337442 0.93342276126726376 -0.22106261560200177 -0.30694261301899067 0.47059073193645345 0.33304733308234424 0.20900281769067927 0.016512736293731456 -0.21131308544651436 -0.39791979443604714 0.17409244537867513 0.3505217205034728;-0.28510469056026189 -0.045920431109872359 0.11724711974677482 0.66706690659567303 -1.1434741760597107 -0.31405236409398429 -0.64032539786188902 -0.14221497212587253 -0.031511026340542883 0.43784664459644829 0.094510110748447021 0.4125349488807224 0.31506966035580808 -0.13658818781403517 0.75374842393689423;-0.2136320558621643 0.17511723689247399 1.6816900705833282 0.57334942923159438 -0.72828902797647865 -0.36282854893180627 -0.79911569147194306 0.03966266742302247 -0.47500207776985354 0.16186975008713758 -0.4327328484231609 0.54221876107621836 -0.80620205404049949 1.3773927655859286 0.36806228409406827;0.27463534805172607 -0.53092422886290969 0.3312121924562228 0.17922168674686439 0.72446776182057826 -0.53807406958400883 -0.3981128074977095 0.10805995013513725 0.49448501437822195 -0.091639946376573397 0.59321545669800313 0.70970862287570413 -0.16248291273285645 0.76191588450561487 0.52866853346878373;0.049498201728863878 0.37147422465893376 0.83694603307969595 0.21210254926280767 0.0085241679382620922 0.03195627608038451 0.050206622348363789 -0.30770576530497451 -0.28060678457825805 0.11871391665769111 0.043962398631533256 0.76417518888037039 0.62241085952373876 0.099320334407828587 0.35157440318022948;-1.2734638005465138 1.0537244840489257 0.39096053028497796 -0.79313660287256438 0.41985837659260555 -1.0459555082983578 -1.1541371094359545 -0.53896845630708579 0.0051751204680226606 -0.56793267398485003 0.19270775356494207 0.31371412999529574 0.67522265054959474 -0.47208117756597112 -0.78738808113473635;-0.87594572397029613 -3.4103210207597994 1.5669964347892444 -1.5475044808578673 0.077034419599483733 0.8085048715349209 -0.41316872145753331 3.0869382778393244 -3.6485164260543761 -0.34212203046240514 -0.96561689791413685 -0.95700196103433866 1.5564694976972038 -3.4665095836270066 -1.1049712759977393;0.67339541343964526 0.56718567765831429 0.15686707687883228 0.065696326973412378 0.10914442351629214 -0.25332967935729278 0.66926487556070424 0.16098434978835721 -0.60879776611641823 -0.43723838642834467 -0.38628466703357461 0.21284833351194116 0.19896332239963954 0.38313572763364384 0.29157991328362476;-0.18160326359138515 0.26668994148534308 -0.35050388237102448 -0.27059218164990584 1.5174607548868146 -0.20743714614766415 0.49839670811237669 -0.2358593142313008 0.59765398318243113 -0.19326819776577497 0.30276390060113306 -0.69520278367680777 0.20841867311652273 0.21040658578004973 -0.48586921368848857;0.11318790502689025 0.42532685405724263 -0.51689666294630177 0.45555846055038673 1.3075117770998665 -0.19038484644700573 0.20678560559735004 -0.24873767634122207 0.28079932465504343 -0.1710144954750267 -0.12383108290517882 0.051440007916465504 0.81186352364167103 -0.60066737081617283 0.091965920547213295;0.57628626081249001 -0.22213924338029184 -0.59088032502031984 -0.31007840863116309 -0.7528415567642277 0.24220538972280295 0.31816134945728836 -0.23616577238734765 0.35841600465962942 0.70103766689439284 -0.17034759672301816 -0.46773448200694173 -0.35941080883318355 0.13227450279575342 0.68504533950854229;-0.86739889656093649 0.024011204533958892 -1.2282441492190093 0.15361172495082126 -0.30014644323148809 -0.2169057244928555 -0.8575573337121154 -0.095511389318656242 0.34427616100394365 0.24106079068868941 -0.50691043242050948 0.99965806617756869 -0.68285223424307717 -0.66369294243715582 0.0087311449619592446;-0.28613139218011924 1.1970927611220994 0.84698967842330264 -1.0632595028318697 0.13237918299571697 -0.61318271148373449 -0.10739791527239534 0.15857558192367124 0.25068918060276585 0.17907216951581614 -0.41394406867814759 0.14380062527218085 0.048603588794860889 -0.44643427661541113 -0.96153226117952229;-0.19015856153562871 1.1930261292020021 -0.081311532973120104 -1.1706271271488877 0.59086279228726102 -0.86112870687723642 -0.58140102061903076 -0.66062586825053182 0.13220384115465442 -0.76151500900546476 -0.16530837284464428 -0.84649321140317735 -0.12478698151681769 -0.34111579963586958 -1.3124460697216795;0.59589943391868105 0.17556017583632427 0.057580731990210882 0.35061590154344957 0.11661341201866179 0.80994107952512218 0.64003271552022356 0.46374071936812811 0.68716990047569682 0.033340671314634002 0.78580997884924186 0.22725535281300357 -0.10165674057869287 0.73904472511308739 0.4852808187433742];

% Layer 3
b3 = 0.41332413971093601;
LW3_2 = [0.68057663475184271 -1.2738169100237076 -0.30071177353393097 0.20520022196580462 1.1299006477531344 2.2780260229726683 3.1034153655592971 0.11836291976443805 -1.4678213643423577 -0.61109925882969041 0.92368312470131086 0.27760314709285927 -0.67164102994185437 -1.59946582843345 -0.30649190264125248];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
