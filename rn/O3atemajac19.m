function [Y,Xf,Af] = O3atemajac19(X,~,~)
%O3ATEMAJAC19 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:37.
% 
% [Y] = O3atemajac19(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.201288244766506;4.04040404040404;166.666666666667;0.0561797752808989;0.00614628149969269;9.52380952380952];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.7262104234953215;-3.4531583959226757;2.6936825065661885;0.86746380134247592;-1.4995331313863043;2.3826457397023524;0.80578464944541994;-0.17704469647629525;-1.0002093797554268;1.2589630995482444;0.35337155128953895;-0.033621598540410594;0.35777913496995284;-1.4791850606509291;-1.2030202264832512];
  IW1_1 = [-0.015789683703275197 -0.17733456560034205 0.3701493964645331 0.067360409513678193 1.4397096198380512 0.21685656301044723 0.071181499471446391 -2.372686271644127;1.3834935529284167 0.84408208776776672 0.84905112490975398 0.08437528947696625 -0.38111386369899863 0.42942004591046357 -0.067614239662544859 -2.3994929998940209;-0.85326628104555735 -0.050835805431953117 0.39327153024418027 1.567431130159916 0.19130956247685946 -0.14272959425023335 0.090510988378324761 -0.61033463648279462;-1.5069262005038631 -0.37306529451020226 -0.34149642617785703 -0.64038927480597951 -0.48572463061018467 0.97413916912328069 0.40254042329751433 -1.4422704505079296;0.51475017819870805 0.27098355983581202 -1.196537353016746 -0.71298285739404499 0.021429973379953497 -0.54916898898291233 0.23426048464490123 1.1358949261286608;-1.8274658079384956 -1.213086920676328 -0.36818134330978564 -0.9718887467048597 0.073764520880381018 -0.47995719095568862 0.07590678898904582 1.033612965155714;0.97785177206714735 0.90431658496752787 0.47485611432826663 0.42344827297525606 0.24799752085728838 0.50935634798555451 -0.15066095384930783 1.2862112330234039;-0.98943526429238193 -0.10311063178929085 -0.60782864875755549 -0.35580473392307727 0.019687034576815789 -0.046684651664697735 -0.15929603470988143 -0.33855981991953626;-0.24073463088583322 4.4869409992495619 -0.047018636464494959 -1.1864824244573284 -0.37981934770909198 -0.65291566206060203 0.21479082817181677 0.17063631705121202;0.19553883432414884 1.7634269664039528 0.74614072750121585 0.50471092319786259 -0.14302601832922268 -0.29454269852250115 0.10741940762545203 -0.28467913206216455;-0.69952087142583841 0.19050059119581009 -0.0044755866685682461 0.055344380424181064 -0.13370074945993499 0.068069002204962495 -0.0022877304340285388 1.3986529584498095;0.63594787857298174 0.015339130917443556 0.06508634872722141 0.1173666481944432 0.27850329523404649 0.19521037216807741 -0.29158675327223466 -1.0110765017318852;0.63342384154949005 -2.2152783854824336 -0.27064913159794785 -0.056146312566924921 0.32728925153163946 -1.1565502810058166 -0.15011998118012976 -1.4666437192053765;0.25026443910995877 0.11101884193515499 -0.21609142886828525 0.15088824267631401 0.26650110261454601 0.10216675944790311 -0.21203752874246337 -0.93390617961225253;-1.3248750543295591 -0.55851018817964049 0.56790508064568435 -0.40380919259351333 -0.14212041997733788 -0.36901770468767026 0.36376960053229485 -0.034572588159421658];
  
  % Layer 2
  b2 = [-1.0855986553789336;-0.8624463097602294;1.6120127931132699;-0.38415550406023102;-0.42928378929466809;-1.4319243645681341;0.28707918537633376;0.78822098331729618;1.0591990654595176;-0.084445498472718442;1.6296036707268038;-0.98879795062983822;-1.7879284170633047;2.015154449308989;-0.80372246817599724];
  LW2_1 = [-0.91531478965821 0.75425542136657586 -0.70696193506712257 0.17299015509372698 -0.73630079164827766 0.59558466595583348 0.31252658103851289 1.1949087071379059 -0.92695999732631806 0.48210540699953403 1.1405907004829365 1.1411615674933082 -0.71016353243616426 0.76866431220769038 1.5133381591991553;1.0216547635612652 2.8168836869110296 -1.4686905762966485 0.59513066734000963 -2.6340455319086975 0.4019443916825205 -2.2752894929502556 -0.13829183108174939 0.26273349117407191 -1.0677637855585858 0.055354072890716116 -1.461590027328094 0.025980063298993009 0.65731960286103008 -1.6047434633537236;0.42613551303799274 -0.99444490797692009 0.54029226707592803 -0.75421257270181952 0.97079293401088196 0.4231970860748529 0.20033164631288397 -0.97948235651852922 0.74663213015180485 0.10208919751413528 -0.9262157135241692 -0.56870707088593175 -0.20475038881655316 -0.49644981362901086 -0.10699770743676511;-0.39032841153460424 -0.54974793660763788 -0.67193609330566373 -1.5310181826801661 1.0453791095729479 -0.61253564688144835 0.012084800483095681 -1.3411392652525853 -0.34195765384484123 0.034980541014591554 -0.48401032554261464 1.4061669757544821 0.089238356287621418 -0.15014093249956451 -1.8238511407604285;-0.29629121730403335 1.1672758730372015 0.57635727929590541 0.14366177918748055 0.35498927793835966 0.62410800261604493 0.072551381646435958 -0.34792791251073607 -0.19139748798318271 -0.84824916976864451 0.020884888153293951 -1.1923549869839776 0.6573596268283497 0.63851916370760819 -0.66680695166941151;0.28348410956589248 0.14496102137808337 -1.9717094531519146 0.19806837925608592 -1.6732832142460892 -0.99533988907027271 -0.038340260095606267 0.87353462961341255 -1.3543267147661271 1.0382952925319509 -0.12585105326741522 0.053588696577846984 0.1158846765919497 -0.85554752130479494 -0.41449824379683931;0.31373755849242446 1.8110495847997294 0.27786674597225897 -1.4337362305721508 1.0201494996164511 -0.60428985388170786 -1.123001666230091 0.23667121271085734 -1.0216425970601284 1.7698100553638707 1.5207544834229989 0.46910624550722957 0.65918503932256278 -2.4991120991334799 0.0091891463456484079;0.031417677262842447 -0.51816993509615628 0.66310907473309755 -0.013922829111531419 -0.35167661812200729 -0.56869624168001442 -0.53932395000457367 -0.22055031804369032 -0.080491524771078654 0.23677809914141881 1.0063338372586239 -0.25699908587916653 0.20356606759167156 0.36196771569055886 -0.9659112075677555;-1.1371723560754972 -2.8643732539748812 1.0302111341031051 -0.31976198002663608 2.4763626550944848 -0.68053575425171409 2.0369114588404567 0.41684479148054704 -0.35043046508903902 1.0081473704124013 0.33361425357298757 1.7911786105698464 -0.11942607808676084 -0.39180054423185962 1.9673809475147752;0.42695808847202693 -0.13134299915269049 0.48841678045600478 -2.0142256106083076 0.90432795591344184 0.61707340886471951 -0.11006422455396883 0.76912095295069527 -0.3135795490557991 -0.45459537298011538 -0.23447326385775139 -1.4155823063759305 0.28746395712503042 -0.42635978069138541 -0.77501002466305291;0.29120879247602799 -0.64582816348882521 0.2223469250186233 0.18152792397137657 0.32528586007317795 -1.1006361889283354 -0.83368184179582094 0.43334507121330285 0.57466519601185784 0.43277249086446956 0.92176600311279178 0.56961826965987716 0.006387336131596256 0.2456751768540005 -0.16921197893961626;-0.58258908610071503 1.5350038558876982 0.3006458452999945 -0.59414045637914381 1.1859878914022262 -1.0274476567537283 -0.35484901287931309 1.5003092673621636 1.2278887696980394 0.98491428185798557 1.4172916969544429 -0.59923975760579329 0.44551343315770314 -0.23196129079611308 -0.085222943839059803;0.67079477207634441 2.7405489702843666 0.27461196573889246 0.13615219283823582 -1.1209427319327154 0.79248685522757167 -2.1435180116478754 -1.4396885097467167 -0.058193207608434001 0.85130735541841307 -0.017709429427779311 -0.99080863994025381 -0.022888425021313344 0.40985429956164893 -0.6455549761979541;-0.33914030263464284 0.51464511900361509 0.11644033556650074 0.56492378657419628 0.54911923884761282 -0.50796749394572727 -2.6411536671334583 1.1377513535741406 -0.24197203245641075 1.4318450342308682 0.83267827674866335 0.14308495458025458 -0.22815104195209235 0.72652339490779161 -0.24678583543514554;0.73820736545307053 -1.1527815724927881 1.8226839454111343 0.93413132146224076 1.0537580622098282 -0.15853335659115192 -0.37827801860737587 -1.8453068766456924 0.26356778122177044 -0.27896622819012379 -1.1016417959111886 -0.93357701719771546 0.62143420548925099 -0.46685762999256725 -1.5828788222482209];
  
  % Layer 3
  b3 = -1.0726213355215297;
  LW3_2 = [-1.9509950689568998 -2.9233693606070252 -2.5038483571490975 0.66975067965070434 -2.6482943409674475 -0.94632634311641861 0.96478891996307614 2.3049930092251074 -2.8456571877012435 1.4570894620342507 -3.1250848597651548 -0.62366666572605367 -1.335820952735852 0.97015619434088429 -1.949068272244179];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 9.52380952380952;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
