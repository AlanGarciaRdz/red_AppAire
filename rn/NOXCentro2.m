function [Y,Xf,Af] = NOXCentro2(X,~,~)
%NOXCENTRO2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:18.
% 
% [Y] = NOXCentro2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.74531835205992;15.748031496063;0.00773694390715667;0.0203458799593082;0.00627943485086342;0.132450331125828];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.9056104720383304;-2.1067523147336118;1.2796705950479303;1.1233188501626203;0.88771713322340429;2.2926554578579945;-0.92131856834255421;-0.81591013938035584;0.096782740166250505;0.20909761410708005;-1.4482136224812545;-1.9275599988123999;2.8303513444493942;1.8652977909214539];
IW1_1 = [-1.8353577348834511 -1.7522484567855872 0.75979724045424235 -1.6282100092791763 -0.90366564135410987 0.92632911373025728 0.56098375332498407 -0.16551628290618284;1.425990913472875 -0.47704439223987238 -0.48463602492876889 0.15100345404219359 0.051365204958657651 0.89887454542308887 -0.043467493401319911 -0.41659146138683778;-1.4732300094839423 0.50380757722994318 0.043038734696038923 -0.88864784514960105 -0.40389823594022689 -0.40063373699323085 0.14842683786667235 1.8895097014932163;-1.6712826164994674 1.8065297647551233 0.33042867488873773 0.95923317296514676 0.74099774296019316 -1.0731287077834926 -0.10495475926869692 -0.93822934500723487;-0.63065855654129432 0.18422583000149606 2.9196287282351832 -0.63743444464659083 0.1772291694082801 -0.56584982055369681 -0.019998965833002313 -1.1473243919318359;-2.7510112207825945 -0.25608469116520066 -1.0688205551207344 0.29948830504942642 0.0069778175408635977 1.1023372202824304 -0.011270250629287951 -0.34474779224781565;2.4232065986575893 3.4502411761840519 -0.064469146572813038 1.4140371459025716 2.4402800172957706 1.3402587188958064 -0.43780848361093055 1.7286760802163015;-1.5826602244528074 -2.2591280031675187 0.55780529938531165 -0.18246036670899593 0.025509929937836504 -0.42779855225900665 0.0029009519489643937 -0.73865094055353153;0.91939363310894595 0.33557772451383344 -0.31716578456530869 -0.29102470695636656 -0.55775035869486378 0.14686785046934914 -0.1670378923161763 0.042022445370588177;-0.32782847853830349 3.3893769670132015 -0.13377666649663095 -0.66783712530138029 -0.016671302479085232 0.0068848348471879685 0.068991495132843403 -0.042736088536475904;0.72818105661835508 -0.080940364430584166 2.347466689445552 1.0522457994368539 1.6985613321636801 0.24235228358614153 -1.013156020374441 -0.17761928940041055;-2.3870612120208192 -0.56227485568079816 -0.062653119341722352 0.15760360822751041 -0.073500930390211605 -0.5920408023678686 0.21202261657997018 -0.81894408628987703;1.1590431931841887 -0.31928170837351322 0.10147836186027076 2.3070686765375648 0.45731432923724158 0.74397975668580885 -0.00094000159115574815 0.89590905638264873;-2.1396920195329736 -0.51578977377110835 -2.0817406453664749 -0.69050256117166631 0.35538976991782928 1.6148070629345834 -1.2983120763802858 -0.97327176274008009];

% Layer 2
b2 = [-1.8827514196506823;-1.0006429253740332;-0.21913307955338332;-1.2905756465082852;0.48203652433955047;1.1811366344352392;-0.40459343089717387;0.98471986685585233;1.0099305521561543;0.3135026506483789;1.5815925197928944;1.1961902199413197;0.61291987448595897;-3.182004924256451];
LW2_1 = [-0.46232443126789724 0.2037083568700217 -0.3571676234394956 -1.4793223382638852 -0.13634985443259157 -0.94335586196370214 0.36941184052373199 -0.43765997346843744 -0.22175909987206352 0.33040142580527021 -0.57966437987419794 -0.6556314972461893 -0.79042262794249685 1.0307083528721908;0.087123844826438604 0.36030328995975208 0.35408898473036704 0.16477079431217051 -0.72235342528763236 0.30919119075704138 0.6508034094101991 2.8597152935876915 0.11540835671285427 3.175896768094133 0.54941402044124432 -1.0148935711179365 0.1200719420641497 0.21131035586194155;0.068235075504967685 -0.94941993038381256 0.17989026873114117 0.78590165886738905 -0.40645032394419028 2.1389640491502009 0.17082692818458098 -0.13829528733211693 -1.5614810324233928 -1.2720512562859043 0.78442389697005477 -2.1412872582814004 0.07898840289231146 -0.88826313707452986;-0.37311434529713144 -0.42459322336349592 -0.35116774783868726 -0.1433171390694242 0.45345168859897983 -0.71020428561868765 -1.3809665465236474 0.0061378862664857176 1.4653869867340927 0.94410637776813044 -0.10335033588912916 2.0542372802172624 -0.16362192352038074 -0.66740845203575327;-1.0147006008207171 0.4345620031650943 0.56442569804791276 0.82144206721979784 1.0098887806549695 1.1446359047923 0.046043625319408428 -0.26182185165859184 0.78219208307908494 -0.17093445538957278 0.63340019128382186 -0.23916152419044803 0.21766139773757881 0.75697181906708022;2.096233203631805 -0.093066409219386595 0.36986462481440563 0.87973898124047212 -0.17474820342945835 -0.64854580254422456 -0.23723147736742237 1.309277095740093 2.7350291931642978 3.6143077028231887 -0.81889058081161314 3.0251915413715968 1.8256669261039651 1.4051538665931667;1.4881518747855582 -1.8774663520834087 -1.450042919571042 0.10685679294276242 -0.22293626579418704 1.4144155536101946 -0.23082059548532319 1.7054205760986116 0.89609221302065067 -0.065184243335771816 -0.84361725367632534 0.715475710792292 1.1767397500420971 0.28571363978884029;-1.365949845730025 0.68786275008294595 -0.26852128387023194 -1.4583825584228971 0.32645116894645798 -1.6401237438968896 0.23513341772828467 -0.41428711024107279 0.80802237535351562 0.75554192020221933 -0.0089427711248142028 0.68754114831514335 -0.76026572338574516 0.83989731574467563;0.70652668662865037 1.6186367552741612 1.812399691946025 2.4037919759735251 -0.26025826069704655 -1.6464031754739168 -1.5688688019473609 2.3594029154026579 3.1440015155118912 3.1412860577629176 -1.1505896299225058 1.0016325651773443 1.7124595464993615 2.1176630354857973;-0.27527246043886694 -1.0669602667227998 -0.74938510083676069 -0.40155024314132665 -0.25842728565871265 -0.86467518493942785 -0.45711473449187756 -0.88769718413242793 0.36231724121994696 -1.0982691121589612 -0.8534262912050492 0.51009217164449916 0.54275953505472818 -1.0444927583792938;1.118009707122855 -0.38097032996395597 -2.3292185049507927 -1.1827695198828803 -1.6266306115733573 0.91038000351501691 0.83762213252760898 0.72363637948753945 -1.3073999692314577 1.9269194093640762 -1.4674761648925188 -0.44407455427590142 1.0386595562863201 1.0646738538681177;0.98407823981844433 -0.31605218328149043 -0.45470459123977836 -0.41796387265659934 -0.72319851189464168 -0.89895843718696866 -0.24025284082582615 0.19374872120292519 -1.1989001641002777 -0.17446666700427887 0.55853073338865267 -0.17792765507001687 -0.34192421776695048 -1.3327188661883187;-0.035558640261035099 -0.62672540184123537 -0.54845058891186527 -0.22928705346306549 0.13563540254708953 -0.48055471746042333 -0.60529570400459975 -1.5540118119929329 0.12328902167839741 -1.8867848257288509 0.12100262755395148 0.52319092771758502 0.28964118780679676 -0.22971539730646445;-1.3630279200487558 1.3863401592042599 0.53091892828955578 0.56920741974812716 0.10711383739905864 -1.3716940323656952 -0.73238241263922621 2.5324334313307779 1.2750686706355876 3.5541202544552455 0.92190523196389251 -2.361508367881874 0.35251404229435485 0.260999202907015];

% Layer 3
b3 = 0.47665835999389722;
LW3_2 = [1.1483992226094049 -0.59031249339261604 -0.92563225522203263 -0.82875180183800168 1.1244368693221449 2.7249915976378412 2.5930223913714179 -1.5335088806338186 -4.2804481807026917 0.87660730788854024 -0.49545416242546403 1.0991367820590292 -1.376758556144811 2.2810574702564388];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
