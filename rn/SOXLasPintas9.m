function [Y,Xf,Af] = SOXLasPintas9(X,~,~)
%SOXLASPINTAS9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:45.
% 
% [Y] = SOXLasPintas9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.0179856115107914;95.2380952380952;0.0558659217877095;0.00576368876080692;0.212765957446809;166.666666666667;45.4545454545455;29.8507462686567;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.3775420297874736;1.2611339292395018;1.1985477765365224;1.4376138511586904;-0.24298681051044832;0.0065237956367831113;0.36422967279192464;0.91507964803608643;-0.18839853832972459;-1.2176052970839419;-2.0489898755687772];
IW1_1 = [-0.75329511925736337 -0.64202103262380383 0.38925519764419114 0.18411285373985217 1.5541323698914375 -1.184053141842327 1.9448928533956849 -0.079914692746424446 -0.53261386532020194 -0.79896494890083336 0.87391775002558014 0.44878472383771928 -0.35825310663694715;0.20789147665778443 -0.26636050986499898 1.4482864638739801 -1.2112568796461523 -1.1550633428901766 -1.3515469123683324 0.79998916741746995 -0.14057125152183608 0.2261090644126586 -0.32785955792747612 -0.68890361915877452 1.4463079959313188 -0.2176190115181833;0.43471665347183203 -1.027419581018276 -0.94065797697773834 1.9016678418115798 1.5978791037663878 0.61948614645417466 0.35682850219390805 0.0013206881467789922 0.51097893000193795 0.65074509134443903 0.67469101572759371 -1.1686001126199279 0.60703280121499015;-0.58614739027294993 0.66356316102634716 2.4889368033896924 -0.33288912557392286 -0.80654077809536262 -3.0721834557273446 -1.6809352438778367 -1.4285522401806967 -0.88235882840271485 2.207251914091831 -1.9299380337629219 -0.51060188202994583 -0.27066995476365879;0.76841560391360197 0.59021947119802576 -0.028210046287992237 -0.47591801023564562 0.31512085522010302 0.32365124159214254 -0.054432961687048545 0.095337423943580454 0.034052522098111798 -0.24110401316350838 0.21157604823663959 -0.74769559015154818 -0.91090248252056538;2.7852068260696732 0.22517310831713261 -1.3401224874247726 -0.20073808493028419 1.1138219068382031 1.5972024947302583 1.5019745663883144 0.57286788351079976 -0.14826088392835296 0.041164737659682517 0.45954623340105816 2.0785485442024725 -0.42779173547872806;1.5183884348350303 -1.320805010926722 0.031379678568594277 1.248449737211109 -1.1788553101920682 0.55747074389947526 -0.019781796458484668 0.1786344929567546 -0.11496932370161203 -0.31797911677726282 -0.018550603025884703 0.24493067352183712 0.065679171934581601;-0.31818088803195194 0.60160645916818234 -0.19305537992216615 0.80233324011799789 -0.35570903467126408 1.4851061350194581 0.95974546581033393 0.25416062931138217 0.51125700572806088 1.5115747892990703 -0.1867333878554078 0.40157085288173555 -0.46609839417903076;-3.2549093786375489 -0.13622683445801101 0.62451971404231155 -0.262699547662331 -0.80334531444529611 -0.76490082663746206 -0.20157893283432943 -0.54923981050150572 0.11316810805973168 -0.058512767091071401 -0.23251396691241097 -0.43103433708644068 -0.90190618409284307;-1.8528353777756956 0.67200166153410357 -1.3103980811283911 0.68241696163860666 0.20505494207179906 2.9307826951093849 0.19768240407716375 -0.44079147748831926 -0.66964491016869399 -1.3225237868554536 0.78878383108657479 -0.13608231252859992 -0.51285274636080458;-0.49620011343915615 -0.78510478715666376 0.068895056566415619 0.93201927079922253 -0.077789428220642998 -0.44522780912441462 -0.23138009610044216 -0.065721975549109246 -0.027668279531367183 0.73677272374195024 -0.18073409824600836 0.49066126274084143 -2.5005868209202964];

% Layer 2
b2 = [-3.0802989923472337;-0.86253766038559532;-0.70089237280321781;-0.89837839480161741;0.72446419873479795;-0.08579256792742003;2.4452200647148361;0.44282980474422862;1.3428855691551729;1.7102653743439193;1.8248678573291093];
LW2_1 = [-0.69194068925727326 1.6800865817262434 0.17829114959595854 -0.68486049491385914 0.54494303986755044 2.3809644057711568 -0.45929434939826963 -0.40683638148112539 1.7547927989319603 0.74381115641466999 1.177368882989412;0.95303014014495158 -0.12897355134976826 0.11279228282623616 -0.18851397721467131 -0.022657136768394169 0.33656270761510265 -0.49764315483380894 0.17398843712669873 0.56624806657973514 -0.34756237735536555 -0.50688774907704415;0.87001393930399995 0.76240946772901741 0.18380092549678312 0.29515675345543185 0.1208621270622118 1.0373944002537541 -0.91935945742287339 -0.19016605616405688 1.5026743876976969 -0.38244617365889144 1.0514318113586474;-0.056497687281592532 -0.12192188305475045 -0.033978346246456154 -0.026834670835811276 -0.03248768686814104 0.043332160570765881 0.45219151931292156 0.036949670324849707 0.92846021904465204 0.73172884148339212 -0.42902772471699385;-0.50490858560532037 0.39925842038590048 -0.099893839692230757 -0.92082451924411024 -0.85781754063753757 0.22923262897514779 -0.77381150966532464 -0.27930728631388774 -0.32600301193492071 0.49262070133917718 0.46492002996149367;0.82231506115458874 0.22271421933846638 -0.054661295124013708 -0.63351590013220682 -0.80762860595735741 -1.0960044961083522 -0.62530494184348817 -0.047784714436045261 -1.1125956708067759 0.48944910567567312 -0.59161489783485521;1.4008922526497531 1.2698171858917653 -2.9810407829531091 2.9849724061903968 1.6002195074625492 -0.8439155122896429 1.2511722365283311 2.3094844922569848 -0.80022400605920896 -1.920594943926994 1.151578244737788;0.90057638489308611 0.5432788254685692 0.025248865043243772 -0.38175242642443175 -0.033900812491230184 0.094619060980084491 -1.0668801559145904 -0.14241002754256854 0.29442597301961126 -0.052257256579818112 0.74912937981042182;0.69158457962743503 0.53437882138921666 0.14279643879428555 -0.58819164702800397 -0.61849260997583388 0.60835323379051065 -0.65042465822268491 -0.33587212958132401 0.31763492156923312 -0.37154577418430923 -1.06034578271727;0.11902104062776052 -0.19326654828726791 -0.39235174691971375 -0.26435439618294132 0.040429101486709342 0.81057092099121564 -0.31876852377249953 -0.48116749006413256 1.4665743482442406 -0.45537826419513794 -0.11478947887635989;0.46332578676962632 2.1036487243176416 -0.90459270886413801 2.4683516660026856 -0.74969350568717219 0.31669141146946445 0.63839873283430881 0.78268592818009675 0.33878747447481677 0.68071523836707248 -1.0715803241394561];

% Layer 3
b3 = 0.98197410795077955;
LW3_2 = [2.754550268108602 -0.22221028636146523 -0.27124864939702054 -0.21946051741343142 -0.26495633051705825 0.2078868607475125 -2.6087733268914084 0.34976423482166175 -0.16440897933835363 0.33230652068678213 2.9157779126170391];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
