function [Y,Xf,Af] = COAguilas19(X,~,~)
%COAGUILAS19 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:20.
% 
% [Y] = COAguilas19(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;0.281968137600451;0.304971027752364];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.7744163355863778;-2.7971876466957259;1.426322862310905;1.2138990948216712;0.50482093585295129;1.4937422057570331;-0.52945844995631119;-0.42166135599451582;0.65494053513740302;2.3214361449698164;-0.77901055980120459;-0.56075001624498599;0.39964454260838234;-1.4010752506275801];
IW1_1 = [-0.17883665823057743 0.6492307603286348 -0.41435417753888548 1.9317624045403785 0.090799821505081368 0.66256588739669386 0.76634465628881876 -0.89096938398211822 -0.68708277961732889 0.097451036472518973 0.26072790695777254 0.022443733270039609;1.7758699422949606 -3.3727485822184153 -0.57126849422464521 0.94399513192571782 -0.67856673197027018 0.87688637091903432 -0.64484382811199903 1.0234613404680073 0.14402487649467882 -0.42323210609943424 0.052009975419382432 0.063539461335819072;-0.70244312892884353 -0.2162358081052799 -0.40000181531588325 -0.96552072646738285 -0.60344106870150471 -0.46680512808468461 -0.47881263674456848 -0.26353889952406179 -0.31139772502257113 -0.33819245082564364 -0.40226935296099581 -0.45605755589737812;-0.82189806337872851 0.82976141381960422 1.2298245434720827 -0.042657562935669698 -0.87397554998679483 -0.51407707273541092 -1.1274336205482178 -0.086983151528071123 -0.97589893627100255 0.38200865672407669 0.21161465030974816 -0.26532818149738624;-0.36222379057251314 -2.7741600255298753 0.49564593480167507 -0.1348130453952805 -0.31297615168840487 -0.5093646075899253 0.045756274119598546 -0.07989118255383422 0.24815380484469779 -0.14347225083686471 0.28585941675762921 -0.54651037291160398;-1.0175501922187991 -0.35322050576424951 0.26544121673875098 -1.143255796306434 0.69220200402013388 0.97067343742675782 0.65751920002256803 1.4729233571483933 -0.55008429530123537 -0.16078734573209924 0.07968820190785586 0.013947932005193725;0.77182956040421447 -0.14947012410550811 0.21872934175372644 -2.0846345283266903 1.8135950891883696 -0.00040517938375132789 -0.98426575214849787 -0.51362109063366401 -0.52606801282401638 0.43866664762527141 -0.17051134836817414 0.059986597273203657;0.10605840781837471 5.812907984124597 -1.2542655576328634 1.0886210563152128 -0.25420934598862027 0.051895235667852771 -0.058711039105452133 0.31519619033578394 0.21913637154613147 -0.15973711631709148 0.12761388280446687 0.18478508052069292;1.971514084529991 0.18412229626095783 2.2278824353438558 -0.17227930934442287 0.58847889780296903 -0.41462233847103724 -1.6011760086016413 -0.13626440890525124 0.21322707526764492 0.3757606456028455 -0.44368032804915863 -0.038190717040998551;0.62993618336818169 0.6549051991453233 3.7709304448168957 -0.34534067281976816 0.59930679976187062 0.20025264434026888 -0.24774810091891614 0.25146949937317847 0.24908104095070299 -0.01120186602432667 -0.72698373287078588 -0.75370841310105552;-2.7062828641489065 -0.57388203502255319 2.2465918004636767 -0.50163721561563568 0.39730613208496324 -0.73476110407982298 -0.36616371933955699 -0.053035582978920054 -0.37079328424801378 0.54770697719203421 0.05768210334406039 0.1104570124426652;-1.0265556193228536 -0.65268379634749085 0.11283052806530758 0.0016814911433300148 -0.72383270073997896 0.39531216481758336 2.1172590813528189 -0.91034007477608492 0.2788761051914207 -0.14071367820649261 -0.082198549456367329 -0.036091126553082505;-0.049655403134167705 1.5258725796807306 0.71942215055182335 0.95280900779531574 -0.1243925445714352 -1.2314478186139046 -0.90955353059687671 -2.6564636677110118 0.1208615875971966 1.2509674128688391 0.15608579692493169 0.38540052418888382;-0.10345647348740795 -1.0565762498026245 1.3701548968567305 -0.22644143164207489 -0.58539339736661467 -0.65823598830704377 0.19012979883466052 0.82340815839468129 0.62197668844873533 0.78894723612896522 0.45297501494491221 -0.56443480676651225];

% Layer 2
b2 = [1.8374111573556833;-1.6818758448891964;-1.2317208141554252;0.74286532996005794;0.34696461748125179;0.62463206730612342;0.039522699030336103;-0.51638444427385444;0.59202813713466951;0.86060568546353877;-0.67181373829354352;0.120007737317195;1.6453285814808951;2.2061458267500953];
LW2_1 = [-0.66144781202878145 -0.65302787308170107 0.25110774162920735 -0.49318029823505283 -0.79080812479256235 1.3556349013228521 -2.2728646031413717 0.85147293141223424 0.065148532282099061 -0.1104075132384863 0.81202030891401267 -1.3173040845656145 -0.61987626764952775 -1.0177935275267784;-0.3125107758768183 -0.20786626233438793 -0.063424077428659395 0.7424704111806355 -0.42341377403280955 0.01185372964948788 -0.32398836941940651 0.65667081236492919 0.22082966546931576 0.1617667253988096 0.18179669668334397 0.55400417983784045 -0.033411349665284619 0.20999244914470927;0.32605152722430397 -0.03848598779421851 0.26390961168780025 -0.49903811984862639 -0.5142983575490393 0.98877453147971028 -0.052667775978855691 -0.5948773565172174 0.030585346468500016 -0.027858599315128019 -0.023046092935688656 -0.04488138345232974 -0.082788150684550338 -0.8057588617043564;-0.02534405679112196 -0.45171958372170723 -0.95410164717348989 -0.10567209446828235 -0.15078684743967632 0.82966017080784382 -0.22805977729324806 0.036883034290185163 0.29959186749557642 -0.50676259623927322 -0.21030332678553568 -0.22775934288100844 0.047529376382772812 -0.20181587907312087;-0.32101309600218186 0.080065896585668969 -0.49710833416332584 -0.38415100332857366 1.3763288798525184 0.016771380255596893 1.0350150319191813 0.84788942654372013 0.52778338754456222 0.8989961424483297 0.43952652222556499 -1.0093138390001153 -0.66813884839252036 0.84944741726080275;-0.25454261134837941 0.18946102969885179 1.4387741619971508 -0.28397988867343754 0.013266600046428238 0.64374983924823892 -0.41110740851466671 -0.98077812259800978 1.4303856804580666 -1.8856794423279242 0.029957198267765574 0.81236476451353368 -0.12392252736889926 -0.93828167103460447;-0.12421016579680896 0.36445918216380629 -0.0044108987988927401 0.29939244345586363 -1.3911211729337563 0.80410535818623641 -0.80391815338142103 0.092025337470512641 -0.077065269475061093 0.40743793685473573 0.46761877235900434 -0.078058302673634228 -0.1127877280690075 0.15160843632107032;0.95271259437078015 0.80093112922834109 -0.42625554006872213 -0.87470832275803556 0.47618601525449222 0.36696426413891059 -0.15001166848972242 0.90824155166332299 -1.101118861644897 0.64964650546341729 0.19471842626873692 -1.1008240332732149 0.65323048132012063 -0.66954173682267648;-0.24132731431540361 0.18177480019620521 0.12454118789308084 0.45758957407031797 -0.061890402062798791 -0.70786834020083123 -0.055002396183075244 0.18441215246032067 0.0086940258034493012 0.1114756454703825 0.19091096088866985 0.3287176469666831 -0.08743608788285763 0.34257818850656935;-0.2010784766443913 0.72579336352028689 0.057451446204851618 1.3075205947829533 0.59811216902706699 -0.18999168004301342 0.051127029618994325 -0.99256819642940941 -1.6278955521036449 0.3561208198705032 1.1733191565335188 -0.021370645647240016 0.60749913088480167 -1.2457158761833249;-0.38568711314709281 0.8985909594735324 0.63571422663251653 -0.061049671862114796 0.3681885566480898 -0.24603297727087334 0.56461718005810391 1.2894211642448337 0.18741517765427071 -0.53574823167492447 -0.078181115424892408 1.0484724196285937 0.13735542232112993 -0.31848072329088839;-1.3233842185583546 1.0732456411759506 1.7075832870213568 2.1230895742780667 -2.1105546308182053 1.1419560810712586 -1.3852231650982285 -2.366837406653763 -0.53110988698266048 1.046442767074089 -1.845678344892379 0.37785592443232419 2.7444853283617232 -1.2535292461997316;0.12888238819552938 -0.014217068403703494 -0.3325621386988048 -0.66329232236770819 -0.22160512730611107 0.33428404716094628 -0.23856894717396143 -1.0517415781639803 0.78295842555917106 -1.0694293301011488 0.0027715573065387085 -0.011502495154109681 -0.25417418430011357 -0.52883371882156927;0.64310691077481852 -1.0347257415482729 -0.21619500950868453 -0.00025858499680379149 -1.0138782145474809 0.37728785615150762 -0.60817359155339246 -0.21679390448364394 -0.40298548298401615 0.2354451593489415 0.66846344588181306 -1.556498209374783 0.43632609917372756 0.079422360269578759];

% Layer 3
b3 = 0.45472035986550852;
LW3_2 = [-0.4421785658163504 -1.5856568213361706 1.2776382920756606 1.2470379433458185 0.18370789275571461 1.2993388063413074 -0.54833595375929156 0.38193080009263325 2.6809806699853072 -0.31016593383496183 -1.4027718966413691 -2.4043211764846597 -1.8683478751096927 -0.85509086325684769];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
