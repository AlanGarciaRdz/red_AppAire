function [Y,Xf,Af] = PM10LasPintas9(X,~,~)
%PM10LASPINTAS9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:28.
% 
% [Y] = PM10LasPintas9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.0251256281407;14.7058823529412;0.0179856115107914;0.00280033604032484;0.0558659217877095;0.00576368876080692;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.23399194401402304;4.6573521404015183;-1.2604757446931896;1.2055709644203916;2.5746094134784672;-1.5079260803752956;0.21340040741254909;-3.2560073991204788;-2.7413010741957029;-0.5546399346392703;0.25352768488391653;6.3673822947478547];
IW1_1 = [-2.4371512538698208 -0.33492119972663481 -1.909285952002153 -0.30546323163448086 -0.29351613273716165 -0.25784775164217882 -3.1322954703130552 -1.1860255119503684 -3.243894032863647;-3.7606657655977829 0.21879702121335207 -1.4650128751053699 -3.4833439672634849 2.9649340061771974 3.8498796570682376 3.9687597790509068 0.94545765573458451 0.4115098073086948;0.52452825437182671 0.021905844578619996 -0.16799275125131391 -0.58457642111353758 -0.0055114416203710208 -0.28402605043669887 0.19478761667132144 0.0063171304899343793 -1.0930752311244079;-1.2111838892342384 -1.4847257605248847 1.3091536171386027 -0.16955051386680645 -0.094103736948674549 -0.81168804361531577 -0.46473841135628308 0.064289652945491146 -0.18233548932930163;-1.2819990875173986 1.8082217928002255 -0.88465444803994198 2.5967947054013552 -0.8344546951522136 0.96701447382936456 -0.34252092797313433 0.2151346297601141 -0.10611742293635379;-0.61373771144275513 -0.16592239071702811 -0.73895745607085705 0.17383206539414126 0.43035890082299416 -0.73979186068264979 0.41916069807187234 -0.077721061618039627 0.20378643633059418;0.13523451406009773 1.1330897706392977 -0.07763742148460151 0.58941608630646525 0.086792000399034272 0.49982871472674956 -0.23241851641009659 0.096701841954105583 0.33928500360124597;-2.3141611063438012 2.3748936196247921 -0.92811532929928831 -2.9429935955792415 -1.099823667822172 1.1906957421938318 -0.53037452728395917 0.27673494073651789 0.150015736095229;-2.7641253520150544 -0.17631787730499202 -3.1928459040659649 -0.11896073850180858 -0.63656070838717005 1.6459690989554163 0.32470754639065641 0.081450061901486695 -0.10636125377632347;-1.0755991657065349 0.62062478757354367 2.3845587112127982 0.46038771660941791 0.0042360986505812839 0.30695584691220956 -0.85176959720367029 0.01842658228744766 -3.9340840823176824;1.9773456942842131 -0.36322170267545778 1.7615853920885785 -0.042547591155348639 0.77273353233691311 -1.4277063157796561 1.0555176945594653 -0.13709474455963966 -0.9758486328448831;1.1754888719573262 0.40019200600875576 -0.86943015531970735 1.6107789552470551 2.4906094300880159 0.99446382457049054 -1.2153626728526232 1.6591849911171024 1.2214833877354632];

% Layer 2
b2 = [-4.8874203760958173;-1.0340948580827944;-0.52533363841285818;0.42057209498436199;-1.9707532684332563;2.2983254610055841;1.6458701082575931;-0.98186251145616688;2.7017612517490632;-0.93253054914006572;2.1940389853544797;2.193719333192178];
LW2_1 = [1.3648616982254635 -1.1151061552204775 3.4734252075810508 0.63287747679385875 1.5058606568830362 -0.46190603957569737 1.5168220041069616 -0.65842222826903851 1.1591307748161948 -1.8452732878482021 -0.77769038717515049 -0.42251604936136283;0.38453112760599156 -1.4065377842253277 -2.8038048881855979 0.31378705150117053 1.4863759458070886 1.8608754795825038 1.0448341947195521 1.3625213861413357 3.241614019085103 -1.3836050854188118 -0.52825599630945208 -3.660923407865345;0.8406916585898303 -0.38584465078643965 -1.1910304550546 -0.61320280401400451 0.51959061488686509 -1.6373689262468152 0.66188943972122838 0.061496496639946559 1.4464841882355883 0.50523737571422567 1.1543486116742989 -2.3601799958425858;-0.41751836902739675 0.20041772639029787 1.0489516702690844 1.2827013247438697 0.1647974114585605 -0.14413158356749423 0.88752380559912114 -0.12405920518992389 -0.3942018601824458 -0.6135596254416591 -1.655023351836979 -0.74718684752531739;1.2692331674443089 1.2374160444994171 0.81428416517425017 1.2410084056340189 -0.16773407299985454 -0.49868658916444075 0.21115313664276963 0.60655490800522838 0.084784113248433962 -0.90371431446721895 -0.51129814583954114 -1.2260515850224529;-2.4907771341061533 0.1811872220130227 1.8076825563593872 0.62752975403683176 0.48108625113549208 0.28250878715901179 1.9532763008270888 -0.81108643076571807 -0.76900839541621224 0.38423666610530527 -0.71548481847855483 -0.068103338127427818;2.1478306670908713 -2.1077732030942897 -1.9140706587273553 -0.87354227730549572 -1.6134767418118843 -2.3737870020331622 -0.5363288048222582 0.26208929767974448 1.666974813990789 0.15839741253966808 0.72273282254179316 -3.2709415463747828;1.0873662818374461 -0.5031778599873874 -1.7553584406038469 -0.64851053162248351 -0.074297474777797495 -0.12582928108868491 -1.4404432180457709 0.14387562642768151 0.35483937232347179 0.0242499633144697 -0.15932298610214396 0.58960828194465298;1.6285057504108007 -0.087091760118936906 -3.3856023020492878 -0.8801767279859255 -1.5098163030415157 -0.67236113133247255 -0.86090614910321517 1.3997262639552617 0.29478550097821626 0.95396858512416949 2.3910244966406107 -1.6960000074124686;-2.1965035684692884 0.36968667048701775 0.57173014133579825 0.16858815432456348 -2.6789676777035845 -1.4664572523051915 -1.0990527750574897 0.91437244521976413 0.21929272967254354 0.40295470154167828 -1.5570850580777018 -0.50104244810650533;-0.13457819117997522 0.66289821076917088 1.7682479711224965 0.37422827689892196 -0.68457030598989688 1.8252137635304149 1.696231209479935 0.82363135349538996 -1.323646474536641 -0.13863577323483284 -1.4450171045528315 -0.34941784257495523;1.7622029416752165 -0.49962440953903187 -0.109951409577319 -0.08931687729230639 2.3540479783041461 1.9986808494941544 1.9155653817303246 -0.33794321165678903 -0.52743305823923725 -0.39901054103602818 1.1661178747019134 0.63463424796439116];

% Layer 3
b3 = 0.16499014402222842;
LW3_2 = [1.1803925347043094 -0.067184703934371773 0.33170879505525658 0.73283008728050725 -0.61810231065844801 -0.61741145846239565 -0.33072773478032752 -0.73502294614497088 0.20480328144864149 -1.3128605799287836 -0.32675938188433484 -1.0786490538582294];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
