function [Y,Xf,Af] = PM10SantaFe10(X,~,~)
%PM10SANTAFE10 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:34.
% 
% [Y] = PM10SantaFe10(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;0.00341273633199099;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.82713915936543048;2.997232648464264;0.85907218526386608;1.412998227506759;-2.9267283509236508;-2.1785596863777204;0.19681322985319938;1.4667663472382331;-2.1090994161759458;2.7712420884625875;0.90463924304656307;-1.107237399023508];
IW1_1 = [-2.6002861824700103 -1.285019533748289 -2.8170781785775385 1.201588129273788 0.35398669847261183 0.40758310047139085;-3.0005287071117315 -0.55829848734350773 -2.6551068866860725 1.794827733178582 -0.7003609821325808 0.38924508287100901;7.271961756216025 -0.30840755526486902 0.98426309049691396 -0.70563970851369529 -2.3740461064486875 -1.0579043093142033;-0.91516309983954336 -2.7031505513911132 -0.69863656263880092 0.58860411594705409 -0.63413674055053426 -0.06808116113141624;1.2561131361897002 0.72306951865915925 -0.76650132695650941 -0.025954662410607968 -0.80932520279667808 -0.9207577554458416;1.5849070742999711 -0.59708715022903192 -1.8705017034461346 1.0008044744447668 0.59650428805691236 0.17786622519364004;-1.6036949711231172 0.77179037468652356 -0.8436136193056647 1.0677596198429604 2.3278807144877276 0.4706376967540935;0.96290591097774803 -1.9847512332665977 0.22518667639587311 0.52321404038767172 0.61484131066694792 0.19604608412786872;-0.15836746039803948 -0.32693490125468777 1.3296964630925852 -0.66572377366838764 -2.9113539811549707 -0.44614951986937984;0.9456807856335705 0.55093544617031831 0.24830520445102117 0.6169602970480077 0.69772758671963309 0.54959486674351121;0.67621949314981611 3.1500524758671475 0.035520884234880118 0.55082490371809534 0.51291363284591962 0.32666385672388315;0.69595485719392514 -0.19476561645738233 -0.78245009120664566 0.48960460716762733 0.31600034779423963 -0.0076756741163910699];

% Layer 2
b2 = [-1.9302347596563316;0.47861229197920924;-1.1822155879354019;1.2257123358668753;1.4418821566451236;-0.76690165947447131;2.1904475794159071;-0.94002195918317066;-2.6202191016329861;-2.2874213775890802;0.088661117301785192;-0.24302668523832202];
LW2_1 = [2.1020640154166834 1.0166364145990958 -0.28580381606156496 -0.61490452385542738 0.53352929170344543 0.56831636709055278 -0.42016936577872493 1.2275769962051697 -0.6406532344443383 -0.6225607301798064 -1.0411191469191994 0.4012858029032873;-0.73175955906541013 -0.78514866142406325 0.35032525698575867 0.57559695405592182 -0.80213864457115969 -1.0647692333743135 0.15400789358692407 0.60038257540500695 -0.23175658194153057 -0.59372303582256225 -0.22316217738445557 0.71732757457952856;1.6855008313879869 -1.1220906018577594 0.81933626427334605 -0.70250611153146891 -0.91657860044898309 -2.8133634624822639 0.010192987212704199 0.51651053236684841 0.52323062414546384 1.042413667584055 0.43932197673465573 1.3293740418117876;-1.4098130660580441 2.6932875289723373 -3.0268000386161802 -0.22976778663533562 -1.0417614707604017 -1.4218998765934858 0.76439858938251626 -1.7284956853945606 -2.517066889684473 -1.5460227050962443 -0.81374240790259444 -0.18306715490394951;-0.41034833476054122 -1.1831972095769809 -0.57872369471663787 0.25987704777227522 -0.31162879209414285 -0.653302529079688 -0.48840781672764561 0.70056361116791033 -0.69429974313631526 -1.1544378141409966 -0.18996136293738999 -0.46902889697336231;1.4712600152587767 -1.2755867275736028 0.32041929175217221 -0.57113972899678578 -0.73294526686651662 -2.7877516633977111 -0.50879119396554884 0.2599626514022359 0.32001784407789452 1.4939116414222227 0.26130432274147919 2.1761551944965589;0.047995164081845759 1.02887802168493 1.3218236927620379 0.072242382987333972 2.1144650552319368 0.36059511983582376 1.3375278208566646 -0.9729963037518029 -1.9936854566420439 -3.8790876638201612 0.26031984436161681 -1.030630977151648;-0.66665191809480395 0.4725197573677884 1.539080405651744 0.11996209781249317 -1.0024112094539483 -0.21428431420156616 1.201479645087963 -0.32256155378537954 0.90212744668976119 1.0780210004368473 0.13532141059374614 0.86573633259109362;-0.84843328000394302 0.08997965887668713 -0.4816435948863404 -0.23710314160699203 -1.5139747797631233 -1.3253431335604928 -1.3665024229375182 -0.16821330250897856 -0.41491467474971588 -0.85420088766235036 0.74292229503307861 0.14100556569616224;-1.9402572334215007 -1.0695774180755362 2.0561442928752132 0.60229383341365483 0.47387535558665983 -1.4179605804525968 1.2643883582919972 3.176923375703594 -1.0920822314419019 0.31667369738021356 -2.0148825316186372 0.45984276018926923;1.8259087712965696 -1.1088041800020141 -0.67894877566123957 -0.58494579306545436 -4.0665419977158512 1.9965029901831584 2.7051019629290267 1.2279826063023087 2.1417933452202269 0.93211798201857698 1.4700219959595984 0.71146665255477215;-1.2781555340837101 0.59583431190020719 0.90666421722999446 -0.9054225118159589 0.5728020174212366 -0.88194904921060957 -0.61515971129126179 0.16733588223444831 0.73073953508341671 1.2129773400712458 1.3160586008570789 1.2467876555360915];

% Layer 3
b3 = -0.5001045874144342;
LW3_2 = [-0.42676934328926802 1.3756967324889648 -1.2293491881624323 -0.16324113536079277 -1.4605326560363441 1.6290174055288662 0.22658290783370141 -0.71120000827455521 0.38449470178004158 0.11141378724054062 0.083590379763148356 -0.29707564674668197];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
