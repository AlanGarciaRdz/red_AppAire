function [Y,Xf,Af] = SOXVallarta19(X,~,~)
%SOXVALLARTA19 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:07.
% 
% [Y] = SOXVallarta19(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;10.4712041884817;0.00782778864970646;0.0208333333333333;24.390243902439;0.02710027100271;0.00630517023959647;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.6604746895789142;-3.6260992740750195;-2.5507365247991785;-0.86927115422618151;1.1589850792392222;-0.4963604649390459;-1.516005302260061;-0.35212664219038992;-1.2041379352575889;-4.4955830419157907;0.79068854884506434;1.63961559861311;1.8199534142007785;-4.8945853817979277];
IW1_1 = [1.1422440993226339 0.21750065672362084 1.8912957927422036 -0.27727866929424272 0.044077785674194611 -0.95167300344573902 -0.97882364917146725 0.63647414363072619 0.0096338175592608072 0.14127946722862303;2.4528389382007765 0.049973404782757483 3.3086666806396106 -0.58590533511342502 0.11935491834172939 -0.19199039079665337 -4.5337313786816464 -4.0591376897900959 -0.76224242586743718 -1.3962708121535552;2.6608812730960363 -0.1974109904149533 -2.844809742718172 0.8280829074840228 0.31931999199695549 0.69693603360590362 2.0243370780886352 -3.5060044194185398 -0.208153335588112 -0.52259491624623888;-0.2651105075013514 -0.12624529491334363 0.25184727746409363 0.27544043475208801 -0.38878460046149255 -0.030156031872965887 -0.51186332160010961 0.48734202220353023 0.56238427419177872 0.961646991501662;-2.91690374845113 0.4170221671623906 -1.5474001395001482 0.24505373899394178 0.35181943391394366 1.7929393588357532 0.068952711675065531 1.325540409682548 -0.11213095195425481 0.072994708538346276;-2.104797141471447 0.98491266161965085 -0.73494510089595289 0.024532776739169253 0.90678745337195144 -0.1830482160505815 -0.44491924400137306 1.2193157662664225 -0.46007558128822285 0.16276801738140556;5.6991550207104851 0.78184272977025127 2.8941853475959567 -0.18061148578795724 -0.93251396031064382 -1.1672891611390244 0.54294312556527657 -0.060451837586799284 0.59110887439835602 1.0955078894560122;-1.4461350580454488 -0.80333381243433366 0.57230037813510548 -0.71296966277771645 0.1501604646976053 -0.6197460898148669 0.70591098725923385 0.93365773898507054 0.27474007772227821 -0.019132550282025547;1.9135439414183673 -1.0936724216284914 -2.7414289261866789 -0.30291849047699765 0.76838779223559972 -1.5840301727763582 1.5529261991841885 -3.2172569509451043 -0.4565173059764282 -1.7045281143507567;-3.0560010505973394 -0.18185675533637088 -4.4485311071229585 -0.42783447284798443 1.2205509575311966 0.41578041144070277 -2.0068979523436155 2.3845485434310238 0.04831394458553568 1.8113535601190904;0.030258184218210256 -1.2325787128858885 -0.71709402180163251 -0.66564456580961229 0.23774529757710375 1.5070401928457915 0.37790471096725597 -1.5024776061459388 -0.1673257833153084 0.28584034917591483;1.9813064408486523 0.47833968878161526 2.04166530844287 0.59979540063182057 -0.89498151534542258 -0.039592144205833915 -0.6395340440797217 -1.2290893513141268 -0.18356014013485961 -0.97525171311082648;5.3880500279591113 0.25870560239581153 -1.0970620883530788 2.2272013173953962 0.52833002723444022 -0.57581624912798512 -0.76931402243222258 0.095825873894236274 1.2379989884637479 1.1917715200354337;-0.57766693102263078 -0.084273671778147138 -0.82726665815645828 -0.50049234422335642 -0.63582568099543268 0.10572169863842545 2.9790818543769126 2.3712197792301035 0.58706915136374482 -6.0974481480134752];

% Layer 2
b2 = [1.5007597231010541;0.41568285570483732;-0.48978763681025383;1.2078132156298371;0.18329146166984001;-1.4488290346208827;3.0695448412598929;-0.83069232074781052;0.14700962152050262;1.1934434866460903;1.8704839832658267;-0.27826833286225006;1.8224117759708349;1.8237562262645592];
LW2_1 = [0.70759452862543037 0.65327173605897737 0.58955412918513572 1.1320855083289116 -1.1776432354869046 -0.50096551693135705 0.10922157476891994 -0.50076890111982009 0.067174597202258574 -0.60127525097098755 0.12470392705609497 -0.08883507736079499 0.9149540859994334 -0.48256231028306951;-0.035579598524294889 0.079697146060259114 -0.089189743152640569 -0.53740730718690788 0.66519251575560778 -0.80005735353941354 0.30247535011383597 -0.35270030000372904 -0.13071197296488521 1.2397957597368205 0.25242543190928146 -0.34858678986629293 0.26331602594036713 -0.011987534119198721;0.094131332846552077 -0.030751982959618181 -0.1573888961535421 -0.54980315087731035 0.74816276787655334 -0.57011403400672289 -0.14216794673419331 -0.11492843092991571 -0.10038027141910982 1.1677566559673167 0.20473178859292671 -0.33785423527101965 0.22692271855666618 -0.16990200722986948;0.65984117165382383 -1.1562376469689026 -0.43005815825270005 0.65344560033444277 2.3405651761498527 -1.5665008650218919 0.05904969645044357 0.088721672198645088 -0.098314113216587118 -0.72224540372156287 -0.13003157822243405 -0.02440550529275639 0.74757522963473644 -0.53257202283563099;0.26528316487631604 -1.0008429065737141 0.20920020235099929 -0.41620996047350356 -0.7729055143521989 -0.33935497536250436 -1.2823461666219478 -1.0773769500705312 -0.28703471374811801 1.0884794966840661 0.27093819614022618 0.733216591365773 -0.6150423951581887 -0.48131250988304292;-0.18102795591028883 2.2601577152451848 -0.76224010150626009 0.051558423715305876 0.74435552993569043 -0.93940671506008844 0.028621740599353289 0.5930911407707401 0.56165048594136813 2.1416574678878941 -0.387494184529175 1.4784458450328399 1.2502037849984486 2.0440698159439878;0.96440459694273895 -5.9041781137581406 3.0823557058753495 -1.9460257205312514 -4.8599651075317132 -0.91647872807796416 -3.8642567991332992 0.12196743501620155 -2.6327015599695147 -1.2354817943423921 -1.4295695000471933 2.6168041196953959 -3.0020067466628886 -5.5869188985716818;-0.13987260226977505 2.0067907556316276 -0.71860076681549212 0.33979852091307172 0.58928629719143899 -0.67992433774473715 -0.042600163316453984 0.53035487358660072 0.55468251279798497 0.89766838906266933 -0.46621777247635754 -0.051915947753730853 1.1274617051283542 1.8294276453317999;0.91429332351789616 0.12587559487439207 0.46723481836462399 1.2599736099677097 -0.7275171448693567 -0.38189647426561946 0.22643618258868001 -0.61314525438777656 0.65407766941914114 1.3522542976220948 0.01231064598437049 1.3407471509390365 0.60049388737790743 -0.12012367526952983;0.41707403841689317 -0.75248721579051481 -0.97310184690216461 0.042676388286745262 0.54796767830116688 -0.097975484296037071 0.4886784826131203 0.216750293373382 -0.13047587684603237 -0.92194815138294617 0.24492966801756005 -0.18974488878523654 0.5974814638909739 -0.74477366299495418;2.8023330457311957 -1.5128872867997576 1.0170241952130192 -2.0577108225299683 0.69410352423688326 0.39524549723789298 1.3271226299662757 1.2516816173651704 -0.91525113527350122 1.2390698309692223 0.14147398634642586 1.7996217224164006 -1.6646407423296457 -0.88726981603615063;1.0235778411667866 -2.1427670285002076 0.56163381764989673 -0.58450715918177121 -0.14649913004632303 0.30636646399504119 -0.81083019037193393 0.86151133240503319 -0.72329961441812896 -0.14868164819906898 -0.64038131490745687 1.4114350138408909 -1.2176992928100496 -1.7546462540908019;0.61444873199890138 -0.57868803558684456 0.15361049351273845 0.030849953847568508 -0.49457822616135283 0.3453477794514147 -1.0681249123644219 -0.33250493461875436 -0.23211437108116659 0.093730447493769867 0.031844256912552008 -0.93195819245836897 -0.17377727282734731 -0.51765767858123957;1.1986616008988662 -0.42972390102217289 -0.85619034879605982 0.36539133285283032 -0.06184013674114671 0.24961119173943683 0.43372015719393131 0.10572916595082524 0.11344692712798797 0.77872649469634936 -0.43123969464095613 0.69679829251811432 0.58907817687321484 -0.70346666555857351];

% Layer 3
b3 = 1.6010941643039358;
LW3_2 = [-0.11945571587419553 0.6377956982064158 -0.67813964074591793 -0.48137014498999586 -1.0187473195154439 1.8886391866266727 -3.4031675704939435 -2.413307335118422 0.084190076084758161 1.5822904559630417 -1.5637203871637266 0.3434674738267442 1.8515832546694111 -0.4241527639511134];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
