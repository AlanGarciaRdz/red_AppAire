function [Y,Xf,Af] = SOXMiravalle17(X,~,~)
%SOXMIRAVALLE17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:37.
% 
% [Y] = SOXMiravalle17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.0208986415882968;90.9090909090909;0.056980056980057;0.0063552589768033;166.666666666667;45.4545454545455;117.647058823529;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.0676184306288539;1.7872627959796652;1.0583512717069938;1.4185118923415105;-1.9077176853732583;-0.79970206627530316;0.075906279914144364;1.4067693781803434;1.5412029411226795;-0.85276287866189904;-1.2063583584060802;0.67573727962250896;1.5551570941878645;-3.1890507741831287;1.6260791117464333];
IW1_1 = [1.0921620508434637 0.72496971061667159 0.48535081906404182 0.86566709238644368 0.28968218036433352 0.46854849559439854 0.1547570036421409 0.3017526466640218 -0.34744670915863229 -0.79272749535477505;-5.3306859025551212 -0.1924219942759775 1.0083208097102925 -0.46650309187834216 2.0687673154429222 -0.5170766176834044 -0.50934705844005035 0.26642457254882229 0.49733279896785298 -0.76109343627881931;-1.4106297375770329 0.010140869829902021 -0.13023740688076585 -0.61914221001059422 0.055867986435917852 -0.45009620030398795 0.014754130967538033 -0.22755505611104623 0.13364530284601819 0.26565306337485767;-0.38834511626097118 0.15153631548721899 0.33490395334833778 -0.34558110463345842 0.58875716674917966 0.1539078464712243 -0.80735143643550089 0.050552601558404409 -1.1074816575220405 -1.0577765810651789;0.64448612725658438 -0.12562717177131896 -0.29095246977011774 -0.4832810720115302 -0.4296942757566467 -0.34709045474166883 1.7702511001735215 -1.8259051081700846 0.54582044962309262 0.3525769007916299;2.9148028251498106 0.77786162021255434 1.9309250041772952 0.53909693348892418 0.90830096520910153 -0.70550216329503523 -0.8531642554192499 1.6738178592730952 0.28654165251617525 0.059357346655476678;-1.4689311393857789 2.2289901528108347 0.3142411073046395 1.0394365027083925 0.287682254488418 -0.077340998096720917 -1.4687606641583408 0.49656994927293485 0.13922323445757948 -0.35628926061193816;2.1608804952531915 -0.8630556816191165 0.93809330910335076 -0.53304839320781272 1.2566121578695402 0.13202174711610071 -0.44137726373754405 1.4103449594282724 0.61032632616683657 1.5295079968028857;-6.0441423009873096 -0.16159239886683696 0.33686486493560541 -0.56721096861837594 1.5865962357239831 0.54832039722506609 0.38434158600070084 -0.95525617407069319 0.69201038321588859 -0.66828309255735407;1.1307840577279853 0.0055071048410675408 -0.56387817925213268 1.6992826561114371 -0.84015153616884286 0.51174819260022342 -2.0899856599144937 0.21247824056488857 -0.1910697363262828 -0.048889570396894774;-0.6233654812209275 0.26174070460428039 -0.16365757489896657 0.79074784422709599 0.31011748106854542 0.39157587688528678 -0.97105715362761691 0.5559537201894843 1.4478271063179751 -0.028778651932869607;0.00091109758103939155 0.49012118194902926 -0.88819438821509678 0.23443338896341109 -1.1503478603160726 2.6100815581281274 -1.9731877399918583 0.2085307589550939 -0.15807795073748157 0.28093941908369557;1.5273238889592937 -0.4976867619810415 1.4961208883010606 1.3315468110177295 1.2224215000935745 -0.86854732635386134 0.3159681301745767 -1.4678734005711382 0.46287744517012819 -0.34079518790996255;-1.6763994242503504 0.23461537565118454 -0.33488516268526841 0.18667613920636009 -1.7185588895107031 -0.16982026049812426 -2.3320421053070599 -0.082527285060546504 -0.12049489524694304 1.0662747508328112;3.4521369587778508 -0.35992799602699294 0.87742483083840261 0.6731470431255735 1.501957448661597 -0.78445873120529086 -0.14957950691189892 -0.013240310691552917 -0.34662768322205828 -0.21498362329808982];

% Layer 2
b2 = [-1.9800137983742769;-2.5599508468667125;-1.6884370162787494;-0.79120106352995534;-1.1677275987444857;-1.6225933719219621;-1.0345689022880866;-0.058409403741570352;-0.015819750158980326;-0.79912848309752416;-1.4375864522920301;1.3572900119424411;-0.4851295553190787;1.1161752858648639;-0.75241239613384814];
LW2_1 = [0.98320163511429293 -1.0905298606436147 0.0066304549522205707 -0.58910847461555971 -0.52453377555289027 1.4694445388263051 0.88993940215334211 -0.60286393201238686 -1.1980225937719822 -0.91847541636695662 -0.25555400605202205 0.74344654764357754 -1.2076067883705357 0.5775933036378107 -0.54898734565458396;-0.58757013843064332 0.59798745752821958 0.18990727596459567 -1.7678161410698285 -0.26143746771174059 -0.44391566646859648 0.7313780400515737 -0.23033278291014728 0.03830525305344451 1.6130709987876504 -0.28868576995686424 -0.31285606549769751 1.1078564169499752 -0.010523316061010514 0.72105326550441695;0.31358866226303189 0.9605402399359565 1.0353586057773443 -0.47305883403812687 0.20422383935901345 0.41183185681503914 0.14332453843605539 0.99610576575005882 0.16637612316012834 0.07755803060731481 0.17183852431015684 -0.1637693925534468 -0.016372534541355205 -1.7922860105872995 0.15822833559818927;-0.26598958238900622 -1.3149027808010687 -0.90271632926591172 -0.11206438242510997 -0.44680855965674721 -0.96989891059658095 -0.031952700805803626 -0.56586349564737648 -0.51620585350790194 -0.036185421802170464 -1.2125227390566196 -0.3531771595597758 0.053969290035359524 1.5341926542300968 -1.3653159516729909;0.31458638366664654 -0.68574467375788895 -0.39907930587767693 0.26212461866275005 -1.1812392117044619 -0.33116132737181986 -0.018318443273153764 -0.71277639748495314 0.67294034093631028 -0.58655918010501928 0.32174913659809179 0.21137732852322577 -0.13455820789674722 0.064213387087800861 0.76103400984031111;-0.24712115247081259 -2.6534821945842784 0.09033340629160036 -0.96312521922609551 0.015491599181567704 -0.091111435106967273 -1.3960612044513667 -0.32272577066670627 -4.0617173448223101 0.43390628375744444 1.2582643589709834 0.31524930939785345 -1.8733744746014163 -0.075982142396698066 -0.12519871197757901;1.2979240096249121 -1.6701018749542103 1.0774365991079451 -0.27915622130463619 -0.87186471672580146 -0.24370190311231674 -0.18996527555488929 0.22583484619123367 1.5690684866707316 -0.056274309102176436 -0.16929088488490798 -0.14990157441301957 -0.16229987918429287 -0.60606654534904947 -0.23355172683774794;0.089739728651458073 0.20226390600946634 -0.5054559697876575 -0.37816227962568 0.60295297680489168 0.33077376641680772 1.1293683874472851 -0.24218904696848614 -0.09092693367349447 -0.30391486261788736 0.19262138584814323 0.27713986287810333 -0.56999919058401405 0.99342824859264867 -0.70484724443780389;0.069468482700158235 0.97611249777817533 -0.38006237215269845 0.51359328486829925 -0.17378908077633803 -1.1783173173163766 -1.1053982038642627 0.7398983455292043 0.20031836631894853 0.29866154003033751 -0.78759376555697125 -0.25088974209439413 0.29859798253010206 -0.29966423492214989 0.65785232844959929;0.23168520487590699 -0.87633928199838396 0.065953029711697489 -0.25589072623616999 -0.44746850839834762 -0.42699767378651016 -0.25314245689846276 0.010191289423355799 1.1172452926717025 0.13057063492868118 -0.1054235838090764 -0.13819584703854038 -0.16972027795262445 -0.2824092893054555 -0.1971651353574326;-0.85461332361324049 -2.615786742917424 -0.54205262248460739 -0.85196155653910377 0.0024177930064284946 -0.19091363528287036 -1.266468178776037 -0.33297241847189463 -4.1555849128791245 0.36598087118378675 0.35969880580674879 0.22126478924842008 -1.8370028555327544 2.4782223525601106 1.0001356122571992;0.16556877937463427 0.56575798939338706 0.29001385474599595 -0.45663999122151427 -0.16849742094747011 -0.16447765062041686 -0.064710019889477027 -0.026198755458802386 0.35432661271565891 0.10777163035053977 0.32771661543399627 -0.20047403433836131 0.57696925327789339 -0.081963277512725349 -0.5269561893865784;-1.1123857613057955 1.2694846390259462 -0.78912852789295829 1.2297625190902124 0.98968514837941601 0.15070409346982552 0.067988497322748254 0.084695553287186767 -1.0071637659851227 0.34191478894599708 0.1848501058480036 -0.0015681433855492454 0.039424490442688039 -0.074801761142945705 0.052745019522465492;1.2934547727747796 -0.016310853751877477 1.1503364320104643 -0.062475240262117732 -0.25769786651136323 0.60720092574754048 0.47660373792299554 -0.3957728120055839 -0.025756054173995957 -0.54809257673278322 0.12485870062659493 0.19867105869006563 -0.43277409007190853 -0.72439730672793123 0.7482080419521786;-0.34633084571109146 0.92587430970260387 -0.36780965278970207 0.84894283631257039 -0.098954032976949158 -0.50736348581297197 -0.076793573345712851 -0.1423253147610844 0.49411839736863189 0.24753035590511768 -0.47657708871058507 -0.35385874558832997 0.66883273469835725 -0.44180582677553148 -0.52834439111816511];

% Layer 3
b3 = -0.58936456775759982;
LW3_2 = [0.53935988500358101 -0.20312711483109197 -0.33482940654021009 0.36588633650193053 0.54748816228251029 -2.8505315352715539 1.6880565839712598 0.099696909023438043 0.22730674554395786 -1.2120508400613834 2.7512997733049489 1.7541853875802287 1.6000564336090337 -0.36441748583582712 -1.2143430441079939];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
