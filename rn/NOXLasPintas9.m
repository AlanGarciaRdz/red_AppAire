function [Y,Xf,Af] = NOXLasPintas9(X,~,~)
%NOXLASPINTAS9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:47.
% 
% [Y] = NOXLasPintas9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.96825396825397;18.6915887850467;0.0175284837861525;0.0546448087431694;0.00640204865556978;0.138888888888889];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.6858976642531198;-1.6970675424115116;0.55520383040228805;1.4285783286790061;0.38669440536755278;-0.49521478228206556;0.3347939494855901;0.39678667591142647;0.87678516373803717;-1.1053166474476561;-2.6726492639166977;-0.91707093105397519;-2.9717203042260798];
IW1_1 = [-0.97425294679317109 1.7942818839460819 -0.49859407782681026 -0.19016975081372864 1.0555403808547159 -2.1906069278673637 -0.65432861711550361 0.54143639104605912;0.13772469410793248 -0.79899743451036565 -0.30207957576373273 -1.3352383060601187 -0.33175303543846185 -1.481943548409653 -0.21906453661438774 0.20971545159957128;0.72521700097652975 -0.31236201536924357 -1.4099316259525867 0.26527836979232855 -1.7594729241952336 0.93169145567162159 0.43571994992010499 2.4731827057159279;0.64395333546988076 0.088437210197685495 -0.52111332466670823 -0.37060168294528051 -0.079797528910570209 -1.3870558406656228 1.02979222103676 -0.30024145769672311;-0.17522053496590331 2.385103639758877 0.68488762927395175 0.36068067942651938 -0.067235956064750732 1.1268108369601342 0.20890983922041886 0.24387151521222697;0.7134184118990976 -0.16630465839316716 -0.41574861216303477 0.19960420811301696 0.22578522731941619 0.110531395995088 0.043286354739481982 0.075077463682321793;0.55323954462673575 0.58063370845828821 -0.033948698650660455 0.71132507055036343 1.4421654047417225 1.541133392689181 -0.25999040951403207 0.83124280236009662;1.035634948687963 1.9139819192294265 -0.86444859950116137 -2.3343928054824712 0.58404940084027401 -1.1732011306375596 -1.2187187222362608 0.890417684431972;-0.84530617098838567 -1.9084793678423759 0.19760321878328399 -0.94830853616047328 -0.29512923084206777 1.919931321295838 0.28843748420692605 0.12435632803935059;0.14540110354886893 -1.0922010398918114 -0.20270556093813297 0.21150952795840561 1.1663376788890014 -0.30664073822096305 -0.48782381737299835 -0.4695977836378894;-0.16799740999452989 1.2810569839729797 -0.0021912580362448003 -1.3180555526443523 -0.27717255260908602 0.21525172585641367 0.33853084195659155 0.22970455970440795;-1.8809625937462471 -0.46192625338259552 -1.7740443540826365 1.5091067005330718 -0.80781646786150507 -1.8433353423638179 -0.62297187345820182 1.0854588373139136;-0.67107614149579597 1.2197672202688059 -1.1106950018641555 1.1542917949343547 -3.3609300047762329 -1.2452989595977104 0.52008701055038609 -0.68450664212930368];

% Layer 2
b2 = [0.66454640822664224;1.1751131818524292;-1.6543945471326671;0.24957891596383797;0.54153433478629021;-0.56954414539873788;-1.2144341801499963;0.80146154430225547;0.64253101701089477;1.4087565133921855;0.93799433273526323;2.5049546795548814;-2.608308840891929];
LW2_1 = [0.20426679016301105 0.8740320866791389 0.20713783419230319 0.68251837874069532 0.29570077175346648 -2.5144606714772566 1.2938717321359063 -0.15957695394821086 0.35431674441416428 0.798415143852651 -0.91742736407551451 -1.0460054241784928 -0.060441277816860733;-1.6835681965321763 -0.88931446378190093 -0.079097306316543575 -0.11773701417016726 -1.2386217014859575 -0.41871634723695117 1.1879975706813579 0.59558568787731136 1.0501894249936718 -0.47582093009863391 0.48032327843953326 -0.77044757673214337 -0.84335981337917054;-0.017343249689074587 0.15633675249290152 -0.55868978895388377 -0.19806460052729422 -1.1041661748316016 0.012167110897617059 0.89301726376766066 -0.31287755102553011 -0.27047621411003797 -0.97235202473540139 -1.9209925298867809 -0.26467889601041172 0.20145106834966833;-0.7622414506752806 -0.093266093089762803 -0.2155565561312128 -0.16732660667375998 -0.3446797343820347 -0.41875492477886717 0.089658805331757907 0.026964931455111051 0.046293799961942279 -0.37110526833736224 -0.88697797925176314 0.23646189119290664 0.31753698645561029;-2.3794805857115833 0.26941687810915294 -0.59678350791559376 0.7059978093676893 2.3815930813964998 1.1691352451017356 0.029774925265268835 -0.98442262651435708 -0.41801342090750859 0.69602432386135082 0.63277956015307302 -0.77298004056534797 0.19911619513265916;-0.44003145861609611 -0.30207059307938822 -0.19446991919486017 0.61226707132098968 0.45327964928060194 -0.7034608938633784 0.012784606388314145 0.34457533492990877 0.60969317343703422 0.10575110805474802 -0.64334931982700228 0.55783019121154909 0.68283060467973511;0.12292456725447679 1.4145666827106353 -0.0044944826970926693 1.709087945376824 1.5621186131154929 0.61172029138159867 1.4680696845802166 -0.070688774483987193 2.7767520784955697 0.71970806582560842 -0.85220389811806119 -0.87916427832064503 -1.0029024194871372;0.31584459944850191 0.12884245517234363 0.058242578075946655 0.67021726796059578 0.55847298952919777 0.28933389900238787 0.31412889719130344 -0.18445259257463342 -1.1314204056754245 0.370452173626583 -0.0055229769405607983 0.10154871776812356 0.063534380125326764;-0.27185839825432834 0.46334268439100984 -0.061759697056576711 0.43224378493111221 0.85289779775629915 0.14041463778869767 0.48660384384984462 -0.027874330809795435 -0.93601516853531885 0.5121431804530947 -0.91075659238236129 -0.0063468381909524089 0.17619447673999086;0.7182516484691317 -1.7778277538137817 0.10646019629732649 1.3008151698256996 -0.17673926223171899 0.054422364730630286 0.045341014057258315 0.87501435557534157 -1.7885168069121549 -0.62476355971289699 -0.42214674075004849 -0.4058145364041616 -0.26969248856659384;0.66344577779812264 -0.6229772789089314 0.55504550410646691 -0.54299526970676992 -1.3665900763264531 0.24512284754931193 -1.8530134877967106 -0.96760589694797394 -0.62992664473773485 -1.331184150081864 1.9989184284821113 0.2053714321309876 0.20061587170020628;-0.64886387801917511 0.54703451089455946 -0.63855960935168909 1.5996907327633401 1.4405661247376993 -0.33059798239663857 1.3460816217067901 0.94119801445437579 0.023132419884647024 0.76871113373474975 1.1295791974908 0.19889502304454593 0.71930169168375291;-0.1955572232678609 0.29971162851941252 -0.33367952134839629 -0.12432320517350473 0.66373012277571553 -0.20539050442752649 0.34072344091208434 0.18426107821020934 1.0523254026009938 0.2679552838721429 -1.3116600058422117 -0.1703185693519432 0.093669464913150619];

% Layer 3
b3 = 0.082463564429926056;
LW3_2 = [2.837043676997081 0.70361500239490704 -0.5468046475841648 1.6794530311825668 0.30456206002646913 -1.2226851414454027 -0.63568997845709263 2.0320302809157065 -1.7499938831189741 -3.0694690422868049 0.34210554193516629 0.64158978830802671 1.3461984632282962];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
