function [Y,Xf,Af] = SOXLomaDorada21(X,~,~)
%SOXLOMADORADA21 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:34.
% 
% [Y] = SOXLomaDorada21(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;11.9760479041916;17.6991150442478;0.00572573718866304;0.0175284837861525;62.5;0.0546448087431694;0.125;90.9090909090909;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.9627273971762453;2.2788582624457536;-1.3299274444556097;0.6302873828820944;0.30416646846212342;0.60475060196361929;0.69663632223566563;0.99667684636881571;-1.584865627411995;-0.95188244557292556;0.21245350016363454;-2.0726487868235792;-2.7665233931038271];
IW1_1 = [3.308452106472461 0.98952030757290799 1.0890737895215172 0.61444428998460776 -0.2908757219943901 0.91055118410922775 -0.1849991877262176 -0.052498778849577418 -0.19538956524113554 0.063992174102989796 0.3125769187515311;-4.1550794355530112 0.873808910955156 0.010864236809759724 -0.018869847148749314 -0.0066904402332167712 2.0104778915771044 1.5901108199273433 1.3330716549794075 -0.1996756645438493 0.25644533858010476 -0.67830799015106236;2.4719229097503934 1.5415674161999735 0.53018353557532294 0.43738720435107237 0.24475315298996247 0.75967417599297293 0.40005869277204342 -0.20035808411381503 -0.29578712970686 0.21738952087301733 0.60415223626384429;-2.2861467348470659 -0.13594656163309757 1.7046935938382575 1.055657219606847 -1.4873797201619099 -0.27993400607943597 1.446575234407409 1.0780185113165497 -0.5339956171042588 0.41147673360539805 -0.51159580146288608;2.5564687459624555 -0.11897028737554025 -0.73476208203164073 -0.20493365590206053 -1.1308118632990272 -1.479667619420588 1.9677975410016544 -2.0180751488572719 -0.68825479783729637 -0.17493871417254436 -0.61910449573585657;-0.88779992304495126 0.45519752350468251 0.50648358266245763 -0.2191092640633048 -0.14785328573853015 0.63376578360898239 0.3877040740327789 1.9803840576879768 0.081869315282402461 0.53351211306573332 0.37114714760210415;1.8711501908507429 -0.19419070420585588 1.3261311380866863 -0.013737933976729354 -0.045727232129290286 0.5402103161093188 -0.95788593440354752 0.99676493561637602 0.17958123422305539 1.354534020701299 -0.050945411966909736;0.72002227324002177 -0.81013060099964529 0.44641017072874545 -0.43655205605966962 -1.5646934993164778 0.18014418588298128 0.20899889750692696 0.82841319191751595 -0.21368616396527204 -0.20619712019658515 -0.29365212004690966;-1.0133043972830784 -1.2819019352468655 -2.4325329040850932 -0.57952420139750482 0.89570845374014763 -0.49613139295500408 0.13274224403316229 -1.535525470941808 -0.92053002284403562 -1.2564905982386023 0.49837309564555288;1.9716242280952445 2.0742694092598675 0.11689836899701456 -0.14329285454983945 1.3747463867431413 -0.7430750720962056 -0.38738365547692621 -0.92250919119470465 -0.13816822905361478 1.2247191100190358 0.27814910039830126;-0.93834605734115484 0.90889677021554738 -0.50053132336264261 -0.57594358889148611 0.11602655655767076 0.79060500614259488 0.77706360012566311 1.5950902386224979 -0.30203645613119801 0.34753164544499737 0.15630478425959463;-1.9239522536112275 2.0746184725823835 0.69471247810811132 -0.90691419258567696 -0.67995257018666211 0.46053934131833302 -0.1633492199946478 1.5298872071986167 0.10576802781058224 0.29911622297379037 0.12349503942617747;-0.43422031416776663 0.3458788116024506 -0.32312020887769738 -0.81300025234865503 -0.19287662681031364 0.052054123790514543 -0.70867865976575795 2.5229045036999564 -0.11827294794354298 0.21062263252167979 0.31184397019833193];

% Layer 2
b2 = [1.5788192712813887;-2.7206835777302838;-1.4322908525976719;1.2197143938242079;-0.73455763823822506;0.77141156692327817;0.16886612226247047;-0.1421053039047197;-1.242376142565589;0.017214552784029585;-0.88445660657158487;-2.0657285585270588;2.1234305948662504];
LW2_1 = [0.49033336247494735 -0.031849489760684357 0.98042975643232766 1.3191441436526756 0.73164654482298153 0.25698688400568925 -0.13288660006392713 0.14945146049476932 -1.0469034291363497 -0.018029659484718165 0.93359374423083685 -0.75058122942345207 0.063355433234048603;-0.54908746871233105 -1.8980313433944649 -1.7245076579279064 0.1290031016938393 0.44040661142567061 0.97993641467387205 0.17271672426538329 -1.114246739300206 -0.42383622377566116 0.21066589045906936 -0.0038285667939472927 0.10617181482830222 0.30492506409418901;1.2233069855401801 -0.28579524034093995 -0.66177212420645626 -0.22370942100363336 0.39791136658812237 -0.7391934663568962 -1.2594495756794846 -0.23728174746459457 -0.53670012709124193 -0.34061773448433463 0.73627434237480971 -1.1341682862097096 1.7164302304636445;-0.52970244750009443 -0.68388104853690601 -0.90480484907603542 -0.00072398716294818678 -0.42698224303593518 -0.56152818876455612 0.68260673976134534 0.77152385078465635 -0.42253433732009577 -0.019087683892985818 0.17815830377961639 -0.15384038546064366 -0.11115081833569229;-0.52680496819538936 1.1174656775115441 -1.0340520978303356 0.14181334763145831 0.47527214066560619 1.1784241353668896 1.622352074852472 -0.83807878458888352 0.0070898556241265056 0.31209204492159298 -0.78978399470516514 -0.27740821928991105 0.7417288342642846;0.44832617901572663 -0.81219347454578927 0.32274637819908469 -0.69311934055659652 0.23370830542130006 -0.22152393959407338 -0.63686852777417202 0.33128096668154206 0.85481339137808721 0.58024072613983735 0.59227371489121561 0.1852342058614401 -0.13426237127204241;-0.26388288617062677 0.67758710397178024 -0.070126542763254335 0.44348788620854451 -0.40570521280705385 -0.024734625148086407 0.20781561627911932 0.32742578656831001 -0.41547574509814161 -0.76540408417501093 0.16428671944177692 -0.91434356739633604 -1.0525960191878536;2.1456883347917741 -1.3316895768954793 1.4975831809830573 1.7871261799925144 -2.2116391926122789 -3.1925338221481536 -2.0623133779428078 -1.5136037870742103 0.80236016467084026 0.23937051334151255 -1.2857667717408052 2.0387769504557776 -0.023999473690475781;-0.93124480717503832 1.4713386775809165 -0.38949105836650988 0.044849757319908208 0.63275757328440141 1.4278618757646373 2.0625026193174616 -1.1423909838481943 0.21949500151346887 -0.27311952416343893 -0.6648285931777681 -0.2008613170496226 0.48335052804926282;1.016337710996311 -0.60201102682586527 0.49012452052038002 -0.42209966626790635 -0.066770704732394076 -0.47297844539577366 -1.5363566419144705 0.49225374869182309 0.29454548054190688 -0.69039874125579115 1.045158762553315 0.13709498616075638 -0.88232079921150541;0.3133267250962688 1.3932852712920527 0.28828256389283147 0.57548305962271529 -0.65587384439190577 0.06238006185262808 0.24703109725360811 -0.46301320838047466 -1.1254109912032271 -1.3401109003869354 -1.2970228351830835 0.051115381821696913 -0.0059659392509916684;-1.2568571740357761 -1.2144874720276682 0.28304923255028763 0.18699791237645444 1.5612937488292842 0.37988254448561332 0.026747081810337227 -0.66396040603659923 -0.69034672475196635 -0.088806531031245181 -0.46169035593252028 -0.08643419327990888 1.411921898668252;1.5016637095524288 0.11379120770431538 0.71922059678694961 0.38342860240721677 -0.017341644744383128 -0.55130834417925345 -1.2348066951327912 0.24806355165655158 0.32686290878709146 -1.227872103243788 1.3916186386279263 0.081645637703719853 0.007146004008502127];

% Layer 3
b3 = -0.62816066573796991;
LW3_2 = [0.092791040397176991 -1.8311165477488798 -0.50193048505297566 0.8098351931762412 1.3099632196356898 0.30663109079927359 0.23345825506958406 2.2771212906327971 -0.67687215723860239 0.61076995281346136 0.18687279818623484 1.2007608259208138 -0.22710669156054866];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
