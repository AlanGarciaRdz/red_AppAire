function [Y,Xf,Af] = SOXMiravalle13(X,~,~)
%SOXMIRAVALLE13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:36.
% 
% [Y] = SOXMiravalle13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.0208986415882968;90.9090909090909;0.056980056980057;0.0063552589768033;166.666666666667;45.4545454545455;117.647058823529;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.6539496378073699;3.5424991697899615;4.3224358267123169;-0.14022180280174446;-2.8216068415962754;2.3263015289928233;2.5098459304982179;-0.89496094641380763;-2.3552338506715591;1.3905401109514726;1.3698012356608968;-3.9896920045506468;-3.2476776651475379];
IW1_1 = [0.77788138515274363 0.059965542745277912 -0.77935683896860264 -0.26863473077189609 -0.32088366730825352 -1.9701786482732417 0.10566322706440685 0.28999054940456087 -0.096361441001017525 1.0202551389582872;0.94077520050158592 -0.60519474218849312 -0.1419128175944967 -2.378800604577719 0.61108020691466747 0.51020978240520543 -2.8382164399925127 3.2402160931496264 1.5700756542165453 1.1694512140678479;1.2800752633579693 2.3433330509983401 0.44575408994811477 -0.42145760003549854 -1.1122658437855537 0.13751077090310815 1.1221709301848375 2.6571360201044345 0.79453336235610872 -1.8997060115563251;-2.3909562633362591 -0.011751659324814994 0.30740125721447625 -0.64100964774853297 0.32493026706823364 -0.21952253724586568 0.29055711857376348 -0.25837630982757953 -0.07274634745869811 -0.33203867929968062;6.893946570090657 0.3906302611390669 0.11409178432251546 0.65123377765600821 -3.1726686447917909 0.095534249903856769 1.4553567216821131 -1.1967877148376072 -0.009160983749186391 0.064812930058573276;-9.0655291195008978 -1.4521405592411893 1.7882167258681692 0.71098113591085088 1.3118056495514521 -0.23648371794234843 -1.0945665733427341 0.59120370618872831 -0.2089447941484916 -0.6145095257211286;-5.1971016831762764 1.8599484942497897 1.0277646171553629 -0.54769360177122062 1.9806264682813335 -0.26992657301811968 2.6687214444195893 -2.3019082971406437 -0.54825041729073043 -0.35537608629184331;3.490326241632439 0.013623342872064511 0.52164284807681804 1.1366996149718245 0.77298534471443414 -0.047825549566582366 -0.38764703993295141 -0.045463670712494922 -0.043780030043553519 -1.8562600480370903;-1.8144531260580368 0.22317434205878231 -0.36384329267716947 0.013750073769497384 -1.061609801203814 -0.0049855029687630691 -0.022029352421666957 -0.4350673704175152 -0.00090126505931763679 -0.27763137927700271;0.5655429210541113 0.035421733703680708 -0.93985767617572369 -2.1333982841494756 -1.323092858530952 0.080817762764297918 2.2007371547630563 -3.3368676950912293 -0.49240949668132733 2.9706497974147372;1.0182336495858737 -0.67091839421299149 0.52583124765226208 -1.1804801209246234 2.078131177189845 -1.8488241533897474 1.1627939500886333 0.76843119757694511 -1.0547122015879267 0.34769665263577876;-1.1944619072525997 0.025375861660804126 -0.07869269066564924 -3.0665442868736186 0.19538656551676586 -1.0596109890112664 0.25665205439925021 0.28473172918492795 -0.12784729613791287 0.59908282581733741;-0.079926905382054284 -0.023127364430908501 -0.89641825984736745 -1.6880609745272066 -0.94216594064830017 0.42670348277062858 -1.6855808417417526 0.073531329405459006 0.51395050779650153 -0.5560742534422537];

% Layer 2
b2 = [0.74337207235127711;-2.7008972479242339;-3.8878059129648439;2.5810963316575384;1.924885005108977;2.857030709573936;1.8549903700979848;0.48501850677177988;1.681910145034976;-1.6969836203159303;0.55339285487184176;-1.6476888798853935;3.0505434405312144];
LW2_1 = [0.18286817143136652 0.29639692710877774 0.58177490237477658 0.77100669672552424 -1.130769389742688 -1.2735250525443003 -0.81307953795220456 -0.7278157273499527 -2.1634625959870832 0.38495530453711241 -0.027339564122674041 -0.0056761076752785498 -0.55779503020678223;1.6040300084128456 1.2932073339362458 -0.35115962885245877 -0.93314800618594929 -2.2208224247225981 -2.6312450729585271 -0.15109703562584198 -0.95657818537766381 -0.15710487758492281 1.3161289622622614 -1.0944896663629491 2.2206527361216968 -1.3155361963523697;2.4336796899059792 1.0035368757042755 -0.85847342892935263 -6.6901839617281436 -0.13590461921093469 2.4997815869993389 1.9023642946384158 -0.51075819140424705 7.4265917076024639 0.62743754263662699 2.1753957401143262 -1.4049243554396165 -3.0273362558962194;-1.5089204653347323 0.65019310357961457 -0.031502674424533958 0.85971937417997213 2.4440610194291521 2.7534106425730958 0.35505736496531115 -1.1518910683458761 -1.9005143215475737 -1.5275843968043983 1.2190652149317864 -0.73673572124066755 1.1372706309881793;0.28499930272543483 0.44672666820867535 0.42410955983064796 -0.64407696961334071 -5.9821565216756669 -1.5543880139650459 0.28438813237722765 2.613449107158313 0.015006165458406115 0.23874767728154001 0.52367172922566163 0.88983405061037546 -0.96617916721218089;-0.58255953760024659 0.016129474661384816 0.027539007891656204 2.1120554092273527 0.85243494148536181 -1.3338698768826904 -0.13241487295294579 -2.7056376659649084 2.4068915779690032 -0.37277177715920135 0.26731682400556522 0.56178084811576212 1.6529074954223384;-0.63110135548747381 0.26805821732012591 1.186234432871059 -0.54819284979995364 -1.8424136597787681 2.9056518614492637 0.15603658299718651 0.45341609866923188 0.33590339269729597 0.20875835968858572 0.27205841877749792 -0.046148182524053838 -0.61255266917698448;2.5445269249106035 -0.66041452372945708 2.0826773007458086 -0.91513490744756865 0.86166443996994468 0.20484442239095751 -0.57003983747028053 0.22862476130932291 0.16724863055374795 0.48590071116143796 -0.16758049019848947 0.99716144809960872 0.30661127774408498;-0.71492108571129775 0.49439577822622394 0.62713220939861092 0.67141807442250134 -1.2135075971358333 -2.0050686509429925 -0.39485561683742604 1.2803123690635867 -1.2127403537462964 0.46854357380393674 0.20258732683247777 -0.34736543096526656 -0.87156521617147742;0.04854897134767043 -0.72229908728673198 0.15838214276889345 -1.8745756404317899 -1.3647151290258908 1.7084068207010918 1.5241324374116982 -5.0325104453702103 -0.56379005307306851 -2.3965030528038209 0.27007217369225489 1.0486780364938233 1.619758707861312;-1.0249882683900007 0.62175222893754589 -1.4140333499376192 0.84408189500342234 -1.0993646336271008 0.8225234169587482 0.52372648681731659 -0.26802599750184647 0.096998169210048585 -0.39950340887133978 0.17363888522601778 -2.1493067708293423 -0.41899331758786601;2.5882488966114749 0.02730840231677608 0.031301871846995677 1.0375181339098427 -6.3636363729841934 -0.78006966821940782 0.99895671117542695 -2.6247443454402348 2.5785961138678823 -0.40636391205455952 0.29958722892389644 0.791307162136344 1.6178575935752468;0.68357601821473168 -0.82932637924406583 0.082103554701013159 3.3355020794491481 4.780654975733011 1.1838866287866516 -2.7257068112017477 -1.0730479449865435 -1.3548790174699161 -0.33103350940540582 0.25636185593197458 -1.3646598169337831 0.48653420086466603];

% Layer 3
b3 = -0.084628990196623344;
LW3_2 = [1.0690266592046938 -3.5281046667662723 2.77041525950946 -2.7094351936347052 1.9884521819650824 1.2345384121630052 -1.123261802537316 1.982494018958181 -1.0892094206887415 0.097994194572886273 2.2043762221290506 -1.3147489794574592 -0.056915736854244336];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
