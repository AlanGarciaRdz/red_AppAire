function [Y,Xf,Af] = PM10LomaDorada9(X,~,~)
%PM10LOMADORADA9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:10.
% 
% [Y] = PM10LomaDorada9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.7707720468000792;-1.8347627701199152;2.5864352322727457;-3.8431689292973803;-0.65767146164931556;2.3418533108452624;0.23473293622455879;2.0197617880431489;0.23519229676663406;-0.12076148496098935;0.99472010341022854;1.3080659825445071;-1.7740616853697619;4.6226146703154711];
IW1_1 = [-0.66545491886549835 -0.59826283419531434 1.5583293395029496 -0.71645764213020691 1.7608879559875066 0.21575934771911948 -1.3216531566160237;0.15678430803755156 0.025238134295473762 -1.6085267107677459 1.2790763945067092 0.10157804708887155 -0.18759100505690346 0.62395434161265795;-2.1070197942799949 0.98054817025219165 -1.7451331187689616 0.70807625118699358 -0.80229141957657313 1.6680387437697004 1.7629626827405656;2.7880224486211547 -1.3351946291065959 -1.1122983594953619 2.1512441937562286 -3.951561924804992 0.28881760420293845 1.0177958735407782;0.043602771290074914 -1.7049645732179861 0.046453496147237122 -0.11501820287217532 -0.063406245614018836 -0.057793814493893661 0.11038100825879343;-1.5861011401835337 1.1239176628271899 -1.9652513754262104 0.96487785753556188 -0.43977651737023182 1.3468952527081874 1.5506933613043377;1.1631173960672689 1.1061278024798511 1.3515156068579479 -1.5085431331689447 0.41714727335456969 1.8216265784904897 0.19984767240569634;0.82476896924056853 0.21409565328825642 0.93694391632488561 -0.61576965522961158 1.8493415347373419 0.4607033363556568 -1.1501904437781723;-2.4688887728877935 0.39795967855597353 -0.30265750140609243 2.0701143050823734 0.091211954500475798 -1.2430688431767951 -1.962328663557132;-1.5705542897052824 -0.5715329550425402 2.4700142009833166 -0.47837135670071451 0.15492909575608327 0.021881404943337596 0.7222594880218981;3.0461331345920089 -0.043030514026733885 -0.61499589079862549 0.0016956063063883614 -0.2817164890943627 0.32410669195980868 -0.26496756204136324;-1.1908634810103718 -2.4770947757956217 0.12982137147682848 0.72352095865137767 -0.35636605358393703 -0.53815856026331088 0.91730960714396592;-2.7192311330262422 -0.23682483242624172 -0.55331558941172243 -0.17186958442564682 0.21236719466536727 1.9769643972022721 -0.49867351015592315;1.1545758637773844 0.65285356711623499 2.9899160848285931 -2.3812865871719318 -0.66335228529852019 3.2448594002990596 0.44248141748508379];

% Layer 2
b2 = [1.9051869530086989;1.5637505537151397;-2.0350794828314953;1.3649906050349874;-0.68440080259203551;0.66324837685183147;0.25397053386851226;0.42965923165731462;-1.3001945758616995;0.17348820072899371;-0.040337886741128065;-0.29120016692729622;1.5616744374374707;-1.8249914860246843];
LW2_1 = [0.51651144519105741 0.25990317608881575 0.0508062262541535 -0.92296199934561196 -0.61267433996140386 -1.6979531399542811 1.1590404785349935 0.73598149084057474 0.65166470413144273 0.37387705196048115 -1.147497182742216 1.0119847412771901 -0.64308602015345318 0.28869715379099758;-1.0069679231308255 0.89918617587804972 -0.14786912269010799 2.2989233672648024 0.28617028330167366 -0.49046834712853715 0.49541013249374088 0.8214921121863511 0.46541846328501896 -0.14369421358402093 0.80031721824324364 0.0015952802605027055 -0.67552785433924811 0.18208345563306874;0.56020199862057396 1.4074351053453016 0.094571651790867989 0.17762180367987276 1.585722068981376 1.3993092405668142 0.15984780389020709 1.1915780843518118 -0.46814881827126631 -0.54950239787210708 -0.5393854358469774 -0.49687818612846379 0.31843168477216893 1.2913163696213181;-0.3674604873816561 -0.14322536386298443 1.4071941652740567 0.8388748096632046 -1.7257362576345714 0.10176965939290285 -0.7996224483077351 0.076501099442923215 -0.64581573411084336 0.10320815077776196 -1.8724003488624223 0.03638599885179878 -0.24690288673328808 -0.79585664616673824;0.13018163964780693 -0.043900462648573044 0.59412430435120966 -1.1535601581888717 -0.7547930310143709 -1.1193000218327391 -0.42273667808597415 -0.57721983270800836 -0.21036269765989959 0.85426775583436632 2.2270963440733302 0.50736164102672532 -0.1581171926608827 -1.4880402777108532;-0.30137567838177448 -0.58135764341330531 -1.6250774186804904 1.0287472061509391 0.78528240831607854 -0.59180963005908371 1.3216550252546311 1.154803771901193 -0.94099493734944795 -0.16684786487593528 0.47697563198589321 0.95257161009594937 0.63824764302579662 -0.49798086866507035;-0.27476139007087652 0.35324335085529784 0.48754850282329609 -1.1942601946409104 -0.18503888530094417 -0.85709392647834615 0.053238502274149536 -0.14690390521253235 -0.16794778165684188 0.35980794142224248 1.9020828428690413 0.20195763994164107 1.2725680536635271 -0.33321425900054413;0.48734936487879399 -0.50396815258473215 -0.32274520102846738 1.6946586562751278 0.17667979351410096 -0.13899617428822164 -0.86607941695467294 0.53358403088509687 -0.34002847106643425 -0.069528053957250105 -0.55596438597135212 -0.66409280570067875 0.13977594721379444 0.7742409848506222;-0.78736156010471603 1.0489357506749195 0.37615631699729024 -0.81015964703174803 -2.0230656156046103 0.13422637672743074 -0.35585965284148663 0.66430030341757829 -0.37003579206723342 0.67647840130682813 0.94119525637345069 0.0088224051894366488 0.30042028535376852 0.44409987264100981;-1.7745443072717499 -0.41658782329179567 0.27180588987690862 1.0418582562118361 0.38967597091179096 1.6511534532966894 -0.13609062721203546 -0.49643620059969684 -0.81291509973943521 -0.93375654914417527 -0.83600244218429709 -0.42609131472805073 -0.63313493938730236 0.092961164229792892;0.36091679707742041 1.1310107671981102 -1.145444058167139 0.66901728023657447 0.86027763412498881 -1.0557385065375244 -0.77988126221187848 1.1449102670864677 0.13365295069360628 -0.40495160673524372 0.80573136398758705 1.2346439836702041 1.2396194651522274 3.6922374351952487;1.0628900507324612 1.4495784935711522 0.69710610045939692 -0.62595307113162002 0.20966651908527173 -0.33140374230314457 -0.45958909027981026 0.56696218514751073 -0.14665301095652139 0.032186112851304488 -0.44651225166687031 -0.54778397117541477 0.64460768854521633 0.83514306276093719;0.91879325339686779 0.11524245740106992 -1.4154269415183891 -0.71109988853013484 -0.3991087118580286 0.14948799544699984 1.4244532453020771 0.075827589545416907 0.61425008867018316 -0.60922679331277874 -0.77224895904173785 0.72346623052301995 0.1638019565189528 0.58213303289715157;-0.97011467083253455 0.15467003823666478 -0.88314169425122369 -1.3014906721196331 0.051108403137768779 0.46978774294026465 0.024480659730497914 -1.4215805111795694 -0.97265973873101197 -1.3796680528689422 0.22459452631781693 0.051256737353765104 -1.0249047830131088 0.10277017994052332];

% Layer 3
b3 = 0.25197295661530844;
LW3_2 = [-2.0942719265196463 0.77227838283977002 0.44881398141309103 -0.32627195247434926 1.0518291650550975 0.086938853027438298 -1.552072142046462 -0.81085134733847375 0.27971189233520427 0.16598399276909498 0.14548559457773322 0.98179187312745275 2.1770737679525087 0.3375340520127203];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
