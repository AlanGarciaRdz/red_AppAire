function [Y,Xf,Af] = NOXAtemajac12(X,~,~)
%NOXATEMAJAC12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:16.
% 
% [Y] = NOXAtemajac12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.04040404040404;16.1290322580645;0.0210748155953635;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.1103950835104657;0.83704026255236419;-0.53910300256244015;1.1625981401604735;-1.4034717243835377;3.4909464992840098;1.3327204772574643;-0.31827163495293515;0.20121101468179811;0.17503490204169578;-0.65446744192044315;3.512964839227477;5.7720101162468582;-2.6212420907470269];
IW1_1 = [2.0517207607319987 -0.37895276099197756 0.56505204413005794 0.67083575395210682 -0.12665496893312508 -0.68437599487436529 0.89560131053743341 -0.52191782401141751;-0.75359044046662405 1.5994214311336954 -0.95745753849027659 -1.4380796679320587 1.5487326783048565 -0.90832061133642794 0.10619132877780697 -0.076340879112040252;-0.26097948945183735 1.5498535153189998 -1.9808434348576858 -1.3716213775346189 1.9379496982966808 0.96215503645426237 -0.00079850068006381489 0.082970459364162086;-0.99836199985267515 -1.1390746947643327 -1.6299716142168803 -0.84088074949983804 -0.032976780386275321 1.3224567136192984 0.40121583064934957 0.99770105368635809;-0.35014040049255518 -3.7851754870404939 -0.25088722972298555 0.76945826083669344 -0.58211966952087568 0.94706991076053137 0.17937147425631805 -1.2331800006068221;-3.7184380359933735 0.60720274078043235 -0.61256285999123128 -0.39262477024956172 0.78228664559741845 1.0172803673475801 -1.5340602022726211 1.1035570049316417;-0.098335877596681123 -2.7576582247889494 -0.17536847814733178 0.11214231588382015 -0.8874506058339835 -1.4370034285562929 -0.26967326269031922 -0.96809652196980756;-0.098333172560229859 0.39966030845086731 0.40516118230165526 0.21027151393031968 -1.3082641523335636 -1.581105127820746 -0.1694662375494963 -0.94608268519674077;1.180966879501447 0.8510538994220056 -0.73611700663160451 -0.58497808394668604 0.59913711753456955 2.0446850455582677 -0.6499608903489984 -0.80170037085194001;-0.10898036281649852 -3.4460264559746285 -0.68086440817920346 -0.051444638117490074 0.43618755551434901 -0.088812202579946889 -0.076961164968976176 -0.21291483055777383;-1.8065138280560631 -0.43019595902233809 0.86232377495853074 0.7457696779392855 0.32417372217493368 1.7877383487216891 1.1335477412702815 0.56893343868451285;2.3736440256479501 0.031633334512388298 -0.34558305389005939 1.2576780843235875 -1.1671351911180499 0.090947437459493879 0.84965826112353771 -0.22131266911831921;0.28237225564895835 -0.058257590524586997 4.8829797024308856 -0.21661935798691972 0.96670705749170027 1.1806500544466432 0.1818492496024687 0.52785703679642981;-1.1385440169833643 -0.6070796705501581 -0.59428593627813875 0.95883770786622224 0.12729621267060731 1.9553420208428038 1.2856681650032147 0.33651274196355702];

% Layer 2
b2 = [-2.4104211971953027;1.4804754744799844;-0.69078379836749193;0.96625073721692323;1.2838704123077886;-0.32407742146305485;-0.14239977222812358;-0.38613693815102912;-0.50133540343804994;0.12167187943347575;-0.68723241552122283;0.88993469954769622;0.94529111811502087;-0.017977267956678623];
LW2_1 = [0.25286418446014597 0.23974277241716979 -0.66883728893384531 1.021229186799006 0.44092853323598002 1.5355241019401624 -0.27103721988047902 0.23872280468831916 0.81238184085969167 -0.63899480376141948 0.62347737703960959 -0.60715678624329195 -0.51171187407607588 -0.35109873684792142;-0.082839988036326584 -0.35549903430600666 2.6768758750247992 0.50687451981828535 -0.70770905398200479 0.96971469128412924 1.7601023122938941 -0.59908897389142668 0.55104467197931051 0.29875461797734426 -0.62784616709552998 0.17051509659079381 0.53617695842466684 -0.4722018470653262;-1.0130610178669455 -1.7501925731443098 0.48747369158994636 -0.035578479052196563 -1.0827712842674733 -1.1653668412908755 -1.2005490856154806 -0.01709775810532322 0.81010847187152957 0.0032634758939154955 1.4527889294035539 -0.41410471002619054 -1.4498327908419204 -1.3878133502530383;-0.5033294047475505 -0.6188424702908687 1.2612511649615554 -0.13539669490280221 0.64509660939467595 0.15706826865195103 3.009889014443321 0.15220204715798752 -1.3421008991987364 -3.0655985187680788 -1.302615311784727 0.37135293478391884 -0.047223201144490357 -0.21898602862990266;-0.055892584474647455 -0.30997685568567301 1.1871769397507865 -0.76246754320874688 1.3943919392966715 0.58088761964671221 2.4337998358860826 -1.3110929541786751 -0.9714192849488501 -2.0479230794720844 -1.3963931060148196 -0.65311650144383071 -1.1946801473575031 -0.63150302789386037;-0.04695981449035673 0.15833556461807077 0.32750947268129521 -1.8485430595857411 0.83895840373248864 0.81743869689844151 -1.6682210725627513 1.5154467438315635 0.68821773887548754 1.2775655413174445 0.031454298962672524 -0.091110907381854275 1.4801106087655358 -0.38817740897677366;0.79174738155559843 0.034314975206238371 1.3798338391534248 -0.53002669924628254 2.9395913149441277 -0.078927305669838813 2.2573262177406166 -1.2134444889604818 0.50386982068725861 -1.0003048739541232 1.5619051226365539 1.3581238996555032 2.1968710795032682 0.61534799799391626;-1.2456251020950004 -0.52661876982778366 0.60092330106333358 1.2954521678928363 0.079666934938495498 -1.3044431374427818 0.39193771799676774 -1.1883646116732174 -0.47714415769114682 -0.70001777902712947 -1.2992446339791486 0.21935015834267751 -1.2916553872876124 1.3783423206189216;-0.32080099083854419 0.12857410113860793 -0.99681559203512837 0.33578070424232176 -0.48657008574575528 1.7689375574049842 0.73236140218816737 -0.71019596041217803 0.13393627691109239 -1.4118453464025496 0.83791930569221096 0.81823545235155759 -1.5372168562139645 -0.14151143379531489;-0.075804888072256479 0.24042844119163431 0.29085112040723049 -0.68338522361340504 0.58993940981229664 -0.40044922914219627 0.14416716971961532 0.0067267471503415447 -0.15736216027259298 0.43485823534474133 0.064867692991528419 1.0683977233459534 0.84408555497378723 0.11488420867377706;-0.64948451957984776 0.2099877543212586 0.26311819795907537 -1.6882421398705707 0.79784613491567768 0.55363290090161943 -1.9318283900476765 1.6939233861054872 0.76225578035251818 1.4523623340397049 0.073584884926293614 -0.013295317012102648 1.4802609218704728 -0.42302850049036994;1.0614206257410832 -0.27305584166843477 0.28955434424781346 -0.31172562884364569 0.30485324740777725 0.12544497982307523 0.67369026242435104 -1.3495513179572944 -0.44389781515466076 -0.64134166749319976 -1.2042584377029328 0.2744545817727338 -0.58010309009149053 1.3958454108772294;-0.38688020257737532 -0.0029331360065469299 0.63821069535885322 -1.2142375142331912 0.27710875721858363 -1.0957377617004223 0.31741449183620896 -0.30635443761344366 -0.5912451487564423 0.45029471680200883 -0.35729358531465782 1.1707108097277703 0.62602787882502675 0.17772675950764644;0.91009564549253796 -0.34930283866292022 1.6530237615301193 -0.38638213834223961 2.6430291584736358 -0.18830564665936975 1.8397615577596229 -0.744544824547406 0.23031544969343928 -0.68930929717882861 1.5345961417932612 1.4021493884250831 2.3065228652135743 0.29887900500336145];

% Layer 3
b3 = -1.0023188496780187;
LW3_2 = [1.4764088908795145 -0.81911891176209495 -1.0533556106859052 1.386614851850547 -0.4302965249385855 -1.8082894978911586 -1.4717896103382364 -0.53289995028591175 -0.21960703487279992 -1.901882242015114 1.6017188266441806 0.4635142090133787 1.9855756796184005 1.6547284991739446];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
