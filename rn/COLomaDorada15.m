function [Y,Xf,Af] = COLomaDorada15(X,~,~)
%COLOMADORADA15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:39.
% 
% [Y] = COLomaDorada15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;17.6991150442478;0.00572573718866304;0.0175284837861525;0.0546448087431694];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.9892812323999403;1.1020025516649998;-4.4019373708245135;-1.2760116346982961;3.4357610796387572;-0.60964358262286733;0.93619562860282945;1.1449591187476877;-1.1946282525314078;-0.5302652446811873;1.1461712993445836;7.2845223538711323;-3.2200160397871951;1.1132346898238348];
IW1_1 = [-1.8317784827441661 -0.7971228176511217 0.099453743169723385 -0.8354306744997928 -0.68230121506442765 4.8386894067857957 -0.54256273208993799;-0.18997224352039588 1.817939175524774 -0.15339137230914543 0.89648851611930014 -0.50355604417830291 -0.42880965446802111 -1.2273519979565806;-2.8072775528838725 1.4340481108504417 -3.2028713047331636 -0.33649132377664576 4.9826965707560351 -0.16149483374436333 2.9069680314332849;0.91907555500976001 0.32738141921015163 0.089313584210806707 -0.50747536462486909 -0.27575010625634383 -0.2261203051410404 0.24695667797515111;-0.20327768488997003 -5.6994559448326427 -0.020894038829981809 -0.078905948834903428 0.38871196816965309 -0.22896676713686162 0.37508275303893068;0.81887324110388271 0.87548055153703619 0.12642254839719733 -0.89928917616735404 -0.68196201161192682 0.26120980835136681 -0.32425839051412259;-0.8425173104643211 2.799156177223511 0.051623673467176112 -0.43347753594914806 -0.19955901879905164 0.79473633064014626 -0.17959392257226214;-1.0824937565420614 0.36193466078113906 0.079644026527488601 0.83450721890267232 -0.14137798359360534 -0.077168733561934849 -0.38357226618261075;-1.2035027444953923 0.35771612031168049 -0.98106842136433259 -1.2383066368433853 0.50590807200647903 -0.87872729862985566 -0.67698641855168773;0.2879310552411336 0.75439485358632363 -0.51160790029712411 -1.1329276304743185 -0.041095525461047673 0.46324062582240516 -0.62030417369981639;0.80113095026289582 0.95363582793430079 -0.16883809461051469 0.20291560239179782 -0.14191319037678435 0.196401735990994 -0.56935703477622157;10.016459079408238 0.0016638659346142129 0.10235459992860167 -0.21620649392130059 -0.89093852215802383 1.1366000088685257 -0.17184157253397009;0.27532146307201322 5.1002543083548577 -1.1374731393835131 -0.29557448558772453 0.8226427963867371 0.23327314395818768 0.70772674424247628;0.27516659305476998 -0.45075717786230235 0.62300764723516966 -1.4549726714300977 -2.2872677509064849 -1.3769121195230754 0.38778893457945252];

% Layer 2
b2 = [-0.069764027510036256;2.1332185296763919;0.79076901432321778;-1.2509462208992523;1.7455537582767355;-0.60566813701325617;-0.39859677364139418;-0.05358090872634523;-1.1878126453868665;2.5068182230344771;-1.2859460418660247;-0.6559615852199685;2.1995795660298287;-2.0784176500890572];
LW2_1 = [-0.53439501440196946 1.3736799122018228 0.034972150336946763 0.478462349555972 -0.47820890729458454 -0.85003759088029673 -0.021716957751823557 -0.3898352485483656 -0.8218176379506128 -0.18786640379371797 -0.61701412012419399 3.4250205068926203 -0.19479040580797854 -1.3638578760205107;-0.59152756864105005 -0.33316756517339896 -0.058510001712215085 -1.1812091974843919 0.72191074390357479 -0.90401334848808013 -1.5666082891829953 -1.1869496490563494 1.1117985559178321 -0.21706136021265235 1.0891793014049314 0.68741511435987812 0.14185071515493949 0.74252109300034619;1.2925322127081511 -0.95935444207729859 0.17656029500726 1.2958628703518589 1.3475578692791048 1.2367049428609156 -0.91911946042904247 1.6839005615575071 -0.51611995985730508 0.19765636855296609 -0.77718926521033393 -1.7635423397537118 0.31558149572869504 0.083500832401935232;-0.10119201072548381 1.0458891846937579 -0.40717772635894978 -0.20989450614390542 0.57098297517466023 -0.83961829127943444 0.38312614347137974 -0.34442803235080921 0.52478570058823082 -0.20025371398688252 0.40115492010350084 -0.062642563518539765 1.3873101137717918 -0.32236643272930465;-1.3689606439228874 -1.348191207584486 0.10794680752363607 -0.05999012749769253 0.63242563448128974 -0.1856896513337786 0.39607508626831062 -0.35065410146503995 0.89510172897377138 0.40648656526763582 1.1688286478458352 -1.923232393385401 0.38310164993962476 0.9685631055640801;-0.11123127734329424 0.87791779571793682 -0.25901847368692782 0.29612305039756248 0.17265665586001142 -0.91502120229627082 -0.3551207116722776 0.26335137879842146 1.0489435490880161 -0.7009546458339434 1.8443557484565798 0.15159895619621983 1.57868463674065 -0.93625736780039115;-0.15566145937098566 1.5721848638270532 -0.69251505929912849 -0.0069762478846497611 0.93511999796635159 -0.39212651478578708 1.3760228874805249 -2.5215383715875586 0.32624362338040191 0.39577098919796955 0.53677868559521436 -0.20438137752497865 -0.44022537696005631 -0.79247036133186533;0.35591226238106322 0.59537309759684343 -0.15264531582247426 0.69993636275015825 -0.067145264373596414 0.46273866528434615 -1.0545841527396151 1.897572464896335 0.29226508105111626 -0.31766004347429444 0.94010160864559156 -0.063487799858489555 1.5039824772915427 -1.7013759159369874;-0.4324780851308071 1.5214114611618657 -1.0542497820308123 -1.9402311264318592 0.9648981438833818 1.9723007552328911 -0.08243302088486068 -2.8172144357686189 0.61700766941075158 -1.2790259634064076 -1.7338296038529031 0.099599234726724079 0.41090781893649719 -1.5151765297528792;0.69231757102089564 -0.28238529241329829 0.13590719843962121 -0.50454114772937775 -0.54102345960601872 -0.64947723277554104 0.13190214079081006 1.1378320674539855 -0.55878229340022856 0.3342596092289376 -0.78540805489537469 -2.7358207582029701 -0.55055239537525147 1.1007629277900373;0.031667673324617472 1.2959488132452486 -0.24542658860408115 0.45195180884831782 0.29324038141481418 -0.58864268722179947 0.42432054069728176 0.29902386565474953 -0.043111458720073118 0.32464132588946498 -0.52987247810125426 -0.067069556288104071 1.1045556825287135 -0.14919493417804053;-0.49545673228331633 -0.44974992813901965 -0.21287097576248465 -1.2539696466111321 -0.72266035250874483 2.455221512990954 -0.0099276280648333617 0.70718480455334487 -1.0676439337366816 -0.72979033256009462 -0.94499395854023094 -0.56188713142864688 -1.1193421959648802 -0.3478289432678765;-0.04312339827746707 0.24289293066336723 0.075440172617782852 1.4536539550950831 -0.82771060722692613 -1.8938857584541842 -0.32434184737415733 0.092899724156755306 0.68223568044937433 0.8924127657816312 0.67213874291725895 0.43240727090864539 0.1687173644118409 -0.29703551321191529;1.4110110418171522 1.2437697963849297 -0.84577633555888398 1.2943811884383416 -0.92704449861648575 -2.3261823463249689 0.48419129539232808 -0.73462743195103353 -0.66341672897832749 0.15940194484197029 -0.88607518171908017 -0.025081002515480524 -0.5914174959099161 0.38449699587529462];

% Layer 3
b3 = 0.09821923155480107;
LW3_2 = [0.57558394201009566 1.5755036290496756 0.38615999245425531 -3.0106384111746292 0.69200743703752987 1.1320376589327299 0.29360367203237825 -0.9932068566872998 3.043397056439185 1.2893034662189293 3.6364832601805919 1.0328341635109415 1.313303202994659 0.49399638592816564];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
