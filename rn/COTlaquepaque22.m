function [Y,Xf,Af] = COTlaquepaque22(X,~,~)
%COTLAQUEPAQUE22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:17.
% 
% [Y] = COTlaquepaque22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;14.7058823529412;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.448430493273543];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.4052247155070496;-0.40277884103896466;1.208222860921081;1.5309989205969445;-1.5195666305011399;-0.83374442812166005;-1.3266887350049286;1.9626162543006549;-1.2120344024141623;-0.33239393351764479;-0.15852514024344919;5.6239071755057628;1.0900610596602007;1.7536643864065089];
IW1_1 = [0.097832688778109037 0.79619546946843356 1.5391950170884245 0.43875608842280861 0.85103611798167245 -0.78948266944214796 1.5179720548916786 0.78612326302672531 -0.60766367551302403 -1.2577892339216961;-0.46665251464184071 -0.77824761127116193 0.078921873439888629 1.4149121930360853 -1.4650633437323282 -0.36202429472822734 0.26018402305690752 -0.57607651741702137 -0.94209602544559334 0.82800792636845422;-2.4050787450461817 -1.136884241635044 -0.88035468614856338 0.010883662267490192 -0.20761798202635248 -0.41870712962465911 -0.091481262179724701 0.013582951855801256 -0.24441611286225193 -0.043980062032315553;-0.063622648876195356 0.57819308082136767 -0.70973593224846532 -0.23287330556020722 -0.23985768417875905 2.0379129153920386 -0.21056844234957814 0.62644466514646879 -0.22259469348245967 0.72946589761444913;0.097268454380754377 0.14331811988484963 -0.5219790284078224 -0.49380499227388674 -1.662263775084305 -1.0795522539530265 -0.1738743461541235 0.063940070856855866 0.56535753133083944 -0.43729171487280816;-1.8404234784739788 -0.14998247101601242 -0.42484510109688384 0.13386284827663961 -0.94908197024133156 0.2497969418283941 -1.3529936537993952 -0.27611324742526167 -0.23342878320638613 0.6681058356830768;-0.98277431812582272 1.4905273635020788 0.22009301347083587 -0.15885988574848625 -0.23516982870716152 0.16182730493410741 -0.092449110465224013 -0.14210947570684501 0.16585371972704033 -0.0059838577346762005;-0.89181011306769253 1.2485405775877836 0.18326644151236443 0.17253037471342453 -0.55585889308837133 -0.75542460544962642 0.97911549163327938 -0.17556136382271781 -0.09480448186256242 -0.1545162636598203;0.11169112784543384 -3.9876270130957505 -0.08373104407205928 -0.12578451069360938 -0.0074033370632117113 -0.54641160041726999 0.092918715518233358 -0.10745768818742488 0.0020726332224107018 -0.1056281073481725;-1.1986402645828116 1.6726328995183992 0.31330643018872711 0.55939404950725358 -0.58275634749396776 -1.2941268550828038 -0.13214277277491282 -0.03412135867500922 0.25807147040985101 0.099175519512265248;-1.6699351591122211 -0.45060865391342286 0.18226264735134867 0.95883895200458014 1.1224304788216557 -1.0339880446614924 1.3900930644913887 -0.93433387823666036 -0.15395163629123448 -0.58479193163194654;0.63355152226801692 0.077415932906344853 -0.18313563860849419 -0.15449535781328422 0.041345139203710433 -0.15911502640308461 0.38384074188838546 0.08916408775202099 0.067195331620862012 5.0126830841219352;0.17375734230498222 -3.9481869035493444 1.3888484027569539 -0.12994175621814433 -0.083079504629766335 -0.33170768952255825 0.15681752280638264 0.025913203368916785 -0.1314397218891615 0.25372041918652927;1.7298711026629419 0.57570655588041297 -1.0043761896154668 -0.0054314575426698819 1.4019001826141158 -1.8506804532131922 -1.4236446206597235 -0.45627199987828182 -0.10370173763540751 0.65758020134596851];

% Layer 2
b2 = [-1.1698612175756733;1.3725328967695871;1.7617445822012621;-1.4579653688118759;0.47141693957569697;0.026948539405968669;0.27549526761916721;0.97753976195142445;0.2008322990279168;0.76034003044336274;-0.30200357913047726;1.1140401505159732;1.9103727003412498;-2.0881547623236059];
LW2_1 = [0.40103974844746781 -0.46559336976529631 -2.2493991186982711 0.34943448799845872 0.22256859692997036 0.67415492707241198 -0.037625266421931015 0.56516984701125883 0.064280982752181304 0.66824404527973558 1.3351969286385619 -0.81971525732316575 -1.1259974580674388 -0.349833565848235;-1.3496170833310126 -0.75507184952644513 0.50503523238576142 -0.12112153159968235 -0.21239464570742286 -1.1683126957659618 0.61836546301075912 -0.74745925409271574 0.42265039421352996 0.21241160786771968 -0.29284638871632418 -1.6066716394246818 -0.26316461628410859 0.027475882590843645;-0.1304081294679855 -0.24532890291296722 -1.139612092737297 0.36786703261143011 -0.021604500680372323 0.36521241318804615 -0.33045149366857185 -0.83975323730485596 1.5887533649920584 0.63839550639022014 0.47656985060335294 -0.44402564910856329 -0.41102576933680096 0.28217739251350826;0.51052058732045458 -0.22220715529707577 -0.48578168561998214 0.2853376557793717 0.82774636311407113 0.37025076861275263 0.090973322123045347 -0.32364350125958491 0.75182285272200089 0.35959877823220326 1.0621550907309576 -1.2872246630088762 -0.028400685841451043 0.46417082744767624;-0.65538525923788105 -1.1971954462055345 0.12183017929117317 -0.11631343064273955 -0.087432097282813162 0.94379316425830018 -0.60584792570205837 0.57984790582703472 -0.13567436196373889 0.92119203771329317 -0.31829499610605627 0.93927081135142132 0.0011545221941266087 -1.1344309851992636;0.52363818107578464 -0.22347255986567033 0.60243985410171264 0.20454367970962992 -0.33591596902239246 0.2549298619473363 0.98077455269929537 0.23251172610041104 1.4677495336436073 0.30647794468986211 -0.40875269975290363 1.2421485128223042 -0.11082778221032892 -0.081713207678607361;-0.15774430897572567 0.44865852813170376 0.37862612240342464 -0.30934959706100762 -0.2639339787167605 -0.84184507763619454 -0.085510739592623813 0.57181039809833711 -1.0430838670860452 -0.040382062424064696 -0.0011311310008202437 0.041869830571443313 0.99697773572974224 0.57531523874537482;0.18591194373049905 0.61741863836572108 -0.076787118454165748 -0.32283582723013943 0.28212253125147568 -0.58180291294796005 1.7841625070929403 1.1958541041630715 -1.1594325087180739 -1.4946618434041079 -0.13668205140974996 -0.2379490281831933 -0.23466775115557992 0.25208032823082271;0.45867435828137293 -0.25290334187005375 -1.3071836527198131 -0.24513605767195656 0.64981221146150736 -0.21981067292860346 -0.79094986710680215 -0.53090277738660741 -0.86661023555518923 -0.20399296951689497 0.70511804180370397 -0.81814891652728261 0.45231132024189785 0.20186690387352224;-0.1308598623802161 -0.54381064721858496 1.1936132405529238 -0.16421710847039656 -0.27903087484294214 0.75780648998660205 -0.78188097680227142 -0.30891352133559058 0.89852382112443574 0.65665689101393565 -0.98019566872064701 0.51878933040701913 -0.70915791752081092 -0.22357297922074873;0.56074388122228369 0.68951696441113874 0.60499404383546618 0.00035263877133876603 0.54629263368117176 1.1496674848037793 -1.6802868989304764 -0.50772884285766817 -1.8203040435957736 -0.88745040445312984 0.47206237671020829 0.11387862219601956 0.87533431128418981 0.33420202608869665;0.49425736440705842 0.6132669218298914 0.35656011305927932 0.22730986051083416 -0.98727483305704933 -1.0166418687453975 -0.96645158179039592 -0.1516493907904049 -0.33298965828203159 0.31535843607261599 -0.29000198887034423 0.33856003381129929 -0.36484834826383328 -0.10180356686956654;0.47863762885264016 0.64457737542692239 0.11007658070312536 0.15479656806950925 -0.28124442243836806 -0.53950664281414307 -0.5184556941598637 -2.0774747142081251 0.87585310449994647 0.11448385182979512 0.14442058381116729 -0.8073718645139778 -0.58707126285788003 1.2130197277707118;-0.92709581213778736 -0.4296935783944803 -1.4862694952517224 -0.4123966942479233 0.4414007685549643 1.5123171238635609 -2.9150302292376553 0.73904371296270732 -1.9875460701784482 -0.15320569929956845 0.9732777169208191 0.71656358476363069 0.78222756690882267 -2.5621094360145062];

% Layer 3
b3 = 1.6663273703291641;
LW3_2 = [0.68234530814254535 -0.75836151962259257 -1.3038051013015164 -0.9168426742441026 -0.74096196919709456 0.74815871731218064 -1.269211798944754 -0.96374425117275742 0.65169705699963598 1.6125854395583956 -0.53042022110624476 -0.5042847079467343 0.78052778538848588 2.7532120538048308];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
