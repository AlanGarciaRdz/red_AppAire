function [Y,Xf,Af] = SOXVallarta1(X,~,~)
%SOXVALLARTA1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:03.
% 
% [Y] = SOXVallarta1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;10.4712041884817;0.00782778864970646;0.0208333333333333;24.390243902439;0.02710027100271;0.00630517023959647;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [4.653221764586732;-0.90664972143182221;-0.20822300042450009;-1.728145078558841;0.028512934506524527;-0.98031322484614847;-1.2587883393147892;3.3482118553299425;2.9728873167504664;0.70600986349210271;-1.5918619028103835;2.3824100688360264;3.2064892731388364];
IW1_1 = [-3.0947753484992715 -0.35290328530025233 4.179275084902546 -0.45493811519622734 0.73970131785824667 0.78972451083964201 -1.9910789110046323 4.7505012544079994 0.5013644929657779 -3.3080986348918708;-1.6493476279175339 0.066260857931967121 -0.44253411139608678 -0.1134089287560978 0.1267414470592616 -0.50253927061765558 1.6955638193139981 1.9603418894097804 -3.567871174494587 -0.10425509992810568;-3.9228591215718085 0.087434925853659196 2.732227667777277 0.13894632828604769 -0.018610679083498241 0.19798534575039539 -2.3786721868578069 0.87925443706610495 -0.18895364258372635 0.28888065208199581;0.3798772139626978 0.10199021134720181 1.0395655403202502 0.87440292891847748 0.21640375640812609 0.3786345149234247 -0.27039154032118817 -2.8177320452216095 -0.061468504108426067 0.14043327207129105;1.1588952159806307 -1.2441780234385289 -0.33098444066454197 2.4327799012329931 -1.0652150334735588 -0.92327773971261706 -3.2701329850157279 2.9248580277697491 0.085853859140095856 3.4201873150986466;0.73044201677046994 0.51660854870142836 0.53986241216026531 -0.11171633052649817 -0.0085199684229520112 -0.70697318994090041 1.2174597341472269 1.161062769089664 -0.29912976356657439 -0.4161270080651443;-3.7391111562550723 -1.4119749946428974 2.1659397554639628 1.9724050331717582 -3.6681729456018299 0.79128629278911555 2.3300048641788664 4.7557163634637769 0.42967178137243656 -5.3744687970540523;-2.7558311853195425 -5.6689343956214371 -2.140097461931854 -2.8305216658492998 3.7080598835163174 -5.3946185328091278 -1.8694985361745138 -0.4257482353352452 1.3375079902025007 2.1172725146740494;1.8472071584344234 -0.12486722870958454 0.6978938556811598 0.38807420652674052 -0.085117389992923301 -0.098917020997954824 1.6085289318990426 -0.31644141357529626 0.14263123386986992 -0.059524900628459172;-5.5663775764509795 0.32911621130583646 -0.89673944647805393 -0.98392868189931126 -0.14887711320489277 1.043412049768659 -0.93639841707366922 -0.85340492717176664 -0.15698033532363193 0.25469599333207621;0.78936850299658545 -0.83312092625770462 0.35914176173964746 1.1771557917973985 -0.71753953753379607 -0.34577072390024949 0.79786576186509917 -1.0733593807808557 0.032658356547460819 0.54720004927875843;-1.636095184863545 -0.72631395020948331 -3.041542198460248 1.7761406717670716 -1.8260490653262829 0.52205693492163929 1.045735632796452 6.2664119743116427 -0.49667642142939827 1.8199718772415787;1.2451770841036702 0.49320167312677848 -1.5638748034340537 1.9697518587932197 1.3593889623591302 2.7347396511984972 -0.10640175907292812 -0.14328434057340386 -0.15681060403260269 -0.054888913790299212];

% Layer 2
b2 = [1.8773682733879367;0.072524736470706286;2.0710187049354025;-4.2858267617585017;1.5200049511188571;-0.19945248548811978;-0.51736089845084043;-0.75011792343706118;0.93175502854096193;-1.2841916155531126;2.7997216687844411;-0.54830820604855945;-1.8486758266001073];
LW2_1 = [-0.3907419037190546 0.12562173111182293 0.11914272433861703 -0.084110249159526682 -0.40866806265177102 -0.78643456066830775 0.079411565223545463 0.35950031379193853 2.292450785573934 -0.37030286538867518 -0.53967929508055157 -0.80159573618090929 -0.51427016078826204;-1.9104694667414814 -0.92342254871373097 -0.78090364174168581 1.5370192453900835 -0.88591588712348668 0.89451834950941111 0.118274991956797 -0.38043856234107404 0.75164058560037506 -3.7713415819893807 0.59573210689974321 -2.2192647621357069 1.426559300557023;-1.8237308427338659 1.4689245900931474 0.087377888635267922 0.044125077703825843 -1.3676322614746008 -0.94981414720743762 -0.53873621150098749 0.030831973033892107 -0.76922646298816644 1.486523845922362 -0.76103045209707421 0.023154382575060483 -0.13407694755818061;-0.89532753155588019 0.23981650043229102 -8.6848843334153116 2.2680521870812962 -4.4967276683201725 3.8329226567340418 13.783324089442548 -7.3704675910107103 0.23258396061572126 0.55331243490783499 3.930254930555773 -5.9831731476584045 -2.2481731266787044;-0.69135761356682979 0.074677200835497129 2.3038011317911691 0.0094056910321338866 -0.46039319368887782 -0.79966133962071206 0.12845674080381314 0.05115518006053546 2.145681428267145 -0.35665046391201255 0.51319751570939953 -0.78438227152061801 -0.53252500161923055;0.68040939542247558 -0.055874570733285112 -2.0737189395249049 -0.36688661075423301 0.3775826811270751 1.0515564140982994 -0.16992645331300144 -0.039615744774134959 -1.6142517114274122 0.34490263482882128 1.0922532233208779 0.73300111754009756 0.46145336237887002;-0.12863994751041075 -0.54847600934835739 -0.82446720815733165 0.60738097388537704 0.093593580307368668 1.4156217323234752 0.18332477231318378 0.023563356090043366 1.0835459396177656 -0.74366481754864755 0.03291361776062024 -0.70804505116656979 -0.87212116168132892;-0.91275853990822953 0.76811139675640749 -0.65860525709409368 -0.097920200558792456 0.32989046861353166 0.28208680224327398 -0.3025312525746649 -0.36665702124493393 -0.070762928362038457 -0.82759884979019127 1.3010159151814302 0.011915125068976675 -0.15311157682551155;0.91524281296892063 -0.29922282479964374 -0.33773342458619221 -0.9711364307184841 -0.7251086894973453 -0.80359357162809097 0.31354699662609775 0.58097210203965022 -1.1076124173160153 0.36415776440782244 0.1522132771996709 -0.53661182316302269 -0.221091945893024;-1.6621820407500989 2.8330574044000603 -2.0439805668809514 1.9867073231699208 -0.59421689420501822 0.76965145693213921 -0.16322612202070974 1.3645549699396973 0.98369094472051688 -0.43101733151756294 1.176493192848409 -0.70622222866508921 -0.28084255372288308;0.86917870029093713 2.0543763963526436 -1.2708019366604493 -2.847499853173959 0.17260184366546083 -1.7376048466553995 -0.038902693189861608 -0.6157637605887929 5.965736834803419 1.8065391684925838 -1.339186785525579 1.3057112212456681 1.0041769993887983;-0.33673492668831251 -0.096692669469695416 1.115246840029009 -0.81727303275498342 0.2654865374417173 -0.96159157202431367 0.6397230933463427 -0.095577027925075775 -2.8579322172231865 1.7960284242905471 -0.27572404086128005 -0.49356916955242136 0.53412419299739;-1.9039432932819749 -0.47525670247954993 -0.55709731147538211 0.96824165022385467 -0.86729765382529977 -0.20593223078835776 0.098608836321284615 -0.37930587507783331 4.3296688724240449 -3.4908799350399615 1.3743912809723167 -2.2512460979917637 -0.45169090841830684];

% Layer 3
b3 = 1.5449781718022546;
LW3_2 = [0.33280914931433508 2.1064287202297782 -0.076201745033026527 1.0121504688580607 -1.073137952401108 -1.1974014457337994 -0.16452219800313062 0.23305660512799861 0.12381405219159387 0.15724082188573194 -1.7338205722866029 -0.14594715359002902 -2.175465283006297];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
