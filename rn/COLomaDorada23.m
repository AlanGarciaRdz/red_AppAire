function [Y,Xf,Af] = COLomaDorada23(X,~,~)
%COLOMADORADA23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:41.
% 
% [Y] = COLomaDorada23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;17.6991150442478;0.00572573718866304;0.0175284837861525;0.0546448087431694];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.1356817158323615;-2.0854959735909291;2.4974658301838528;-0.72223727771787094;-2.5621299681133949;0.94751960111316968;-0.26012486836909177;-0.84190544182527538;0.45465582969760882;-0.91088258267826261;-1.2176278785989112;-3.0232556859580044;1.2804594866504559;1.6754434014288397;-3.7139981720336799];
IW1_1 = [2.0154518503998879 1.014072810606228 -0.077342282522173234 1.1770307517416945 -0.63800334925993174 -0.0015368587020379351 1.0501957849880208;0.20577884895144524 -2.2822929047970404 -0.22450985089576442 -0.18759145549193051 0.37053832764023065 0.62044459108196015 -0.75973361769868974;-0.38070063684964955 -1.7727117040528886 -0.14018776739946276 0.15492542155579059 -0.058689601057648165 -0.30427063000681059 -0.12171307687335105;-0.057366521408199346 1.7044613619931108 0.2377588978079157 -0.11439623081233219 0.067773041390909047 -0.21786208264376936 -0.63769341123800083;1.9656161475786034 0.35901518170927565 0.36193520471663343 -1.5956450270873166 0.55013053686191804 -0.86774888986995347 -1.0190903073885991;-0.74239977391675327 -0.17394537445898123 0.44509654559374456 0.24969894400586781 0.28790767694855679 -1.4849618780178517 -2.2484711821486236;-1.1419150221524261 0.36939973551095368 -0.60576841019631777 -1.0557854636140782 2.0284748452630907 -1.527794476916069 0.68094267077170434;1.5668853031063374 -0.050452933784366646 0.12070600410456045 1.0165998327361301 0.58234662831757078 0.76293038957800607 -1.8528007247330476;0.095024225457872466 -0.26979468916926952 0.2852942937013061 0.63442097620448124 0.28030794425044148 -1.3146457686503203 -1.5696214443207639;-1.8729099336898429 -0.15697840491328993 -0.2186623507843537 -0.72131701304277918 0.32755029498771437 -0.038586939243348793 0.38767537151339987;-1.2156690032143713 -0.1416583843067262 -0.71641375883353897 -1.0944048256876489 -1.7722144645626081 1.5077164957157649 0.50156280013352461;-5.8759559418861773 -0.29734127040422098 0.91062927585551157 1.6778752777675403 0.64134231358450089 -0.58562981935731095 -1.8464699883261877;-0.027620844520829552 4.6925529620341333 -0.048932247736311565 0.25990123844860019 -0.10071005115210414 0.38436378748281058 0.11444140001247735;1.5767692994514564 0.9963709540091612 -1.6550473866854181 -0.26546112290188723 -0.82474023608874369 0.26488586199285213 -1.259297445994682;-0.82556288180203186 -0.1599084516203618 -1.1443672975880721 -0.58601174598763084 -0.081276140904729288 0.9366749146318033 3.2498201176896626];

% Layer 2
b2 = [1.5154328590850561;1.4425862824306965;-0.97070124963682869;-0.42091282402324426;-0.82425773198878838;0.49452052086475923;-1.9851319440601618;0.11363587842478183;0.60445585249200262;1.6456370841611396;-1.9678477254473052;-1.8555496002715084;0.6288494971319587;-1.8825623509263318;-2.3395545738284178];
LW2_1 = [-0.17465566821599898 -0.16491512225045704 -0.1489860011669161 0.72714507448576648 -0.2096172513644548 0.016788201734175986 -0.13385310389392274 -0.51166456852539033 -0.63735387665874199 1.2376060673046629 0.24297970203334424 1.2922508468025729 -0.93732419685824875 -0.43468032629071224 -0.75021059987304184;0.33168695776649287 0.4477953580276921 -0.45234533060016002 0.16516738909295986 0.22580983245119413 1.0827658999863663 -0.66159700103591967 0.30945327974875608 -1.1143792514382571 -0.42089771181483809 1.1293424151017002 1.2464692858322417 1.0278829333326163 1.503511602286556 -0.61219939819411517;1.1732482877025323 0.29123868905657269 0.64657675155524275 -1.3546582522999115 1.0576812684061467 0.61003776360158768 0.83860745778569667 1.7795181779607865 0.94683017928458801 -0.043859088287725667 2.0843208036242786 0.48517530687123184 1.3864347572543667 -0.36280667828968965 -0.79856149470102411;0.60315562449128801 0.42241169118524818 0.60507666564602658 -0.041005566871714479 1.3661250120967554 -2.5530998043498485 -0.32381187056571764 -0.32903596400615548 2.8076477333819128 2.5319409995769036 0.29088100963687785 -1.2700326108697058 0.89845540091828624 -0.57994188952286496 -0.6612927626387799;0.13860784153453923 -0.53769491042831374 -0.083643112789729968 0.23142372458207561 0.38536133100091757 0.93339919600812815 -0.16746094766844008 0.25508888220640619 0.31376084212430111 -0.01934791499556783 0.31866620285409292 -0.055859329178808745 0.67648329092476212 0.32298743997483759 0.44135265669546092;-1.5680903169974387 1.1735185092754088 1.7196470270820443 -0.4180873048230338 -0.7530399700340723 -1.1976962942612339 0.97157515220188295 0.73018413222935785 -1.0948315607844465 0.050463372080023751 0.36228670118255196 0.12247949629881349 0.48578541011289994 0.33309588324607819 -0.42137903127677712;0.25696154924032616 0.9824869741260045 -0.51498310120210478 0.49235491737226911 -0.22504611724308651 1.8694983092153699 0.0187607967797595 -3.1279415358106286 0.82012123863299935 -0.4322694909891856 0.25237489219717374 -0.63886807788420674 0.21236057615085518 -0.21219292353375593 1.4790744181110789;0.12301640454253548 -0.87556840401499814 0.1776093157256321 -0.63107640327165559 -0.071931255288636586 -0.19917568981704659 -0.051373214601132595 0.66353248719240987 -0.29777185855454169 -0.78232611846176081 -1.0905260606113261 -0.54827215523409834 -0.9786813852477152 0.066991328857291421 0.47767709014389659;-0.020126979310447317 -0.64730933550867853 -0.96238666880966706 0.2322093770326405 0.14238663864955889 -1.044275573742288 0.024855727860326644 0.38012923052077618 0.12758092065115453 0.72046730037569062 0.062045992211368556 6.5980121983569284e-05 -1.2420868432478303 0.058977632164874692 -1.0146692054102406;0.47299211507800265 0.11775196310593197 -0.50408406644148507 -0.37685569139372771 0.78695807065928769 -0.27967411409174281 -0.46521669450283459 0.020776354461788389 1.1627218014268887 1.2610103699336608 0.85105635755448195 -0.82876133684923581 -0.73671376872466776 -0.5112208517454998 -0.84647623629825852;-0.70097502323194349 -0.66994697542017001 -0.03840465607992849 0.57410657002441756 -0.28494222632294691 -1.2748436666301948 0.20454454480652506 -0.28300143973431818 0.31478255213105288 0.16823364287650577 -0.076485862180451808 -0.2213489258015241 -0.95633300014458189 0.81748685338479454 -0.32685142569439107;0.10315353770793777 -0.12008021912748575 -0.29316873862840109 1.1538451397970477 0.10325160532791298 -0.1556405739614721 0.051910926221752834 0.58911099006641454 -0.75756640152372201 -0.19343076429250261 -0.029737300047494478 0.56566728420475687 0.23376788315027355 0.96705251406938697 -0.37919676419744403;-0.28644436878285101 -1.0368977159817134 0.28390597380323257 0.3392974711995041 0.016686354450260302 -0.61732268768465537 -0.3327282083238442 1.0042729375034187 -1.0250263716055221 -0.39317871193395637 0.51526545640425869 0.53360561138895668 0.56834585332081122 0.077134768797545758 -1.1361623735432955;-0.30217743008369369 0.81761873913915328 -1.3762990842297678 -0.21319714504548604 -0.47444582092651783 1.2004920515699031 -0.22717986126760911 -1.092799346997765 0.071593441731444996 -0.90072135987943236 0.3266266166417498 -0.64818298781564199 1.4943266567997078 0.77036260294458359 0.7063257226268852;0.37733816180847107 -1.9444597726643513 0.11641514366716778 -0.81843153726388773 -0.052349280430230051 -0.30603165313873198 1.0567877519844961 1.889221390574793 0.51967016362590568 -0.64828413247263439 1.481628373134505 0.40913580063925031 0.51861258492912288 -0.49151831463943052 -0.86980525278229492];

% Layer 3
b3 = -0.41242277767947177;
LW3_2 = [-0.92851801582203364 -0.71426724507287465 0.6966783213068215 -1.0506425849080274 -1.6311486291675592 -0.49566387074655771 0.92253085790168066 -0.74960452997287763 -2.2928571211198787 1.1721393332054539 1.0344336003774308 1.8065466384199369 1.0927223879337578 -1.3204354714703863 -0.78815619605328069];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
