function [Y,Xf,Af] = COLasPintas2(X,~,~)
%COLASPINTAS2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:58.
% 
% [Y] = COLasPintas2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.241545893719807;14.7058823529412;0.0179856115107914;0.0558659217877095;0.00576368876080692;0.212765957446809];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.2960971534009618;-3.9343196783935466;1.3819499066415497;-0.79121051545003662;-1.9497533305235355;3.0447435019684916;0.4246068547680184;0.72240269112712341;-1.257300677442899;0.45849135445053113;1.0628357112729589;-1.0999499225212479;2.3719331145643836;-0.93829135118497853];
IW1_1 = [-1.1649045894040604 0.069263510896013736 2.3136372054580412 -0.01262024249807926 0.53883950008515946 0.42711083584248788 -0.081822560123881671 -0.1439279035507505;0.15722637684776941 -5.778688197007666 1.6414777055351877 -2.4663849352136182 -0.41008414823311223 -0.20320258442818886 -0.12905812693273702 0.11142349715281434;-0.18013131047303282 -2.4532399494540025 -0.01622707995287544 1.0985685732968677 0.54831285504901528 2.032415596963344 0.016627508749842361 0.50489160792149268;1.1481599201377433 2.7306695393180487 2.376954637804062 1.3747875713887214 0.22416750353410941 3.6784225922389773 -2.0698880369510313 0.12527689949460957;2.862458472273619 -0.71368411580342828 -2.3504306045865659 0.36397863458217539 0.36320704773526141 0.48170933980501923 0.32430214298525617 -0.61524451732718621;8.9726497585032359 0.5995539454553761 -0.044067635546161707 -1.3310370970739465 -0.23652696809199064 -1.9408684863024184 0.16893256949644578 -1.0666014585425418;-0.42569364145245092 -1.3416086630510602 -0.64342611842734787 1.0137148275707282 0.12537517087494057 0.7726110524917561 0.032393549607770161 0.28640325864245858;0.77096709916518336 0.050402148686339854 1.3510433092149454 -0.19712087804049311 1.5909586419756794 1.439851040009785 0.077610017473868725 -0.14018405453976113;0.97061594099864001 0.33820694495645298 -1.3063987473607446 -0.20762663098882361 -1.1256355375875278 -0.40148385853665391 0.15446318035753417 0.10436450117073492;-1.9444434820238445 0.87095596799938757 0.11662483991319242 -0.42683841252343929 -0.99056264978797426 -1.4507625453941193 0.10748851167096998 -0.3169383650996459;0.18863874395283228 0.14806889603447765 -0.69514892806163564 0.37781150450502077 -0.16131436253579873 1.0595953749007363 0.005580489929360115 0.88112961418513625;0.09175102135814138 0.59363856680154914 0.75823471587824143 -0.72837724016272243 -0.25614249753772272 0.65800180125408192 -0.75338759049972159 0.62122719096475898;2.3553681514473079 -2.3511803814343963 0.62764773984773059 1.2885103777322073 1.2661248160187142 1.2307237487284601 -0.025921371281980216 -0.046985598892054212;0.43877784134536085 1.2544743416640534 0.40495963390133882 -0.096017122205225305 -0.94060675949730599 0.16554785825524468 0.2494360401580322 0.17169450515780399];

% Layer 2
b2 = [1.6189494383025391;-3.7955530785713885;-0.41934049986129646;-0.16370552469406768;0.34001804638631489;-2.9680284730537947;-3.1829608511973579;1.3399152877586715;1.1384573613859392;1.2724668585995933;-5.3020999042183643;1.0258968857470634;-1.5682974501595106;-5.4310351537048556];
LW2_1 = [-1.1736557773830629 0.43804656000649578 0.27649963005150491 -0.016488162115551964 -0.66379852229010783 -0.39149175412945159 0.59828261980470354 -0.6310895633844259 -1.0418458563152608 -0.57358054598129504 0.21382079275414972 1.416825629258547 0.33861285958060605 0.67190346044514282;-4.8506435316851686 -1.0624800203828331 -3.035552478941776 2.5509496017390263 -0.27237335405531837 -1.9692276849270016 0.086393069804375583 -0.64127124357373821 -0.55150611076281764 3.5124116580652074 -0.93212966562532884 -0.81943578476577672 1.5941106149006139 2.9228205012627257;2.5586473177814448 -1.0170907864292738 -0.01019064648036028 -1.2384247357840219 -2.381328363768731 0.96547112011625558 -0.17666005968182419 0.42888387428236513 3.1224570226591859 0.4604348768909442 1.0912419449570532 1.6513377947220631 3.2831351820260628 0.95711168983696016;-1.0380383575758765 -1.1189546384915368 -1.0859727824627394 0.092806465443423719 -0.23625069834231188 -0.43359930382228673 -1.6189319422766522 -0.81950522759586375 -0.28149565755367023 -3.9643397498946897 -2.5045644622011243 0.4038476396398486 -1.0077508667458093 1.1358723670024793;-0.58059946417973518 -1.0403696999780596 1.5109424793006021 -1.5118439579700962 -3.8615578433708815 6.2677648854132686 -2.2724975432855312 0.41427512620614543 2.1692992183791699 3.7784225301428629 2.5431946126217153 0.37360994332647723 3.5602379312729759 1.0825909736049784;-1.1366177989755963 1.8329029297322699 0.79612456914760321 0.91394383342904217 -1.5518061741355784 -0.28444268160875991 -3.9485950467801687 0.091214223867622513 -0.24343914472412673 -0.87244365264672463 2.7130975766388477 -4.1790322504205948 -0.012472854080776336 1.8662477581346284;-1.5012903754094014 0.98026531358023283 -1.137452315037327 0.40753757056738837 3.5388035191133351 -1.6145150234833774 0.38262424651557436 0.38743663867371453 -2.331385376088527 -0.027026040672789652 -0.86850549553904755 0.65978520686678166 4.4457692152687276 1.3859824284266133;2.1516695994508517 0.58972859352456375 -1.0776574028281563 -0.18162043418368479 0.50800892752163973 -0.20240212064932517 -0.056395658886350855 -0.06937138105373987 0.98928987793684597 -0.72653605207544325 0.90084754990058125 0.47220262880848729 -0.29005208394251547 -0.37243958704091762;1.0466083805776574 0.42798667888835351 -1.873459181276806 -0.38802755754661727 2.7367822957327168 -1.142210217180416 1.2521229593163712 0.014315966365478119 -0.80821619789219279 1.9037948165454208 -0.95588676765839431 -0.11980868509012899 -0.53279673455971888 -0.1240889318180978;-0.61094797472360229 1.4787824969308918 -0.0074390156084496104 -0.34192592022311596 0.45242322844413418 0.048157177053979039 1.8182291123330852 0.31970222909422996 -0.19890207532865772 0.40315201303745568 -0.36878403559132217 1.2943901893122398 -0.21327956513889892 -0.48665094264887615;1.3854583006593675 -1.8296375958498527 2.8235591840673955 0.032183591244733994 1.4476684907486228 -0.76786424104519613 -4.9214236836673333 -3.8457886925670626 -2.0912698896062403 -1.4300189708741886 4.8055818639588113 -1.3099832604997397 -1.0683439831729209 0.37027462413695245;-0.47385578745631796 1.2697716128391046 -0.079510928632394839 -0.26757966454087589 0.31823610865217566 0.031040492066810185 1.5050300337340958 0.32699271528283697 -0.12110810118523807 0.24435624610472687 -0.1323849697568574 1.0054754805466368 -0.20456943599131328 -0.32487550979350349;0.92317511498665883 -0.4176585924461278 0.11825279479759175 0.10889923361317826 0.51227891101760048 0.45366375566064254 -1.1341802467050406 0.32544869677981281 0.77874668318291862 0.27646169085031647 -0.62992323289177399 -2.3913988531731083 -0.2158665596402945 -0.13866514986543821;-2.4249582114461412 3.0864382954942116 -2.2042307773657761 0.026132603181076464 1.3778492944838756 3.9665043981623316 2.5491268038330235 -0.12324081292049054 -0.983774824423572 1.5040078587871684 -0.33240180041807993 -0.81173784024792328 -3.3504196862326694 0.53181352330368714];

% Layer 3
b3 = -0.76528963569964548;
LW3_2 = [0.75189559789860416 0.22179976707330273 0.49544621101524849 -0.34288881593667642 -0.50006990980812205 -0.19817801169236798 0.44547182215975495 0.87468457537467681 -0.082013219373253801 2.2350412573242551 -0.16088629057996465 -2.6329010083557991 0.64795389704917072 0.51859737965045993];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
