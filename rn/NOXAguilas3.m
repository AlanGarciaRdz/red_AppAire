function [Y,Xf,Af] = NOXAguilas3(X,~,~)
%NOXAGUILAS3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:11.
% 
% [Y] = NOXAguilas3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.0669660302883015;2.6760414961625814;2.5526542315986891;0.33736315815002638;0.10468908765832466;0.87600639035278305;0.41937213474006285;-1.7191058794582341;1.5774523227627628;1.1850853220445952;-1.4730912893327055;-1.3484238898743846;1.3030002040702153];
IW1_1 = [-0.18599780664010421 -1.336943093102505 -0.24635674539795635 -2.3867179002687231 0.029567324727694598 0.52929156992655146 -0.20964410296186869 -0.053613833582667615 -0.23108327899019365 -0.15875960976474077 -0.5085857607649229 -1.1050003975417566;1.6179126021177879 3.5782481553573442 2.8135491914044883 -0.50107851832274075 -0.037650146887861495 -3.0308996579028715 0.35602193407212174 1.1464672301230898 0.31649923758659848 1.0474813316658769 0.17744221812835187 -1.5051466860612637;0.047246802468562527 5.4897314067571088 -1.074126094098599 0.5157232753843658 0.037826331510080045 -0.26310078059561687 -0.31326812440130669 -0.19718850666754298 -0.10723985461477059 0.066369958392205081 -0.21162356984778813 0.029782378709094656;-0.91403510876576455 -0.18877685282496542 0.49257493559264587 -0.59115297279805856 0.0029369582069217609 -0.41707467210485627 0.12146787844950391 -0.15342797459822624 0.027567359394763031 -0.027755082992538281 0.49322074813732947 -0.14771451170605909;-0.054892598253263022 3.1003487387628059 -0.088779764825969998 -0.082353833321863718 0.13812190366975075 -0.14355251083042841 0.22907341194700534 -0.33184163919552079 -0.070374243641091044 0.01996706097464054 0.091685536579467736 -0.63621003452530589;0.27849125635481725 -0.38988391990985033 2.2271973912452729 -2.6282722736213819 0.38697357653371717 -0.5273452426233548 -0.09399344781014092 1.4137668337832894 0.027926159814237801 0.10935688419179564 -0.17001044347109104 1.1046614599164497;0.91287723416018252 0.46943258886901057 -1.8061406526582959 1.6401802497692359 1.2117331914686136 2.0939775262925302 -1.4533967882856715 -1.1921677908920532 -0.56792663546351119 -1.2280089529379818 -0.54719135146552544 1.0119596082359659;1.4591249130907666 -0.19229976919392652 0.15667838129742725 -0.25010546815121054 0.86653598977534863 0.01347045627835658 -0.04892107761435889 0.22687764535106941 0.056997025335767539 -0.28500677838781019 -0.029493603449693498 0.14503687416489719;-2.6306142113499176 -0.20540767802647872 1.5084143243847292 -0.27616254038691723 0.48596998272292152 -2.3070065533520374 0.46288248840763763 -3.3803834949780063 0.91016713436724783 -0.79594547804858617 -0.67680769942552454 -1.0952803914129059;-0.19241764489490429 -0.64383189187889611 -0.77415174499518002 1.5860042221519715 0.26524236296621106 1.3717245685497803 -0.61373455749078198 0.49968610023245363 -0.21520558716692864 0.16817103370461278 -0.71879718256687086 -0.8033612022858021;-1.00934614520813 0.63663015250019317 0.038511343010933001 -0.86449097207662595 -0.0013080230945414582 0.025266878521242649 -0.12775007219204237 -0.055546336732499729 -0.13932684955452654 -0.23790793561609447 0.088276237009627778 -0.67396786341273685;-0.37596079247315145 -0.949141285277877 0.23972687097213236 0.21502925361898534 -0.22039202201438335 0.80227434440646928 -0.070538258638638857 -0.6368018913868807 -0.14334110412366138 -0.53460986914746733 0.14984866076509248 -0.8143457774702304;-0.20839479801381211 -1.0162430106219569 0.48483180312342899 -0.58626440976165994 0.11395194153670289 -0.69487850250927852 -0.32303116234429707 0.22710416228203656 -0.4570804236521579 -0.5663396045758714 -0.84639177788549591 1.719867906872762];

% Layer 2
b2 = [3.1367803826516121;0.52355737190489438;1.5671281985434704;-1.2938334372522979;0.89159190595906868;0.84278604112670119;2.532620310124241;0.98008937707900823;-0.51775742770595001;1.2508883017718682;-0.20653586378542665;-2.580361975597731;1.8422235679317054];
LW2_1 = [-0.37505125588464233 -0.79746211853129401 1.806525851951577 0.058671828774998845 1.3391331938331583 0.8194313520851092 1.4237016139931415 -1.246263398563803 1.3225673049998268 -0.57947947541010758 -5.1073669165338309 2.1480109547136497 -1.0492171855615355;-0.35618067898488404 0.25595882980402074 0.67388462826934781 0.85583051891216588 0.2491901607183705 -0.98911636483284371 1.4835022713995338 -0.58074425013471331 0.76870115307030784 0.59749120977710901 -0.95828170035417204 0.45862464894415789 -0.18192454015261897;0.27725743815257969 0.4609209985456505 1.1808227626390186 -0.90403365191375928 0.67535009196687656 0.078322427187046184 1.432204284117514 -0.14243774778675133 0.70773226730087391 0.02619671366146404 2.0541623412706116 -0.88704471601500801 1.1083600950718879;2.8129007253552736 -0.82528310377326297 1.5784859481618898 -0.24698529162926025 -2.6458094513843546 1.8159943871231148 -0.33137945574696054 3.0478550592998221 -0.37579879151548101 -2.089024434051344 0.66221629812167238 -1.2780650216558098 0.071442068324134758;-0.89227283929341017 0.89317096751595215 -1.3818084935003776 -1.8841565535984632 -0.99149381807942993 1.0750625623101771 -0.18514399224823427 1.2915828126528239 -1.0580356533041588 -1.1042191012210454 0.35145046735107555 -0.69162508079018781 -1.4206778043025334;-1.0660905061512842 -1.0179169212447101 -1.7016119322300214 0.88022270873216779 0.80762907537745576 -0.89505755433865852 1.0007673875415273 -1.4046997377568926 -0.21264555432011772 0.54238545552505868 -0.96576072646958067 -0.28572324265308846 0.60974445999125948;0.1676653014673781 -0.96674928765527723 -1.8187775889024824 1.1090826969914629 5.9571002739081393 0.6193801100776104 1.621865532732045 -0.59790585445299993 2.4041725487004806 0.36100488102508005 -1.3141077489321131 -1.3144327908226416 1.3796837787392504;-0.41946295167998005 -0.44403052587911285 -1.6672831271648976 -1.937776390822066 -0.581229116070487 -1.3995668719654222 1.141017366698484 -0.48295061228815039 -0.30100802336421001 -2.0727923319629076 1.3405526887504555 -1.6702937674768636 1.5426086967932393;0.19677260493328033 -0.53368814306939527 -1.5631017128419058 -1.9359336369355435 0.17684482072439611 -1.5176742935409502 0.38884558578701695 -1.8393836814017748 -0.32925857921320378 -1.0293591991808948 1.0870300615984814 -1.138280314435959 1.2420385049153075;-1.4267955419646392 -1.6363170849852195 -1.9954265271821223 0.74777857863090247 0.80724960164174564 -0.8875115099146762 1.0448743594132728 -1.5830546159161134 -0.59708831857839717 0.52176005915300194 -0.68449699203826264 -0.68868813948627106 0.92171484265796655;0.17959395072121265 -0.2959973718736546 -0.18793382644805379 -1.0533123838087735 -0.54702724553898885 0.87960742909328216 -1.1618061640877264 0.58601540221580839 -0.79306102544107637 -0.54040184806269242 1.2247858673406953 -0.61494634083204935 0.32691620128275806;-1.4025402867068588 0.11864915025063633 -0.82700764778661706 -0.13655849860504654 4.2014195885443595 0.18470866779564488 -0.28224662717756394 0.87551932240395947 -0.42823397360820092 -0.21186254210681327 -0.061219174617841238 2.1153868211708859 -0.29765352360287184;0.82111305727596473 0.14886029357138347 1.0946491213908329 -0.71398103300296523 1.6039456690627816 0.51531830644393051 1.134501509026395 0.38493184613547532 0.82996853036074347 -0.13050099348818381 0.30437856124551621 -0.034190792080686469 1.4836459463449547];

% Layer 3
b3 = 2.9076570415735166;
LW3_2 = [-0.13670720687397028 1.2254065400869711 -0.46521956020062 -0.60280255592692822 -0.13641587229103216 2.2546321353188996 -4.0113949452188127 0.25388277066418524 -0.38783076396659505 -1.6608140370449669 1.3901241058471521 0.71066216485632927 0.33731220690489566];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
