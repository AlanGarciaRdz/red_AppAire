function [Y,Xf,Af] = O3laspintas15(X,~,~)
%O3LASPINTAS15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:48.
% 
% [Y] = O3laspintas15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.241545893719807;4.5045045045045;0.00280033604032484;95.2380952380952;0.212765957446809;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-3.2755161638067651;-0.70826910256618714;0.99022148262257681;1.7875772937602976;2.1856666080778062;-1.7761442695568015;1.8696234237019209;-0.13640307844413832;-1.4064984480674316;0.53342706714262955;3.5041276149773175;6.2881054986562361;1.8578434169776283];
  IW1_1 = [-0.36571846729621055 1.6628733707145831 -0.67538204827846748 -0.42222400555188 -1.5204877603591889 -0.1372899275860732 -1.2661719253415069 -0.50084304480965613;0.67104701039757519 -1.710828113683263 -0.041964555021869618 0.59366675535288649 -0.12481222552023011 0.91603694018409887 0.86283515407335931 -1.04840312802762;1.1325450102133368 1.850275796366974 0.37211515371979714 0.168124357598254 -0.60134210783638797 0.46448014098120149 0.31668763048797072 0.32296258318114845;-2.526078587249986 -0.029816470387273326 0.10263725164512992 -0.24466780202614308 -0.16540139616347621 0.074184438601652539 -0.045229685250623375 -0.15706412436917064;-0.79878653527921195 2.2698748512609837 1.4370757179756166 -0.45063476866202634 -0.58936942727350616 -0.20325530550685464 0.46775886549393658 1.1399829536108379;-0.26104897168029034 -2.1900999973730215 -0.045397758064012264 0.067060047574778431 0.23760075360773794 -0.31781009421814571 -0.18447498853057437 0.7437306830181617;-2.1811366814405089 0.010972396210348716 -1.3474560717072102 -0.35736108535506539 1.8457978875843735 -1.801076644180539 0.31596979023502481 0.28642614626245549;-0.80733055285687905 0.44849227897094429 0.61786101043288499 0.16695896975308461 0.91242722217621253 -0.39756206459574994 -0.55377881238730764 0.48118689354164229;0.17472484956878243 0.91868201988573317 0.60982486589106522 1.3763926052619515 1.3302672422019111 -0.66401764113402795 -0.1930761758869273 -2.3894715181899548;-0.11705532861071098 2.2111279643952222 0.19022384693149647 -0.36238169247050778 0.75629772793541561 0.028687687204838296 -1.2896229635678691 0.8036345890679415;4.1268535139556359 0.16554820395180908 0.57669678462757146 -0.39867222847416361 -0.59059650543073638 0.094923192330598247 0.74286625113885063 -0.14453935628651854;3.4354415436461392 2.574769129040209 1.0095079350906118 -1.2449112375060754 0.21839352550116503 1.9658534236552978 1.1529631057719067 -1.9471704133623133;0.27730175891372999 0.70492764186502577 -0.48783878408541437 1.3418777315469417 -0.94541514862639275 0.58157739981174994 1.4458053762564227 -0.073794945035449117];
  
  % Layer 2
  b2 = [-6.2434828891420437;0.14469637404515071;-0.96874462110377857;2.2071213359644815;0.17980473952050063;-0.088470088738775335;-0.40288173995897547;-0.95446959684597066;2.4759812212502799;-0.28620430860296298;0.6106325864449339;-0.96896257889190252;-1.9895300335824053];
  LW2_1 = [0.86637676243914052 -1.5693159481309973 -0.29717286085093197 -1.2949229204067896 0.84347083977706183 -1.1623755542086058 1.0382098697903248 -2.0405792608409503 -0.17402472132760746 -0.73240105365131924 -0.64310874385434791 0.21238483036236669 -0.84513055498720091;1.3374141111614657 1.0748021922547444 0.54413343158401217 -0.96351581726958657 0.65208445345814814 -0.5246164520090365 0.86500575147245407 -0.5850155800615876 0.53410508363844844 -0.75945302273983695 1.1700774270318806 -1.1392566940164335 -0.73939334564343562;0.80841933681758904 0.40111855593113127 0.83873946005170052 0.17454994686786712 1.5745794070236134 0.35326324517815083 1.0652718556026153 -1.0935616547507936 0.23322827500171453 -1.9120348573623309 1.2145772906176693 -1.5898270353652748 -0.55123817203367886;-0.86145563818696025 1.4584723126879133 -1.145503729869602 1.8331799683405026 0.83753889129415238 -0.27962410504336738 -0.59532472657805513 -1.6233555301066651 0.87398718024901056 -0.31417694831867415 0.30213554698106793 -1.2761155422936179 -0.28148875477404273;-0.94042849594199351 -1.393563350145226 -0.5064779310204105 1.7498468686436086 1.8690694852500189 0.91907596506945288 -0.60874012765172092 -0.041289919936416022 -0.2777554154318897 -1.9208873339605588 -0.35935745054911794 -0.56049167982837877 0.60253960379890925;-2.2938445411383173 -1.6011727702131682 -0.80022669084286735 0.57590574838125197 -1.7105699207100444 -2.4767950210172365 -0.52462033127830809 0.32820953745082126 -0.093260230448394252 1.6781834340105681 0.55422862507016413 -0.70641623938052045 0.76829573924890371;0.64969081686285179 0.11635707943146013 1.0342944115834227 -1.2940333313249959 -1.4122594696566717 0.51988791486003882 0.55194132117414541 1.4696267155952585 -0.65559221010903568 0.9809476124661457 1.356320182290071 -0.48113334746668407 0.26512282054925906;0.78289854046015772 0.67549957026844221 1.1039329971928553 -0.8209422863056568 0.065979858467608024 0.42007506520672783 0.30846845599869133 -0.44538244687919859 0.40269365493405124 -0.59831031172232085 2.2281304504182469 -0.44267923513465879 -0.56660667559508948;1.7899538549804712 -0.0029050643530451441 -1.4338251248311231 1.159241417562803 0.517957478460773 -1.0196167367467359 -0.22734312289811859 -0.41858604655834625 -0.116886692666731 0.68504606997355455 1.7142806495823344 -2.110694360311387 0.44891878699171345;0.073876427266844819 0.20847374547757622 -1.3513711236396566 2.1688992214050948 0.62766063848773879 0.32290750576014071 -0.559400044492666 0.08481708561549034 -0.22240090953604325 0.44306922429477497 1.1162732750756392 -1.9146133328182104 0.32348625239466294;1.7433684725504692 -0.99275053565352367 -1.038395254190378 -0.94607884885324134 1.7181845394145916 -1.5287704702879934 1.0542392357630719 -1.9843037839838413 0.76876838453822383 0.60130260588321116 -0.13471691958343734 1.1972663808217479 0.055731724410081243;-0.67931865256539326 0.20784403011832173 -0.48655582159082678 1.4390585488762269 -0.63932452017906416 0.82598621889064661 -1.3012044778772154 -1.4030817539476119 0.59178676660515261 1.1619246990347141 -2.3135140896973532 3.343693612665839 -0.13795325900438365;-1.2926042629014198 -1.1599940251171235 0.14729649540572209 0.5123187121674615 -1.3671720966440561 -0.88045897321861921 -1.2622087803105606 0.20565944328579763 0.092274084056522515 0.63024458465019184 2.3428477451112877 0.045113513924298521 0.46590774806554414];
  
  % Layer 3
  b3 = -0.45247967330900984;
  LW3_2 = [2.052765986634538 -1.0104567410400991 -0.42728833737091698 -0.7107534686662722 -0.24508189935533037 2.4928698179701061 -1.2124957950722053 1.4297357052941815 -0.72019794028700124 0.59801283325221055 0.27200488860262062 -0.63791058614270646 -0.48067370861329195];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
