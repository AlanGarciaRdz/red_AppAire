function [Y,Xf,Af] = NOXLasPintas20(X,~,~)
%NOXLASPINTAS20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:49.
% 
% [Y] = NOXLasPintas20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.96825396825397;18.6915887850467;0.0175284837861525;0.0546448087431694;0.00640204865556978;0.138888888888889];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.7225186705276068;1.5184021217175208;1.8449100359366613;1.0791654656702685;0.48698467923953348;-1.289519319946788;0.23998994235338611;0.13423233446336388;-1.1978869006865984;-2.0647232196811345;0.014309922806801817;1.2157238003390793;2.4087905132547101;1.1345922721019346;-2.5863683929596926];
IW1_1 = [-1.6335941889730632 1.5808707871480188 0.55999913447657934 -0.27595520296636639 0.3408475788138266 1.5055484847300327 0.21266714007097498 -0.94564860972391418;-0.77247565474746205 0.41940619208778468 -1.3425792115409931 0.25802898173633204 -0.24906893207769465 -0.32871559681394946 -0.76664114740753164 -0.61603534514694613;-0.93301513862747643 1.7456860278343658 -0.3981765768968818 -0.1245155874532021 0.059500896946814784 0.52568741692661913 -0.91906544232765564 0.93897513135901889;-0.89899875711128108 -0.56371449784040706 0.34283768686516286 1.0465460981912158 0.14226821605492948 -0.76864744528552598 0.46928998481586359 0.080026663993450403;0.21763362511382342 3.5594508997251633 0.23114177061645891 0.16066061438238802 0.20898386089510812 -0.2778837725198457 0.33546274856138547 -0.020299068751119063;0.090534116620425736 0.57848135001725409 1.349455141429875 0.99482713883927731 0.24509136070443066 0.043765545259978646 0.76655027930756092 0.74426288729584955;-1.0998759220010754 0.74421334397580918 0.30048836906112986 1.3739960972131766 -0.42727919490234967 -1.6040302595600491 0.74939844930341692 0.051212976591880441;0.35819906221938397 -0.14594703012782526 0.3996576029506077 -0.35999193284863829 1.5683061586412004 2.5858535886222733 -0.05455984309265674 -0.30597876893616921;0.10259425637130591 -0.98287091742701715 -0.052609552967446328 -0.37229506735053497 -0.86270858402573514 -1.4036221024319782 1.0327912663280479 -1.059498864571419;-1.4695912512186955 0.47425895813814922 0.36607467807411503 0.093304741685604764 -1.3204404045195151 -1.8242094505344277 0.70173811989135926 0.18834207519589161;-1.0325072870662557 0.8833933479934436 -0.77504811150920283 -1.1637337385188047 1.7908782977338411 0.209416828109417 -0.59658061478301483 0.65472737896533684;-0.36730751613819312 -1.7472064768487932 -0.33328164200260946 -0.41108245526014636 0.28783300726439509 1.7810671774112252 -1.1145669259413147 -0.098313755208401771;-0.62613771525816853 0.87147936053714181 -0.82404352447044626 0.14302140285425807 0.99747406461187238 0.37725488037559624 0.56499710847813489 0.23789919575489604;0.93190717061227546 -1.5982795213443246 -0.58271947568062143 0.17955528102651008 1.6417466335747766 2.3117385201550489 1.6251612560953927 -0.29171575359655233;-0.96198487774621821 2.3562176146027678 -0.47488763853141325 -0.44500654432555387 -0.66435979370629106 0.56971143620556752 -0.52524633857961012 -0.23283416435813103];

% Layer 2
b2 = [1.419884062282595;1.7755746435723938;1.2844028963970979;-1.0214696690951868;0.97684674981081976;-0.9170582249439595;1.0340745098750497;-0.065073379541769227;0.36812016686447485;0.48494781341774734;-1.0263533010875294;-0.43042828835364394;0.93571070854119265;1.7867905103544197;1.5526866020932875];
LW2_1 = [0.4976845804311269 0.076129391332330862 0.46000236626738927 0.0025838083059252365 1.4902126346925577 0.35242963377902542 0.15416320653417245 -0.15749573054560498 0.930094175638423 -0.23249766517389173 -0.21734395481557317 -0.62996116695234039 1.3789031146997481 0.80992301439127612 -0.34097507591413456;-0.44779206577198338 0.61446335193898738 -1.0168784499043393 0.25489871538110281 -0.64958742059217855 0.22434533422388922 -0.42197071718434082 0.49636532902850999 0.46950015978125265 0.48204507467518043 -0.20833464955524486 -0.34536181881785272 -0.013710488172560181 -0.37045484818890306 -1.0135690221218805;-0.27793757927838647 -0.10343856652874205 -0.70407148657499918 -1.00026665160174 -0.44723904180656943 -0.42393901511846954 -0.047514301250232566 -0.51233266105390407 -0.53538126733458635 0.58541718380524665 -0.44045342438372342 0.59237796942349785 0.56163126118533169 0.50719683261580484 0.7299057543419003;0.19020425312976388 0.055995991586544322 0.46782171631094743 -0.081806057542031588 -0.76743227178858087 0.68430388082257565 0.14004490977132694 0.21582922701684759 -0.73226199004391668 -0.53772958648052149 -0.17343205356543603 -0.89419871045083577 -0.41461574188796241 -0.80026051682616839 0.64523039529707338;-0.71488097356278557 0.446900717874683 0.29957108941845312 0.62970408313637616 -1.3390773779754825 -0.22283241793686262 0.33749855779053023 0.49646356747819764 -0.05499892208046727 0.20711082072307771 -0.21177233887541302 -1.6644301619003314 0.42664355541002713 -0.87303049087082218 0.38839456721536242;-0.20935323510353687 0.39913780521672121 0.66905125142540089 0.83648535765967424 0.14395124471316523 -0.092852552515055004 -0.73541474366357129 0.99049370648600121 0.25070706311974872 -0.18919703844323799 -0.81940759342230496 -0.83907475653512931 0.20463905909570354 -1.0755671285654109 -0.7728625550309548;-0.8634139412248093 0.10361931913405886 1.0997101946014034 -0.064193945500626182 -0.55480492537846748 -1.1804694362349153 0.091059375675926313 0.81407653563774929 -0.13173430467234706 -0.10562638878913305 -0.68641880545583256 -0.74915743378134847 0.94574118092739834 -0.85464551386222765 0.90773015320403372;-0.32745858108581011 0.27280872360476005 -0.50091268147045398 -1.3867844016608615 -0.56953645134084108 0.19993461195108589 0.30170487195220619 0.75829272498822942 -0.23852157898613652 -0.36010357368595725 0.031459114086175813 -1.0192948791594798 -0.26201952340765644 -0.49143725333831334 -1.1243580438923517;1.3370002565085777 0.079505774810630508 -0.27299103654476986 -0.33845989058515441 -1.6514788748014149 0.18685689024010335 0.95899891030453066 0.34563590021208707 0.64238125635403043 -0.79033199718995018 -0.15966731586391289 -0.073478872058987274 -0.67406583528777508 -0.61884423172412584 -0.71988066368826265;0.57590318630282811 0.64822315856097801 -0.71888969272539915 -1.095646986577459 0.87955929563598023 0.20513603320038384 0.63789020360917126 -0.80397684832333804 0.31430329747983576 0.46314107754473127 0.82985372684964265 0.1112817239598959 -0.27046725835534552 1.3739655890792333 -0.18095743206442796;0.2422550482069406 0.29730891148731953 1.4218148985676844 0.15746507763150697 0.10462248655743392 0.18091039768657816 0.23080499910806457 1.1816714283175571 0.10981075582952751 -0.48465050946302252 -0.75696365809142796 -0.81637604807482489 -0.68660686296195594 -1.0072789063262462 -1.057226642252783;1.0767378662277056 0.33454954486733812 -1.2611829875160667 -0.51068815969704884 -1.7919931663539685 -0.7044817263379255 1.3222255984750888 0.40198051742269331 -0.14692035997245162 0.18657217141500007 0.039641294217423281 -1.1062071612745603 1.5041858524411078 -0.69182379929114357 -0.58188637692085254;0.38245212527962685 0.30595413790630871 0.030309357326088027 0.88652723219446528 -0.16517502745522464 -0.08137432151083214 -0.70702437574701982 0.056607023107353632 -0.34698694193110852 -0.73402782477908957 -0.14105640010389983 0.30592253604940478 0.18333151672073483 0.49834714864876367 -0.45103804980787227;-0.41280365444774886 0.12138991882590033 -0.08335305906896677 -0.8339880201646962 -0.19676148448071784 0.32032146785254817 -0.27177601911427202 -0.89707227241896959 -0.8644496350112576 0.63090928159167114 -0.21246553847202396 0.1428548911651486 -0.21475373857342722 0.71216972276314772 0.56047870895487539;0.17010503894564749 0.39255476699417452 0.74873945554122956 1.5040463634839303 -0.47339135256400744 0.13594891734892733 -0.54253706450994865 0.1968639317089835 -0.43509255640147809 0.42770113855998587 0.25131074534475878 -0.023513406189899718 -0.44570773782995277 0.63682150528477999 0.53149768214109006];

% Layer 3
b3 = 0.078550244244253623;
LW3_2 = [1.3911790544307712 -1.1292511359286679 -1.2338090949119767 0.91554933895513424 1.1156180001557874 1.4907166197587813 -1.5408628015590393 0.57732372768642415 2.0739091231196065 0.78489286165613148 -0.82111603266640665 -1.5707229633465178 -0.45959318140197764 1.3688465571708226 1.3106771598775953];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
