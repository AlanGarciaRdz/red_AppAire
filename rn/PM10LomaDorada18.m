function [Y,Xf,Af] = PM10LomaDorada18(X,~,~)
%PM10LOMADORADA18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:13.
% 
% [Y] = PM10LomaDorada18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.5339406996461227;3.2446219731343406;-1.3745731410682587;1.2092711218801191;-0.32402698809043323;-0.65423444281031695;-3.4044769150530767;-1.2413892371075808;1.9008729461984115;2.7104061304293667;-6.034361521295291;5.1398673361014247;-3.1280752165954109];
IW1_1 = [-0.2814160418872263 2.554300568513717 2.7638824102414885 -4.1090950909219472 3.0126917072543002 0.34396179731650894 2.226645249432027;-0.2353417621209338 -0.058447630737821041 -1.8517785238676676 5.1483809821917816 1.4942668191801951 2.4679510548248658 -5.2187524228707876;0.74841825540357854 -2.3083011794265835 2.1047644009833069 -1.1076498444129355 4.8696569180085589 -3.754806585895158 -5.6086590987626828;0.049142413024632292 -0.97053270515052881 1.2125351492428866 -1.5655364314946989 -0.62658910095730636 2.5710376501523871 0.95498485602299965;0.12091098601095125 -0.60762348550807344 -0.069417023146127979 0.27233658708916048 0.060556529605516232 -0.38236743856934141 -0.35859782205673174;-0.78878019236194874 0.84003658057581176 10.742453732332866 -5.8545992202182529 -2.1191043551011162 1.2177818913476792 -4.4056533802355675;2.2649221224031542 4.0342076047046884 -2.7595676348757503 5.5825808162031612 5.6662313132084989 -3.0914271641577864 -2.7838279919842437;-0.40724205348907727 -0.082919374472176482 0.752911251105428 0.11913127485827434 -0.38347801925564429 -1.4464694332904833 -0.77922435596534523;-3.9892177790160188 0.14803434109958818 1.83532774266731 -1.1589703801233775 -2.0705868498136413 -1.8601664162797547 0.45890505926911057;-1.881195329948131 1.8996827624942905 1.8836243112666107 3.1198442697117565 0.53929405616366077 -2.3722431654382836 -2.6829006740244052;-2.2585835982559215 0.6323035769909563 -2.6120142956429873 4.3285778323677668 0.74600526525493394 -7.676138165985595 0.23689463606289618;-5.6478230327545687 -0.00095850231691034168 4.9862374003043879 -4.9936787159481071 -0.39905037175268926 7.0446745472075616 0.50316518497022611;0.26407933681752938 2.7339811547997863 -1.0056506942539247 0.17118051196978309 0.90912628981897892 -1.8679864890820641 -0.080478439736437174];

% Layer 2
b2 = [-2.6345113302474186;-4.3770753089340522;-0.1993693680035519;2.1848749590234506;-4.4378482440825842;-3.1574957001118071;-5.6042765291310861;3.5486683317347256;3.1508963797675884;1.6696092265117972;-5.9759982575466859;-3.2166415763989309;-2.2444914431935716];
LW2_1 = [-1.6396204223656139 0.44191049986524134 0.44013689932034228 0.8608438099734177 -7.0548675781982721 -0.19504574923811718 0.17984215358523528 1.2845099271633478 1.6393245640987384 0.051042944607052457 -1.4307286533543955 -0.99255410426007096 0.35263489706833046;-3.6048218792611406 2.2413020774999426 -0.58862294641685409 -3.1849997485357981 1.719320118719609 0.34645689393706719 1.1954986539967105 5.4162300467042721 -0.11320882076219982 -0.85759000709685496 3.1223270828894254 0.12167066362511805 0.50706916582505313;-0.10701967461548054 0.45876537797577349 -0.61770383390011052 -0.48193800353479271 -0.84490019135530881 0.34490909645756224 -1.1993990709014726 0.13837730545311192 0.14309008511290627 0.29481104143212011 -0.55135366856850188 -0.16567619304877163 2.8007647768118478;2.1156679417215494 -1.3547822367837681 -0.28053164798542168 1.6971909477904985 2.892791516628122 0.66780981480562851 -0.27577566042832435 4.2245978933298449 1.4896627301976761 2.0499511510009576 -4.4708693013143481 -0.90383452654829854 4.9617901593272764;-0.55259760339560005 -0.6431602543700915 -0.10248818724104436 -0.91481349819051061 1.1410081114648769 -0.40234575277629997 0.0066417169436219815 -0.97764697936244249 -3.4988891855591375 0.61988067219839738 1.3619782483777718 8.4431814166872741 0.33351557173467761;-1.0831752217846975 -1.7951303000143777 1.138117591511205 -0.13580112312493617 1.0208156151663521 -1.3174902893737073 4.6862497818662092 -0.86971780821797395 1.4789202072741032 3.1426882105667926 2.1628382127863466 1.5769994887908325 -3.2485950568771775;-4.3496789533373228 -0.84814222606524647 -1.8452378925922162 -0.23783937929383792 -0.65441367376994108 -1.5812135295120626 -5.1401436878500233 -2.9644337379206935 1.238184132750304 -0.41885185737286335 -3.4672318596633529 0.097028830833489524 4.741862070609498;0.086628414919013658 1.0422713665656176 0.40096661140473638 1.1965225259190939 0.78567237422453229 -0.76923609587341135 -1.8701723906321657 3.8446558565030706 0.86349844331012104 0.92537208843676988 -5.290293222652859 3.5989202519071384 -5.6344416505664618;0.32628800938377056 3.4621556360247046 -1.000025246130164 1.6912258315659257 0.8839557183364718 -3.4555223558746309 0.17937389709017523 10.18568894698428 -5.1499277031249919 -1.7929161485830214 3.4235413497604412 0.4466307146528195 1.1083629586845172;0.086110407715168188 -0.5836550221944744 -0.33206851613545252 -1.9115553175863507 -2.7404734821201893 -0.032332836302414222 1.887854404246506 1.4240131517064234 -1.7927700219148917 -0.23764498704893589 0.49694428705636412 0.21325834678925037 -1.4858312243459235;0.93689130661052078 0.79503881269857823 0.15440504033681063 -5.606786783210266 -1.9452962759750065 -0.18154873064742827 0.21713838673303471 -4.3706766795251522 1.8055489208498445 -3.621049899308689 -1.8541429474010673 0.77227512527884323 -2.0746417320167612;-0.092511226612352282 0.32220903430170184 0.064994767163132863 2.1872376452787741 2.1294724180391178 -0.22094142233913439 -0.45762627495491037 -0.42566938757775913 1.744737101824076 1.1524303587627509 -0.30594684999946131 -0.34463188433851566 -0.94218271077690796;-2.5311955640375903 -0.03527991972561538 1.9246880222239477 -0.94904351615867943 -3.3264630713250338 0.079551790747183368 -2.9122586337000769 -1.6688961103813857 0.30724302906338552 0.63291048954319284 1.9199277131301722 -0.3575968111461853 1.5370606200002794];

% Layer 3
b3 = -0.8335215691195923;
LW3_2 = [-0.15781251353732004 -0.035132431383661553 0.21419485079777348 -0.061596558551086984 -0.22915563295842756 0.13164072787771844 0.050576261529569261 0.055061522581696262 -0.086469142958099363 0.13523136288509441 0.090933870661037738 0.16911234004378634 0.094758329824158605];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
