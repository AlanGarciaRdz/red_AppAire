function [Y,Xf,Af] = O3atemajac11(X,~,~)
%O3ATEMAJAC11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:36.
% 
% [Y] = O3atemajac11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.201288244766506;4.04040404040404;166.666666666667;0.0561797752808989;0.00614628149969269;9.52380952380952];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-3.3757939718303076;-0.01679044759377455;4.8435970901016354;1.7168793942696552;-2.1758383849501364;2.4849818446090253;-0.50068520151618001;1.0512036459126928;-4.6651831016466536;0.86570687301500271;2.0200395049554229;0.44383380912171527;-3.3116231139350667];
  IW1_1 = [-0.48363741264832227 0.89961951301705589 -1.8030138964980054 -0.81664122605620726 0.50455825865508264 -0.59137701449157842 0.29965336934311881 0.63320131932797541;-2.6072058486531402 -1.3335937583500996 -0.28214337131614964 0.44781060282256002 -0.078371562049655188 -0.12724236991074395 0.068216164721996098 0.16740091154483641;0.014434675368894961 -0.20634114709635071 0.75643368377114872 4.5456973270506342 -0.44119354790281151 1.0046327211002271 0.064959577133622187 -0.34088237390695075;-1.337579210971322 2.1592251103212763 -0.41402920875018695 -0.66503402177366844 0.22810904216570932 -0.23978618355631076 -0.035919677835638049 0.45199637479404836;2.3426781694464895 -1.0486095806061111 0.21919940755772438 0.24483342847658088 0.051003819125781093 0.014720765816941215 -0.040863724872844565 -0.48761045934951314;-0.87665995590601575 1.5742604685905919 -3.4334674276264332 1.4670886605511884 1.4640864832097831 0.53195478269176466 2.0172587750429702 0.57164018124400329;0.05987465378991149 -1.5943763533454105 -1.9344358357269498 0.79310152335880491 -0.28995863501079011 1.3878695646909094 -0.27651513747691747 -0.13443916804743419;1.5938290331206861 3.9512583603871101 -0.80332437468990114 -0.94208473145454452 -0.085578531200240116 0.11063930069202398 0.11939542020540359 -1.7119509287114634;-2.6839525517441589 -0.70043109650774205 -3.5238856947053412 -0.14294563250582304 -0.35708921863911208 -0.59815989464932551 -0.034617190035858537 1.6104932426509271;2.491321144848079 -1.0879790718306195 -0.12930566943392666 -0.01774666720786796 0.29737988746278721 0.74845048129246317 0.070316530420514042 -0.09614491158967764;0.83272749513038058 0.098756954957030393 0.47807081156391507 0.3352168735393225 -0.15289889917919613 -0.19397209112139929 0.030067878678461803 0.86462779058927042;0.60906460326757117 -2.7644895067819437 -0.6723476645120422 0.66949715089685091 -0.059340778226181862 0.14226718403155128 -0.042223461058756628 1.5948094725697939;-0.87862117521086469 1.5074744539267384 -0.34919164058604535 -0.23775655371443963 0.52650487157548642 -0.95073658890327351 0.19675795120200623 -1.7258582674004903];
  
  % Layer 2
  b2 = [1.4030192973416376;3.5420621577731564;4.4893322165821541;-1.7665896084142443;1.2359348019365946;-1.4066667812074747;0.56032428758651254;4.2159552971486987;4.4152561282379406;-3.3735688055058302;-0.81013506277889591;-2.9327988263906106;3.7990244427271125];
  LW2_1 = [-0.62953155259981552 0.49211751803469533 0.12345754599812968 0.48542449562304996 0.77478015858805727 0.22430770657120513 -0.3135987756916962 0.036006159725847704 -0.14399110516155933 -0.76247477394878393 0.25070753483288355 -0.022507373063791955 0.63436657804571051;-2.3765036543168114 -0.40608435598518733 -0.098129979897147515 -4.0231725902853057 -0.92475111166121859 -0.1198929233046185 0.51678282301322431 -0.3895351762945502 1.0638567687286238 0.47173647836871913 1.5147844331448321 0.12044185190921833 1.521834068900028;-0.65533501033017738 0.010969875956449516 -0.21416172684647383 -2.5540871041167024 0.0043584510673776791 0.70238737017742081 -2.3261704300433523 -2.9306996886551446 -0.98437106455606527 1.8504910356987507 -2.8755538436204588 -1.4824419198290768 -2.6759095647136659;-0.5077603514829776 -1.3178956008130549 1.3725974373450931 0.25864276659375918 -2.340758944645875 0.37623219610091857 -1.2734270349413905 -3.8934715871853038 1.181092544577333 6.1826246404744127 -6.7200569462934059 0.90384832057441744 -0.49347934027880991;-0.95596214401290114 -0.012154406704920469 0.065449158277401359 0.17271314101148008 0.65700681931177096 0.07246958049899814 -0.33040278053944594 -0.73582871834521568 -0.9098714631142234 -0.47285606896141485 -1.3424327339450497 -0.57835763296186837 0.49720916701254447;-2.1811172312210214 -0.9098533455229868 0.019865517845291909 -0.75759306224771894 -0.82523098178374199 0.097225270330078925 -0.15302286674823751 0.10694862853024076 -0.02202538191929225 -0.67879496947487916 -0.32033513026990379 -0.32129693078614568 -0.36826935168745994;0.047045071487312837 -0.82215722585269579 0.44544385594547248 -0.75250751058867749 0.20648476849516995 -0.24108982323487477 0.088413347963240463 0.58136564889574616 -0.27579446673145319 0.061378702173804728 0.7489329952391317 -0.54788149397886909 0.34980894561245846;-1.5719766734785221 -0.62824238537590715 -0.74100725090787178 -0.89291197470312389 4.677006192214721 0.07401699596536597 0.64984661613889394 0.31716154161290533 -0.47080975383876417 0.66329856258806563 -0.39533092706984241 -0.39486953149874476 0.23972702327639811;0.3404911281205969 -0.30842461770228602 -0.064790047183879582 0.16469656150678152 0.78561669997743111 -0.32540611375543671 -0.17527030979622973 -1.9875504746206916 0.12428283513942458 1.2887813998620026 -3.5129908171439572 -0.80727470498863119 0.02124372723447128;1.5578548658044276 0.45892742648920659 0.52335502725619953 -0.62814848817867541 -1.4567739068830017 0.1866184453184106 -0.2946644965231594 -0.3929200492261003 -0.71119807077838826 -1.1995867683607326 1.7705343334843247 -1.6430080749361595 -0.4387970849251529;-0.091976318201260038 0.45807563361831016 -0.85340926960109353 0.21078008232165585 -1.0336288667802809 0.12825021916780238 0.39109384566297595 -0.82251816866514726 0.029866514384994443 0.40674442463217619 -1.3443202207825236 0.19990857134841131 0.10949927225709742;-2.6600480397841717 -0.14046932572514481 0.25728772088346519 0.0064437889779404827 -0.034089907353066468 0.30853059028060509 -0.65672104044200474 0.98567573115665164 0.12213999748365499 -0.69789480600703413 1.7393289399022958 0.38335178241367923 -0.48399546511655323;0.4711382156842619 0.4010357335460179 -0.069236448621372237 -4.3488352069153322 -0.96773502802441469 1.3288205842838825 -0.48106301521146122 -1.9015276604022033 -1.0603195168008179 0.21789142242961773 -1.4257068735506493 -2.3377251648489072 -3.2993424537272684];
  
  % Layer 3
  b3 = 0.69523787690090078;
  LW3_2 = [-1.9022065436086846 -1.2450776141424735 -0.72350683021319628 0.1908611142904485 1.5500252278887074 -1.6345915841779453 2.0200558308782397 -0.9974968556801761 -0.76658668993888734 -1.4766621615121818 2.0964542736644818 1.7238734473359525 0.68854893369012193];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 9.52380952380952;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
