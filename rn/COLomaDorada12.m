function [Y,Xf,Af] = COLomaDorada12(X,~,~)
%COLOMADORADA12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:38.
% 
% [Y] = COLomaDorada12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;17.6991150442478;0.00572573718866304;0.0175284837861525;0.0546448087431694];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.6806741452978264;1.9536204319769777;-0.27016413821566959;-2.7779071749148891;-0.96570635143715355;0.85616514789301057;-0.29946400199876672;0.13045991419105843;0.71758644680040584;-2.1728261106960165;-2.4000152162699826;-1.1682300795623672;2.4451506050367744;2.0709810558077013];
IW1_1 = [-0.27183232290169429 -0.65805501299338154 0.048266783800878808 0.14797897004077035 0.29331532310259206 0.54534391842425756 1.3382407340486193;-0.75121168376379621 -0.56515882918185212 0.26078954705852525 -0.82969458863554335 0.318123878237344 -2.0228878034108608 -0.59565723869971654;0.99188669909281824 -2.4108587723698758 0.14767787357617629 0.67327671822823643 -0.53777368369304379 0.062272513161281615 0.77735101828275754;0.10255775563692038 2.4184579358941516 0.40094614972039311 -0.32733529718485022 0.84962130601391617 -0.52090774751182778 0.94226944689256109;0.85434026830982868 -0.50818246664991151 0.52697710817799992 0.33980821364419406 0.35655112814897155 0.24069564977422936 -1.1556282194779881;-0.65184815302069132 0.34041937401527367 0.71004469117120073 0.54471517149975046 -1.1655073792054829 1.295229217778374 -0.46265313959575677;0.36525656680405555 3.5649019923499341 -1.5806409738513927 1.4613190996960697 -0.072703400702736315 1.1885749104378589 0.44568507264096235;1.6545351194347433 1.4493478593512481 -0.32774219737228116 0.31260091746304841 0.13468089258963162 -0.13764359946716892 -0.90600046780047061;-1.426505615285238 -1.1095730562573196 -1.6327132827295034 -0.43710878858201418 2.1270501850671546 0.91648589103472289 0.80423564336688846;-2.4175155656049259 -0.87803982386642454 -0.29853724876681098 -0.098226708008036595 0.86474635832844304 -0.11709267367754217 0.67866511023825904;-2.7764196648896964 0.60946229382693085 -0.135791958394096 -0.12666861349723954 0.56221270014737101 -0.37877839401217434 -0.0081226378590374647;0.42721860165444631 -0.86222050782434179 -0.78868694541278472 0.30743963403713143 0.69507897660466855 -0.43015035540901059 1.7215176447005835;0.35098392955938307 -3.4562879154506239 -0.23219962877463354 0.67961724120339451 -0.58541270614874497 -0.60521598806705079 -0.14633202658949634;-0.3325553312650496 -2.0835887718760162 -1.5878395097101887 0.5764581705880677 0.99607716480281272 -2.0003862986847745 -0.8704020915116919];

% Layer 2
b2 = [1.630992336604731;0.83462685827348604;1.6190640469997153;-1.2211228975533042;-0.5147532091111493;0.89229637328628286;-0.0074649265925501238;0.19460052293703664;0.042340257733611122;0.62186580583892515;-0.80102489408268884;1.379355158738103;1.6074562802006958;1.7061050275697365];
LW2_1 = [-0.14800069197196097 0.64788394326131493 -0.52544798341733112 -1.0099054316208229 0.098535254555159393 -0.21069594350963025 -1.369774166789357 0.94199923853100154 1.1184856967274726 0.98026567471462012 -0.19780736695371051 0.15524281382277239 1.0816491192993032 -0.28359232020930308;-1.5152323302272392 -0.31217986021413746 -0.62455595307293177 -0.18503403397706414 -0.24039400932820143 0.70035725758435152 0.40498610582759537 -0.41529866723450404 -0.17366125724303397 0.75136046949543678 -1.3686195490251458 0.22462694318617635 0.68486922876924239 0.42531719749683256;-0.23551496534301769 0.53910065137431329 0.59036446319060998 -1.130592975851153 0.21194514072760426 0.56232116928971576 -0.052439662308083272 -0.18104895865282089 -0.38810511936076797 0.34331001473498951 2.2105533062382596 -0.1884179437437305 -0.24797267877655021 0.020096329463986401;0.79244002104064526 -0.77047150871569225 -0.92392394589175886 0.82893161888895972 0.85575472166981692 -0.25407736519075763 0.067806738583678472 -1.5524327512556417 -0.6226899023173541 -1.5969969263022803 0.2459357819963319 0.25457931868374395 -1.1496615218252475 -0.034021319547424253;0.47774581190224374 0.34519624888432088 0.44033697353675599 -0.98923037388533797 1.5772239235832002 -0.50079498419700252 0.77344365783719249 -0.39373016236786518 0.36253460066761428 0.40445390123417163 -0.76920543681270126 -0.23964460581044911 1.2171787342522604 -0.55451441523084655;1.3188563955586976 0.10558377750015979 -0.73022915633022067 1.1528098221071716 0.063911267133052216 -1.4384714545619171 -0.070933727614114803 2.1325578851022011 -0.4997184608001688 -0.084718539099245177 -3.1468409739827594 -0.22732318682762834 0.3922450733976085 -0.25610373091549743;-0.12032839740783373 -0.84659739699464065 -0.18613015103030967 0.53195583367037536 -0.61386237042792358 -0.64945083834204298 0.84916494174620283 0.50401712869421456 0.53130495294057267 0.98687520103016668 0.49318618162660988 -1.3354449305813498 -0.13186256154929446 -0.73368677171385122;-0.29348389284267828 1.3019002008476772 -0.81632869114234596 -0.67897854567725402 -0.84853796617829813 -0.15881046549474431 -0.27566076830140818 -0.26320094915011966 -0.74927045054230412 -0.15267617200748604 -0.08459803597999567 0.41660427403046579 -0.22393608643598178 1.3762677789078988;0.61814104428131433 0.1340375814515288 0.33054778043056848 -0.2686619337533166 -0.060185695257337683 0.61028817118623579 -0.87297774976479903 -0.049405480911709689 -0.34464020871230733 -0.14385202721648938 -0.23954456209736494 0.42000840542185525 0.035662731484132869 0.96431629426838639;0.71324468313812484 0.72072327229001043 -0.28870463818078534 -0.27628656083331066 0.232809749079256 0.99524163406399146 0.28081820192842155 -0.28364227006356896 -1.0301997591058552 -0.87718104669211849 0.60167658901737897 0.41809377631891159 -0.41421626753296198 -0.22496240621951935;-0.49939631055603212 0.29310629210751538 -0.28278166801980514 -0.60797608934623482 -0.29231464919881478 0.29831632704028799 -0.15833909990943484 -0.52741445789847508 -0.045911120653979301 0.14609482375836322 0.095605024315836423 0.10481538160034988 -0.94612929387789368 0.62282366535292788;-0.49410664806913501 -0.72237595367927521 0.25023326880328012 -0.047038257693229994 -0.77311120449174675 0.56709824449698265 0.053301626062564889 0.45303272247896531 -0.31758895439054335 1.1348751950239702 0.74178086569380197 -0.35038438017761897 0.43431245022326082 0.14479267038054908;0.78028529906349553 -0.62258290091116697 -0.75507489148597584 0.8610414916382646 -0.21601047311516181 0.32475305518764058 -1.2671824971428418 -0.32526175878994262 0.54059012241394278 -0.28618605713267009 -1.0269168446730939 0.47691741210628363 1.2297531920933724 -0.24544794617846255;0.62458986976040387 -0.10625121344057231 0.89587126359554536 -0.89732035322500192 0.51808909097423395 -0.60211150799968904 -0.22806839044766763 0.39940112653014259 -0.45088153430247635 -1.492278386133626 1.1878283011208162 0.40547248136275504 -0.17814872873521242 -1.2308616450241441];

% Layer 3
b3 = 0.44245061710434219;
LW3_2 = [1.2803737464174052 1.1281033645558323 0.87213019321295926 1.6423028859346409 -0.92589875903487062 -0.51278909947915896 0.87768639945943716 -0.37558315040867346 1.1864695036603932 -0.41038846322656608 -2.1723977228339355 -1.0234052765462229 -1.1962886323044737 -0.47353302747524378];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
