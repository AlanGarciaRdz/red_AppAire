function [Y,Xf,Af] = NOXSantaFe14(X,~,~)
%NOXSANTAFE14 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:51.
% 
% [Y] = NOXSantaFe14(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.0939120310988235;-2.390657233056201;-3.5988434740445783;0.02609041313251112;0.75297974845751647;0.16685507531574301;-0.084743538542246352;0.82303025649173533;-1.4523379985291101;-0.61107883625842196;-3.4157053401485222;-1.7831007436358897;-2.4841387675341768];
IW1_1 = [0.51152209826189921 -2.1731146079991359 0.54474269134159725 1.1542706249637487 -1.0157495190736203 0.64346704712732217 -0.35335794392628606 0.96562291867895289 -1.7084771290982088 -0.80617509239496365 0.047768284585945224 0.15839068352051675;2.3884666498985556 1.6514684236486947 -0.60173062330600879 0.60389720595221419 -0.41024433893785345 -0.63907738425970617 -0.51695185825218903 -0.093912365950803434 0.90702132048081474 -0.40857605890629867 -0.37438239243140531 -0.00526496661932036;3.6937461178866351 -1.7515595366529897 -0.66790702032294413 0.51006113205466397 0.39944788432461331 -0.61964354384751863 -0.098631763217117141 0.06624820939989691 0.85080097281056533 0.11318953825938916 0.34602241572430026 0.33236018904545489;-0.016946195922805947 -1.9956664261968011 -0.18657455521082908 0.30869853777273537 0.28588699191659817 0.66432918446923428 0.24309401079176177 0.11434964401811931 -0.58754591706259285 -0.3863724008239785 0.13354825163511252 0.079974015706390442;0.5551561538812283 0.92881039701658052 -0.71458006521195272 0.72100454220931587 -0.026479874655658465 0.22181842380657099 -0.11917828610746541 0.2162088316315865 -0.054074122654037458 0.12726902219500552 0.18738887196649445 0.0054579245900627585;-0.5590180215980608 -2.0717046476375844 -0.16255279429802544 -0.077888463323714768 0.20581394391607191 0.17098085096000076 0.14527326731576881 0.10960646969895133 -0.17173771998174708 0.274642048643368 -0.10773251187230205 -0.0014242206410445303;-0.51142131433251437 -0.40709119796452559 0.49136318796571582 -0.56673699284494039 -0.090055657055765986 -0.3318998845709894 0.61970147362003358 0.84795336548542599 0.24153047211219411 1.8745186576397221 -1.0610437094292471 0.26778229893546818;0.051897561822709333 -2.6346173729241213 -0.32825131847736866 -0.34074687616023075 -0.74477318609323506 0.068903042322276842 -0.13478435620823379 0.025001863890579717 0.098941330537339028 0.21137612380844764 -0.063119731590716002 0.30368406284925037;-0.81808650313350439 0.89225403355382493 -0.64452259074296181 0.32916654010210566 -0.1381426271111183 0.017445156252142574 0.037679019852069104 -0.16657347247604126 -0.25056273186582717 -0.48315537884037324 0.40278881741404876 -0.19245073617069811;1.0796888027553082 -0.57676060003263052 1.6385245724228001 0.28889382564737959 0.19677528755414256 0.59919029008962266 -0.034380917617796297 -0.44069048487222212 0.2207393893958276 0.46553961090806467 0.51931639817506225 0.39846617857973821;-0.054734747137096793 -2.2348498357595283 -0.97107922442178418 0.92345543019193632 0.23534015605232256 0.54910071979719743 0.26188980726068595 -0.091595914489317337 -0.4573612152253928 -3.7639720508192118 0.40057052014303773 -0.13868683969394552;0.0066739255569481862 0.47376831511051037 0.78821543241913528 0.5595003320894455 0.90936642256045341 0.33411564206196354 0.29670537665737506 0.41860023754311287 0.91785073581791832 -0.31799059112313338 -0.15838868457794344 0.43087712803351041;0.19185252926307036 -0.79322994192151619 -0.81943128217797345 1.4565838007397773 0.43287615847492511 -0.48390429162439952 0.0657529960037955 -0.96612542611395269 -0.62041898957181985 -0.088876947280843693 0.36178097975487561 -0.22209108596651483];

% Layer 2
b2 = [-1.8404882700706566;1.2972514628975151;-0.51327236487731642;-0.54902650499052974;0.88690171493487102;0.52295946977702368;1.4068658760797352;0.18627780266987376;-1.5792539069821687;0.27909676693716862;1.3269143844031248;-2.0145258714593948;-2.3009789837461758];
LW2_1 = [0.29979686707430109 0.70959719153475243 -0.34921509216226093 -0.63287646792298902 -1.1901707912483077 -0.45911066773952669 -0.62210570837989088 0.6846223504206288 0.52956281732780508 0.37640770825596126 -1.1214072078477679 0.24574715957402538 0.44422931719573822;-0.70375880371135391 0.26449494886437441 -0.44296539896984455 1.365360637611839 -0.80664631396652819 0.7667553307937216 -0.49822021952812856 -0.21972882089329521 -0.35005557673890841 -0.66912212614291233 0.96789588447984654 0.61842035153448904 0.61210330148503822;0.24267968705347331 -1.0812098926575249 0.23136341689928799 -0.38994749827292141 -1.3030896203871696 2.8330682596452594 -1.1635538800023557 1.0056117326965204 -2.5718847972513057 -0.50200250494588605 -0.096847367768562564 -0.47616685418248295 -1.6544677805707531;-0.17953487045237901 1.2384689314516859 0.50214721164212894 0.29635182922339559 -0.97431115699642468 -0.099139629094326415 0.31800366923702372 0.050035739112751401 1.0501023562471485 -0.044914565906946695 -0.82392229405825335 -0.19569578672036825 -0.62110218556946972;0.07830763895616924 0.44301674602173324 -0.38384302161556733 -0.5872888388827382 -0.84344064738992075 1.0008416421271376 -0.043164144983639498 1.2685361065021712 0.71956047463550887 -1.0597982454463135 0.29656127929578774 -0.9900429951724693 -0.19678073560911311;0.7300672398436856 -0.49085090771848711 -0.69211760067073658 -1.8369492859513858 1.4024803102068151 -0.17080666089902194 -0.27534327300970141 0.21064459405684299 -2.7693835264455142 -0.89426165551338288 0.9460009009984317 0.034049792303641642 -0.34855757450432279;0.9405436598369501 -1.2049122203953964 0.75602115043009799 -0.42001029992379313 -1.6029961219131115 -1.6165366889282045 -0.013702936942959633 0.061251177548798046 1.0343586358184531 -0.049607346633721454 0.097351793724010843 -1.2641948072883848 -1.1744318228639621;-0.65875394451036584 1.0000114441024057 0.40646532576605454 0.11115832848094989 1.5402420917629731 0.91180272149427644 0.80569646044243948 0.011766333587084409 0.70418491043701847 -0.10290194129794439 -0.34163414404429027 0.88309447911654704 -0.12122362577565106;-1.365935099950444 0.25520190427227657 -1.309339531966857 0.56816689732819237 2.1383376482523575 1.3508716058728691 0.27847206851177586 -0.7998808388564056 -0.020728371483554456 0.61338409950059081 0.30720303363148815 0.30718416245420288 0.30077316760559425;-1.14842877133981 0.80228670937327118 -0.21223955654937549 -1.253249476884029 0.1495495587203684 -0.047505524334297937 -0.84269738238413172 -0.93901707516606159 0.34776193700715802 0.55247513374442159 2.321340077206917 0.73740471569046628 1.234262533032197;0.64029071797975445 -0.8916912492273632 -1.4853027977619071 1.518306589965591 -1.349323676980128 2.9826785297451464 -0.9940348604107121 1.1722551618322614 -2.184252187613775 -0.84999948382538637 -1.9679401725789885 0.079139809537528832 0.91402283545792662;-0.26728671946490773 -0.49668670174345841 1.1036140984965503 -0.046451678654990794 -0.016132697310612648 2.5258956584963128 0.7977696665751457 0.7877163502022666 2.609739382327541 0.35716970465404968 -0.080112483244513075 0.99175501583997805 -0.27631981393391997;-1.2052020480388581 -0.013851974821016777 -1.3354888747045175 0.79977445872599529 1.7272759865802976 0.73840369094203684 0.26005157856880928 -0.55897821398763425 -0.13182850270206731 -0.25849744769532584 0.24432060848826531 1.070371230141675 0.10150508032794522];

% Layer 3
b3 = -0.7815632572857204;
LW3_2 = [-0.46561578559285888 -0.037586706907373507 -2.3888249496809548 0.65520120413538452 0.52930321755251675 1.2426100107190052 -0.90377316861318924 -0.69588957611963465 1.3362133076931277 -0.51160822860552446 2.406152180602334 2.3791620188216132 -1.7047905078546912];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
