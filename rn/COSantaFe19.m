function [Y,Xf,Af] = COSantaFe19(X,~,~)
%COSANTAFE19 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:10.
% 
% [Y] = COSantaFe19(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;0.448430493273543;166.666666666667;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.3191322032117752;2.4564677664539181;-2.7119807039296329;1.8552424974214403;-1.0322638140638973;1.1608369337300735;-1.114973638016471;-1.5822071483768088;0.44530714623952117;-1.2352692114378327;1.6286464056037371];
IW1_1 = [1.1651792554920015 -1.133893462250517 -0.065543577703976369 0.012501378686682354 -0.12074509593325919 -0.27788742987474568 -0.54686519948608536 0.063380371178450495 -0.090504022374084558 1.082907882589689 0.21231687589292153 -0.32447228212115431;-0.68331398918965136 -0.70483878454201276 -0.93847916700104517 2.7577568898292886 -0.68019747008811104 0.54842947889044502 -0.51891538286722139 0.48372294124666781 -0.06846074229594945 1.7559841367744071 -0.18539827169248982 -0.32283931168588081;1.5614065850378449 -0.74876213875229558 -0.29021929811717445 -2.1908727679603492 1.0809954509270085 -0.59364837682511684 0.53967478163327254 -0.12327264806730522 -0.25437053252171693 0.36964858632986197 0.24610600828507351 -0.10497165596712071;-1.5918015024032901 0.26069804955064768 0.71412030826274708 -0.3544386485414226 -0.47599554354707696 0.32770329575776896 0.90168127382399388 0.032832997225672643 0.021049247661082661 -0.73708401455460448 -0.22954321698694224 0.26098490124739904;2.2942417181278723 -1.8013413471060487 0.89649134347089088 -1.0749427394101396 -2.2282731691161239 -0.39996040177353109 0.45115022252284376 -0.78887320704503239 -1.0083129712980199 0.41913549310444487 -0.83517405354258911 -0.83609805578157192;-1.6518581469116935 -0.78811278084259473 0.82102101818439688 -0.23815166117514103 -1.0328189579848934 0.48914445350762176 0.82732388455163741 0.18981403208398273 -0.088171469837726724 0.14111765337523713 -0.35701753481122944 0.16831187935090691;0.42590557617844443 -1.3921736307691586 0.95137729578803354 -1.0936146438726306 0.1427401643713189 -0.28635957704395099 0.51920911745213971 -0.47876859372144892 0.44601671544568788 -2.7919643231495286 0.041599076808426845 0.33717558732874775;0.16485390725537355 -1.7260171487394309 0.56091388748482951 -0.17440173384952806 0.10182083212977941 -0.074685419970874606 0.054726678748874991 -0.2599590159456423 0.53699294197141112 -3.465120276346727 0.30067533087297849 0.47515065176804938;-0.30123310610191023 -3.4946630181457921 0.077216162402221358 0.19572037361733202 -0.008126403591213683 -0.034722289956042443 -0.66009954108463265 0.10954338351362404 -9.42781454106199e-05 0.48372119180548728 0.20646533706950482 0.008154442610552393;-1.8302030015398223 0.085259507319970645 -0.35685232238767123 -0.13337369790930256 -0.37530198349912852 0.20575511608473221 0.95623457845597348 0.026615499600438075 0.59395820523764598 -0.10557959122213527 -0.01325427381717686 0.3778521852491224;3.1597812995878694 0.019747340430395697 0.20460591166934222 0.12363476368068319 0.48137169696142085 -0.21009935816945524 -1.7799964975924223 0.056777161985736693 -1.2899933832654535 -0.052315130491537652 0.092142221381468395 -0.4559515725814054];

% Layer 2
b2 = [1.9903595555488429;-0.87952905226979949;-1.1658390725496692;0.30002286040213216;1.3635800739972912;1.7142103926226868;-1.4982107282038184;1.3511874369414405;0.24820138665146491;0.62837663583785786;-2.2490084450251011];
LW2_1 = [0.70885985153583042 -0.4898070328515664 0.26094063557744851 -1.131947221508449 0.0657012561763409 0.78338535405988474 0.011679994685036763 1.4641677431794518 -1.4396713403748675 0.0055208097461955097 -0.26142703292256819;0.012718947181915165 0.76170385534564611 -0.29341008929455759 0.34516637140541723 0.57184966506444923 -0.93277957504630837 1.5110444598618329 -1.2335766332306555 1.7077150879071132 -0.54019841535813218 -0.88923776363925855;1.6963376388910167 -0.34420868381807906 -2.5220010318089643 -2.4486975191794422 -0.20560027433222491 -0.57024143487380852 0.97171903060282905 -0.42835700398283139 -2.0900095299341785 0.53624120450858104 -0.34795879228031001;-0.45137926069486961 0.22448867146025708 0.25609117628685718 -0.71935388782761034 -0.72440107322292802 0.76844209753443871 0.5980312124719922 -0.37627738415565004 0.55012958718442795 -1.156447454096539 -0.15833001220022219;0.20381976558137871 0.11428607250933881 -0.3617477077057501 -0.37978001639695758 0.6388542808127049 -0.83750632042968243 -0.14418144845738476 0.14474690299262979 0.90289907039010209 1.0694071216361469 0.86274348232367903;0.93095489463022851 0.64712863868797099 0.27390098519724415 -2.1300359880186659 0.46871512122874831 -0.88876579784937759 0.40016371147813978 -0.82209257231068256 0.55061521951767356 0.86266793239834971 2.6797879217404219;-1.1383575061410276 0.16546050077447297 -0.57246944794418086 0.42500949534390969 -0.26026956099860843 -0.37143326327920911 -0.04349630504319528 -1.294929605798546 1.4582579560101032 0.050344447392911412 -0.0021462182153120096;0.87443905477368689 1.4995182927764559 0.71331762914373409 -0.40023517204239173 -0.68787717278234195 0.77471721669769833 0.88838128509415359 0.91214329864825772 1.051563552146479 -0.29157624350847733 1.1305293885272649;-0.81688503612468621 0.33113703952712131 -0.45569537341178118 -1.1696140106347552 -0.17939340822758826 0.29191022713800951 0.82308655739660563 -0.18453856976080216 1.03310450706329 0.017324579462848579 0.15417080122526222;-0.63993270670460745 0.59981424962194851 1.1005361663367836 -2.7645964072021814 0.4866861402540158 1.7100348756435366 0.55535130883457695 0.24625473467892042 0.52861003471690626 1.7291684925103814 -0.4529608998128879;-0.82803025493726046 -1.195918006436298 1.1963213653283793 -0.33908095728790727 0.32758425088276044 0.90439822332944331 0.31352164461598059 -0.30020332708160685 0.81120749619858346 -0.43810696259619164 -0.11994486585003267];

% Layer 3
b3 = -0.34473712239457088;
LW3_2 = [1.686883035714595 -0.78556288718366996 -0.76150260711030959 -1.4411224970204484 -1.8425416238937009 1.6565090753732419 2.1232262998512201 -0.51298538215824685 2.2832193065655311 0.58129701409515611 0.55048442955923016];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
