function [Y,Xf,Af] = COAtemajac2(X,~,~)
%COATEMAJAC2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:21.
% 
% [Y] = COAtemajac2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.1777962409326979;1.7289981354307495;-1.5203578728769842;-1.9915284607496184;0.049058583120030461;-2.126914476930208;-1.3622355434020157;1.0757999623688608;1.1133177649080144;-0.67848753675078965;0.89839248548435502;-2.3893370398783418;-3.0052595029435794];
IW1_1 = [-0.24008196603919729 0.10191301813486567 -1.7100937837870547 0.80820440329689147 0.043345444969948542 0.33423116724158503 0.58426277234463464 -0.51216066685156203 -0.17173108864212108 -0.067205288684312761;0.0074896874502861288 -0.42468490455453828 -0.32864962576750667 0.18516523305369645 -0.51138899294726303 0.39439535157367994 -1.1225422461903432 0.69080688528054723 1.1295040096144966 0.9156550801488994;0.3865694698026737 -2.057788717195884 -0.94497579315468072 0.30006514322690603 0.43326185331705802 0.30702917217521852 0.090625059880148295 -0.084125428721289405 -0.12771017864537118 -1.2009779350462733;1.5984416835586956 0.59928381742717973 1.5274366755792801 -0.71329106201883219 -0.077971293322664739 -1.1936870494083907 -0.32114647973873633 0.1914123549645112 0.097404492313457242 -0.46071525380082712;-0.28858200470348461 -0.13791149074254075 0.74787583426360238 -0.68102870036938423 0.52938059028572115 -0.26485235938561474 -0.065602575752185727 -1.0877457751600368 0.46120831434749382 -0.50547516617269761;-0.51978309085551444 0.99429010782356597 -0.20224816604867768 -1.7627983269540903 0.21004338147909721 -0.73912323600082686 0.043921197972640567 -1.2642214230792328 0.41862520752539562 -0.16514238740897549;0.69869629398081512 2.8831256097749738 -0.62983982216714263 0.25792740853001861 0.27583719228879527 0.83120453389336812 -0.91504722917266756 0.29378046696934607 0.42047949623792463 0.89436522840859844;0.14455893371981876 -0.78706876602684706 0.23721880926002403 0.56141157083215498 0.79402114446372929 0.79054957576141283 1.107900363878864 2.3511354316255355 0.39924100018487024 0.47491248495288857;0.69364879205675412 -0.026504461106455941 -0.62513343025268309 0.84378697953067727 0.47445328501257383 0.64017302786156194 0.29903574504056091 0.25912698926404665 -0.13533754358991171 -1.736165106850841;0.17562717109128495 3.9565562701534187 -1.1486292217918568 0.62228116233161368 0.61406065429523971 0.49310682505628267 1.5910912854352879 -0.84927273851754259 0.076155020010792537 -0.33783869351340351;0.13324159549563816 4.107332237562825 -0.98959079737401456 -0.19966958639685073 0.11852965819742439 -0.11338198695529939 -0.027055315111312993 -0.40400304214623134 -0.2087129537417248 0.093029709409515354;-0.52536688067589143 2.2749451423097642 1.0590771590738182 -0.2469992357377768 -0.21946247874388281 0.2360081702957541 -0.14646110203749838 1.5736390614557358 0.072205589234865336 -0.94110535880578372;-0.067397928202307347 -0.6334753715537309 -2.8716612014886462 0.028978425969577636 0.025941330233978002 0.067557083824235711 -0.055705004616289862 -0.053416721981497862 -0.04201936505309746 0.054969782900117573];

% Layer 2
b2 = [1.581552704454638;-1.7356702156525246;1.3568853862532828;0.6811413142262458;1.2322194314632935;0.44876967502707837;-1.1554106205866292;-0.64754456689184359;-0.97721570637034372;-1.1678944157331559;-1.5879586346441179;1.2797217663304501;2.229988548967484];
LW2_1 = [-0.95491299145118635 0.17261284915233738 -0.17439907779017028 -0.18590132309656549 -0.31434784371284469 -0.3281325150899842 -0.18965965683842928 0.90158295016338552 0.92538135609228234 -1.124382497590372 -0.50837233303270113 -1.1316738868888414 -0.020723955239303579;0.47774829757786053 0.43222934143628489 1.309430417581964 1.1848753724379237 0.0073895212668863772 0.42055480809316015 -0.13619962177876316 -0.1596077502727857 -0.46686999436675697 1.0955822490517311 -0.045274611728613606 0.29497921055248572 -0.72199378576300988;-0.24720861947640257 1.1803039586736745 0.12464841745231994 -1.5515128443614639 -0.7611797178982167 0.00057538333176918033 0.67930366323762559 1.1486468669849166 0.74577816552805243 -2.3842129691389591 0.4759137782496688 0.3355984090692265 -0.178051993662876;-0.71946219555843871 -0.42342774647007581 -0.48244598677076167 0.30061541656056917 -0.30421252352958089 0.48142422952044278 0.33386021379002828 -0.50822563643481145 -0.46735949950415517 0.9823939621650426 -0.20469592358841374 0.6397999751373884 0.31867175036158996;-0.15888714776554039 0.60565074087622084 -0.084247878014138966 -0.050580462263869384 0.78541474424579694 -1.0254035252949827 -1.0243155800690709 0.85088079145559803 -0.13025393342617064 -1.0511358551942283 -0.5751589351207852 -1.8186768586105375 -0.035543920037747846;0.10982464321385053 0.25543209129021333 -0.43844235157632921 0.55086985823897172 0.25665064574251284 -0.15124792027216025 -0.15128839751318332 -0.016424589746696999 0.36411276011569227 0.21831375682351506 0.066967707424546385 0.40138912233391377 1.6227518014142621;0.53680159619604784 0.65267458215208418 0.80479306448500643 -0.60479640733150053 0.085201611234472951 -0.29681278030503683 -0.3678529829601877 0.79192939354506853 0.69978362845191311 -1.2080928131338475 0.55141518529969502 -1.1156664345720015 0.057096160204176752;1.1185378143358728 0.56177812600961219 1.2081846025922987 0.31245704454370615 -0.41866880205881934 0.68772206760014531 0.1193113385255134 -0.45609592471131916 -0.96375351476191562 -0.18392250086702905 -2.6377742260159129 0.99992893314614306 -0.60013161541304705;-0.26695139403894591 -0.033838608368250984 1.1696989969855076 1.1073762365717092 -0.16185097462264214 0.37373288480487155 2.1386446878590517 -0.084729112209677507 -0.74156536573724674 0.78094727541600506 -1.1373665969491813 1.4621999322215691 0.62528729566435981;-0.66790319416251198 -0.33724459894911707 0.28199240706781292 -0.071324554442271371 1.1240583678039899 -0.50152735839656881 0.97693251674900961 -0.16483032745850831 -0.32669080585587662 -0.20530993779535689 -0.22028762896026038 0.44438460618962999 -0.48261163291700415;0.40411305059559177 -0.78513740611465266 1.0378606201182874 -0.091094755682779915 -0.47811877355730564 0.4961648997850478 0.5189316750381805 -0.40150056389788863 -0.75525075643688455 -1.0915562815028497 -2.606579987039952 -0.70476339663014198 -0.29717417130502893;1.6082283894914766 -0.053180978335833531 0.11323986306411604 0.12724549648075714 1.1465062444403955 -0.77158466548139004 -0.46211557158367916 -0.19852094379324942 -0.78311389475275672 -0.38055586328662921 -0.19088147173666734 0.19267176434293692 -0.39515744314769635;0.082701749316265005 1.0184022096390219 1.036658659363191 -1.0271864139558335 -0.89874770377363733 1.0612822664147372 0.91750198199453625 1.1937209928357309 0.3539151520396206 -0.88624954139961065 -0.21962272488962672 -0.46084630666267068 1.0464955336082427];

% Layer 3
b3 = 0.26258800403182053;
LW3_2 = [-0.43433448659164664 1.1208433979502654 0.57110199347431112 -1.3664342611597526 0.28281592845917686 -0.13498232561769291 -0.98348754384110726 1.2910432300873784 -1.7679746073784068 1.1229871942949439 -1.2913903475312292 -1.0543620298150853 -0.49575817564265406];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.201288244766506;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
