function [Y,Xf,Af] = PM10LasPintas1(X,~,~)
%PM10LASPINTAS1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:26.
% 
% [Y] = PM10LasPintas1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.0251256281407;14.7058823529412;0.0179856115107914;0.00280033604032484;0.0558659217877095;0.00576368876080692;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.5726500314831402;-2.4278928809150466;3.5110187543723215;-0.23037969163716482;-5.2756582555733909;0.77663304932605659;-1.0840252454705108;-0.76969588727963445;0.2032302462571863;1.679986702419098;-1.6234553788010477;2.4802464965023505;0.47700338080181359;-10.011317057883131;4.4874726056310603];
IW1_1 = [-0.26827096997203803 1.0642502500501738 1.2664484291771916 -0.13434770597435153 -1.0561402275532428 -0.27350163506911512 -0.37134336012377378 0.37004636483443648 0.12149346548039233;2.485032162569301 -0.078044160985984559 2.5956742495146723 0.82094897041585935 0.42067005669817559 -3.1466565402716822 1.8632825544786653 -0.33998121844005608 -1.8877012266245858;-2.7838860893363999 0.99931302206744277 0.58219915023725688 -0.59077191098453563 0.32827758800057255 -0.049878971837310798 1.5771482347188328 0.049158870189334528 1.4315769630264119;0.79598172419492397 -1.0953446934888194 -1.4227978619002357 0.48805782430448652 1.0354362282468728 0.25275787999032934 0.14553342731581922 -0.58428119116195587 0.031358282055736486;1.9519233828018989 -1.9899506255229951 -1.2369865628368411 0.52240451403179489 -2.0132752907036107 1.1877187578504129 0.27393267594716181 -2.258792706082009 -0.27188079216573358;-0.17030740820481188 0.19343550575017274 -0.37971774436654637 -0.23819870800985191 0.67182589020730143 0.69989282865618807 0.5234735122859947 0.0067337535999622 1.4348734576956446;-0.37630651441306195 -0.53308291264759444 0.29286573662254034 0.22747413980492817 -0.25930246675612073 -0.63085632276945713 -0.252747379172237 0.11801597890785959 -2.5558794333190042;3.4809893567608241 -0.69443028754128633 -1.0250885440805524 -2.370473854279957 0.13894552038179783 -0.32366841646778222 2.1513997493320298 -0.4834007468670809 -1.5219330731545069;-1.9190540229430511 -0.26625034419038068 -0.57578500021360846 -0.31324433075116709 0.10124477874281802 1.73875105918159 0.78616095934209074 0.21459719463146612 -0.016385187293562906;2.2657796380125674 0.82835443728376579 -0.19288042488886603 0.050444433424958093 0.96914461074038616 0.20993537901641823 1.256119524601305 -0.21162475136726264 0.38614379717684533;0.74719644158037846 0.90552156878832213 0.31021513146560059 0.076642331001325809 0.014122739153127267 -0.042376985712694576 -0.6620981388503131 -0.14055435255279025 -1.4814746853440615;0.51307021148985954 -3.4858656520522908 2.2516410534189086 1.1391904457466697 0.12696323347128724 0.035230177271087765 -0.26697904175650811 -0.28534016784241134 -0.44785200022021066;2.6409947491647103 -0.19006698400626396 -0.8648059699162135 -1.6809382993659068 -0.10791145915231271 -0.47305991832939043 0.82494638509569129 0.51031483232749564 0.16390885972353703;-1.0712091566602122 0.27240280886368123 -9.5899186444875895 1.0207200718794247 0.061058117034767663 0.11051968767568365 -0.43363713594472542 -0.33191152214487252 0.44992005689790338;1.9832782478777595 -0.1594682626825438 -0.85664845059836447 2.9169706112030767 -0.065134087498762969 -0.31612074372932547 0.68925907336415015 0.44202181749165004 0.36119692230340111];

% Layer 2
b2 = [0.32225671630234021;-4.120888330937567;-2.5166200294534709;3.1590373000972276;-0.89788369424352066;-11.206680307727332;-2.1273931485700608;-0.1167890348961257;-0.66288834013079523;0.094065843858720119;0.35414479352536249;3.9619508512403874;-2.1607386072983084;2.869477166209851;1.7340322148628822];
LW2_1 = [-2.2345320244892815 0.51601206647401554 -2.4743174734013538 -2.3433597878478407 -2.2463606197955359 1.0830532686523717 1.1207123584763989 0.61368145559065757 -0.27828331139263318 -0.35603039695085748 -0.67122171435863398 -0.97216773255122413 -1.5086451283656974 -0.62308841523710723 1.4822092895645418;-0.27056503596572617 -1.5324541254973081 0.32925441327157723 0.22009647455013928 -0.65557385536979362 -1.4942702576316147 -0.75009067486449332 -0.15470313486579026 1.3747312866537729 1.0776183242328319 0.78200490657759913 0.3739364569210199 0.73184567995187111 -2.0339125924816415 -1.0541690904437357;-1.616653112004439 0.08327224769158019 -0.23754831759341974 -1.4458377598962708 0.43302503511935547 -0.8452696508528782 1.2098545750738727 -0.86601189587143779 0.57779504728727427 1.7813461573095073 1.5118322323050437 -0.5333924014346284 -0.65544412673421837 -1.2140970251755396 1.5781467878192017;-1.9463201533364316 0.96130196850920135 1.8973161096023576 0.0088838174220485372 -1.3012863853388033 -2.755729397494973 -0.29979771499563679 -0.74208536825249993 0.17345161099908302 0.96439288671183832 -0.075350999252619677 2.4791286569760005 0.61461823097560331 -1.2813064737455133 -1.2070203479191715;-0.18327785954956358 -0.3952385912804906 1.0077764600584149 0.42877518221737176 1.5082120087694408 -0.6371727964608952 0.23128332365396345 -0.80836010442990214 0.039189013278169343 0.74256523420653808 0.17602909048964399 0.18495867262337615 -1.1253638560660353 -2.0059703160682871 1.4063581966680685;0.1592308297937074 0.083615065924037765 3.3488092906240796 0.50045255210559259 -0.39136962734746988 -1.2162770984403568 0.88355831385892947 -1.3815608849178393 -0.038795607803885176 3.6534178143764366 -1.2584243921319822 1.427435942558682 -3.9287090060495662 -7.3236123365280035 4.7625994898179531;-0.30727073041554931 0.19779168889379106 1.919179300046103 -0.78083858248392968 0.3407117305972151 -0.26247303368122876 -1.4935456337901454 1.1396588161392471 0.2469811891811306 -0.80558923245636738 -0.3583950774346526 -1.4602265308747897 -0.25501433362101433 -0.79136446650182735 -0.75265293911355569;2.3863861220680036 -0.3804723174196124 3.6590032391200085 2.5438881297409339 3.2637577137603189 -1.1839399561714865 -1.2560951504743847 -0.85877479111025368 0.36197770164686249 0.48144615049200601 0.78444099987679861 1.1124274093735038 2.204576759669663 0.81646999614148341 -2.1632291620428261;-0.0025464075359013238 -0.3261491623039538 1.0702662662965396 0.53093542783415004 1.5219078073225256 -0.33096758656247588 0.36539364957511977 -0.88490371838524284 -0.35853579590895335 0.67679750041588072 -0.12486400649755439 0.24708679665267883 -0.84902557521663602 -1.2971841757469922 1.254617874926478;-1.8841744996336212 -0.91236982550472812 -5.4170336111251016 -0.27042253843480574 1.5063358943159595 -2.2931675754010983 -0.64498730483401023 1.631963603344905 -3.1962109945726893 1.5825696171003953 -2.5143984552278988 -0.11512565023640783 1.1543638929298436 0.15430179956059409 -1.0084943845815686;-0.76927690885694688 0.0035235363496392592 -1.4802996497004073 -0.8194115714869763 -2.784960095394541 1.0020903061414663 -0.23227802726948868 -0.74397308770750192 1.0766528225753207 0.79263683571345078 2.7125894591301836 0.74344488554929367 -0.64734045617925229 -1.6401929134401261 0.93206300859033919;0.33846658112145128 -0.55080407759899008 -3.8145254172936278 0.76072206296255562 -0.38092133689343943 1.6424402070457609 1.460287073142748 -0.75978386567447054 1.394487471641354 0.003931450399279085 1.8776989624497866 0.42797391443556271 1.1982534632390738 -1.1513397981836488 -0.085168020913704345;-2.5203934735325655 0.31834101289444572 1.1945865875677355 -2.567668175929644 -2.195885008271441 0.66396531238150658 0.87269582643946086 1.0362327178098742 -0.12354764265065121 -0.78525058293739902 -0.58396091071083456 0.64754939488722763 0.17130962562005556 2.7871601865910329 -0.95196093321504005;0.69636259659219846 0.15765848396333032 -2.5231687262947133 0.30908454861576362 -0.62058567017671995 0.41053375411503323 -0.066255784301214149 -0.75944625915506836 1.2645728636668694 1.1543920498025744 2.6030205288178947 1.2660290621750621 -1.1083966441287612 -2.3896278503909776 1.6760519523358122;5.0936403853482339 0.76920694228264008 0.0022052758003932079 3.7980529458347907 -1.1708143199229821 4.2606435970252541 2.8556302687378436 0.50623422058739875 -1.6959169939563554 -3.0148128392001459 -1.1292522014735396 -0.098735955038745479 -4.9238757160231179 -3.8707029011483911 1.5914358447289094];

% Layer 3
b3 = 1.0644698169712354;
LW3_2 = [-2.9674445517700514 -0.28971735415230454 -0.24521065441897197 -0.55675455953617736 1.493729067395706 0.25820572709241535 -0.34980455158422852 -2.5479463987662414 -1.5655058064532765 -0.1028428793618016 0.51401667795318462 -0.38043766632575515 -0.28298287830131341 -0.69063755899041923 -1.386497242276447];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
