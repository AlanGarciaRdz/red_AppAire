function [Y,Xf,Af] = SOXVallarta11(X,~,~)
%SOXVALLARTA11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:06.
% 
% [Y] = SOXVallarta11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;10.4712041884817;0.00782778864970646;0.0208333333333333;24.390243902439;0.02710027100271;0.00630517023959647;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.6206648887955593;-2.2971206021396404;0.68760942405452019;1.1395400343346074;-0.42494526408285965;-0.6649298652968203;0.2846063886043636;-1.0571937255325639;-0.021676626511951735;0.61246440237444455;1.124142445375224;-3.6355585109739526;-1.7830591607929822;4.0820118051645835;1.9862279409148256];
IW1_1 = [4.5637354365268132 0.4580189226589122 0.31775558999391085 3.1796497772105474 -1.5762104751688204 1.8372412011122716 0.78519444258447746 0.45972311074396893 0.21357691808971976 -1.4102705143178635;1.2276434867878196 0.080273851584226494 -0.37292762574809257 1.3352927481613135 -1.2102471922088605 1.2730250977407926 -0.78563809411927943 0.94926315472827949 -1.8091025397512734 1.0765636434615709;-0.97392524942457348 0.25012731625258561 5.1531514046648379 -2.6115372396852043 -0.96722777371814139 -0.66665064432673027 0.53881310744921096 -1.4853470868823777 -1.5126116653540536 -2.2777946168984773;-4.2027349175603499 -0.23121047903095052 -2.6356185535981718 -2.2025487103678953 2.7923569184343013 -1.4701698536056578 0.0025244278736356552 0.05419460425154049 -1.2839703199495844 1.3454783406538928;0.54937667566310189 0.27831002631058138 0.21360667441349862 0.64331017733243057 -0.63723169166688698 0.42850653166646202 0.44154113839579512 0.88576866323635961 -0.2967052422078944 0.82186775468399409;1.45618264848332 -0.32711315391000689 1.0820744138209757 -0.33963136195382798 -0.20851692325674601 -1.2226358375046236 -0.60079136671252864 -0.89474424375220141 0.27047970757154483 1.6305067206148607;2.2481047651162473 -0.025545402642495423 3.6953127936073331 -1.1662125254696201 1.132071364795336 -2.2300484451372022 -0.19119809117402017 -3.4090596035182781 2.1909437122754638 -1.2945506858975571;3.3737834954291315 2.0295716105548931 -2.0716820632690327 2.0700653411657246 0.5665318376652696 0.3490639419984275 0.74115653824489125 -0.77947276311169822 -0.35544525705810148 -0.96356639296397195;1.2508412187489439 0.16570877944326234 -0.18749869976402339 -0.1775277563150495 0.67000176110484833 -0.63777417776987599 -0.8921679058994485 -1.3796511643752354 -0.14360036823278524 0.69863785104540754;3.6233068618746151 -0.1008019362497502 -2.1014708184965074 1.2243003010044093 0.50760610314377386 -0.16643709650780469 -0.35973890355510485 -0.52312774468796697 0.74848331932700995 1.0386786469324611;-0.13165336107007691 1.1195590003310825 2.6365920942773222 -1.9465244595745101 1.0114922019353163 -0.62093153877391838 0.20208184947094432 -0.021080741220625115 1.5152674732365381 0.74120545678854199;-0.64264980183641218 -0.25941075355223175 1.1354426798576029 -1.1611686888405124 -4.0097945664411032 0.13143614580149904 0.29723054865113369 0.40796788061760658 -1.2255962205024407 0.96942572259911275;0.69283688983286051 -2.1188199597712587 -0.2435907799082529 0.4089166000370118 -0.085226102948379373 0.058253858948478704 0.72244721016859781 1.2260785449572871 0.17202488647104458 0.092727552100393185;0.28383925749802147 -0.16437200811536731 5.3652328854144757 0.44461130908118834 0.92847839400218046 -0.34806631725964188 -1.3816749914136153 -1.6126765633658904 -1.0872418293944264 0.44508693703145857;2.7241831761883692 0.17288867729283847 -0.1537814774177074 0.13135602490065987 0.75639525561644239 -0.74002652869702257 0.45395671956453837 -1.7390754398882611 -0.00087984391349241707 1.1138285616073986];

% Layer 2
b2 = [1.8594051422762514;-0.79098126171683358;3.1149005401088914;-1.7625797506018661;-2.2928701205430255;0.33100321088939766;-0.36944356246157151;0.84729060200884476;-1.3334384192924293;-0.61742679374007137;0.76568666899286431;-0.86523580884491513;-0.97140231017400058;-2.9040658592305824;2.3928035534046814];
LW2_1 = [-1.3677274713759002 0.075226787138003653 -0.37394797328286433 -1.6787118242097943 -0.24275613264389781 -0.33369687842395962 -0.060475753646961464 -0.61859888729220236 0.1000580003334961 -0.7559267723407459 0.11605916563930252 -0.081155420702553979 0.069966457970421628 0.21189343599543822 2.0617853935895369;1.5576946219639274 -0.53709831099510419 0.67721937306664615 1.2715608611802589 -1.3310286906776934 -0.14674067871059832 0.15544807709106015 -0.34442712990972457 0.38908079068287638 1.6791095969998424 0.20834978197474099 1.2851592263293459 -0.22146683888330954 0.02577480428844147 -0.86507178972635168;1.4768433209470406 0.20856395719207477 -2.1614497348074684 4.6193112245505787 -1.4237397492085198 -3.4113426017018398 2.5995255266970436 -0.32180657054416478 2.2336153955518943 1.6384564620047075 1.1361297431137374 1.9250775593907667 -1.4885541230680204 -0.90282406641881596 1.7391826411432614;0.75183976836046051 0.61252118879770767 -0.50325617411166623 -0.24933917306429643 0.26014709703407152 0.58661323916549124 0.72938283376994173 -1.2323742601706791 -0.2555255771278917 0.092591496483577049 -0.39510800928734435 1.2065993921382223 -0.51252166276223265 -0.9791467747530922 -0.20296895629860567;-2.6163528163286665 2.5491325054435348 3.2911176533035156 -2.4153809434960003 2.2203102741679772 1.4203623254097784 2.9327048874680801 1.7917141718581837 -1.8440570040262136 2.5227339000780189 -2.2343696083309275 1.239532249114313 1.2926157727074554 -3.7247491860060666 -0.35520499358337704;-0.31619809549272493 -0.80686117028159399 -0.1236280278633201 -0.15815396384842415 0.75277521551765314 -0.92852401553163821 -0.37344581602288668 -0.37713898144354718 -1.3493423727461376 0.52639096397118101 0.25801131757327134 0.90375064955670714 -0.48040579575775233 -0.22786004263611351 1.0391623729509292;0.59171332842263269 1.2139207374862937 0.1706445533526306 -2.7500151546889287 0.57279473224361732 -0.2138036890990872 0.2312190603908951 -2.290731871888116 0.70624018998537641 -3.1528939681817767 -0.99103273156097571 1.0595294056132183 0.97889347464671772 -0.97309040770526678 0.38771521722748131;0.41770421935655438 0.057860418220228277 -1.0865180638853644 2.4882804184658616 -1.4046066810637949 -1.3471592622176138 1.5265905598954295 -0.38082845076193095 0.24326595170885532 1.0683524551220593 0.2051799200860665 0.22177297194564138 -1.2435426096718862 -0.027082451299955457 1.5180338689669444;-2.3021180478548993 1.5592173563817016 2.9871608876241846 -2.4648383040158506 1.6848816834923601 1.37063234211194 2.072758282812706 1.7705232772790569 0.1516293143767935 -0.066868722366036262 -1.9789726242355175 1.7374842486325768 1.3169872366721185 -3.3130057059430653 -0.54175910224963597;-0.91134460678927665 0.0046028833988379612 -0.62276955221190156 -1.0615500633918227 -0.35564114434460736 -0.63598108386572882 -0.13430246971027981 0.22159364970480114 1.4916665288884834 -0.96618481263725142 -0.079623497679513211 -0.15912978776842315 0.773057331024807 -0.17654509118807113 -0.11478365015529181;0.22828807633400944 0.78741521088372102 0.20289744577610355 0.36788139997952179 0.11256039736860912 0.82951856538981261 0.45400102881165694 0.58789924737589105 0.90239605232249565 -0.64426775537675618 -0.18166598272105555 -0.8055911938750151 0.89155249665921366 0.22443929953039979 -0.77694411006815178;0.21369469008114469 1.1707883611059826 0.60832601798617081 0.57152833406390458 -0.40266711322694299 -0.33436371731866366 1.5653218651588103 0.74218834041854254 -0.10657654152116883 -0.091312814905163742 -0.78630746060513113 -0.20153404960212387 0.21349083536300997 -0.0060692936005739204 -0.15796202262613751;0.26116346396192075 0.89086286425689876 0.12569218976460658 -0.046260128647020823 -1.0522745989478028 1.0273054484809034 0.32733989159468924 0.20797109636940084 1.4745824340582518 -0.39268303377420427 -0.31868286851656946 -1.0369125373123522 0.065799447037464459 0.27361060492578376 -1.1595343766633133;-0.90581216281583643 0.75695005090159839 1.0170088741167285 -1.3084138091237059 1.1765342062153046 -0.52132912922350116 0.7261409299644267 -0.96239090843955666 0.6432124838820662 1.256955992969405 0.79244347845091978 0.037610711298192635 0.71132041923581946 -1.0773657319531489 -0.48414318212876084;0.69291670950966622 -0.052387913229995899 -2.41023013876333 0.72876889479796436 -0.23051839024486703 0.041218361449531102 -0.81179913396978731 -0.46018449288418239 0.29672458800934409 0.34561200235226719 0.65388872703800149 -1.5329871504907913 -0.98022780106194407 1.5651778311937832 -0.90210547240836558];

% Layer 3
b3 = -0.35690287977667018;
LW3_2 = [-0.81603783993395851 0.16794204465685905 -1.5948261800208632 0.3565195927706637 2.7660772730370784 2.2759315650204419 -0.17154352860431707 2.1051818789894328 -3.2058816063554088 0.21916230705725825 0.93575981519536056 -0.051441114160684351 1.4485665327233301 -0.3175308022374706 -0.83978165449992237];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
