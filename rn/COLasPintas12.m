function [Y,Xf,Af] = COLasPintas12(X,~,~)
%COLASPINTAS12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:01.
% 
% [Y] = COLasPintas12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.241545893719807;14.7058823529412;0.0179856115107914;0.0558659217877095;0.00576368876080692;0.212765957446809];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.40743513797746561;-0.9697530240919231;0.84685826665416064;0.95064706776718777;-0.97250913632138802;1.1335041250748927;-1.5620316607561011;0.69882979474140083;-0.35308420031297982;0.52876947977791167;-2.0551093758020857;-0.74796134827426741;0.90078803704792199;2.9411605277052737;-0.95711315054818746];
IW1_1 = [-0.72817091173853266 2.0502530964804602 0.90355239473623417 0.07332962517321924 -0.73347617563036727 -1.3067116549215338 -0.12341088320794688 1.2214746943552395;0.76473081626926698 0.85064942691731693 0.035993259607747748 -0.26492857888142407 -0.87982774815142306 -1.087492776929551 0.010959954404238009 -0.8617461335120703;0.15763118722053682 -1.3396240614224768 0.48611516659395537 0.26869863301928354 -0.60099989442245494 1.4267986474952523 0.15464293892784281 -0.23856507648424818;-0.78798100442273922 -0.45896752716355543 0.22481953028198159 0.55510176266230749 -0.65457506783808383 -0.2256779694189299 0.10901696858626916 -0.074615764219203795;-0.42102647122333503 -2.3765322637140143 -0.9241254863419458 -1.509375046409043 0.66786566584801721 2.6488327859616092 0.41228029674428901 -0.56182667971153999;-0.026620635461045417 -1.3634626974444399 -0.73770017408955069 0.5053419205722377 0.56933666930184534 2.6729837628401181 0.96747044731673226 -1.5057970399853131;-2.4922989591929126 -0.25696638821577467 -0.054450792742230331 -0.5435441008258981 0.021296140937791697 1.2567002299749912 -0.07629938535479755 0.53531563237855473;0.43599984353620785 -1.5236639778551655 -0.32508958366187679 0.24997314858859093 -0.19113195121597548 -1.67740723999222 -0.030517821071755144 -0.55550787793332357;-2.1475790491448836 -0.61936839442867475 -0.20296798929216733 1.4362334655192701 0.87131675324293756 -0.86795184126641101 -0.40098779976743482 1.5047807510216904;0.87911937089089631 -0.84824476519039649 0.16102014340218149 0.39119113434943609 -0.70487088144352938 -1.1066386456823556 0.18340018191081758 -0.33156648200530553;0.38572842723126233 3.7191313263392587 0.55321614497287808 0.1827720481185732 -0.21372158718493017 0.021146848019657778 -0.16509808671072243 0.46146325194219318;0.45878761859026451 -1.4319258524998213 0.11671814200855136 0.2938377190723484 -0.25745268316199976 -0.96122772713948024 -0.11761490613127687 -0.58664703073985314;0.23763748009250468 -0.94836792187586816 0.053056640987169577 -0.7973439431744298 0.50162548447612676 1.6885466144743702 -0.00017672866818820542 0.36375380014957659;1.2565817750550068 -1.3192846012415811 -2.1546964266103572 0.6548284517327625 0.44604557562507335 -0.62959207471890832 1.339160058247806 0.60402165053596202;-0.21193569006716251 1.4721519771882883 0.42743849938513256 -1.9466477248745779 -1.4495112086568795 0.9615962896669813 -0.35741061844202765 -0.39864077455287911];

% Layer 2
b2 = [1.6672477215261146;-2.1197727484712328;1.4573105163212616;0.49363165113635671;0.95710681910923101;0.15690992017760613;0.44485174077349215;-0.032372116878726737;0.52297109335734593;0.66215341094514546;-0.8417192752648387;-1.1084082323576603;1.3233136016979501;-1.1601155621969184;2.4909952715027481];
LW2_1 = [-0.48842123070413945 0.046525388781229145 -0.92838151219908727 0.041397902896551618 0.34992582215039647 -0.2154444178886073 -0.44396570127312407 -0.11797369875809613 0.13537811276824546 0.52446629153616686 0.23751581449594589 -0.074124536117899598 0.12472026580123652 -0.7847945219660527 0.327270884192846;0.7418447395840424 0.036649849393426186 0.30230167418497739 0.49473337403505124 -0.11993120921728047 0.39572615411257922 1.4750321203453463 0.48535316015845542 -0.12223419674543679 -0.40831787380559864 -1.0070484975762382 0.96876795796529758 -1.0620904441904504 0.74750250180156452 -0.43795211575501869;-0.16266521867263195 0.28849317846100014 0.19019676231195728 -0.56285233471583551 -0.0018196430466872009 0.84597803664115201 -1.2616189241761337 0.95800039704120743 -0.99308923221389944 0.47394499438962356 -0.1704811671367947 -0.74393349735811976 -0.047053620549989496 1.2589522625861882 -0.5473018931890532;-0.47921288733236223 -0.35530194230969114 -0.97831534960658773 0.1820707297182807 0.18108297495144668 -0.15123588877582361 -0.28758179506557013 -0.17411929273850527 0.4056007165539407 0.21348639976958569 0.075268245784570489 0.35662608824648601 0.57206948074317943 -0.091614411792718467 0.058408433195886796;-0.25999673728509687 0.84412754832409731 -1.1970533392868064 1.0801039625048008 0.03649760618780748 -0.043436223234835036 0.27161370390709838 -0.4575103585553037 0.056733300416136459 -0.77028110009897122 0.47917140638117206 -0.35837609458898545 0.93632733722077865 -1.2561635175937622 -0.88461573531965609;0.18218594523058251 -0.47947812410073631 -0.1638802289496403 0.13757307816160752 -0.0080079631557318058 -1.0848505284124683 -0.44481252278642358 0.46052970499957585 0.32647945856494198 -0.83723670476996248 -0.041499258631962785 -0.80891822987297091 0.54043214848083987 0.76180224648958894 -0.35995817480880937;-0.53142836823261086 0.55928843950444984 0.25427342728705715 0.15369138755365958 1.1865218775274233 0.80115050297224732 0.1834652579735617 1.0292562537245384 -0.092981912812012263 0.037298737668433557 1.6442763272721521 1.2496915433608853 -1.1108807845589042 -1.3507141575929307 0.28414460930502267;0.397501896810317 -0.98532464849343426 -0.7663763790625957 1.1728498492663404 0.74369994576366727 0.49055724133356771 1.3317523254323389 0.43833955064371855 -0.24113403855852605 -0.56811042903595299 -0.32215460757058434 0.56920746849964321 -2.644440853094042 -1.3012126006191604 -0.22893078382900178;-0.46844664130717095 0.88395953105143832 -0.76247741675324454 0.77423094384791968 0.42424504958009468 -0.40867771485594534 -0.10142452047606303 -0.69306043677654894 -0.26570773443863455 -0.91326503163692507 1.5823880180444836 0.52002542900686555 0.04072455473665812 0.32213049068521471 -0.73837045898698173;0.56914622887850519 0.30010038110086124 0.82561850072696774 0.75149254400287624 -0.75502067477424506 0.1295789971387693 -0.89511866364360038 0.81364254765827837 -0.57650112108707785 -1.2917668222526215 -0.33234463934265107 1.8573648206910751 1.3934395297803093 0.78336081596813956 -0.49360452942960137;-0.52272010120129797 -1.0959651081940542 -0.24697748694828853 1.0122225106445104 0.21938249300509347 -0.40815641766453004 0.22035917509370992 0.31536272009304822 0.90419135887537083 -0.032858679829325957 0.11433660060794865 1.7087291861028451 0.15186377718723065 0.92542234426288639 -0.41379478292110139;0.35071405230220049 0.34851386605206774 0.18498979287158923 0.2630661742856914 -0.36294262186330017 -0.01232381188011035 -0.037333210796365181 0.87485436352488788 0.47860122444272718 -0.43046522064173443 0.78899839207615718 -0.42328917225246909 0.17782401893602912 -0.19587749220476758 0.10400132784617834;0.92413471290578486 0.29533505576908237 0.17525517721018596 -0.17478457809983067 1.4577340896478219 1.3871995644991668 -0.38965214380463836 1.6238064673225954 1.0323632998561667 -0.31299796348101655 -1.3896492065909294 0.26114908253216701 0.93504075092953898 -0.24939626527560793 -0.23755443247006541;0.48202579031832998 -2.0562629016415195 1.332429239189675 -0.20250967085903898 -0.43837870481151142 0.41085800913579351 0.58761331320995158 0.51150200130866885 -0.12685266743882317 -0.58697737877344514 0.040552186926244738 -0.47557173926299856 -1.4032217364460644 -0.93687247708795462 0.10296765355272836;0.47503044766960756 -0.96327916956032933 -0.23937783748018684 1.0544879910734917 -0.090273515404461657 0.021282439888201693 -0.35224210692823055 -1.2538716463746287 -0.25401045685690382 -0.20683008917371168 -1.2021241762313022 -0.30525702453413384 -0.80968953909640673 -0.22687388944761472 0.16220779487722389];

% Layer 3
b3 = -0.81989453569418402;
LW3_2 = [-2.0811081906796791 -1.0575639698245065 -0.59932911417964529 1.6147060856790854 -0.752154157604497 -1.050080869096603 -0.69360940786370473 1.1594988364544863 0.82232496990009729 1.6926247243522954 -0.32551377834217093 1.6345697029163142 0.45486675123707926 -0.57428522558205741 0.82704533444006501];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
