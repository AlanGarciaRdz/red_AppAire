function [Y,Xf,Af] = NOXCentro4(X,~,~)
%NOXCENTRO4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:19.
% 
% [Y] = NOXCentro4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.74531835205992;15.748031496063;0.00773694390715667;0.0203458799593082;0.00627943485086342;0.132450331125828];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.2786174608261405;3.2155808110400987;-1.849240636176128;-2.5544596547308185;-0.98442755978656926;0.5637555780167508;0.11248708524461054;-0.037457310234571203;-1.7769966322406214;-0.84466048178160935;0.77145833238899231;1.3289175836830853;-1.0048254368322387;-3.4482586824659371];
IW1_1 = [-1.763863824982828 -0.26261901732727866 -0.84341597563799486 0.34683026804920569 -1.3305801550010978 2.9937155713126309 -1.6138866944700665 0.20260983336627369;-3.5610117487647446 -0.48841926692853244 0.101939092035069 0.67601041136556317 -0.039570135450298145 -0.43557721432357488 0.22886311489776931 -0.92010283313421992;0.22056851041060327 4.6720625038784824 -0.99992388368636331 0.26853570463013449 0.75918688826027036 -0.48852169044458149 -0.098025629026729982 0.093764338532053834;0.25044007423477183 -3.3213960831522105 0.20070006651415653 -0.61020638574951025 0.23453324785785087 -0.21161442176626927 0.0043776700828248079 -0.34906496028677525;0.97361279818476387 1.6395238418924702 -0.79646635217972273 0.21187873811398353 -0.33884732650369553 0.30353624158887577 0.19672443379335797 1.0097047154693473;-0.15382904806084496 -0.57735757844794078 -0.66967697379501989 0.63236889479112568 -0.33909065282801298 -0.54887818474578431 -0.34171548336491275 -0.21390289912816332;3.1177081470777996 -0.35655072672401983 1.41504963433431 0.45968249970103553 -0.48249303692458606 0.21639712787284221 0.25608175550086659 0.92820700499621733;0.66849737898789496 0.81338849398138058 0.73183579276074573 0.24999824564638834 -0.79383726643357244 0.87109916651272545 0.20058044531973565 0.83267934377512764;-0.6409729794256428 -3.6087156044769846 0.0051982289484252316 0.20016555834494704 -0.040204602232326594 0.30970846865498941 0.27217035946406659 0.42518018876437275;-1.2144653236149867 0.21375347033081857 -0.77673181070942532 1.3057371457654321 1.7420908580408392 1.3309824242580348 -2.5827584344318724 -0.052118423673163036;1.1523052334723729 -0.63087477260016156 1.2105236306002329 -0.89243418943196962 -0.57575952176018919 0.51856586404964788 -0.10064700848792105 -0.25126577036789044;0.10115937081261639 0.12999492353445677 -0.88635813899484861 -0.5239663379095616 -0.80068803617812712 1.3097771980006883 -0.90117933660038607 0.68244196204527963;-0.10756750117021197 -1.1815329238001655 0.14539365138325025 -0.13013080230225993 -1.641549594545169 -0.071054355272677672 -0.49651563757601352 -0.17406697420708869;-3.4197807018775639 -0.70812755251351678 0.58903189577569648 -1.0422642526269652 -1.4595809256694701 0.38340760763844095 0.25863367172072327 0.38067357199366103];

% Layer 2
b2 = [-0.070936262983152157;-0.31259584515039512;2.4397009144705923;-1.3134935305769582;-1.4048279790491904;-1.2530624471270775;-1.1919531535119374;0.11275784923924972;0.33044440223294103;-1.0393281207570266;2.0540914589121897;1.0085821026562971;-1.6446155845815804;-1.6310201174604855];
LW2_1 = [0.1414516725536778 1.2956191939208463 -0.70922958461872787 -0.3598827887193472 0.263515166219633 -0.4305067813406408 0.093972119745083932 -0.23781771444555277 -0.45505687044039439 0.012646814516255954 -0.27080114320661375 -1.4581226508139344 0.46029889048237438 0.14617227896885956;-0.40946210615346756 0.46859266146435846 1.4009006247512896 1.0814397098289894 -0.60934487940943993 0.18968821226906124 0.90422149852511635 -0.34960887447852151 -0.82804241924488076 0.04184758393882633 0.30200514418963215 1.4800244485708309 -0.1586791976546712 0.71546623605188986;-0.076010251053925268 -1.4528667345105584 -1.335240558492452 -0.44821561930123599 -2.2445140463627227 0.48457564788253499 -2.3107568974870212 2.1305419348627845 0.30929473971804089 -1.1759261262148324 -2.3480785647953319 1.0015188054197983 -1.2659348017696836 -0.87448820853476961;0.29571164251704252 -0.32736761171324247 0.38019821459286662 1.5246476119005083 -1.1589466723339046 0.039613398353705503 -1.0376266482214407 1.1434202110879579 -1.3162700802300384 0.11323283805032033 -0.60116284006931275 -1.0464662503042359 0.042982260835643896 -0.70740708831864985;-0.049790112842339362 1.2052981430773613 -1.1469000777134675 -1.4268008357369137 0.56915495119219262 0.18542868302251828 0.3513305367711585 0.059679309327160909 -1.0651446780092562 -0.19553426766452314 0.40127150213692936 0.4581621266701531 -0.93748243041277934 0.04828630558707165;-2.1897803511075034 0.05515270558427679 1.3661195406584075 0.8752259763221607 3.0075740014794983 -1.0923188645222353 2.2996119542304974 -1.3607430202057103 0.026444296566873967 1.6387991979747216 0.12494983939151719 -1.7190940034447679 -1.4171895463397199 1.2725555432046003;-0.37356962583974884 1.1504640043861822 -0.857336572712464 -1.4868090085797379 1.4040180594428389 -0.4718489057805228 0.29818857351694167 -0.36479498314725828 -0.79495336634289293 -0.043077666922115024 0.54638574105248217 1.078687623058459 -0.348628852431007 -0.14751220990701336;0.82636628145627933 0.6301080628163962 -0.89462656314720734 1.3475324819125161 0.81076636789296752 0.038991778730547225 -0.092660437118971761 -0.49734290109447293 -1.1837611238877868 -0.33823620251578362 0.62569597803320365 1.2662943415784473 -0.48341955311893869 0.87608354452943615;0.21499070911748241 0.05338175142338647 -2.1609094249499918 1.0825424871292637 0.54648317542163849 -1.2193942542733074 -0.74063151218832346 -0.039958484897161792 -0.23117477291407224 -0.50660271815380986 -1.0166741127651735 -0.50009133404567985 0.91876271794513031 -1.9487589226118194;-1.8000901186914429 -0.88523947092014466 1.3415878871460736 -1.3053399309158071 0.13991936381773609 -0.82927391460971467 0.8883558429431283 -0.55401309072347238 0.49963472720765717 -0.44791882578821218 -0.83180906523262299 -0.12284984725455445 1.1095251625069111 1.2158358326268208;0.17847407131356977 -0.44260179561269974 -0.92672630570603209 -0.043210343020586815 0.84206025031636655 -0.55834616934713688 -0.25540360992572991 0.12220707774320275 0.25095423948744777 0.28792904051464552 -0.82078803596818495 -0.71812270151738988 0.43262348166123377 -0.81655270227558807;0.20534211685140907 -0.52122455405602031 -0.87810698701976719 0.45239903510482238 0.72209776971005746 -0.5599501712229783 -0.21441059187438838 0.10008448119600905 -0.37849005527707441 0.20682316729823422 -0.72885643004655798 0.17110820613374261 0.41463008201407553 -0.82399627411262488;0.17406370089992765 1.2919031132924979 -1.0771745448973995 -0.44789020154230125 0.47343748659114332 -0.61186281062612868 -0.02981991504074176 -0.34435350776204243 -0.60805279569024173 -0.039557648128099955 -0.35440146641600467 -0.54593357658161767 0.5735086213549474 -0.03858745701808846;-0.0021908883738686047 -1.9578535621942261 -0.83946904121430255 0.633337390315311 -0.94240378514139966 -0.43562371954528045 0.701976028067411 0.095278728874578486 1.6582275480369395 0.45702977802206224 1.5570779511509543 0.38425718355792821 0.069943168013566176 2.2922424918803417];

% Layer 3
b3 = -0.061202753582820214;
LW3_2 = [0.9123294181507795 -0.23196815099679433 -0.93844833717852905 -0.90997527343366558 1.7419989742972273 1.066727127390287 -1.7837832120077599 -1.4971617504774883 -0.150695065273559 -1.7640689351719185 -1.2262716838304122 1.3367595250799122 -0.85660077537447232 0.12198306221380555];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
