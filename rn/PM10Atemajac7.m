function [Y,Xf,Af] = PM10Atemajac7(X,~,~)
%PM10ATEMAJAC7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:56.
% 
% [Y] = PM10Atemajac7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00968992248062015;166.666666666667;0.0561797752808989;0.00614628149969269];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.7421874697642861;-2.5266642183573813;1.6293073223178944;1.9526008510202777;-1.8755779260535546;-2.2324138065276027;-0.51443580121029031;-0.37620520489087211;-0.36204379847383855;-0.86015759453631391;-2.4274313148168161;-2.4753086094192578;4.0852169031086776;-1.8821506281142348;-2.2444622860706871];
IW1_1 = [-0.99541690628961743 -0.034452224997682662 -0.61309974821293467 -0.78038760896889725 2.3340731949102 0.39732484611778929;3.3175164983471008 0.8263915258446034 -2.0324568356351489 -0.89414202517655661 -3.1965593963578214 0.62550401621428753;-1.8849867152435711 0.20965306207391904 0.8118461683379995 -2.9414013452962173 -1.36141855029423 -0.23407028542620803;-0.1801540648303297 0.47829253667663685 2.3974686198572397 -0.10600018431811356 -0.37186435388195083 0.10671248932916005;0.87151321743725385 -1.6487156944554644 -1.7714206382379176 0.23700075777686505 0.74926793682684922 -0.11865105777408202;3.0537622961999542 0.18698495923710581 0.23511030387143109 1.0780942147981836 -1.7673131541300489 -1.0025449612247204;-0.74440184484981298 -1.4316296952548915 -0.16625817723650441 0.034045181627410742 -0.27930806821308241 -0.041369151114433823;1.4718012878179034 1.0451058648777336 -2.3289181505314471 -1.1894180101601193 3.5816480019404953 -0.0020753955073938299;-1.1599798896854565 0.17058473782110209 2.5028051833630043 -0.66150014573529115 2.2259732735544513 0.34672252309408136;-1.2576261635059938 -1.8068737531949635 -0.64277220438509097 -0.75425248284479718 2.4735773433452204 0.45841164786052102;-0.79257829888168829 1.6196353990631465 -2.4922573297882251 -0.23688715685520828 -0.6618615422373294 0.10158181615887668;-0.43926203733018881 -1.1715662422863433 -2.0686028577244042 -0.18560659419062664 -0.44264364595097505 0.051949717346492529;1.663493390981102 0.41058188843648075 -0.088616283008376581 -5.1048104546881632 -1.4905061955500296 1.0448101974803119;-0.22482218367927098 1.2165175808189246 0.95033340059074367 2.4888123131085087 -4.847685306732612 -0.47433358210723697;0.66686764782800667 1.5474540426320693 -3.5772671839716725 -0.96115706199951012 -3.2772528492099906 1.1903820362462778];

% Layer 2
b2 = [3.0435275730108793;-1.1892620595896515;-1.3592217583355768;1.5593307371849443;-0.3459652307005503;0.39650761211334873;0.62927750046983233;4.8461200074188353;-0.15020364017444135;2.4834464277903687;1.1023799464268413;-0.23149491223889221;-1.3794650294231914;0.10401068521195023;-3.149821523031485];
LW2_1 = [-0.34253815618055639 0.3201924492026853 -0.14495339933725268 2.1532101893025177 1.8854754702955838 -1.7404570261452288 -3.030802001659477 -0.39752744995417866 0.96451299350391462 -1.567945756164064 1.1982515218122824 4.1344500687608594 0.074814155468438726 -1.0059355415876055 0.10644021820059876;-1.5474476839668403 0.35761619327171973 -0.40401685869442622 -3.4275586544237835 -1.7232883673073174 -0.18479223098408065 0.10118611504788566 -1.0629038471431689 0.75575851361084023 0.49745559603931194 -0.47181295463025585 0.26247626063286617 -0.34420622936169343 -0.18409169362310551 0.33237171987437253;-0.043889789376717329 -0.21177612092552031 -0.33040786277244993 -1.9840695924977021 4.3828594262518381 -0.72252450353189723 0.63378241987617889 0.11756902441899687 1.1177692541163116 -0.89903588685319347 4.6976373444730903 0.31526726827292884 -2.6486542808829112 -2.3167860359719143 0.21323205552580315;0.0026432405348698193 -0.2756490840064702 0.51707298125482803 3.6273811752761542 1.3389023708408223 0.66291922125907676 0.45293451876770319 1.2565509634866729 0.21047962496354622 -0.033126455143988938 0.92827792142163823 -0.78445906655608721 -0.55205738327786857 0.12649048688225789 -0.47186794231252172;0.10438296336937664 0.6674348632300674 -0.24106702763323634 1.0558652798722035 2.3831534228687223 1.1097508918331405 1.1563952490256915 -0.11268809217377063 1.8879775733408659 -0.25470480546461227 1.6979062873726536 0.49258380975206456 3.5263972862180624 -0.009345378882762042 -0.78832134549095256;-2.1512683793666523 -0.22698453741528776 -1.7399211678368083 2.1478218380434546 1.7993678881117268 -1.1264957554928634 1.0697559993074792 -0.07072325680336139 1.2450883512946285 0.99587163506455334 0.30349735352807239 -0.73474602610244655 0.73794431517513814 1.5364671875270191 0.23636898902583786;1.2976096741111438 0.55250967642806159 1.5562378623431987 0.61501293792790335 1.3846332451879202 -0.10108285462095418 -1.3390064050714074 1.5657124856535514 1.8037544886791033 -2.6243872120783482 2.7790503586540685 1.3982767117185375 -0.69592357300196817 -2.7404971267210088 -0.16227867378692507;-3.9567058029862401 -6.0402013466494875 -0.077784154558408258 5.4763205742169863 2.4272009781838846 3.092950403531904 -5.3887604805663987 0.080086100277806896 0.42283439423862074 4.1015116582426563 4.179678328283023 5.6794694048423375 2.064443470480918 -2.8870534953530465 1.8284522346895815;-0.31008211819922615 -0.65686486379049247 -0.52936087208781546 -0.84035602520496089 -2.6534532542386562 -1.2085200244682033 0.023603062119055579 0.57153743844634397 -1.1295858965667924 0.13241914597550408 -2.374101234429475 -0.76847801132213345 0.092539783147410334 2.6874573990807344 1.3081214949687805;-1.788916258229827 0.30811817728307783 0.93034232352432678 0.56675394609786367 -0.69665767867996686 -1.3215032099354469 -0.78339396154340868 -0.58551154007052753 -0.099572961547070488 -2.3503128249324057 3.5448649725165353 2.7688202487726317 0.68219119321335875 -1.1072837963839055 -0.30144981278843896;0.59841981893127816 -0.0968815114911937 0.60884940789239628 3.2500006056391584 3.1826182164397059 -0.74890730887621859 -0.86550009198132694 -0.15930519098765522 -0.096143862119661305 -0.81366562079231353 1.5374004691772385 0.53739602542094156 0.91366140372247406 0.86180882615254417 -0.061689531345613113;0.69438598140288899 0.5831145703800692 -0.7311441216092478 -0.56492258502623938 -0.1733802372463602 0.36053047630294249 1.6183435095370451 0.73992257760304503 -1.964256511084657 0.053567224432263999 -0.045126532464240796 -0.63695431526578505 0.61939074053384569 2.4576536421419641 -0.034664348288361069;-0.83923583708158189 2.0750499351076384 -1.2201653928600784 2.1295517986608927 -0.04993383680211181 1.56039497674873 -1.9498104852116693 -1.1842768356730888 -0.5066377150460234 -0.021900391689849349 -1.512500665090224 0.0031950893739882535 0.55693767567315056 -0.39838912386246905 1.5865161622976751;-2.3365044770524488 -0.4152558799087408 -1.1298353935168362 -0.69641072008519334 -0.060176682381099023 -0.14656328836580676 -1.5615986567668443 0.01765145794529057 1.5841661228232977 0.55856394229849793 -0.6017477148466579 1.5361013915709203 -1.3499516292754015 -0.67174456469344368 0.54940168391836264;-0.60852624831592272 0.30056655168355673 2.0245564796749069 -0.20378378427560542 0.45636562347382181 1.3474434205868207 -1.0833845384638416 -1.7902437066241523 -0.81498220462897675 1.8654527651792916 -2.2488963631380452 -0.38792501348523345 -1.2096752386675522 1.1226840586952105 -0.069306472266480457];

% Layer 3
b3 = 0.84025391280291928;
LW3_2 = [0.40046404282754605 -0.6730412882980219 -2.0764007420952253 -0.52492065494735951 0.42360062530774745 0.26280485528629932 0.19998632595491461 -3.2953805511208278 0.42959829628412288 -0.40427672685296695 -0.47568665482051503 -0.22661796615376531 -0.00015033623046078548 -0.3109251833564487 0.60059623767129156];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00968992248062015;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
