function [Y,Xf,Af] = SOXSantaFe19(X,~,~)
%SOXSANTAFE19 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:52.
% 
% [Y] = SOXSantaFe19(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.8952795437968066;-1.6376302884921579;-2.0805243298258906;0.18055475830464549;0.62480994216400476;0.082129486869707183;-1.9029894075823228;-4.2977637812712706;-3.732047367549431;2.4349093026135016];
IW1_1 = [0.83059573285391353 0.051088532420650416 -0.90374665607380444 0.50627276387618103 0.87534406589236002 -0.28183991090964755 -0.70406812780346362 -0.13285899332922194 -1.1431702129863643 2.5473209436703312 -0.19031155273402051 -0.78355307510803396 0.4732615643757776 -0.081416861995115025 -0.65913740860863823;0.20332716578239063 0.07136922031722534 0.5679265971148979 -0.99235145578138084 -0.002543714869132796 0.16403618414109028 -0.81775022466244307 -0.081704489331623706 -0.31802506862455165 2.8930049688279134 0.64497003965786026 -1.6729153133531696 0.39116859289849509 0.12488902196352847 -3.1743219669790967;-1.0909824915439617 0.19456036786360223 -4.7265183354469533 1.3674119669447411 0.68688027797924489 1.3611987418398539 3.8851556915205609 0.35707452934392292 -1.259504193254209 0.96519180327785159 -0.49385494195030782 7.9876637284291503 -0.85550453176579211 -1.9548457096614162 -3.794026400814785;-0.45496632542285154 1.2278311003652049 -0.76353335084866003 -0.48663699599981913 -0.34727594776892845 -0.090561866584141046 0.73138837408435364 0.85788014268890522 -1.1726428239079931 -0.46655674062814134 -1.0175255836065729 0.41188718129460483 0.21944366801942955 1.27947359621626 0.011270323677270051;-0.50121146511403059 0.11803160718751714 -0.15039258526272117 -0.54912100054488633 -0.40064409491581987 0.10677644361165776 0.6424923363973426 -0.087364441468048018 -1.0365381361870012 0.72443174798364662 0.34853980066910539 -1.9157811295766658 -0.56605338048092946 0.17297810955666715 0.24160987227424777;0.79941701219707728 -1.6883792318649278 1.564303562537225 -0.95881634076959477 -0.27917069430058727 0.035413119743228083 0.80384409870024076 -0.87789147524334044 1.1955286579985831 0.18736674222420835 0.55452613827491759 -0.049007883056964713 0.1628661030273218 -1.2829916405470141 -0.84953416520338043;3.4382247430436359 -0.011218788496613088 -0.681414664405398 1.5687685047601077 -1.0668086003050861 0.31923903865437142 -0.48876434569528976 -0.045282531909155814 0.51840375322529308 0.26767788361627665 0.59157431967138219 0.87602847949007956 -1.6863900249494788 -0.13657860193969462 -0.5761282225257911;0.058128784349505601 0.017161751528007949 0.14372684365128321 -0.2015366347839905 -0.0023742408890806794 0.024068589540803906 -0.19969512965731304 -0.019054295513688507 -0.080019967835611702 -3.3649482801395845 0.14260729143201975 -0.40079722350272373 0.065775156497515072 0.04733347827623699 -0.57459516210139661;5.1263770967865163 -0.34002460197241419 -3.4189058810359514 1.7504757502192017 0.65811038289350443 1.2166589270916839 -0.32823119488869046 0.61412070964266408 -0.42644529658792518 -3.433901232621472 1.0065835056089749 7.0418350360061828 -3.3438315771178235 0.045063671758444515 0.023382982652932698;1.6436678931200583 0.21411557739914105 1.1204464757941006 -0.39060580176336823 1.2992047115968746 0.86904376099251723 -1.2107929819969501 -0.39967377314679392 1.6155049259975522 -1.9101229606852128 0.31295010468259898 -1.9997323174420483 1.6925021987930651 -0.76211098217894757 0.21687306341451032];

% Layer 2
b2 = [-2.1142356856837123;0.84715671307090623;2.790722029503566;1.1357080580542307;0.96374211143499811;0.81713937286622396;-2.4813793958034567;1.8396498218617565;1.4395473617586698;-2.5733631392050271];
LW2_1 = [1.02332753332119 2.130026109999692 -0.10651304616716423 -0.47191346394408262 -1.3771199111550001 1.726153170677031 3.2667766392037239 -0.18364828615526649 3.6967776187673205 -0.43917132649856838;-1.4155807152554807 -1.8494337620984429 -4.8781325300134704 1.3283982235909504 -0.63400239330871577 -1.6999453583070288 -2.8744611616314995 0.32231903641794507 -4.8592255836348475 -2.0317620812167183;0.63897223472539255 -2.8760161190547588 -1.0624182395773789 0.40183865852791123 2.3856422353134628 0.22007656850438756 3.1229481226743991 -0.39133228604500953 -0.34309104365237142 -0.077439888392327516;1.3570432573054014 -0.2339980354078752 0.57223866568318493 -0.85935578004585222 1.459625522686669 -1.2299208987454533 -0.21103011722698045 1.8849703758330099 0.30534208370697735 1.6371303094921321;0.16833334369428291 1.4299238687140388 -0.18834644918849752 -0.16981470472333887 1.0059911429347634 -0.091521382820769326 1.3436810274130513 -6.6178338918932047 -1.2307916917879489 -0.14534479581351156;-1.9055311370953463 1.8050135763287187 5.1511238691768648 -1.0116146737700948 1.5209977127920811 1.680982928371282 2.8666330487388429 -0.41102777019518261 4.428102358714713 2.8475522907286503;-2.0105863760751173 1.8818371511441907 2.1020251570148325 -2.0820091249378185 -2.0817940188286661 -1.9566551965017986 2.6753572244853778 0.95546666458900387 -4.6388873863989479 0.39721638186594282;1.683437984284935 -0.94845517727881923 0.65529874115116793 -2.6730490240237894 1.9568639712640552 -2.2170912668121083 -0.71844670798548449 0.69906769784816691 0.72169033166769991 1.9395371545340427;0.61579225468104193 -0.5539249536090225 -0.2830590921497686 -0.021799291526099884 0.08670786287836027 -0.82560021155022423 -0.34662074921401209 -0.91545364146887642 -0.51129931806797346 0.56479053750628816;-1.566502170222388 0.89292546393515027 0.93855566819246228 -0.15436059094060642 -0.3159232946087645 -1.1233339549647863 1.4400066583615958 -0.19082348499578536 0.10257035640049961 -1.6704639541300439];

% Layer 3
b3 = -0.12892867552698661;
LW3_2 = [-0.90798750542301854 2.1811734584067612 -2.2836024879749828 0.87853454530657571 2.8613239073034715 3.09793249962497 0.98945700239324086 -2.8386541478849843 0.10399560492051181 -1.474370232461695];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
