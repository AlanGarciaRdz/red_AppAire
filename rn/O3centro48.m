function [Y,Xf,Af] = O3centro48(X,~,~)
%O3CENTRO48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:39.
% 
% [Y] = O3centro48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.281968137600451;3.74531835205992;45.4545454545455;15.748031496063];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-1.6862768540532409;0.96209220060201861;0.83341852735944311;-0.15434938118697297;-1.6706505893717951;0.76069335929368731;2.2930110631805896;-0.62349205902796223;-0.77818577959733182;0.27277356473755432;0.12946458098486291;0.88399833266268857;1.9033219490046642;2.8108322005649007];
  IW1_1 = [1.2586523643306078 1.2576796898000935 0.16996386004773567 -1.0740294496995872 -1.0401257891507827 1.4026589790947859;-2.6914714883248516 0.37987321561565146 0.32950065982622728 0.04373251186779277 0.40556391602128672 -0.18342060107205405;-1.2836379454891198 0.89988321996667697 -0.14984391735814911 0.33079109922653144 0.042778267033686826 -1.8418452515977395;0.22078680077565385 1.9091857855403711 -0.090261660598188007 0.19156421181761313 -1.2753482719039442 -0.79706182146740001;1.0352366751093987 0.20268517941352937 1.4290395798696618 0.72563195830519911 -0.020069767946251565 -0.022212525098146134;-1.5189101599640285 -0.44392476022214222 -0.063169926852181049 0.028505582364529457 -0.073532162902982035 0.27011745838475815;-1.3903368515159829 1.1159765285387506 -0.099403537993487431 0.2021181340914181 -1.0307482690622678 1.6564016094919536;-0.68685529906716347 -1.6055595293097835 0.69976217675195085 0.12214644951104082 1.5171236932868517 2.8578409182135984;-0.30712169031047254 -2.2793481564110478 -0.73491767653619722 -1.0963944207942846 1.1636607042368527 -0.25833435999712401;1.5120889841212608 0.054763093322024753 -0.069642362122798812 -0.37799869048071244 0.26324054143514231 0.84496097527788239;1.225717434687666 0.54805805975597766 -0.16055692737936592 -0.28386317434519243 0.28776783454610688 -0.7501931065857016;1.1274397408370058 0.043491191697612792 0.13252263235957307 0.28094421319223573 -0.25730448692413904 -1.0516919410300718;1.4785366914421045 -0.9274209998463786 -0.030595990315212714 1.4294385708363231 -0.19219027629957747 0.14646831914853492;1.3357505874562789 0.5165286893135892 -0.41234102082390922 -1.0204703846000502 1.1185486314623356 0.83849155287993393];
  
  % Layer 2
  b2 = [-1.7727783439295499;2.2332615160713227;-1.1100217267545422;-0.26252919559451537;0.2272601767376676;-0.2462141564199031;-0.0080119102481119656;1.1801073382511342;0.90374923823327147;-0.83298664373337805;-0.98265822908455136;-0.68628393393986598;1.9284903944682439;1.6912456068326263];
  LW2_1 = [0.2530269649388644 -0.48285735626264159 -0.28362640186630839 -0.21564517746835646 0.010176168604058941 0.89274572467684621 0.86479963427436757 0.084005245952093632 0.76848396448584655 -0.072279947718995735 -0.044716277717624937 -0.012845094821881734 0.66232627880263217 0.10127064622976301;1.1589452097721007 0.9241528505427884 -0.29480284462994627 -0.53468651936744005 -0.50233559675412542 -2.0755574280287825 -0.4366267765474911 -0.9968560541939494 -0.40201077576007038 -0.7866994429974864 -1.6145188485459672 0.79719571675150491 -0.60028385805769102 -0.050706462980111798;-0.3539862660222215 -1.6965694662037545 0.83113525176509717 0.29316433788302432 -0.24972990763852346 -0.16832650661814602 0.24874115286949736 -0.11400825994413236 1.183503339102461 -0.78493767025125294 0.083045322529428242 -0.19247634123209181 -0.79772576248793248 -0.15567437223494612;0.78186070743351366 -0.023911163719164331 0.13012077460203561 0.048773995675750061 -0.65755705729520253 -1.7639614656705884 0.63688881403103181 0.15424853638639272 0.41187990197190399 -0.67994632893731866 -0.95699253057974221 0.56895639948223031 -0.038016570054397139 0.13926493751947827;-1.6682441048971144 -0.40123203736399893 -1.4110504812487819 2.0423144482767759 -0.35398539465388457 -0.25947204179309907 -1.5839737206960582 1.1476137082403461 2.0914774117194739 0.023145000216480735 -0.49953541212647673 -0.56667845543331208 0.83426499729056913 -0.35806416826883547;-0.78725688701167795 1.8800244274984033 -1.332239689877021 2.1004194132700014 -0.08978509084190045 -0.31557921223809804 -0.93773271107670109 -0.78558440210473524 -0.92593037250429178 0.66173973918622964 -0.53495474774431073 0.92397181243828208 0.40879223645750984 -0.72664556297068073;-0.73659757178224905 0.42518189908009818 -0.76623510087168401 -1.4707045652889026 -0.39748280194851227 1.8884638058756429 -0.1861704405695376 1.8441590451561025 -0.19464276864108976 -0.47188786302841312 0.11691263651157706 -0.85800023361045485 -0.89323083464672148 0.10864950087792731;-0.46012999790383025 -0.29219562484435091 -0.076989570758220938 -1.2482138536162795 -0.65784163244307992 -0.43867462199091112 -2.3707634743917168 0.42385667314726733 1.9610306075903474 0.8247959176413121 -0.70946779009923278 0.19831364451278488 -1.1939737567727831 0.78373596434806636;-0.628681776641838 1.3272835531590341 0.64182637260398301 -1.1387404112558832 -0.62302842820765703 0.96467644309394751 0.8344851848806677 -0.055754881304371173 -0.24407900300048541 0.95062598942552212 -0.61528193278715038 1.2628640436254823 -0.99180025213876544 0.010708437692248838;-0.14624366226982494 -1.0713986483097728 -1.1481525554013694 -0.53523779683238815 -0.32988767107694666 -2.3979809040496773 0.14472280781620994 -0.15383821496812289 -1.0704508474575536 0.29678669478283143 -0.69331356318391102 -0.3732426783959224 0.61565884783093627 -1.2555873406683886;0.52858211633071872 0.01779998392498456 0.62423454370006459 0.1369665040876443 0.42988301611412483 -0.33723827672136442 0.53231075448991438 -0.53836634875664968 0.74988962922749669 -1.0786103438661425 -0.1283324420391628 -0.43713838891601642 -0.31648775273363761 0.17270627757790691;-0.69908862877565814 1.3542228471516897 0.38711094869893381 -0.087418452232517735 -0.77520802610686312 -1.5203495723813671 -0.87773745744751108 -0.85720946451321756 -0.90843539108517046 1.2480500483336843 0.36070743281412931 -0.063526789224816638 0.49225402294835524 -0.42727532256767053;0.42303579382866163 0.15345085806802683 -0.67131347308635436 0.89130497095295724 0.40399362888519469 0.5853079445797662 -0.769841241876002 0.3302968715450797 -0.56698367241986625 0.85022096618746179 -0.24244416234657523 0.75709988425657926 0.5657500139939684 -0.21351456796880369;-1.0978604524036668 0.332923614563156 -0.22363178425494235 -0.52166094846351063 -0.61170667177436333 0.19245879510459815 0.49514421862156666 0.32612846413378538 -0.54603077688042023 0.70823835549384295 -0.98558780468399942 0.3560073353906581 -0.80052946200369302 -0.59605893393106135];
  
  % Layer 3
  b3 = -1.6162405755506131;
  LW3_2 = [-2.2108211550948496 -0.94537929677212873 -1.219444167777707 1.1711522677935351 0.81628418285056525 -0.85102170046125492 -0.66455604838968974 -0.67665896374416235 -1.8130339146471908 -1.0204421459523783 -2.0793932305177099 -1.4373722082495681 -1.994434039369033 1.8549222727371173];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 15.748031496063;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
