function [Y,Xf,Af] = O3tlaquepaque48(X,~,~)
%O3TLAQUEPAQUE48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:53.
% 
% [Y] = O3tlaquepaque48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.171659085057077;3.03490136570561;14.7058823529412;15.3846153846154;10.752688172043;10.4712041884817;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-1.5275726334353279;-0.90954805655331994;1.1641489162661534;-2.2594169620701789;-0.35464973118399712;0.21660912165978313;-1.7819642382497864;-0.5711327960963436;-2.2941380083715686;-1.1800618108040584;2.3766396670352301;-2.360877487293402;-1.3475867718259846];
  IW1_1 = [-0.20396465401482633 -0.69925574727450479 -0.23187931918224472 0.26245230952842841 -0.22847813397182024 -0.43976118417514365 0.025229170660309722 0.17629473978290561 -0.029150418582986233 -0.40887815749802492 -0.60042164535319342 -0.081057894699404068 -0.41797253488822189;0.31471617281389658 4.9887371035993571 0.94749754684575938 -0.8540879941634415 -0.94398147579831637 0.052142809873374579 -0.07005480294033703 0.29704781490554777 0.82729782846272415 -0.19018943244209596 1.5317373003166321 -0.033868069974229684 0.32597121045014604;-0.55767476228138646 0.58303040615779111 2.6535996002115354 0.24293982309213921 -1.7184712816432002 -0.23289229979835349 -0.29327900779940164 1.2866341842612945 -0.47168811430935764 -2.4415309260099449 -0.59970882824322835 0.93204798661639865 -0.44484293861339502;0.37541729686172454 2.6380980374936791 -1.2890454527273931 0.11557316181802985 0.40842147133037615 0.21462927218644626 0.8770535229810803 -0.40801223467689507 -2.591595576158173 0.33072701689087886 1.4384079244892383 -0.27145121259744809 1.0112996305748945;-0.88919677022538024 -0.57251981040872457 0.13421201001397476 -0.58918421150475098 -1.2044933899407817 0.68489328850284892 -0.26878115961943033 -0.079542779510887632 0.86484937462208722 -0.58885416589195494 -1.6244316281062632 0.51578436489988144 1.0206205955242507;1.8424769032410042 -0.16414768364727583 0.12758499297406753 0.054912159880363451 -0.092191928246797769 -0.085440686418676706 0.0135863719864393 0.026169885538923569 -0.085382558725476759 0.056307697190933668 -0.18828472777271071 -0.070586298207194642 0.031359833499755643;0.40677449307261587 -1.0625768589771227 -1.4889260888718423 -0.089730280029197126 0.47349616376612474 -0.18626049331491273 -0.38116806522133473 -0.2633422168160196 0.5550410402286059 0.98631952519917987 2.0700225859242432 -0.3802987276977936 0.688045641260844;1.7279060213575872 -5.0693097820868083 1.6368708798596465 -0.59680141657239394 1.3869785486670461 0.12534556551199638 0.68534577781900685 -0.50086194908908976 -0.83464900589433699 -1.2299688032804839 -0.90290860147297758 -0.76474932089888781 -0.97237340980999909;0.031274272338165356 -0.18464983194693319 -1.5518131839293945 -0.14510372209245651 0.033416954268546684 -0.18119763654201798 -0.73691258798545844 0.25231553402694362 0.026936218882650055 1.3674272263174398 2.3901578076223977 -0.59096025198898428 0.13624001313071019;0.39983670968786156 2.2846963824138626 0.71224955199268736 -0.81625874270941778 -2.621381171937192 2.1110568776684104 0.96171801105114196 1.0724999830516138 -0.073801051400070386 0.54285488716073615 0.58199605589133663 -2.1726089928878092 0.90046892230892939;-0.037975449334786054 -0.79017261149719187 0.056623428005898369 0.36171245056003121 0.31953876164224004 -0.35757215889341376 0.90292410024538083 -0.29314079844113605 0.78963742628639755 -0.18318615391397033 -0.7557186151764147 0.3883993493460155 0.090496025529583829;-0.92020439863189873 0.39832601517611355 -1.0497654479434102 0.028066913572198888 0.85711272419635631 -0.41207856351500904 -1.9282254345003689 -1.8524991325165798 -0.77797170758390199 1.4970378550340744 0.55412934664160607 -0.31172664984792497 1.51688506619612;-0.85500250362255759 2.8768083631789532 0.76858600354842954 -0.9094846443952771 0.7723789996199022 0.70360139743656025 1.2438467080514859 0.2893290280666847 0.19843876037824257 0.53784484586712011 1.1435086158036321 0.10092752906591733 -2.4041764009173749];
  
  % Layer 2
  b2 = [4.7889393409972847;-2.9263032959703943;-0.85300325679549194;1.046887833341767;1.6288698375435839;-2.4400971960886064;3.4266570482296945;-2.8595817714785232;-3.3601370981801986;1.0043936302704157;2.204366440511532;2.1793369541628516;4.2342493484385804];
  LW2_1 = [-0.15006354685108442 -1.7214561883468213 0.081363711739753611 0.83089678065478512 0.90836979494537451 1.5036743226058622 -1.6411234761936109 2.751006971657858 -0.89701291911829784 -0.65236298772741796 -1.7770804472385311 -0.037201900256398107 0.5874238527576523;0.070422075431654074 -0.12571983612029522 -0.11627278932700297 0.33221716418561298 1.0512792606089292 2.9757575131262133 0.060236604410037912 0.44476327999287529 -1.6827280972526506 -0.20000854440737256 -0.8711791059467433 -0.83421687229468255 1.3134791292960972;0.38835919422105775 -1.2458320644755181 0.066699134934250101 -0.14864451057090061 -0.7539313495282427 1.0479980984288038 -0.86500639949073488 -0.61547356848720869 0.91148617961885114 0.50519425544134022 1.0300545634233034 0.84020999241944927 0.15102717680804767;0.40175100320626467 -0.060645355662616973 0.060178878067896596 -0.061428726973493698 -0.11221552514102141 -1.5297273496401214 0.23942497188403847 -0.15647077991515282 -0.30903739805965519 0.41873270409410329 -0.3578903722763534 -0.20203317047944466 -0.12509087510878023;0.099912101108587975 -0.13151601707460503 -0.012985277680352928 -0.013718373709567321 -0.20526663957274877 -1.1640157471721935 -0.094930933241866328 -0.11894967199054636 0.15458590666384647 0.18345213468931212 0.19455186635632696 0.15124820392842944 -0.23855888804741557;1.6787299876088657 1.8062422080968508 1.0784834178670915 0.6364188875308181 -0.11812958568017404 -0.36956070644689354 1.5034339312442808 -1.3982597560469074 -0.25335990671690789 -0.44805876419451363 -3.0246630969817558 -0.057154317806567545 0.098981529035449906;-0.027902961703510514 -1.3649138324539307 -0.0031975850640229165 0.56728804052360005 0.81941154270225358 1.5811245244865757 -1.0538654829622862 1.5654593487205952 -1.2134811149416336 -0.69151865099534759 -1.5378964922374685 0.081841164155124199 0.57383380809945606;-0.73512699313424601 -1.0634633900416228 2.4898362206552442 0.46105500495492158 -0.64155672369374561 -0.079380203943756902 0.83447779388178245 -0.29626937780666152 -0.90989649300998787 1.1619649108149726 0.54208051043091532 0.68963867249432187 -0.23052834865527372;-0.56452528721637607 -1.1982472233028452 -1.1512574765132524 0.3671434607884258 -0.63354527734506294 -0.22547040994313414 -0.35665970763015942 -0.61802442238436628 0.61647652464192915 -0.34412476905779921 -0.27845105072903709 -0.38468095594240703 -1.38743091579088;-0.13845323303662396 1.6219036487207958 0.01219260241093909 -0.32303959685850736 0.47723367764722763 0.14159898732219284 -0.57691460529402494 0.4086310810560338 -0.22828485831354925 0.025868184277321335 1.2563079923258549 0.17920192202474439 0.014333980792640236;-1.4008128843511869 2.0743825024504901 -2.1827633994431874 -1.894888816387355 0.35429935201714158 -1.077081930052195 0.53248070204995379 0.55929204722018755 -1.2706711895412071 -0.65072425637523956 -0.93155576558514741 -1.3802826934757824 -0.76631904863760958;1.4231724412844133 0.60421450683316558 -0.91772977747505435 -0.52240004005399088 0.25874693462835346 0.24358940292660083 -0.46287845867504773 -0.059589885469256414 -0.27167653772461625 0.13771998039731609 1.3121523040037657 -0.15219204706869963 0.032874618362358131;0.22086611519135049 5.7325672339120661 -0.6413746725469246 -0.38225396921251981 0.25242341531472906 -0.25527143183119488 -0.32074173704222486 0.25960196655844109 -1.1588154020192092 -1.184820795134186 -1.9374935805681397 -0.21579251115928119 -1.8944018502449138];
  
  % Layer 3
  b3 = -1.1523763153628797;
  LW3_2 = [1.9041075753756316 0.44014504365365148 -0.72331763739793054 -1.4424114260578145 4.2882197600947443 1.9063775588145859 -2.2425097107781546 0.80885859060537668 -1.8535956810664214 -4.4596154660988745 -2.6101839764487123 4.0015998190458157 1.3129175667652992];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
