function [Y,Xf,Af] = NOXAguilas22(X,~,~)
%NOXAGUILAS22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:14.
% 
% [Y] = NOXAguilas22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.86135165516625256;-1.3795168443799264;-1.5236253121119876;0.87484743663587583;-0.21522160628458592;1.594382884505861;-1.0553401808271927;0.16273514966360111;-0.87737175748901464;1.2339677769248683;-1.6880321200060426;-0.82662996193412441;3.6354985641288953];
IW1_1 = [-0.261302417710223 -4.2317468469092807 -0.064752289550303932 0.073471992316195223 -0.20549828928190261 0.034768003520612337 -0.066029209559209462 0.35661176784750243 0.046570850522608696 0.083376359680824408 0.24711887279697983 -0.041934698103937802;0.96258361799136771 0.43503970061950326 -0.59244430824394945 0.016069898560005531 1.1031681449707411 -0.21666219307814405 -0.49669435945065604 -0.1037404922332377 0.37638924455556422 -0.35795367567529529 0.1752803074020981 -0.69513506379976686;0.26091356100759378 0.15740647296288407 0.5238309730287336 -1.7248087933958003 0.032490229083026748 0.0016889511452555205 -0.15877251531530512 0.28171563883371936 -0.056871991287457888 0.024431142075955668 0.0050913289571466059 0.17051810952302621;-0.34294858292966174 0.15860983439070553 0.26296755531716387 1.2286301099206014 -0.10325321940722117 -1.6829004938019014 1.2144878540733535 -0.6498924173520445 -0.34364502955477044 0.064858883415734675 0.27222707549312886 -1.3661250571729222;-0.0059009103648308917 2.9235322990902168 -0.31715185430349918 -0.17493140182452163 0.15477431522336438 0.17063479891492728 0.37401605100028784 0.10285597516554471 0.047154131502199388 0.12026766290426902 -0.017297768370783711 -0.24805767866741069;-0.12520619314482537 0.17546680655019536 -0.23747860997174161 0.26740389031634393 -0.35286376228120236 -0.58049819795535207 1.9902335849698658 -0.14543154307694645 0.75330041448924645 0.36424046767009882 0.42557714892363874 -0.38466966264588665;-1.1237886171891398 0.047523542484351984 -0.75473651767350602 0.15993327853254999 -0.084856614998921734 -0.74783999870421913 1.2665263703151397 -0.65929084390113557 0.67820171134201446 -0.38664353650116856 -0.11166815596691038 0.41081024084939161;0.31955761195505089 0.57848210198272398 0.072238858793457553 0.83608466580181817 0.63928145207476483 -1.6126373593865366 0.10153636620805245 2.5794538586500293 0.74738492757840214 -0.43868737753672088 -0.41334717217646949 -0.35094632707226447;-1.6942927247270247 -0.11110043054998736 0.71035923906378673 -0.64133663722518541 -0.57410743174572365 0.07483007070303771 -0.31507368477205439 -0.28599459790154241 -0.50017609940239915 0.048493141056037803 0.48444533907067477 -0.31640684797289392;0.94255602068721611 -1.2633888255519719 0.44291976604273386 2.0941928871538349 1.2359523212064325 -0.87952006079187173 -1.0012711413427269 -0.9157766049068865 -0.24316703992443062 -0.43680138281525155 -0.27494127759475012 -0.63426247933473967;0.11637533034926498 1.6186448646558622 0.66559670564106188 -0.6535000908162617 0.32298528905424356 -0.35826442660387542 -0.21168289569419646 -0.4109941820277429 -0.25382163795342494 0.18472953303229367 0.11270347343612119 -0.037019621474565625;0.087803390583249596 -0.10941778179569842 -0.27722756352441918 0.5805867673921542 1.0755938699407508 -0.27208239794046751 -0.058747369782565909 0.52641147245279751 0.13133113821821049 -0.24962638395144235 -0.3404684762426487 -0.72428251837500679;2.2249928804207109 -0.2232001324486674 -0.91841796421685373 1.8409932515889371 0.8874735821907902 -0.24386360028066756 -0.17878194409928921 -0.050314482406437509 0.10447339932218554 -0.031668970429797841 -0.25886470574965847 -0.38447420618582856];

% Layer 2
b2 = [-1.1255355301144281;1.6106855999879437;-1.664074704405663;0.7762146844565927;-0.61175179033776528;1.3328547348015389;-0.2781662993003709;0.10092293404996037;-0.36048626103650039;-0.37018957958662746;1.5129217514536852;2.6779243719039592;2.7761130847563629];
LW2_1 = [1.128371289798795 0.66641593496740603 -0.37216998474876473 0.071264737568899686 0.56096176517857643 -0.20094156128611665 0.2966486636544699 -1.0115041120780097 0.23002009042592172 0.5368071423703481 0.077445836778667621 -0.14668427666976327 0.7743338105900931;-0.18514178586625737 -0.66440616601032243 0.6730589378723123 0.30796242174056809 0.82547645439078787 0.59376580949237645 0.22003778803198532 0.69210186846741029 -0.15506668322076117 -0.21261863208155973 -0.0099592806631045895 -0.24683126271389189 0.4050889716924046;-0.36108729468176259 -0.30260282362189883 0.12967224049549853 -0.67482104687725808 -0.82965024385057995 0.41926677477784402 -0.262022714405858 -1.7563075149051992 -0.68661813697133467 -0.12547723106219902 0.37000528721356807 0.015709477125079592 0.55174330392167437;0.016815912651609477 0.18902900439752265 0.19969344838273534 0.2705255575654173 -0.85907360638621366 0.34505893653070258 0.216896880049364 0.069771858184016572 0.3363933999212349 0.31594528248207188 -0.1048187220709615 -0.62206921604294352 -0.62868848733025295;0.53197692079413161 0.77932805607189104 0.41941266356694995 -0.85145943818066205 -0.56235646843765474 0.24352056549046275 -0.76161212263512046 0.70114103641701742 0.68491751212876417 -0.19189136616315164 0.73146131235883038 0.17858016123061971 0.24864269118672658;-0.77435771685539867 0.31322865241052766 -1.1920679115118145 0.076134300796231735 -1.3160386559933286 1.1896138405155847 0.25435077469445 -0.7211330656236169 -0.24805157781386941 0.022078281638158153 0.76038174188274354 -0.44914468996662243 -0.63870235102731232;0.42783054424530431 0.20868560966251698 1.0907275309760565 -0.65807890588089502 0.98968887380202619 0.15679258735798537 -0.60529375016830489 -0.58839148531171293 0.33638238246126451 -0.26330533401249651 0.27980654820834505 0.62277444624809086 0.22755372526066042;-0.68792070618533174 -0.2197531967127975 -0.59690689484579418 -0.24075537059144084 0.038623846913593628 0.19902310504483822 1.520449992351703 -0.3526368002611831 -0.077252238596613995 -0.13621986657398344 -1.233771123603119 0.019591626576940229 0.67007607659138602;-0.90580027960608356 -0.12173858202655813 -0.65140612922335017 -0.39418143694816699 0.042367645268176476 0.27916887227730292 -0.042427766610992186 -0.64886316140525047 -0.10116659550601448 -0.30305402222861066 0.47765703298561385 0.64996891921640099 0.48113281090786969;0.86831260233601959 0.51669524698627312 -0.45397759498579593 0.49160145962584928 0.50866689226795481 0.17545731951419596 -0.42635174322595365 0.52401408640699154 -1.1834893876319537 0.023527372187044863 -0.50903875722488034 -0.95929783879209685 -1.5365767137023711;1.2241182568450342 -0.54128406872076795 -0.7517589556411608 1.226905151023528 1.9516459930071151 -0.90761548476930687 0.071539932167315426 -0.39753359773986818 -1.1404327470308926 0.1121958792218989 -1.1504465184247159 -0.33861776584605718 -1.819860946606503;2.0725021595242685 -0.097285107623996225 -0.11197611365535035 0.30737660922940185 0.24106244945627683 -0.47260803007491636 -1.0411288348565022 0.4246385641218462 -0.55407275495764841 -1.1979274009730869 -0.25633769779609467 0.48987739219559068 -0.22154291525901429;1.4347694295763236 -1.2992421016061508 0.79226184317375814 0.28260018720469887 2.3645428175550558 0.022431882815059243 -1.1906040789065326 -0.35382341586806143 -1.3935705700071603 0.69574735912697061 -1.1502607644771452 -0.44870864642387132 -1.1695573488625837];

% Layer 3
b3 = 0.84732596754207778;
LW3_2 = [0.46362932885722224 0.18977575252080869 -0.4166117399763144 1.120928462607496 -0.7000833788874945 -0.66292341198599236 -0.49086333516745617 -0.28522452875619186 1.2352159794979345 0.45332885070798834 -1.6435354525994621 0.64285182041032096 -1.4667178404591628];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
