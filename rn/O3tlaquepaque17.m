function [Y,Xf,Af] = O3tlaquepaque17(X,~,~)
%O3TLAQUEPAQUE17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:52.
% 
% [Y] = O3tlaquepaque17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.171659085057077;3.03490136570561;14.7058823529412;15.3846153846154;10.752688172043;10.4712041884817;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-0.41747902987597602;-1.5016910522744207;1.2741403438907755;2.2842219687331782;1.1308113413490786;-0.022802234196520249;-1.1725170214748957;-0.74438155641293724;-0.86596480676869114;0.40988982897624365;1.6198311073710308;-3.9581645386892124;-0.69816318393280397;1.6606864195590076;-2.7306864613917483];
  IW1_1 = [0.048579321296317396 -2.3245595980985567 -1.1871098008946313 -0.19582270484004097 0.38073525217429316 -0.39705261800831809 -0.23426025881681281 0.048498671324364209 0.58060488249548714 0.95039653021448778 0.11630030231532752 0.15827575794993526 0.32563351613886637;1.0836335014169132 -0.51046415060696726 1.3763415078719818 1.2650821944785884 0.26814762178759927 -0.37276047064160611 -1.1950086903785735 -0.65945287351278814 -1.2101646165948206 -0.20309644123524154 0.70658498481545651 -0.084993199554679225 -0.67881260248818909;-1.683198825442161 0.29989359560763429 0.68633849716481299 0.46024667793898488 0.42684931498935796 -0.08403043359308332 -0.038779736631492187 0.033824354383810366 -0.08352860194010768 1.0294117824723521 0.77885351468770203 0.43633323303906713 0.7048859680106937;-0.39809847860133862 0.71308687822393768 0.028121982297434123 -0.65539309659085188 0.33837449842273798 0.70325043922743258 0.16299016719189949 0.494442570501328 -0.0014301452687578986 -0.25104910037595285 0.25205152644794832 -0.020914088577573407 0.49310027126880102;-0.011606618147856412 0.017608312813845464 -1.0174314770525201 1.2028112926190753 -0.074041453938817073 0.34046307936694487 -0.10140486177154037 -0.53611318698753774 0.57170358919686293 0.60127408912556246 0.083291329061271208 0.30449324348108286 0.33430682169886389;0.99323982497614893 0.24352882572073375 0.1360592422743015 1.1215136912943777 -0.30549188970766539 0.32476194803569824 0.29032120819698165 -0.40804420061933666 -0.65706056570688853 0.40420423488913859 0.30813040870914699 0.18742092482637759 0.02964714541224556;0.21155443041587593 0.72826167927861984 0.15241164662451931 -0.98502019530441898 -0.26473100148379497 0.016105676439840393 0.36044485644410962 0.11265223296194865 -0.44442490755932251 -0.37241690399341454 -0.38459079709411675 -0.20846690240470958 -0.29174476161568891;0.64656786103077679 -1.1263919135250862 0.13973955763135104 -0.25606468677583039 0.23560844666145961 -0.23385007327578869 -0.15972313840302796 0.20137443613232936 0.10261567839418188 0.11549185007562829 0.15941685791303661 0.0085125380663009526 -0.065379383731750354;2.5128609143093019 -0.013365261477710451 0.12823971418134406 -0.10174666711768297 -0.055765901856735162 -0.01635960224457024 0.030429594017529128 0.035661025959495996 0.04190937964073798 -0.14625333664422741 -0.078365597680823684 -0.055547832041641827 -0.040879932500308289;0.51465470798691748 4.4961774637752807 0.8657350867971505 -0.21917059565968453 2.0808786534582935 -0.1101257559962131 2.0200445240079778 -1.0896784309800089 1.3575358671915905 0.71136446464470293 -1.1829648780596369 0.0046900090287147686 -4.1133554367207834;0.34474973270923676 3.9999967477988081 1.4880748214392481 -0.26345800309749623 -2.3324147248336038 -0.5711877654293005 -0.13095493230599042 -0.63490792246488548 1.1985740873096757 -0.77113593943251668 0.14348836822317357 -0.21498957022727708 3.6162947824955904;-0.3805402794565842 1.2579378342164766 0.12739776991834337 -1.123260793362701 -0.54357899919657271 0.44932837524440811 0.20347741782268758 -0.1083067131815565 -0.91666153520374682 -1.3912631016350105 1.1890394980176537 -0.85766814977449979 -0.790343248528799;-3.7139859123511947 -0.4978809853877495 0.96583591544421887 0.033572744821668332 1.1353464858898876 -0.058616914373223687 0.74464701211044937 0.018457556193913188 -0.00035666296726930523 0.34136628273379038 0.35202389757709607 -0.076087328592074455 -0.23211331875911095;0.85793653379216517 -0.89759892121905416 -0.011749522563255677 -0.70726441963851061 -1.1132264501537554 -0.64547416167852312 -0.92326304966757988 0.63293007007370683 -1.1585874156320124 -0.88100458306547547 0.27167732867626493 0.34947619480616837 2.2650729953214537;1.185124925713346 0.5040040723642637 0.09475968284740735 1.1189672352256954 -2.6572656111268991 1.119891392905864 0.028638042727688603 0.78392290639851281 0.37343768520389042 0.48617362973218714 0.98737899774236515 0.39013354244807646 -1.409760602708481];
  
  % Layer 2
  b2 = [-2.032996612175213;2.6983085913134532;1.6115512758385737;0.29222943105078192;2.4734638422356441;-1.1279702377964156;-0.13661765080360541;0.44957992791105034;-0.99414945447136693;-0.89220757902116798;0.73065562469106493;1.114314757418118;-1.193584004504163;-0.63328543240593738;0.37951731061778715];
  LW2_1 = [0.29755395035991422 0.58770818161189275 -0.44812827462426258 -0.36490651435563215 -0.55202391605152323 -0.58490467567507409 0.64054909289964757 -3.2926896940508348 -0.47332543244739861 -0.34915248366135693 0.31290389254270495 0.34786879214869426 -0.1992315286357921 -0.42885494692468007 -0.50952071391824771;-0.33976427136683712 0.12794411263015776 -0.0091219573279380933 0.11569030489589741 0.44627835380270575 -0.4995154636376633 -0.23912190037589129 1.7301383254757914 0.13183412450381773 0.27445230363921452 0.35695632503474112 0.49806911806762072 0.11402650325323847 0.2754703893495577 0.37985882125277637;-0.17267585948136074 -0.39492301842956229 1.2526110461358275 -1.1126408641612426 -0.6341475496218032 -0.15662015339809426 -0.12554262831606083 -0.46334445720886652 -0.69551785699047874 -0.21064236664574001 -0.57781157663081806 -0.39849845617285967 -1.0057073521181374 0.70178051129189112 -0.33728688797807055;-0.65228832865181274 -0.18499502293057468 0.63207486434889248 -0.42447754994466047 -0.40267574641442289 0.2783459573060959 0.80401167930785455 -0.90060647765276147 0.66349339616139369 -0.67084312946235169 -0.2328751659707558 -0.71713627477491404 -0.38790885231905686 -0.77933868061955414 -0.18617469682935514;-2.1695767376085491 -0.42707849689185051 0.6178262523442567 -0.1686542479050448 0.79582302831767382 -0.13082965295269822 1.487959715395339 2.2506620327526554 -1.1811490793208348 0.42424544916399587 -0.12477164153621594 0.26055869583746671 -0.55643842691859102 0.22995228699650538 -0.79009055159689678;1.0110894633907104 0.24761674762363589 -1.5074170604325254 -0.34422757348668626 0.58325234711180496 -1.3814454132367311 -2.0269921938630775 -0.041063705504482066 -0.37337796996150707 0.99464970926841634 0.11480261412013439 0.93991193926547234 0.94929592738245894 1.2144752934835943 0.18244273204196876;0.30000442960283297 -1.2027705497903205 0.61068635975314023 1.9903587509493255 -0.59103509391386055 2.0725879508873657 -2.0190099085753137 0.66561141519481604 0.58778840326038384 0.40858513848195521 -0.67085075685183682 -0.244849293311001 0.07926705598281944 0.20738672178174275 -0.27171661647601231;-0.086875818779196437 1.0798640416659033 -0.77619856417948485 0.31388295510311237 0.80046143821202287 -0.18580601433068272 1.0800567852758072 -1.7220466519350284 0.056606742600619875 -0.38431261271893563 -0.91949857806295854 -0.94995413223263159 0.033958916253464547 0.91902899322206322 1.4565424712239461;-0.7244665633040831 -0.88018444764301373 0.53879950983098435 0.0087220679499772427 -0.94793310704821943 -0.045559808717988176 -1.3386991853206167 0.37226574672066787 0.87775739092677774 -0.1894807325881343 0.34036443463344368 0.011885513154364719 -0.20051077073290174 -0.72559442969299004 -0.36764647253413052;-1.6008377281593156 0.2060305099347598 0.43691676122483719 -0.18657604232439495 0.19584170864061867 -0.64839506265199942 0.90089560078817144 1.784102631929448 -0.65474595590237905 -1.2367793128029669 -1.6315510287034627 0.83590340473938518 0.24890612439540605 -0.97019511466141628 0.65511245915181615;-0.61027300148653396 -0.81160550145191201 -0.94791902966896557 1.0474466317764475 0.015168194649816733 2.2591829285176268 -0.92295088103611878 2.0013830656979694 -0.0073785797389980309 -0.0013287951202099729 -0.37200393490314138 -0.239362009513575 1.8631059437072421 0.93558885388409541 -1.4569893463681296;1.485155829021704 0.48828827368129801 0.030893901471475346 0.29171021058596203 0.51081309475690118 -0.79090907811339528 0.85389493699314556 -1.020934923197732 -1.0165628205559636 0.34303125739996826 -0.19888239170562338 0.29111138755447891 0.1915872894077586 0.59310053229458282 0.92313677983119713;-1.9149389714404348 -0.56551870453329389 -0.42066294258503045 -0.99234722779223172 -0.2669125366658861 1.238175593149168 -0.87327178449220022 0.91596505063410527 0.61306459585584605 -0.34500195170850378 0.21373686977319259 -0.16731610047463977 0.72092828379089524 0.6272929177827794 -0.86390282996734868;-0.18921907104737232 0.73892839254513409 0.16735973153522021 -1.3813951005025149 0.15550016879323053 -1.912768395378377 0.85449639722253357 -0.70556879997781141 -0.29502120256731812 -0.17841797387640712 0.49399999552670248 -0.12721623390500428 -1.0614515631673387 0.34600468222225461 1.5238067959868289;0.90765562242278441 0.043583130067208549 -0.087405031389775872 0.3682084036091744 0.16861328231229217 -0.16079040183670029 -0.35025139701059838 0.066440357986745108 -0.66165549833720239 0.50389439085707322 0.064208116880457133 0.68904890187055889 0.22738359264364555 0.16408234486934303 0.088135997051815768];
  
  % Layer 3
  b3 = -0.1546876480498964;
  LW3_2 = [0.42705246546132097 3.4204796687855556 -1.2113268025026123 1.9951489740398145 -1.204044039228972 0.49420614579666605 0.6714392535369732 -0.62013973392293198 -1.2604195407033192 1.8985544221986128 1.0881825536228413 -2.137612184427462 -1.234935021109556 1.210690613747555 1.7025410919581936];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
