function [Y,Xf,Af] = COLomaDorada7(X,~,~)
%COLOMADORADA7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:37.
% 
% [Y] = COLomaDorada7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;17.6991150442478;0.00572573718866304;0.0175284837861525;0.0546448087431694];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.9423452724553198;-2.5569115943485525;-0.41063718693582779;-1.3021551385131791;0.29035975914018153;-0.28119936297120224;-0.88782010325253791;0.03331210592298995;0.52548792924798216;0.77832996892164896;2.1044430327541681;2.2406134904544217;-2.8207107169746721;-4.3477376960577194];
IW1_1 = [1.393267511698687 0.95956105210741383 0.58816952396464084 -0.43988945078208314 0.5703714148393213 -1.99595875263943 0.24820109858513517;2.8159840746090534 -0.42676386159863799 -0.86338331420779524 -0.67193984843351406 1.5074241437558134 -0.75999095174687514 -1.0517063057020504;1.6818364562466097 -2.1268191627162332 1.2077279831860841 -1.5024995134049872 1.1454815760463215 -0.0064518061344218391 0.52161316559262638;-1.919385864128458 1.2608513877957295 0.89711380575185773 -0.21121366564158675 -0.6169999258359844 -3.8388635058148419 -3.0521713945413071;-1.0977233659855428 2.1311325678871684 -0.46369423629367135 0.17051675011431836 -0.48735229651421674 -0.014418114914526253 -0.16969364982269458;-0.17947617660068305 0.79320121875635619 0.07581420969603643 0.13617196348460453 -0.27668170391983155 0.2118209479505137 0.17836018004998294;1.8601647785257922 1.7356226589300694 -0.17031882358701625 0.20898502968353191 -0.013833167437234627 -0.13155941613300726 -0.28944385546334128;-1.9376964153566498 -0.15769701663697799 0.30881898395504082 -0.27590829089954133 0.37234974182741803 0.99686370447874739 1.4030538765161407;1.4764714254783957 -1.4533850439719307 1.6159250593253125 1.1531164033296679 -2.0057662831298742 0.42686042189358825 -0.13516893494987306;-2.99191872311245 -1.400026239986957 1.9423075252976358 0.83633576412938504 0.86350515903984537 3.0859670875444545 -0.34274435651300705;0.17524914953990267 0.70339538553540115 0.86847038791439646 0.40061054784938843 0.24076027687211154 -0.4390514917796805 0.95585594008663777;0.14195241166991115 2.7128071658786821 -0.24453074928658311 -0.10621027549372349 0.34910589740576858 -0.23334586494558446 -0.48087233189483275;-2.0621647543189923 -0.94871611089327101 -0.94783508079804224 -0.21823350043575004 0.91337878481790269 -0.83441045451709428 -0.51718681560400082;-2.3390931439968958 -0.81039029183006506 -0.22659172131169208 0.043545000218097811 -1.9796709106728176 -0.23230002563158536 -0.015599693010114138];

% Layer 2
b2 = [-3.7843979087046691;-1.6319756512547332;-0.71703776757889148;-0.91322167773415863;0.44930188308752705;0.08880183589894769;-1.6683718981455056;2.8707783906886362;1.1439457963740771;-0.8368074709240505;-0.55490797778858081;-1.2111382899114738;-1.0697051612449644;0.43659585468314616];
LW2_1 = [0.067303327265117646 -0.089585510202316671 -0.20802960097580483 -0.010200947838931513 1.2087790346724141 -3.1429151264212889 1.01367244252793 0.42183336100139135 1.3745567478849763 0.28337402287142582 -0.47129728915477936 0.17557780551292299 0.5053351971357537 -1.4327222364699699;0.24497450632328927 -0.37991061992941938 0.41669178893513104 -1.4167644838112234 -0.11558549423833256 -0.52059676439106806 1.3147924176481234 -0.035631219975681874 0.0072252739406848381 0.42061276554188148 0.80614551067280027 -0.21481353404595083 0.92200474879136296 0.57280348750208432;0.34863652604607204 -1.0310772059773521 1.0817225230361407 0.40989992221443033 2.0841518460867641 0.19286312603241826 0.056847185003866513 0.45355276925310967 -0.51412365142955896 -0.22436718571683484 0.98801732387867203 -1.0163182611568002 -1.7261796580160604 2.2988987582628022;1.2732342011156734 -1.3844778578613324 1.5070695061564132 0.57719677711278239 3.396763831819456 -0.28608500886053972 -0.17079542721248325 -0.074271859794904943 0.30448188296128309 -0.13929374612456663 -0.70578402288951225 -1.1690050463014539 0.34931724304776324 -1.1147281536476943;-0.19522915513167557 -0.38103459221462199 0.04489052042440652 -2.1406516287246502 0.18613241813860978 0.92753443370636235 -1.3801612537521406 -0.84307719190280583 0.92488509423743781 0.60160116591656587 0.53181155384766576 1.5485691249807445 -0.027173857478434333 -1.223175204532513;-0.14124040963286261 -0.68064595458723043 0.13495896050598286 -0.59769808066640195 0.58148890640819484 0.50400926905958654 -0.035523434245742988 0.050440243464622711 0.54393512323566862 0.090734586239408652 -0.0018730958565910272 0.49709899614325037 -0.34434483365859325 -0.83121075516436027;0.39716710093287971 0.10841368934213787 -0.69534639935669296 -0.10164684659179404 0.5388706798480889 -3.779398598836297 1.6482039136462681 0.40588050997782205 0.39747009701176994 -0.43919206630341823 -0.58460879659149145 -1.6990573019250208 -1.3412891603391852 0.86559487737678409;-0.48805131938980278 -0.39337208288475622 -0.41520986537754218 -0.13567902602372786 0.094324371683861402 0.97257528051451803 1.2430516712741007 -0.55435947126282714 -0.77509010718750315 0.99402801446018629 1.5393207972303764 1.5490858179910587 3.5215126207125294 3.3170044184201415;0.60122603911109718 -0.19870270153072633 -0.16951558849406334 0.021478269254741056 -0.88194049556347276 0.49587691990935784 0.26749761937088873 0.29001002077319876 -0.25993643206841033 -0.22826009358120147 0.07540875699179303 1.1778387645404822 -0.95780087676026826 1.3403570846146018;-0.83971537338028113 0.18069166778682866 -1.8413960317721387 0.65183125483068227 1.2534903806592514 1.3600345324565479 1.1460249360130634 2.2834409744080979 -2.023658489864832 2.3550375439752815 1.8983077190673991 -1.6317173398669629 2.6145914092087477 3.0474818650587081;0.1264737906799718 0.014130784010984852 0.95046252236235584 0.29981649146036415 1.9403707441518885 -0.60268511874779129 -0.15599007758481931 1.0205012117554368 -1.0625071860738065 0.061707279321002437 -1.1937816969408233 -1.675054895270677 1.920815437126441 -2.6948230151859485;0.19755914881785802 -0.079727864646214369 -0.14362664124382962 -0.20206158371397737 -0.32880793765567284 1.2023632900084933 -0.38021095609324967 -0.35549873440602436 -0.18064453593563001 0.2921877426840272 0.28586876536871003 0.24505443989151907 0.55756072854444083 -0.77640345964356761;-1.3960872954278742 0.0070424327523548672 0.85113903094145515 -0.17239716692940202 2.2846262495607745 -1.8499605740299274 1.3867613767234568 0.64298919770581753 -0.56909055712548262 0.18147740248336358 1.3685255884169669 0.34954612635390303 1.6989249656898933 1.1309477557071927;0.36659346934093268 -0.42812794494042211 -0.015227263009321411 -0.12846028039013863 -0.020656725008823356 0.20008946654222848 0.5914558179100603 0.12364819845371278 0.067044228208492179 -0.067539466079166791 0.17997422202473515 1.1780737917280193 -0.5743445418261437 0.37330973862022343];

% Layer 3
b3 = 0.0071830258212275781;
LW3_2 = [2.2307758018818156 -0.79664327127014589 -0.7793919707210758 0.69308650849538489 -0.72280110719560908 2.2728755448713267 -1.000238436582964 -0.49541864537923913 3.0702416155142824 0.31409789749010181 -0.48929410920300931 1.1577512011012268 0.77533426769756797 -3.659408357339919];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
