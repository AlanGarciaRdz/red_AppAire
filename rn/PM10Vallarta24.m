function [Y,Xf,Af] = PM10Vallarta24(X,~,~)
%PM10VALLARTA24 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:49.
% 
% [Y] = PM10Vallarta24(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.12820512820513;0.00782778864970646;24.390243902439;0.02710027100271;0.00630517023959647;0.141843971631206];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.1665109537628573;-1.841931199049222;-1.2155702361481848;0.61856373132076425;1.129837917340468;0.74379379352569186;3.0736930775139637;-0.12574718122299955;1.1057759003412597;1.6259080685338934;-0.75664135881761285;0.76556888320746186;5.6913766011474491;3.1256886005032976;-5.6479685646723583];
IW1_1 = [3.7569995936496769 0.49773260748904796 -1.9151656178961984 -2.5372520889118553 7.5058567609215867 1.0554284923851349 -1.8708201640032112 0.40057555473770268;4.5156077744586618 0.24616382253052976 -2.01851635905795 1.8365057311405144 6.2338733489042868 -0.083097333661031683 -4.356508545818464 -0.031116079636442841;1.3981857462357627 0.76483636181420755 -0.28008681778323674 1.4257535228210569 0.78017241111424163 -3.1131863177192627 0.19477669060335204 0.24736486455897877;0.97011044956795778 -0.027045910354905656 0.32207236641317949 0.065964584394438225 0.45637901556331084 1.512804125530163 0.026040807073807702 0.33539063820670895;0.88437078078530018 1.8677786123125657 0.05372631119863798 0.22295738820714869 0.051925092188403743 2.4684368458295141 0.16915180491665471 -0.24144588707117312;0.18743073593400242 -1.284898429481705 -0.19924841902727602 1.1207142082784831 -0.32839039525850422 0.68032914973954728 0.43652199307164907 -0.53380175958741405;0.36358499378859688 -0.2228702663850122 0.98191167224550402 -2.471400525275437 -0.72438449889473833 -1.6741426138647626 -0.71162001358882387 4.195786621939301;1.6541339814624036 0.73718038533899211 0.17002598481195236 -0.65227275241300675 -1.65157148898823 1.3087204494070652 -0.20392639861809045 -0.76735714717134218;2.8662419819856204 1.1725505103203775 1.9122331031126958 -3.0012456125653704 -0.021100196911386343 -0.20636683246426066 -1.6260214436506866 0.099698199319610159;1.0843337053842945 0.88368611583446754 -0.48429344512019873 0.16110570431204441 1.6164725196580039 -1.1799920657062133 0.18689774595696851 -0.19908657646596825;-2.1698675215649947 2.294522612575896 0.47148684146978903 0.3106098101842778 -3.2513384752837173 3.5294740891459888 -0.059777977212624622 0.77946665600622311;0.055037530991502222 0.4290842854384907 -0.51124715363805706 -0.56538021579890596 3.7389336086324718 -3.3691646734921754 -0.12318109762689718 0.26206749272826863;2.8169123742276634 -0.8929079625195655 -1.3055012018386394 0.31796147483328041 5.7438836692957222 -0.72260774489270685 0.13632167628299094 0.11130366168265138;2.4288121372145826 -3.9554195971631336 2.5987653458332391 -2.8755460595696576 0.50150430591544404 0.65412939123974212 -1.6977839956317582 2.7519390700267903;-0.72620001031108317 0.18814623662989788 0.60521706592084423 -1.8999998023692128 -2.9299399463235933 -1.4307491753710777 -0.44658592998282287 -0.76949353173198454];

% Layer 2
b2 = [-2.4382935785764599;4.5579894992707963;1.7076475419754629;3.5314207913684776;0.35320278013049083;4.463863914734751;-4.1896873465713824;3.705708270033587;-0.40016219113666535;-3.9697174048609041;-2.3989367860311024;1.2338806566431053;6.3736094709855422;-1.952050932363663;0.15282107496153524];
LW2_1 = [1.2072742383000636 -1.9286841951452567 0.43269102007368349 3.0574691094794262 -2.0622103157257667 0.64287337563379421 -3.6236535605194558 -0.72289257734626011 3.2600750001641146 1.8068806511730875 -2.0772506302292637 -3.0720565812523111 0.65991826062635961 -4.83975626124509 -0.010661080897779063;-4.7435924335390993 6.8539779532935325 5.6272154647398285 0.68079626885955591 -4.6268802028138065 -5.1024937345561741 -2.6439073368205257 -0.65473004476057284 1.3655770767791182 -2.7516204744141959 -2.3748480012070794 -1.1833720930654099 -3.594281461226176 -0.30086988437933987 -4.7842238155502441;0.80112377401706325 -0.8440614228406077 1.0852580475239095 0.90410779270846753 3.6907847350568739 -1.5963951562072616 2.7845751974451618 2.0230746130030206 -1.2166380395078171 0.83011504281693049 -1.6749597245717391 2.3894863475728303 -1.1287521267030516 0.88974591924492796 -1.0148855898652911;-1.5865894057241672 3.6153367551720783 5.5865371037352691 -2.8067970424668562 -4.1016685335396694 -4.9175524732375964 -5.20150017673578 -2.3977500941701142 2.276183917345477 0.793031938365933 -2.5209773439868606 -4.5494779054089571 -2.8888600285625041 -0.31700506687224739 -4.7810432142067656;-4.4417864398458784 3.4503480635240282 2.7313647607996479 4.4771904685069996 -5.0405193691373364 -2.9654673044853919 -0.16107193672797926 -2.7010443304261149 0.038155457364128405 8.2622178103872397 0.054613355272243716 -3.6447635637640943 -2.4003346737348181 -0.52612669995590711 1.0375204339779789;3.0774346462383306 -1.5030520220898602 -0.62849461637010884 -1.94563236612768 -0.98507164694999649 -1.9550307308848009 -5.1361350269199644 -3.6363162521757846 -0.39311907760172554 -1.0266838798010891 0.29668651886500819 0.48694779918759945 0.18108825038725873 -0.82737088369747969 1.1546764557936364;-3.4635116074475927 -3.6852826968592742 0.2926104432452491 0.013814569023714918 0.97338852300484446 -3.7976504463299734 0.25185495717390211 -0.81082096346655286 -0.14816499348463577 -2.9616588415159004 -1.2360454095017857 0.69039999396077723 2.2511499552895797 -0.79167214493875637 -0.1949516626096687;9.518129266736894 1.4426947564048704 -6.7530945119312262 -3.0553383522585356 1.4137526980263189 0.58697228670343349 1.6747264566507931 -0.25559620159701912 5.7408996662537914 -6.7537703760462957 0.88638736039525357 -0.53192787147444864 -0.73541782538938483 0.17343212634057464 2.8613447594188792;-1.1385958798056532 0.95670923796015228 2.0942438188906358 -1.8360169272469642 0.74152544090028594 4.6952198008352495 1.4284959579573504 -3.8966046080669057 1.7645969334126321 1.6472112940861221 -1.4570329165920324 -2.852260818832586 -1.4060625915595202 -1.8620817862841248 3.6914644734220992;-1.4181220472646687 0.40498173867535914 -0.85382968202696197 -1.7910531495152431 -0.60619386818424781 1.9204356101871471 3.1719286524532704 10.164239178667158 -0.81170411170437018 1.3556595397207016 -1.6298196190250045 -5.6963174370762353 0.54134362345245157 2.0507281685726375 -5.4971859027979342;-2.8579146657506032 2.8810128481065358 -0.51861100989692055 -0.24439757170001525 -0.4914897031398624 -0.65875023282746492 2.2885167909209767 1.0539706999476715 -0.079190431311376014 -5.1143511982287126 -0.010161337239291829 4.6359501394682097 0.75058497800874024 -0.66012537750901956 -1.9536430922504389;3.9799418625499881 0.1229057745320512 0.33350352880518219 3.5489433147822758 -4.6880734659360801 2.1489744768278456 2.6863887352803402 -0.052444105465613733 1.3280525732042894 -1.0277567388723616 2.9293795468241846 0.59216370121235873 0.63498895544140332 0.57277123312258349 0.71442551485432104;6.0395786299856695 5.3562610372932449 -6.2730535003336634 -0.5687154721371952 -0.73779351038062702 0.63242158072203702 -2.3859387046969984 -3.1790877525001902 3.0779479913775751 -0.45876629463331553 -0.12235286547997749 1.6782846640809672 1.1061801594891576 -1.5804802213123355 -1.4295353384431351;0.23801300089853503 -0.3829733544399978 3.1926855051750676 -2.1803730370874153 4.2900446922102029 5.7556496875255698 -0.62978588845602113 -0.93345459629412209 8.5941343874918594 -2.7614330156367979 0.069593517423724355 -1.3492273673464139 -5.0815342283143448 2.067413980647046 6.0298924577389057;-0.98306960354728368 0.37867188031607918 -5.5160663662916614 3.8186747120012181 2.5621154622973585 4.7295698981745131 -1.137347305605261 2.8796715235576791 0.69350592563632452 2.1403056907059601 4.7752725884960716 6.5084230920827695 -0.31529594476386025 0.44693894810859625 -0.31034831570025778];

% Layer 3
b3 = -0.75225809488933937;
LW3_2 = [0.058989099032895766 -0.12552721436637587 -0.11991615550957171 0.14345066561495545 0.055573309695157926 -0.076499713675898862 -0.077810979409944817 0.02379438229810275 -0.05235807439277243 0.063195865415253391 0.17852708309689774 -0.065359674873460449 -0.080439481352779021 0.02225156761877432 0.084706341825534173];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
