function [Y,Xf,Af] = SOXMiravalle10(X,~,~)
%SOXMIRAVALLE10 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:36.
% 
% [Y] = SOXMiravalle10(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.0208986415882968;90.9090909090909;0.056980056980057;0.0063552589768033;166.666666666667;45.4545454545455;117.647058823529;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.9625166103149598;2.3348573764128338;3.2493808054727942;3.7277009127324807;1.4265344604256516;1.5369119226458932;0.29252688598777776;0.044047882346764052;0.74429551532830884;4.4692183345496801;2.9772569810677392];
IW1_1 = [-1.3576069231898642 0.16765458215032258 -2.5412968220202585 -0.60322481402967254 3.7950045478749868 -0.046476000732575712 2.0294108580452761 -0.50391377413682703 -0.66674936348373381 1.414001460576602;-10.181989368716783 0.10371295119767771 1.40039376349908 -0.87999879319362284 2.1541096688705319 -0.02669325882959513 0.028657862118810377 -0.2438196608031995 -0.82140935477538723 -0.87904275091978967;0.36049606930708 -0.18371748667549903 -0.81638511363820609 -0.90340555980368464 0.050736823199028357 0.48578047454976148 0.19157100793442183 1.3103008213888956 0.05302829857513492 -0.40710790645298928;0.83997673430636055 0.1858365096653723 1.4961602457237955 0.4698299509347405 1.7687998338230191 1.8581417566986465 0.43744580632933494 0.70003523513633192 -0.24131106254757917 -0.86793021007040549;-1.7673189301551075 0.1314826217452163 0.55342961713346117 -1.0235388541796291 1.4034512719489767 0.8157392685974022 -1.1768229931849883 2.0533375577821804 -1.5817705925796222 0.29443944287138657;0.97114870285433663 0.11103741897019859 0.18169409567103784 -1.7590857219742271 0.75438744442293337 0.71269752048101132 -0.84972995909870763 1.6631811984692773 -0.1105748677261106 -0.20580851109125667;-1.8069871888526294 0.38087009015235573 -3.7593658235879173 -0.55198533013440554 -6.0055255254720397 -0.18493637322990936 0.20578421308964256 -2.4550955930840188 -0.36772150670115078 0.074089718426599269;1.0726263440602053 0.091680759078125493 -0.30504717045815249 -1.3042954357751413 0.035240074768844103 0.12742748478967472 -1.2756422680873114 0.55063400198634338 -0.030737050015540255 0.4742078605327984;1.8093996900435214 0.016482198859134285 0.17154497198066518 -1.759817440325413 0.23287129309212257 -0.036217541450021755 -0.79716453064069792 0.12711392010814204 -0.059311063035293377 0.85667337049836667;6.5060734133273481 -0.24211809731138759 0.66168689272667947 0.49990756341976889 1.0698986779290669 -0.046084282829325585 0.13071194744723419 1.8633431368070508 0.18368325105448152 0.5828037157998549;-1.6693974734626658 -3.9930454997274558 1.7428214072600374 -1.8210358522551724 1.8920595854682356 -0.17012335213104962 2.736594136410829 -0.75271694060488958 -0.16134617788883407 -1.7159431171429571];

% Layer 2
b2 = [-1.3200508915121829;-6.3566070133149664;3.5390286197558543;1.0981131770892563;-0.5950015099612137;-1.3621579937515089;1.357250139814848;-4.4176058809985674;-1.587014061504705;0.87728080349565829;2.5649472169707099];
LW2_1 = [0.21032471363125779 0.51670601110074388 1.1741681070446106 0.40778657219179698 0.58136863509387526 -0.75958507447065304 -0.019655318826554292 -0.21058344905989973 -0.093826321440086888 0.7885746822621259 -0.044546668296508066;0.38373822779145672 5.6723425869418271 -4.2178216233713677 -5.3986300665017115 0.030683088442227724 -0.12134680781598334 0.13112856003223403 0.23473058116026047 0.18551558345255359 8.3976591913444061 -0.63391655947743009;0.3584087741918201 -8.7229124539288829 1.6294183844595844 -0.67162061030820475 -1.0194686341197043 -0.93961980407898038 -0.57174730748551494 2.9315728709303497 -1.247352562785593 1.1253238705705781 -0.065675524155914294;0.41164224521417692 1.248711051479314 -1.6948559018686031 0.53706256843581923 0.13819318646918469 -0.56257855519915845 -0.04797562323177109 0.28791641966312931 0.95035949220466731 0.33824227670051354 -0.0080686143210338714;0.29860326504738843 -1.7411686838949172 0.32858174886749414 1.085168347073914 -2.2712221359000284 1.9203114934172592 0.94257996701207425 -1.4685577576778137 0.063325455267587927 -0.7105659246976771 -0.049169360415863769;-0.82199041880733614 -4.9727268262266415 -1.3986305889446373 -0.65434271211533623 0.89664882729145345 0.13214709934707219 0.51135564612063356 -1.5762949147140455 1.8127140791432019 -3.4007346492529593 -0.09050367520289046;0.85942777588772656 1.8910888084805293 0.69770794533813207 0.69045025737537935 -1.0121854065672364 -0.18689976126562241 -0.55242951109186411 1.721903848000377 -1.7701729889513169 0.86186614015565965 0.10013675244463323;-0.56861890722292374 8.9118409984908098 -2.3157952366131922 4.0678781213327202 -2.3888951706918267 -0.020469813575976437 -0.86417631189571087 0.24525968108532784 -0.12187784335631921 -0.77068245615773456 -0.84933975374424076;-0.019874803815779701 1.5002793831063288 0.64295935965072237 0.4502415342270627 1.7098773266745679 0.0061680613805775919 -0.62229998133886022 0.43038785119239564 -1.9151421998514668 1.4678235569841662 -0.096920968312889669;-0.23409354446097438 -0.15238903799974635 -0.55020288514410287 2.48611273831211 0.013884925932718558 -0.0047774026842863195 -0.54406745578227989 -0.34993517889739584 0.1028836685100305 -0.15063786957120801 -0.41403674720434874;0.40006640114344311 1.0604623307291028 -1.5565438311657751 -1.0422153461969434 0.32463705297703588 -0.8351879912631377 -0.011149338193844196 0.18598923623801847 0.63737511407117042 0.70184944725494181 0.0039418868091778145];

% Layer 3
b3 = -0.53354716592058382;
LW3_2 = [-0.81609591796002257 1.955557525515299 -0.8721393918431537 -0.95354239448863243 0.22126258036124516 -2.2522048016513829 -2.044787187165531 -0.87020651921005188 0.36641987072477616 1.3612440141091076 1.4654067606810453];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
