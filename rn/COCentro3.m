function [Y,Xf,Af] = COCentro3(X,~,~)
%COCENTRO3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:29.
% 
% [Y] = COCentro3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.281968137600451;15.748031496063;0.00773694390715667;0.0203458799593082;0.00627943485086342;0.132450331125828;0.448430493273543;0.241545893719807];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.1360860256714602;4.3822036521075018;-0.50204639034385534;0.58893290812870214;0.30762078736020926;-0.076209748942506483;0.3836807439862987;1.283615871443996;-1.7246251926688372;-2.9834834452262551;0.37366958010652429;-1.8079008878397103;2.502514410105773];
IW1_1 = [-0.54149119678122337 5.1415224636899008 0.093865579832270188 -0.31930583303728061 0.08379740575959195 -0.51745741390782662 0.1953017267693771 -0.31140968320218332 -0.4511180783273025 0.32904525930302109;0.39913140133053654 0.35671594715665594 0.19788549202129641 -0.32473765222210338 0.28113323923522049 0.14636074765954141 0.17643898121183418 0.18610562821713258 3.0637803247301023 0.25027894948647894;0.94831558794289494 -1.7072758271956885 -0.35131638694383721 0.043839891224250367 0.12462473570905541 0.25486492981035247 0.016379498447783108 0.22291983339740726 0.39399020918448718 -0.41782932568434861;-0.25121697708333973 0.44595596304456619 0.2524873271140935 0.81146882842236578 -0.34651517510412178 -0.11085886199567219 -0.088732125955392496 0.12270872546112187 -0.084701321090257325 -0.4685577229686857;-0.16940735179942962 0.52437828098569117 1.2728620933743053 0.27987824293906804 -0.82867413741576312 0.3372510336877258 0.051781745811679568 -0.041921611161161672 0.29253512220075739 -0.22990745558405248;0.49744975959459281 0.78580278976992013 0.61865045503854621 -0.088839857944847153 -0.2172836119031335 0.17463137098775172 0.078534503416520768 0.1114092878830541 -0.89540541774852778 0.081181019116617792;0.57035699154043662 0.77033066022665064 -1.1044870968331233 -0.74683597886377551 0.76423977477273619 -0.28613607667073943 -0.12801636937692415 0.056451856925555835 -0.96451626667291424 0.14068384117089502;0.23000294239246472 1.7235188767828302 -0.73053577977809081 -0.29354862375488111 0.41895386981281085 -0.3392722511582027 -0.24490485867419723 -0.085378054513776044 1.6911194447367932 0.80479505126296635;-0.63176242596231014 -2.7022027483381907 0.25524902855853243 -0.18931305401940235 0.10578751167879269 -0.2234269753697829 -0.10862980355203131 -0.42835017092241179 -0.88950251413638226 0.83520927480594342;-2.1274384542120011 -0.70434839506899072 0.1693126743106515 -1.1839260732435473 0.46225375992702938 -0.22979661709757213 -0.26654404449261554 -0.17473615946046822 0.81493982350812344 0.67478250495197467;0.68745990354912623 -2.1774760953845984 -1.03707862344085 1.4051950119776468 -0.5995297042719675 -0.40870846041743591 -0.362656013625275 -0.0077147292795772138 1.688844522234195 -1.3500512916677472;0.19616644071754608 -4.2799016152638121 -0.0086582332054734555 -0.12083913945298161 -0.08156580692359687 0.059780769139074534 0.037520658696767475 -0.025215016826003644 0.46470449879083864 -0.049506537773215259;-2.5571800198830643 -2.5261422076206195 -0.2709346057879618 -1.4968276966074319 -0.11693200617080581 0.9645072247626385 0.35187836512211784 -0.7994655058364023 -0.22821533184756151 0.27430517753003525];

% Layer 2
b2 = [-1.2202655837248086;-0.19546455373603017;2.9110084603314355;2.3030730187905375;-1.3631248922537607;-0.94724201534687202;1.2298064504360084;-0.82745694080541365;-0.26486280641398607;0.40006613770019916;-3.0636472735794631;-1.9312688424620741;3.1641508383584944];
LW2_1 = [-0.19953438542459173 0.042093295954192048 0.65859752068950939 -1.1129394816313742 -0.33358917184606673 0.66853767525390773 -0.92158315026751048 0.62564802438081724 0.62480756949523641 -1.5157769341004252 -0.17527613259740799 0.7033596527640229 -0.51863996893290509;1.6589909895466106 -1.4637163622338105 1.3311827753499206 0.47000043570736588 1.509377850358457 -0.98466088506455263 1.883455421929179 -0.63181495125406828 -0.098709894834350637 -0.87394837164560735 -0.65846074337948313 0.39662506194200792 -0.81904810784420867;-0.12983508773600577 -0.65304014727904069 0.26151018699432954 1.006293533426603 1.4516533650812895 -1.3612696740232253 1.1452877375718009 -0.65640860277155577 -0.52184359514985279 1.5770032477192253 -0.50515146404092504 0.40925722478346582 -0.93765897196157899;-0.01021507776863631 -0.40044044606241502 -0.049825546287150024 0.6042298702310962 -0.15840034264672354 -0.68592635906394084 -0.28203959777378518 0.091402420231150749 0.016198859535927645 1.6213900651137525 -0.63215844635297735 0.47557326059854005 -0.52631155860475221;-1.7057605694267857 1.6777934531700078 -1.0157666832005914 0.22486355814652759 0.64363309653227707 -1.7284133943303912 0.67061619317124699 -0.056873210972290832 0.81219500848967174 -0.24649039492104291 0.2341329153457592 -2.1363988939016254 0.043457416247106508;1.0863785757869588 -0.27129608891852708 1.6012817974276263 -1.0294373514747317 -0.314897334058796 -1.5405765031519372 -1.7459328673329946 -1.2208781878839192 -0.87044428963137888 -1.356170697480432 0.86559609309516494 -3.0248071656491362 1.1263081947399225;-0.49133340925636587 -1.9271670288973226 -1.4454525214012932 -0.19921546854282579 -0.40642075571090758 0.89163277344453573 -0.16085072345402168 0.60914774148432183 -1.2368001845093806 -1.0675589647276924 -0.21623622200053769 -0.8020825028502887 0.06508666340189459;-1.1751201123381287 1.069855258585416 0.077378252259021299 -0.67939777732484596 -0.64120012101667456 1.6035904394563842 -0.41054639577367674 1.140753067804593 0.6305927905867964 -0.75799256651052038 0.14434471211559283 0.74134075493527152 -1.1856211369307499;0.13253809136100064 -0.28957518474745453 -0.32682817244127238 -0.28224904802406864 -0.064617209985195684 0.75263216560132296 -0.21150257446096252 -0.3996851010274432 0.3680264259538123 -0.29300110967243109 0.42849904973338576 -0.74745319246664199 0.98266383973652793;-0.54253813185165067 0.52254030901575932 -1.2878987523791443 0.4076688926710455 1.0476643880965899 -3.1813723132679019 1.0239662037695119 -0.32011615751442252 0.64179012482372422 1.7018018418527048 0.50666625250930708 -1.2402753015435752 0.8372668598510109;0.091319856472027311 1.8041931509932605 -0.3836440669735765 0.77420032606942402 0.6701431027052196 -0.84956507775875267 1.0358523859705067 1.3724353654635895 -0.67765020525807385 -0.9635259260566561 -0.21402503435004105 2.1064389201156071 -0.60309936189585533;0.71436720628211881 -0.55500196609902619 0.44394793549729339 -0.80428804394704922 0.24521643056404396 -0.77193340178296399 0.35089807867387002 0.18514295732722688 -0.89202765254622263 -0.23413221255374767 -0.97652040274208984 1.3807812888797986 0.74596639060001402;0.58644143597740284 0.35055617836972286 2.4104918763534378 0.59713937180663379 0.14801816974032964 0.84150302817363742 -0.15921169711133071 0.60816127240034934 -0.19173108461046656 1.4828819854593878 0.61716346591697768 -1.6488941157044952 -2.2714700679823392];

% Layer 3
b3 = -0.098495490235087857;
LW3_2 = [-0.65914900042503255 0.45209179293324442 -0.415766595576819 0.77971966067299125 0.72225924299213373 0.39312933218786761 -0.99156034129932313 0.83163822409084998 1.3524543895237837 -0.29490798970554888 0.33018586554370427 1.011401404978038 0.52048592967893248];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
