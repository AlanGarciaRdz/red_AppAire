function [Y,Xf,Af] = SOXTlaquepaque20(X,~,~)
%SOXTLAQUEPAQUE20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:01.
% 
% [Y] = SOXTlaquepaque20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;3.03490136570561;14.7058823529412;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;35.0877192982456;117.647058823529;27.7777777777778;5.12820512820513];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.5126684874450951;-1.2812633463131788;-0.78092202437425351;-0.41352316786419663;1.3926556514773585;0.6966887677643363;0.9950114481586565;-0.5597405121743233;-0.26017507858122157;-0.011938611907639047;3.1510021009279221;-2.4322649089404149;1.9447342380606973];
IW1_1 = [3.28920324214771 0.48355721167193871 -1.5520864938940109 1.1800886194719995 1.3914796788082537 0.25368777278079352 0.13147052513632609 1.2191927870106651 -1.4195264391068882 0.10244147604233257 -0.41734904179560073 -1.2111202772797744 0.37400685487759239 0.78083920788098382 -0.40530183269118114;1.1525903100883803 -0.22340215193894739 0.26876874262660844 -0.08818093151162186 0.35126853353656462 0.24652864535017585 0.30327390665070397 0.46997464636027009 1.2115108699102519 0.54714964958341128 -1.116685435312728 1.2687329439956874 -0.37381951088014459 -0.020340754861184456 0.82456548793801276;1.4426439195733964 0.10725344692022207 -3.0902644663103267 0.30570925110875757 -1.0898783108365082 1.9731730101989373 0.45755179056414513 1.1640353001439161 0.26542917705930336 0.69739769328281986 -0.073287092897179343 0.048362327482537437 -1.1672075133307194 1.5926904851684527 -0.077904918844515933;0.58690048947846396 2.0983932222637836 -0.096739968951054967 0.20929548526191466 0.7468280900088704 0.14170887366004573 1.7936112256265473 -0.5004262037645032 -1.0438436121258807 -0.40705949373339334 0.43857418679630772 -1.5512415785599232 -0.18501266639321962 -0.48923945467626873 0.12578025367933288;0.75897069596242928 -2.1754451335051059 1.1163936286921003 -1.1271790985620287 -1.4940494692611286 -0.45112157047651219 0.041056289232208526 0.25498845572210371 -0.18626397899257097 0.47535783504867712 0.10539844597193274 0.993984992383663 -0.061768818470887624 -0.74319551555920893 -0.094373458300475929;-1.8560155217247065 -1.1929616950691986 1.1880861993829819 1.4263270165137825 0.11469572098493358 -0.77721276215090385 -0.41187638319481623 -1.6870060650238896 1.0016955612024598 0.13191503901194795 -0.12162148180906898 0.92114461610914899 -0.046867326715746366 -0.61583615475008779 1.5900994404874373;-2.3243586078349998 -0.47960347709898032 -1.5707499230647786 -0.45742201096483714 -1.2082228344281887 2.2373206267343253 0.28490341865858665 0.29515797268406141 1.536288668385386 0.67773381857087045 0.057594527975052351 -1.2163079710174229 -1.3668673669595357 1.3762936910559644 0.79940563396973485;-0.21960825003384957 0.3801547635363286 -0.36202711685639399 -0.13982152962169972 0.16228042886986938 0.21642160601340965 0.46333919199532364 0.055423989593210238 -0.29027300321004257 0.45700980414274722 0.53456565748038654 0.1307905424309263 -0.44019627787126636 0.57847058383358541 0.54930436936292015;0.77589073744079973 -0.024891068510324139 0.49765970116363334 -0.18187122818512619 -0.12624446085219707 0.038941611011326614 0.26559145489308422 -0.12406389335392662 -0.10597271993883137 0.14665147143808971 0.04509631780936707 -1.1053255684338659 0.04311691070780653 -0.090061162428528269 -0.15446053848534225;2.009730637381971 -0.79619519521528082 -2.1647489461490634 0.41096767297989178 0.65221704583874685 3.8855604278682199 -1.885166332145064 -0.27818809447771409 -1.0201238718960142 -0.3070858562153303 -0.235918140456473 -1.4077891144318311 0.3646908653405036 0.3143060272856123 -0.91269857891492268;0.39197713172486243 0.063637003353597399 0.11425283641042683 0.0061805771841133214 -0.031550652432535277 0.00057264011622787381 0.15131523567020846 -0.05709183962160895 -0.02510591309344215 0.058984735084679621 0.0021680156183360826 2.8776912746176366 0.017225191987507344 -0.048200070395529829 -0.053803955378397675;0.43761316219123753 -0.25865254398110515 -0.86307678425147005 -0.33197170100650042 -0.82010192698160134 0.89003590990042736 1.1105218759045841 -0.63247462448553604 -1.9550604368808444 0.24425689419232863 0.78366883284987832 1.35111627124412 -0.65390132261823652 -0.61955369437467289 -0.44501284852239209;0.39695984436055198 0.49273127324520866 -0.93087622135541614 0.24649226812300357 -0.860865456690174 -0.61077532798498801 -0.44413849859259752 -0.12291615472783222 0.23660913578724924 -0.20454651267034293 -0.37364646301165327 -0.058091853208424971 -0.39203060685679963 -0.13552018341678512 -0.074989582056448442];

% Layer 2
b2 = [-1.2110918779713371;1.7711523833576579;-2.3891982921627899;-0.55543974154652687;-1.0161797930072716;-0.060203711784813194;0.070907211925376121;-0.6936156261266041;0.92198382673676071;-0.33029158817614901;2.0130271041605998;2.115313259010505;-2.0442692247807162];
LW2_1 = [1.0101938698126354 -0.55553466508556437 -0.46537465834600439 0.20922169668826307 -0.39637387207504826 -0.10578106275673094 0.87278853334788675 0.24797190792278967 1.3472789382466663 -0.22256928525214187 0.31079819621898669 -0.18943252792610463 0.43261457329821057;-0.38920114021874691 0.050353215367360593 -0.37647248499722263 1.0282697189800616 -0.02841187338070162 -0.053237937430774845 0.86521091713023668 -0.021688574915674802 0.55334613757761009 0.41593812580618 0.45168111019015184 -0.60879258815566573 0.78311408313134667;1.3260935672223577 1.71477615995777 2.0549042602875991 -4.6088369845484074 -1.264288031671855 -1.93418648636391 1.9530766891811027 0.34984912552416386 -0.30005113636237229 -2.6919504257264668 -1.5354516337857407 -0.41638807638935593 -0.71001774143109464;0.61945171793560416 -0.022743848342243578 0.71634451120063303 -0.046312390743742604 0.507551712109655 -1.3142381736377473 -0.053881295393572615 -0.3649366269029648 -2.8072973922196351 -0.21397761488124045 -0.30020766170743429 -0.43536411869193631 -0.25936699706146965;0.31068638349284244 0.32227347352335145 1.2996903544662703 -0.26166272145296349 0.61079408752652242 -0.41456990191403098 -0.15220628885625381 0.62143088064975871 -2.1291358318519928 -2.4223038168226179 0.74285871421414373 -1.186580295796281 -1.30177110962275;-0.46221113083495946 -0.37630583699142162 -0.5228425214048168 0.13911438773231852 -0.13514153987768479 0.50665497446633279 0.051907490546374183 0.13452212470690994 -0.50556818724369146 0.12842090757841709 2.8373418424618939 0.22963759960586799 0.59358954317666901;-0.21800712073682743 0.23154435615011354 0.2103371506707104 0.36748622951626697 0.40070314697213094 -0.56284710096843271 -0.0083234676692058723 -0.19523449232429319 0.21062848324565384 -0.34707785468357816 0.95156814224318309 -1.0894187877297936 0.73184007299629572;-0.5004780423801235 0.073429286761566986 0.025834391929659632 1.0728664680691686 0.138963096410537 -0.021531131850200891 -1.2223990663561417 0.46218380375284979 0.57172160470850619 1.7615506426502894 -0.70072837833579604 -1.0285761446264512 -1.2171834511165189;-0.15120681842907494 -1.0667713062405819 -0.7714689869428184 1.1890905178184275 -0.15911830954133116 0.084018353185020822 -0.33736356512769272 -0.42067603936220715 -0.11098256839128466 0.56136207281982031 0.45407015497937597 -0.3558451251909584 0.87854329042912915;-0.68686874443999968 -0.089268715627117703 0.034403726264733384 -0.15478044658842188 0.077238998728477198 0.44022232944486145 -0.63068720826976354 -0.376270818188017 -0.98308154807570569 0.440415930227116 -0.50700935037569828 0.55145853270141854 0.26086561516868328;2.1918740910317287 -1.8636356215454311 -2.1596761833534912 -1.7608411418583447 -1.4377711938583793 0.0048155578702072238 2.2008401194969776 -1.4290021678347902 -0.027784850022214369 0.68875283927910758 2.3491649324893915 1.493973656217918 0.51876626320055474;0.84153800221461128 0.071906663683103153 -0.9726620880504987 -0.31381357318422198 -0.36918611051929251 -0.13576547740753975 0.99161656619723737 0.041780306775459561 0.31218169589614592 -0.2358517541948906 -0.68742825112077066 0.40546913267502249 1.0729672794285259;0.0931388283528439 0.29656529685507693 1.3448875232717095 -1.2423141197199914 0.017586962870330514 0.6180518494855225 0.43961288358509343 1.1538220660902285 0.92192393295226183 -0.7838633140989153 -1.2799963685696498 0.75995840521226343 0.31433245369112628];

% Layer 3
b3 = 0.4703423292111113;
LW3_2 = [-0.29793248958392632 0.8799325285775389 3.2191610313412196 0.57201422425549242 -0.35654991919736256 1.0786557605971401 -1.121100172175276 0.046005079673824202 -0.49902518884357838 -0.34222204627580904 -1.4958660780113502 2.0210433558111838 -1.1315873578996565];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
