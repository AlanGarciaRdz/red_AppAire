function [Y,Xf,Af] = SOXVallarta10(X,~,~)
%SOXVALLARTA10 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:05.
% 
% [Y] = SOXVallarta10(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;10.4712041884817;0.00782778864970646;0.0208333333333333;24.390243902439;0.02710027100271;0.00630517023959647;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.3673289957362593;1.8224402084783187;2.8780154755012846;1.1836739057973393;-3.2188489050709217;0.91993182116211847;-0.15865055930441052;0.37256725383505374;-0.95899984996412913;-1.4798990023700851;-3.2061675737990587;-0.98002402999025617;-2.9058219936386118];
IW1_1 = [-1.6629231069760508 0.051287212413651903 -2.0081503731628398 -0.024667301564479306 0.26238040772445986 -0.023079959710175839 -1.2383820177233458 -0.64021567744304775 0.08226679941040968 -0.25753227100334874;-0.62733465893439344 -0.27489857390620087 -1.2092706763016472 0.38725958532149696 1.481002318958343 0.30627486908165763 0.052420816150356569 -1.733242335455103 -0.060003878538722924 -0.69410418820099806;-1.3641594317592489 0.22227020293410177 -1.6442969108050749 -0.05521924084912512 -0.76482292593687451 0.26682919467852739 -1.2505133723957713 -0.67899541493177618 0.7636023831982216 3.929856957906932;2.2608411268714259 1.5841191263169105 -4.4198372215255812 1.6484432621292484 -2.0654415632546788 3.419578506116483 -0.34529763410462999 1.1311893472542038 -4.425669862520901 2.5821295725083058;7.1852134169625712 -1.1368100292854799 0.28274836818695864 0.76144884111430033 0.77240471783242948 -0.51899399628138454 1.3403503822043674 -1.4088107444667568 0.023629801419086792 0.2501396938154728;-7.3764278215318333 -2.9256978638447624 -5.0590650691913694 -1.386136756914772 2.5532020642023392 -0.83819390071013267 0.59808920942675303 -2.2413190705459498 0.36937095842330814 0.20631115728009439;3.7950690157077522 -1.0756037704900303 -0.64962958726037434 -0.56560413690326161 0.55380741598459338 -1.2291626812185348 0.4369703759098808 0.2093524275512427 -1.4854941795189853 0.83122983839561149;-0.042035147168872751 -0.20232188403198983 3.6676558450558843 -0.53562056778914868 -0.4859208267228311 -0.25408433966847777 -1.807764141220098 1.1465164711391012 -0.54693972445271521 -0.31320126263202963;-3.4677754825900351 -0.3469331157471196 -1.3201693917272161 -0.8988149489996099 0.28218252127579024 -0.79846807671893583 0.68685019876648379 -0.8180563591994563 -1.3487316759835108 -0.74858912382795251;4.816327840459758 -2.7049283281097978 0.58832691728467601 0.51925084218809092 -0.071991327472651065 -0.39295034098829407 1.5186922722736875 -0.19019819765107071 -0.0074871062522916506 0.14195659659862686;-3.9460108869588821 0.57422190115473104 6.1682327332845315 1.4066924491085429 0.51217943216826001 1.9333411455687555 0.85822994488742388 2.5222389718460061 1.5004780596015403 -10.143731132009618;-13.087006564006664 0.18093605425794512 2.7696328700694863 0.33617531729420752 0.83672252908144196 0.7609931939972201 0.13689191872922352 0.46880366554759795 0.82083986433607437 -3.2639295391459395;3.1271657961215471 -2.2727716120567312 -0.57671251984023264 -0.42622671588648453 -1.3221806690320395 -0.253236415306204 2.4020560480762616 0.70499776966836158 -0.26696157731517356 -0.60427506826580435];

% Layer 2
b2 = [-2.6292875860471527;1.3505537154629981;3.4952995098977624;0.87605734218373776;-0.041648525906355975;-1.1972955545075534;0.35271212519525069;1.8039574848331432;1.3209135354132076;-1.1777077221086021;-2.6536764158910939;-1.0086167086006821;-1.3548273835441325];
LW2_1 = [1.2610771614527225 -0.071526043911625814 -0.20576576655793372 0.660257929813577 0.24001948830638725 -0.084241769430676669 -0.30390031920463906 0.18680570796090798 -0.70632999091146353 -0.6038364604113049 1.9101148177104044 -3.0605386112458186 0.67595339314058533;-0.61778296335524863 -1.5431972536360381 0.56958556691227447 -0.2865668582151617 0.52238417205321541 -0.50641363212937152 -0.039783750704425573 -0.24447691566836938 0.27130467284414667 -0.15377873488574756 1.433963060660979 -1.2361791505649542 0.21677075511909588;0.70086555315875754 0.63211129165690794 0.45990964370214144 0.10923928763090837 1.202750325962713 -3.0381699534347599 0.12749048162441665 0.07314989839808797 0.3882710117453182 -0.44871093957862213 -0.80505166917340276 0.57782589565988884 0.34244622611549341;-0.17059785061936861 -0.64685617410612772 1.0589206914192244 -0.067037465904487267 1.1435221851709776 -0.53390003824694654 0.11073842534901437 -0.35137833802614249 0.45023750237469068 -0.43993674529849763 0.62312394269242111 -0.37504243859867892 0.19794778360949897;-0.092997712991828518 0.047677559781417383 1.228357009489218 -0.053146456505644694 1.985861082800622 -0.4544189319444592 0.28263407285401565 -0.38184776279984478 0.73481236801585414 -1.1947847968159329 -0.22569247830420139 0.045454804913872077 0.37582192836391581;-0.16662709912375526 0.21109789966673906 -0.4017999246634576 0.018572390252846023 -1.2897805247781964 0.5187796081781415 -0.24799246095188818 0.30356202630867973 -0.40566676005855756 0.5117022319213933 0.18919764209145337 0.22073167824075085 0.16271682897887235;0.23302764993044728 0.22081184461187095 1.289114623551403 -0.0064427199885636333 2.748001221840958 -0.48793649053436294 0.41541708410885209 -0.36633963792557195 0.97526227161901013 -1.9760917372933564 -0.77639255344640001 0.59308774636355899 0.78095174462169326;2.4736690388167335 2.5908054930818776 -1.2331891841702838 0.5963548561173222 -0.91879870976731925 0.8623415988098172 0.096749103657428351 0.382990344009356 -0.5479242177281769 0.4388982217054036 -2.5276711088040966 4.1067808441709239 -0.46678065801939395;-1.1180854277630459 1.1364336466097162 0.86875233338841984 -0.059428175948226802 -0.70743395841821655 0.86415104145933797 -0.052461889180621731 -0.16557446813903021 -2.6027553895724531 -0.99408724719566621 0.21594716138651174 -1.4713333210393948 1.7607514253453334;-0.40399589172481049 -0.57894692608720921 0.92093778912126878 -0.33146031411177279 -0.38294141854386632 0.099455719976107332 -0.48855855881138061 0.029914572588252163 0.13950289872770011 0.14264030171425035 1.709769181275727 -1.1177129903929153 0.63710529079975908;-0.15695135870250276 -0.35198308054800842 -0.80381014965520026 0.073831136541640668 -1.201163038265058 2.5908389421879212 -0.10578836548119956 -0.0038870545914380071 -0.39864430721950544 0.59932466195307521 -0.099709203339129679 0.38940129397462048 -0.45126265433749047;0.12389162088092869 0.20656011461544521 -1.2109274085106991 0.10977772588802151 -1.1562514280905622 0.69401456705135711 -0.15723406203280002 0.23917132473681291 -0.37557113611640475 0.58826029102137189 -0.70083585646838353 0.8440137853039954 -0.15176461803142313;-0.56310877649273972 -1.3985317428106063 0.48838352842493765 0.18051602797196717 1.848048852787364 -1.1322762581994492 0.16419753203154669 -0.46194573580048232 1.4662859724748116 -0.47872671814895995 -0.48159696960502651 2.2012138957808367 0.48058814202836547];

% Layer 3
b3 = -0.29449245071182956;
LW3_2 = [-1.3576098247632606 -2.3119496704157623 -2.6944715303383484 2.7569287800778781 -3.3249536806953444 -2.3256850254817616 1.3129713470120608 -0.8293776725395029 0.68995440935580477 0.99421220711569236 -3.594908451411075 3.3573972235648166 1.1378154368428308];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
