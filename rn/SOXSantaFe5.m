function [Y,Xf,Af] = SOXSantaFe5(X,~,~)
%SOXSANTAFE5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:49.
% 
% [Y] = SOXSantaFe5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.101700681759247;-2.0193038914578292;2.2143266917534157;-3.474794865219851;-0.69687531097514754;1.50366994804504;-0.31574003792397154;0.60372158036754986;-0.34710043335605945;-1.2987381311396289;-1.2501984013604557;2.752861904355254;0.56179086204871598;-3.8705103724357577;1.7430269001023582];
IW1_1 = [0.1901750276565376 1.1773176933086884 -0.061885327034593381 -0.34572559876263947 -0.90087784497329682 0.9255152219221815 2.3120688697080838 1.1332844695597424 -0.32812666214603425 0.81960113058755579 -1.5610967027579552 2.5908481015873455 -0.31176133717607363 -0.44567297928870292 -0.39187333770587285;-0.019490218769345171 -2.923542951525421 0.051035979769658714 -0.69712374823034284 0.55251464800669037 0.11819433432949319 1.1963698794707751 0.39370561893872213 -0.2595394150568906 -0.019000522884082313 0.21996308113056742 0.56345213770940172 -0.91591121640378748 -0.008100627804225026 -0.37978243917776294;0.99148362338966611 -0.25684848772796226 -0.39644059582374824 -1.098231113769921 0.87464419993038678 -0.033143576381125361 1.7744393011842263 0.0080540762316295977 -3.360974949355696 1.6615078870608404 0.20410437171725748 0.31611523614399256 -0.66924895332340606 1.0481856103062059 1.926299921427679;4.5664081982596674 -0.12186807604405712 0.41772278104300475 0.053063598838571077 0.098031595197435678 -0.13288630623149827 -0.5708681710857284 0.10237481464659928 1.1266160075348441 -1.8648922870143687 -0.20060273176980586 -0.83976031671130147 -0.014013682780821209 -0.25591709823022069 2.6177316905383372;0.62841180975143263 -0.74594565475994423 -0.11015247493757828 -0.43913456926364813 -0.12386086369346665 0.10265616390803889 0.84436515035036863 -1.2518098973768457 0.141927496408805 1.2610613518652876 0.14655225308006786 0.22762424763596983 0.14999209827223223 -0.36143461064711685 0.92294299779188416;-0.14857336770221366 -1.3732890122096839 -1.0008896895718411 0.1682392850899089 0.42712547051053462 1.0443511242700352 -1.0836077750302258 -1.7850715372483212 0.11705919846285427 -1.6785767884167659 -0.54797855875478019 -0.3327522939316927 0.24256674185529897 0.15658735084194605 -0.9277191729382146;-0.85873406144016073 -0.96762846466417174 0.12118546917777141 -0.36582410857698472 -1.6015873125330657 -1.1732262190437204 -0.23272271318216423 -0.77116542678971134 -0.13734071298103714 -2.277261137723813 1.3224813368359214 -0.85118959324894161 0.7866655020933504 0.3971147845319567 0.21187870947745319;-0.368087934053349 -3.1978456493530745 -1.3993898775651232 0.27740092693514223 -0.75489825743751682 0.0091912508847204477 1.2057088423509987 -0.11440068374756293 0.4174551756494701 2.558834396387494 -0.42649783007332814 -0.061765534800334629 -0.91506309943469022 -0.15940648672341146 0.093882276838514273;-3.3568463219651252 1.0035341800658719 0.97023496321213953 0.94555719251006765 -1.623936312094447 0.42797784570557018 2.1604670172227238 0.047689018294946678 0.54804077929498451 1.3423846872329841 -3.0619117575451176 -4.9582191403946378 -1.819818922350821 1.7830914078069322 0.53189140534275814;3.8599465901273877 -0.093375171033275597 -1.1821012404834121 -0.98525291013485516 1.1066750876218645 0.19575579916394206 -0.43594452833965247 0.060345350822658662 -1.5566068275569682 -3.2236722149432153 2.7610052935693998 2.5795974471661665 -0.033562706852421707 -0.67177782898111471 1.4704621577817296;0.56254019842484493 -0.74706783029727697 0.38750411142909907 0.018070493233723568 -0.18515603188124907 -0.72276410048858808 -0.053969748725342964 -0.27261631672044423 -1.1798189133812078 3.1441665705168078 1.3797445929487877 -1.8468339497618831 -0.43079192313617154 -0.0054365390379390588 0.81123601719037042;0.09219651540649465 -0.010654738309406067 -0.0149729166068774 0.008049591981381294 -0.026486332049997622 -0.024798773770754384 5.7322759866431337e-05 -0.011804735530016583 -0.0038640126852731533 2.8232011708175442 0.030079433170636161 -0.033168792958249281 0.0014705596263255051 0.0015682865416131793 -0.014905787433134556;-5.0588835264611784 -0.46164480264875685 -0.096573508152077159 0.65954969994134016 0.085006849197151305 0.028878947753111932 -2.1382954163518839 -0.091184886974199353 -0.45936126981337566 -1.1716842884774898 -0.12164350691212958 0.73069070731184194 -0.016904725024305126 0.20208996821689781 -0.73600788625171942;-2.0310101798303299 -0.77305403324511812 1.3387448331160881 -0.027156597319257382 -2.2857286553215199 -0.23957779672123308 1.0597387539134684 -2.6380637216530833 2.6845026154807403 2.0608871189750699 0.55578952728200837 0.2789783250297827 -0.44029826968207475 0.94312510209530276 -4.7158338035533305;1.0477735706892155 -0.31230761059103479 -0.45937721923880143 0.093458570197367044 -0.14859628214131335 -0.20798191186560361 0.30304590326243686 -0.18333908692495485 0.056979891808899799 1.4822808114588972 0.17721937088401066 -0.49189087546742105 -0.01887388789503627 0.25717330131695254 -0.18774054606149937];

% Layer 2
b2 = [1.657147194346871;1.3991031376422696;-0.53086136418885554;-1.7183875491225626;-0.38374112127141935;0.38197887243314949;-0.22181040976912131;-1.1434475760630087;-1.7287990377706144;0.49415610832058909;-1.1407206441417819;0.935038798886907;-0.29331181716466015;0.80821185643505811;2.9010412648528052];
LW2_1 = [-0.35735518071508082 0.8889399529066484 0.052574052538148952 0.28213281320057715 -0.45680416198570684 0.70084387381670821 -0.43413035122060117 0.46611265858380796 0.14564493354755259 0.027432932627906026 0.11553484948829514 3.0112019459779389 -0.71713471088771941 0.69141948836825495 0.036075250936080973;-1.4315910436229562 -0.09025624313491612 0.10374364228018176 0.99496828549872385 0.83104400119064781 -0.73757450390200374 0.41175572435336649 0.86514466775729371 -0.4915228751712688 -0.46277970304967669 0.2891821579022501 0.4746673360634881 0.65652935581902516 -0.82123330619773971 -0.34755106267290381;1.045897367490989 0.047589462774110816 -0.13099523126499885 -1.1391226768269165 0.11672470712009916 0.069727880062560754 -0.1902943879111666 -0.51247252833313228 0.38614454189203556 0.51884622975607986 -0.13716179512078608 -0.71930724787604627 -0.83593876778022869 0.14904136987879832 0.19631881845260149;2.8106458987999394 -1.6094973742315768 -4.647600902741714 0.31597492580388292 0.070836316690916681 -0.57406766209473226 -0.76242323555040559 -1.6373904760409939 2.8670031956350606 3.6825861986608395 0.19389480384885691 -0.96343790734706114 2.0491589266526917 6.3122621612328782 -0.46224832341660693;-0.20740815764076215 0.54367050159121211 0.03907562999978869 -1.1551380444965682 -1.9178823866869454 0.72207613194372555 -2.2741972836534705 -1.6063470343259521 0.15543641336857486 0.071264053913427688 0.73564340313480958 0.15554214680612127 -1.2029080383087489 0.62423284352815989 0.69363336563073319;-0.14777896137966839 0.090872002890233769 -0.32241201698699368 -1.5060314666310859 -0.58489740173890425 0.075968141090766161 -0.79066140762059456 0.85272014544402852 1.6892395689247628 0.45362421301538219 -2.0476588520897958 0.17487560654077527 -1.0468057880907038 0.61392795422064106 -0.2149319908078553;0.27019376726182842 -0.59406921281232972 -0.14054687416576594 -0.47128231610636084 0.69899554540305386 -0.58394187324904867 -0.55904671108551263 -0.46701543193507544 -0.25849994970332352 0.14500880931296334 0.81371822238077085 -0.86697608817591776 -0.11762896106603869 -0.063932344912524169 0.0018504367342826247;0.92473352513660212 -0.098209299524065652 -0.10632364067205194 0.037913704176274265 0.62692773886345954 -0.74256530473022908 1.9186337630592909 0.10250823131556071 0.11492230371131495 0.33399276289129332 0.3912664146175488 -3.451168008714228 -0.082032173089451349 -0.37837308527026392 0.038419772748039524;2.5374858973594248 3.6907476317162176 -5.2345068054262915 -1.705460248822267 1.7051782588945545 -2.1964227010056243 -1.7333734407467705 2.0590750226130119 -4.1848174206058681 2.0264856832302924 0.56982272427572422 -4.8624164465428139 1.1990476577828308 1.5321963053886942 -2.036622979690256;1.4466583221778948 -0.26677792662131805 -0.18170611607182238 1.1832086611526791 -0.80510180685909327 0.52882672450438939 0.74951527221051539 1.1956143184951509 0.67078815665683889 -0.084498665828834099 -0.93625893727373732 -0.50038966240572602 1.2818986855594532 -1.2486988008551783 -1.5649703580385019;0.081748012349226795 -0.67105215327464984 -0.14255063637745991 0.81155921341634429 0.39237737415181662 -0.68204895332903237 2.6282860560240144 1.6537593781895135 -0.028350985977361437 0.11564930939287316 -0.3717538248347998 -0.30420981571135253 0.89283081627938321 -0.36121970787548729 -0.77736024042548335;0.87835444056708556 -0.24455832903665897 0.17413044621673751 0.25055147163263514 0.99680994357434693 -1.427861469313314 0.19927775457881947 -1.1909787218080805 -0.0770161636488918 -0.43389039196029905 -0.27440318606899178 0.72178181735362834 0.49327014918255985 0.22548761894225897 0.71247597238328408;-0.35743446754745883 0.20645228455709469 -0.08072037126826187 0.19550998476170858 -0.80466374402481278 1.338824908630204 -0.40500818798677302 0.56975468549226083 0.09929124840256201 0.2776403527282662 0.26774135391309534 -0.082889325497641414 0.0064751472309029327 -0.032027307979834767 -0.26171397814676089;-0.0049543622722817426 0.43598977799523053 -0.21712613664959285 0.46448318319845638 0.49593958405824995 -1.2527269214126338 0.49383568086466517 -1.3960173276705823 0.609030749637965 0.44958814771469291 0.93736727121651597 0.19879957371511636 1.1418671571156738 0.53983230921481817 0.87407946103664991;-0.53596159689390688 0.10823746977967161 -0.54052325758275965 -0.051326698974190746 -1.786931879970312 -0.63798436737347686 0.95477592445629933 -1.7572756920720094 0.19161906307582854 1.4259371932880687 0.27140051525379238 -1.9479482637268852 -0.045908839407141508 0.34664297217963463 0.99505849398073687];

% Layer 3
b3 = 0.68634219785363415;
LW3_2 = [-0.18319782404769119 1.5478205769046893 1.914844323819817 3.0369499585951778 1.7740932015603954 -0.1402978467876049 -1.6039266698948906 -2.0479573956147048 1.0618813712396833 0.24815632696485057 1.7499603910238513 1.2213431743885228 1.5948592695554553 -0.3762432216052628 -1.3170167772507961];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
