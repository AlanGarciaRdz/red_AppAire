function [Y,Xf,Af] = PM10Centro9(X,~,~)
%PM10CENTRO9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:03.
% 
% [Y] = PM10Centro9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.281968137600451;3.74531835205992;0.00773694390715667;45.4545454545455;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.8224208070786623;3.1967603050695517;-3.1432353087249241;3.1312124894178095;-1.7300404740670887;3.9552413450449282;-0.71023248963381214;-1.4225190440889457;-2.3917795570539755;0.11711880356187636;0.093644773573160214;-2.7015641133597317];
IW1_1 = [-1.2764877292625398 -0.65600138833430444 -1.0357399408381636 -0.67567965544314523 0.38198851630287745 -0.2212614576788948 -0.44617933874297472;-2.0232061766316538 3.2097877268646009 3.5718733504298203 0.062714792742746633 0.25966538282595353 -2.8538610403553499 -0.38149179278178397;4.6221300133371388 0.2166675910292617 0.26092178962238338 0.1367664292928249 -1.3683211800114572 -4.2407622169183066 -0.24489427225259816;-4.5200688569230012 -0.072595995734040353 0.48757569187255079 0.20018712590045121 -0.6312185215567746 -0.38734495453292261 0.20784364270630526;2.1466643923698383 -0.16459049847542745 1.0147499720168038 1.4407732666943129 -3.4642610716223627 -2.0019859743298212 -0.98369760986722699;-3.9382910599604424 -0.36673743546359516 -0.078853780657760664 0.17120954312328321 -0.27548122019502658 -0.34422034191798428 0.27677749266830343;1.4146405112124159 6.0739100372775043 -0.18261065195967441 -0.59450474054480507 0.52219198715112425 0.91968003336549231 -0.71578449321355442;-0.93261034643571372 -2.86439699663143 0.2767714853570174 0.38827642464605427 0.8412227933138936 -0.28105730826081943 0.7038797132686162;-0.77625374084359366 0.39837271027304455 1.440879639077888 -0.25564278648391642 -4.6855533873926305 0.20211301451111524 0.89358839694551195;-2.3938718170425677 0.1272233135469536 0.21229713491530233 0.014086165329300362 0.67280644136914136 1.4665968853002702 0.37096375203907905;-0.026230701933863593 -1.0997277945893875 0.59220824734651845 -0.44369209856279035 -1.0862611859008473 0.39839806541351591 -0.47740856342312693;-0.62684097889428458 -1.1946706964259344 0.70049860979351009 -0.5242929547077565 -0.46987163119486314 -2.8976672309938958 1.7277693301400094];

% Layer 2
b2 = [0.95831046987993651;1.1566840591901781;1.0392901856074264;-0.95732697879773698;-0.042668808201918706;0.33218020479818833;0.74266542681547754;0.99279845386161303;-1.1528835902113068;0.97273162336047958;-1.9902055416529691;1.2060024753323111];
LW2_1 = [-1.2186311548685216 2.0234573582640638 -1.1596296418011649 0.73055264057859171 2.1132672935057082 -1.7362145656854788 0.99129623423231661 0.35483952466216662 -0.4504207481277433 1.8264203843798144 -1.1356053735683336 0.47293031562482157;-0.42519061669965835 0.22581347974663285 0.0029128953100111023 0.35739064422245781 0.18699122188556647 -1.6967334964842045 0.19188997463236845 -1.3573971837562706 -0.96427352637659391 0.64299430591120743 -0.76358929302113054 0.085839548250651876;-0.18628450212108813 0.37119182474978579 0.25642124674546002 -0.036574749597781044 0.038487160725961464 0.16140672681910065 -0.59773872164216002 0.27497719601416348 -0.34988444078169123 0.85293240418000105 1.0472413270427912 -0.28302445404116228;0.42820400380610973 0.055832789334256332 0.053252835381594449 -0.10136232345386705 -0.70304229862156276 -0.07731799988468295 0.14879490430330364 -0.55194585500092941 -0.97092604700065988 -0.42196629681005482 0.10856884844519092 0.039923806754679471;-0.12448517026631567 0.52108114623456947 0.24890994726580051 -0.012786576412872567 -0.15719827729790012 0.7385524424426273 -0.48058179981289512 -0.0071627960229678107 -0.50642007995470939 0.38526444368415824 0.99927540632927325 -0.17631163087561158;-0.5562125110929278 0.40890349099490819 -1.1420081733376206 -0.54593792152821374 2.142867634210599 1.7915455780320819 -0.15406863426299014 1.3788881149770726 2.119388382182358 0.48762998036623484 -1.0447607608532568 -0.053610555356405354;1.0938782521218109 0.71794284019419108 -1.3627838249988105 -1.670769580621104 0.83221890402995047 0.6143332661263109 -0.46265643217847574 -1.8684625113993472 2.5240577834846154 -0.96355683981775808 -0.92375308509051157 1.1807660663348742;0.6225715017912602 -1.8128718296434345 2.0980928740189744 0.85852862544753106 -0.59699280229903384 -0.080137864489173871 -0.67703047841083175 -0.46928355691344403 0.06430299715731333 0.55739480192889679 0.52867901621378888 -0.40079860970246289;-1.5593673251965106 0.57897879721578849 -2.0630244099950472 -4.1349981411612537 -0.55726489365938947 1.4742084413052881 -0.31637386761922837 -0.50090399212495795 -0.095670942510739806 -1.4656026781635429 1.0582851173293573 0.55885141907907365;0.49530015620309115 0.71341744002400009 0.30039340909924611 1.1648702415031567 0.16366256979586788 0.77045815461571521 0.36367380549234812 -0.081710889429736033 -0.59931370024105424 0.35566289518895544 -0.19303534528081784 -0.69761398620763859;-0.43249139023454136 0.83068870991573196 -0.33331762703881229 0.42789173592938334 -0.47320612078607571 -0.16361388816850492 0.13963262676887833 0.66385876983725911 -0.081029370343231835 -1.333572395495259 -0.59575785614214605 -0.53402039062722206;-1.1531984173293448 0.00072263363620445054 0.56054735906109299 0.95740288894946468 1.0324293222154621 3.1413687381211681 0.88049084504285102 0.3250117737276898 0.21867624247701922 2.1248670726836636 -0.64517364205344396 0.49758371897240855];

% Layer 3
b3 = -1.0690841838692824;
LW3_2 = [0.13410126372169567 -0.39380548047553965 1.3756127891059928 0.74030220629040877 -1.5532274846591967 0.20296669160169428 0.12225542083552091 0.30479394435188195 0.32417443478139057 0.83758754673646374 0.66401658824705267 0.41338342760139712];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
