function [Y,Xf,Af] = SOXSantaFe16(X,~,~)
%SOXSANTAFE16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:51.
% 
% [Y] = SOXSantaFe16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.551013694777323;1.4401975316011559;-4.2352059311174788;-1.0573606862945668;0.78209144791899177;1.3896016915135261;1.503998476311615;-0.52003621642259001;-0.81551311839527052;3.0981008131285401;-1.7511508397694311];
IW1_1 = [-0.27801849803364664 -0.13486058516358812 -0.28240616035867033 -0.35872206354896363 -0.063006863374194658 0.9863270147121711 -0.089132334873325447 0.10706948573271864 -0.62757053640954552 -2.0148639896090788 0.29596652179445987 0.49845628014600907 0.44816262291554521 0.15574851075134019 -0.14089548962026077;-0.278943885507143 -0.00077186578980240061 -0.0096412844816845533 -0.30739257177166113 -0.52732274095009046 0.40157506601918441 0.30927410798423821 0.30538041649916725 -0.18369605098907005 -0.22491116121999258 -1.0946630778220336 -0.230491624575555 -0.070755824060809464 -0.12517175014635012 0.49723959619423141;2.8505875458757246 -1.4511641064049141 -0.45028646632741726 -0.18750973490494571 -3.106546739389457 0.29813735953447607 1.3894335328925149 0.16379191451698788 0.17051604635090642 1.7297983818577622 -0.79349397578670977 -0.33846634138871273 -0.0046428071142724653 -0.21934130297898763 0.52906437616448521;0.66359704497358651 0.38388565504423133 0.42696530666966231 0.49935848396747673 0.74158812124164231 0.63770805834794975 0.19685854940287001 -0.39876224442128583 -0.34746768997636512 0.42861495374593489 0.0091715280268406512 -0.46019580057365378 0.13784704984449836 0.70911302988307445 0.4204544368379351;-4.4726315150291889 0.79103968633317678 -0.94830099242164101 -0.44239501606013421 -0.53528977316302562 0.9974885801359995 -1.4162890571591364 0.014555704896798992 -0.94691096434975019 -0.83654700954545735 0.76326036984343137 -0.28001127005348053 1.611389417191293 0.60955357741345595 -1.4742618419797595;-0.69678203895567581 0.29028072525741744 0.2492407578460025 -0.09595423756188623 -1.732921230022016 -0.29625183282806594 -4.1212103183522437 -0.51684959140296727 0.048532578961970912 2.5472393401228244 0.85905591944500181 -2.7015855591220643 2.4320029375725762 0.7910619504844425 0.86122844318745484;2.0744857256288993 0.011104479594100051 0.26855563314886283 0.37483124592526762 0.60864457800568084 -0.066805190219118515 -0.51483883319310864 0.10712075713741921 -0.36617338297212415 -1.2458853769235707 -0.19723163732570334 -0.24137219514961278 -0.40983102399286087 0.10685821203073163 1.0091198576821743;4.0733288121914066 0.08000968368677383 -1.4174437523597569 0.20412373861179245 -1.1295212945947837 2.0620987565131017 -3.059771214370862 -0.064748264287425708 -1.0117103603539386 -0.12840633707335031 3.7446572313192865 3.5201352371583163 -1.5920055977878909 -0.64992134525701029 0.39787157679964769;-0.95482083366131743 -0.077321746619819096 -0.63988264230345571 -0.46509856515244824 0.087183738521456056 0.92752560837114562 -1.4000214538027624 0.10484718610965787 -2.3876842859405594 1.460023230899655 0.86668733479027826 0.25416833678842266 0.84173240967097696 -0.0068529608236596179 0.86231294190404206;-0.27594281543104787 -0.16478428601130118 -0.3405534227053626 -0.39565265297859231 -0.10771210510784994 1.1737972795638494 0.03927505020214539 0.13590446285208033 -0.71695315123377401 2.8147943576451864 0.25132706772641428 0.61054648584135573 0.49779160534886424 0.18164545945486338 -0.48445179886138612;-0.38009466569004502 0.03304970896727305 -0.22221315405957145 -0.14302978476588152 0.37984761050268978 -0.25880429636243862 0.15088682882872562 -0.47609131773605923 0.75865289125828073 0.26529064677369918 0.46476525115480721 -0.57271291177580741 -0.54955219307066427 0.14173307612348329 0.73390898564579132];

% Layer 2
b2 = [1.7881825847461112;-1.4685491435004472;1.5860210869516906;0.80191736542975622;0.24111516430026358;0.20468220600389195;0.40673162113804806;-0.65916922738781136;-0.15977260652985045;1.654197340772358;1.2655411447734819];
LW2_1 = [-0.48395402479839089 -0.063555480094205807 -0.60081693424494009 -0.83649998280743598 0.30987706974849111 -0.63886049240718679 0.64235024583611278 -0.339432517171538 -0.61449293776322689 -0.10504010119623244 -0.23252304388388173;0.74149358112306574 -0.19647439521397145 0.39403676430093859 -0.31712134625992111 0.55006165428832154 -0.47587529153757968 0.33210636945016053 -0.87278999131063717 0.28601389608725597 -0.011903343270198258 0.93321596408350149;-3.0291273833510708 -0.2677587784462469 -0.12165493493873974 -1.2433348412747152 0.051214968502734742 0.017089343975960992 -1.0748427684337285 0.055187546911038866 -0.23702799811420022 2.6856782330352784 0.12814538405230885;-0.12445944126439572 -0.56907186979100544 0.045808526594414589 -0.21101874347655888 -0.35948785438265818 0.21712296684272753 -0.13048874537264557 0.1230270116499656 -1.1191163298201912 1.4622265911783185 0.14873709284948672;-0.025006920476068603 -0.17331450659782083 -0.49031573766255909 -0.34117459271991452 -0.45671162031310625 0.40825524748894571 -0.8568360464606628 0.14123918870733035 -1.5569928179113415 1.7257805189643081 0.31345000865111516;0.33750541544145629 -0.055793494225558043 -0.63779981452053236 0.55924954185026321 1.0679143202615102 0.47618022971957341 -0.20668906081146077 0.98115037361156476 0.28293403001019213 0.5942378808329789 -0.90113832848280295;0.17496825193605228 0.34098402654853355 0.28159718352329582 -0.78297495156679364 -1.3320931073294671 1.1466634314163175 0.54430295919513072 -0.20037253771103214 0.23156028068687137 0.27430618815619418 -0.83083378591178458;-0.27197271114832833 -0.030823197738148296 0.85480040408858837 -0.27065612701593544 -0.78249892659515952 -0.1820023553555053 -1.5342415835079271 -0.1450202614164959 0.46849773052110938 -0.19179252384480899 0.24689640177083239;2.1700478962139762 1.4139528320065693 -5.0273989520580464 -0.99915491897337261 -4.72724145208013 3.6467446575575471 1.6047265664478452 -4.1246898382997452 2.0750821801745003 2.1607055701459297 -0.9415206573979239;-0.4591631465584024 0.79132913640803193 0.59117279230784558 -0.43313661211329635 -0.30413571745700385 -0.77256792483289594 1.867019751473695 0.15819946269626373 0.81174909511124205 0.18653946380418779 0.14629056054835354;0.11887454703252431 -0.85427081543818506 0.47860707011946285 0.78577396234200891 0.087614910214071806 -1.138209146148512 0.28938402995261842 -0.71152853364153912 0.26272322496990275 -0.50644553162267691 1.0219336768295519];

% Layer 3
b3 = -0.22301916497586158;
LW3_2 = [-0.54114684036871719 0.041268848988100355 1.338669828306674 0.53642831018102966 -0.49929985552432576 0.095976036812284907 0.60600184827379533 -0.57856668787745136 -1.585780279398429 -0.80851817178575303 0.34970659186798131];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
