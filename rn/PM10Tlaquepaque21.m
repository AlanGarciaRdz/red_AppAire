function [Y,Xf,Af] = PM10Tlaquepaque21(X,~,~)
%PM10TLAQUEPAQUE21 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:42.
% 
% [Y] = PM10Tlaquepaque21(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.00773694390715667;0.00572573718866304;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.90635116108216662;-0.23093346547646698;-2.5922040370321895;0.95642190670090299;1.6622257546819885;-1.9730287841522045;-5.7253729202865049;0.31292878616409603;-2.4791344494646697;-3.8829299754581448;2.4980544050396039];
IW1_1 = [-1.1608609204949016 -0.48796573613589767 0.079608892167720324 0.14526492035540739 0.46950980295439904 -0.46300138465304436 0.00676097206025323 -0.14175874778774034 0.74352880046193892 -0.057842232909103723 0.020348650763080661;-0.31615766165035925 -0.639279528023174 0.38359117994226283 -0.24257865792261729 1.0405470653354472 -0.96777288920956717 0.31427570350488249 -0.37893859885984871 0.53616475675727193 0.18421989402002106 -0.74291196792989589;1.1668137101054132 0.58042879413821369 -0.86453451465843589 0.22749568305821627 0.18666285935784127 0.83731621986172278 -0.14799022101968914 -0.29587271177455854 2.093265873760473 -1.2040995244161221 -2.5847225520974959;0.83717083084878097 -0.19712581389498737 -0.17407687419016429 -0.28751712737390911 1.1400509993058725 -1.4876183971190893 -0.049397497110228332 0.32807696898321548 -0.096000233561840898 0.77283412461206613 -0.23156633897365891;-0.49364287506285187 -1.5583522732210096 0.11180682019806946 0.31566998645979771 0.11129228948772711 0.13684798591722561 -0.0691313813420419 0.0050238168199434408 0.0074638605248452446 -0.46881284169521964 -0.23083958138535388;-2.6773818943430148 -0.66722543617060859 1.1593779127305692 -0.014588439831010016 -2.9598555809870719 1.1907358243436283 0.10721689031599196 -0.1187247553971022 -0.1004764211245629 -0.10192835772526954 0.33049210037058036;-1.0879359858347772 -0.22086033616242604 0.88477384737305798 -1.1489080831838325 -4.4049359800591645 -0.66144878886104896 0.033170264737868695 -0.12366390298955782 -1.4868926874970891 -0.67417489112997309 1.1072709615543159;0.044148770634329121 0.52315400171198867 -0.1542531268289575 0.45706923143270362 -0.13183644861786636 0.44053558807882515 -0.13845181332559928 0.10106015555972322 -0.73908737957292758 -0.18086889438502124 0.25801877211926011;-2.425310579925982 -0.31718079266610888 1.9465286295138335 -4.0508379874337628 0.46117526627910665 1.1272678651927655 -1.000896176259205 0.52598960410235096 -0.015554458531610506 -1.1362619440780117 0.87835345271658849;-0.16141937434526707 4.28346225471988 0.60264109846105329 -1.9862810853724402 -0.12714700868752382 -0.89507603782122902 1.1145031055586756 1.0945779571471907 -1.1892345278692296 0.15928176651103132 -0.26946857510602429;0.25595679829913892 0.10561593752812673 -0.33374859753270203 0.50308594789963945 0.45725207580261595 1.1564863121517159 -0.10531875481160434 0.80970557388562392 -1.3814861947034029 -0.3913886584891611 1.1373736423559453];

% Layer 2
b2 = [-0.35820469426270202;1.5893356336590574;0.71191466557671312;1.1317601145419212;0.90705931781936844;-0.021612209309895027;-1.006259286278776;-3.1371823026958379;0.52058779229015295;3.4575546390747567;-0.62974413219884418];
LW2_1 = [0.47577859850194915 1.0639813635803561 0.19784163563086526 0.32632174893457566 -0.45106437110242154 0.37137023927303536 -0.4877214282200843 0.65862519855661739 -0.25673201546147884 0.072569621249399571 -0.09446813528599457;-0.86371048456282717 0.71988811867573521 0.2382689365485561 -0.04199946014227042 -0.65787283232254512 0.64214722841096727 1.23150399206379 0.95153686056972975 -0.22641530418872155 -0.18744715359254954 -0.070536285140897673;-2.0336038121283022 2.3022671411872362 -3.4213331874992918 -1.6837443851664238 0.93816331420122023 -2.3639268360926113 0.64299632132182349 -0.77291419040012332 -2.6463857021730397 -0.93544454666892074 -0.29657345608688968;-0.76039656419408785 0.078419334887971551 -0.045149790054052751 0.00020998774622818517 -0.081901395464286347 0.6614424389049729 -0.30839344430063553 -2.4860005556884541 0.26701168598766506 -0.17828837435671724 1.2641386546509277;0.016441822775944297 0.82722267383493342 0.33845561815133812 0.83539682697636919 0.091568274951991005 0.81642570521322166 0.98886551296205416 0.78133618368478797 -0.34233435497210807 0.10438141055155262 -0.43922584161287587;-0.72309642525685314 -1.965883072970283 0.24388229993480817 0.33569835182642771 -1.3697098834499164 0.0072207411124492193 0.30552839200105503 1.4708469562474913 0.83972943917656051 -0.017994000045936327 -1.1473244607898008;0.54191036598536024 2.1950636721725814 0.074616466537133636 -1.0225476242480536 -1.5165015985747539 0.045198362901913661 -1.1722510114430051 3.6022180243351056 -0.56219429944821997 0.05528172888462847 -0.53752358416806478;-0.45523619046095065 0.99532256064058067 1.0694380349009043 2.1221448992169702 -0.49716089570083449 -3.5367754020421973 0.92953159780104277 -1.1015540154518133 2.9561465300547027 -0.3234547411505983 1.175778247862479;-0.27314748287456003 -1.7107040866345775 -0.04903019806822858 0.83724455770779493 1.194200202846853 0.030893025368531456 0.89258151772895611 -2.4783513290232482 0.34341578487736235 -0.0070965550006634954 0.33653533472687452;-1.1015979426705778 0.68505688029592715 -0.24449685865164653 -0.73846651842692135 -1.47184440314166 0.46390051114513214 -0.25671845445972363 -4.4203655005072884 1.5282918424704659 -0.11779297776068617 3.0782038575478579;-2.0090657012983635 0.77920770799590933 0.14400877036389056 -0.67980399684271853 -1.551568206797727 1.6093329924717805 0.41373149651623048 -1.2961539514938099 -0.47572179794954178 -0.11458119675584513 0.50497832214949501];

% Layer 3
b3 = 0.79137313616130056;
LW3_2 = [1.5322361726768101 1.0348007790148963 -0.093504581677602283 -0.97835284038239756 -1.2898606213192141 -0.3182195044359899 1.0318175891957424 0.6341411076548551 2.1069396778138119 0.37257485015504038 0.66740802652668951];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
