function [Y,Xf,Af] = NOXSantaFe17(X,~,~)
%NOXSANTAFE17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:52.
% 
% [Y] = NOXSantaFe17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.2821820990606132;-5.3643677020672946;1.475025258205064;-0.51429667782857091;-1.931983514226651;2.9797937978256486;-1.7347930169544001;-0.67404521632124192;-2.5267483992719466;-2.4422145228608643;-1.2761461093197477;-0.56818357899117089;-1.5531660834003111;1.9812257749854967];
IW1_1 = [0.655422085500314 1.4699153329340786 -3.3842059145861789 1.5574243386067703 2.1421584396129103 -0.14142350983825691 0.19783811772736185 0.72100174830920016 -0.78760848973228192 1.1697664100494056 -0.89988874788331508 1.4551354019367051;0.46806952413685865 0.28185285949507632 -0.73851359018462759 0.60279502447614763 -0.10390361699208311 0.084271706270014943 0.083677571700182016 -0.55172829008000979 0.11661401019270577 -4.392371144907341 -0.26703170265274345 -0.16106257089814002;-0.16201975536478608 1.9446750822472918 -0.35825574428241913 0.16242307090172478 0.53848210868787716 -0.095551020666674091 0.15021727191190343 -0.072365409344882697 0.055293083965424976 -0.32545297708856208 0.018943892430994643 0.18701257730397483;1.4855001459656729 3.1347458127317345 -0.39870926409609331 -0.0077170207455812961 -0.54280429956698639 -0.42612986626576188 0.013300070075808496 -0.11886731186001025 0.24144755631500903 -0.20845982950318179 -0.27940069447901467 0.42883228322406636;0.19542258065085139 -1.1075596891615735 1.3430714140721121 -0.21595734449936788 0.19822371913457842 0.72473663075096373 -0.26707818438395853 -0.14107836268853019 0.22863303697361748 -3.6061656890774887 -0.28859477294745672 -1.7061448458522182;-4.1507089462123856 -0.016139613348620265 0.8071280148035832 -0.66192706241845012 0.24972166949545599 -0.81484118684314155 -0.16000761079711565 -0.14229478163448447 -0.26587434381739139 0.32974970276548043 0.46081956853609918 -0.38463702048032622;1.3797535551877405 3.3942640204208709 0.048217334904740748 0.12944297867861787 1.8248311792953527 -2.750727032658649 -0.073711858809741404 -0.2298316455663128 0.049491366681288895 0.52450980727148033 -0.39712332751941504 -0.04172010913172014;-2.3579660783946963 -2.6000029432461051 2.0914615329993151 -1.6975167748187652 -0.57616006384190532 -0.9810091946835523 0.44840706772552408 0.28260332893016848 0.52636298877297005 -1.1807960745145814 -0.12899783249210733 0.9445285906991483;0.22733532261920916 5.5419380788500581 0.40431311206155796 -0.22043167918222517 0.59988628932530552 -0.44054153770166715 -0.070415055337913576 0.20952942982265649 0.85795407223522424 -0.32903848777706302 -1.3644546900016701 0.79611560191014508;-1.3494410396129268 0.10765024526373138 0.81847084723068531 -1.4157835404945889 1.7702946075331165 -0.83356601430349941 -0.36303470719493647 0.56600517103711334 -0.64862304522864478 -3.3051731662903245 1.152622709458456 0.010738925426401445;-1.1075913043782277 2.2237317321585248 -0.33075532507952338 0.50273153965319994 -0.07705506840828219 0.18221984593531329 0.0016728414435306996 -0.15876312832521744 -0.22806125126849675 -1.2448503126868349 0.25342351729877172 -0.29143818381219089;-0.95248717212132172 -0.77106910199683232 -1.7543857186230549 0.037416118834030107 1.5480680793812522 -0.11431396834716731 0.36149170807350534 -0.046762331922582751 -0.35387403756289032 0.77031087441395285 -0.1770032395884619 0.71064558959127688;-1.3887344375464099 0.38481496037325569 0.2010061741748187 -0.0014098080402171883 -0.93098374206934986 0.50767274291642717 -0.079810175149165663 -0.27031236274988907 -0.30129471773898703 -0.795888406957447 0.43339121677160347 -0.56795134326286889;0.99919758972097239 -0.073841302711849396 -1.0451068111213611 0.088279016839388241 0.82575319347489951 -0.073924185991302488 0.002478506176841898 -0.28912082778210563 0.14905322182065456 1.1739091576435592 -0.045117313489606237 -0.65221423138359125];

% Layer 2
b2 = [-1.3054137423065209;-2.6957437741972683;-1.7865356446501925;0.81959978940037481;-1.1280625851989352;-0.93342968128879322;-0.079922597892609776;0.65432671449513979;-1.2049884906392159;-0.0022638022441056893;1.5785364822924044;-1.4820408385976691;4.2608426244494026;1.5929886630704895];
LW2_1 = [-0.33313001222903055 0.043528449357974619 -1.6767435896652849 1.936350289754706 0.085349936659580988 0.39923376641393499 0.17938644537484957 0.62743475908690449 -0.7616121890074119 0.20000655635547132 -0.84119985297525779 0.19665825716077176 0.28777852323169295 -0.0085685734172230264;1.3992226702978208 0.34437081132881853 -0.29193324401664411 -0.27071950726293664 0.15023230379542477 -0.95406316611963293 -0.029522914682882966 -0.381623302654444 -2.1115382843230921 -2.2001546496074313 0.54098789831567839 -0.40722301564927543 -2.119247615275857 -1.6071005551696176;0.59139618900802482 -0.62815042503716312 -3.1273749649548326 -1.4294839415149687 0.18201392741371319 0.34950258098320325 -1.4339607116591386 -0.18486943281086296 0.034526265029103421 -0.30843093533617533 0.61398723487458196 1.8561041726762662 0.46313437136568641 -1.0228405492606432;0.26341947824720829 -1.0834978238936295 -0.29928870102344041 0.87020673777747048 0.30044516039969793 1.2791978592892095 -0.56978739771799169 0.26007061650801211 2.7747503688348267 -0.36728110150711962 0.2072641975656076 -0.061729529027467291 -0.54084604509353806 1.3430144491496219;0.8252921145616573 -0.21928255739817923 -0.13447543446658061 0.29197126400326373 0.018042407578171354 -1.1245608931032283 0.75988068749518811 -0.22124654901948487 -0.68093702873361506 0.053128207684047767 0.44881741298835132 0.58060845376677073 0.28085741358813909 -1.1015957038819644;0.62183412116490955 0.32391769985119168 -2.3293293078495956 1.5697121199361783 0.014814231633032617 -0.43101950960839208 -0.53405865778300865 1.0533840418029627 -2.1593455776771697 0.18831809009690684 -0.13748117857096259 0.57410622138708733 -0.14854246215643221 0.82328435187353566;-0.96816315037043921 0.43796875981782668 -0.85458612511268506 -0.080093726988163666 -0.2924759730194999 -0.29975443643129279 -0.71439569209249854 0.3776657867041574 -0.33844088262590588 1.4351677471708268 0.21692898119904738 -0.40398948903135307 -0.77142443710286979 0.03242417396115984;-1.2306650483960946 -0.25441622281276999 -0.35307792737663068 0.15995844153129718 1.0117056074326121 1.8832340510777645 -1.4158480048768243 -0.3949401560995115 2.2196859956314725 0.27582668697316171 -0.5940051455169516 -0.3965437732398357 -1.1493692225164001 0.89979010102979307;-0.54417994116831425 0.088115639483558827 -1.7486300513839559 1.9323214998167839 0.11280461759378525 -0.26129048148223494 0.1169184741051241 0.74628368904287201 -1.7300645012346267 0.046458890620975656 -0.76795668756211088 0.50459981722115532 0.27515964570269563 -0.4387918851003586;0.13948979640762052 -1.3961109469656561 -0.55244543638583721 0.64191468303348864 0.26671062152631175 1.4394393954385472 -0.52488219253087631 -0.046318831167605691 1.413540772528675 -0.66787035753903079 0.95078670243395136 0.059467799144684516 -0.57957847487447989 1.1608123617059045;-0.03904806601687922 0.31924652763885109 1.1930886802527967 0.27623626996494249 0.019129048085839203 0.065755140195400116 -0.15760481220587155 0.61778004953218946 -0.30528016909259392 -0.12392321086823996 0.5447448897364402 0.19712287800387171 -0.19842608988886562 0.048029602503779634;0.051497322119763822 -0.40241964420117871 -0.52811344731007126 -0.036035215387587922 -0.076154568017108543 -0.31735492539669591 1.1241159277781034 -0.56335057458896853 -0.18103358672059797 0.30335909529172705 -0.48230714817224646 -0.14714720869416975 -0.65258239203486468 -0.41967484220202672;-1.1615305064600467 2.2603988215420685 1.9206398737460133 -2.2255144040577086 -2.7044747741637045 0.92458116253780021 -0.7885976245463302 -0.29646941555469858 2.2652463115693671 0.84774276705547891 -3.976089885755699 -1.5053860309201936 -1.3215816392586233 2.8297439130169941;-0.22906410193339033 -1.9507104344850776 -0.088032838274594322 0.33960680644593166 -0.3778950115362032 -1.1977504178033405 -0.33864735685821606 -0.16789966964703065 0.51819285393851044 -0.19119365586299158 -0.20880033839601386 -0.26999956897590882 -0.50086946482408201 1.4250138345758765];

% Layer 3
b3 = 0.14114683177841092;
LW3_2 = [1.3125704529386992 0.88291276373599259 0.28420878117264475 -1.0292386932354058 0.42361277464495395 0.5532787646018239 -0.11383398884004879 1.1060541527729071 -1.7596420446281495 1.0170855602012254 1.8925172875947136 0.12574273327474428 -3.6874511820917513 1.3639011428453032];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
