function [Y,Xf,Af] = COTlaquepaque15(X,~,~)
%COTLAQUEPAQUE15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:15.
% 
% [Y] = COTlaquepaque15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;14.7058823529412;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.448430493273543];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.9131788977751347;2.4911195976261129;0.18726621653228814;4.9733944158544308;-1.2805484110866006;2.7708393394911308;-0.36395874799602213;-1.9738461411138113;-0.13549470363674004;-1.9287401308245988;1.1758499290053321;1.347299419942795;-0.87093271820926299;-0.26009231584897963;-2.1862237425989028];
IW1_1 = [-1.2617925351306019 0.50398729114285201 0.32594894541782499 0.20562621745157425 0.36663528650456545 0.22406095120820976 0.023127754050430709 -0.077715154340633086 0.49073342545056092 -0.78014571566334789;-0.91341682398570712 -2.0044312139227891 1.0475549036921004 -0.3155250222704209 -0.028855171959644984 -0.059212033838588529 0.76304986828949739 -0.27291835360696076 -0.2258592549444598 0.41522916413597755;-3.712140378193165 -0.49266413747730475 0.30773376608515979 0.027001057653924833 -0.38699105013389146 -2.1091599699731485 -1.9251938941628359 -0.0056612924432335645 1.2870886199251454 -0.25145771350407936;0.31502187318853742 -0.23059868530713795 0.17634011021270532 -1.2714431014944201 0.45619337380367481 0.1544864588563136 0.53035556309530074 -0.031810557575062723 0.29566856993168 4.8946414905073805;0.035734021721155515 5.025927993176893 0.33313828148544711 0.13447402173217704 -0.053956499653856071 0.62754194364422156 0.28203297646416203 0.097410421459748944 0.06435765556544025 -0.22338309751601532;-2.3728631002944192 -0.28374314561856478 0.083890291442012821 0.52652182069832132 -0.62851283902496957 -2.4775658984191318e-05 -1.3867662758355102 0.82790441194729059 0.26184612648929367 -0.12179976259298561;-0.061524043937534655 -5.2172305912464587 -0.49369857002897366 0.28601878893857025 -0.16314356232878019 3.0260331242734124 0.34345048493513131 -0.0053283658417339428 -0.28852996954318166 0.40414034634759938;2.0260854766927605 -0.77946600332948646 -0.73046272838553872 0.15181826060147849 -0.53625224609918354 -0.96250960950236963 -0.97577568721763064 0.44472805565021817 -0.26007223053149897 1.2012683496500645;0.38660389202227524 -0.25669134662195719 0.12296581396474762 -0.77337965890358529 0.30077815711586581 0.28048870096005551 0.6358410496132757 0.034478869485628123 0.27801880594996037 -0.57672047050197139;-0.23532275254038837 1.1730635300978496 -0.41352451905365584 -1.34981956753142 0.44835606210904605 -0.2057988315981851 -0.74090785182495078 -0.082940769959636923 0.34602183144415377 -0.86531490916653808;2.9151272141085283 -0.3129246015772168 -0.31979195384339759 -0.11054871636544228 0.97076803908131548 -0.79495057944859882 0.38384146326302715 0.017113869678883908 -0.19528606373880611 -0.50995860750771738;0.83203707771080604 1.6995615038503142 0.15916885870000441 -0.56853313388461624 1.0565037802126922 2.5706988291169677 0.39848050577108213 -0.22272819418682394 -0.066255953323754266 -1.1884690889403753;-0.62213405327994853 -0.20845601578964768 0.1468766146653607 -1.0823498764382509 -1.1457296270467088 -0.97295297165511208 1.5470839646274737 -1.442629456272827 -1.0722643728452912 0.61285265412842094;0.0031977483365328817 -0.79204506870315339 -0.45980641604911604 0.3275936090272123 0.018901304988215781 0.0700648124536144 -0.19456684864427257 -0.10891399869949339 -0.359892828997188 0.14840051360176049;0.033023683536859888 0.44148289198928115 -0.051474600522325165 1.2512856949497317 -0.12252274008962494 0.51415885512182913 -1.0049631931559182 0.32363715437170437 0.12375111263123501 -0.4375159161300492];

% Layer 2
b2 = [1.4582431555037372;-2.4740889295476425;-1.6697722566492987;1.2203553612811981;0.69106078627153567;0.15714247980193249;1.3348223267944699;-0.87394166362212367;0.25218586065914234;1.1029803622267496;-2.4973693770445324;0.17076342958624424;-0.70679421946323806;-1.9573742160184804;2.1462357340444242];
LW2_1 = [-1.9246819686801808 -1.3962908100519233 0.75552347311236967 0.36289377077959345 -0.55323951547268591 -0.11852336142829718 -0.2575750110093048 0.34239553028775382 1.8571961888675734 -1.0256425596695895 -0.58888825391912047 0.62614517398159519 -0.1553675425847936 1.3230979508346778 0.739556590388739;1.973630125420992 -0.011914627592599054 0.032862714349492582 -0.37278842155016023 1.4360426385540681 -1.2323641157760137 0.053779716144162631 -0.2239593876561814 -0.54607888729916709 0.44681490537190249 2.4347819051665867 0.24893597889893446 -0.72850187112423637 0.67595238395445256 1.2419207412472799;1.107421822397187 0.26097912639769955 0.71771872947374715 -1.9628173371802491 0.098239048833308723 2.2593472661223255 -1.0728468183081303 1.1069696780787801 0.24859590894072378 0.17418470906230232 0.038221284804809422 0.13590703021372733 -0.047824237721827229 0.68127172046902718 0.88545382319519317;-0.95234493548473409 0.13530186576121131 -0.13594252284499841 -0.4706480370985171 -2.0237940585120548 0.86564786753767997 -0.05197549520309714 -0.13933607561909231 -0.47213927342234613 -0.63264487248042356 -0.010360326820154309 0.46947929301431324 0.10039665759859488 -1.5486051936483767 1.0186072883794728;-0.031780163856665308 0.13664296920865696 -0.59685148057286042 -0.2343995357245971 0.70010037969922301 0.20878061999880687 0.22216452734342049 -0.2382563119408978 -0.27090150405472835 0.37154442485821304 0.25808671564381191 -0.42689678746948295 -0.12438621854583067 -0.098471485035456496 -0.44282164698732279;1.5224114626992726 0.20997927546064082 -0.85165330553423058 -0.62445276431972452 0.56787642131001259 0.28273758063215765 0.051854046607993545 -0.3342965897152354 -1.4937903530709191 1.0775749900108749 0.38999261800120383 -0.91741706569197257 0.13618921003368153 -0.88555226944642229 -0.52281620513540483;-1.3278014613223583 0.29699454677127446 0.48527381768899408 0.54981221510202904 -1.5768794069580905 -0.63406760906042869 1.4069057261799081 -0.87644264879032785 -2.5648964471998448 0.035864006126073697 1.2796352084409015 0.87412599354253151 -0.47675538987512689 -2.5982265514341409 -1.3624803736644879;-0.97279447743400638 -1.5108743396637665 -0.50853555610170842 0.61600869123271851 1.8304413677133999 1.9199593081657089 -0.82770722786616857 -0.16319749917511497 2.2692201653235684 -1.0635128959080102 -2.8320822126765917 0.67491505526262163 0.62028448645965306 0.8032070475693982 0.39487097907102198;-0.22073252516995534 0.019082235236981174 -0.14470976461393426 -0.042535931890059317 -0.23332039478826189 0.042513109242226746 -0.057022545135221904 -0.4690538436392751 0.37517220179887939 -0.3303827710804364 -0.12587888135402553 0.37386035260308054 -0.17699409154445617 0.6675688614445503 -0.96208526442981079;1.6286624615285656 -0.32352413146584802 0.63247800512524488 2.9233150444234099 -0.97150910715602834 -0.68547073134620085 0.89199815850694364 0.30130022894710784 -3.3975701563970389 -1.1082520954938297 0.37276909308924977 0.72353304417062814 -0.30754654887763738 -1.8823197322905805 -0.041239923063026845;-0.18583853079586085 -0.85709898516481409 0.46572284957093663 -0.11535430937157268 -0.32193868702061745 0.87299930275133808 -0.61834520496975676 0.54421476371228295 0.78660113160985889 -0.49463725817218185 0.74084948828156227 0.014188633563251188 0.12561451506661306 0.057459119514606811 0.17210020339432588;1.4976193903794741 -0.15439251929356268 -0.70236342211211267 -0.23268895952763527 -1.3405442488143615 1.1954610687720255 -2.0485594527236 0.72223071704243402 -0.086414097370234755 -1.1433929149658035 -1.9863222121131128 -0.5838275480461953 0.32004748384031784 0.25661143801764663 0.68726129643299128;1.2438103830561942 -0.2633897922851976 0.24451784977251506 -1.4364851628544797 -1.3928349382266936 -0.076894089457695297 0.25831220570158625 1.5766271477195228 -1.8454542452094447 0.34099218113237206 0.79825881080701078 -0.14994861708421062 0.73596840187734214 -2.5259834479827141 -0.16448367536693467;0.25478033539404993 0.22637641993906349 0.42019034881722783 -0.3580734768120391 -0.64485494475315341 0.68542897729252161 -0.59199152962494128 0.70259728823889345 0.61552674753752823 -0.63826786978943695 0.48778594778828421 0.28008284630993535 -0.040544663635786585 -0.72276159911021853 0.92107094262317601;0.51582584694976408 -1.1588235764192181 0.70440048185434834 -0.58127947879613473 0.052644839467745459 0.082442223699680406 -0.93732815817678006 0.76760664279495139 0.13123834059521458 0.38388776751113751 -1.6631175370649449 0.19891276056787599 -0.40183903414824773 0.048539011559011511 0.095906989357323585];

% Layer 3
b3 = -1.2405221315391415;
LW3_2 = [-1.4605956745145172 -0.41215886373032168 -0.33418507624541477 -0.66520092161791988 0.71686935031348142 -1.6996566419869088 -3.1899160316324386 -0.35602468322288694 1.8115512642751825 3.1927943312310934 2.399296803379058 0.21079709558717727 0.34563657653086199 -0.76771442493700714 0.35223791601556459];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
