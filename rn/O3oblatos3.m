function [Y,Xf,Af] = O3oblatos3(X,~,~)
%O3OBLATOS3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:44.
% 
% [Y] = O3oblatos3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.100381449508131;117.647058823529;0.0560224089635854;13.1578947368421];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.7029379579666675;1.0917622729126681;1.7584747621065446;0.99325442967698818;-1.9846321883796325;-2.3045974993925222;-0.14524561208549411;1.5473365172149947;-0.66434486673775583;-0.27835865634748425;-2.1573423968666448;0.49564251366890005;1.4691364140281302;-4.6750186539153056];
  IW1_1 = [-3.2665841770925583 0.41906329561735095 2.3201172753852535 -0.14991479892643822 0.38176174558657805 1.0804401756216775;-0.27961237989285437 3.2142128122990172 2.9755856131096703 -1.2977017912049029 -1.9877587294120549 1.9085552893270532;-0.063843333891129006 1.1200766103446131 6.295166965209992 -4.3581454066804852 -0.85373488571565348 2.7150489403455231;-0.57535574471348816 2.3814025150477516 -0.69245881644798668 0.55569540761128711 0.75910096754233691 -0.96524190558454837;3.2702084192635743 0.034087049247224409 -0.85702993442531328 0.38569751962980742 0.050102874244164541 0.25668110252919141;0.18159270640343025 0.24504848264168128 -1.9886192224370018 0.20863514121385499 -0.078786886202907525 -1.4739676382039433;-0.59902923978357148 1.3129716051868936 -1.3612419933076043 0.016408643927305865 -0.84264725782997352 -0.29137654796843743;-0.80752091645396529 0.44451603752252999 -0.39061070008395643 -0.24227396244154975 -0.44468321457394727 1.8180470732496568;-2.7807507742634794 -4.0096939709656585 -0.41260589117039709 0.13853083138565925 1.3336519126666633 -0.90361951331634793;2.7950584730349419 0.28518081513649185 -0.089647504054209765 -0.21992230068380866 -0.62489052608115936 -0.30486067177075837;-0.57591264427306921 -0.26662817154999591 0.039563194946127783 0.026831268451883449 -0.22886703045124915 -2.3945887702707718;-0.61668836095533675 5.7959075385824859 -4.5897674829942652 1.0006028141750032 1.3290010515627366 -0.90174321697401583;1.4260820927203057 0.119720788560918 -0.20065765155581983 0.13877185271585665 0.4314472794664419 1.3891882051218569;0.24033908937709436 1.6019666292397399 -0.40599079417012013 -3.5321410867381093 -0.63498220896149571 2.7577791477475735];
  
  % Layer 2
  b2 = [6.6296298825302777;5.0120296215554658;0.74145164489690274;-0.034865480481345364;0.9945718809883185;-1.9686756115200887;1.5567300863632068;-1.024097927702297;-0.43281524934487148;1.0891981735024827;0.55091666079415647;0.1612988764688065;-3.4043585414744748;0.11044087995541112];
  LW2_1 = [-0.77776168664089929 -0.84724603523316178 -1.1622128186377649 4.0671413618010996 0.93407286008353463 1.7209953722652036 0.69022033165726837 2.8459723188739634 -6.9811807502974315 -1.4587177877224315 2.3563897339348974 -3.2182253162924996 3.2272879333557363 0.00020844727016146054;1.0748465577102797 1.4567662605991578 -2.0709502604214056 -0.11593628018447513 0.17798583427379117 0.37844292460558909 -0.51326528582150532 -3.2973332715321044 4.0177056849330341 0.12823447393256684 -1.9911094906362865 0.54252640732708257 1.3556573568458681 0.70576311530948521;-1.4069254504291122 -0.26263162508571331 -0.21204987094494884 -0.63376679601327635 1.0273005086501856 1.2454271583216521 -1.4924796063117003 0.13246628230801172 -0.088339627990912939 0.49464110544951817 -2.523478937232579 0.58233709842856729 -2.6422792924590599 0.23323068396117883;1.1202616051296417 0.34649463735638242 -0.026529625222325062 -0.47707035933496761 0.66841469545962073 0.026835881614178363 -0.17234450838520179 -0.28365103783993556 -0.035154506800198465 1.8858107697005406 0.56823821188578549 0.17968430273745353 0.62587815048063999 -0.0045237637599007457;0.51074567910879809 -1.6441422395622225 2.1057514962353663 2.0868913376839933 0.35014870477155297 0.65508214163441936 0.46543810499138327 -0.40537465913956455 -1.6819057587879696 1.8465720444899003 -1.1508400271939734 -0.95767230889231136 -2.2433527178493904 -2.0458242885706186;-1.6488322656364351 0.038688207548506354 0.74526678223839271 1.1059506862774688 0.42176238553205053 0.13103695976328822 -0.51216069888547433 0.32358053774937168 -0.53779069446905536 -0.71075169091330404 -0.17852859163835136 -0.68047475773065114 -0.6278711800136364 -1.410054414326821;1.2804634682922531 -0.041045473359267268 -0.74568555900755751 0.13610859561587069 0.48230972346261214 -0.68775553580211046 1.3582335730481483 0.22105193530097367 1.1383303577660295 0.96712289402856466 -0.38214598194183519 0.21460223520523863 0.47603662388027007 1.1743384901305269;-0.25828515103952265 0.26641841227105784 2.050452497495773 1.4786145658364056 1.2927245871167092 -1.5099495529255202 1.5474084362151661 0.72143937167659811 0.41320070168921136 -1.8386113473542387 1.8856962104440951 0.034082754932572797 1.0473764915826007 -1.5206480623847858;0.95610972615937007 0.3095734783582042 -0.20782004477069743 -0.20105413971433095 0.5770434741205801 0.047701026761789153 0.20082354630534763 -0.52601015290778375 0.15268566658846541 1.3489097528145291 0.60115479387217063 0.071679815667246488 0.90610539195256057 0.031336823425507254;1.0640914201480502 0.43486679843093962 -0.56078591993304217 -1.723885070974241 -0.7014783924777801 0.19600919599091751 -0.87977594532111603 0.93167769577302295 0.063895893490401728 -0.74965020713728614 0.9521507585055009 0.74905677295823347 0.5877169809497137 0.32887276504171969;-0.92260869561492742 1.0268850513075707 -0.73481742560324059 -3.2825497008493594 -2.2320049794716446 2.3999206934157478 -1.8410761326300809 -2.4050791402578504 -0.10043336024312677 -2.1066635755384517 -1.5714826549414445 1.5437057445051505 -1.7302939638919819 3.2068079522202009;-0.9250261111918695 -0.14420119982293145 -0.49337090223608016 -1.4893378681405762 -0.65135865867978782 -0.22741155144529862 0.073075426223665502 -0.21021895395046364 0.30434129475116117 0.1892877549798106 0.19560865456598067 0.92555371595951808 0.7134247644109587 1.41124075646054;-1.2358254455517244 -1.1788832318267755 2.1576465350763518 -1.4567700695104402 -1.1672861728584187 0.53855219260851284 1.7149482335005397 -2.5994063835127652 0.64841549960448996 0.067939049036554955 -1.5689050884394775 0.66560530875298285 -1.6844630874595325 -1.9131393324240149;0.28680211312679527 0.33411510510473247 -2.0289472563501514 0.14198383062939218 0.35654962729703804 -0.82152759927774899 0.48408961129965378 0.79472499116604178 0.73246773932250675 1.3075656361306942 -1.3642645623028238 0.13355342264920453 -1.8416166859414318 3.3750917607588864];
  
  % Layer 3
  b3 = 0.31129196820508453;
  LW3_2 = [-1.0740420251092888 -0.38370574024350806 -0.95048612362001994 -1.6463572628534142 0.81309671248336246 2.3556636748640387 2.1443121826449167 -0.35048294569308341 2.0603978909998126 1.2155274410385952 0.79284704413745788 1.6584001364718393 -0.85441329170263935 0.39210835011313044];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 13.1578947368421;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
