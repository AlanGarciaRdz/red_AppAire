function [Y,Xf,Af] = NOXSantaFe23(X,~,~)
%NOXSANTAFE23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:52.
% 
% [Y] = NOXSantaFe23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.2567414705125231;1.6413907984887188;1.6181678217177267;-1.2929395871449032;-0.80298562397142248;-1.091165543860307;-0.45128064815787972;1.7998743891662203;1.4854257041442946;0.6552414156927342;-2.9863260213359837;1.410821612505067;-1.1276864469049082;1.4146191244324882];
IW1_1 = [1.3804861779061848 -0.071238093279468229 -0.6198241024708433 0.67793306341642079 -0.33032922017361915 0.9444355523521083 0.28934350096575157 -1.1676348426911081 -0.800543288635714 0.99989506624347324 -0.294597509669424 -0.13706869352885173;0.29251361938755649 -2.2500052355775972 -0.28699579209529191 0.11789413203246597 0.12828278263419093 -0.28277629369706003 0.065236281056652176 0.80044845752467864 -0.079214085246198912 0.39489632524104668 -0.16634421084707046 -0.50366440019312542;-0.15845765700137171 -0.32838573008809024 1.3378725705735559 -0.89101156938678261 0.55498079135179934 0.35834096221428197 0.18918423378823368 -0.12675011488997473 -0.034384948309692895 -0.37329612761843467 1.6416168576636427 -0.34801739082892463;-0.3347316506971818 0.36958547754585458 0.87573877086881091 0.44181384426706155 -1.1875676869809773 -1.4513343979628388 -0.015028227116463559 -0.84191741485372551 -0.11946428298212748 -0.017092989665120004 0.87154436490468867 0.13297753498771023;-0.14023030025660699 -0.48385577338945251 0.15358960726615165 0.78413865523085313 -0.94737105930197685 0.025334826212389618 -0.084438679932258204 -0.43582148907823437 0.4469438311052325 -0.90501811529069731 -0.041138998749019572 0.31908580364274097;0.23268369171744729 1.2162365802645234 0.12493733550521334 -1.0938455921702845 1.3698405445489292 0.32036708622732979 0.17376778031237319 0.037118400892640964 -0.34589997844945608 0.15418445005275833 -0.17418524516661926 -1.1619420082521246;1.1746509142464843 -0.3140468991587167 0.0083313607338489637 -0.61607878211741773 -0.72830534965202409 -0.059870874041236852 -0.074963122430955056 0.68811898821140338 -0.41768518891801681 0.46355392257856026 0.13334189171014055 0.055744499827663871;-0.26720794450165847 -0.25159715213482386 0.29996788791291978 0.77658701268155528 -1.1226167525808104 -0.26857887027026545 -0.11390157472692622 -0.31826427542603342 0.48785505251711697 2.4019682773289146 -0.045791298698847474 -0.22564209796607618;-3.7215267029265791 0.033495505871349529 1.0906902574913162 -0.46081772864074272 -0.73865020583218488 -0.9117989181490268 -0.07009337512569086 -0.17895353319356108 -0.77755508266777562 0.51483146383881184 0.43736579677656107 0.36304623914598988;-0.41355780889360733 0.04570420041452436 -0.19263606533343258 -0.43840836926518428 -0.44398200186401948 -0.58925811042848941 0.3784601862556406 -0.61373819214302916 -0.23328036862919235 0.36535452005590735 -0.74937682085404322 -0.47957498238666774;-0.3510227503619584 -3.7854868870107268 -0.4685672357197852 -0.42533753671955654 -0.71408736944207496 -0.18935789217667973 0.2695069109653167 -0.085695576526333611 -0.060209172190090594 0.2324677218562344 0.068178167051111072 0.43435972503805897;-0.76634571972065157 -0.2721317267713329 1.0088790586179188 1.1813286361020505 -0.95246504036023028 0.86731050977315982 -0.11499968961371737 -0.68862376475952836 -0.70153397508454318 0.21210217953112648 1.3590805278184921 -0.73261644275596804;-0.26314719859689334 -0.12460658120363019 -0.2857555605471494 -0.14597223608812207 0.31619324922254638 0.35174428886003034 0.040400163515295809 -0.84529815934319286 0.09715883208379443 -0.33987772836524954 -0.13557695465120759 0.92116545527207028;0.14902266906085548 0.71592305579778792 -0.79126041096077115 -0.91608608876278741 -0.46361388963344352 -0.084301048912023419 -0.81191015578231518 0.68767478286460293 0.025618014421851572 -0.40432090206642263 -0.75765375761643705 -0.46638689367956621];

% Layer 2
b2 = [-1.4213923922105711;3.2869697829851909;1.1696147826702941;-1.3188355175820055;1.1633227076206143;-0.079989219870394479;0.098314755355739886;0.91903258840634261;0.85474521735109332;-0.55533111974775951;-1.0382102813853575;2.2520447630626013;1.4501712053181555;1.7177186318323037];
LW2_1 = [0.15491295950078454 -0.56094689793914221 -0.20683376237384621 0.70341722013320784 -0.10540911887210941 0.45085438992867294 -0.033087047610865908 -0.044349079821394841 -0.080041710692888082 -0.19293652849332807 0.69420837242069811 0.020520037668897501 -0.054338754446081133 0.66551060181921184;-0.088965005579006787 -3.6707444814562891 -0.25954738542528299 -0.18178986470655439 0.88790275455805245 1.1655889012565102 0.36146177893739928 -0.51386701563613402 0.15211491839541166 2.140024273341973 1.4486337986812561 0.035339790781985653 -1.7163059317363778 -0.024468490678654073;-1.5003855260657204 0.28480447904579087 -0.87094404203041687 0.68689884284235625 -0.44070059906617676 0.0094946279844358127 1.6885546899504464 -0.99122383229974442 0.87547058412772383 0.70441452431991736 0.017444251359069976 -0.25688451205456847 -0.77888366165155221 0.6648500573648024;1.2827855114764706 -0.26683733786936958 0.11134812021771334 0.74762206758171057 1.0346986941995624 0.71933876823490039 1.0895482432026649 0.84202317928370651 -1.9252984224952281 -0.78065962594044569 -0.24222502822773481 -0.56905006449383733 0.35563203724480447 -1.4339058809514389;-1.1806470433093286 1.4604203651839729 -0.53585628490176807 1.9161359047015734 -0.64908528099667273 0.05613358303125468 2.3176939734717541 -0.90058473093828939 1.2844376339302024 0.7494600740145505 -0.50942389916843722 -0.061733069904619686 0.40455639760464618 0.79188111616355428;0.11584136578797324 -0.1666110884517617 0.65598503727931423 -0.6043462970698511 0.17441403724029231 -0.13433112770827887 -0.43254129211136283 0.96366595049308879 -0.75089954066293241 0.31424978599659875 0.086728190070700345 0.10626473784316193 0.34532806172755548 -0.55051452807518109;0.40256670410916551 -0.63662647367125758 -0.16418429011150931 -0.93316176659360328 0.85949784749826441 -0.23306727674726369 -1.0733006598181183 -0.92971847109498396 0.69226007862521421 0.054598821981290617 -0.10741128091716932 -0.22906902904015083 0.8548373097133195 -0.20816446221345231;-0.16317814393709043 0.75287868092440013 0.47964724547985393 -0.88828039096697486 1.1305820789967158 -1.2464487639308035 0.74198488900087411 -1.4750982533407113 1.2605865451587381 0.11870187408856331 -1.608922804044016 -1.0628994820658875 -0.80955930790562225 -0.2241556727699788;0.61334856176053842 0.22099462253478563 -0.06389951232545886 0.1630781631757855 -2.1836530045209241 0.089638414984080206 0.5414930900978534 1.8185788345155269 -0.17265097907263252 0.63126738869044519 0.25259113319471954 0.17148550469125692 0.51622425885230516 1.4212495950928874;-0.37003284715660589 -0.23679963526288328 0.16278666933724839 0.36668747370921256 -0.24345613510902051 0.21464382936706139 0.43249398934540001 1.3006427793259752 -0.17189645442537757 -0.0084368349093774941 -0.48403535559633387 0.44764656852928031 1.5731836627277793 -0.25844461682538322;0.53291734272613944 0.72699015473712936 -0.48764136848089845 2.0234766667748292 -0.57788326723937611 0.069634842492095339 -0.45018864372455591 0.099819641208848578 -0.34765981972987597 -0.44307774389811877 0.090989010377567556 -0.12369823747878783 0.40498001104015768 -0.58043877822390422;1.2005915637761491 1.4185536245997077 -0.062464542196088269 -1.8765959683827766 -0.49180990937935126 1.4702899705061814 -0.75849542535205783 0.83427585984786623 -0.77137268783977608 1.5076571454420904 -0.94710504555813002 0.46330931017553195 0.77074848884062774 0.45114384524519785;1.2891919906505389 1.4838673574270096 1.6717981940048499 0.64348127404947109 0.49523030889391245 0.82490816653967269 1.3740530227720626 0.50779565879130639 2.3845229369852405 0.289352014012282 -1.1339824012671977 -1.7000316565790383 -0.53248014211875472 0.5953913567825514;-0.068125211217071338 0.92775500970218494 -0.39558238644091304 -0.61627702248891658 0.43346749351538566 -0.34541594778224916 -0.29144190669553477 -0.61924717361379922 0.068323225941864477 -0.27549270876408216 0.9051804796546602 0.15043963513738068 -0.29144150148990161 0.0093743205179879774];

% Layer 3
b3 = 0.65095794275182561;
LW3_2 = [-1.4075904969776292 -1.5840991319843236 -2.1775593592773701 -1.2025009769460204 1.6639759927724971 0.14245503043115026 0.081169927405165862 -0.50851664728746115 1.7368731579120802 -0.57049003235880491 0.98905346013481421 -1.0281075978268623 -1.1245019573010242 -0.52097287507214785];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
