function [Y,Xf,Af] = PM10LomaDorada3(X,~,~)
%PM10LOMADORADA3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:09.
% 
% [Y] = PM10LomaDorada3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.4344799830452393;2.7690868276360323;-0.090748056890777556;-0.4362106667385881;-1.3512385123411235;1.0345246422057368;-0.78993547252686069;0.5433621377393395;4.1832967812747901;-2.1347507543621185;0.84865995442059228;1.4034210953951238;-2.4207588395756989;0.9276869827651284];
IW1_1 = [0.56502322701686369 -1.8822834756930737 0.03224523879983876 -0.70159265509229507 0.28978014426305998 -0.25765283355292945 -0.66432770965245891;-1.2832238234705338 -2.9988822445539052 -0.9761817783880844 0.89254537940222356 -0.10928386437307219 -1.2224297887763693 1.5285300661826595;-0.032753113819236845 -0.019676042324503689 0.66837147592265467 0.17097794489350956 -0.88810929183408915 0.91198192999430161 -0.35843558934777525;0.55561350644430385 -0.25233861191207507 0.60927411809262733 0.34739130649493866 1.6695130077745071 -1.9665948614057147 1.3839588160593062;0.81370388230870105 -1.0511273093536413 -0.48479892044324091 -0.063989895093532645 -0.2127915387871889 -0.75705143777823258 -0.034569857573764247;-1.7897001929040164 0.55402547882701914 0.55673125691147063 -1.3951467290061703 0.9507256583548741 -0.15769646322743774 0.72653923838589729;0.25589451381717915 -5.6000727658176412 -0.26082012058043719 -0.27076857461035847 0.42328751089285538 0.025505460363149789 0.76539729701724091;0.94930039407675681 -0.077583678937300588 0.10219109405749344 0.45991381379944668 -0.0039559662867235182 0.7185733406790511 1.9922411314875093;1.9124123075139976 0.22294384832119507 1.1173509900295822 -1.5053619336708763 0.90658875092697944 4.5260924926858683 -2.4737680683094028;2.0105084780667601 0.01059735473893015 -2.2224163153621515 1.867596029355634 -0.36543820847261682 -2.9417674975612358 0.17948356902592913;0.70220075484947209 -1.8209891048738012 -0.63749345369951604 0.22447939691417315 0.24858879109591692 -1.9993836125047955 0.068099705394424073;1.3549228165076388 -0.13764432137304575 -0.56580166513103125 -0.90675851462509405 -1.1559260872806123 -1.6433192258112599 1.2383254944812132;-4.0963697830858408 -0.18901290935132734 -0.72232013687261387 0.40553850254196866 0.44706465437498955 -1.0123408422083637 1.0034567042192728;0.72407484416179546 0.1332777290457012 -0.93712326698060733 1.6438027365507901 -1.5588076613162658 -1.0243787639207138 -1.1248158160864747];

% Layer 2
b2 = [1.8536946990961518;1.0821010954499215;-1.7109561884775946;-0.13902572062132032;0.13244698861912621;0.32413066211323383;-0.16156617354482172;-0.051879823014775436;-1.0423987193948985;0.93067603541349098;0.28126658498541651;-1.1403237984637735;-1.6984484640529107;-1.9470345220235237];
LW2_1 = [0.55889964986701957 -0.8123462029267664 -1.0569572356549872 -0.0058823777790636411 0.62550533925017204 0.37910550245798169 0.012565526624328444 -0.53218667744809445 0.33652112013994256 0.42422037365255189 -0.10505622614995666 -0.59572962637617177 -0.27397174099881511 0.44731372766925709;0.54878496259854115 0.62335938626402387 -0.089775037002428948 0.70613897629071465 -1.3200341496471784 -0.32914350562682904 0.059372192769001908 -0.85654455260642048 0.17802215570774199 0.18968184434818805 0.35499088710954096 0.064697313038028045 0.84264419155807024 -0.58642148232839175;0.53808063399727657 0.70654805191511105 1.6889268393592978 0.50292295768216666 1.3685123447934957 0.75489103723675588 -0.92946914954954019 -0.21258145086303154 1.2964979741054434 0.41322893058099869 0.25382450766900266 0.6895571656009416 -0.16451517247608288 -0.31359136405199434;1.8123752982186971 -1.486417820814101 1.2865268984789653 0.55866537073065226 2.5913814872092078 1.3461285325531418 -2.4055384589620723 0.76973226346603585 1.3041750256612283 -0.34997939794144561 0.72020128727529464 0.59252966668807516 0.20400291607556595 0.0011302647625620749;-0.26095745035731521 0.2793126973924514 0.15535384190358847 -0.38429256764908382 -0.22151659228310577 -0.38120078112756139 0.22796861724215056 0.18557596946197175 -0.17638984665409901 -1.0503740963750987 0.55125254052925732 -0.72686710311326341 0.13587372898909469 0.19106524897501256;-0.1178662912775842 0.26037474687404927 -0.58573592422946896 -0.9237125616533608 -0.84334765769972142 -2.7989651475679018 0.02316444872932745 0.88033569545215129 0.49764960714039025 -0.84037510969018314 0.14579667428003212 -0.43939590278030616 2.191940381711035 -0.023185762137892932;-1.5152985008831981 0.13677644048173732 0.62903476436286943 -0.51066323392400936 -2.0851718256646663 -1.4094557683829483 0.074852386607649785 -0.44940882466774212 1.5853506631943661 0.61500481375809957 0.14511457613058726 -0.50201506766927662 1.8291108824414153 -0.37977512919437334;0.7245938644170361 -0.22859224071121381 0.97541705511517163 1.5181233772467573 -0.471309796049663 0.050484799543109797 -0.29361958908835112 -1.7012779254354338 -0.99880396862473841 1.4143812493809982 -0.56320089106600468 1.0522080432113814 0.84803998025349092 1.0976340052443239;-0.019493640789738739 -0.40004528670002354 0.28996322589698958 0.27023255768718946 0.29497059648925844 -0.82266983084898815 -0.23242360822936853 0.42039151900197963 0.15485022198564363 0.30593927669243492 -0.89657756677387423 0.25997110789236089 1.2325821756301865 -1.0998661034266968;2.496451066731971 2.2075553249271453 0.73473170146646005 0.98619312173466955 -0.69550442268387458 -0.96817515588681458 -1.4867487532981287 -0.87058447598590816 0.82495433229103055 0.32292441100399516 -0.016041962800198442 -0.31450777400195917 -0.52252816148686243 -1.6104394290288606;-1.1225606297812591 0.64051731081526964 1.2299261724172732 0.63910453741463369 0.27217149824342851 -0.27843385442201646 0.55178113219983949 -1.4650256433060667 -1.1191646920325244 -0.45059200624449469 -0.30018540684476547 0.42728175494773701 -0.17485936843286135 -0.28600469006243612;-1.9096465106454257 -1.8478139049566071 1.3450999207283214 0.1999782476284826 2.3972298084966432 -2.2459637956365972 -0.005264735973990825 -1.568816176059473 -1.054329725442779 2.8718770551916273 -0.20917669935799843 -0.48414285635981208 -2.4579790203049932 0.11584607520046877;-0.41940017493908355 -0.26777851033493771 -0.2642278828149176 0.71279033257460611 0.53497155327581825 0.89328078880590989 0.45146866933809859 0.30799266159276328 0.57445988229887712 -0.96954052420631986 -0.70127895869694934 0.39402857838371008 -0.2067915588921525 -0.72232114744047193;-1.262466753172246 -0.32128835790751664 0.65152807024640114 1.1527704488521362 -1.6217651055795725 1.2956461617139687 -0.92731589637550238 0.67127607618190621 0.36634725637087873 -0.37918667112457727 0.054640280292701557 -0.25739892866412956 0.0092005913797905646 -0.32325244802231035];

% Layer 3
b3 = -0.74919587942351751;
LW3_2 = [-0.3762660583598007 0.69656972620556257 -0.70262661551675654 0.26605166127011842 -1.0158371274613558 0.17422832824830062 -0.1042503577762233 -0.60729850754337467 0.60682917563496275 0.22070858602448271 0.6580603068409614 0.10029773171660804 -0.45332772222508866 -0.11553994343003296];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
