function [Y,Xf,Af] = PM10SantaFe13(X,~,~)
%PM10SANTAFE13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:34.
% 
% [Y] = PM10SantaFe13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;0.00341273633199099;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.8995141438904799;2.5026009586398228;0.78419690563767808;-1.8696890110346522;1.344793263343238;-0.22496079319926099;-0.35030790127729133;0.41219708040688413;-0.61904854722158664;0.61193524496909013;-0.80787875631142103;1.7247508666987612;1.5337946390792376;-2.2422601629045378];
IW1_1 = [-1.7204579087017906 -0.091419254441875958 0.49373060018956288 0.28743407572742308 -1.7119988015704197 -1.0842600457609712;0.63978713817164135 0.097126395123631457 -0.81637718148344363 -0.79247586111597923 2.9788386615876457 1.0028881709039306;-0.24382854373982765 1.0329788899222418 -0.34250812428182847 0.2882218749008727 0.49955221535286026 -0.56287346815317796;2.0580895119960996 -0.57291171454488699 -0.3413272400611097 0.46498534337669328 1.2083105547922464 -0.4401590251045624;0.47395546815362788 -1.4928829150528129 -0.55352793671829303 1.1179676443451474 0.28413155820898306 -0.44645362562334662;-0.18561335772868784 1.883518995726065 -0.85789533165528886 0.88221858837468525 -0.55401611061848388 0.32652361706518795;1.5825614229770297 1.2924663883169878 0.42199995686177788 -0.83433198029440381 -0.50424641267023695 -0.17318061450125161;0.1462923260795824 -0.4375015161081815 -1.0486393163976759 -0.38000936767382837 1.4020071059797639 0.76590269750060735;1.4173427616539451 1.2714374564015145 0.14515055659527235 1.0555824112060348 -0.26159879698179744 -0.13741390676229867;2.059273754870631 -0.81363580585045181 0.38693827289670846 -0.30716312427746895 -0.18842947634877283 0.17483779402851329;-3.4635041408726317 0.12289357746277353 -0.12259655307031168 -1.050937234457364 1.0257500366574774 1.1545403737975171;-0.33483266761354569 0.55793058021334097 -0.96058249519611749 0.648184255057079 -1.4665344512341789 0.67087211926304757;0.68787026137468987 0.28253864698210673 -2.199624762697816 0.16445571088796715 -0.054366856330368661 -0.44261155715732459;-1.8596942583267586 0.96425685690952956 -0.12218106548066457 0.89034467913689475 -0.13648699234152672 -0.049010401311684736];

% Layer 2
b2 = [-2.0609588671058447;-1.3260057139428794;-1.1501116300827599;0.51652449525794242;-1.0514552752805706;0.15249229377100659;0.051305877431788341;0.26043771752229256;0.64946155937844374;0.95797650511601695;-1.1736006962262246;-1.6266447701665787;-1.3971119811723711;1.8684621169554145];
LW2_1 = [0.099198382764032061 0.63132616520451579 -0.11988829899566483 0.80552286062427936 -0.17686003943781278 -0.4746976952462772 0.33505420582125223 0.49129871594174318 -0.1396077586738923 -1.1272433901422381 0.97563872338626179 -0.35104761005064467 0.17843997318977572 0.80889948256949507;0.67245695902013414 -0.17838425350105219 -1.0869172112031626 0.36630659575977925 -0.52093812858910638 0.4006971673784141 -0.064870810751627539 -0.45117971595981382 -0.45126974809180354 -0.42070259495213747 0.086343493976577715 -0.48187475868623658 0.41457135533555972 0.33799051450541284;0.078930687392941512 0.84830523037707772 1.7040012098150521 -0.62682631641013697 -0.93088873008138884 0.26203917623183165 -1.2591486980247026 0.25863841156720319 0.54299668444709026 -0.031583444628049878 0.22136823730304878 0.20529714172145469 -0.31800393357689749 0.070188420193939269;-0.16442211819571648 0.47389703717131521 0.63932441458226141 0.90446179918332492 -0.30706334463145196 0.23787966553928322 0.44026828733176226 -0.060363587386318113 -1.213737929684565 1.6347031737269035 0.37802616354939655 0.51797726784632836 0.079052622515481341 0.8512023041188379;0.18061960084733356 -0.92327095943453641 -0.5964099745696565 0.51962902060282312 -0.55518040168313243 1.2945427657145772 -0.44454038087522307 -0.076720592507780933 -1.6872946107062645 0.79962176943123042 -1.1296586911103108 0.33167371200717394 0.40922870793901051 -0.86816647480426101;-0.84506154770450159 0.50166173783138579 0.34425584626543632 0.47529406949573 -0.55061385079317615 -0.71890314886078488 -1.3073771800086775 0.63068508861043171 -0.13188554036511863 1.2066548445469989 -0.66320561304942038 0.21249880982518618 0.44783178445516569 -0.049483657733813434;0.14989042927412488 0.18137079314068494 -0.18703784480445543 1.28669786524428 0.80848893212361872 0.48298442517206791 1.130078438709859 -0.70981161334336784 0.73374655271820799 -1.5283153550452939 0.79620728159685494 0.6892238998742608 -0.0099726531810937803 -0.63542076394213465;-0.72628876694095679 -0.21572992116884668 -0.41522781803951381 0.79489093815085665 1.0924722453031042 -0.80837733002774981 1.0463163903200321 0.65124391599343823 1.7313878647579528 -0.30021170340598585 0.68356969798208822 0.56919715880285715 -0.22628625137370784 -0.23748040833907755;0.57002424671817309 -0.37100399000344292 -0.96944018901586104 0.14987865526426222 0.49789382657331127 -0.22362071681806137 -0.18733104191888914 0.32891468932678336 0.37786200152011368 -0.1434020920758165 -0.44412897191967532 0.25150170578824704 0.086360433757039695 0.21538569271284927;-0.31420802766778022 1.0470968450917131 -0.20552001549583249 -1.2718873258224699 0.37187723395543593 -0.077815963959975892 -1.651151399828416 0.33446034620877635 -1.3270766519545902 1.0415217286737808 -0.72475280773552553 -0.083175506353950712 0.075082166855127613 -0.40870770939818818;-0.11705663853134561 0.1461533675849829 1.2060938239185708 0.51856015855010928 0.59484957795951898 -0.19741257531481926 0.93842823305027723 0.34685317360769796 0.44375116657268043 -1.0864504254878866 0.53018541017030218 0.10714218357584292 0.017136910532492902 0.12607011437952986;0.3883118649181494 -0.29464019971681016 0.50615149834768824 -0.097382722561276974 -1.0741070759514937 1.0796087530370293 -0.87777863764065989 -0.33271791911546389 -2.0936161525907342 1.8466735662074372 -0.749897413658695 0.33116080257435587 0.2021251260202864 0.40461640827024858;-1.5045292594711817 -1.6241251969106125 -0.57197139072990666 0.46408092439718768 -1.605533203999173 1.1844305458808484 0.74063015671126398 0.29306672680984325 -1.0034586276685058 -0.30055557479573297 -0.20944606989580861 0.010273447628211183 -0.12184070942781951 -0.12550855447204762;0.29309221499265492 0.072926594848786552 0.21001828409571482 0.40974320766251676 -0.018435776047099658 0.30280663986733297 0.4049268055455239 0.23942690275543876 1.4860323966713278 0.91147935448467565 0.2086598652162816 0.29554369049971313 -0.21095403422054632 -0.56581314456705201];

% Layer 3
b3 = -0.51651574881401829;
LW3_2 = [-0.80209781937047553 0.48565503666490856 0.2927965061347948 -0.73084783349042892 -0.60978050937230754 -0.5387514995786582 -0.54419222693780378 0.63804521144641058 0.67685358871878465 1.4641690248062933 0.63151308354932989 0.78549098431383602 1.818641101689676 1.1742469680182299];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
