function [Y,Xf,Af] = SOXSantaFe11(X,~,~)
%SOXSANTAFE11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:50.
% 
% [Y] = SOXSantaFe11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.49241532090403073;-1.5891000817943235;1.1917689150941646;-0.54284221148775069;1.3373269229045888;-0.52484618896981217;0.51076521657159035;-0.20630337065581511;-0.44458507101325762;-0.3105332924013241;0.93368411199500134;1.0380645580604897;-1.7904099285626072;-0.80971718336212251;-1.7337515602270956];
IW1_1 = [1.0657508441658938 -0.084762513809435697 -0.50958365343752132 -0.50605023781191205 0.47855368435148765 -0.13298491332770943 0.26023827387778642 0.40737362067453448 -0.099888963676326992 1.3135310117840842 0.26358428945277168 -1.1518387810641844 0.75100533602792008 -0.23963628060356496 -0.8806062335244681;0.94881923382974553 0.042133285425567893 -0.33195099836725112 -0.17337091727204873 0.66496837661897401 0.39478048100829155 -0.47507798492136072 0.37350946205468927 -0.2273455810921847 0.76881293107706627 -1.2580659910331218 0.53051328794816788 0.62655007298584986 -0.86829506632539855 0.56980977125970822;-0.28533607129855509 1.9542932834476021 -0.61459050625424816 -0.6744199564587674 1.8655255107209894 -0.061882081341472467 0.90460031357181159 -0.14270958060905181 -0.19216806017347771 -0.72738210170742679 0.68036719625477171 -0.8215019938120699 -0.17829472269573049 -0.73797359547018304 0.82395774947364719;0.29056556387801152 0.53728474508718316 -0.27112137458025748 -0.41400960395836384 -0.47508420727553435 -0.62525193684287528 -0.40258109276921566 -0.39568735069313588 -1.1161903405546736 -0.51895098128392203 -0.12805494077422142 -0.86383192482543847 -0.27312902768471775 0.26628615771133535 -0.42338146861758025;-3.4872046259163287 -0.18335608900567937 -2.0757991362902075 0.28824443793952914 0.21223194697113121 -0.09090758734425225 1.0177867682592374 0.080549018377289366 -0.54104852707592543 -0.53059020847115623 0.38127123192361706 -0.41877672811333566 0.7779890247116219 -0.18597536071349491 -0.72999570136287328;0.54938872769928904 -0.060604666947885792 0.4183319142465185 0.074012506419084301 0.65134033307232875 0.04901463705152511 0.33017843163877758 0.18429963859528667 0.85577039946246913 -0.23353521475059619 -0.29021965988237686 0.57015272357924141 0.36028967510222748 -0.3805056295232952 0.74446013695918356;-0.0017671041451212156 0.79775762921400073 0.99933748061947181 0.10927330972065925 -0.14833811386812795 -0.49157022318606669 0.098845479147899637 -0.19554504181034169 0.56164368861927694 0.98073605473567971 0.18409149095521238 -1.607518395837777 -0.21577637804180322 -0.11985593803395878 0.54181423796204053;1.4251697826230569 1.6797728523391076 -1.4485140642133252 -0.42724465441900783 2.9695528771331454 -0.021466643655412634 0.52251378231377232 1.1344308194187256 -0.82018959716671758 -0.33123635132160079 -0.74786815236287663 1.4777479028634204 -1.1258606264626536 0.75804744041517658 0.58709453033444958;0.8772076873367296 -1.8907480851779495 0.4103344323969732 0.74139081233905579 -1.0062576768317331 0.34984586300491716 -0.52997114078878904 -0.31649893397436091 0.13445568957700851 -1.4399980985049623 -0.52674575897425957 4.1981039758649539 -2.4758784631607362 -0.23504454705166913 0.81877179237722886;-1.1417729030664336 -0.96647152608209108 0.44452954136548106 -0.5008143161501375 1.5330237540058445 -0.74655109222150451 -1.6653304243392002 -0.072243890043210773 0.4745943664216441 0.37086827252219873 0.35759954813220562 -0.094886602439247542 0.3196060210714628 -0.13493517994514037 -0.044685826133387105;0.60202609568064192 -0.1217705916739113 -0.33469377075600004 -0.61337625266993079 -0.85267585284053093 -0.24250202078719144 -0.73790982713334619 0.024749118960971948 0.43045897505251218 -0.32304783294340911 -0.32241332761174646 -0.41839712433036652 0.22530930515390027 -0.64758803408843635 -0.2841970972332743;0.16702854451616028 -0.61701199961399888 0.19073278369538524 -0.440778215923116 -1.1761548895570961 -0.049418647105574365 0.49935466878022416 -0.62713989661308323 0.16521880366830294 0.11586789222256622 -0.012212356648095224 0.18661595475029918 -0.92610576054369276 -0.30721825365190375 0.51432211263253236;0.68831424180622369 0.77697057943762937 -0.052238694946229236 -0.37293659686433211 -0.62710051304423753 -0.62139504991909589 0.65145422371995909 -0.18011650091332138 0.31732338636280677 -0.58155901380486341 -0.062810473681587681 -1.002789335291943 -0.63354942562834882 -0.67055500788354305 1.1141213909086218;-0.46849583844184967 -0.77580722103758948 0.15470961292325397 0.35638748400472769 1.0019337338367154 0.48218045087546818 -0.70328161967988789 0.30707008896355747 -0.26391548386531627 -3.5612283353644454 0.20477956918121565 0.54320531265306737 0.89864420733967909 0.58000663661079888 0.2843382530856261;0.071073865710038431 0.09277176431874197 0.30915726061449744 -0.026575274489109617 -0.24521833887666405 -0.043894781641266492 -0.74519261856140362 -0.23852941452980689 0.10561087227353035 -0.089217729101977353 0.57228982263341577 -0.89709638854289764 0.37914422612452825 -0.19467769954365308 0.031652283673718945];

% Layer 2
b2 = [-1.7571642587746963;2.0360045007130676;0.81675064846173262;-1.0812867198794029;-0.70710151671066379;-0.44562173044006176;-0.34566699355642899;0.20986195697023322;-0.24631011511113268;-0.70183232491005276;0.8270115964403445;-1.0553504939265226;-1.3465715906138691;-1.3818925942575335;2.9627024633823678];
LW2_1 = [-0.018060366519512261 -0.06905084723425195 -0.84497921784789898 0.0026538222861230212 -0.42928546056776606 -0.35495724317611421 -0.35746457489223415 0.42055659172793775 -0.25436358472414189 0.51380058868174039 -0.14439755672210539 -0.57974430903798935 -0.4263898822212796 -1.3079816967132025 0.18630120714038631;0.18014225836524214 -0.7873637832158572 1.9073937020934137 0.44955138461272998 -0.95176302314009154 -1.0558812697139992 -0.97538374373044845 0.71927472570706985 1.0352901233101295 -0.68456751443938735 0.03208978931709492 0.11165196599416993 -0.074286707810226865 1.5677786746068767 -0.54170904150920307;0.60464637700154555 0.43901847181428133 0.029782075022856208 -0.84282526140742808 0.19812775838831753 -0.32401130806999678 0.22095880034904075 -0.52175592732272102 0.024759015196926901 -0.080668261232897082 -0.55047294319037166 -0.48569300141978577 -0.41159643114756295 0.33075211228677132 0.89477512450669361;-0.66793021158671273 0.54909555246644293 -0.0045567433864511925 0.042615297946309666 1.2582449542882443 -0.11568721327459412 -0.17407189300093054 0.19675396644962112 -0.40478546617750788 -0.44957009986288488 -0.55162051500850018 -1.1117511988408288 1.2461752063913403 0.66211939676285503 0.97657057241267387;0.11574024628467183 -0.012570474977703805 -1.2002636145619414 -0.21594419586778713 0.31674664544066167 0.36128849056663831 0.66636834664183353 0.19416845637186864 -0.54475448025397677 0.55687626457203954 0.69658290753282881 -0.15553497806432176 -0.25057832209616193 -0.3606688335982105 -0.52784550449627021;0.29728223940752624 -0.34845096937166942 0.09226781954956953 0.13209538649554778 -0.99843428384599853 0.42663934543899529 -0.90901040602658567 0.15600669373860285 -0.071545167999151282 -0.22567836057215013 0.2575519518060943 0.080885773641499958 -0.15827059169195523 -0.35033607491633562 0.55708104256481983;0.064040650297184365 0.55996877904852027 -0.4009430605257075 -0.54445063056704934 0.32160068385494778 0.38091243786167961 -0.39070425041298623 -0.17561156349174498 -0.25069379123048208 0.14393832944237486 0.65085777826635682 -0.4354453339984159 0.85409814776274073 0.50853208812232809 0.1790573605602295;0.017027607834103509 0.47512323434538306 0.21039577221576797 0.13651086813433147 -0.26034778323742963 -0.54299315097834411 -0.31922570977133341 -0.083616291382173386 0.29341094817460556 0.10820695390445653 0.59566174240697289 0.082300596603905013 0.19260214435752127 0.37399158543981165 0.11646661667597155;-0.51398783013825777 -0.10951773614422113 -0.00011851222101018355 0.38170871807759893 0.52981858595128262 0.75367673370814403 0.041376265685574447 0.21049666127736849 -0.68290081989820883 -0.49218462385441353 -0.20145788784037205 -1.4541826864379761 0.43746156410799253 -0.38828664213416875 0.89641397696218827;0.53788698462484497 1.526787625577039 -2.3290518575821375 -1.5770705741387305 2.1705041845587942 1.1716880873482749 0.12904383812781206 -0.23256429640178902 0.25654847729612379 -2.8626569965878894 -0.58369710990274615 -1.0933642813376068 1.1846723120917597 -1.6438400207301476 1.7847962295640447;0.13100684194566564 0.35882389171808032 0.12564649577680639 0.47905240554048717 0.52826750453637228 -0.70265565035699162 0.70011655115731641 -0.22833001156831709 0.34431303804626334 -0.1759752361721299 -0.50489607791570879 0.42422039022247837 0.98259971972843674 1.179066745378738 -0.38877576932839603;-0.21602437761412302 -0.46075083401925687 -0.10295248643021992 0.3073446725195535 0.69595021759560804 0.52894311548658346 -0.17393612652512602 0.13721670763978452 0.42694580361743867 0.32008937605495963 -0.1083370067019489 -0.13684685145944317 -1.3956583271477869 -0.88546501508763475 -0.45178419274179371;-0.079949187656112849 0.66134228641433646 0.24978827775953763 -0.68295662463259255 0.32359576187973699 0.2288439797039119 0.40714392907945163 0.44057504029760525 -0.083014558039352843 0.061778547698778906 -0.46095215623635671 -0.64054497935411558 0.2200788939154561 0.65190948370165458 -0.059403816503720619;-0.52274466276120068 0.4284365726418396 0.88115906667998878 0.34294969777403728 -0.22434038170255721 -0.62555324608805984 -0.056449798991158137 -0.31072851942824681 0.50187726363179586 0.22509449591813221 0.072398351210518755 0.8583754514227373 1.3152743001982858 1.7523313293216329 0.32279557033383072;2.9239160944752687 -1.7465963386430305 0.151580002910775 1.9754184399903041 -2.1893061972138885 -1.3540022816149953 0.64126794641418361 -4.6175402777144692 -4.8192149881024546 -1.3309036034380046 1.1141505736922179 0.44882184653824897 -2.5748840498401449 2.4717542184682331 -0.89795731173964255];

% Layer 3
b3 = 1.1957067989768908;
LW3_2 = [-1.364926917404591 -1.3856144484921338 0.13192391050567523 -1.3055881451244864 0.1037552083259639 -0.22261588062395343 -0.69029056658922294 0.89331883441440574 0.5298810778805042 1.4914760581453517 -0.78952363375753576 -0.14985416447897543 -1.1149770001178756 -0.1216902782985784 -3.0073302875707331];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
