function [Y,Xf,Af] = SOXAguilas5(X,~,~)
%SOXAGUILAS5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:17.
% 
% [Y] = SOXAguilas5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.0488472584099111;-0.25212965990710706;2.4414282540913916;1.187481882101465;2.7818910252307463;0.71514270570817962;-1.1668589203617472;-1.049968999498323;-1.1300323075474661;-0.12723934020420349;-0.74136545784677677;0.79873766329913853;-1.5608487736061265;2.3064250886078943;-1.1092924016399661];
IW1_1 = [0.22418225971051761 0.91512344416140778 0.17688354300474962 0.095141504240197738 -0.87203431716608271 0.10936776940856327 -0.68217258938562886 0.31828615452398556 0.73542401727018991 0.21082491781772547 0.62473479334685023 -0.65666182207160828 -0.46130846097891198;2.1669152331186323 -2.429894996339514 -1.3231899758710963 0.74925664809082337 -0.59426856491605629 -0.55333783288653415 -0.030412389722018377 1.0313519161715097 -1.8419865748775655 -0.51729559348525489 -0.23991851539105569 0.46465349713883475 0.18210028695733455;-0.28546453150155382 -0.037677995285251169 0.21581305699860814 -0.30719041185647666 -0.71354972959571361 0.13083537080471244 0.19871064743225733 2.7800329473438907 -0.42837645784771766 0.29866262361013429 0.020484109564187836 1.1627152694045999 -0.34731059115012558;-1.6910907832813966 -1.0469108313255842 -1.5314935080745651 0.19182697443923888 0.23806942681895468 0.92591706513009586 -0.11428708440709079 0.055731858722486628 -0.58965136563129883 -0.92493658080932895 0.50625628309047399 1.4501660287564322 -0.51342281912655297;-5.0165862306796871 -0.99768018557694405 -0.016197462837309218 -0.61290172402359933 -0.59813742551356031 -0.38624073387594438 -0.21323590678817775 0.61737117293823451 -0.26477038513078599 -0.13616404558777695 -0.61520414726436379 -0.9435229227666766 0.011090053422438906;-0.83995616556044705 0.29640285309313991 -0.12855776673629213 0.16732188664727671 -1.2983924538300842 -0.30083879587339468 0.14320526895965249 0.1316233561895504 0.22034505224891646 0.036442698334663612 0.19800538724128419 0.46718179871189541 0.071762109372921878;-0.68518477712604309 -1.1955165397834302 1.3044366589518646 -1.2698010603161736 -0.32676936546424284 -0.12870292333978464 0.35867942265185082 1.267277262363842 1.557846417874001 -0.78251276285721372 -0.88964023018273919 -2.0475219414531436 -0.57062144423785277;-0.80191946132290592 0.24145440510005828 -0.84719022684419865 1.8000232900288056 1.1730889868938015 -1.7527493575852926 0.081011915229448214 0.16289059618661519 -0.28671314961107108 -1.3602641563162921 1.0823405620384967 -0.29522263046090635 0.16936304013788561;1.1657624674639857 0.57108300811825474 0.68340605609300353 -0.82515282202792428 0.93594122861051332 1.3951590281544095 -0.41363052270774325 -1.748376751093202 1.2007097932350803 0.37000188267865214 -0.75536965453231664 -1.0410860885104791 -0.71111240402950682;0.30002693323881019 -2.0973275582702042 0.19925307103600373 -0.22611371279230452 1.2461506773294562 0.90164753059551073 0.4741957021971977 -2.1511363993080699 -0.79360587841127195 -0.31034131018229122 -0.10251489177658218 2.0201301072941527 -1.2016428641656793;-2.3310772395090269 0.72335669622086773 -0.92456905555291646 0.65502304256858557 -1.2469933387576175 -0.37948652466753646 -1.0584209008188861 -0.56371759011419142 -2.3741457273006872 0.33792493337727919 -0.38491030213300365 -0.93101052406166263 0.67233296097847817;-0.15043036580912547 -1.1098139458002387 0.35313841170018556 0.86058362631795682 0.20912747362275258 -0.80498666693170362 0.10506571455921786 0.23752452362885332 0.2219755626716251 -1.2322335529735058 1.349571950359238 -1.0334029760163637 0.49373433241031395;-0.75433853675917872 -1.7459013232590943 -0.074811423801840846 0.6088240063269591 0.76114078411436292 -0.14458326119658266 0.074511844313625827 0.036908829254317384 0.23814214201000755 -0.61663005202437626 -0.51008804175051803 -0.041453331838262178 0.46142042303586678;0.17998556645088248 0.034762911536554739 -0.1787424447110767 0.34811817729212313 0.79228379546234073 -0.22495355378713783 -0.16025264514250667 1.7813567292720041 0.42336038568242096 -0.31182804683187598 0.011574481909979629 -1.2328401775340743 0.41142228682705095;-0.64010922803537718 -0.040577619776160243 0.021508069869178609 0.23532416606913228 0.094241332010217199 -0.14753082093014291 0.097726844496481238 -0.3404805512014133 -0.012205459333540856 0.04349684417520483 0.16552110091073291 -0.06605865508153197 -0.021741766339539385];

% Layer 2
b2 = [2.0474638819388398;-0.8074832260525262;-0.39277232206655199;1.1720996510531037;0.61883803572993479;-1.0014825350170031;-0.3971412258834342;-0.39159258618010923;-0.41584500299603383;2.1953756911999824;2.1596390053807504;-0.6015833979367059;-1.3821664531463069;-1.4866054032426343;-2.0391321019579731];
LW2_1 = [0.23203927121895079 -0.57093798372418303 0.0064573871613796546 -0.41422780166220546 -0.68256733637371003 0.41624827327759473 0.022235044803188653 -0.36819992656321388 -0.11239634505178757 0.51406834479164998 -0.21988432739553915 0.27797957308797966 -0.30085283549072644 -1.9443741362291447 0.42639692413313807;0.4643495732837945 -0.91975466251422966 -0.3574202313230242 0.6008400057824298 -0.086366901337522201 0.45656320151920871 -0.015257830473738819 -0.4205358045252805 0.023627420852866447 0.28028937339582533 0.088199820874798052 -0.22785712022136762 -0.35061189266328041 0.94716966262683422 0.20982200193721412;1.4051218186293182 -0.25952943663117911 2.2004700065810754 -0.054848110336109215 -0.037307987697611289 0.40101697356310345 -0.012924774999622522 -0.28822291523738841 -0.095284304595166708 0.15657023793482067 -0.093463810142259768 0.086915801587085478 0.40696362499244337 1.961068493156807 -0.52801060497655272;-0.38836321544648683 -0.67487053532250629 0.16676056655698385 -0.1102669737205903 1.2496383405658005 0.083106575936398586 0.31113257424380697 -0.5734243259917069 0.53799772469625129 0.55339545722622585 0.69745780305802796 0.49995447561778028 0.13645741821621937 -1.3551802526044376 0.46743505620742593;-0.20597673069499267 -0.011097702427377787 1.0867540988081512 -0.86311948453594656 0.0082628237477263763 -0.038141877822588918 0.22092087245287376 -0.47751713374099436 -0.60492880214183375 -0.413765563765708 0.21531633901090746 0.91633198691415374 0.85429964493422406 -0.93055859077127223 -0.28031888968964302;0.21539463391777755 0.4641356220712497 0.74899031889037271 0.1361958114971466 -0.53337322536566201 -0.49811731360322364 0.56159757937156896 0.55751632923517858 -1.0750057799604515 0.10745515297290295 -0.091274778827777389 0.055851143785505319 -0.5319576965056082 0.01138449249814532 0.88221498609048432;0.59763133735442553 -0.9395571330822805 -1.1111530394638971 0.22341378108556381 -0.47219022392526572 1.0129562277539699 0.07853403683552132 -0.762142962389597 -0.87632966116923283 0.10337882315410285 0.002773842711154943 -0.07995562567430177 0.67519902551929767 -0.80997165438749164 -0.51074332927589194;-1.1317329818203452 0.99865993526693908 0.64043611988460536 -0.63131107838848322 0.71059039028501059 -0.38474105376782175 -0.3241252377356228 0.52023079515088688 1.020063875334293 0.14489079791103046 0.13601542172221218 0.28607305781777753 -0.25296523987935549 0.38392991499791629 -0.14191308895468552;-0.25146274436435134 0.45719818128986661 1.9188443312809524 1.7542603840546624 -1.3180299816869672 -1.0594892564711085 0.8727777544267955 0.86696757376906985 -0.44074370534634222 -0.74593323427715463 -1.2299974978083503 -0.16137096131906292 0.56975276717138845 0.71298346895277753 0.77970595412121213;2.1341197897833424 -1.362265428442595 -0.74102130495311036 1.1120323272272314 -2.8832004034879923 1.3392450509032827 1.3154009461717275 1.040998440264548 -2.0162194317723281 2.6364490367500779 0.77330823453187758 -1.3157980359034014 -2.0859016882662185 2.7499507221768744 0.0029382210720844404;1.5149924148419047 -1.3020459195619716 -3.6159830470659879 -3.3954988849218046 0.53421925080469401 -0.8277893325242085 -3.8187935991051911 -2.2865914793553963 -1.3913897394255548 3.653583607941858 2.7513518943341269 0.58084965338827133 0.22818639757779888 3.4144035368103718 -0.90680960736574423;0.18494063366833649 -0.95360019749322689 -0.23077415541793983 0.56443330229768951 0.034478406827571473 0.30198119172737126 -0.074331487955907452 -0.44015841948477918 0.059753102680457207 0.31515946957366459 0.073971932595232048 -0.3004076392097213 -0.33294797821277228 1.0963093209132682 0.073274846226123153;-0.3325774100280745 -0.22537280583743854 -1.8017106455923477 -0.65264305879414175 -0.60122949655452718 0.18145310330131847 -0.23211868663321705 0.71942321934560738 0.073807450284375173 -0.31382596883334429 0.15350434339232524 0.20158416685537725 -0.36941038776326224 -0.43640376865660291 -0.33346429472657946;-0.25389172388317011 0.67031708608181351 1.0680122086158652 -0.87974113125619136 0.079738194580498703 0.068393627890896078 0.047082032102953295 -0.4055411874638391 -0.54071616857247462 0.49482163722309019 -0.57074635587779232 -0.54422762694271676 -0.22913812081506393 0.53648719605349415 -0.037874452346339002;-0.82951979083830696 1.0186383868276858 0.10535249529533434 -0.88926292414676655 0.64757181323771995 0.093757298575187595 -0.34474299185113105 0.2258366258391315 0.92996540733006927 0.42323189707674858 0.22732175288476297 0.37059606513510912 -0.29227320459848799 0.08378233445827038 -0.86440743629996764];

% Layer 3
b3 = 0.9435630319896593;
LW3_2 = [-0.12491621743088026 -0.97872659984589117 1.2005425973329178 0.035418042124164398 -0.017822620420274778 0.15682164967827197 -0.28209164044536067 -0.80589797963475973 -0.87440109965913271 -2.1950054819743441 -1.4860255645720968 0.8914536781518555 0.066086307659412549 -0.078807357432523442 0.50868320693499136];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
