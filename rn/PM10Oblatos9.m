function [Y,Xf,Af] = PM10Oblatos9(X,~,~)
%PM10OBLATOS9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:22.
% 
% [Y] = PM10Oblatos9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.2907968738375153;1.9543443710238408;5.3471917826378368;-0.26052051160354889;1.8642289299958756;-1.2201073407755878;-0.79893322304705705;0.64615724612368441;0.82385781814775783;-1.411560646049641;-0.95549204657642506;-2.8184649767516365;2.1939551798928103;2.0856277312448923];
IW1_1 = [-0.60939846485713878 0.74018687301462016 0.8569379816412438 -0.2513277253277979 0.32207154414154848 -0.10789000193657119 -0.082767867306387202 0.49452329244025717;4.3686020355128869 -0.083210361793137191 -1.2908771136111479 -0.82466536299859627 1.7574400975741202 -0.15859085154365482 -0.29799025150125352 -0.038378280059118232;-2.9812437152609164 1.7521025151286251 4.7585896314470864 -0.32490197253755393 -0.09112397360231933 1.2610876276203162 0.43924101481228112 -0.042437019799666062;1.3955366373595424 0.85879478979616863 1.6564686982071424 -0.74571320658345008 0.43827184869851871 -1.5576564284646641 0.17867603454275063 1.4504662974921931;-0.073718548071554091 -1.1925173257978194 0.10359149823529687 0.68538358734307614 0.80803345154868711 0.062620604882367259 0.030952043351340858 0.4795982462804757;1.1124421426059352 1.282710965246215 -0.57606106149185521 0.19948432720096279 0.51201576568156926 0.049399645978771542 -0.27529881123758571 0.70106713986253244;-2.9130209902289534 -1.8075168003699025 2.1947587853985375 3.2413548760183009 0.13024062027709365 1.4684265235023806 0.33772246356018926 -2.149413097037522;2.7016150007783075 -0.30088533602017919 1.5556254224904196 0.55186625775227505 -3.1569277245103797 0.44095755815521015 -0.15824962490360886 -0.099869702464442961;-0.71879602907601314 -0.73529172615392591 1.3427236188583482 -0.24703876629468363 -0.87172464320940779 0.041910236368055555 0.2977986994154968 -0.79470722020326579;-0.46455882937856446 0.88306173909120833 0.17354614404537819 -3.3836013953759063 2.2438357696631228 -0.32762046700607134 -0.46462296813103143 0.15290518607178644;0.62215837327199353 -0.72736865478050683 0.37306489861419512 0.50130924004590638 0.50237266820038784 2.8527783458057736 0.65579409805592359 -0.61094384537040813;0.1908311926006015 0.23154632153474858 -1.9234721341720646 -0.079351448888342516 0.63106205219500422 -0.2105622096866939 -0.71705366175089258 0.7460212329675987;0.56698259140129414 0.3511619484407637 -1.0989147053990469 0.050691363708320301 -1.1366441013115525 0.027866257527314905 -0.3190639482306995 -1.2985672565847057;-0.6505642245408384 -1.3116503795077592 1.1556251042818464 -0.69767311935591514 -1.3209249393667395 -1.1222832308622279 0.29917897714579889 -0.6756566604821167];

% Layer 2
b2 = [3.6361228223817754;-1.6656044384424535;0.47569314798819901;-0.21912753258129125;0.10617427583376692;-0.31189650258871299;1.2893072799282235;-1.3729773011619271;-1.1784981190998285;0.27035972083627302;-0.68306964954204863;-2.206531482855139;-1.9050000682242572;0.98439381147473615];
LW2_1 = [-2.031650116085336 -1.6165888754161541 0.87486727916496787 -0.34822586241730635 0.5554219592531735 0.62831302268087219 -1.7423163034446327 -0.67548248422989599 1.0854982447372024 0.43387726552763495 3.3892186523677399 -0.20746308509574213 2.2785134507345681 -1.0312686624425895;-0.048162330377172907 -0.50598505681410777 0.57307934749522371 0.39716864114642719 -1.9835995122868084 -2.1956006266691217 0.02427928383194743 0.89523099159386921 -2.943385625245805 0.11649719017142118 0.57763222176529183 -1.1205371861940887 0.15315963727805054 -1.2884206602000823;1.0346958155712984 2.2272733335725201 0.2602303121457496 0.10104849023053211 0.37411538439155589 0.97003392002289401 0.36094610629240664 -1.6436208820574174 1.544920705133054 0.14999925599037189 1.2033941622555826 -0.79919917991369283 0.20087339164582707 0.089232184900250755;2.7683960176611024 0.33613235006014436 1.0677161298154818 -1.2923530704774107 -1.4871797390069357 -0.59651350832970351 0.89499256917472403 -0.32830225818097214 -0.4932965589074535 -0.51705832308689925 0.65284742074149815 0.037001586305430545 0.43538576689145692 -3.357116999784401;-2.6235010787893849 1.7061316902131924 -1.0871525484971714 0.32857132561815927 -2.5934524291663958 -0.41820949534307078 0.32836645797363229 0.048762083824494276 -2.5885877593326327 -1.1092685276126111 -1.5927706846918326 -0.5793740761178765 -0.97583636034177113 0.96085258577014621;-0.070611063412510819 1.5988573145955995 -0.79079200048263942 -0.15019266233864623 -1.0732568710243682 -0.25642452287678263 0.47354554294635876 -0.94444701178356705 1.2880654021049742 -0.048987376860248698 -0.2017929571960175 1.0743493523969292 0.831625729864374 -0.60961690655143008;-1.0998013945395153 0.46595854991834212 0.72401887782611829 -0.21274430427522495 0.32387246192581215 -0.084612527511951752 0.0910509020034629 -1.9960042100332072 0.85602201744390671 0.74402839868526005 1.9533414790955537 -2.5988125284266448 2.0256518219231547 -1.0330091909021617;-0.13295757705043729 0.41289713353907243 -0.17229074925776292 0.2330224395672589 1.2769210069130426 -1.2571550083247671 -0.7631595666486668 -0.47232394963396529 0.57030990963665373 -0.19950447610598795 -1.3945116309780441 0.53020963375178165 -0.58482413214954077 -0.8879916552112368;1.3257702546708119 1.027144103395603 -0.4745901649612646 -0.16677567871858642 1.4170473260921477 2.8338957673226126 -0.62844298215093308 -0.49757070459362684 0.9245360705044835 -0.53175144306742517 -0.99022062545816292 0.62460438469690149 -1.219163110702453 3.1979456070532981;2.4959594844491719 -0.91170737732968465 -0.59166547390063029 -1.2733379177453104 1.3629822616009515 1.2238314707120039 0.062417287074082055 0.40507149110713958 0.011122603274900236 -0.87588012165022666 0.16690740835818091 0.87635385543879951 -1.1002183125109515 1.6437535470854627;0.85604110001540523 1.8968077738390219 1.8141341791519154 -2.1414572136099546 -0.040233705438176143 1.2002492043354531 0.18795927667824586 1.8446234696648514 1.493400192489851 0.19923421557009649 -0.083841167890715884 1.0985078355770099 -1.4510654972472041 0.24179737238754545;-1.2523401658294644 -0.31423139438969333 0.51972363332590954 -0.24637379750712926 -0.0084728907010786 -3.5180391024120423 -0.38300606295575157 0.026794777341736173 -0.98213072961454884 -0.12047062729462472 -0.43419638649674619 1.2699483240078344 -1.6777458779952326 0.23135605743166868;-0.68897954844539999 -2.1656233666043949 -0.26925571729497372 0.056581704345325431 -0.35545170341748383 -2.9411219320409723 -0.34723799000359634 1.9261208207502396 -2.4335225440108901 0.029116000117758077 -1.4116637141406234 -1.7171301064455446 -1.0084817845061291 -1.5920421467559425;0.90403890263917097 -0.73679293654636524 0.78027349316953176 0.17541962784710635 -1.2190423805147192 -1.3679139896222654 -0.52761538042993972 -2.8640267411077702 -1.8310958372606514 -0.74921845295539846 -1.5412623002781836 -1.7878968505585244 -0.89790623159246352 -0.74433679697367616];

% Layer 3
b3 = 1.6498880318828006;
LW3_2 = [1.0147500324434366 0.69807034709262417 1.2300442612574494 -0.26745973011744645 -0.26940694530714654 0.47580317029034014 -0.96798244162108038 -0.68867130388146292 0.39257746439466418 0.31800496453794902 -0.20678375143806157 2.2183998599282231 1.1377499173966037 -0.22440149423832223];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
