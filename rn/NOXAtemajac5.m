function [Y,Xf,Af] = NOXAtemajac5(X,~,~)
%NOXATEMAJAC5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:15.
% 
% [Y] = NOXAtemajac5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.04040404040404;16.1290322580645;0.0210748155953635;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.8084308344776434;4.9724024053576388;1.2219780853207063;2.0119855897512107;0.23434681506814975;-1.5093234317309665;-0.12484682637088688;0.19260572759587991;0.61543475787188118;6.4864092065951846;4.3909284471727057;7.9297689446552342];
IW1_1 = [0.41332521954004209 -5.1885720133285851 0.020228336860255991 -0.45751954709418963 0.87292261982778607 -0.5733979417061057 0.056034916477773672 0.35478450532074746;0.076383515680074079 1.4031098179216652 0.11489196136697973 -0.17483226018707623 0.36047852671010489 0.59167341714886612 -0.44051450734621317 3.3984546267472613;0.77089738236305572 -2.4318058262137128 1.8963679580513937 -0.26563444161386368 -0.29028648859828143 -0.20845504140717333 -0.36144113796220423 -0.55443832862340681;2.1578088745920398 1.7553548544036852 -0.69481993000232634 2.0172074525359216 2.7084455618585048 3.8801927364126549 1.4573326803316571 0.18613832908194056;-0.58268867530099788 -1.964833600582355 -0.72038255868749057 -0.18653550797576091 0.31720121222198749 2.3708407151860209 0.66283423435202304 0.53128812498068023;-1.0816837264352426 -1.9237265836499668 0.58675506314983406 1.6487637215887527 -2.1374670530976503 1.1083892968753146 0.27621144717079837 -1.129285898446581;0.065010139600767652 -0.023281214321779341 -1.4797174986719588 0.34646513931540435 0.31659173845451799 1.6524767470728161 -0.88563739686037712 -2.5512257668777831;0.65820088340859972 -1.9126057087267809 1.4710856970183532 -0.85614422589461614 -0.25255894790068889 0.20020753644838929 -0.64645706903243072 -0.63764100016189484;1.9888808176210475 0.4798084901709449 -1.2895546431142186 -0.84138699025101926 0.92354610192021636 -1.073439691314545 -0.57939247039672503 0.28260626095754038;-4.494241347106942 1.2809881154490839 -0.92716970666232112 1.6359876994204958 3.5767081291045892 3.859409573157091 0.33046089793529787 3.3341375254441394;0.27309168365328212 6.0041119134162217 0.16016588417301128 -0.058914225039719152 -0.27008805329147445 -0.34813671126355783 -0.23642056244538329 0.043421941272011794;0.77289643691597831 0.47586043160751679 5.9411395710138164 -0.35487282091818539 0.93863285162644039 -0.29253567479791592 -0.16805075086291196 0.22185566633033693];

% Layer 2
b2 = [2.1989691823100692;1.7542307370126264;0.70661840916167695;1.3462789881330195;-1.4599499528073014;-0.74945995690634493;1.5634867226757383;2.3959171957873604;-2.8558547390563485;1.2768926115885715;-2.6807057766146456;3.4283921206845238];
LW2_1 = [-1.0711098002092008 1.1718319526281336 -1.4570663296938751 0.029696563146895623 0.061466904643610647 -0.024256447892925571 -0.29081752762347995 0.48707546184292094 0.2830955611290939 0.2544447530652667 -0.51894476507780662 -1.2208748574117674;0.25868669425598906 -1.7764250214424635 -0.10829576105803299 -0.13013666702510621 0.23289839530357792 -0.34604704521618163 -0.18253199455031055 -0.0078382348041314831 0.16840658341354986 -0.59721707635942411 -0.55631727054518365 0.16133821770429171;-0.85751403996328657 -0.73793829419198098 1.0317232531258738 -0.059574546261499696 -0.27831902695235949 0.085967864081993653 0.13109043687810307 -0.37811758626075614 0.212436363028709 0.10870483866028934 -0.2861426642185127 0.39730497984785951;-0.12303900601790305 0.33183430517807655 -2.4483977480328911 -0.13858885894898454 1.4255260526324873 -0.15882549238294102 0.50562244383308264 3.2192074754071669 -1.2321933841162074 2.5042782399066086 1.1758706653994699 1.8362200980245682;0.70885562311738992 -0.090922759860775595 -0.26066406864227021 0.029774484962177487 0.13297526741998072 0.17589558559294935 -0.1166629905832658 0.20697237374590832 -0.49311443361587554 -0.012930432224024908 0.78865284931518831 1.5390397975277308;-0.45416660632716427 -0.44726325285721291 0.86127258238464677 -0.085164249273586567 -0.62216643090792312 0.068266672361785352 0.015543072749503241 -0.24069695193622076 0.32273411173405109 0.51960805044892466 0.19116023264749096 0.70054216207067432;-0.58700745100586726 0.50044829489046361 -0.27411032878491148 0.03741990634804309 -0.81470712828992853 -0.011315579403950001 0.12819949231777011 -0.27680928678760336 0.71160992783127774 0.23542056505345446 1.1517533546347607 -1.0719173533536592;-0.096527985596084845 -0.7786494519764583 -0.46613975549499209 0.014347367975302942 -0.20069161936585767 -0.36189016660277745 -0.029899920643734829 0.24951241125910487 0.6174678376187599 -0.65880076078903904 -0.73431825857410171 -1.1719823140538776;-0.76343316534146122 0.59506505596337556 -0.73588672787632381 -0.2251603633019742 0.50397615536721063 0.076875469894705423 -0.60248191276622298 0.72922989008661288 0.22562584170762609 0.20188310623211256 0.14727683623475377 2.5602943675118488;0.69261178895799536 0.095577201213236179 -0.023513570711264427 0.24706974231900075 -0.28757087262514719 0.22681359495952824 0.35624411656806443 -0.050941117227895932 -0.17063817526300781 -0.33081681702098037 -0.027207755583829485 -1.3103982383091144;-1.099606943285693 -0.31574881569963792 0.82096330799579242 -0.14301144551739767 0.63629700164166803 -0.048640578624335865 -0.030046601750806361 -0.25522582797278021 -0.62307498076664336 0.1789945584998385 -0.52544540491033787 2.3757584226242012;1.7306325737476915 0.49060698582213519 0.50570231129326459 1.2646142744375684 -2.4130672959103023 -0.20700883900097788 -0.10587940123669662 1.5504541848824289 -0.0052553843899742908 -2.3640916179224529 1.5638388730636743 1.5875007320491223];

% Layer 3
b3 = -1.4702084501581456;
LW3_2 = [0.85938234590292206 -1.2527174559812255 2.621252936208184 -1.0072718201926536 3.2643791747846045 -1.296057641655296 -0.98295754435020932 1.3213440776221328 -1.006877251418103 -1.8141811833068411 -1.1869391251228947 -0.41702187080398384];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
