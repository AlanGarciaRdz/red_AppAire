function [Y,Xf,Af] = COAtemajac12(X,~,~)
%COATEMAJAC12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:25.
% 
% [Y] = COAtemajac12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.8925346082208316;-2.2120756541742286;1.9633382797822265;-0.3894449674452875;-2.7031033080401525;-1.6459335241593973;-1.105030079676347;0.54245947098460967;1.885387832797365;0.87736885598900194;-1.9838985781165195;2.3022166515085312;-0.52930865045102071;1.1315446712027548;2.0835636968945166];
IW1_1 = [0.034016889260095412 0.80663742651756754 0.92336297799728329 0.9401509442320547 -0.11564740399411656 1.635851728624707 -0.42748457737074841 -0.39475140360644423 0.32713089273317386 -0.2578002181609505;-0.19287798680068241 3.267324537510834 -0.047707240182629486 -0.015874984942598529 -0.3310309822987228 0.077372886553953704 0.33211279773735802 -0.11893220524922568 -1.2395170905354911 -0.32447246881314062;0.50900608509901446 2.0736912254729405 -0.5140032173023712 0.37027942198676289 0.49783032789479886 -0.16371360266776583 0.41770154376943752 1.067987416429234 0.89254775446843537 1.5194751178260064;1.3645441642847189 0.35396006886660808 1.9245487304678777 2.5889447876647589 -0.30160060427784341 -1.9242168879517612 0.16301006208966287 -0.47205416961837621 -0.72875569292306497 0.36513883743216469;0.2891788310130986 4.0157959587298171 0.53245882397307809 0.0088972375487745767 -0.030430200123204531 -0.024026281434546236 -0.48958423847820071 0.049557515841903391 0.48213520911075397 0.58776464926425775;0.53610668125009431 0.57843326838414599 -2.4979078344237156 0.4249981874155595 -0.22323538622218161 -0.081191514604004478 -0.061248125650459478 -1.2324768932198942 0.69358077890635617 0.90751360447131157;0.57699451743259189 -1.193714515389334 -1.2482955075175319 1.3265503659345719 -0.87092109508783144 0.21481661712034097 -0.21173300454980032 0.95845506549940107 -0.29495761610654625 0.61343385178124488;-0.26236072056373316 2.452140741858464 -0.11655343169293227 -0.19583959531495446 0.0021629007399151185 -0.17416889546416164 0.15649853073463668 -1.9809847077063836 -0.29734570679986105 0.80470882492854834;-0.90894705400374487 -0.82947831081933321 -0.62467442002401807 -0.23181899234637732 -1.8631349540223139 1.9342936287525925 -1.647399359389164 -0.15407696799029158 0.64359519707442026 0.84234388685452732;-1.6152547302551941 -0.1619221201991132 -0.67288172635389298 0.5294405544866817 -0.098399001658994817 -0.1207336274795304 -0.13536222556274524 -0.15341936863727915 0.17564156127698966 0.87048240925531883;1.8069815962117342 -0.96932170330651313 1.9523654577376637 0.39795005719782722 -0.1602260839907502 -1.3605721043069947 -0.91062571613822318 -0.3665231219865146 -0.59929833697009327 0.49054394060835571;-1.603727477676014 1.3069418645722235 -0.18056671619487341 0.8556580637175637 -1.7583140356941374 -0.59660360507128241 -0.70220671941599444 -0.3965356939957379 1.0393862260947648 -2.9620305912846456;0.49301749021791652 0.68246841565825922 0.32368310578125392 -0.52197188613853862 -0.35220963230464741 0.58394482881197074 0.030539322639644831 0.85558339228972979 -0.6014812872367078 0.35308955742082948;0.88835954528110372 1.8201904160141895 -0.82493071539721241 -0.024946586447303038 0.73852685192433543 1.0557082322265663 0.16827453852459029 -2.1223173561240758 -0.2022092192383147 -0.16095221835101589;0.13033649819461493 -0.2191574539598091 -1.2771203820360004 -0.83717459998923904 0.4656864419095153 0.85704052722806745 2.2880323885275233 0.34183705037701523 0.47913371587355663 0.21219130157549426];

% Layer 2
b2 = [1.7910466674294876;2.0823845256135716;1.0988791923309249;-1.2272785640846773;1.5719147921199281;0.31125893074739341;1.0574598192356999;0.40217747288044514;0.18350661118657718;-1.6323620324869825;1.3244095611124596;-0.5003272927617689;2.9611585865089323;-2.1550782732722964;-1.8110194856002102];
LW2_1 = [-0.54183141048360006 0.26046998248326364 -0.64388563098263607 0.045975053711379062 1.3470779558215999 -0.96418239229875058 -0.28300683319448999 -0.056690431699456853 -0.061392894342763189 -1.1705527343334565 2.3512386694365164 0.73472923169857296 -1.7100930640705474 -0.20731081491982389 0.068808769073736994;-1.6797233245115968 0.44648824442329865 -0.7964275988192504 0.50108876462521346 0.62773385863148856 0.35246499722263031 -0.15559437412009935 -0.73169064252878602 0.24914479123878938 0.44729213297777964 -0.078179102454827537 -0.65743854935118051 0.55931346517476888 -0.34644029943608573 0.12330158721617226;-1.2336927180749284 0.67635938710096499 0.073777355570544129 0.46286824590592668 0.58123140476901392 -0.28909554851431157 0.011303986296373992 0.58401488685966363 1.0635486450506877 0.53218670508730981 0.45287044310026964 -0.66560311986707688 0.70986168939569561 -0.84379627999345985 0.83527170292070951;0.37115542564897458 0.11688020441365343 0.0033963524599627329 0.53392910047751485 1.2633548706305464 -0.46744839333576688 -0.12605737573848066 -0.40293922395882165 1.1189766782585053 0.45339527983475136 -1.2599161046471037 -0.056846568247094123 0.64858097486286548 0.18218992947445201 0.30876609720981352;-1.1469787306308843 -1.9712968146935883 0.0069435674933935113 -1.6388677726171943 1.0133160408132653 -0.32922419821600041 0.55925684365854567 1.9490993809198685 0.41599444565679744 -1.9461767251631219 -2.045582127231671 -1.0022971928540727 -0.51172000798444772 -0.070553780197573163 -1.4179751471116364;0.25499640628263942 -1.5808426115067942 1.5796863727216182 0.01380432794714348 -0.1581236458171888 -0.27492984868578318 0.75200748825079256 0.50088174830350862 -0.34816456164538301 0.56597570983984657 -1.4126007320414451 -1.5381293322526188 0.46603205469377296 0.93791916194777669 -0.46819156400274198;0.32534550148768554 -0.3884305775811947 0.084393824958095276 1.5402576293480323 -0.98538509167892585 0.1302315929954935 -0.14965202446598072 1.0118242771590857 0.26527630404152247 0.39973465845093026 -1.9658993562953777 -0.4773641413849814 0.82295511703102908 -0.94032480418164932 -0.23542326966872432;-0.3428233980430066 1.1744186207565415 -0.63413985984336307 -0.65070796804398157 0.21937789561717538 -0.13085861991426401 -1.1377623525929983 0.67866353692039594 0.10589156626614747 0.40541231231623975 0.26306906618037068 0.31184667604672045 -0.57613661276469297 -0.432338478776714 -0.53759425608811484;-0.3417004997162556 -0.26063368093070483 0.31926632057666915 0.23819390573435428 1.3445681626028896 -1.1869344354292848 -0.23852233143336149 -0.48101825636928547 0.54752130517687558 -0.120551551855545 0.63794560339702355 0.68113211416732533 0.65119479613626008 0.15553037619803917 -0.084614393765363477;0.6400772327541433 -0.59245831676315375 0.65333018377933172 -0.039688873580071234 0.45328826157161967 -1.1738215166272488 -1.2714771590111227 0.37049361597253916 -0.7190027732984956 -0.50627817318714441 -1.4411641613470163 -1.0737586906914329 0.0098573785907465072 0.28135656598620046 -0.73580908153807445;-0.29133888672940761 1.8905551750101879 0.036201098491939115 -0.24751351630496135 -0.12670263143003385 -0.79216309576596511 1.0065625165231225 0.61162944456993495 -0.32502794663767276 0.17290690928960895 -1.523047548220454 -0.72997017620142413 0.32977423303437819 -0.43080744791756359 1.8978873897862651;-1.1276986782618565 0.097791796485598464 -0.74915292561785574 0.76184797320424869 0.6420100238410078 0.17131717674813279 -0.0027039502372320848 -0.88280238077485529 0.36772726874396927 0.97307046579897805 -1.2023297057911677 -0.20893538355530761 1.0500192725476627 -0.11567671934721346 0.22033034421694686;-1.0460471122734241 0.66996868572111068 -0.19653158930500975 2.2787390171239106 -0.24201700409326193 1.2665351608473139 -0.42305876440980572 -1.4285193199099657 -0.32766071961995041 1.0347123315616846 -2.6108048184553332 -1.4587960917441367 1.2739585293051501 -0.43039185613780689 -0.56663344166112573;-0.25781026238638599 -0.4788390128295234 0.29891026547637162 -1.6290420201929465 -0.19026669470737884 -0.19272525713414662 -0.24116116951393124 1.0995584925023039 -1.883663968397985 -0.55080970700687149 0.885780232201277 1.0911464329647815 0.59688325712234769 -1.3189790132784498 -0.42118033731709381;0.10232118615660124 -0.47386060593196722 -0.55223945134264441 -0.040959148433216963 0.35576005691784734 -0.39165469821743465 0.68524847439474912 0.17164835966482819 0.28919905117647116 -0.37075315484854882 0.69454456087036298 0.087674552638830977 0.50458948581245544 0.0730996585457101 -1.0280599556491159];

% Layer 3
b3 = 0.63677924524431517;
LW3_2 = [0.25221853704565689 1.1806439474596733 -0.46566076820480301 0.34341363988820173 -2.0551607254185229 0.15061938392519611 0.6057543024410893 -0.060608261126832326 -0.14903237083105925 -0.48432011833725896 0.50810495775412201 -0.25760790027114283 -0.45206296187967532 0.50236176789485387 0.43674385862739146];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.201288244766506;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
