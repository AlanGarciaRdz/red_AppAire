function [Y,Xf,Af] = PM10SantaFe15(X,~,~)
%PM10SANTAFE15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:35.
% 
% [Y] = PM10SantaFe15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;0.00341273633199099;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.8509683744153812;2.5527904069361731;-0.42245470826364634;1.66132807480239;-4.4414105385342655;2.3422937235566383;2.9838506350666667;1.0483493477120551;-0.56201637856692654;-1.197008449772873;-2.3657659904553441;1.5987195560367127;-0.60687428688764555;4.0038706719926571];
IW1_1 = [0.34639804726986217 1.0531243207083472 0.20129674736454034 -0.098512601647652354 0.10840964330022965 -0.10443361436726588;0.38266258177203627 0.024871737072537006 1.0227047438871806 1.822054849313264 -0.5452759609816934 0.25169638407926326;0.37508126903021755 -1.8417448826007579 4.4127583853309762 -4.5667324428208396 -0.21789628321949489 -0.017745376748335998;-0.95210170503962488 -0.57932064177252374 0.29739325791726123 0.34887424510473219 -0.28980677627120455 -1.2561216121098744;4.8658767173981525 -0.39736492893331271 -0.95717033529862217 1.2907394833407688 0.024754019112126928 -0.21390072586324721;-0.3610928245574459 4.4315471123249806 -1.258565118878042 -0.32757304352242028 0.69897887230398192 0.80720971296304134;-0.0071090715747885343 0.13143421304564742 1.3095009798605912 3.0228131175086856 -1.7154244331729065 0.066570712885318434;0.47417414501185806 2.1431465134105285 4.0924350774031488 -2.6175798215022112 1.2172064871717747 0.086510223964454888;3.8847131646209374 1.2902955578609101 -2.7766559531561126 1.4301412769666209 -1.4046198830548164 0.97422351444632671;-3.0751119971421041 -0.31538503545067004 -0.25932267515174157 0.38583987713340223 -0.38805352575263818 0.76989666234922072;0.57683258552576699 -0.93944029297010956 -0.54862279687602145 2.229245658692534 -1.0698563940283474 0.93663224641395149;-0.56869358907856504 -0.2847502345457551 2.818021564655103 -1.2927081400341778 -1.7339509905976886 -0.24813617012174796;-0.26572509032758024 1.803299659908733 -0.52326351245536695 -0.027498255317712376 0.65951075426896388 -0.070496549087948251;9.3736005363086026 0.4103147194694779 -2.7656892960505424 1.6385447097106778 -1.3058957391170229 1.0904427111995805];

% Layer 2
b2 = [-1.6503051713837074;-2.9807442520356013;-0.7344552175321214;-3.5840137490008082;-1.1151506687040444;0.90520918714262444;0.49698439510279341;-1.4945657213790757;-0.45421633000608752;2.7208005392627412;-0.20428289698221413;2.4451561555836792;2.6594238520923419;-3.1622721314908109];
LW2_1 = [0.95327911686367972 0.55816223328040804 0.017823233031236396 0.55796559064467743 -0.47902879825550404 -0.15127825935229916 -0.75162197365478134 -0.56937842478705858 -0.28926167468037811 0.36684298935587034 0.22847721592145198 0.75821227591136098 -0.05068413695971051 0.037070361261357224;1.4378030295160495 -4.6800883684876489 1.6049184144324624 -2.3669959283308195 -1.4236060698599131 -0.32578967796339187 -1.8507073460504881 -3.0718009268726738 1.2363667063162707 -0.044673255979285523 1.96808686267868 3.587540678915853 3.3783190263783101 1.1236468222624907;-1.3796822081791271 -1.305364347086283 -0.64766653398104812 -0.38201060192054004 -0.87112839405345621 0.070820343562038382 -0.69388384475823128 1.4027596392749127 -0.59660999963928052 -0.70556016919387321 -0.060245829250165528 -0.8900226834137217 -1.0582411091530739 -0.23699731927241741;1.7836728473904175 3.0090953790148105 1.9116322639033729 -0.22552950285298873 -3.0770762671306251 1.0664994410419069 -1.0240056926807048 -0.24960039073245449 -0.28627278372161163 0.061416716004796798 0.63318059126358728 0.9319088730462719 3.1712643411109034 0.83416149991834787;1.1603175817550113 -1.4329310506542123 -0.72660104609234821 -0.20070106847019745 1.5511212066192153 2.4116710318589965 -0.73107036263947189 1.66914781635355 0.47520835385766813 -0.44939739219421815 -0.15205378720891066 0.82455566650212642 -1.0219033253696752 -1.0540228828969829;-2.3248072919156288 0.95258905424582496 0.20516569244588856 -1.2572355194660492 -0.34379260105942244 -3.082253894123423 -1.6160281309979396 0.30475533274869959 -0.72611022038741324 0.81936552390483219 0.51982879667809412 -1.5296485786408243 -3.6193808165656582 0.66871291076426032;-0.30292190888897635 -1.5190283444118522 0.58501523417446133 -0.36808496524172485 4.0119474682292671 1.0692248596906029 -0.057667679473916197 0.44322364527833857 0.040367061708852341 -1.2306714276683874 -1.0055004234187996 0.14078672243135162 0.90365263274023222 -0.91653602659099664;-3.2889683802785288 0.82799237315343577 0.74746683345000076 -0.22615503062344838 0.60918214971929452 0.48473591567753294 0.92851752537243981 -1.3651089573254847 0.44094534487609172 -0.83968931126150781 -1.1690942471776622 -2.2933321071655293 2.4037295873212687 0.068453717764568212;0.0041839637567554627 -0.88755908970816122 0.36730026300082969 0.1503171799951678 -2.3498360419330369 -0.29569724569023653 1.4767245259206367 0.071722182247594329 1.7568498958381056 -2.0632130830279825 2.0983528209700788 0.91558594748507582 -0.16175976743578541 -2.7119699246758979;0.59802666005389604 -1.3624790078645368 -0.06636517204168807 0.42414312477236221 -0.83863432861620912 -0.121092214818144 0.76642486012514344 0.2066975073401113 0.72772925326204174 -0.75785959465796549 0.20728280784457806 -0.88819389638962187 -0.83688661084219584 0.19630922336340112;0.0014929996271662443 -0.89928578595635655 1.9054418863839861 -0.4967752330846853 1.0164184305635731 -1.1569416474517551 0.032161370456399302 0.57057959592763319 1.1059519492237901 1.3510779119096905 -0.6733642917166347 2.306729179482264 2.372510012827858 1.1152031243370011;3.5854840183009911 -0.74986508109751837 -0.5140479101939871 -0.35336786100651935 -1.9280742007032354 -1.0750232240579616 0.24048727549900947 -0.77211945681550864 0.10787835452465859 0.54872575878687269 -0.031488734624073964 -0.86597985712255443 -1.5834672250735999 0.6622646373678871;1.1480322620943371 -1.6236820014313031 -2.0560983272224567 -0.10483071755394095 2.5372259196356328 -1.1762305592374223 -0.0063370865742379268 0.12881055398593255 1.6780719923799128 -0.87131196089154683 -0.085556978019959262 0.55062936379703609 -3.7670045631083497 -1.7625291400745828;-0.53578097314553885 -1.568458832305748 -1.0799488643477098 -0.087174327779772159 -0.7393442235027321 0.32168700346622109 -0.22806290625323433 -0.97104520308014131 -1.2773131131509561 -1.2038991323647461 1.0773158232553 -0.8999030498927032 -2.1517268850316045 0.36931461907065322];

% Layer 3
b3 = -0.68643658366084326;
LW3_2 = [0.58124497846605094 0.37803044903211291 -0.28851940363210404 0.2201291535442213 0.33669069836759519 0.072156715476926092 -0.49276870837764009 0.21721083339299987 -0.20914711796943772 0.9945185295463157 -0.078647638402895667 -0.46247379133282679 0.21228391605266753 0.30091820103065187];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
