function [Y,Xf,Af] = COAtemajac13(X,~,~)
%COATEMAJAC13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:25.
% 
% [Y] = COAtemajac13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.9120074902690085;2.3841512241667711;1.3298259850879097;4.6323518883411898;1.4489954822420894;-1.7827833199701624;-0.81155614830646938;-0.056674298374612561;0.6780819940225663;2.2573961111435006;-0.79263816444707635;-0.29634338634713098;-1.8455103460257565;0.17068314787361216;-1.5739416097798766];
IW1_1 = [0.057788217915379685 6.4325675221385152 0.65159374094152678 -0.024597370736060133 -0.29965803501370047 -0.14432853751591895 -0.082545414563380687 0.24774164104629368 -0.20592697815010783 0.31222317287155471;-0.68420744094584596 -0.96061663363965943 -1.0328827402046317 0.20782553526263495 -0.029216931955914665 1.5798544326766037 1.5281403986897344 1.8398874908481635 0.23430110662745821 0.76226618239172983;-1.0834530340416515 -1.3703722622887551 -1.9231150259586525 -0.62653549913871498 0.58955686524741691 2.558099521511497 1.3258661358960346 2.6929992234818325 -0.24371840678621332 -0.034298176276301003;-0.55868003426684587 -2.783701782095056 -1.7028667436929135 0.55838956947780904 2.7124431588491547 0.69552133657719173 0.14807278172817351 0.51262370877924457 0.15888675028172489 0.79017981762724931;-0.15744344369996788 -2.4898728315562568 0.19767486697226991 -0.39890665735229974 -0.3636524802428035 -1.0542532973172976 0.37062378543529084 0.30049021285978483 -0.18595409822542713 1.2831643321497836;2.9753206530319147 3.2566027290139754 -2.1390407692139819 -1.9140263074363408 -1.46358087776631 0.96195998117809234 3.0346414711599818 -0.5858846586618901 -0.85498245841127885 0.58166852913438505;-0.11987397318319207 -0.74492332741172029 -0.65451732345570501 0.33180510922775014 -0.35746554747654108 0.85907192499781215 -0.68944326825303603 1.0936658323209065 0.30166144666795153 0.47090702318784516;-0.1993188276125476 0.37967439412552034 -0.66299750261759005 -0.20701082179354999 0.36537855457825741 -1.2845751256741327 0.80955317903143742 2.2115147056030975 0.62672491705608835 -1.3805799352336432;0.50525957278929623 -0.2364917318812978 1.0314067946913827 0.25203890829698361 0.26648805926076669 0.91632454570640731 -0.60651953190315222 -0.86627156388909177 -0.32595514033503353 0.95935764196655615;-0.24520077589931671 -0.024110933071947296 -0.94217598343401243 -0.44532698136925414 -0.75142069532775502 -1.1085422300659928 0.70444124926876051 2.610876443331211 -0.65363622846038238 0.61030934259060576;-0.44428678434238145 1.8854954385728055 2.0189431352888096 -0.2587474556386114 -0.036460819562836012 -1.7644667565698482 -1.5616122439240578 -0.53420525938200247 -0.11739690273793373 1.1633748807558106;2.7365024673880973 -0.018331916873920443 -0.034981212178202589 -0.21915470494964212 1.1518708390022603 0.14060118440312308 0.14628471302111162 -1.8228886013731125 0.45762759353818039 2.3947918592570927;-0.44448795097742266 -3.3303950343975695 0.41081090985765101 -0.41401707212082006 -0.26181985834677479 -1.1918264075234188 -0.72259807089187478 -2.7782955338249216 -0.3279205705904798 -0.95387495756032215;0.81772650436263528 -1.0114591022237043 -2.5056307620354685 -1.0166966148699659 0.21998825110396636 0.1383209972596241 0.95309035431146882 -0.43947202619585479 -0.28265252165868782 -0.64240062391730979;-0.37896339880395719 0.75233169744871875 0.88737319211178411 0.39308412423043398 0.13817414362776687 -2.61809517082495 -0.37967097865852995 -2.1294297242614264 0.065820249128955663 0.39819563000999719];

% Layer 2
b2 = [-1.9469906496202689;3.328269537814966;-0.76616309847529895;0.57960622877099677;0.540173981682184;-1.1117577231126667;0.23105310331760751;1.5846900482896662;-1.1608656003847273;-1.3219283640087536;-3.978697751156719;-0.27408032336184562;4.8386498129913686;2.9614523265709787;1.5024677861799003];
LW2_1 = [-0.26309372125694042 -1.6249174129861004 0.41582162673890999 -0.858623194875753 0.76108125956529693 0.52058393621072641 -0.88155479132462067 -0.2360297116129314 -1.0784408308994702 -1.0502616640423479 -1.0017967893182393 0.45179269465750682 0.51461221090945419 0.72422377929368276 0.24078484757425592;0.62958400548738003 1.7260798438824094 0.066732764166501299 -0.014355746297823463 2.346396920428341 -0.81966354302083866 2.1966928181812317 0.14974675260538151 0.26695239357200656 0.044790104303566815 1.3686957584850445 1.5295543655711741 -3.0287816839371779 1.8992470390732037 0.677485885570139;-0.34990423505128321 -0.28999147111481383 -0.35797609108508965 -1.9288773057316349 1.7307330132280574 0.41614709300829988 -1.006594204999963 0.066409153479598387 -1.0429776095038115 -0.97778407771795017 -1.8104157445076834 0.38671664922178983 0.51901212939621444 0.077920614219703171 1.2269990311055947;0.39626797368690087 1.1331104773510592 -0.18764619780885686 0.9545186876491486 -0.84847594304617668 -0.47906111097127968 0.99141576963961131 0.32500875568242737 1.3330486772433128 2.1287768803130254 0.98011420182910092 -0.51837113360625586 -0.27271297906283176 -0.51508290847699278 -0.43951065371942905;-1.6287186592490246 1.7435879787682553 -1.9638710522065854 -0.79729476563276547 -0.33787435334397603 -0.093383339177805891 -0.13638806831558775 -0.34751991728507503 -0.16885964150028121 -0.89970697516038056 -0.31698333668690404 -0.29215716250483353 1.1380988135253598 0.60011023339533931 1.8744986558200274;-4.5195078509583464 0.36625867494388309 0.054663028454207313 -0.66408596731483649 0.88734001864432832 -0.40004649614465537 0.29613064418085833 -0.48300451539095801 0.52353857875256304 -1.1904406653796407 -0.48648049511447405 0.076990777797952936 0.15882658698406055 -1.5820943926046149 -0.582214667089475;-1.5962176506838159 1.820038888025687 -1.7599188853049839 -0.89186962236985068 -0.3852414965946761 -0.10305510204298425 -0.11159130147431756 -0.27721134690288435 -0.11925180796653245 -0.65605908663630452 -0.3071827747662958 -0.326161858952846 1.0486979710769437 0.82730551447875778 2.2065124738643025;0.65718927456361931 -2.7686154346110383 2.1675136604638747 -0.15681125515127917 -0.032452242362607187 -0.1691926811229057 0.43493832088670498 -0.75810274663823884 -2.7130016360995106 2.5924986657366609 -0.0074066506886158734 0.035164641612496161 -1.2170280261052979 -0.26280947805955068 3.4452400550820785;0.20393609015766637 0.57721930516364917 0.22620781503268789 0.47523050774550801 1.3204967079762582 -1.0585603533109254 0.4573169109098032 -0.72450585771531995 -2.337348019851774 -1.2502268045795393 -0.16606415147602765 -0.34236262000314349 -0.7634975738494979 0.65309996923945568 -2.057730766857897;0.85314085984419485 0.27056601204288638 2.2636182880644533 0.95485756143141798 2.4438429180315326 -0.54113208167667659 0.38854035949681992 -0.65131005898977501 -2.7658920271380256 1.0934846794765167 -0.39816661181475799 -0.30623094079248964 -1.8623525046060807 -2.2033117684218286 0.28121403451633398;-0.1132751355931681 0.69907419301961782 -1.7633720195937097 0.85290403712691465 0.73474254829539631 2.6407258582206241 -1.617976299434934 0.74299225151211801 -0.72978249510913129 -2.7549722049987597 2.2883756317196893 0.56234378730700818 3.7080051451474585 -2.1656944225296373 -1.9487086420476689;-0.48026852779792811 -0.36047371210825613 0.88433520828358303 -0.7839007674929046 0.56152021355563397 -0.19556817540995455 0.66623968265720368 -0.40627196008233007 0.028458163860577333 -0.0086290961560001947 -0.39171031593299033 0.096039573782990828 -0.90820310048416641 0.27944667498884646 2.8850944760086663;1.3901942344388245 -3.9527506135776793 -0.053300164965179295 0.79378336584469578 0.8676195579252004 0.60052472155643422 0.9419513548259878 1.9583229807360716 5.820173935447885 2.7324321757862209 -0.93875133316214721 -0.14298828697581645 -0.26060364908548361 0.26372559724756184 -0.62819790001162423;0.79748863294686656 1.5316661780631164 -0.07225468787592651 -0.97724978903209669 0.30821885383952136 -0.27735510436761152 0.47712040932716532 0.20784208162214352 1.0438834516675752 -0.010622984640651714 1.8151768949209788 -0.5187300096428763 -0.78418605638061922 0.33758193346211945 -0.099179874835569934;3.8955147902836815 -0.45227853442795085 0.15386535203246213 0.56591110003962575 -0.94525102537583583 0.39808817677216352 -0.31326000812700172 0.28334329084541598 -0.86211201614293342 0.32409209270006178 0.46726419771051325 -0.061467835856321304 -0.51391771298653133 1.5986602536802341 1.1923467238057144];

% Layer 3
b3 = 1.8117423304619791;
LW3_2 = [-4.1120666754114188 -1.0387012409263126 -0.54129441089019292 -2.9102653300275696 -1.799674935649908 -1.6451762599797473 1.8381838145331977 -0.14886666486368122 0.19807086039760596 -0.16087548797281193 1.8924527072069484 0.42057039013101932 -0.40546029426410529 -0.60012504847669623 -1.5487834047124505];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.201288244766506;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
