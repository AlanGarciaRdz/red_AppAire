function [Y,Xf,Af] = O3oblatos22(X,~,~)
%O3OBLATOS22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:46.
% 
% [Y] = O3oblatos22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.100381449508131;117.647058823529;0.0560224089635854;13.1578947368421];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-4.1135210108810467;-0.62840470962377526;0.062023052246998209;-0.77054465829787722;1.8680340962599362;0.05082863018206682;0.55797440985423497;-2.0280222271186892;-1.8528157601897277;-0.34129899276270315;-0.6937356059464439;-1.7691563597695279;1.0084707848865109];
  IW1_1 = [0.034899108883692603 0.54958913116832253 1.7676484919741116 0.60225580716653238 0.080585502738570486 -3.536928500270526;2.0936102021029521 0.66106477042121947 -0.68845064843579362 0.32715956282262931 -0.29411061794546023 0.97413094200165262;-0.084097432630527366 -0.88266897813960432 0.61635563246895997 0.37781665607050574 0.58473434418519932 0.35031650441710416;-0.16712031248699422 1.2340726565445255 1.5472717727099103 -1.5967197418703807 0.27112644550711462 1.8283976805587916;-1.701323306866285 -0.4557878772581333 0.64512897146997306 -0.17790279887114807 0.10529201503249389 0.085515691319842824;0.33240661686811823 1.7220923691479246 -0.84847246549263899 -0.87391008786526936 -0.99472546939111106 0.28682830932941411;-0.15806345924767434 -0.46891537611829898 1.2304252164225655 -0.38366354956043935 -0.50058771320037299 0.81539981137293138;1.1827753315146525 1.2975688813059256 -1.8009331886031235 0.54926558200387932 1.9482287614816514 -0.91678580962855249;-1.796903832807589 2.121364576263427 0.4264864964872716 0.16138222866391322 0.61523873141646879 -0.80296136832885967;-1.3782667327876366 1.5263298339462483 -3.0992651230183261 -0.71856065882725595 -1.3737442804398348 0.026092987658327911;-4.9551996133650711 0.79910992611818932 -0.25610087054922054 0.64318004298285736 -0.049956684730083162 0.11413457582207526;-1.148111595629316 0.54248246035364789 1.580728795475792 0.18961858730597023 -1.7802035130829574 -1.4866725640047387;1.8204634586048098 -0.63219161700136817 1.1047956671320363 -0.33480612425158357 -0.0098178250854391406 0.1903929398268335];
  
  % Layer 2
  b2 = [1.1080477954723649;1.5600594259059635;-1.1203104155341046;1.5645206518933943;-2.1301003930266194;-2.0675410323089358;-0.80827875205686384;-0.69882852030522447;-0.95210202605664818;2.3612797382323825;-1.1597213990287345;-1.0394173629177828;-1.3214701413699688];
  LW2_1 = [0.42076217316694992 -0.99236840436805751 -1.7988875389042001 -0.94769991986499236 -0.84552027412840725 0.60015888634852965 -0.3925500334876913 -0.81449613981393543 -0.42038363238484117 -0.29895703288719983 -1.135440630045579 -0.10162606856163672 0.23226155699287315;-0.72289738936755565 0.55504340173108302 -0.83696037151861336 0.44441728823879129 -0.34414123171773892 0.18082594857784084 -0.8438224768409105 -0.13528064712486687 -1.1717680612955885 -0.45234893921556851 0.16342612383897107 -1.4036588117798818 0.72329945911634941;0.42533037723469103 -0.59794379979864454 -0.49891894833673811 -0.13274982853317888 1.0688045186608206 -0.63481089132782831 1.2227697092073992 0.44851755431347623 0.17533778002131975 -0.014408877018642159 -0.23145700629193292 0.0017906719017259567 0.2630822608238238;-0.7067243733754669 -1.8179833412260966 -0.5644657639466496 0.0063655608159820659 -0.11522996385303622 -0.16962225086330596 -0.34952002204232135 0.39901566354919399 0.0049355813178211319 0.092177091796750543 -0.95042543205036378 0.029090159409921965 -1.2376657685636214;2.0982546180195643 -0.47576758992458373 -0.29480042934248751 -2.2014201813463021 -0.38642781056395153 -0.64421714960513676 0.20648113273477917 -1.059781384029832 -0.37324318040365956 0.85939930943853948 -0.14797957529642819 0.31452541373202347 -0.76265207034761662;0.53304519003571116 0.36454436034176801 0.40585607330709861 -2.7933637277607368 -0.59834916251363279 0.32246419477740945 -0.39631770392691712 -0.7184834306050939 0.29823822987695425 -0.48956357401135708 0.4775888452086392 0.017782892720107329 -0.62244834774691593;0.36588961260829383 0.4970391725938112 -2.0836463474963409 0.098265675885522319 -0.32825467870361275 -1.2420871946260357 -0.32848415266448427 -0.5862679706385493 -0.7297966052267334 -1.8442626300424712 -1.2443894091506094 -1.0082930203566942 -1.4992031583058567;-0.50229472915690732 0.29765331493988589 1.3077506533258076 0.16028323115791401 -0.058787403467111782 0.7791775541690118 -1.3807146383903188 -0.29745477387974251 -0.32110324529440304 -1.3180742766750289 0.42877991226569456 -1.0820888518222807 0.34312994300765426;-0.204841274035267 0.79339970553402994 -0.61692449776769975 -0.08325331262878341 -0.52157002963971721 -0.37933219627408671 -1.2319402273204656 -1.4465771975134665 -0.43732731871292896 -1.9430049436317109 -0.89899159517939109 -1.0337129425524869 -1.3420652770834125;1.4649657614738907 -0.36649439168949111 -0.14379019174822175 -0.89827957988996954 -1.5857055243319902 -0.48224583811540422 1.761096604790837 0.36374878140378802 -0.89443975177280943 -1.5953354921487419 -0.45165377443055621 -0.47095735884800183 -0.87018036289854028;-1.635950989954041 1.2396951047333056 1.3222445399043701 -1.118271015133748 -1.2239600567969195 0.97622030239876478 -1.1592792785532369 -0.30308130506727349 0.17296081921587436 0.27651783941122626 0.31247228422185491 -1.0335503975235445 -0.46093301971230433;0.42692681798380122 -0.37793327452875131 -0.30945099415487309 2.0432763095149267 0.84359462771853966 -0.55718747449820649 -0.41262013301666445 0.78010961833114023 -0.50991386386053794 2.1180457568379025 0.012777606176199071 -0.57359519541346971 0.28394140643903854;-0.39294085173576648 0.11483369058234437 0.45078949996741435 -1.0589976129415994 -3.0825428019972199 -0.25226165229813752 0.51588877426117685 0.30383566993725108 -0.14532436630248116 0.072768511653015649 1.8881541083904505 0.037885166194267655 -1.1324301343711234];
  
  % Layer 3
  b3 = 2.6284360887365588;
  LW3_2 = [2.3887563365603572 -0.47863589090539715 2.9057773163631859 -2.6543549282553678 1.133767650476863 -1.4378801421688547 1.5660937398392356 1.3978729410302757 -1.7792415626316163 -1.9484207925530794 1.6089663849214511 -1.507576455767464 2.4258096300433691];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 13.1578947368421;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
