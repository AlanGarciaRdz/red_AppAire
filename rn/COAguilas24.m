function [Y,Xf,Af] = COAguilas24(X,~,~)
%COAGUILAS24 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:21.
% 
% [Y] = COAguilas24(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;0.281968137600451;0.304971027752364];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.4770625989795159;1.7286566473944747;0.66388918969028154;-0.023093742460881476;1.0949578930748411;-0.65482169066822526;0.13975616796338503;-0.3318677194025979;0.17889069713670613;-1.1940502998436364;0.84945346354217965;-1.0951954659809418;-1.438971798269628;0.61699042172287266;0.87552064945779262];
IW1_1 = [-1.3526162013364103 -0.30527915841137809 -0.23938352831580773 -0.48101610395132666 0.43280722484566841 1.2280890483676892 -0.10457188145937761 0.79502520419696043 -0.34714902544222276 -0.1464273735232961 -0.30038154389075589 1.3652772219879981;-0.96932730012371815 0.53294987939665717 -1.0982623589535452 -0.76107019786536101 -0.084894800026525954 0.29137876979823085 0.35745968916350063 1.1651339426329217 -0.18799364300407889 0.45513992365191136 0.19276509962759422 0.69553917565129963;-0.3794672959740607 0.47765527440867006 -0.25623449690923178 0.27784811718597652 0.60617073954609757 0.53209046898334922 0.2365911648815768 -0.44911474914546656 -0.33854616729784492 0.010522189995771897 0.41788522971273856 -0.47523111630839016;-0.056627518010342895 2.7587339101733201 -0.1904579810185616 0.14933275809473134 0.058272758132640302 -0.1519427145227224 -0.073469050902651045 0.19795165296909195 -0.039177263972990151 0.28426129900467151 -0.094004622988125106 -0.0055116098791407955;-0.14308969932114443 -0.96129418395603328 -1.3692839588369055 0.39600713702230372 -0.46417074465754271 -1.1237071890659902 -0.27400312851004105 -0.69075112245893922 -0.28005640815778521 0.099506204891999878 -0.35109679223423412 0.063055333064206104;0.7453286007853881 0.26045254346932606 -0.06535061507100072 -0.98970809656642322 0.7661352965770003 -0.2521214740327708 -0.59563249183924727 0.29670899311183424 0.32625384267613955 -0.79168927163531089 -0.73871692838382719 0.32615614983106711;0.044382991041279601 -0.093189606990172674 -1.3138583695620647 0.73446506675729828 -0.87450551560385659 -0.26337803130117471 0.15148685647540769 1.0726037347545143 -0.48056355549141644 -0.17522252704482599 -0.22891945314882989 -0.10999094506478516;0.91608655325253419 -1.1851813298770992 2.2229758856924713 -2.1970797319975772 -0.47488005345345835 -0.95790622493403077 -0.06066357277291437 0.34265888256000471 0.12017760784565963 0.046256799706328927 -0.31718152365230773 0.63406818838567669;1.9074013578392066 0.3002928988300953 0.17638816692444728 0.53752727950675872 -0.07210867835293118 -0.18216668169348058 -0.96249022311729981 0.04050631149929311 0.48994838150698566 0.25930329258613782 0.72363385122953283 -0.49210823905412993;-0.60191918362825669 -0.10314979278537882 -0.039394380743315735 0.33930781061121795 0.063727514087448672 -0.37382910609284475 -0.66712200921718134 -1.3671363685764149 -0.16013266710344176 0.085717665543080773 -0.61051687411299005 0.58011673266396424;0.18304658290592571 2.1155036334813353 -0.11454306370783618 0.0030646083644595059 0.21715044899007363 -0.084797635665849733 -0.1283318549768932 0.41151842813152018 0.10059321619659674 0.083295222796753457 0.0033497340738808069 0.23364754546157182;-1.4565173732696928 -0.78774724244174266 -1.0312307563045764 -0.50267135587845158 -0.2221781982224634 -1.0219934372508661 0.040207228263155037 -0.36724527583957139 -0.5133209256694341 0.10942945055249147 -0.39760155625127136 -0.37306286695165608;-0.4427004897573677 -0.9526697935810241 -0.94052640951960098 -0.92117935281477237 0.96936465173262176 -0.12176213380453606 -1.2619297053988465 0.47697941696700874 0.36253416924115961 0.37362895608863034 -1.5138593734355064 0.79006299498845389;0.85673672298293402 -0.52408345158258129 0.70262923513087461 -1.0463677919792997 0.53916531720476302 -0.075269823350055304 -0.028801769353829589 -0.22873889329857477 -0.22905905235736632 0.14016217403723891 0.7533977065007128 0.15140124351531054;0.26731659354512222 -0.10230117276389095 -0.34608221259469113 -0.081811577978789143 -1.0401760331603349 -0.90130235153535598 0.21047113040511478 -0.58733284724472312 -0.069101388869805519 -0.22886360869167599 0.29499163080454349 0.046650596707078856];

% Layer 2
b2 = [1.6152012429943228;-1.2919895231915746;1.2018123888635603;0.32737626549315191;0.83231720442012225;0.51668293536184884;0.45296033166422339;-0.26053429377897785;0.64113388817650119;0.68710120425613841;-0.64129649068983252;-0.79970047272596168;1.6333364704922224;1.5209522985203912;-1.6256207501000222];
LW2_1 = [-0.56743890709186906 -0.27855710868236183 0.91816006262498606 0.31355403128295256 0.40168376756676272 -1.4893467954476234 0.13058700994723946 0.094149012993400311 -0.6095731223114369 -0.54699397832142316 0.63174142089626661 -0.2116250995534292 -0.051357023478363621 0.1306418289262766 0.19424051768872733;0.54297869636827889 -0.11401177075345012 -0.50760738906963776 -0.0083975756815016407 -0.7540856051328062 0.58212543945909578 -0.0018743405863761442 0.92005538903604445 -0.27398213518647707 0.096500103442334215 -0.65053669991681162 0.0087416132317150834 -1.2587558933345711 -0.42176585203034778 -0.21238784111178816;-0.59320722373369084 0.062760372169946538 0.59009133865458951 -0.39058612029241019 0.4473321876166238 0.23916536715742828 0.108958231744259 -0.32006836795643412 -0.66317620322620585 -0.033792447215683363 -0.63843797781215628 -0.31070430728504489 -0.14918107844395154 0.92472504622078144 0.16461528602018571;-0.055321421513075821 0.15833729451270137 1.7788116285855711 -1.0608823589174348 -1.1676071786237787 -0.19319151657072178 -0.031774981907985063 0.74219059033435086 0.72632322118520709 0.39130800316538755 2.1978717019837224 0.08742292039154545 -0.028486015927408615 -1.0247555944644051 0.41147891940519832;-0.68829522349283989 0.21958935368920632 -0.25625099586710631 -0.81378693003507518 -0.20710170057801688 -0.81291999277507976 1.329012881131884 -0.31850596029815176 0.058763425427750503 -0.017021196185776612 -0.44469169557895388 0.12845682198760772 -0.18666132681789541 0.13554227825134668 0.81441833276817233;-0.15639600471789128 0.6374871388633675 -1.3208294852285525 0.28395250203605876 0.40472070570070556 -0.0093079141964198774 -0.22643842254068616 -0.74636600930483588 -0.6452176069615031 0.41493000280295217 -0.016442856653735075 0.41738079366420405 -0.25618648124951882 0.42207270463498425 -0.34224173565429583;0.71676638688660543 0.27941374686470333 1.0961420742057861 0.10465445320737674 1.2010827341595387 0.19726796572241326 0.5987600261340652 0.84858507795563198 1.0632711757475768 -0.73062018383840632 -0.33416221404101126 -1.2733575647556545 0.46446966865538064 1.2395975860594257 -0.19383729337885167;-0.77904043736313777 -0.66221398671584686 0.48995875934798788 -0.36579845927245347 1.0348825854047252 -0.23434706186298662 -0.12853011788153579 0.45779264383293788 -0.19009674245926239 -0.23167578753391926 -0.48883328692704864 -0.35307171815721489 0.10847241909740143 -0.46478820244105207 -0.11852226378392275;0.74957860175124447 1.1696961669746606 -0.032573246205684414 0.086415700798029474 0.19874252311483853 -0.35941954265264647 -0.47376934396948905 -0.58255424050589499 -0.69237390513168362 -1.6572498261263438 -0.50157993165083581 -1.2096380793955299 -1.5176996331243169 -0.6745409171565816 -0.040736209932616702;0.26897569182411096 -0.50452719581449446 -0.031701303704301839 -0.4208285031109042 -0.24655668061185956 0.36739396876039687 0.23107366646729036 -0.32458979429173079 -1.2250136725651093 -0.96976137228058046 0.031675453536266454 0.52091756237246367 0.25459882515651328 -0.045703758608303134 1.0535022201529329;-0.36782155223401902 0.010295021659370251 0.56746667441931031 -0.1919875312618799 -0.39007291725217658 -0.049432195175181493 -0.81466712223963422 0.24832094437640254 0.86994201244127867 0.55534820031537879 0.3666220140825327 0.30704462368719071 0.78371596537640253 -0.31619779971760753 0.57330531678625474;0.13296351320971375 -0.47538335243362018 -0.12590847304336736 0.32878569834680232 -0.069669793224314158 0.39670956053427986 0.52252760281416732 0.41355370678588654 -0.19309891223269829 0.79724515769383508 -0.52236905141676959 0.35186960907325004 -0.3832288070321011 -0.32539867128120803 -0.39715291232519617;0.94976151208693671 -0.032315168732032912 -0.57533875345324048 -1.0178006933299257 0.22746676340632307 0.31071953374576516 -0.62891037339133182 0.29445666007824189 0.36886244192278761 0.16115450179047763 -0.58104898398727955 0.54332235700735576 0.37993692456775596 0.051722342522237626 0.74412896772215809;0.45902519215471876 -0.17506350224362069 -0.21829161877841874 -0.31002809714867191 -0.42734597772413019 0.2399238114926821 -0.18585798578283291 0.91331817850979014 0.48227700131678497 -0.78166011327616958 0.23086234264812308 -0.27939343688821167 0.12971144170142201 0.88187028394888978 0.32305981178712634;-0.22761849839121567 0.4279995767956406 0.85251223247851293 -0.49197841755461708 0.63235137208464176 -0.090200517385567489 -0.12566037577197733 0.16092828618124336 0.51651216345904083 0.37670861369478853 0.20820405863781327 0.058888074974595084 0.46181698414840971 0.10699984596199882 0.8828674449283096];

% Layer 3
b3 = -0.0039863035030399362;
LW3_2 = [-0.30150824089168821 0.51396280042842657 -0.25906119206216172 0.73902049447130724 -0.38359973291100274 0.51991890416981146 -0.85842938958974069 1.002386578027715 -0.30672396438662874 -0.57545010777296879 -1.4916610988747632 -1.0777060935952092 -0.37549498461818354 0.71208229991694327 1.0088731812814735];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
