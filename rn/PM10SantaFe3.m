function [Y,Xf,Af] = PM10SantaFe3(X,~,~)
%PM10SANTAFE3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:32.
% 
% [Y] = PM10SantaFe3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;0.00341273633199099;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.8922990683912857;-0.98430186661001906;-1.0069583196471923;1.1742525616097794;1.0107314920814607;-0.99593054673927317;-0.20307492017133033;-0.08988611292954804;0.24655861343351068;-0.91050614188945989;2.1827098518055061;1.7797466854568125;3.1399019488491162;2.2589554208067955];
IW1_1 = [-0.94344103016625558 1.7618668572614276 -0.47822866354494148 0.73123843825242718 1.1821233165224563 -0.0079552979146212018;0.45035906204984338 -2.8977701857730342 0.63518691134625282 -0.39880761748637572 -0.62627852010577822 -0.15342754617013579;-0.30175410849058842 0.40416972436093551 -1.4600533567454577 -1.8952268891625119 3.9995170661306214 -0.024373760646376613;-0.67601097396951171 -1.6428028269848551 1.8987937458612387 -1.7795527788161039 -0.6082522022908381 0.1241181652913534;-1.4701532048649635 2.0388664114027577 -0.1695755047302451 -1.6658399616226827 0.31097596635304792 0.27007353640772169;1.0652714261902068 0.49144855690735484 0.93864805147595054 1.9298307801065149 -0.074676694647772907 -3.9677706563033972;-6.3594955968058997 -0.071691376082910957 -0.83548974551584887 1.4821236664905275 1.8968689997326917 0.54982612112210005;-0.4278469610372746 0.21274761169322434 -0.6502619158035724 -0.10242949252859171 -0.90636962228123907 1.0085563406131586;0.76373608033061646 1.0423997934263427 1.737818716003386 -0.58743634760851038 -0.40794454103028183 -0.85573385631368082;1.1738171157957498 0.61090241485075869 0.21524054518866367 2.1110617575834918 0.80196406614760762 -1.0807785816217159;2.1458913826134283 1.930505086691813 0.35039176491770158 -0.2359764325905036 -0.71910823413745917 0.17335101153418153;0.82648034619884014 0.061604159361715573 -0.53428579430308909 1.3242027439836763 1.8012029977580675 -0.017009531660389689;-0.062015213939353664 -2.9611729334849741 0.074041532726108569 -0.93811867602711174 2.0806467133084294 -0.49314833913328993;1.3811590243158083 -0.31054887368864459 -1.2450011911048597 -0.01025566207319667 1.0133272512432832 0.13818187243123828];

% Layer 2
b2 = [-2.3793232077171385;0.060441711501790216;0.6135004882186873;1.7582807192912642;-0.055525855577342881;0.011012403383360167;-0.1765265884769269;-0.42623398738404999;-1.1323618822571475;0.63691890112531924;0.71563391415294575;1.3673744064358437;0.95962192128509793;1.5895582021759025];
LW2_1 = [0.54814874456188067 -0.047776815919455762 0.38716407128511909 1.0627896452509349 -0.24109477564717915 0.78432376193980347 -0.86150898726279024 -0.36808635921911742 0.55171564945492502 -1.2136981001969831 0.91061272364556622 -0.042885835860314046 -0.58366634777647763 0.17210566455151555;-0.81994582979321773 -1.2141000916006806 -0.035759636683740076 -0.033646559996268657 0.047040555966887741 1.2272185091567904 -0.68161231806033418 -0.18364325918327021 -0.2276046896317161 -1.2720240680494395 0.26255668732803544 0.24542287649260858 -0.36883823860960779 1.3209732618642052;-0.63512716586694395 -0.23477418486768059 0.090215719128947519 -0.61223993068820881 -0.69736285596795533 0.0045916204290822864 -0.40972378587908964 -0.69749450886445241 -1.0657487673998509 -0.94465325232251374 0.77298962017332717 -0.90010709659856358 0.2774978739849453 0.19597704577144801;-0.51193484657376653 -0.56244595579941381 0.81709553340574015 0.51836159958788175 -0.57405472904276411 0.28014018019620918 1.5376095727321908 0.81210389028822483 -0.050716283376254251 0.16415675724030782 0.00075915994179659094 -1.1415950284674969 0.2727562460714234 0.8835989085623337;0.52336068281590686 0.61191930347274115 0.29834030651627697 0.21806842824028577 0.30916477911659435 0.51590973190932099 0.21590894676137007 1.0943240105941887 1.0586857338681308 -0.53169932921592755 -0.8693155587735093 0.70678105687610915 -0.44617113824245336 -0.66518663866811223;1.8175817034703003 1.1341927318831095 0.53995092992295024 0.82541102358999974 0.41788438073678669 0.60319801457571609 -1.3703529367955196 1.1359903915071388 0.42631581731220519 -1.2343748788190361 -0.7879215212339632 1.053897578713658 -0.82929950602169356 -1.2353948981020766;-1.2612043079115309 0.049282361691782683 -0.36477088141802638 0.83497188040979753 -0.10211808176977892 -0.44775329579326989 0.078185769911495298 0.33744444396585643 1.0722295443193053 0.30746517104145865 -1.2220468758651311 -0.16643590113841925 0.70141240198695465 -0.020014990366601749;-1.6416708797507777 0.040095540721381037 -0.57264739057521574 -0.081918078437353797 0.4209627238861775 2.7146775947357344 -1.8667979249943052 0.57950875478264663 0.85997965592320813 -1.5371460693215497 -0.18318469392908487 -0.18498534906965097 0.939391133809243 -0.99995328367453984;-1.1264778238040885 1.2052215602509495 0.59282071030430217 -0.34304505596861212 0.20456609151712002 -1.5968147677442055 -0.34275111127836089 -1.5610648517775243 0.06396911633092689 1.8951337105745785 0.10991858185846617 -0.24293514194523805 -0.1346283657551566 -1.4317713818765248;1.9226630264246025 0.15900112896852511 -0.10644791178166196 -0.82178189161747617 -0.29255340948928499 0.78192189461843453 1.5843568406774702 1.1223622629337155 0.060511363884203209 -0.93793748172387481 0.084883416085361027 0.28708064619074319 0.29012501276501484 -0.35532438133086708;1.4857369797913931 0.043621455687524777 0.48027894264942028 0.55860572971676681 -0.78318072965303653 0.56231849509860499 1.4946102001702359 0.97923161726321417 0.4718043664555624 -0.86097607895697981 0.40232876104549276 -0.1407599935513692 -0.17639119353817884 -0.38737939887906625;0.4339578050595122 -0.00071304704333448538 -0.88305337906880954 -0.46350743795949639 -0.6137059614597129 -0.64569015896884152 0.51218913136913746 -1.141595366074879 -0.83174110600797602 0.80313128507498588 0.28019431772017228 0.19877945482093579 0.56583922512087503 0.77173136855524438;0.95558117955737121 0.073386646196860236 0.33318589697129841 0.79030382470011851 -0.16400553449564184 -0.17854938674312346 -0.76135969142902837 0.51836926730597077 0.018282814780689029 0.52478129994556055 -0.47461311608118312 0.34846924801030427 -0.85718279561538357 -0.36637208801642701;0.34695025573190563 -0.14712196578513448 0.3842099488937466 0.66945691287945241 -0.45008344440869957 -0.16348223590226871 -0.81859173973692356 0.55365908551944953 0.27517862234704865 0.46068504381374265 -0.67575193778483789 0.24506436508758811 -1.0063834678651657 0.36517167923237781];

% Layer 3
b3 = 1.1643256329297182;
LW3_2 = [-0.71295521976389475 -0.6029270460922066 -0.89765462628562576 -0.56231735002106364 -1.2614301247483795 0.49911597070139746 -0.5782981969485117 0.15895900041763053 1.4265618589080615 -0.8744795322867368 1.3236966601142681 -1.1274309825629696 -1.7103227734427355 1.5364122634862727];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
