function [Y,Xf,Af] = SOXAguilas8(X,~,~)
%SOXAGUILAS8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:18.
% 
% [Y] = SOXAguilas8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.3983157874229049;-1.446931903069121;0.77905037268785804;-2.631940455366931;0.18852290310588543;-1.4318473073611406;-1.3657148376632218;-0.83795274708985712;3.1659328442982066;4.4074148878942401;-4.9831529143602884;-2.2399634106278237];
IW1_1 = [1.4656831462431426 -0.69340928533224444 -0.047633703354728572 -0.44538125808085782 0.077583884672774522 -1.1477723755804534 -0.1926148625132002 -1.2495176337679288 -0.29561019482529954 -0.062077785901211192 -0.39673588840911406 -0.44778099271043359 0.45650038185701641;-0.5545014514871015 0.53655198163632145 0.99643378370657154 -1.760155300837642 0.4692910915255718 -0.37456113598177782 0.6269033876902026 1.1335370083608298 1.5098890086504966 0.18888603577565607 0.15175464402434871 0.020581569808095918 0.75142116786566149;-2.8131149323372084 0.50739774270075599 1.0039631778196936 -0.34034370537783798 -0.21282979856678685 0.6927995717688531 0.31403967145894451 0.85902028087033078 0.49054213573070948 -0.022542883478909023 0.26753558158305807 -2.7466794967983681 0.89109704188312666;2.0134148916720518 2.6721086674944345 1.2982728236704641 -1.9177654625828013 0.95722823222885545 -1.5314872614385078 -1.564356672860884 0.033539784520899063 -0.17604831210127919 0.58377516861944934 0.45430799675818589 -2.134695244687673 1.5309038645699338;0.11904555227302589 1.2507478129094964 0.011422148760466155 0.041677945475499252 -0.37244922735861291 -0.043551133339376658 0.17967084592313501 -1.1909420066734795 0.25231446956399073 -0.0096170196819316441 0.11846430807593228 -0.42727793291681598 0.29692800455370932;-1.053596653016293 1.0429257312350015 0.72311616087864528 -3.6551331363041455 0.64152338411464693 0.83575764747442072 0.72813270695824406 1.6053858879635048 2.0051605910354509 -0.32843019881127289 -0.18973609096527394 0.52057673439101171 0.81473376565929168;0.54011968462372228 1.1071891911378642 -2.8684402887246874 0.19031050186268145 -0.20024405586828192 -0.54654024730153783 -2.4138829130813817 -2.9213836567701033 -2.2873960631582295 0.24609242420939798 0.88111927689447922 -1.1090515128487113 -1.2689968141532948;0.5216847937705652 -2.4806208312798841 0.12631378494591411 -0.39541333335206419 0.6390817485407374 -0.30485727305465588 -0.63615685781322473 -1.9442525065224507 -0.39747172558210409 -0.0078259283838826334 -0.2875519636760609 1.2169847931772195 -0.3540553700478517;-4.3302039828746137 0.15025649295586857 -0.34527777921133862 2.2628372510640244 -0.20818945123847035 -2.4600703204536316 0.55692220069549359 -3.5543356957981671 0.65437459488430672 -0.13844408265104707 0.23770118961380099 5.5384634857738657 -2.644611604919147;-4.1335278263799422 1.7185218008069654 0.75972732520739739 0.53896519809675791 -1.3936377034591323 -0.63705304479916902 0.16064039433305774 -0.12422589083545402 3.7789188214805405 0.61820872934989102 0.92017876141107047 1.4278367254316637 -1.9849491685666352;-0.045776902430140438 -0.084140793907551567 -0.068149681964621456 0.069760219984288691 0.0010406903906257498 0.11597368440340486 -0.001578610251437801 -4.4029813904517372 -0.046108757492128345 0.0038971370349178296 -0.0088390033602050427 0.068376597787907459 -0.078212596333908549;-0.26095831734997094 -0.17882385433935197 0.51326483704876735 -0.36661360116219133 0.026578975179458484 -1.1110218574886106 0.13657795816676888 0.95556591356416942 0.21431258866248554 -0.078032794673754305 -0.17702766181089935 -0.67735228588216234 -0.058225853770669203];

% Layer 2
b2 = [1.8044514697293819;-0.5333248628886984;3.310835977706625;-3.4972573521755068;-2.6342444584166205;-1.0731479496120313;1.1866634576468731;-0.46795590085679883;2.025022866913833;-1.2368107949948928;-2.3518571904782939;1.8713657778218422];
LW2_1 = [0.036904108585522566 0.44163715506934159 -0.61589259008195607 0.040071657842641897 0.63667573515960318 -0.62122359590436671 -0.1369365003125172 -0.80337963006092905 1.0950290382592156 0.47098831589130596 -0.15552937997004135 -0.025554006142297012;0.61556311653488316 -1.4148326324551344 -0.20343000982314111 0.40357289446808642 -1.3366379579531897 0.98004536411494203 1.0198912760443564 -0.11709723906528068 -0.42720453633464356 0.63434008364940186 -1.8376055170909962 1.3710593906187303;-1.2361946785773474 -1.3078817434880547 2.8580823163470925 3.5409765000084841 -0.15655406903881208 0.039150677600653619 1.8628189137396927 6.536566294773829 -1.2213738393902192 2.1493892623534303 -2.0446240047472202 0.19038867623578754;2.1095057795269949 -0.26932486721283233 -1.1795381579862476 -0.80494294191641347 -0.97709894603083725 -0.072097855874731206 -0.79956184747835635 0.97125737991665007 1.1824460621026514 1.1521000392451786 -1.0851681783770211 1.7530675937793097;0.63403646267997793 -0.069910783915357683 -0.44867519600910571 -1.8758351543357834 -1.4412113754171225 -0.12406122001685442 0.44601840042837398 0.40234515948232669 -0.15135516466465573 0.67531991553285398 -2.6387690531528123 2.3021837540644245;1.1549117812433944 0.97125068655164726 0.17731006625459667 0.027232306866830827 -1.487879364117346 -0.29069468488631417 -2.3245971464692059 0.71415203954690365 -1.9471507981226004 -0.87143826629462584 -0.48678266584982177 1.5284843198514388;0.76162651149759675 -1.0704785117494831 -0.14735128512024953 0.48857571963776358 -0.40122330971889042 1.054330928203981 0.88216667855383302 -0.11064257263463431 -0.19633794715827924 0.46283918302279331 1.4588570184234579 1.3934907859772312;1.928821564919698 -1.6097460704223321 -1.611034328714247 -0.18905545092776663 -1.002349268140764 2.3011661799696381 -0.69354444082460032 -0.2481709439861729 0.7592698757283316 1.0806085723916261 -1.2306722065021949 2.1859903095541267;0.45274511557784747 -0.81264434711102451 0.31453242526119551 -0.82064591607118453 -1.9836714141437419 -0.42996962505498187 -0.087653961199711888 -0.095800215659748042 -1.3181928084219965 0.73295805188618779 -0.35053515430780557 -0.69183512047776718;0.4621658760539189 0.89036143595266193 -0.6577425999378449 -1.3466829713038362 -0.16511552972647989 0.53553739778205134 -0.06754216215697853 0.055687889561921181 -0.36286728902548893 0.50209836956257203 -1.7506546669294623 1.676926326933821;0.17963837135424196 -1.0364201259332182 -0.23236946406679632 0.43622022998752508 0.16926140965472336 0.81471780842387931 1.1466919637363808 -0.035735723910756481 -0.34519761344687283 0.36554544515976201 -2.2469867155622749 1.5084571672484464;-0.72050340335963337 0.24729428048173618 0.11180276368971907 0.12411391987571921 1.9173679865437003 -1.8048652507837861 -0.67281449602822163 -4.1185291405388451 0.94370414580123374 -0.81884776114117674 0.91918122861354945 -1.1564143245943708];

% Layer 3
b3 = -0.54338041084138655;
LW3_2 = [-0.29644518969264938 2.0340902583701328 -1.6456479193429772 3.0112867044379379 -0.95692765651483769 -1.4364308243116959 -0.65664250692476589 -3.5372873868404144 -0.28825706193548789 2.3232749871013549 -1.852345267617959 0.6919862319094956];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
