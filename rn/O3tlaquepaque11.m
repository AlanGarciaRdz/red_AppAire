function [Y,Xf,Af] = O3tlaquepaque11(X,~,~)
%O3TLAQUEPAQUE11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:52.
% 
% [Y] = O3tlaquepaque11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.171659085057077;3.03490136570561;14.7058823529412;15.3846153846154;10.752688172043;10.4712041884817;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-3.3083445907975428;-3.2280411485502514;0.95176472029692682;4.4740383730862208;0.43545069165998124;-1.1808348528048367;-0.34701451125842075;3.859167072683177;1.9803933203496509;1.1838513140837368;-1.0730827793763908;-1.1929658795326898;-0.17199690089946312;-2.2079836356023828;-4.8768343591251444];
  IW1_1 = [-0.49930874924582852 -0.041894097749464052 -3.1054700659165357 0.22620095576380134 -0.28801837318482582 0.49604135760734724 -0.9587198283831363 -0.50581878315152706 -0.25267530490416457 0.51415666439796381 0.084032257699449317 0.95014869559497883 1.3314205892319315;2.2232452935898892 -0.98957558507679244 -1.0586357642307314 -2.8826453247577941 -1.0094848463662041 0.60978834244021507 -0.64776310698292383 -0.58631761159370477 0.039761494718344365 -0.54956645545905702 1.3193401144450625 0.011148393690838724 1.7979084549645477;-0.70259443984601744 4.1305892820494963 0.020508116933151872 -0.67542599410171356 -1.1480390922576285 0.090367788529953377 0.58071560923888099 -0.61489421661089083 0.21223176849409697 -0.90904233334054674 -0.354515720868193 0.064038417692537861 1.6022776044832092;-0.13104134149211244 0.28536612648535309 1.0126930159322081 2.6450608949713028 -0.29956339113001929 -0.10367233948853119 0.16402319815771738 -0.10218056273015325 -0.2765443564561702 0.24180263973325405 -0.20310631999482751 -0.67565577598947901 -0.16994367145937017;-0.68673930249374671 -1.3187647533163847 -0.34989180683992721 0.44607094265809433 0.41516666111306522 -0.12898302179469542 -0.88633243927638272 -0.68628451956100656 0.23341971975177284 0.058186762011399717 0.39065311201278768 -0.091353125989362252 0.86205284298092943;-0.44039891521626118 -1.988155307425453 1.3965263109504344 -0.87353562981300092 0.29965584900241393 -0.89009053992993592 1.0758274100508334 -0.16801301978873701 -2.9831994527152736 1.5190732888148439 0.3583021936181342 -0.021868999838163875 -0.81785692932285059;-0.45220265634609219 0.21630386056422002 -0.97013174061017104 2.7750444900485416 0.81525135912708502 -1.2230157590027204 -0.14367822840225986 -1.7476839349330477 0.08338720947280874 1.9117275039735033 -0.1653311639902153 -0.020331258399732668 -0.86847632358642335;1.8750080037350334 0.56407509899505315 0.80128449426599235 -0.52097414136786724 -0.1097873538372417 0.48986992712879596 0.74922825811067051 0.41934065937951215 -1.5134623230138509 0.77270344142810377 -2.7831841406024886 -0.27685454996322417 0.15770940768487066;3.6165942532607303 0.44776279088303417 1.1154726140173041 0.10967302033498898 0.086970926715527141 -0.15718730856382485 0.34793815822816654 0.68352144527568337 0.17154775547407114 0.70280458096267984 0.037932762829777825 -0.0030990753805365638 -1.1097606527236477;2.4945555793231269 -0.54346237901193695 0.26075568474129435 -0.5223230588339598 -0.071817327683456944 0.013609126773656652 -0.0065167865542528468 0.28733039283385908 -0.20434992484818057 -0.75153522348914381 0.32186485249347119 0.046853456015707791 0.49744074075809136;0.37904146571824793 -2.8164083052708713 0.51844101922329444 -0.52168471389118654 0.68623639963269611 0.1179843241084402 -0.24745394366825868 0.949782103631993 -0.4918018522097839 0.81310529731445758 0.24517339003841482 0.044072119001872925 -1.2936734564732757;0.2096970376783944 2.5832162789249931 1.7931504818793906 -4.9497959954989845 0.39816210441592442 -0.30769315986674944 0.77531135811049268 1.6916558250406359 0.56586320993951822 0.87691461074908506 0.76277489121200293 -0.14381885003765188 -2.1144524616663669;0.80444919611208976 -0.66192986987371549 -0.27856269739699835 0.59690735776920922 0.15472204628491798 0.20106123684703675 -0.21069976386964845 -1.660533713458731 1.1023321427192641 -1.1493494924859415 -1.5501499499400964 0.32373289833813773 0.78155600467401054;-1.7450653978926582 -0.22760651194478579 -0.36399809597773225 0.1973099321033682 -0.10185673018886528 -0.049133700277079279 -0.17733415547634143 -0.52309633121458132 0.11494132833929152 -0.023136706020453566 -0.38895164712998204 -0.0020058593809663934 -0.11392946116004074;-0.30023476996915477 1.5551031546148533 -5.9961235812342171 1.2264028982163946 1.9407104166220737 -0.32728691527865489 -1.8848049845941768 -0.014819690731297804 0.86591902165423584 2.3166707211758726 -0.37221356079179857 -0.32092335036663866 0.76534775420914347];
  
  % Layer 2
  b2 = [-3.1000394005337064;-1.0750968446945466;-0.76314444372113022;0.43427977829899139;-0.26506733681599653;-1.4730062485039257;-1.0394402364552537;-2.002307935532289;-2.4255239262540242;1.0664432596724447;3.3176063584599325;2.7608248002016027;1.0892420493964059;4.6433368529957955;-2.6522893523628586];
  LW2_1 = [0.33190496202886027 0.15401351296713364 -0.96923798780538462 -0.043888737420040111 0.81538584070570741 -0.002052199541957055 -0.52700547007558418 -0.062893888504188783 -1.4051105237511226 -2.1108233307974653 -1.1494740318937475 -0.24915889068963118 -0.0068538705630824398 -1.5784881501576777 -1.0284816896679034;-0.13791720529583684 -0.28750349015623439 5.7896702137407576 -0.12948733047758121 -0.71436557333375317 -0.33841699263149877 0.02184585042635272 0.059900536202950917 -1.5514251819614777 -0.12971956246673683 5.4371682775582331 0.18887276208161471 0.58936421892684243 -0.74953202597157831 1.2259914623602854;-0.43610877140471471 -0.48372348189678022 -0.15690466357189681 -0.33544177183997659 -0.19587114388904561 0.16895126817531314 0.23816385643773688 0.55643292695200031 -1.2867928177984798 1.2494561131733888 -0.79434941710541684 0.35591044125818799 -0.76608697038192775 1.5844214012686886 0.5616082763720307;0.04067713901839877 0.36424662121597534 0.711038355320601 0.61178092897634573 -0.54486403061858635 -0.16320664165225324 0.67581024506743392 -0.026078588378021583 1.0321418417130206 1.4406816203776163 1.9112691805398485 -0.23595473746939291 0.85984752822391375 0.46050082490168542 0.77744155145368166;0.64320566772243182 0.38049010783879567 0.11327378842765141 1.0478069818455784 0.40710010124758278 -0.29437040133591275 -0.27622693525593722 -0.14616090874230586 1.1332599962124734 -1.3654203810477377 0.80900486768790536 -0.58376230987744715 0.58540006278124201 -1.629073268574633 -0.54909589321676433;0.1654709639515981 -0.37731824279790527 -1.0614832563601404 -0.44341073017639632 0.74100994925931174 0.2230699631452748 -0.89130533443812054 -0.20014596134202242 -1.3726135943588615 -2.0490517487061193 -2.7746456469669525 0.44118256613251633 -1.1270994646717212 -1.3752101003224271 -1.4710607636993713;-1.7155972233830603 0.20770998552897299 -3.81850848373012 1.5001322678043034 3.744412545907704 -0.99706398076171765 -2.1952054018874394 -3.5248061415271548 2.8845174771559825 -0.66360280597929999 -2.14537531297744 2.3013251274577602 0.033012761400648405 0.20668907493882266 -0.26711963657582161;0.61421196285421031 -0.17030263823026098 -2.974122771663156 -0.30995340215464506 0.45751445290405457 -0.17468310672567677 -0.84331420267618684 0.92159428104715513 -1.1482774628744052 0.074570553993535585 -2.7898383419478527 0.63998608830820147 -0.57946921340619384 0.50575622719937074 0.21103384252390933;-0.82328799112923101 2.1594464051372571 3.8405951644201104 -2.6301632597044091 0.67187973427686798 -0.7327612082975774 -0.24114058443478101 0.97600290033528425 -2.9329187708106459 -2.4606763069909809 4.086530682046968 0.43476075689460053 -0.79989920851245544 -0.016172802163219813 -1.661659307567519;-0.097271379137844782 0.34974991325492799 0.18586833525259891 -0.31653574361838366 0.4601692698525704 -0.18899821406611828 0.2630294869762097 -0.21646393310140433 1.0944339569119039 0.8179555782068928 0.80968055636208036 0.020498291821734252 -0.46371951403541556 0.82073478752728868 -0.90771186086972111;1.8859886313354701 -0.37223859922717462 1.7533561707367447 0.14924745090058347 0.83809854212729307 0.55614136606715214 0.86715323779666886 -2.207117258372282 0.060059600733853802 2.6072715753588884 1.5959865798725121 0.2380256583468669 0.60122292050666493 2.1415865154737648 -1.6822882242453541;0.92103533344604427 1.3461842709197389 -2.2358391787612479 2.1637497823098033 -0.26842625378415358 -1.7683983493164457 1.2264872489241343 0.12065938687917438 -1.080010020853992 0.345494136715851 0.11712519059335058 -1.1778981455854136 -0.15014964994550928 -0.46887721872346777 0.77411508618544456;-0.66205195429721897 0.76862606303219272 -0.37703152690164998 -1.3774133370715671 -2.3314960681815178 -0.06418096712369914 -1.0207907309657662 -0.64349009468606855 -1.9028552051584045 -2.5126386269654475 -1.0434413371475446 -2.5238591498197582 -0.7348086403301749 -2.7918416997956625 1.8445644792874221;3.2632930776089264 1.8987412136490571 -3.219002900013749 3.9315148821970003 -1.8395955562876685 0.78232795175091541 2.1136282945590898 0.60942739480428898 0.34327901422325213 -3.4079932805958228 -1.9107809147191208 1.4819182599717922 0.4303599972813732 -1.5116886571078272 -2.0001384033361802;0.036588077456396029 0.49107368494027526 1.2415377519560435 0.079793749538257741 0.73596560482687234 -0.46343660492674049 0.73461190727749281 -0.035660075005498754 -0.35613688138235194 0.37465378325095261 2.6514401809615431 -0.28974795570185469 -1.0683882252323795 2.833328756015046 -1.5691165212516807];
  
  % Layer 3
  b3 = 2.6265154229413099;
  LW3_2 = [0.98916510319547035 1.4186615393699491 1.9548539657361199 -1.3495934889643038 1.9252309781835306 -0.76201022515567152 -0.098203001712188015 -0.52797771186500286 -0.37498634579546203 1.7510197042109852 -0.13942033295204911 -0.16369042903658651 -0.27538998471766751 -4.0554795756927584 -0.96616244030046261];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
