function [Y,Xf,Af] = NOXLasPintas3(X,~,~)
%NOXLASPINTAS3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:46.
% 
% [Y] = NOXLasPintas3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.96825396825397;18.6915887850467;0.0175284837861525;0.0546448087431694;0.00640204865556978;0.138888888888889];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.597959348327131;2.3755756492063349;3.5134084009872315;1.5480817917222083;0.41723685004053318;0.5399836502763764;0.78155790925563629;-0.83603142123763596;1.7981450559936503;-0.79927289989050487;-0.091879665736796484;1.1992157866291193;0.98133148398233849;1.8273594782187672;-1.8967495450161067];
IW1_1 = [-0.43277372373915712 -2.6547476069849876 0.022867703386960224 0.52354163619641059 0.59735905499535469 -0.38342695819651573 -0.36573105884672508 0.52610830675937736;-2.3268188310463067 -0.17556551620717437 0.67715450032023838 -0.78836317787400045 -0.81070274370534179 0.57125051212121092 1.4211557271972777 -1.1619462622716212;0.055868652409724745 5.5331350079680961 0.10878966623669796 0.90360759096446952 -0.094065926956363205 0.043261801312904441 0.23215705489340671 -0.30451040298417298;-1.1355990020836935 0.92923119553972544 -0.25954630026457848 0.39050036249615477 1.4215363776572234 0.057102915902649251 -0.12539607762912341 -0.0018473009474273862;-0.012317094395845427 -0.069764305612589922 0.14756641538840395 -0.73129302111039796 -0.71521826672868771 -1.741295392709086 -0.26937083302294723 0.46130963331001418;0.31733413846437186 0.51661754491332512 -0.67080169339462747 0.57788659375742935 0.92878705458677269 1.3765158757202949 -0.18623810076793276 -0.29648075218214925;-1.8306784189175027 -0.80651431967356124 0.81379477585009274 0.44022294338154339 0.89531600223794594 -0.99987622594506176 0.49608228215638173 -0.32369022178883516;-0.25062656070160189 0.23130674390856448 1.0851999982444693 0.041092320163820806 -0.1015528042905994 -0.091435561127428705 0.71957415923657808 -2.0875822901150487;-2.1489135678918241 -0.93128327213893736 -1.1614910635961375 -0.92666334624112978 0.84038105612167457 -0.80910255517681162 0.69526419913503734 0.058000947141890524;-1.5592086287021598 1.0192996660532172 0.41421297017202091 0.22847938664697984 -2.074510234286135 -2.8041273508490527 -0.98872372781547024 0.3892207961219068;-1.3224706338767769 -0.49814020552802113 2.434454469952001 -0.97142793450726816 -0.17864826898576877 1.5151954667485312 -1.3481680115916232 0.52940780300882051;0.43012019465386492 -0.73931708687401676 0.23098366849571456 0.20405731572043448 0.72433377202612836 -0.13470003210057813 -0.50426096451979752 0.23604330868222881;0.62066793894024541 1.5015218800260437 -1.2163707905736489 -0.60060803724796075 1.4643880220462513 1.3899430755256224 0.43831678564835086 1.1632397619504109;-0.15678227424193877 -0.78686447838345897 -1.343264341478752 0.083453722865852231 1.8801718331976933 1.4003594450572276 -1.6407092284820262 -0.027699469124048436;1.2387687987879701 -0.52184179525075625 0.31068120401257443 1.3189996536133946 1.6720477351835736 -0.7799365648535822 0.59150781921501661 0.086155632547487537];

% Layer 2
b2 = [-2.48667164288773;-1.4672117926997323;0.98883055487722349;-0.99197094375699835;0.10102233740611048;-0.47595857575985601;-0.9922111914752213;-0.44810787586150402;0.19343533529733981;-0.63593339608001009;-1.1509420851536152;-1.5171894935472963;-1.5174384371777063;1.8886107069669178;2.876662985515412];
LW2_1 = [-0.45914941929394654 0.80116929473845067 0.83489248068328514 0.54067493305086678 -0.69106533493460531 -0.22999783405571106 0.052751870243701419 0.073255070042743869 -0.76373585984779724 0.076458159357315855 -0.00064477489408142075 2.1142083430390124 0.60944371562868827 1.3607441628868542 -0.17430384148966055;-0.17279624169089622 0.073458354073865903 1.0617667823498738 -0.20822528659696107 0.21222255675974921 0.02143532436640504 -0.46246789875089861 0.20216129449631048 1.7225334096010863 1.2193672394865953 -0.37913611149251059 0.67174319155289375 0.85329257924820623 1.3509014293871811 0.8458675020659373;0.50607519918934618 -0.42539730896770811 0.2233667383237255 0.37751147796750495 -0.74449606100179744 0.28636982699059871 0.079761819090464689 -1.5011776082199737 1.3766786288800701 0.29374774440981843 0.21496315943653158 0.23045576653246772 0.62832883051400523 0.90606562695239734 0.73223672152190244;-0.37575392430625537 0.29309420484418791 0.20469858054800422 -0.14020733365788798 0.43843596796187695 1.7851557730394716 -0.44694938380042742 0.60756530038149414 -0.50637159793402076 -0.30997153588016635 -0.0071712152528166104 -0.77219967174074144 -1.2586646355067403 -0.62425840260555288 -0.45666649461088404;-0.032196368865019261 -0.28595912263131457 0.95050818757470501 -0.48626355055866638 0.33225857441949602 -0.031865752301556721 0.47992819524565172 -0.87911737221086717 0.46347180164598928 0.24600701066072084 0.029492416332393655 0.65703493434951965 0.28613939173747116 -0.0053335700212897089 -0.03483415842874299;-0.92971039820395451 0.78057569519140402 1.3743212027225609 0.39861809551529676 -1.0602253386592855 -0.13791574708630761 0.44549817543764392 -0.38073899276181655 -1.0968902842233901 -0.99027937108617092 0.26236324586917337 0.74633582440423907 0.079664583289839608 0.46481060757613535 -0.85284346478269191;0.42884402174367131 0.078202501121702558 -0.84542313330941499 0.64855021128394541 -0.50329517455179895 -0.38867024904979153 -0.5385544353803875 0.78040172757523496 0.48613616842159246 -0.27601505337913673 -0.055202171554615084 -0.030277353341185594 -0.13855253833470732 -0.535341752547976 -0.023121334332864847;1.6131855005541034 -0.46914077708116714 -2.0546273139454492 -0.5893440171783535 -1.3053135956230468 1.1273107579560204 0.10657721842491343 0.28971439327754317 -1.3709265472958883 1.2991471038035123 0.70908028189710781 -2.1483309528949031 0.43236310017249191 0.15614581247037862 -0.16967465310886259;0.71078103314344965 0.2517402233423795 -0.31424797581789582 0.15253916330864331 0.35070379238987537 0.20763122160433065 0.15149148935471643 1.8749132344837598 -0.49084737699887659 1.1235855495608309 0.19470098047291143 1.062838860275078 -0.1372812031190519 -0.43275838996951194 -0.99544555292257775;-0.77758584558340416 0.31717624610330658 1.2971078628570056 0.46171444450384302 -0.2767934727886544 -0.50044770312715148 -0.29369426153289357 -0.37111961572769903 0.015495761623406865 0.54325734628227584 -0.31625205044912585 1.677885320140071 0.48056228620723213 0.070765791245366541 -0.006237237632807837;1.0973497363966671 0.20088038587603765 0.70700082202591541 -0.11015898277621838 -0.50098638634964154 0.40525243191495613 -0.24997743346410406 0.68520031333375042 0.89668307985798013 -0.84114395884376636 0.2941882072181331 -0.58047022868130049 -1.0821146330856679 -1.5538548249698174 -0.21573410376156099;-0.82563208941758059 0.51686006145025809 0.19759940535035753 -0.70855811216176634 -0.12669140262278283 0.86323658116755553 -0.24384627389965946 -0.16274269172864064 -0.029318083592173312 -0.28054933177951014 -0.15516394212133927 0.41253135214801639 0.93776710335698976 -1.381925003609074 -0.20503039440108373;0.18449079452106568 -0.18235099521761264 -0.94021954987208989 0.18948660908326906 -0.14044087055000404 -0.26832786097218875 -0.48457306332970262 0.24911606378491241 0.80200797695816217 0.53777278953718954 -0.15925470430604888 0.4847425721748288 0.38870760007732991 0.16513735174211014 0.7083891778517647;0.92760792724085317 -0.0027120730173323948 -1.0345209541794995 -0.049387168099974149 1.407571428524347 0.31490362433045743 -0.44247450715000564 -0.1038396292528572 0.7479585110841086 1.5153001324848951 -1.1381670252653777 -1.4723628906505595 0.40558051423642605 0.86950058269930008 -0.013821206392406554;-1.4412374440702977 -0.66289830204366373 -0.66956355090885611 -1.0191962625958584 -0.35000866796290386 0.38029879001375788 1.4774851892217253 0.094494151579416708 1.7381671965240628 1.5287814440446594 0.31257840204572462 1.6234189883043442 0.16926679410324652 1.269406002704309 -0.73597415241876341];

% Layer 3
b3 = 1.7119401436874226;
LW3_2 = [0.48728195384160694 1.1017808578944295 -0.51401144833181522 1.7088186887391694 2.0971817210834072 -0.49873309147333256 2.3622791317009599 0.79571642005673726 -0.12271963577262246 -1.250287039854183 -0.46701756237352177 -0.96217169856943519 -1.9970205000149313 -0.915131547280295 -1.558636541239492];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
