function [Y,Xf,Af] = COOblatos16(X,~,~)
%COOBLATOS16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:55.
% 
% [Y] = COOblatos16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [4.5872773972809133;0.97008116000266065;-2.8285905909456397;3.4056304132880286;-0.47325852563919912;-1.125998292894828;-3.248909348150399;-4.1605872490039006;-0.25411301926694546;2.3652919499240177;-1.4777330311400438;0.34403818109615053;-2.8286986906438205;-1.8050192001264418;-4.8257815587811708];
IW1_1 = [-0.69926623514442399 -2.5878524797391997 2.1691704772289024 -0.56407125039308792 0.30271668031014071 -2.3609468284182866 -0.47928375088852737 -3.8514584182430123 -0.083350422312495162 0.02903483531516261;0.15346819333497974 -0.57760935097691335 -0.2159113932309808 -0.7704686687281197 1.0683292281556422 0.078480700940672957 0.67446565077541132 2.5596935106807517 0.15300726276883209 -0.4620702778793298;0.63155570587072141 4.412231004944009 -0.24633569333913211 0.089583379867315682 0.31938527948723994 -0.43920194205577961 -0.071624684682975975 0.57302131432788328 -0.0097767973906968102 -0.23578969357059701;1.5670041651283306 -0.44317793862576349 1.6000833900269267 0.086296541075169667 -0.63179095982346145 2.9854194814626971 2.2999312313901616 2.2858373052377789 0.57299048084691184 -0.35405187274321204;-0.6103092367804398 1.2501811388849786 -1.5403733384698701 -0.58111539924320943 1.329851584512644 -0.11696238916879333 -0.32606357377489165 -0.93329115594197343 0.25425449669061928 -0.30873206939596343;1.0075712910521069 0.036764636109080498 1.8613649014505094 1.0718633021870081 -1.3834950831407644 0.048394609972925141 0.27905087993152733 2.6858545810636261 -0.16852771656033874 0.050876330867115627;0.14588561290867652 1.550301475399914 -0.14352095953963265 -1.9727172482255677 -0.17364140073361059 -1.6304908220884538 0.36170108381105542 0.53379470505884286 -1.2155779020010051 -0.22106754408129461;-5.0863268434868916 0.39681463013165313 -1.0283000084106442 -0.61484786394955826 -0.29496448282343407 1.5702494877145532 0.36874809465197023 1.0856633251664771 -0.30641099522199516 0.31498917916993208;-0.24758096631522458 2.2482574987461543 0.53813289733414316 0.2819107632616914 -1.3365533166897106 0.53482846542737461 0.077797966385667647 -0.34803449525923114 -0.31659142455912498 0.28365405971774454;-3.272518684377741 0.080325181409405463 0.19772081582532317 -0.47841827061982323 -0.74683314916350152 0.44901443466492708 0.12334035078338294 -0.51553189706992308 -0.5574241155191566 0.2793777266275117;0.56441820421936062 1.6515005021981348 -1.1851670462394015 1.8331486690493037 0.70155536728898682 -1.6674058615320031 -1.1628082323772324 -1.8627474874696754 0.32159698367173961 0.28711402012346177;0.32804834901467606 1.4383201435638935 0.43216732948675546 -0.93900126000210549 -0.27345434765502319 0.31355998488082443 0.962771520264325 -0.97549097940438922 -0.27089171534891726 -0.18533963315550822;-0.20174794784067951 1.720067939717016 0.20959112733717128 0.35997392321399968 -1.060337180954501 1.6536281228434138 -0.0560795082539534 3.2881915340429977 0.012446904735612736 -0.22852361232216806;-0.80421630842008707 -0.15981273389477435 -0.52355566704430201 0.64202701580137167 1.3591236108042237 2.0029841121915748 -0.54831670753957029 1.5450897503933723 -0.050586064448748386 0.96051455949411635;-2.4091157131903462 2.2744638066232974 -0.90371529856221677 -0.10945078658292604 0.34099866310339166 -0.98476197064894344 -0.45335922324200678 -0.3379982797085877 0.081903879866412038 -0.31804316353878642];

% Layer 2
b2 = [2.309554623008506;-2.1931569523865511;0.1436796108182003;-0.75660354714961287;-1.5732503598320136;-1.5678246520457706;-1.136465753236902;-0.23852854092489034;-0.73274623841335806;1.2946279654250439;1.771867621165611;-1.9783960253592479;1.9563576993852634;-5.6474452295418711;1.1936940886035501];
LW2_1 = [-1.4518175432555862 -0.74837149560880667 -0.10979691128382563 -0.90773535581787146 -0.77306618273728611 -1.9516368422682973 -1.1743055248348317 -0.56648973677993353 -1.5890236472267953 -1.097533651609323 -0.357699781814796 1.0209878511579045 0.052351489463059175 -1.0485843725826811 -0.083872265117572217;0.65423547685136296 0.48499896190921632 -0.32265682252992528 0.36799027673190576 0.56766586359492344 1.3821054540780042 0.18215069007682183 -0.84873119702255817 0.19480002436150357 0.45490604677434088 0.43814558491569594 0.32216855326115978 -0.034952521298156208 0.75906831090021498 -0.74120955104708985;0.81325110213056495 1.0260338688502046 2.0978390051617595 -0.27120976253793738 1.0530137154051482 0.93238715110627235 -0.75270464251589397 0.2420231071759823 0.57042192906376676 -0.032331400931449997 0.010764180519756673 -0.21006212207602237 -0.069103092860806237 1.2275527721348996 -1.3873034980253223;-0.65911442872040238 0.31007341158150159 -0.96007081645478798 0.10690228240371424 0.044499091933364023 -0.414727064214579 0.054776198815954857 0.64473000990576657 0.2233389015832698 0.15354769842537533 0.017697316401184392 -0.248683954875527 -0.61661051979555515 -0.4877627262269929 0.4067916503449639;-0.13491377730003928 -0.16248785851372613 -0.54220200759199999 0.52036670607416502 -0.40499164660509884 -1.1488274393836124 0.014236762074152119 -0.26907235552544873 0.10916451057213178 -0.018639697717962884 -0.34908691353387938 -0.68951220657748391 -0.36798202992132034 1.1061046522414133 -1.1348006129796322;-1.5540234940315061 0.95748624798048187 -1.395130364846819 -2.0702769784173256 0.34590860396502526 1.1246812024954356 1.9316903532329064 -0.92385622314831517 1.04791905959988 1.4986861539432539 0.10150610405988346 -1.2340860727157137 -0.68055598747931567 1.3728881560729309 0.84667089497643577;0.67757053233992592 -0.23711504485979382 -1.0907872296972905 0.43440813877748369 1.8688343996160222 0.90500751300024151 0.18532206919182825 -0.5874951910176226 1.8271913423418744 1.5982034285962921 -0.27724888173558421 -1.4375617994590464 -0.27796215935494251 0.15739983338314509 -1.1269051324142414;0.058345837727306019 -0.41871444335337005 1.0631625128481006 -0.025127862646657062 -0.26951734875372613 -0.47164386616363418 -0.016477123367036155 -0.49417477405667876 0.44992939175152563 -0.032437025559227478 -0.30360337393815046 -0.2542692390866475 0.15264807157647581 0.4080635568462046 0.11240006325444904;-3.2568425913517793 0.60259203419769258 -1.6600292899590332 -1.4566678095714038 -1.0864572345884673 0.52499427787464314 0.37136741548314389 0.74910682301924181 2.4279962537931539 -2.8470950368578425 0.87246012203664858 0.078077621409626111 -2.600491303741137 0.23809070132236293 1.4896115695482293;0.69582386750354552 -0.80749764313626426 -1.2843906692677789 -0.14053478096743258 -0.85478589830462426 -0.59062460489220314 -0.022488122244941868 0.092788728286603991 -0.96449282649888279 -1.1267671670906849 -0.40999843464480368 0.11122880564036917 1.2353187301213631 -0.58806608784959158 1.0940313800288868;-0.077358777795827227 -0.057618487179789596 1.7741431914285071 0.5310170012662162 -0.62402539100367571 -1.3897312270314657 0.078633161442928048 -0.47627500293538372 0.1605432398745501 -2.1987466210767233 0.25256325102833949 -0.083125715657336591 -0.053551222737865833 -0.11801572730844571 -1.9210700528745988;0.41095527996514181 -0.58614078585234919 -0.22381890257437581 -0.5124363608181185 0.12644022420261561 0.26403790929979287 -0.29645970544930367 -0.72419283880297469 -0.31204218999904393 1.6328516977801031 -0.50603238091978886 0.26849493327074037 0.61324312417559845 1.1090251830033122 0.38978777042442897;1.537922487268812 -0.70637725684991071 2.1293705669262457 -0.19529674606508732 -0.11307715453530309 1.0097191614203052 -0.24397843701098226 -0.94210314067222833 -2.4211585656993302 1.7131725042610251 -1.2358866075454125 -0.35632005961244551 -0.088864561327961653 -0.51084122089283979 -1.3683412043694443;0.8995405400674249 5.966694089601976 -2.3578474401205542 -2.2113813982338146 3.7794684747462126 3.2197103933764337 -0.72138983813177904 -1.2776187414121247 3.6020048324436273 -3.9263768780417747 -0.27637229794298024 -0.26123604007579898 -0.29635379971166526 2.7654959813478754 1.1707495464422046;0.4475033426384103 0.8038693437225628 -0.99230205845013986 -0.091440152452050893 0.34730791805958694 -1.3828293701602379 0.50134492892348237 -1.2800315064362915 1.3868375344997379 0.48299578184403386 0.60587565768549867 -0.78252745254890699 0.064686104931413621 1.4511659413678406 -0.32221581067532801];

% Layer 3
b3 = 2.3858143053399168;
LW3_2 = [-0.71982237496215373 -1.2255605136625474 -0.33977864419969178 -1.6693838404989263 0.60428251536747823 -0.16322654337286371 0.38783659621891114 -1.0750794787509959 -3.3802033403965805 -0.74206960382134979 -0.9760581733368302 -1.1614280317280792 -3.2396734073133997 3.7156891985629823 -1.0873020935847038];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
