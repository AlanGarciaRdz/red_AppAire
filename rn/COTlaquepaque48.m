function [Y,Xf,Af] = COTlaquepaque48(X,~,~)
%COTLAQUEPAQUE48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:18.
% 
% [Y] = COTlaquepaque48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;14.7058823529412;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.448430493273543];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.86161474921422432;4.2228196514430874;0.50884263984819256;-0.89735282923559501;1.852381119783447;-0.69284876730840061;-3.9964647501035153;-0.99606837303233731;5.0812870162141595;1.3424006771537615;-0.29098010254605072;-2.3715975850174122];
IW1_1 = [-0.012834165794106822 4.2829536765848681 0.25754383501545697 -0.025031901041849582 0.10416897486600964 0.36041066277528633 -0.21948165638798967 -0.022356892534201832 -0.012922273667323436 -0.10760078851098284;-7.4260446503820665 1.056660529284281 -1.3608662580707427 -2.4935761630958257 0.40008784529062091 3.18608128345533 0.253588472642296 -2.0997793422574422 -0.6580653697818053 -2.346853858063406;0.0025512229768199866 0.96586071398251794 0.21633372209153665 -0.17530548623941217 0.047280157461935653 -0.72346570688114298 0.64556832694994337 0.10200954955893723 0.035557140032190841 0.51392770001003119;-0.69199226400202984 -0.23981531363378683 0.61192954562493718 -0.5677310666712716 -0.22962883677303719 -0.91838784614491886 0.81451678445906472 -0.33274821921399339 0.046661391916425023 -0.49130372159142116;1.8513610810768886 -0.27085727450672892 0.32382277124694969 0.061358635798677071 0.29233282934307037 1.5929839902713012 0.54333987545395757 -0.12283816736657763 0.14805320556478069 0.34210316689278808;0.28911299274027852 -3.3386907052842387 -0.20708596350063929 0.011478719434225012 -0.02180490055547998 -0.090509445677106823 0.31842379991566538 0.032811530242956077 0.033603711091463401 0.20283411763324488;-4.4114189719185806 -1.5762650579086988 -1.3737538636374964 1.4316519925469902 -2.1356774579817577 1.2159187503690367 2.0937606162025424 -0.64257137699848776 1.8425255365871245 2.5353001949450658;0.35035781150131612 0.024672041265646087 -0.046895400242536522 0.12808041786061511 0.010425196162546283 0.15700355833699473 -0.13753102183071877 0.099485729522610686 0.010065751200925118 -0.87602699200238732;-0.77188045111685932 0.21043741684177414 -0.53836450332624186 -0.97005714241058216 -5.7060597595356963 -0.32272899284099488 2.0376511382244389 0.098588847335407986 1.2509145022216872 -0.40026104399809764;5.1310984813944751 2.776544589819923 1.0931083974533216 -0.31973985370702707 1.0233839537196587 -4.8904356619837479 -2.2284629663504489 0.58644409338025638 0.29867483708744719 -0.34279711410167851;-4.375746859467343 0.33614252978043846 -0.38333778311005701 0.816485879894983 0.65451519554992921 1.9161808352021386 -0.92080653969128878 0.1893614093550387 -0.22088201930452123 0.82586880054398137;-0.56428693530122731 -0.41000410112315522 1.4157986382195882 -0.68365136255207415 -1.5078108251278983 -3.7181768232441237 -0.25593749407615318 -0.456701525594154 -0.068606550863664587 0.030045090178200749];

% Layer 2
b2 = [0.88470994477149389;1.420469619150442;-1.5450395955879397;-4.1838578279534095;1.043455653296762;-0.46084654066510061;-0.15371911550646225;0.0043898755507620901;-0.94819315482143607;-3.0769690837786952;0.86111571169825263;-6.7377038479584215];
LW2_1 = [1.7059179307397723 -0.2529355054784872 0.58356069146189193 0.83479083633376228 -2.3420696471799363 1.6881561255425523 -1.9381840034823061 0.72123566357226765 -0.95887531545775806 0.072391789009783825 -2.2957403045783087 0.026951805597497932;-1.8042881801840576 -0.27768920344149334 -0.68545371180813264 0.8181356802744858 1.6730537405433337 -4.0480642204249895 1.4510484561554409 0.16718013080341157 -0.37523359000832229 -0.18612413465619415 1.8030464172440368 -0.30015017246652459;0.17850469421102402 -0.13230902604643197 -0.36053799632312333 0.33716900822851792 0.93840667626010354 -1.4303877994852263 -0.72844327360521155 0.086111204532248992 -0.16586681534645398 -0.20846659754212338 0.39749977778004925 -0.18746417262987305;-3.090651586207855 0.20375295909439703 0.067408360023867422 -0.27731524045513767 3.0365869450534202 -6.8990584442712777 2.4377463853776637 0.84802913239054212 -0.41887393836617554 2.2595120744872101 -0.73036367725006335 -0.17498610939640985;2.6709144463749546 -0.039629247751518271 2.4424135327039016 1.5547853676926295 -0.5141617654641375 3.771144515176736 -2.6115447251863269 0.41970314135128295 0.28354656349186347 0.47552731694046779 -3.5801115458469202 -0.43911365996093071;-0.56844131519357854 -0.18514449530592789 -2.8957974194263567 -1.9089707729177026 -1.3911651442020609 -1.8867497645579072 1.2562843798638132 0.34840521489206183 -0.62957242695826432 -0.034726288199293825 1.5428012454987807 0.56115963547473191;-5.6338080460698858 0.25610159334298216 0.9558797447727172 -0.55487895951117194 1.3178576841871319 -5.4760269624817273 2.5572112463073 0.18139334807358121 0.082474274133786801 -0.44099230322274924 0.31633757290216769 -0.032348031651032123;-0.8761115080531412 -0.14144387525222271 0.57080522293721059 -0.095063977964566115 1.5328727981111554 -1.9068664253392262 0.22986665938712081 0.43078193431105921 0.078850798713453005 -0.065102611142816985 0.80741788744746934 -0.068041865899871254;1.0908961847234269 -0.17474964506915558 4.7844511389947044 -1.4911837166695399 0.94341916122138492 -0.0042872622528533771 -1.4020896469702324 4.4499628151284041 -1.4816813414510672 -2.4634624653103852 2.0329053525271683 3.5356952596510118;-2.1092787947985752 -0.18694645044568597 1.9918542536211734 -0.93057023480227219 -0.23939574131018665 -1.5824359791037033 1.9377518295901044 1.1152497195101199 -0.82114095375035567 3.5108769328127956 0.62665488622698462 1.4894283053662078;-1.3677231720715 -0.07660244878454589 0.78634886833355233 -0.27080479967911769 1.7504794728124355 -2.2874195089413685 1.0272948272811242 0.55981969451331715 0.1006984995048857 0.046920802887570945 1.196592857358173 -0.00032089946838861905;-1.5758995650434124 0.24195722005310888 -1.4511335969724692 3.2026641683212178 -1.5500820636841861 -2.316350751070972 -3.732360401202675 7.0020395674213765 1.8260145304370066 0.024595504203929371 0.17528925415426785 -1.1519100602051722];

% Layer 3
b3 = -2.1089340222580537;
LW3_2 = [-2.0657141145246496 1.1348889595569656 -2.8126929754332348 0.62995855739381079 3.7465694465346271 2.7366369252997291 1.6636660622127204 4.2533782650493732 -0.13967174820380726 0.98411106087294586 -3.7090058445123013 -4.3474665700588666];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
