function [Y,Xf,Af] = SOXSantaFe12(X,~,~)
%SOXSANTAFE12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:51.
% 
% [Y] = SOXSantaFe12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.1588352367565333;1.7128959357300424;1.0557907087239102;0.75029160289412633;1.4632241736622493;0.075948149366494605;-0.042015020701449024;-2.3800989007666473;-1.3307915324231732;-1.2521518799767883;1.8624288925167345];
IW1_1 = [-0.48250089692475551 1.5251138516963649 0.32333942265212595 -1.1634356872813287 2.1951233146129141 0.021126107541728792 -0.17230863137315769 -0.18614462118848096 -0.81962109487868162 -0.8607583368917161 0.97604729929969991 0.26229996708821723 0.49114989865460584 0.12714463519574529 -0.68889858564246109;-0.13050939782671603 -0.35199366096692147 -0.097820338500915524 -0.29973032147370099 -0.090180769776694022 -0.099965970327714357 0.29419724649529255 0.3502763379756571 0.030176893670045037 0.092353416464356741 0.57565883011909302 -0.34227633807019919 -0.55843714711384151 -0.20621775065207748 0.022591947672680832;-1.7291315376512197 -2.9646104947049698 -0.021191785073479529 1.2148604571326882 -0.51706308713428739 -0.1244530714645728 0.30943203531233676 0.090996348453860051 0.49097035329288813 -0.15090664941801843 -0.79007757847383142 2.2594599754212288 0.62828536900431398 -0.1736914375588279 -0.63181518108011203;-2.3001393107852546 -0.091375215948228283 -1.2757798542420806 0.24823112257243202 -0.40188263782723288 -0.65809343374763118 1.4933352240823932 0.51222675233184178 0.80943218395113625 1.1988513525677538 -0.73000730406081671 0.30548523441388503 -0.049046969014262323 -0.1101609778796673 0.45065101220469261;-0.88665931231662498 1.5419361536184506 0.6297835228130928 -1.1775034903161776 1.4124543423383165 -0.13194153335117709 -0.77601241627991957 0.1484867284380704 0.76410851525773416 -1.8459611025787201 0.64708710001033465 1.018967896738189 -0.30469006829772671 0.46891781584764608 -1.0218415626775001;0.45523376486244582 -0.3888250747398565 -0.027253428421610215 -0.43497641610738219 -0.38743395228870869 0.097506128356453517 0.73417788466833867 0.088925241980426423 -0.40298574452561864 -0.18287085544877502 -0.45753655969772788 1.4589827003151061 -0.92262330035396523 0.2256606522465136 -0.23144491310079651;4.0130248213708208 -0.38045245203267347 -0.58171880462604708 0.41324123974845328 0.64704914807556657 1.7178804214371743 1.7558387144604855 0.10297656277356013 -0.28648057717406383 -4.0222611063638425 0.0182480850187473 4.7494057059726673 -2.4510864873212097 -1.2653588187254246 2.5510996628118088;-0.26668268956904967 0.18129872455291152 0.036049025152164821 0.28605968486396355 0.17430540617524745 -0.089503109714817924 -0.15266955618348407 -0.028616997075409364 0.21349287060566202 -3.2174038921539818 0.09630521593137624 -0.48452611060038298 0.28060553965718293 -0.12176861488776695 1.2645052889987383;-0.8854019600030294 -0.028190072606503497 0.36902584997657523 0.80190842845160726 -0.119326766280904 -0.081859265722018917 0.68381792742679182 -1.4392742595894348 0.28657242005511369 0.62763342977859526 -0.79506396462053219 -0.23324300135085951 -0.52233725136062437 0.36968493533811475 0.08740823456991853;0.24684587302297822 -0.10386720089215296 0.21063373419454873 0.25809549570988799 -1.3322755947411653 0.02801432147571277 -1.1043165239212998 -0.75747068731526146 -1.1515613748105025 -0.22599406130594252 0.70010608135410779 -1.3068812943314383 0.07728233180673505 0.4380955956064464 -0.91479957490811481;-0.32855959949873376 -0.38404258009410475 0.12970008257734655 -0.64753603061988041 0.35747278822146472 0.34669736529813544 -0.11590403642684616 -0.52522040217091692 0.010395691013096588 0.11421402772244768 0.3612748706882673 -0.50879757782512525 -0.32321516513280513 -0.0036612396073176234 -0.46298554953139792];

% Layer 2
b2 = [-1.7771273927368638;-1.624623955630712;-0.7028010730034876;0.55729990649931427;-0.55898506457659847;0.35696776188754992;1.1098209729549822;-0.98814852537967979;1.051560647816729;1.9797243840871483;-1.2852819670460784];
LW2_1 = [0.59538094192012259 -0.15850612802933139 0.47293910160056563 -0.14341829387111785 0.20035778811718499 0.20513583769576565 -0.050491189838763856 1.6926720802146573 -0.56742540083560167 0.60539074400272508 0.92478173174228417;0.093324508529395431 0.36668945396165831 0.0032353669318075373 0.6857558625589083 -1.0408639631866641 -0.39781398421495229 0.6601653753515363 0.45365543713700152 0.99518770517777466 -0.12553357936754717 -0.014936168619645021;0.40395537345638094 0.41761210994044828 -0.074068561808517661 0.45570917873185141 0.33713693711364723 0.46692548446437238 -0.78604557261872154 -0.43646724529173919 0.66169272831749204 -1.0461110722948821 0.73959456625768782;-0.23677670883158358 0.25282246899716959 0.44293893571011606 -0.38087806944127123 0.5866937091427924 -0.73921938081204508 0.052882513028597047 -1.2041949156668268 0.75475649656356181 -0.42619366982326601 -0.11563064087758687;-0.14669214235731287 0.29667257518082835 -0.71268689066588309 0.18959293601086427 -1.0543165104104224 1.0947288869348064 0.0089762218840531947 0.43777542215444476 0.30562938338247259 -0.52783018346946853 -0.06106733988624731;0.87356465666167205 1.1570815075896141 0.97962988490625702 -0.014184421867203492 1.2108799213586885 -1.9933679607122994 0.71948073362068454 -0.72217124468482519 0.28544509895329284 0.82515743963790633 0.24305382106697759;1.8553479190042459 -0.2865501578296048 2.1510027475545348 0.50522436775082358 -0.037528297103773207 -0.16024529225379855 -3.3310182108602735 -0.49628000248386428 -0.95823544379844239 0.52490289149324576 0.10636466055433114;0.60951866875158178 -0.3193088197842664 0.6893289735432574 -0.18626821710848507 0.65372118278402169 -0.22467537221938483 -0.3933695868949949 0.31583109428132422 0.13305335243261232 0.095824470960555463 -0.0070749204409578936;1.0938232874828462 -0.2535100913683897 0.0036131728023026111 0.50706553417813505 1.0650600916969468 -0.48907457016521477 0.803841837091267 -0.48055712512630677 -1.0459437801066618 1.4618378758453587 -0.33685790274755112;0.50651163042791025 0.78074051422360125 -0.28419706187251403 -1.2072506443898774 1.5268729239316317 0.13307959333198915 -0.50669539117706197 0.26461889282062412 0.040313156514371999 -1.4474052754486002 1.3817212322649506;-1.7741011550669108 -0.10703118072058086 -2.153099537797448 0.98438477026312499 -0.035895394747751636 0.11026536300720721 3.4712231808906804 0.47838307472407837 0.11921984966364439 0.67822000198247157 -0.1844710389349708];

% Layer 3
b3 = -1.2499179285288295;
LW3_2 = [-0.60308257361495654 -0.48531840516734409 -0.26606730550381352 -0.35313293683154945 -0.9217549413167988 -1.5242715589936793 2.4300800361364439 0.56921559588237836 2.4201222928377426 -1.8018707831825047 2.3594746870175212];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
