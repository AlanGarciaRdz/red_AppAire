function [Y,Xf,Af] = NOXTlaquepaque20(X,~,~)
%NOXTLAQUEPAQUE20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:16:24.
% 
% [Y] = NOXTlaquepaque20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.03490136570561;19.6078431372549;0.0212539851222104;0.0523560209424084;0.00632111251580278;0.294117647058824];
x1_step1_ymin = -1;

% Layer 1
b1 = [4.7353242974454925;-0.98896228817454712;1.4650788407899145;-1.4154021722803034;1.6405706232577382;0.94732893028541576;2.5482451452047585;-0.11121770930660647;1.7618679944407027;2.7637127964191284;0.80742527299954381;1.0692979013428996;1.6692862617641306;0.57933430101889782];
IW1_1 = [-4.3502995252086931 0.050542936124307991 -0.097082254060252379 0.24830756004367111 0.11436365276595616 0.43337232052360453 -0.045957787001756178 0.012443729422512359;0.63153806991193084 0.42209735252867936 -0.51841323539577189 0.79226729446844035 -0.97313881487232878 -1.4232642150154686 0.021003364790309113 -0.076806422067537836;-0.099408424051153674 -2.221352919087789 0.48804999229264356 -0.22898748895408519 0.48463227306043249 0.17763128935780706 0.33592274609072281 -0.35703598021181138;-0.95229148269532149 -3.9273757406251084 1.3789468236171174 0.57075151459854923 -1.1112411914936082 0.87534028732050795 0.27064879444182732 -1.6220117723319416;-0.71780689816831023 0.81708585737813055 1.6851702493470366 -0.40829031937314869 -0.25577355066100127 -0.57710681783909423 0.081828554259462283 -0.10807828743396779;-1.0128854659112634 -1.6234014508013987 -0.17338913712954895 0.36485883637219779 0.82611167513326289 -2.3791182956053198 0.041195866832922617 0.19362707168005872;-3.3271492537738858 -0.98932583713261113 -1.4852503521776148 -1.4024316221529673 0.27772205647847881 3.7121603152918206 0.11829078796915775 -1.3059941369613739;-0.19019705739237522 -1.8591453589255986 0.0060604017869470631 -0.081251410631398402 -0.050773674240941771 -0.27579693608378408 0.011723243853866423 -0.035605945644181361;1.5570450987957014 -1.3842932827789864 2.2721937048414027 2.177022135161446 0.66859651330049552 1.1226754658324603 -3.2569162407341588 1.607005101288006;0.019130434861430436 0.65030928987891923 -1.168041113361306 2.1811285990619016 0.011721674177321138 -0.089224840497265992 0.68988227895048604 -0.068507227988659117;1.1970483122219582 -0.52294673779116807 0.51467885743388786 0.048905227551020225 0.064466849820500993 1.4634118466860182 -0.099961557386465297 -0.094878735353537691;-2.4582198315217312 0.12617775330522737 -0.16551516167181246 -1.3174175918997031 2.9667410538095416 -0.073950565860251977 0.43483653805365741 -0.078616879182170113;0.50683659500285194 -0.84525759493885311 0.48983324570719078 0.61128309952614757 -0.47039872118497533 0.12188292750298695 0.04562278371412308 -0.058245817114775597;-0.062286301828512032 -3.6321696374379808 -0.70946230141473121 0.033228128605722988 -0.30444908519298808 0.031544002586205461 -0.11148033461804235 0.20816592320886176];

% Layer 2
b2 = [3.2651634907853251;-2.7986386666766676;1.2474592267623545;-1.3571056513041229;-0.47466899754922104;3.2069965572748913;1.3061841487100663;1.5102718841334748;-0.37859675671199178;-0.6843519455703535;0.045402293133928247;-1.2251836152688544;1.9930367469191965;-2.7217124055247379];
LW2_1 = [-3.5241119264296938 -0.14282103162294832 -0.24501136354148162 -0.37120085697501332 -1.1107124201461187 0.43575473874228571 -1.1504755126527508 0.25405624267035198 -0.18907949633040233 0.6537479803201186 1.387756763110636 -0.14127141525670978 -1.0372950543467363 -0.19099753083426699;1.8059926350239426 -1.2011286350052386 -0.72048835381507215 0.21172223532198922 0.16953926149934956 0.27118322746204643 -0.62227512304886246 -0.2152605856942183 -1.1486556393085843 0.56518699921008175 -0.26331551913912754 0.56750733272772713 1.0526552669304343 0.90577837592506372;-1.2476107309469571 1.4118788547581942 -1.7682839007437585 -1.4647735228338248 -0.23940135634373605 0.49992357165908918 2.1990308023972958 -0.40108835235017981 -0.61917248893895382 -1.4616259213862504 -0.84348034052890597 1.3758212355585973 1.8477845723631767 -0.050936987479429804;2.1278463193424431 1.050283964025214 0.57025181991080642 -0.31421311348687014 -0.094233581535588376 -0.23269455777652748 -0.055875968088394568 1.7339044692024619 0.26100620230901739 0.94772382171325187 0.8102020399599682 -0.57501426560646496 -1.5548182163878808 -0.67645867874262067;-1.578596148009491 -0.20426959331341568 1.3939615319765886 0.32162671456869368 0.41442486857895483 0.13914745264279266 0.91743014349862839 0.19981717577245575 0.17398789461976411 -0.83249561317474907 -0.57737528913026381 -0.7380986593452965 0.26167105747743968 1.6660655537607143;-1.9493906100312257 -1.6544773650551492 0.85117818158589953 -0.90096307672048082 -1.6157933921777474 2.3337107499543235 2.0353437656761511 -0.69585051756201377 -0.95096436765321812 -0.86666852190623467 -0.64504124882415359 -0.71565660835258182 0.15897541244105062 -1.132730720520166;-1.0870395558737822 -0.35605998390776122 -0.21255384010773476 0.28492052716726646 0.26838753206236154 0.76002686272658537 1.1516966437931011 -1.1421161347211692 -0.34116017774721935 -0.65187922043416135 -0.1733221202873412 0.14838085536359891 0.57650424459312399 0.43971430977405274;-0.69303078121018136 1.6922951394509775 -1.4472078549788963 -1.0907372629132712 -0.052300961602280524 0.10785531325912803 1.7969518147603822 0.27446385138019425 -0.50069993984595307 -1.172304174439732 -0.6117510155851924 0.93601985166226209 1.5737368154535758 -0.41161128157794874;1.8735647635433395 0.13445020541519553 0.055487297397132949 0.49317802740116534 -0.062141078582435345 -0.052977908644622429 -1.237343216565713 -1.797541419306659 -0.12831272984467793 0.62889359075532836 0.23330298313696496 0.45088513403854275 -0.08845144666705633 -0.70441286595046237;0.73166884235433971 0.66768233067926175 -1.1874077916362709 1.3735386251966548 0.49997896415383386 -0.025151732582819015 0.56831502074067053 -2.4569300914125103 0.035792596569136435 0.75588001613319578 -0.32092438717575655 -0.01489265833123051 1.42158905261956 -0.013200987256459943;-2.3515116883098299 -2.0300509890050833 -0.15786852884954661 -0.23846086054079524 -1.4740207648624488 -2.831628025113937 -1.9931341580621156 1.3604598901315887 -1.5136975377438986 -2.0864072321019465 -3.2910992029113055 0.10941689289587847 1.9293888979243061 1.1124786967751694;-0.64557726613439559 -0.05145389004919397 0.1660974340622326 -0.58432878348212802 0.69577161001103904 -0.43493194359008497 0.039306612265953007 -3.1841362000277398 0.57627104910890536 -0.590361029125549 -1.0188826251635164 0.38250877080937551 1.2256981977839521 0.88928047957226142;0.37768390858770923 1.0725709978838318 0.73328473707686659 -0.43198880361287534 -0.35211098234190052 -0.51584235430190217 -0.1182852637842348 -0.028829435022136835 -0.42263790826459957 -0.44362369246479055 0.058139481433439895 0.18343760017546643 -0.077968599991116133 -0.33716453803973861;0.80641689278407058 0.88298827140092473 0.94419233878666886 0.059654969617586741 -1.1272760115387841 -0.84475004055401637 -1.9725715397465238 -0.69650102371207556 -0.47929438771201827 -1.1883776662727337 -0.056596377115743196 -0.44067628128965458 1.2090676978582853 -0.9414736124055334];

% Layer 3
b3 = 3.9610251429812684;
LW3_2 = [0.40421872969367334 0.35898203374634702 -1.2745238747640384 0.6973401815208139 1.1922454415359958 -2.9856219732750384 1.8279052988348268 2.3045571112067793 1.3023667369910261 -0.42900479254036133 1.8995347828251423 0.61976554243163207 -2.0186050257883834 0.36129711614775589];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
