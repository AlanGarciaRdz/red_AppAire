function [Y,Xf,Af] = COAtemajac15(X,~,~)
%COATEMAJAC15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:25.
% 
% [Y] = COAtemajac15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.8904865138744293;-0.66764363096551793;0.93744450909916177;-2.4375728591778687;-0.54780512203651199;-0.96603485118874388;-0.56286850262463672;1.772884199286306;0.11695309101934326;0.74508207905046009;-2.9998935672665521;-0.59880413045286185;-2.9876089272435009;-2.3984973025516108];
IW1_1 = [2.7207439615707592 -1.7732753857081798 0.91158995881538896 0.87535008825134719 0.56733578646201732 1.938860697893602 0.47578907581329499 0.77452703838272163 -0.21651643686546132 -1.3027189494531217;-0.27169077907071398 0.61874673050309881 -0.10971761682825462 -1.1312838528264604 -0.54662225181151936 0.016248034696426453 0.94758394433410664 1.3491187399287667 -0.16110056361649616 -0.76909078945417519;-0.9234752963722388 2.02242391192111 -0.42538128112376222 -0.4358376135615043 -0.83527869754994355 -0.56783395552670479 -0.0071891049758802464 0.92722039736630235 0.17879502212420464 0.29867299339864872;0.32441541752795278 4.2245335190097846 -0.62820455889663696 0.011714190513645084 -0.061944825731787397 -0.036844323270280172 0.32260994268567328 -0.0054192779305979669 0.040811649369007191 -0.20745558538251921;0.016830305129731563 -0.089606432794419821 -0.42359718600996027 0.34497296689023932 -0.52507826425064752 -0.71890106201768023 -0.10979432790978114 -0.22427128483881262 0.44006440153710036 1.0634099858855084;-0.15746854053642337 -0.33776944217586002 2.3341074993141522 -0.34962755446525851 -0.05804721677536645 1.2522515596616635 0.43219734931937137 0.38922980454662126 -0.77164169128961357 1.3482519183498913;-0.18071634295676225 0.14279232674313547 0.6246115214164637 -1.1059924496003544 -0.42769574053058657 -0.77536845132411369 -0.11605194586878699 0.57600600995993878 -0.0076122494422317796 -0.78933586443241899;0.12877459217183282 2.8538107524566225 -0.71814743906579648 0.060261660061310458 0.54503810703356093 0.23183667394480381 -0.1092900032548933 -1.4906821730127517 0.061693691702505472 0.45216174453846347;-3.1614519169205182 1.1799645185146248 -0.29118729844493213 0.34475423225802848 -1.1080647468886473 -3.2035458509031973 -1.3623454712212641 0.7776547093106807 1.2534525486681987 4.8306792199981565;0.24351897488610105 0.17922056151794771 2.2370257214346632 1.0007707530684868 -0.11367696802391988 -1.0077822826934362 -1.2926449832260942 -2.3388241772134846 -0.20131813251520908 0.4837226730442824;-2.8572992390916188 -0.18747958099376161 0.43723840066846126 -0.18938239255256803 -0.82397127642029278 -0.2430038561902291 1.0417235567044474 3.3922450771952359 0.6681056232645749 -1.6191770904759961;-0.34735500763139832 0.94256203145472117 0.66411309653034811 0.11877708781008549 -0.070529277333959917 -0.45232253177411397 -0.7435271921818164 -0.17876660474831532 0.12002013411620774 0.70184675900288596;-3.4115140730027997 -1.2332776899963016 -0.54856991120419141 0.92467403384353275 0.4804527859600578 -0.91466770337062564 -0.27394430988871399 -0.42112272653474531 0.63174120989971705 -0.36883309036394096;0.528352332355843 -0.50529964354164802 0.467929886615984 -1.9878054078743868 1.3511900863774575 0.13876606405151662 -3.0942003009672834 3.5926684015977135 0.57460896021522578 -1.0034523020668931];

% Layer 2
b2 = [4.2662147917373741;-1.9114313411456407;0.028750866279009024;1.2415558414062615;-0.71646924829791581;0.71992813755062413;0.99669746419411609;-0.35673591894366141;0.6804336262060563;-0.090982224040327658;-0.58554799274608749;1.5918586414160356;-1.6043378424609984;1.6018578566388448];
LW2_1 = [-1.8609616075431492 -1.8104022547701311 -2.1835657132945339 -0.61209163542311984 -2.2891490647423813 -1.0992815509279517 1.0441635534320226 0.33839821606167375 0.59928206094826808 -1.7728435309817701 3.1946439226113483 2.4288226707550939 -0.56551722775927271 -0.73714452310647682;-0.74832962019204641 -2.9563799057470908 -1.1539418861713042 3.3988123717926291 -1.523743003197036 0.057213269393343244 1.2632702518424881 1.7483748199866991 -0.0018975728348054593 1.0050917821575838 0.75352312339276162 -1.9234398286949395 1.4690081885258313 0.53269724199221113;-0.65240247348711466 1.1903756796088316 -1.524353016575321 0.18689265531565052 0.19352100423604449 0.53570375857789343 0.10009674068785143 1.7350025690973552 0.13604317778758848 -0.38818770305558831 -0.56735573437049647 0.71591463496243601 0.89352796528122391 -0.17952457380008291;0.33832436710106462 -0.93559023669032504 1.2933278545387352 -0.029880086486722145 -0.32216642220393299 0.097490954519504042 1.1558189529152259 -1.29352832983722 0.44540806129937532 -0.15250769615852353 -0.2875883112127654 -0.28005162925158378 -0.49886103178717767 -0.14458233800089024;0.68656823057070604 1.2482825784170457 0.21871872037385731 -0.1069452346300179 0.2239291531534473 0.33429434873987962 -0.21446714548532014 1.5198701763620284 0.27547608988721473 -0.078387325438886463 -0.50168615082888179 0.43458434913876165 0.72936300920529007 -0.077431624702835433;-0.53702169813664213 -1.088336641628213 0.089608861297718695 -1.8526212665284447 0.19350361158809171 0.50929062215712928 1.2236506477779685 -2.325977071273837 0.80053221611819148 -0.57094308342080513 0.23312982089184298 -0.87854856729481368 -0.086102135666732027 -0.24749633849149488;-0.85171731324914113 0.14582875553592592 -2.3056480814695446 0.80197707069307744 -0.45609069365158611 -0.24590263131264889 -0.27547340148570232 0.34585908154062478 -1.2342848530418251 0.81891630809662619 0.1256723843916091 -0.0014416003693617646 -1.678698603555413 0.047893288784308166;1.5807907134864165 2.1577310293836174 1.2401875881964841 0.18430643734861923 0.41762644322074949 0.43278703824836373 -0.43737006078774865 0.29886945687919103 0.021274779277893133 0.068805528325934479 -0.53147329471532956 1.1977840696934641 1.0563490617760207 -0.01317409355459114;-0.35291730670689109 0.86090040709755167 -0.81151472325597307 1.9604592505095828 -0.30575349856670353 1.2975078156458018 -1.1409986230716858 2.1031271563491387 -0.84859764786163216 0.42805987009716118 -0.23166609457081977 0.94102785941555722 -0.33280864478948224 0.23728304333261821;-0.56186493152381156 0.91057531366653799 -2.1836021395793308 -0.022067953957317636 0.95702636883708569 -2.3530619617381614 -0.92676697891786519 0.32611544496139527 -1.284480295501099 0.80198561466881957 -0.016268651385800022 0.58791526730614774 -0.89510269822443389 -0.020697409641898409;-0.40121670060234915 1.2060152421445616 -0.7028645513346482 0.224625882385245 0.76335355867502896 0.32456664388051026 0.0043657114838502875 0.75113470707114072 -0.73026594089885022 -0.041906440679377044 -0.1799503565667353 0.97439694574050428 0.099223818217975435 0.092834424817575867;-0.93123768270145235 0.38347616011917246 -0.24380629996987624 -0.77460422763772285 0.54749023699704658 -0.69246356078111493 0.95818863025670598 -0.93822363184936908 0.70528409945359072 0.013272321093255379 -1.2393530578389036 0.074015428010513362 1.4234948954225741 -1.6315784801656525;0.17698529594956 -0.81553623770879069 0.3874756332369661 -0.096810259121849096 0.98382521024005154 0.40802781072035921 0.92664709377233845 -0.53461533431802222 0.70756050380018398 -1.1181314442668906 -0.083643877158241453 2.4030652588491188 -1.3173822536288826 -0.82866558415118385;1.1025650283526698 2.784957488993502 1.6040264765006504 0.57170763366471977 1.5115450664231516 -0.18127006468170687 0.14627636091746465 3.4811545138751852 -0.62935707015307829 1.5973520400050187 -0.71980183849160362 0.92584578176965071 0.059870525240107747 0.53310287693598357];

% Layer 3
b3 = 0.37663012083652131;
LW3_2 = [-3.2726376500739724 -0.20481557065863862 1.0889307128907308 1.7698759212487052 -1.2939509566746967 -1.2870606187343945 -0.24733405106626627 0.64514266257453834 -1.2463422491594607 0.28118957935365835 -0.56481393401417035 -0.093781055474267058 -0.11422940473113123 0.077106018859367104];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.201288244766506;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
