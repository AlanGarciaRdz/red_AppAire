function [Y,Xf,Af] = O3laspintas24(X,~,~)
%O3LASPINTAS24 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:48.
% 
% [Y] = O3laspintas24(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.241545893719807;4.5045045045045;0.00280033604032484;95.2380952380952;0.212765957446809;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-1.8061509456119338;-4.795536714773343;-1.2909776255288918;-3.0538734122861149;-0.27634280063409772;-2.9011841463898751;-0.013398113808516446;-0.90329398662801597;-1.4530819368670658;-1.5106086696537839;-0.47545968027053903;0.6169453690796185;2.6802190963031176;0.3366363862098774;-1.6183493551702313];
  IW1_1 = [0.62917933997947528 -2.2622532721828064 0.96687177107652089 -0.50083782224250661 0.60404965522574294 -0.017715508871933301 -0.023755019791824254 -0.15065413259220103;0.39557413328109137 0.38426638193605028 -1.0454018976081523 0.97693259476265659 -0.5289660084654445 -3.9910544047953929 -0.12044985110308265 1.2623954705582929;0.32580395667112022 -0.4240701508884408 0.026115054633487469 1.1252021042562592 0.73274993217488382 0.72377285979226424 0.29803973957289936 0.82167227637260587;4.0479095301100676 0.28251534828017977 -0.53675121822250671 -0.11183964859023482 -0.19802748376101489 -0.10885659233988201 0.17168499996308534 -0.39054361660911191;-0.48156983179403801 3.7597620385805883 -1.3518173876473918 -0.07477756119343032 0.57183991288130576 0.74959415676279273 -2.8497594315138723 -0.38573479835318542;1.2651246221761847 -2.0431449950087259 -2.8110651554934676 0.34605623465620822 0.77809436132309662 0.11331635825503061 -0.21922934406003958 1.0525260925280018;-0.66021201350589354 0.20812714708990909 -0.15428274494286726 -1.4045089226508627 -0.32751830969309365 -0.033682327761581879 -1.4503230017936386 -0.46878734774195741;-3.412110734286911 -0.43255196463503154 0.59837417768007239 -0.26118175437854252 -0.13509059569551218 0.13972127364233686 -0.19546647892966557 -0.45642932605518377;-0.6388592978919303 -0.39755292208620707 1.5376258740200839 0.15494435333749471 -0.28436294960969127 1.5303717093359948 0.40585400398621557 1.1281381119675016;-0.61903583735360046 0.54281460946349058 -0.53945349665436604 -0.70382213424153728 -1.7652011698336503 0.50949356282867364 0.24906603730464894 0.55769458795078652;-0.27221749323224975 1.2308334607914404 -1.7409320091819678 -0.0099487452419030342 0.29745430621376912 0.16236022124675745 0.78517225091203713 0.14066192311021838;-0.47870996237440711 0.96582455158132741 0.94364949105916174 -0.69918558700685829 0.99932111775635735 0.42364723237391366 -1.3026484833390615 1.1732641545805593;0.3604686512647165 -0.70592740863907766 1.9479142662411852 0.34182355299403644 0.28777547688727378 -0.70405751655806859 -0.86910612635844087 2.0469355136970111;3.5146873178247313 0.29657135902277226 -1.6901582187430422 0.32434512046797892 0.48508197160078514 0.8401601946863122 1.1381734668371812 -0.05179550705253852;-0.048856061211396545 0.94589946207945463 -0.29354454058778828 0.63511358836516685 0.74656996882581328 0.66890886588640908 -0.18591520029707745 -2.4313856510877083];
  
  % Layer 2
  b2 = [1.7909284118203941;0.78307656459956532;1.128610945186485;0.70517123205107002;-1.4171595739834206;-0.52265000333767109;0.30268527408518525;-0.35352730875772342;-0.07477450524726513;-0.59474493807716033;-0.98651646911880031;-0.44861732981378549;-1.0973663279504333;-1.4023836868638246;-2.3000164735253668];
  LW2_1 = [-0.75737670214265396 0.7066241427828045 -0.58341627501824345 -0.21575235060068773 -1.2342302201815178 -0.71220746847832939 -0.1007771794942343 0.66374489301721551 0.35754461491679723 -0.10206272806512121 0.22882425167374332 1.1261019030751322 -0.80754096439122758 0.43960651590627015 -0.040316864086224931;1.0701299942817932 -1.6244759818965913 0.58899243711317817 0.10512262136978441 -1.4721896221994881 -0.5189045610440236 -1.1231036228041318 0.016385606894917769 0.43027542566873012 -1.0830651727718994 1.5710050763065304 -1.7387946298830654 1.5834399366752523 -1.1194527616287917 0.17894550327144002;0.48180159790522348 1.1191710655209559 -0.54927803372276418 -0.27011255512901206 -0.053210175668957423 0.0031109374577363135 0.28705273978535267 -0.18590334318037766 0.52447465689958828 -1.2560358938469149 -0.12844971845210507 -0.15739503037567651 -0.27397151746752835 -0.34419260969607551 -0.39044732125997011;-0.66411634957391152 0.33829142640199411 -0.33699153380290325 -0.40976841827325167 -0.79108785558501882 -0.52718778156876667 0.20917162409137527 -0.46995850864104738 0.30729018306659034 0.06695696351332181 0.1565503772475228 -0.10213776296000424 -0.61661340863464542 -0.17926320289355319 -0.0095244428203004675;0.77670049149253362 -0.7067534195488917 0.034209955767258993 -0.063725103025639038 1.3989879960452876 0.72181006821895166 0.12468674600980449 -0.90325297316129904 0.78406875905562357 0.054281201955873312 -0.55111093783802356 -1.0636997104328645 0.63721720384073721 -0.31793832741400108 -0.062667291388826846;0.52051750759034487 -0.33931719377079095 0.0053660923067273998 0.68343878173962525 0.54248152064699973 0.40720915892182941 0.28137261062833291 1.8384549219466213 0.26752178605760035 0.52739383284337304 0.2912523692644613 -0.4069292643976874 0.94025686482621706 1.718129310388349 0.30010485338251347;-0.9772345725203172 -0.47522540147138881 0.47239314434298602 -0.33679540763897714 -0.97341763097347478 -0.85157829555341436 0.27538028206320309 -0.20840718844100228 -0.42217938947038586 0.57143902410958591 -0.011907819355528017 0.26770242951053624 -1.1333305854518381 0.18937096125417252 0.0089048821407017222;-0.32780877313420925 -0.24061663976018144 0.15428939209305703 0.068212195431980302 -0.19807000856220758 -0.13633785237700879 -0.8817357660884364 0.57528491394247616 0.56241770104566535 -0.6776234806664041 -0.39389041827210908 0.41604613206722579 -0.45321594247013758 0.81855980603790324 -0.23028406519773004;-0.31494351160476236 -2.2119349362217631 -0.1875084332576358 0.26502947840566699 0.05333469671920861 1.2712112332813623 -0.044881274052356007 0.058061668533199592 -0.11362655999191286 0.37971108395594116 -0.59461367476039628 0.091512582427330541 -0.54645738522140275 0.42335159025558122 -0.40563882457178518;-1.5322106528830448 -0.88984591816296088 0.21793674784949832 -2.2773580198208272 -0.040137189994484367 -0.32707258922975124 0.18251759277270921 1.5459706761211578 0.096397852065357337 0.14502126624730485 -0.059284291864805216 -0.84384339158411847 0.43105389407718586 0.75083252714233895 -0.35444631379310726;0.045402319963156162 0.74502332177402464 0.85384768610900341 -0.89002818284070551 -0.24551683323731055 -0.5879490946494621 0.68128261094264098 -0.80327090234739129 0.19562223282802049 0.24818641715907472 0.31942956057420707 0.03052739238895124 0.92375247763407886 -0.66112037327967366 0.48363239337451314;-0.1994349276335935 -2.2773955833233637 -1.0277221949150854 0.28960929448698453 2.9566486232369917 2.1185606325261368 -0.31537412960707872 0.28430582883568328 -0.47822776757668983 -2.5589103124407875 -2.1946859486605814 -0.49913065714268356 -0.44997912678138091 -1.2484052444430049 -0.75059873404523259;0.03357524948546943 1.8676539403886283 -0.093240030682486749 -0.63528669086942802 0.34590255678816484 0.45173397064533205 0.022311508920689799 1.0589846214785636 -0.01000077132950351 0.039572082843565365 -0.34505157913394036 -1.1192806373417477 -0.66041302201860763 1.1451216773935609 -0.072134907427433864;-0.84018335770797226 -0.38196936498624062 -0.4224994715563285 0.059469636171373727 0.42297270565369177 0.4270563450923327 0.26166227429324562 0.51801135955383959 0.022520031454701224 0.80755509270981018 0.15586345557000783 0.12014935996132779 0.07993888760615063 0.61314972379500599 0.18280822310734751;-2.5305770126515883 -0.74368020257158773 0.46762794484685466 -0.57084051531606173 -1.9633270455847016 1.5237431325383135 -1.0965144130492639 -0.38358683764708584 1.1127510723454106 0.23410620331990151 -1.0688244001533354 -0.019774627947674275 -0.81844820258663598 -0.31176168990804359 1.1764484713739907];
  
  % Layer 3
  b3 = -0.22672537271152354;
  LW3_2 = [2.3154199509159623 0.23077105320859967 0.88735259501553909 1.0892609212976181 1.6961235008443656 0.96764588629418136 -0.70705462593961022 1.3114469641073154 0.74420819333393573 0.30771075409885085 0.70574950895551436 -0.15068545672671912 -1.395264242924301 1.1594856772526543 1.1690741951464443];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
