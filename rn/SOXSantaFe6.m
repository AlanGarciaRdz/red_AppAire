function [Y,Xf,Af] = SOXSantaFe6(X,~,~)
%SOXSANTAFE6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:49.
% 
% [Y] = SOXSantaFe6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.0273696072396299;1.5684210091811619;-1.081282157881069;1.3755730269487856;1.1066532171049177;-0.44017960154352431;0.75310310166420724;0.14802264723476008;0.10675456979510216;-1.0700465897900679;-0.78957598786358196;0.84311360052855544;1.5979543342666751;-1.1989832668505447];
IW1_1 = [-2.5932517718298538 2.4269123295710928 0.29077525689516404 -0.86646440763786048 0.35827328414530213 0.75043170236833545 -0.53726516615003261 0.43437257177317257 -0.33565817707918283 0.11018253815440884 0.16014032552155982 -1.7499489170840103 0.34584470699768532 0.71155654215927833 -0.59304089868971255;-0.30910805207340575 0.55170493524489372 0.13813855224604718 -0.49078624972976709 -0.49872843015847335 -0.48145172978180789 -0.32298935516788391 0.63449572724198144 -0.33866595724548088 0.51164931479596554 -0.45148950637177948 0.11915249842396128 0.01371280640480553 -0.42191453918735961 -0.4350970952587665;0.44048947565907592 0.35987561080030894 -0.73421846021211301 0.062602856980425906 0.99994220782610199 -0.0010329245354117368 0.65820210258635814 0.82485750972105887 -0.87467220823046055 0.81127981639050961 -0.67322801177659342 0.49851329786875853 -0.15293865755788771 0.054790658291230407 1.5799218363542151;-3.1270698357967039 -0.55216768084730172 -1.0132773030142705 0.2273163884671221 1.4523794602749958 -0.43480742841111808 -0.73908300152434836 0.062067952171544878 0.058217756969382257 -1.7428294111886771 0.44142443529703485 0.3366199450920031 0.5685420630104161 0.58545714495324164 -0.66171485038306543;0.45928520863173172 -1.5001390544730433 -0.48656109294131206 -0.26728026350760864 0.53103980507573822 0.20388867186237419 -0.47604396859327258 0.33561276126651468 -0.093783536353029856 -1.4435371547887572 0.71448447610957699 0.42212393786031632 0.094183086483979953 -0.024550794111433905 -0.83377668055930276;-0.45308843774535301 0.046622884844036094 0.14581610877228762 0.44786292998026295 -1.1262577880564695 0.71688791294657372 2.047611451647342 1.2049106966133327 0.97384042664239878 -0.41708625249228459 -1.2631681692448149 3.0748126943012526 -1.2635617919520197 -0.44337660967856707 0.38054097204148235;0.84768479791914508 1.2178366410853445 0.33369180687531474 -0.29705241954163686 0.10178887889164701 0.19409622450411504 0.4370746713938744 0.26333456012196266 -0.19114683798529869 -0.182558394324979 -0.091198288091963259 0.36571440519647735 0.00013586119123506005 0.24203481070976163 0.063236538593769084;-0.10946214636195188 0.0060086664858932399 -0.41360520839922638 -0.59088154356284228 0.017727829896291347 -0.94785158435523542 0.12065327837762496 -0.37051345557293347 -0.71147380865997967 -0.34777652216154187 0.1765213867471524 -0.86135849103480699 -0.82830896912302998 0.44356897779991222 -0.35113261735702311;0.18612899965528526 0.37168053808980822 0.53208399125023387 -0.60792986655778669 0.50611304553765235 -0.38629445924609646 -0.62268355381347407 -0.0037861936450027918 1.1289018059108833 -1.1884533283131591 0.020473775017983725 -0.63274879079371105 0.393841730267879 -0.041455269437124062 1.5208142149779615;-0.61146835255879928 -0.95978401753255027 -0.045060905975876218 -0.20539811666983138 -0.46793501601690568 -0.25936865104535589 -0.063136090650885504 0.0089281081885324524 -0.84327582351890462 2.9845503715587767 -0.0091096367530004579 -0.10131740282794588 -0.43049170180021762 0.075214346029824269 -0.70367748224653759;-0.08950701328292153 -0.19980217278541304 -0.03779351726085374 0.25152577906682011 0.39463812446167379 0.11140921961934643 -0.067386423379992733 -0.035072673663798071 -0.081998389071905348 0.87862792887443764 0.14456986654545137 -0.071045914544197245 0.18066097582781293 -0.13766300307356724 -0.66111261736451077;0.60679321633083494 0.83626132951068011 0.2937499021493124 -0.47269448145073095 -0.16353466310371034 -0.051106580272911255 0.13310012757503886 0.13524518961460308 0.21454203970717661 0.54240984811114046 -0.10958770241222814 0.034395761056289956 0.065991599930615777 0.18533741250014604 0.34678746219861861;0.17128035776803285 1.5062743853081735 -0.73185965838561473 0.18578130024799297 0.15216960903798343 -0.3134986998632 -0.011341735758438665 -0.055918190733758026 -0.48134370606181848 -1.050057426023131 0.14122175728325348 0.30573683234276278 0.585808788397849 -0.39106098868960321 -0.78487263635138782;-1.2042066007054306 -0.83711881196491444 0.11096016271671516 -0.39655914705974671 0.26747429442235543 -0.57911028093113182 -0.6825850997877394 0.076927946436206804 0.18173477337816304 -0.48138275798516078 -0.18805127968218596 -0.50443711843513772 -0.45431354017510911 0.43719048222034079 -0.33822925947920413];

% Layer 2
b2 = [-1.5210658131574561;1.4833581589786322;1.0978416968052316;-0.35708051513136335;0.69697467921621248;-0.8569661005333209;-0.13257885152013238;0.027397508045016922;-0.48508463747007052;0.65557506008519528;0.84171371030075526;1.4349813111987479;-1.1225610581841721;-1.8482313868457394];
LW2_1 = [-0.6971104498089481 0.14204999617078154 -0.8227374040177855 -0.60798815467219947 0.021538018574995675 -1.0936902101552339 0.52137676936653055 -0.043963769424740132 0.91249365856797604 -1.1487159454708389 0.19557208258097475 -0.51696296810575415 0.83438775016278799 0.58079542662982397;0.35197549697927499 -0.1973957163322374 -0.5078487038009406 0.28638046845383724 0.10702244761390881 0.3423867724888055 -0.70586467055534752 -0.56030916821199328 -0.58695132926433125 0.80735440418972215 -0.45909807397048025 -0.6429839902261566 0.71179110616748487 0.55609816738637474;-0.43740934352677951 0.091265428267479173 -0.39565936327351015 0.858130636415113 -1.0445504244204875 -0.56553964362115461 0.23341962016825163 0.54327207983127712 -0.23238378605842103 -0.25010370707017038 0.0313301851994576 -0.75156804447281578 0.12530698550688021 0.41956233308027702;0.74177915793781046 0.82116986637160427 -0.4724431700119438 0.64585226124532613 1.1516149752038884 -0.7002424465410797 0.46869793860206244 0.083617749370863581 0.28261288980406679 0.24337425591457812 -0.37122626438864942 0.093866801127472727 0.78470314468840907 0.27760749890972508;-0.59817726041668917 -0.40606409854036812 -0.49998635130908747 0.75470444301843842 0.080570253843477352 -0.20267358549750483 -0.024953292392043622 0.39195837232613884 0.51052336571812262 -0.92896194423137168 0.47390921908898992 -0.44652095411052051 -0.31440001203353696 -0.16772098114011311;0.29824489306480984 -0.62278330859838382 1.2172178418336694 0.3920905168896156 0.92537462879464727 1.771202802459799 -0.33015328774041686 0.55997367754865979 -1.4072292282397425 1.4796962341302202 0.48217998461969863 2.0011901320048548 0.34940733553305253 -0.60626960215552439;-0.17819823922601447 -0.85984464832495344 0.33083142437816165 0.82072175631155164 0.41928673021793861 0.88430433811633091 -0.03028380203688024 -0.40180099086308863 0.36124072137939861 -0.99685364440964885 -1.0878702125869739 -0.83196191983640111 0.12793174101469579 -0.13195541293811949;-0.42180161645900172 -0.29823226172994399 -0.057662882436996625 -0.31131644649595031 -0.58989768228256778 -0.67456651487586516 0.22069375401947183 0.60643031999957342 -0.34504057527576426 0.6229621042458362 -0.43267785516086982 0.5702651279072859 -0.16365291189797851 -0.014233745702833332;-1.1000266616209815 -0.10519894782576461 0.25075528744196163 0.73217821024980045 0.084840596301249557 0.71471568439969613 0.29907014729440606 0.81495322208967269 -0.35247761061978172 -1.656755490795295 0.78385665149005479 0.54360173190338656 -0.48059872475342286 -0.20837003856336456;0.64359667925905373 0.6334575494172856 0.43361626928430125 -0.67589773926760777 0.054698298429355231 -0.26139510841620167 0.65656682642472042 -0.60728064136938242 -0.036296228902560748 -0.28068649674711971 -0.61313867526911137 0.21696380029011159 0.62400549489450741 -0.38776687307614804;-0.32067770816726965 -0.52035192753573578 1.2895168995959636 1.3340334461159535 -0.53443053950122488 0.98729681471214203 -0.13128590030014001 0.47337562688095125 -1.2706126436727407 0.63320105994602593 -0.23928638995834273 -0.011742535395364188 -0.32416454374236259 -0.21434566465198882;0.86692936521977171 0.57794088792805098 0.11984781629938013 -1.7223285889216235 -0.1773968857922037 0.33916445963426584 0.029428261079979982 0.41173060500900333 0.80977864964647783 -0.48333798866366806 -0.63436966997727251 1.0002442494767285 0.66778562524112173 -0.24572129472944129;-0.0028656464934659108 0.90189369173173606 -1.1796281563098658 0.15674618497986478 -0.82325859474005658 0.93829290457608971 0.92411211119445313 -0.20504079526350286 -1.0283910261269986 0.86987299135138352 -0.16896482904402685 -0.47528614200377028 -1.6602328184395687 0.59800695427660966;-0.024158007430836043 -0.71235612536980875 -0.062996144008030372 -0.891252417028083 0.47092822598727374 -0.36247276370958437 1.5044921420476616 -0.79886351188821725 0.31706933605653637 -0.70223863998970593 -0.45776461006670094 0.25085802824770259 0.22199731032027301 0.12528001176898057];

% Layer 3
b3 = -0.69105384055929497;
LW3_2 = [1.1070777302353787 -0.70144909189801308 0.81802622199671704 -0.34410470254209324 -0.98364717312512884 1.7226192936105891 -1.1773332809865882 -1.2978041834502076 0.53895114084785767 -0.7968225795709456 1.7135208991900699 1.1118686481436255 -2.500060762373181 -0.51954614843229741];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
