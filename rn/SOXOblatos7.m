function [Y,Xf,Af] = SOXOblatos7(X,~,~)
%SOXOBLATOS7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:40.
% 
% [Y] = SOXOblatos7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.5721589883598399;-1.7717622194393639;-1.2302256958763416;-0.64554678661682308;-0.88450028467974362;-0.34149936951291787;-0.67670323651935338;0.37814985472346124;0.20193795814776316;0.016942728993241667;-1.6199032287887327;-0.93440019397882879;-1.7122566794197398;-2.1013965171870916;-2.3415244156309662];
IW1_1 = [-0.96411246282278684 1.0350951416484551 0.31063394625198432 0.58834683280072952 -0.0095578268319750862 1.312382878555916 -0.3367317338571133 -1.1926225221898212 -0.35817423369482709 0.18466185182584366 -0.17791339735370379;1.0550228196360805 -0.21629496156769662 -0.30366049628609409 0.40050423899668713 0.65331142209735293 -0.39902458144561886 -0.12081539336931432 0.84125575852829781 -0.25321395965562671 0.31099515756710289 0.1645248845653709;1.2632640927137189 -0.44184015438611302 -1.114408330220737 0.43648418695405805 -0.16939390719690944 -0.91099222023052329 -0.19753326208924452 -0.75487459638141541 -0.28211837031024661 -0.99852190463211732 1.3756742673164499;1.7461708493842234 0.018879103366192904 0.69921736338230656 1.4264371280489299 -2.2518400402907459 -0.24398905881151223 -0.57079106068436147 -0.30222623503039497 -0.28671948550870519 -0.76928133888452155 1.5137826360771773;0.32659619797064687 -1.3599710859638801 0.25329839416000205 0.18621036420251641 0.47498836797621924 1.0850734968600921 0.30261235410624043 -0.44065546842834658 -0.21849241696817659 1.198521267050402 -0.17629656922213224;1.3298373649219635 1.8951047546754871 0.21359153562730646 0.5351765008918633 0.64747828297065257 1.0083605013386991 0.14501001920916912 0.067179941683664438 0.49074817072445581 1.1159314587468769 -0.67336381014344027;2.9388925314872423 -0.44143761328305092 0.24707668103322708 0.26034708056884032 -0.96032123275643433 0.2745338508055547 -0.47537650604191151 0.46796182458443741 0.76212678374767617 1.0665980678534925 0.51555526538762175;0.27287348813912699 0.49975250393249487 -0.0013934870137829423 -0.26583690801054505 -0.42009508959593622 -0.45999020944555025 0.22166077720259347 0.95509396468817243 0.43409354710389142 -0.74059762739230295 -0.83155934059208692;-0.064673662836993606 -1.5802414254291517 -0.11695515856636425 -0.75815890079095949 0.89500995558613694 -1.7013455773175443 0.8905838165073634 0.57737614403879145 -0.84810572555251718 -0.25362088671718852 -2.1454781711793158;0.41837062204307263 0.26472142668693111 -0.44571423774622049 -0.93089638479379 -0.063036323010314227 0.28364688788242953 0.62954262102083491 -1.1063907857644124 0.3820530656006581 -0.39753478247822555 0.17967402289445644;0.037847646261348705 -0.13510667347588148 0.55552341791211335 0.086204271008455846 -1.1665089347905282 0.73958763316980036 -0.2720302620895455 0.56132761498235539 -0.049230355929927527 0.78933603163774635 2.3559042314355403;-1.5496014481903988 -0.2903156870626793 0.11319163071124778 -0.71452465996327175 -0.13560973645954463 -0.10034883926011801 0.061742303722659653 -1.5122592926848173 0.95741182058707386 -0.29419348343265017 0.76151587921044472;-1.0268395215877772 -0.155135524585616 0.35195365948591506 -0.61055803374579254 0.04184717680657081 1.4127918269331206 -0.36629568944238106 0.81492975025457737 -0.18643961957963112 -0.27531140435299339 -0.4387730522825376;-1.0151146971120248 -0.24121382083859255 -1.8152153992734852 -1.4979698648672573 0.019601760075621186 -0.75566100465712438 -0.13871402741683422 1.2369398625549834 0.3164943668252978 0.30286482704773482 1.8405216423782291;-0.19750737338645313 -0.18883661816044373 -0.072550890751804209 -0.063004244452798883 -0.37469468355050833 0.9255088864924117 -0.72869346361470266 -1.3400204287643689 -0.56099448451755507 0.71937202547341506 -0.16966937022155185];

% Layer 2
b2 = [2.1197157186011264;-2.2407968458696357;-1.3878211611410265;0.95827426518231706;0.56660782599690518;-0.41616216800616168;0.30147147608436542;-0.77481478658732705;0.13594348596415573;0.46512497708385797;1.1715572280964734;0.90849680450221781;1.2898485310891661;1.4425360542614318;-1.3728360370301333];
LW2_1 = [0.21267808369990901 -0.31235227494789347 -0.34600564186202371 0.13641830100330313 -0.25741023043055244 -0.19984501223438236 -0.15053869935900174 0.42355696579636054 -0.15287213142574324 0.082474620379040187 0.3052960951164016 0.4109862548328353 0.54983328453531044 -0.008748641300403804 0.79182201749806691;1.096012256957265 1.1439975313735333 -0.86356752674763071 0.32092676786300051 -0.61397422368778154 -1.4694224040160804 1.8380850841608549 -1.4014675285066853 -0.98018040844182919 1.1921604459567223 1.2589435711259727 -1.7379152831531794 -0.41568249261656431 2.8807232788767982 0.96732592210820045;0.50987046730996399 0.67422681840540777 -0.50243188442843989 -0.028223688675156927 0.056264825435450555 -0.33669881869889567 -0.21763434250692923 -0.36238417585217803 0.42005537938006909 0.27341740059676156 -0.03952328725056907 -0.0040001175698453212 0.11952093376358584 0.68344650496094383 0.61832311070336488;-0.36626595986655075 -0.016751988183600422 0.18972726476311297 -0.39674710007935832 -0.27682360973812248 0.35838722948902213 0.41866157983908558 0.42586448974191315 -0.25915711886321025 -0.47988419720747416 -0.46469480588740864 -0.40903154429052346 -0.87096326894533005 0.41285131844681322 0.29668502324132201;-0.78789480818480295 0.49294538792841375 -0.97385348171857133 -0.629421715907451 0.45522804017140239 -0.16067845403092951 0.40526754602863063 0.089635871809055342 -0.32952062834274787 -0.19455690040169721 0.64370966959753639 -0.77681395963601885 0.60623696830170781 -0.17711124648117527 0.54443758668327003;0.23901970746799142 0.17659896941444858 0.37991735695003231 -0.19586980315017827 0.030148272313904642 -0.44910416811840048 0.24450428216506084 -0.020934070630955329 -0.26665186011191394 0.037918048898857387 -1.2834246477982627 -0.16494095960503224 0.022434981718011338 0.20606076364360021 0.31567374580477803;-0.98665482342467092 -0.10380385614441692 0.60080608887881082 -0.18098668195698123 0.21424527084564401 -0.1161071955683478 -0.15207497867175693 0.44978073389090606 0.58185263458555103 0.33814221123067251 -0.47248281459919911 -0.1859629239951065 -0.22611921035204322 -0.39770668116706853 0.41738179937090358;-0.40555702894727708 1.1030646998612963 -0.65061076898724646 1.7561872771101741 0.5820002381849535 -1.5270027709586953 -1.7081313997485259 -1.3491482293108512 -2.7285059865954895 0.044971081782506306 0.28533103064733933 -0.63826923602418917 -0.64705048954432598 -0.066218714749901306 1.7834846458058604;-0.071484705795312006 0.62704306556213951 -0.045841189283033545 -0.33087705637046727 -0.058911932698660421 0.10646118919881709 -0.15302987466447954 0.21377997142777724 0.2333322100009679 0.3511292803440107 0.50018502782709473 -0.34413981846270875 0.68617240262716439 0.26247079001322571 -0.85554430015626526;0.47398636303724506 -0.74336716994025542 -0.10869210765356213 0.41173201768163642 -0.041477988446466045 -0.37614030177842722 0.1344506359859188 -0.24393208028247867 -0.15718895811680428 -0.046949606486716242 0.43052482397134761 0.44585782287551862 0.15966478406738024 -0.1701750171137093 -0.29812118137098398;0.048172737583777873 0.13975043044976765 1.1423154763697312 -0.51707399228158013 0.89628552027586572 0.31477459433276456 -0.52355071896779826 0.23309279530836438 -0.18330307010989286 -0.4197884223978221 0.65365776304535539 -0.01870279542499537 -0.065707418099421072 -0.096350547557679411 -0.85798286180810146;0.31083760988786202 -0.24845960976748888 0.13688534269846744 0.3904135937989171 0.73485967668039742 0.27271786728548492 0.64087721532200093 0.61798017565044294 0.065267418567676844 0.0021843587585473542 0.60423093815559381 0.78505874671312081 0.21082571160125943 0.22070773381913225 -0.57922309860313281;0.2521150088305652 0.30936572761953418 0.11406306406062723 -0.34335992884362465 -0.17235419300820121 0.556391722968678 0.25338947103062504 0.42351160698038642 0.88623576686424677 0.26486408464982614 -0.71632100304303226 0.4264150526853781 0.067640803394222543 0.74200617947191139 -0.50312834370811077;-0.36983226547260156 0.70275822459849835 -0.41783302190446669 0.0056561453910057291 -0.029392698846637883 0.089192230222864849 -0.067639939243585273 -0.85706967851415283 0.30404424754724252 0.22479497030678774 -0.67117402143667815 -0.068864379285065558 0.62236210719048723 -0.34317563060046213 -1.1224354389438533;-0.26495424130134154 0.27761021633180011 -0.87193727027293011 0.32737394276117793 -0.38028724493674571 0.17812517633053471 -0.073053103857607951 0.14589299107766207 0.36693272672551175 0.29764595513538072 -0.51862367436897272 -0.059027665436984206 0.25806789004904745 -0.13020846797399904 -0.018614623312013273];

% Layer 3
b3 = 0.4377139518283138;
LW3_2 = [1.0244003186128279 1.9971110857650143 0.29642794870498418 0.068540182546000042 -0.11329215669759361 1.050669291612836 -0.089044872028564967 1.9711487374885026 -0.49778305021398234 -0.45755748331852458 0.4965185152659824 0.16444324033519631 1.0651554367639029 1.0598795772396177 1.0510793686733801];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
