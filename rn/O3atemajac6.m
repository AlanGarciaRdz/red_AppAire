function [Y,Xf,Af] = O3atemajac6(X,~,~)
%O3ATEMAJAC6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:35.
% 
% [Y] = O3atemajac6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.201288244766506;4.04040404040404;166.666666666667;0.0561797752808989;0.00614628149969269;9.52380952380952];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [2.3075098991823149;2.1049252954659576;1.2498401943099369;-1.7654533951740246;0.835389102241888;-1.1759950027002144;-0.48401749203783195;-0.79173747182645793;1.0174076087521255;-1.3901602785340295;-0.37650366334864843;1.1234176801813036;1.6476687295335273;-1.8017624173598756;2.0215214860969266];
  IW1_1 = [-0.38546566671144294 -0.39845928525996999 0.53757242489873824 0.31599814470954102 0.45849250175412609 -1.275685852902759 -0.66045361091430455 0.082886885243145816;-0.16773406435412322 1.4159339995472298 0.57730829796381222 -0.34145769426842693 -0.1861990432080598 -0.58706997655225979 0.0074571530589674067 1.3338483037425499;-1.0546156827594357 1.0150888708684416 -0.019586938440214779 0.73448585293000079 0.69395918561503722 0.4205823580966791 -0.59452618836642901 -0.34519064234146329;2.0195555865323995 0.11155889846586525 -0.80672251082318536 -1.3717166669912511 0.61029559492899266 0.1011394671910095 0.19578548922425268 -1.0812988977594218;0.12114360334427605 1.1397439893995323 0.35370402045550159 -1.1780292489655206 0.44934311262780352 -1.3518904633579372 0.42650337629403373 -0.71392631458596689;0.9575937791089375 0.63264368899032253 0.0045253450618774928 0.48971718804957148 0.12074700402166652 -0.24134805237688278 -0.095188362225841192 -1.0091124449521451;2.2281306911945848 0.39866507376940818 -0.4861239898222614 0.13019769469879994 0.38894379700128773 -0.027666120093616783 0.13692170809821314 -0.40090842488932321;-2.1133328162683531 -1.9658424562228434 -0.77615674800755707 0.14743511361588538 1.6333229504535476 0.066184526841192498 -0.11158557284212499 0.3254198552654225;0.3915075748050566 0.077114699768180625 -0.88278550572530246 -0.99082545942092992 0.48311933720904493 -0.65184234997071289 0.9114445468717367 -0.25253409946628769;-1.2448468367713357 -1.2877837468342157 -0.40297288405758924 0.26031319371252321 0.026648735226646666 -0.077257123590983801 -0.047225259508850967 0.18246483989890452;0.21920128481866408 -2.5335888907844923 0.082823791750556028 0.56501730583041498 -0.019815315665943984 -0.34713162446528889 0.16149631877080917 -0.27437489508410556;-0.62793769649810183 0.0062468385819519912 0.7305176298995153 -0.90974334520208844 -0.45841831870587807 0.86372629070437845 0.028945423719077393 -0.54285928246410264;2.0823760445381394 -0.57168095784503548 0.37524277924067867 0.091333854539219647 0.066473809166077605 0.39740674879453486 -0.21312384024562953 0.91188038000911154;0.014865635058907339 0.074526315036692575 -1.0387049627475651 -0.17724671389834051 1.2940059340158478 -0.98076910348570345 -0.97949287711716404 0.97562584988003798;0.66855467285876269 -0.7262344279648546 -0.4208580842503441 -0.5614299225774052 -0.23013970221320551 0.75750031990562816 -0.27625933053009949 -1.072525282927419];
  
  % Layer 2
  b2 = [1.5416683090101166;-1.3456911238701452;-0.53332017183388447;1.0764966522463681;0.92554293082000472;-0.60922941763321603;0.42139087599794428;0.60601897461766319;0.4029351887872662;-0.1692499462550919;0.42395250789105743;-0.83436061944688056;1.3549219247267625;-1.5194842813348655;-2.2407795372587902];
  LW2_1 = [-0.58897243577395542 0.39700084213524583 0.46220580608017164 -0.024359666044680553 0.97881654234634452 0.48708731228164753 -1.7429519212243065 -0.23298530935318287 0.10253586821397327 0.53694630703845703 0.40574093302892184 -0.075139280047308854 -0.54456353083222353 0.18284326723018121 -0.78633337284169136;-0.086945381177169961 -1.6307876323114889 -0.09904051896646876 0.056222525968761164 0.85782941490288778 -0.81067037852732637 0.76741277356779414 -0.25676573892422899 0.0064193246696395145 -1.3921987038500592 0.023606741886853199 -0.22705279760143351 0.67381332968219398 0.72095067575011595 0.7247125076719384;0.26618322260625354 -0.60032176672909143 -0.13554289476128895 0.2751339624014259 -0.66100021391721209 0.63025101020893526 0.79401067757692434 0.37625368459021008 0.84365420140628822 0.88730453981395263 -0.20901339897236659 1.3822088454536792 0.6041861660972887 -0.25244591185181509 1.0321081963734231;-0.81337926693003404 -0.30167822338790873 0.85393174694910401 -0.66828642276363259 -0.44403137014416622 0.34334383351007242 1.8125903357270106 0.40435499211409626 0.75600505971859988 -0.5707348178671543 0.99677803846495727 -0.089196446034258622 -0.63553997421919806 -0.83948346532774898 0.70593140517685449;-0.19578088793153992 0.071307351688521703 -0.22255396941941899 0.35343343972979868 0.51294732451285852 -0.2754242186967395 0.51915326813660423 -0.93400082298902298 -0.47569085707313929 0.15418625959648927 -0.34676441531004881 0.86724912932014464 0.48003914725068408 -0.14484467582143234 -0.30600917994546367;0.28599928405277464 1.1479977277250537 -0.0036618089746242458 0.073708892443240484 -0.39571625751940276 0.45309685455610876 0.95147701945043006 -0.018695936736437508 -0.0094949782199510412 0.28207242804650007 0.41663212596140214 0.40243223920139337 -0.58767123458972703 0.45462153801538085 0.20819569837022192;-0.58206801284050347 -0.16592724528295183 0.57479765162521079 0.018687432527456013 0.27497893610992608 0.68611429077892383 -0.50242221304412993 -0.36279577696597581 0.23544297876262912 1.8828711365652013 -0.41920459206008648 0.60098717789369882 -0.030422081535295221 0.14279033222491122 -0.039988291387925048;0.39912387135490135 -0.44267082307079325 -0.39361341407356559 0.64074545519307591 0.77965739084592556 -0.18721989066873918 0.51003329340138537 0.38483993077221956 0.14326388485016694 -0.99037531359457232 0.86054802449194545 0.31536833649343393 0.49309950493479132 0.24042249511806379 1.400458171019004;0.24605342124698668 -0.26707015451080857 0.23320704814977311 -0.34120995153538469 0.80079654749137541 0.30940645899902031 0.026090366615660585 0.02917152749881477 0.015102664075461181 -0.2606251301839479 -0.64781947596943967 0.0051463777737446679 0.24293389368088938 0.20209020485397458 0.88358064682973281;-0.14425228155346598 0.48267472053782967 0.27822063164966476 -0.67896732959812822 -0.3357600525531137 0.46279937841543811 0.87269198612783316 -0.47122160102855576 -0.0041598969721385499 -0.72302277152944361 -0.39051124327031728 0.40717900847409116 -0.96929696488565764 0.54537352712161569 -0.18285900691004647;-0.93329184844951185 1.0067612908175891 0.88776201249538789 -1.1687037893062857 0.13042284268454507 0.86067868706617467 0.18914645814868222 -0.90101722535692463 0.055467023093378899 -0.38847038579827237 -0.25043855349713939 -0.28711392149679504 0.17598544281165687 0.46951159014177191 -0.13861019668175431;-0.069148056924639559 1.2249472284334417 -0.16567845126369618 0.57129817415455186 0.48412176038311733 -0.89065603265682503 -0.15901380652052721 0.050687426737282923 0.73249843317947427 0.14310321658501082 -0.93015815565101001 0.21224480969697682 0.093279624165201663 -0.51643914773711097 0.58298230770338677;-0.091499648918995022 -1.1288639565552419 0.1279616242014866 -1.0609963115172978 -0.92822715425648117 -1.0153465171687635 0.41636149922728682 0.1440348663755639 0.62178884203305751 -0.2950565604872456 -0.93674796523318504 -0.043078946260566069 0.85376358317813217 0.55614805885069651 0.83068075667535513;-0.96423902043231369 -1.0305790778320425 0.75796650602802218 0.3356260805266435 -0.16982159265499397 0.76751266355953818 -0.22167146570663879 -0.32708868861994167 0.46376595470308823 0.14875436766796873 -0.92820320869991169 0.74474071781195306 0.36455563439801419 0.50165044317236884 0.082123829656734468;0.21855684808996542 1.06044018580813 -0.17991257482837009 -0.40316324347648119 -0.75090358690804149 -0.35348175067840293 -0.40559031792058214 0.60365838452587495 0.045688374579120082 -2.2980909394301854 1.0917472245400541 -0.24216302484685293 -0.67134217560231568 -0.45964593196048148 -0.3608141195913987];
  
  % Layer 3
  b3 = -1.268129986090355;
  LW3_2 = [0.59903984011347111 -0.82560515082999741 -1.1442016562980317 1.1242428858029443 -0.56204249846901777 1.0597031686789633 -1.9830908906163893 -1.1860705245371488 -0.27851109385593131 -1.2619432462397664 0.54937121609820794 0.14526893360968596 1.7572328127512076 1.2372663730626683 -1.436699200482829];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 9.52380952380952;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
