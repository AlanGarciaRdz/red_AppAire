function [Y,Xf,Af] = O3lomadorada13(X,~,~)
%O3LOMADORADA13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:40.
% 
% [Y] = O3lomadorada13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;17.6991150442478];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.8136484515095521;-1.9622276104006926;-1.7892910418541894;-0.2158092712936657;-0.75595824341758144;-1.2876290886848123;1.5284093958078526;0.29928156295395486;0.82495621755589399;-1.6237080211086667;-0.89708838412322123;-3.2936060940989829];
  IW1_1 = [1.2673441731344277 -3.7813007429006067 -0.62819963941718227 2.0660431706910569 -0.47081763878398852 -1.0981179165777859 0.19875966804422132;0.42882210784108926 -1.0496462621868301 -0.76208065320210594 0.6802699646314595 0.80564191102177363 -0.54370306760795639 -1.3633141561114053;-0.71159611303592163 -1.0253635350307047 0.42650581029436574 -0.61821394766210935 -0.35548069317660558 -0.14828760320844075 -0.39994282835022271;-1.6435070885438565 -1.3431649922970283 -0.16839408821142424 0.46211927115645757 0.1312818988717433 -0.091312524423174224 -0.16856604236927633;0.65735630983972237 0.37557000962655313 1.0695204459159562 -1.4445613258755647 0.45427521408045407 0.13390902259681542 -1.8039419087011117;1.4854062443221239 0.080188389930031537 -0.10242514707242895 -0.041033223829446588 0.41637401974076776 -0.12930445333193111 0.30366202910851053;3.5549504485630998 0.18487820584471767 -0.46417055216912934 1.2639995879122676 -0.39187786151942 -0.23804040420542916 -0.87410941073867099;-0.073840669143072704 -0.0003850621883696977 -0.45920216957197485 -0.61142742265494443 -0.66766492403741218 -0.022048600048381745 2.369870836272943;0.43769672193876502 -0.87580764046164095 -0.41064845066327627 0.66861085974922696 -0.074029447917243918 -0.23765024349074912 1.1602985975094484;-0.88498354340818819 0.37435742298967661 0.077519987094993414 0.55249112305046688 -0.2473566806469536 0.38883480470502563 -1.1734504947397055;-0.8198872992204479 1.6012277135203488 3.0638413586757673 -2.1261022684272493 1.2661620594712304 -0.9827927132306814 0.62156097346468187;-2.7505499486255127 -3.3181746406272299 1.9316051519384023 -0.68429387525700025 -1.5737318753758172 1.5718242191219753 1.2122735115364303];
  
  % Layer 2
  b2 = [1.7384518206246586;-2.0256271023160961;-2.2029978812141864;1.6877599620678105;0.1223802285200191;-0.12476211807792495;-0.45745790530694147;1.4683363299277372;0.63686049468566297;-2.4476347372682921;0.45650863172242628;-2.1666317602093552];
  LW2_1 = [-0.10147091441845996 -0.25325217126901978 -0.22888875835154604 -0.37241824914403759 0.43870432778406981 -0.7276516850193403 -0.097567481685716106 0.56243362133607178 0.45227953309298774 -0.63040658895219237 0.67048516137986258 -0.80204922871075157;0.32863583803809127 1.9162374428803948 0.95264991337899996 0.36534147294411118 1.2862380253986871 -0.28413371075294486 0.45811292601276571 1.5302371250985156 -2.2162813398307315 1.7710657224286552 -2.1254174661178493 -0.45451373071810974;-0.077892017788817061 -0.024866375789929486 -0.57198521698649218 -0.27109560165382213 0.29350750440261597 -0.76172350577192316 -0.5864039336943252 -0.2830037010285103 0.77754429936938674 -0.16680994496401333 -1.4107621785323512 0.64877650271506726;-0.86662868642018498 1.289884716853773 0.5131374242790383 1.5650346402194582 -0.69884218607934601 -2.2001688360182428 0.55898827265508322 0.61504162016000585 -0.70681312558385045 -0.10603694081605669 0.58963989536466044 -0.74186372266286671;0.55174814400666139 -0.58238852376766426 -1.5274156108028762 -0.89732122218162036 0.72698200469765684 -0.78863445201180415 -0.74761329495941964 0.3397376085277477 -1.2934803644990409 -0.32199727345685597 -0.53480660852793072 -0.42695844381613551;0.27988126986554462 -1.0801867086234398 0.23578027115792199 -0.45761916744118991 0.91073345770141323 -1.3404563665885845 0.13932888876042568 -0.77333260559814609 -0.16344841923946055 0.15961780388100555 -0.52028213163727033 -0.53828925623700574;-0.019134661928164556 -0.25515290760040082 0.9365078177605981 -0.55424726693364623 0.37961793334256833 1.055451625580768 0.22317682322610127 -0.58907090663271788 0.8745039893697012 0.15733222012253498 -1.535977607206471 0.52139220995010171;0.26431465144241656 0.12991830609574914 0.3039045548888471 1.0275076512337515 -0.32459594286260868 0.72146802103055663 -0.71510435725040911 0.31970565848402482 -0.75239691603057979 -0.015659249965612999 0.1206685487551159 0.47254675559457188;0.3742202822660266 0.035679129462626344 -0.89172019777160716 2.1024352006184679 1.1613703206188997 0.51934967204035976 -0.98521795003805723 1.6112413426142744 -0.40796287203053083 0.87987150542898085 -0.060090032814202637 0.42638818590210908;-2.7663717498067619 1.366821932168709 0.86981663688739896 1.6963512641385441 0.39477609633854044 0.60517294269456456 -0.24310815924872806 2.0959548302008564 -1.3887008126301805 1.6555891919886181 0.060024677405999795 -1.5068103262584405;0.2300962819780745 0.70770753174642032 -0.2001631702196548 0.85903950364358328 -0.9198771722466742 0.81344673484804197 -0.094095913766356135 2.3208880589944241 0.48849413353145821 1.7034848744512177 1.0272348733991872 0.52527306705182097;-0.37765233803450271 1.3494412284959032 1.7413199925432477 0.14339697048966932 0.57442833813463345 -0.08062628602326441 1.709639188941271 0.58445149270273322 0.46959758734266333 0.80863912332377874 0.056985677711385199 -0.2638296559473679];
  
  % Layer 3
  b3 = -0.71402530518109009;
  LW3_2 = [-0.26673954829122698 -1.5919087114491721 0.90426522224454142 -0.7418710503552739 1.5582061987503188 -1.078474329440938 -0.53375220941838253 1.9837435405191652 -1.0056752844084196 -0.74333081772702336 -0.79312041195229477 1.6272039662179609];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 17.6991150442478;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
