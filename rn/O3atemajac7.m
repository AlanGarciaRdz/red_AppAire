function [Y,Xf,Af] = O3atemajac7(X,~,~)
%O3ATEMAJAC7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:35.
% 
% [Y] = O3atemajac7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.201288244766506;4.04040404040404;166.666666666667;0.0561797752808989;0.00614628149969269;9.52380952380952];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-3.9029409823423205;-1.4044869190612221;-1.8555260012190182;0.49048929028187321;0.67139261172197306;-0.38903434005052184;-0.66020187659712914;0.91173800618710854;0.78992867310139758;0.56483518054248549;-2.1940071745606207;-1.0516367035727936;2.7267138843162013];
  IW1_1 = [0.088894366917168968 -1.3628287587088319 0.52610859000999488 -1.2888464492134177 -0.49237194583308092 1.5599640406896385 -1.192617599863808 -0.28146254651253716;0.98720623745924196 0.78896853094482722 -2.3233462546552017 -0.78629853405587469 -0.2456103506974123 -1.7913382982011858 -0.10087947802073643 1.5632981070421372;-0.53610049080434918 -0.49582902469586226 -0.26341651391566173 -0.23996371111824938 0.11063410064532167 1.2066793558450537 0.19935538435713823 -1.6781315640484131;0.64547619350504781 0.17758674341796196 -0.28900320329819246 0.04017976223435453 -0.15267221727062502 0.0078269942186585603 -0.092101645402364318 1.4149790385607701;-0.17147783798550686 -0.93037282578767222 -0.26032562227337119 -0.61581103245035329 0.5290074772158172 -1.1423845952712837 -0.44967874953749132 -0.077540519507471942;-1.671956051324955 0.35397959453692018 -0.86645954913725465 -0.42003063907277505 -0.23135789562540357 0.79119222365931863 0.32591300484192925 0.091025041490366831;0.83620688927725539 -3.7374162432733127 -0.46800855566232491 0.4804029306564252 0.10694122285296973 -0.6492187965641294 0.18961195049825602 -0.39410169247126736;-1.5982711357949284 -0.0093828327089222844 -0.24570354440487926 1.0267873301853505 -0.25427815554062105 -0.1048529974856614 -0.14991319775625239 0.85529922211530318;2.4328629212303583 0.0036451801753710524 -0.91690592622614642 1.1592126887417651 0.51008378468826299 0.25862646263811573 0.18819604142967994 -0.589573494769423;0.57918812809803799 1.5491826189293312 0.73713250824352361 0.76432622810835649 -0.10938309611605236 0.37158786757063172 0.056437216598243495 0.96132159408042706;-1.542190039855049 -1.3215408031916196 -0.84051223360120964 -0.61359629425924456 0.62229683793723956 -0.71046754250267874 0.14113075876272893 0.11425808489750047;-0.058471621893485856 0.23720604470792969 0.31815432355510564 1.0440119993932366 -1.0577628432803032 -1.3814866845746401 0.1792070602651217 -0.95807485900882239;2.0418978155746084 3.4862555861070077 -1.0123922884648813 -1.1646058789526397 0.75988575046556617 -0.11494271482094109 -0.22864924002885417 -1.0314689027204049];
  
  % Layer 2
  b2 = [3.2978362544776991;2.102829616939573;-0.34311084106685424;-1.2167028340047816;0.86331890249043552;0.30577974063744251;0.62436002640353627;-0.66728784466438174;-0.08229403512762104;-0.52203639659938361;-1.2373378217608102;1.6688837676815744;-1.0651057665283314];
  LW2_1 = [-0.050953613288271041 0.10601643673990432 0.68197039305227725 1.1886193018439415 0.73790695900746939 -0.80385234908538206 -0.74363740978285364 -2.5685045424657913 -1.9609671936523383 1.7746509333472207 -0.094123114039622036 0.58735338693379102 0.034218033175624663;-0.78741687852009967 -0.47160900776123882 1.1570051906389323 2.6049107093867696 0.43941527301294447 0.16772676306851075 0.061992485484539714 -0.96353308804355575 -1.3114802762691682 0.43000105507651532 -0.28214774292488043 0.9021881197981978 -0.086359474251396673;-0.30456722484853166 0.55378893201437107 1.0444394470661009 0.38797213491407195 1.0737521742054266 0.017070255598465256 0.62152379464381002 -1.1680170799683034 -0.29831112396577336 1.3162022413603192 -0.97133967772795027 0.11404582191035308 0.11924895404358472;0.41845524103084086 0.37409561607245384 0.62929007782015733 1.1385048660702644 0.24188334729452601 -0.19108943292469466 -0.11533149256115419 -1.3853915562527062 0.10258677487515258 0.89090726574520096 -0.26885792544331355 -0.1438495219547499 -0.98607230365808229;-0.81994748419968966 0.070960092891613299 1.1472843277096798 -0.72003620145559499 0.46561521895937813 -0.36105850040647974 -0.12635979544405201 1.120408357094574 -1.0352788056098026 -0.07258023037212806 -1.3246175955204795 0.40245852307005403 0.42071525626055423;1.1073946423369749 0.032741329168593694 1.562600711824585 0.48614425409676132 1.1111546324351511 0.24479763341454977 -1.2139453839174676 0.46572905760906147 2.0188845129846338 0.47912791838440594 1.3108494273003255 0.30152496511025495 -0.33630245490429955;0.56343628446909477 0.6677942007119696 1.018216042507212 -0.52419336183621357 1.2305826001109177 0.12189140267461308 -1.765673108224308 -1.592456674003887 -1.2976460248995021 1.1789338737626602 1.4534863539991592 0.50750467520202958 0.48299142082377383;-0.49916098739314091 -0.98760906458362541 -0.82118470063113813 1.3380523374898499 1.1862533010957523 -0.39791251980134307 1.3200343345969561 0.74408501405514194 0.87854499427797939 -0.12501302625303043 2.3070970022250443 0.44980813387875185 -1.2699119518695703;-0.57880513139281664 0.022798427322346063 -0.46940207457828798 0.22640087507158957 -1.1311584133661465 -0.30882851750217488 -0.41308658661829634 -0.35917004551521842 -0.94022471414217146 -0.0016742752654330534 -1.3862060047083815 0.34252811482532164 1.9825776864350195;-0.59670763573931318 -0.33991891259000656 -0.48726909684675418 0.87620922334619245 0.17923397060065641 0.76979865055140984 0.76218921538229412 -0.87334878093602664 -0.10550118875470058 0.38179172168918385 -0.78869065761764223 0.1521275075429149 0.24419851244924415;0.17963494614741743 -0.75348782720411545 -1.6810959745788581 -0.11122756512399953 -0.26172756314251572 0.84920443745533025 -0.5185018718885771 -0.57412686470298802 -0.10500414587296424 -0.1974637004397759 -0.37299975116828998 -0.01411333317021931 -0.37194169191065263;-0.14315642274311211 0.014450523573534392 0.080470265498271965 0.62198188207879268 0.14356063658686311 -0.36178519232535145 -0.67722626350046788 -1.8236551764754141 -1.4190394836936973 0.70747307861784514 -0.48803004530536315 0.50806981314108568 0.33011614870045908;-0.78018775151088748 0.23287040812517301 -1.2277194515790337 -1.096948835326091 -1.0113459122489696 -0.092159471894358733 1.027440946145582 0.25146012083173708 -0.64935687292669453 -0.68264459885275375 -1.0737145062415245 -0.19010166471687676 0.75303807807896073];
  
  % Layer 3
  b3 = -0.7734390132769382;
  LW3_2 = [-1.3565143994170066 -1.2662700455747955 -1.1267087314420257 -0.94711298708771441 -0.7327975235259484 -0.82540567951651123 0.32280366337152822 -0.38737331026562044 -1.068229667816925 1.7451178184691554 -0.90520860585994301 2.0762011065110531 -0.94354178462101124];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 9.52380952380952;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
