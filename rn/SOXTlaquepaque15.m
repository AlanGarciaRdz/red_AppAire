function [Y,Xf,Af] = SOXTlaquepaque15(X,~,~)
%SOXTLAQUEPAQUE15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:00.
% 
% [Y] = SOXTlaquepaque15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;3.03490136570561;14.7058823529412;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;35.0877192982456;117.647058823529;27.7777777777778;5.12820512820513];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.7701324657804218;1.5805459434062006;-3.0059755300771016;3.4536862237665242;1.090481722362133;1.0675828573103281;-0.58042717340697303;-1.4201403398911607;2.9670844487747425;-2.1426963915915227];
IW1_1 = [-0.10646743428100572 -0.36769400860250767 -0.74036833739432706 -0.26611870622043166 0.40935991461615029 -0.05119266574650088 -0.50260682378110033 -0.77536049533800278 -0.3833219591451773 0.8007683619377598 -0.48962342987541857 -0.76629776420437612 -0.46675884227957914 0.40175400246745929 -0.55198434961857257;-0.14664793516799601 -0.3847868989368059 -0.47805170622757126 0.19976565059165249 0.14577601055067205 -0.44797495100686291 0.39369571038780421 -0.49641284572054845 -0.45392977532358697 -0.093176186120194848 -0.77865162281025724 -0.50170717148122768 -0.7700173254423287 -0.017084097038479681 -0.7032358147891149;-0.11148678437034344 -1.8356368106611534 2.227349127011947 -1.1140861397391268 0.26149232650793208 -4.3599396066765488 0.32782436268550069 -0.97509317149522845 0.61691668952035883 -0.069312715794020485 -0.0043177815113228241 1.9275625318503526 0.6713530737880069 0.30695850185771728 -0.45508146625899637;-0.88795848920575027 -0.38149773033684226 0.57225900491224035 -0.62199844233085422 0.061577418523002608 0.80968396884520599 0.39803275040894187 -1.0123699811469367 -0.17793186909729442 -0.12355896653448357 0.10157259578990843 3.5466024589516749 0.10611193791434295 -0.75150076782431086 0.82631638931725959;1.0190361930608121 0.51728471868924653 -1.9138664100982292 -0.96909670408756488 -0.21673021606463988 2.5231004378381137 0.19454010833378163 -0.58613763142321318 -1.3318469915699023 -0.22616163959639904 -0.11334907289681553 -0.0078219220278204632 0.25624443316799977 -1.7516840165585812 3.0224566273081348;1.4607123597629212 -1.8148933387131141 2.0585696734347478 0.052076061199845119 -0.32674397099902147 -0.71259251778610067 -1.065165411086096 -0.37057199978810146 -2.1274671059741483 0.2062319345197037 0.59371695551537063 0.81301890217219752 0.74596160345302431 -2.6056620109675208 -1.2687152809252922;-4.3217533538078579 4.691584758126278 -0.42306468092348937 -1.6729452414149053 1.3743613228025631 -0.69577062277920831 0.94552984619429314 -0.0056393008797825522 1.8069406105910089 -0.50641484011406213 -0.92893333584737892 1.7987229111843208 -0.23635635147318657 2.4659351174813415 1.9227875957934157;-2.0493611780530001 0.34475866032426511 -1.0079713615010344 -0.11110071472158006 0.34706859171857396 0.038219106263218727 -0.061419037074394965 -0.05921036818937965 0.010783735108504319 0.14453153254613166 0.10116088865256891 0.26033074465483486 -0.55665797597524613 1.1919353467383993 -0.93891794716169474;0.69596970423872007 0.40043512132546971 -0.60570557789761081 0.58808713346019981 -0.071775455150347459 -0.76084685392181983 -0.38565460734267532 0.86973521998867842 0.20860394021643969 0.12416865580026044 -0.10045431482808431 2.8763079892692938 -0.090874514390872518 0.7475296689471943 -0.82264471834406472;-0.61117782757826677 -1.0151512593587346 -0.52558530650050261 -0.0076933658995906526 -0.42983752250595697 0.96142483866733086 -0.26247765673690915 1.0837738960000805 -1.1501942395045393 -0.19317596627998607 0.45547717292782014 -0.25081356054618192 -0.42706079685670562 -0.34622570302894984 1.1682585159944276];

% Layer 2
b2 = [-1.7041012624944467;1.7211418797862024;-1.0496915023049394;-0.1080089530910664;0.51903216468861602;-1.0820635100045353;-0.68446953530360244;1.3607095054809921;1.2478214342218275;2.0847804505316905];
LW2_1 = [0.56013992500887044 0.090104664541189108 0.33447875583108239 0.37775049745862832 0.30297887087158648 -0.15713633318802558 -0.023043055365963974 1.132587928146227 -0.41037131041258962 1.0122684749231041;-0.16498771144686111 0.84778462188634363 -0.3299942876142492 -1.005149107223571 -0.26442843732648635 -0.3344194589285876 0.67801692845027384 -0.48369283112058936 -0.077532081284276647 -0.86349990813874999;0.53098694605978425 -0.92430674600414109 0.63905747244868838 1.3651265099298893 0.42884351140692023 -0.46349776907423357 -0.27106541720106075 2.0626417608255525 0.29860496552417543 0.43345994312933667;1.1731420318005539 0.93748171580498241 -0.83278685036233902 1.5650606427758869 -0.65109535895224302 0.82587663438690817 0.71124729984872481 1.0710032413186816 0.62105095572940716 -0.59811747954591532;0.35386058192355058 -0.24908804079980937 -0.22660931245978391 1.0324519877130127 -0.1039655286711442 -0.084307922785894274 -0.10882003295015664 -0.43012205167803402 1.0740436338538668 -0.42589405550891724;-1.5551537871855168 -0.98287856243249494 2.8512389828104747 -1.4067115381908577 3.672963997504672 -3.7162885344858569 -4.5434752290869707 2.6827618105655491 2.1952895868374531 0.48849547883883565;-0.59158596342711833 -0.718569923948849 1.7545329686895232 0.16912218876522975 1.3654750715532085 -2.5290039974365266 -1.728492549529868 0.3491003089698636 0.77989790866457964 0.62063057183673187;0.85695872200438117 0.41076210945812514 -0.98057941721143571 4.5486192197724673 -1.3153904259454845 0.57871396176241452 1.3395576660591355 -1.2066007833879957 3.0583279941644537 0.46789042734561409;0.35340153100884242 0.038270332313478136 1.2215411545230892 -0.039192493782076676 0.32209031038516078 0.21051621924555072 0.23937215700862413 1.4165671376468769 1.2630678609307213 1.3639132978857391;1.2310215133891715 -0.38800979299437927 -0.4635117120200255 0.41626904179604574 0.35812093165441455 0.34212927130731452 -0.58423469519875559 0.77505986014977535 0.55346616028340356 0.059697150903792698];

% Layer 3
b3 = -0.41051585365601129;
LW3_2 = [1.2981557865108622 -0.42326186442119523 -0.2145852753619038 -1.2389823738762471 1.174556798008505 2.1180228494636966 -2.3348338041618342 1.4442176516552798 0.065199134872346784 -0.54064396223729871];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
