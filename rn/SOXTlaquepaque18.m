function [Y,Xf,Af] = SOXTlaquepaque18(X,~,~)
%SOXTLAQUEPAQUE18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:01.
% 
% [Y] = SOXTlaquepaque18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;3.03490136570561;14.7058823529412;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;35.0877192982456;117.647058823529;27.7777777777778;5.12820512820513];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.7056165608616063;-2.8257229629365943;-1.839619879149172;0.2674585858888458;-0.2158287145953646;-0.39641323578322368;-1.6369051610256466;1.8235081720627049;-0.25414272721561831;-1.205301306745532];
IW1_1 = [0.39280730699831545 0.27717256279824631 0.61445714496689008 0.022367665981930338 -0.057575080397429007 0.55572740072809212 -0.70773235302525306 0.31833662018031367 -0.016785618998067076 -0.047963037162253551 -0.47020835425097673 0.41612708142002786 0.51527832396939566 0.27479674038423596 0.54210506952921533;-0.16614499714744313 -0.026115387563332274 -0.017604048329859474 -0.21025705227506425 -0.13382173614020401 0.182939374799719 -0.071391415351788612 0.045382565621530993 0.030280553681441683 -0.011182340173362457 -0.043945593579149858 -2.5728255160222693 -0.16436256415307041 0.05141988343008852 -0.10556286207164517;2.7326566143024924 0.3088289056095721 -1.6988676150243849 1.4875692632058577 -0.13113151979733753 0.3109687357597512 0.12826407189695629 0.87259742233654691 1.6696097790500495 0.35293773323759187 0.31602495151412363 -0.19378758683844813 -2.1503938457991802 2.0572981881934558 -0.35239002082043697;0.164997070009825 -0.27824130008084785 -1.1321817990026424 0.20846801708673801 -0.11657748543965997 3.7562856820523591 0.67798954107750242 -0.81527201387523585 -1.9621775557064174 0.4252520399595931 -0.34075477632404472 -1.137011612871049 -0.77710466186245652 -0.27662139987280332 -0.35068086987132502;2.8796571987532888 0.19194445284505862 0.15996105389446053 0.63705288127589033 0.25738852333654461 -0.31419830315958824 0.58423055851894201 -0.082616265012618845 1.3596074820581237 0.29403021132549284 0.22967225841382771 0.95608826497639143 -0.64196527956650751 -0.0055239045178055585 -0.054490978062128687;-0.40146610397534493 0.050565967500393272 0.14528650871925636 0.36027545618980505 0.095660622776480408 -0.92441458517387542 0.31803434311996043 0.017723927418435075 0.57797357930131443 0.7044364279502402 0.74347746169939022 1.0881016164372217 -0.040318988259145844 0.88564046188035439 0.14805220827736079;-0.13543342087956597 -0.50539253369939741 -0.57117531817374223 -0.13202524243950764 0.042082253049005917 0.27029889119546346 -1.490692188180968 1.3037051328432079 1.6435244138466425 -0.32547187792988402 0.27651515811007232 -1.2861807168865675 -0.90853201600852818 -0.46437508913085745 -0.99603979752081362;1.1040957102249065 -0.25355665773164898 -0.25694955151763427 -0.0657286967926074 0.19900137793910372 0.71330546145623464 -0.05806878767549923 0.86338022340975817 -0.91805969120369735 0.078899156289122876 -0.10839518346497548 0.4927526239967509 0.65190811302230856 -0.4692879145792701 -0.24781094142745627;-1.4013403434999527 2.6099536513750499 -0.24751544132757325 0.3678108094876848 -0.80280896586953909 -0.7242488593915315 0.42357667415181399 -1.1890695537622951 -0.43911807227520649 -0.08003777039097984 -0.018510630849283411 -0.58399957734348307 -0.282329945939649 -1.0968862968818114 1.4183718206165241;-0.72552726937615364 -0.02402571162622557 -0.18133161441084444 -0.39427926708750838 -0.41607080834513482 0.16188445971418855 -0.2382357271213896 0.21191503367938733 0.36343854170552597 -0.08143095314481455 0.025985606843307991 1.2257430450047004 -0.56636495827203581 -0.32952717989515001 -0.20525650453867306];

% Layer 2
b2 = [1.9656796881246681;-1.3791610225308801;0.75213848508107051;1.01145624323395;0.14520058129095204;-0.63784158812303804;0.128703289947351;1.5557945781598856;-1.7697352642314308;1.7723863920083733];
LW2_1 = [-0.3719169024852238 -0.6524107180520996 -0.46655932894785473 -0.95880735221489166 -0.42985717926397982 -0.56354926096016078 0.88092685345339961 1.7456564946591746 -0.050519004100260528 -0.42030220644485711;0.88414149546004961 -0.025150981072461973 0.83817803328572027 0.26905632782251859 -0.7119293715813082 0.80956651241975364 0.026349611077297157 -0.38218639678185029 0.55259578580226609 -0.056740017130664067;0.18920674141626176 -0.45989389303144007 -1.0279745575725781 -0.60480110812194343 -1.4513918375202557 -0.88033452844667448 -0.75116987182054218 -1.5404857528064402 -0.14774656925926599 -1.214104065147986;-1.0665302205440474 -2.9665276097871747 0.98573105998512234 0.16737097835696568 0.13891476340055106 0.1645881719935256 -0.14317160470128035 -0.43485007167278134 -0.12332898991195455 0.69148683231290764;-0.49917946112506922 0.22965685186336082 1.1326703789699089 -0.41816258770823223 -0.5156314782662702 -0.57383001474833262 0.69242999231200331 0.019010640514341898 -0.20859073344495793 -0.3041561930442081;-0.00039153070852298438 1.0783718891231242 0.37549354077287567 -0.26575129163273942 1.4849942893631922 0.13347321128561701 -1.5519001566429844 -0.057717001576431115 -1.9842290541108072 -0.082504120592981123;1.1764235515456367 -0.82146623510474714 0.14378302186444333 0.095639025862861021 1.0213737757570995 0.84875983710139613 0.23253088884071929 -1.9890101135457809 -0.13603730524130919 -0.90967944738174311;0.085008290698964539 -0.1839487870600138 -1.1611810847504835 -0.28048054803846689 0.21975536154166939 -0.21304202647550038 -0.41245456606905218 0.083398268337690734 0.37069153252327147 -0.7104300021853146;-0.34631520153638073 1.1071226565586221 0.39471924734533598 0.82377664718993937 1.4668607245171423 0.82798929320806647 -1.5315893620518719 -0.077936923781412246 -1.9763588834754353 -0.54578301468389523;0.59629017218012237 0.61509144354145229 1.2176137553807096 0.35586673922226014 0.50149251092180036 -0.33862919483574211 -0.82997999321570315 0.59185045277493531 0.35028007705602698 1.0645615811083231];

% Layer 3
b3 = -0.90061373439036063;
LW3_2 = [-0.68564049294166951 0.18751952933446686 0.36218878211484962 0.20595703902141052 0.35906149183045311 2.1671847506628508 -0.3482530965759062 0.0090720674432871601 -2.1805864587076083 0.26772132210065841];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
