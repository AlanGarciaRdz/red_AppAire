function [Y,Xf,Af] = SOXOblatos5(X,~,~)
%SOXOBLATOS5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:39.
% 
% [Y] = SOXOblatos5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.69457901694801105;-3.4599936390924633;-0.49927851673003421;1.9688227838515096;-1.4748607952326636;-1.8640348876400779;-0.44860729138800831;-0.33375145684330521;-1.6126220921637802;1.1888374135371109;-2.7303797725325136;-2.821165482785978];
IW1_1 = [-2.709832573532267 -0.15085201351496969 0.25630796176747273 1.4901807493715189 -0.27138251317467316 3.2134126835327699 -0.51986586141133606 0.68274027387903136 0.085150145685610579 0.23918806673056311 -0.79916044106235518;2.619854589594627 0.024939196137654433 -0.18489948460051342 -1.7549178470232722 -1.7970823804709246 -0.1612008172986949 -0.79994467421347693 1.3747401148094625 0.38395532940981786 1.0286470464572768 1.7043797627439028;-1.6337527069205611 1.8479502805375729 -0.84637268362091334 -0.73461624013376958 -1.9151757463799826 -0.025828200758596848 -0.10229764238920361 -5.0694670222044538 0.47247926834294501 0.43682818304917237 2.3294173028508962;0.13274922033820979 -1.6268391922619656 0.28360577199628267 1.0548648832566681 0.21391454658168579 0.45046368504426715 -1.3212817735166156 0.31910840429010839 0.40490421233097307 2.0289452797071363 0.51909669332918806;3.7205279779278406 -0.0641330701968401 1.6367126072059752 -0.89219421133159638 -0.1223843926670671 1.6197777877115909 -0.66190892823380665 0.2229527787449887 0.52389100705842784 0.18916706364617025 -1.306922792384519;1.805501757288311 0.55929773504193692 -1.7043599936046878 -0.23078574805544153 -0.42036743261697607 0.43579719061929778 0.56183421673738354 0.82881167403448819 -0.30486067464771183 -0.92314093903777972 -1.0353569449828171;2.1673388626056034 -0.041436523441569596 0.97605872793275761 2.3356764274059048 -3.1095515451648081 1.8846748914328684 0.11733213875441734 1.4698663220776695 -0.37679280210810256 -0.58567601953306703 1.8030992990126107;1.4314721108810842 0.060588489340703378 0.93344244946490118 -1.8254456540642332 1.0380356133901625 1.8087308826151807 0.73902346268667773 -1.7009349750107949 -0.54941149286009183 -0.85235394029705414 -0.64712582141288311;0.63782371038627694 1.2109957747981024 1.2733368573059178 -0.01627461351532794 -2.2186883358912541 -0.56221626111404965 0.11964469032190372 -1.2117251713091373 0.1672827499768304 -0.10272834317792169 -1.2438240258647069;-1.1513532077615818 -2.9174072274197069 -0.54156838380501648 0.60220799696297633 0.27171376796075702 -0.798816236826832 0.16068133850440436 2.5800893489136207 -0.69620664503835961 -1.2782857438517032 0.80008169226267778;-1.0261768620887015 -0.17319509587396464 -1.1579110244250006 -2.1113678889877239 -0.016225428222207031 1.2354951188277365 0.24520582171560454 -0.55441840816865096 0.3587633396246494 1.1536145913309388 0.049410401845743343;0.65771919952257107 -0.22218839485710506 0.85997791487839859 -0.2176612574796096 -0.11768376798036426 -2.4831640862034612 -0.17324817112966384 -0.49061818000572177 0.014587303330446215 0.26150642701421722 -0.17671310493335227];

% Layer 2
b2 = [3.7954562522268032;4.1375158910808905;1.6933005504833114;5.7965593906672277;-0.24190595965534784;0.53726699642543552;-0.81762494041932032;-0.93445304523288752;1.9742464835094153;0.24351441987148259;-1.7247002734735886;-1.9159027141143519];
LW2_1 = [-0.17472297968994199 -0.3510939288909205 -1.5525970148362416 -0.37218507262788048 0.99545044019104967 -0.27665243704217141 -1.6892448332991719 -0.61924336025996951 -0.16057144268996268 -0.54542295258780171 0.4636126696016673 -0.7410242338395383;-1.0058206529060463 -4.7465233414453536 -2.5485557185499217 3.2585353434303146 0.81121681423827263 -1.3922801949987116 -1.2569397339152899 2.5879195504653882 1.5766004033100458 -2.4092993549422594 -2.7629079879092027 -1.0910333093027731;-0.53024015338897945 -0.30570112794837095 0.1168923933653528 0.045298968715342856 -1.0278590900588165 0.018704482829682456 -1.2357239818258823 0.35231746999239444 -1.1862427524969417 0.5467302090853875 -0.56656389056097711 -0.35891601079496427;-0.96837259914792551 1.3807574689241213 -4.4723505109376536 0.87505610638110398 3.1244888172879675 0.84863264684611106 -5.4225280805892826 0.50284765712451018 -0.37786966677254702 -1.6051938130242442 -1.2063036142825838 -3.263561750167689;0.87663851326109876 0.67368765301705935 0.49371256438098277 0.81770310381820188 -0.47158073202715328 -1.0553872431008537 -0.53670786682056781 -0.30534638914644674 -0.1074522917542559 0.023060977574678072 0.67163176276487213 -1.2247138800900381;1.4597385200757227 -0.13458480763268776 0.3396225397014257 -0.55265760793746699 0.1215955799977326 -0.20467135835335029 -0.47927827418541502 -0.56983244934502153 -0.38134831667916408 0.069786851586425697 0.92301617304648942 -1.4597060181635284;0.39517846993693645 0.20053135792490556 -0.084063057417327225 -0.23304680452339077 0.98258214644556074 0.16789460153816368 1.2646525545855516 -0.46091129242084689 0.68910025668635222 -0.75361477203057892 0.71496037328199136 1.146269221244101;-0.33919241252700327 0.084372061810845833 0.27772157464130742 -0.3026094535282422 0.84341899535529619 0.097698966591547171 0.83243684145976238 -0.49189270387381034 -0.40242724562963883 -0.060939871483705221 1.0906554957908527 -0.19237148576709556;0.11832908348805971 -0.24406999518974151 -0.01997556715226817 0.16631957186794985 -0.99099289653234945 0.7345244520173031 -0.82998884827254948 0.57317236925757098 -0.55143274108311768 -0.28650513230212088 -0.83152856864130054 -0.52362107711969808;1.3895015502475165 -0.17847870061832485 0.29437039086324468 -0.39973489113097077 0.15415848715975086 -0.45335230764884094 -0.43711434643695246 -0.4696219181876673 -0.14973016970475647 0.12666381883264033 0.6459393859235002 -1.7724464479967139;-0.41772134735820626 -0.38278313291022503 -0.35717298946681331 -0.33758479123514623 -0.60239100294698478 0.61074949442598903 -0.49277858952341635 -0.12438687491348935 0.11995830731529705 0.2640601172193755 1.3265696307975776 0.94897648357480624;-0.45402790161837314 -0.36977130294264482 -0.4806106349901933 -0.38817536876691022 -1.2816042235773442 1.3372129586884458 -1.9268281134723415 -0.10728780170428395 -0.29343953380117133 0.060198283280154613 1.8867514879122709 1.9607566412023809];

% Layer 3
b3 = 0.79643576393591686;
LW3_2 = [1.1438192975325696 -1.1981890306953378 -0.55069556687796117 -3.9807386461271235 -0.029643148700504891 -0.43360684655550175 -0.55150823296353657 0.11104861044039226 1.8644729574129932 0.47447507517137216 -0.7542650303976044 0.27758461281126978];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
