function [Y,Xf,Af] = SOXVallarta23(X,~,~)
%SOXVALLARTA23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:08.
% 
% [Y] = SOXVallarta23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;10.4712041884817;0.00782778864970646;0.0208333333333333;24.390243902439;0.02710027100271;0.00630517023959647;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [5.7849855580582936;1.0743840137829801;6.0389630321756673;-0.70577996015405076;-3.4333832618370197;0.70006109917257497;-0.23743374364103143;-0.72668076554964245;-1.0302805202502181;-0.52948250241372119;0.62987268122119711;1.6806942472644242;-6.8303706759045495;-1.9632410899508708];
IW1_1 = [-4.8369350757451555 2.7298147852030428 1.4972780742672966 3.0848523843531712 1.6122313303911571 1.8734572827361344 -1.0380918719236933 -0.94901862569584461 2.8873012901997104 2.8398448903434006;-1.8571627793608481 -0.1471631666308322 -0.71546546263702027 -0.32849702079671628 0.40645877951231463 -0.070659307903113575 0.2061179438125551 1.1953933947325239 -0.27511150390321226 0.27153735162127018;-5.3770666277947496 0.043450404589757186 4.4400647693593651 -1.2766112171874613 2.835575388875236 -1.1101883243555029 0.66858114243632194 -0.93384809906177935 0.4032961357894233 -0.5787820320742576;1.7754188367264607 0.15439282537037022 4.1751989141461863 -7.0162630958334429 -1.2926494146593164 -4.3157568563853728 1.1593274233314814 -3.8285709208691538 -2.1118270188106707 -1.1029388440904733;2.2801141963321476 -0.049685291263532959 2.2690884234248321 -0.20280020012668024 -0.004329021297667407 -0.59314133248543977 -4.4484706075152447 -2.0494739750067068 -0.10832594675570123 0.037786104989211117;0.34715221824623799 -0.23310837365826986 -2.2953969364855524 0.18183164635004342 -0.8695300322144105 1.6942784481523396 0.92831258759037039 1.640352840216468 0.63589643719956401 -0.08883818825910543;2.4831458631448036 -0.11736692091188974 -1.1010153258191544 1.3143965895423915 0.63661133298748795 2.4144734020419798 2.4265232821219724 -1.0901368246028329 -0.57226955062925011 -1.2178965271694884;2.716908497167811 -0.077859403136510408 -4.2769264399066929 1.1085595293200767 -1.3712475336114709 0.058134644018373982 2.68397233835057 0.11004697770085074 -0.16449710697776185 0.086356539136141192;-0.36850806359014154 -0.90133109262430622 0.33408816218517406 0.47273183418928916 0.39072290344615257 -0.14782564179849944 1.0946295005735154 -0.2219829464817038 -0.61418895718229416 -1.2417869252064178;-0.34832113783012614 0.17472969622122392 1.8186797286515892 -1.2394128962464679 0.25388078151942739 -3.5159457895784612 -1.4795664614750568 -1.6139750492312137 0.14332602438924097 0.75050843361850228;1.0691938501120357 -0.33623902147784501 -2.3504202895585244 0.28794389818293536 1.2047093070550314 1.357522985510166 2.6219437740163527 -0.25932329872208598 -0.74200129179977847 -0.73296531880829852;5.4064734152901508 0.16191478208414298 1.5196580926734631 -5.5072956598417946 -2.4359445630791625 0.64953769615070844 1.2951445582162322 -3.5926604904972868 -2.7631632051059039 6.4730088761033961;-3.3338060597844232 -0.027007022407434848 -1.4813834673431809 -0.39827202192311972 0.32697915753379725 0.4463870484846138 -5.1881610460863987 1.8900514140853695 0.040431638232541034 0.12795135771948166;-2.884285584551888 -0.61006487135685772 -1.0118483684450672 -0.34400192487273229 1.4386218829698281 0.025553034277123812 0.46855212498683335 1.2167921965673472 -0.48777677589576496 -0.45509201842560715];

% Layer 2
b2 = [4.9028113729260525;-2.8401806072188984;-1.737107857273279;1.0385355363956386;-0.16420394135885641;0.66667804426757349;1.0515181567999292;-0.68149384093223697;1.6556825437383995;1.1032966171408307;1.5740322105752844;2.1082270160502237;-2.4972669826347786;-3.8923288596796612];
LW2_1 = [-1.3982814292440517 -1.7929786873715619 2.0448910766565342 0.50692931632890148 -0.69261661244868766 -0.086854141491595233 1.7175844256703929 0.31252928289212645 -1.8892181912292714 -0.51351149720964273 -2.2295804798736465 -0.85933452042283298 3.6867507644861122 -2.4983274970227809;1.4098808004625922 1.9906645711253821 -1.755388355115608 -0.52797990962443864 1.4226447340453532 -0.078933063229741293 -1.8396609731351312 1.7305947496760019 1.7471710899054744 0.25840092824591432 2.0519472057274077 0.32979407313868492 2.2785644329807599 0.40175783729712172;-0.41444854861991542 0.54685763441306079 -0.41871376741548827 0.17985399288786186 1.3561456509370602 -1.7391535635978503 -0.052063120114087424 0.40852744674931402 0.2236197527278716 0.066096678491673985 1.155382804661147 -0.24919309354256874 3.7623913047165671 -1.9453259382424937;-0.3310475126434575 -1.6486253738683379 0.8391401024270656 0.3801862305711185 1.749347709145384 -0.24727859504320995 0.2422478811236719 0.84131237101695167 -0.77356393881856733 -0.32108765565431802 -0.77454723122590352 0.20348996235521363 3.5875988181130487 0.43362185417738675;-2.0499240912261483 -8.8393525848631764 -0.35878115676854416 1.1078670419722563 3.12575495828332 -2.2907543133623003 0.39257696636120121 -0.76550561646011439 0.22048988023303964 0.16669748575961912 -0.4325294859947843 -0.91138544332637261 1.8619588663707989 1.4749418342760954;0.3057166886897254 1.8635972789978008 2.6940407169651062 -0.19490596942784644 -1.100144900639902 -1.3792423806172045 -0.28903514394963858 0.990168344243881 0.097265704072580672 -0.0029386331533790208 0.83279048482406692 -1.2652657695296929 0.0024431786425645041 -1.5406617611033553;-0.61092985126770605 -1.7204087703642459 -0.60572247540337909 0.55425149461638712 4.2187995644931995 0.28586335379289374 1.0424929750473206 2.7223225881781006 -2.4654211836517588 -0.89412097854466244 -1.5129411161046356 -0.20878551424046832 4.0917299015080681 -0.19284588152804852;-0.27277840217549809 -5.5236277285603768 2.8461766769212367 1.2140868359808723 3.4918809882291573 -0.0020979019333630007 -0.78291134502013282 2.9451375632340535 0.92290800823674579 -0.4564540096752544 0.43414438941510036 -1.7798677658379145 1.7540452028225304 0.86965454445683243;0.83292194448535639 4.654277758055926 -1.8535661224931463 -0.59493542772780006 -3.2936018045565918 -0.95572037446185054 -1.0563212598580525 -1.9997384952179416 -0.2005629080249699 -0.73740850443385564 1.3153251337917573 1.2310937248947234 -1.5248255201712435 -0.66710668004596607;-0.41706218802861705 2.042847205738862 2.5066652919162196 -0.3871743834865255 -0.92966475902191026 1.8949223361031999 1.174088934127461 2.2910398169716375 -2.783434733291156 0.53118577164323821 -0.91549719438293786 0.23805559365087797 -4.1836752667263921 2.1800260280261803;0.33726033492259372 5.0295029592802072 -2.530143080058056 -0.98958853011469883 -3.3010608684206995 -0.21082537171779175 0.38238020903217235 -2.6169150261628342 -0.75103112846345244 0.18427446098888214 -0.10624207579398702 1.4846822405601459 -1.0081013886945209 -0.72419677132717641;0.51995982475300073 0.28331244696043667 0.83543446456613357 1.0007065533837816 -2.137775293152071 1.681336728705108 0.73615071555844813 0.12657781818661565 -0.8795011277880852 -0.19698562666299446 -2.3256127461569767 -0.97885596951136367 -0.90351238783918786 -0.77606079964193309;0.4472695237369182 1.5099913802152993 1.0914929266089461 -0.31266578376381449 -1.6574187806186389 -0.14401413821296172 -0.55300698775224311 -0.31762651806528452 0.97944580937784509 0.33081821942636636 1.0854199537844116 -0.082605752163224813 -2.6488316290130935 -0.82265116602512312;1.400168225276915 1.260061059266119 -2.3573394281531339 -0.42402300322925013 -1.3696351543013789 -0.34106368617042487 -2.0373307681409618 1.6478711666333918 1.8637338907467649 0.35236129598343313 2.1479247401205765 0.32262998448185876 2.7911473773321496 -0.22168616421729775];

% Layer 3
b3 = 1.2533972700038167;
LW3_2 = [2.6256009182065405 3.4965814490452134 -0.42951774618009914 0.16690154670269677 -0.28637806328784976 -0.073723780462700533 0.12309132219511824 3.6237567143023992 -1.630344657103499 -3.2194555535741562 5.1416260559340392 -0.26210194548603727 0.17663993938144359 -1.6932236459173045];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
