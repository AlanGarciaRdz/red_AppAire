function [Y,Xf,Af] = O3oblatos18(X,~,~)
%O3OBLATOS18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:46.
% 
% [Y] = O3oblatos18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.100381449508131;117.647058823529;0.0560224089635854;13.1578947368421];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [3.320179548216732;3.482850948121555;1.400247522515889;-2.7019657357590865;0.14797466491245923;-2.852965096933342;0.74388079513888594;0.60153702910919438;0.28961003289773779;-1.0476247092221378;1.0762658873392472;-0.55595990152265629;5.6464649507221987;2.8118448196863501];
  IW1_1 = [-1.7060139264487886 2.2062671183241398 -0.69959768972467185 1.0143059541328525 1.0306881489206345 -1.1450964023707166;-1.0979297565400494 0.28814133703810529 -2.4759187663173883 1.1451126802137055 0.99701230971247434 3.455374115387178;-0.83958473372148379 0.19018826416047288 1.3023460847634285 -0.011071070629976231 -0.21442888840391361 0.87454106431552814;2.6603371817321153 0.12549705131097491 -1.8009002080601748 0.62100375327694113 -0.35885597898569577 0.72367906066381749;-1.6984607310696807 -0.15227349205661708 -0.12043954608319873 -0.012425563765567034 -0.43528985808447529 -1.0771200318132741;0.23484824560348172 -0.017559047068466505 -1.675188741770937 -1.540017817663476 0.75114118930547558 0.40734145813308092;0.84006114307634761 2.4181489404268994 1.6482824826864497 -1.7830897933231895 -1.5692321881595834 0.30243736765345697;-1.3061329757772615 4.4992934723201872 0.70607300687919727 0.015971594228669755 -0.17194348267686876 0.03791522207398252;0.8594915868016364 -3.065745086848533 0.21748513154963306 -1.413456646376827 0.078275132765134037 -0.40786508422112905;-1.0349152124630037 0.2155755899540848 -2.2435714639992859 0.92414709356123681 1.0156797308421823 -1.2147120386130954;-0.14958405498174274 1.45299048530769 0.41438883036172153 -1.0783223540363791 0.35247298609461164 0.32760984790371583;-1.2506229684008379 -2.6758921936976043 0.26772791862465611 0.54340187305957899 0.47523498107110018 0.1026603725180414;1.4663999903968445 -0.29108312335926928 1.5992964738340814 -0.4351986703826089 -0.90268574986502192 2.2828226750957006;2.2870270826109573 2.3243526231300136 0.73366139351145865 -1.5954972053503544 -1.2930556779576579 -0.29719315292457443];
  
  % Layer 2
  b2 = [1.4379849298603826;-1.7248379587354818;-2.2182307507427592;-0.54210527303479239;1.8237736815346952;0.81021852560741803;1.0725384826521445;0.37328119766041218;-0.67811381226952783;1.2979711870888309;1.0484786173048195;1.5012398905708757;2.987364349810786;-2.0879114901146973];
  LW2_1 = [0.9665598901928858 -0.082233134848492789 -0.8271043770774531 -1.4700517163518858 -0.13844342706741652 -0.23181167131719954 1.1471540425405256 -0.72704016117541392 -2.2220417822913547 -1.6427977451832103 0.13107292714550028 0.27280732119251083 -0.20996120291749029 0.48521924591421245;0.55483185773488808 0.16604664466234004 -0.0028720435382883075 1.532990104019029 -0.62136613120950668 0.39255059041800489 -0.42271487366740113 -0.40050924183230174 -0.0051395011275534828 1.6376644077004512 -0.78807268038505196 1.0203872772707041 -0.50893029437583848 -0.78805301337364109;-0.62284872169311178 -3.3637200650095171 -0.68598777854408399 -0.4918506130402876 -0.34820922293120887 -0.79247825663116722 -0.75582097123179404 0.96281254441416186 0.5102638635406308 3.1502689699933764 1.2791913988626411 0.42404009585936298 1.1826290244714053 -0.89901833835326561;0.33521785665085818 -0.60629714466854046 -1.293932598944715 0.46213614061009672 -0.38659457812226189 -2.0671478224195758 0.24180538359580506 -2.539280850903507 -1.3166732553472678 -0.40485701723705658 0.27218847470069629 -0.74210544176082238 -1.3215906605671219 -0.24548009829345291;0.7775940511336803 1.8899542422861182 1.8145661244845697 0.58176027855749246 0.39627763997842841 1.2012234848355536 0.76592140342854698 -2.3236074035467338 -0.37658092259813464 -0.6740738056718556 -1.2697574948643979 -2.2216744093280565 0.22032441501223124 -0.93214339607219188;0.06091343117501484 -1.4455435095131164 -0.30741387832574929 -0.87721534278973223 0.16342655892011851 -0.19359009360718535 -1.5294095461387975 1.6400584521807471 2.2660899574820679 -0.57331489390843282 -0.74331036336959921 0.24414292896048503 -1.4398561829502554 -0.32292946379870208;1.4680101428931243 -0.18582806197526092 -0.45272682706711315 -1.3275680231170548 0.28438748596752011 -0.14915263038210741 1.1409958841987065 -0.6755949107939766 -1.8350587321927514 -1.4085779538995169 -0.27176445911235203 -0.037262722124113308 0.74106579434468733 -0.42896262202381552;-0.96518553655820027 -0.39589775789672743 -0.87712279479404331 -0.18346433966626624 -0.37816621777703974 -0.86128031009344297 -0.24441861967796849 0.92126945120368509 0.47844498492543153 0.16262578053110832 0.61793318292927946 1.2599944261859299 -1.4820368956398426 0.69983965596604503;-0.68824312491436435 -0.67072422748062344 -1.153145837128692 0.71545133585747545 0.18618177245633155 -0.9765066664354406 -0.033590407623913014 -1.3809473282320563 -0.94325910650710121 -0.38653899948540626 0.10792082280309256 -0.69372624618658307 -0.046603466698992187 0.57691557464085697;0.65781061939655838 -0.13837086249721156 1.9612905289051663 -0.52211262831411076 0.73224606831231698 0.15765714218617505 0.62115714108733699 -0.24311042287955303 0.30336074919633316 0.97721399770921702 0.85032966178213165 1.0778741420675144 -0.68715409318385723 -0.55702467982172454;0.61963744592305792 0.66447147310271881 -1.5379795219877517 0.17764917159856869 -0.40787764267860893 -0.25651491125822679 0.24780042680766853 -0.096123396598700533 -0.070984274987809529 -0.98117272569261393 -0.46727614439817006 -0.51441400210449084 -0.41796676836604679 -0.39166581700608533;0.74819103031500245 0.11260235447896752 -1.9852181017410537 0.33389698773172982 -0.92802807039915136 -0.37209324722376413 0.48869881319585529 0.32767897644028754 -0.29006853932653975 -1.0085541409295833 -0.26501125628752403 -0.18870909717530002 0.42203998279364607 -0.36848306082070864;0.70400927472086061 0.77332697545512741 0.42619411032582649 0.42848975298216135 0.62530052106981449 1.058952274648761 -0.27331256875536658 -0.28729832968463176 -0.60395362025875354 -1.514962693868215 -1.4749177278935943 -1.2087731352542792 -1.0685571059407422 0.39161523232391177;-0.68730796448538778 -0.45497904838548542 1.5259177558203509 -0.52833317339511154 0.59531077731931403 0.017884380585949017 -0.68505450789147804 0.34529736451815662 0.18102896551103204 0.75888911081694277 1.4216782300375652 -0.7897043924824303 0.59313032785301434 -0.7545298978857784];
  
  % Layer 3
  b3 = 0.82465936778925564;
  LW3_2 = [1.9905892328252766 0.46705102107895319 -1.1766598315181425 0.55734522208498727 -0.95927326407044455 0.7940073536357658 -1.7757468802754 -1.7490415376916446 -0.8304901443055448 -0.56894704725074974 2.00855801947879 -1.7045514962241421 -1.6786169125325785 1.0081036969733899];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 13.1578947368421;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
