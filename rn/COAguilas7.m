function [Y,Xf,Af] = COAguilas7(X,~,~)
%COAGUILAS7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:18.
% 
% [Y] = COAguilas7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;0.281968137600451;0.304971027752364];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.1388314208148296;3.1093323618685473;-2.0811710263011247;-0.79372892391509098;1.7949222526250554;1.3515305380483735;1.5626343039384214;-0.69575761757611942;-1.3666948191807573;1.4889675922162067;1.5996027448201535;-3.4915013513172668;0.46808721606354409;-3.8249541285844804];
IW1_1 = [0.74292787080054079 -2.3265566141921896 1.2322869619757373 -0.4432507873241549 -0.2193381269706102 -0.20894746002320688 -0.028456267225457015 0.23551136340382475 0.14778461068627005 -0.043093034785285089 0.20642827436177022 0.099296997758541616;-2.5795243067386808 -0.6256478368103815 -0.94033147379503668 1.2292949140515097 -0.50052998676435545 0.9253137621374693 -0.57080432119225277 -0.62560922556375731 -0.29147541607637073 0.0038321240630734693 0.33403805895761801 -0.0045932524546763547;-0.042697970877484545 -0.42163730809886624 0.51555566614124204 -0.25874150747301633 -0.28885638109458045 0.29184881890778008 -0.9576050974822089 1.2414569958567221 0.068109346024304185 0.010507566461905543 0.19476733921745232 0.40046035835936733;0.51368648146753693 2.3244213765609705 0.17144651639410932 -0.54011457850248212 0.12954911717807427 0.042911699604022135 0.27694873341130993 0.10924474218956313 0.010132669521701597 0.015043037369450396 0.00092555621313888774 -0.076901224251306854;0.030385969911724424 2.1670787031971162 0.59797573363917589 -0.28170515044733219 -0.07631830082613604 -0.092867607201646968 -0.10176245530769067 0.17822178538904176 0.10589046243802201 0.15449903781312133 -0.059721779241077438 0.1057089523625281;-0.030901126423637355 1.1379814890376583 0.5020304056165692 -0.30047175588704295 0.26332828472949671 0.26148698554438649 -0.021283902386130021 -0.67177749806697584 0.096039703089393011 0.60130252564431563 -0.2412442691602957 -0.083864522443710524;3.0072098096437219 1.4951740332540837 -1.6801167019488139 0.73161772323571217 0.24187121004621187 0.39969416296706417 -1.6344744837384257 0.18376637215676275 -0.16841251330969084 -0.40121262817677888 0.55285460708126943 -0.14726960813846088;-0.17843720236532326 2.5262382815530873 0.22333171542227115 -0.428747728832783 0.22250706203138426 -0.17011210866550333 0.61719710308613951 0.97841868260290976 0.018490567240682817 -0.032491680620525237 0.014522005304320164 -0.34236720096306317;2.6075995657476145 -1.2413500488387457 2.2652480672215041 -0.1288287899036408 -0.52250998493257705 -1.5082914374094416 0.83180490244949667 -1.2478984307462628 2.1414648637130393 -0.60203210549984032 0.087843187261021485 0.90972815112869454;-0.44138045605377479 3.3917124092573525 -0.39510533860968172 0.67282541310841193 0.11388784982497285 0.226857056285097 -0.92139623727357711 -0.80939726706541471 -0.16473501286034364 0.28775495253509475 -0.23250627371572097 -0.607307134596906;-0.26062502168487056 0.07524011476897885 1.7340178359483152 -0.62296003956211854 0.85836323092813904 -0.084490609575311806 -0.5245982973308716 -1.0719881785433825 -0.32352847960381614 -0.58344606856849623 0.31645322399382658 -0.5128425453526827;-1.4137030417942686 0.072829424245145144 -0.23366191225185651 -1.2363157270869867 -0.49945214333226257 -0.89346664953729849 -0.39568568964249851 -0.24696404904649061 -0.17502750805722375 -0.044549523572213742 0.30914367019234429 -0.54423274454941861;0.61229520546171901 1.2152970573318893 0.28677288893908864 -0.18501926857034567 0.16897664825808131 0.43280973822449131 -0.33794556891021582 -0.36350244190104536 0.10127372493683964 0.040669837267978681 0.20547291526857533 0.2059969375235586;-1.8017326913684604 0.34811064787018281 -4.6219869414413974 0.9159819962983653 -0.41352080510693884 -0.078914537717355251 0.47429071165718417 0.0082784265513863899 -0.3602643870258363 0.49351541154659373 -0.14935571589940916 -0.60478989692900176];

% Layer 2
b2 = [0.89691562626718291;1.7259342593028821;-2.7801012589590113;0.38201725261288655;2.9285412858359918;0.96371087059675031;-0.70705543478195632;-0.26919988169896503;4.8178510247401629;0.38364822762833073;-3.0466415509117004;0.064455765722178315;1.1400186789315223;2.2764992702141544];
LW2_1 = [0.77834285629812017 -0.20663695397664403 -0.63478915852814599 -2.1341885253407051 -0.9300353105796324 -1.3551502098568546 -0.72973490357676563 1.0263263568999408 -0.35910556746636552 1.4427105422373936 -0.30409488026192588 -0.57485679831609771 1.6381583689131487 0.42023162308446921;-0.34467570878081061 -1.1028107377019225 0.7164479530931348 0.68474064650640598 -1.4669884695417048 -0.80220812407355213 -0.11236083636359438 -0.23900743963423632 0.026684029740270683 1.1515831305807842 -0.13693627162278621 0.00018682954620064321 0.74840707739837686 0.25512294265806779;-1.4177840683732721 0.99766276066598159 -1.6059249419044173 -1.7444640231924295 1.132807647959635 -0.11310413594102223 -0.62561551050510844 1.0824097424621355 -0.5058569033848006 -2.0099019483845106 0.16593083201609948 0.022232871538729427 0.49280987470647564 0.18677884255183433;1.5672351771478057 -0.47650352283502018 -0.36403367951859356 0.70189929118599037 -1.1665508617794755 -1.5749029119159506 -0.78801198538181461 0.23670058415176562 -1.7266850551187887 1.0627959827311775 -1.4120128066034237 -0.26493559125332233 0.044743880494536759 -1.1286796375270447;-0.73969208883734372 -2.8972357084242129 1.1836937713100348 -0.81244935759382442 0.46932170321406652 0.47796483049460831 0.73763289935423482 0.21249742249121062 -0.11730731389876886 0.15302341652063539 -0.12845142435076368 -0.15792641290162604 0.017314175958138542 -0.18567715569844889;3.3760590275311455 -1.3883212046740234 1.3103151538436584 1.3205805764750562 1.1220101080077685 2.0778485247716088 3.3619106820414864 -1.2495344198556484 -0.68472865127350224 -1.7949212532202967 0.97181193718077985 -0.7338472880355269 -1.7092923676686176 -0.19731835281889171;0.94358950911781814 0.98478424804604847 -0.80706367345792329 -1.6290219232637888 -0.058552401939118294 0.1399041902630091 0.48175046352316891 0.80972747974915849 0.16072534924213661 0.45271362163072254 -0.47620177073902803 -0.11486888009557283 1.6132992555778332 -0.0079820906980252841;0.47067789063568538 0.32727447352687988 -0.81907836224400821 -0.30229764239918278 -1.2555591148839655 -0.66495701250788541 0.90547583042970525 1.6031059395262768 -0.010540171217003916 -0.70591500853604017 -0.7460128941830344 2.0424441364725001 2.7060051303368264 -0.86705535249943888;-0.37246300131169829 -2.8333599633838094 0.65028976628506618 -1.5788147219265132 0.0082905499836368919 -1.7659012364997095 1.320137295233984 1.079409618166465 0.53088411603646379 -0.070785150599014898 -1.1859458390136171 1.1027868575351454 1.0748750402944691 -0.45521118669415639;-1.1110955405769167 0.32618862335186299 -0.48234450367791126 -0.34306725020937878 -1.3979186815953653 -2.1396340822593904 0.040601536923154005 1.6000751738569725 -0.37781850047268262 -0.77805355191706127 -1.2732933684096217 2.624495237232396 3.6216437771440728 -0.91450152466016554;-1.9913515986583947 1.919878933950407 0.75641770416840992 1.7904122639028537 -0.21218884607987204 0.32591891445514792 0.046421908674966275 -0.98518510445327445 -0.64416187069546216 -0.98223346541611434 0.0624277605889327 0.41540770719652409 -1.2843195770935727 -0.12207554606773338;2.022532397786045 -0.14816092498693637 0.34328358559230276 2.4657983024756516 0.67973936471400664 1.4369350600984034 -0.54413702563600563 -1.7988096946874819 0.5240201973971309 1.3015350392980038 0.67482378402421361 -0.39261576141245408 -1.8312168289549828 -0.12832054123489794;-0.45608127548679311 -1.2768324926699992 -0.55313796472227239 -1.3295741250125148 0.05396378732993589 -0.31202326196770991 0.42681134637649482 0.26254602552330714 -0.3995023509133997 -0.094645838549440461 -0.41054974237836073 0.05323303531044031 1.5141257974792408 0.12647366615386851;0.44956047472339261 -0.98734821120681537 0.66716574685226415 -0.96982036042355491 2.3891966428495386 -0.1285051797867871 -0.26958921225143839 -0.11513389841446417 -0.012144033959665741 1.3713404996181711 -0.14988409835717231 -0.60860762336182272 0.41955445661217011 -0.27297403719325053];

% Layer 3
b3 = -2.6524120006582965;
LW3_2 = [-1.2145322558337575 -1.1583908487148955 -1.0708726581933334 -0.32762826613395363 -1.6364484505686503 -0.28957310294586741 -1.7916447857307789 -1.0522374454336409 -0.47125663770255855 0.88349479661571706 -2.3419575316909076 -0.80079008765322224 2.1198116841139378 0.97872290865029288];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
