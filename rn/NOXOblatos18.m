function [Y,Xf,Af] = NOXOblatos18(X,~,~)
%NOXOBLATOS18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:34.
% 
% [Y] = NOXOblatos18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;-10;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;4.05679513184584;0.195790504160548;0.00618238021638331;117.647058823529;0.141843971631206];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.1401039710126546;8.7860262949525332;-1.6865730860384252;-1.7119816347260217;-0.45004331257949226;4.4828772040380755;-1.6096868891602409;-0.50850017399687908;0.80991939112148881;0.98712649844583267;-3.2729469025907849;-1.5860075857206788];
IW1_1 = [-0.13376833359438681 2.2801514039190254 1.0850256119920714 0.14726224621564868 -0.57905967988971718 -0.30226493475441379 -0.086218473669654974 0.053207462335628411;-7.1290041747321604 0.74306203740632848 -0.54694888634974081 0.10411648338391338 -0.7386364470790826 -0.045738638326297765 1.1773963770352325 0.9281763212095937;-1.4997252446480995 -0.52167029474444582 -1.3707468540357619 2.1103022654546053 -0.47218488941320536 -1.5157622078175323 0.72354303047846891 1.516636839398801;0.050531346641792749 -5.1168456704099938 0.66058930478888445 -0.36804864129452985 -3.9699014112342912 -0.32626609696825282 -0.15831613589950838 -0.18730791088612253;-1.0868941460438204 -1.7427987857471547 0.19483446901626042 -1.7462723035551582 -0.079203966576420592 -0.22414855122126817 0.57689812620870695 0.27447063893072915;-7.8153038083520956 -0.73524310030785067 -0.79685209361116482 -0.55977658207136782 0.15687194624233772 -0.0022414752371582095 0.17264819745602961 -1.7355631119747823;-0.25857424688443087 -5.7912307852782492 -1.1665592070953703 -1.1870034776639558 0.079374262352726682 0.29260599246088931 0.20310677053330756 -0.093918549134640317;-0.97307986034053451 -0.95772116082606518 -0.49864915473854149 0.85883685515768593 -0.68548825295555282 0.19551590697292662 -0.63149144704168181 -0.34743467817885937;3.1388861007962165 -1.5127973729073756 -0.84575621091285391 -0.29488145098777835 0.061205473702019952 1.5952946862939941 -1.697357589031405 -0.67888261125146765;9.0711553859454952 -0.65279739161549843 0.24409937456104464 0.61821878750294124 -6.9396878949700218 0.40773666513270784 -1.0018729680537857 1.3944368042203106;0.90208105171185149 -0.19431120687936992 -2.5027885087933712 0.46520353024423644 -0.23310449900154998 0.32642581245770746 -0.13592984531747224 -0.0050048199330767901;1.0989532836760223 -0.65691262728308075 0.49826195881105401 1.7153184051423422 0.4021031282924023 1.0722367349376349 -0.48101252876153222 -1.4863509006589961];

% Layer 2
b2 = [-1.5106688897376948;0.53454122017012862;1.2385159598360029;3.345853743284084;-2.3884100769253163;3.0525160661242539;-0.031868206340475658;-0.45006874014194859;0.72804783386038441;-0.5119389775749762;-0.98643792004916508;-1.8363668772915422];
LW2_1 = [-0.033539315550737532 0.7761841197517001 -0.68276816353929148 -0.94660794112243185 1.0597241025291539 -0.40894409374362889 -1.305407858675578 1.6274181234077156 -0.21003852204752549 0.031260044664479764 -0.1989027024920077 0.56824157039833467;3.5974565752063987 -3.5696912554737508 -1.5088522563364535 -0.40506443306240669 -0.56630361392958384 -2.7973323541292303 2.4032691080096802 1.4613178988712501 0.64392534414477076 -1.8285586917665371 -0.41752559246213788 -2.0605374208792031;-0.25226053044966795 0.83115685796846595 0.84889902613231749 -0.79871102881669365 -0.15938607300428698 -0.42104897027546301 1.2508009157161111 -2.3125843527474172 1.134140958512929 1.4903367932239071 -0.20191984261861776 -0.90833059344625411;0.12175403839558842 -4.2356404269451922 -0.95700060439122148 2.0558260883064725 -0.33854090018569427 -2.2811723664233972 0.4471097438214508 -1.223108223869886 -0.32349984623734673 -1.7163323188588762 -2.1728429692717355 -0.67932195081298841;1.6359414510705141 0.65345180612946452 -2.4058643386065395 1.8909788853204821 -0.98097154774639717 -0.46025050664406925 -0.88538632958276053 -1.481113925862505 0.28169035461822317 -0.19222313078819389 0.37264933590499216 0.92409171128453715;-0.43965623499064505 -4.4152421693002175 -1.7020910628191097 2.0393023187401687 -0.31466123649291994 -2.225449792171569 -0.0034929242017013168 -1.4523960120725912 -0.35621310455195615 -1.6752042604870405 -1.939403762024229 -0.56474628887698441;-1.1154316057325153 0.59092777632346072 -2.3161567554545139 -0.1233877134409091 1.1412555354205074 -0.85870408388948616 0.43806736502707877 0.053676122405314539 -0.48368635998567366 -0.41965855492844351 0.20112807644860328 0.83673964169531667;0.67522820162578245 -1.7150679295589333 1.8373115953166723 -1.3560352227276105 1.0465290059139964 2.0000557212605465 -0.60177952490259323 1.9742458177677904 -0.1369795225782211 -0.055925857552743041 -1.9562613140547938 1.3871312719636357;1.0172344782078926 1.4731652440698055 -1.6361117463951973 -0.0057384274211029415 -0.21938291331915444 -2.2169600982325659 -1.1090044058882262 -0.97876270207686922 0.49226080324244681 -0.037639331357328359 -1.7463236773078288 -0.44288499416057836;-2.4814555965773817 0.092387915689170583 0.95412436311681892 -0.53243733123925974 -0.68686094369904782 3.2830685123291334 -2.6993053788218484 2.9006337463674545 -1.5914503200066608 3.0499474135204689 1.2321348813680684 -1.5423328200131152;-1.949178012166187 0.12826357237659136 1.2624591259924964 0.68386729125861967 2.0334308153050369 1.5790447362441387 -0.73933763625394155 3.4641883587703877 -0.54479887950444827 -0.075549811421395441 -0.7954804838054419 -0.29824934249815716;-0.93816260033841281 -0.66987003056155991 0.67896245154733859 0.076444427823682326 3.3490000434845606 0.7429663226183586 -2.3783200989470625 0.31687435853783352 1.135563410772978 -0.2442188890801647 1.9167805253222714 0.64052497266855923];

% Layer 3
b3 = -0.12888962378512284;
LW3_2 = [-0.93982246190456487 0.24370803208273281 0.89163511750057212 -2.4062928938894883 0.58159751190261122 2.6517577313248664 0.71714566581830397 1.2070910075104249 1.2098456964952335 0.65369710677646498 0.044359239771325006 2.2342024743103406];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
