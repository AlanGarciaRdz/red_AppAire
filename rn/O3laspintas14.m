function [Y,Xf,Af] = O3laspintas14(X,~,~)
%O3LASPINTAS14 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:47.
% 
% [Y] = O3laspintas14(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.241545893719807;4.5045045045045;0.00280033604032484;95.2380952380952;0.212765957446809;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.1284800019630552;-5.3240726379614669;-3.4061655150798362;3.1161455027912006;-2.0059650071236734;0.45931407528898149;-0.89672789334305847;0.29869252717465339;-2.5976790827083138;-1.1255863845949008;2.2640374945749273;3.4359012440340493];
  IW1_1 = [0.43809775539174078 0.32971614702463214 -0.46565717916483873 -0.82915930370410629 -0.54227937526630343 0.030473311581195102 -0.22062645085099197 -1.0222456416980099;0.70569129830733945 0.85816219680721273 0.88329153019379669 0.21552999381659668 2.2831895516972867 -2.9682634680748086 -1.1911341986801498 -3.1279056876671656;-1.9469239027768519 0.12598153985997651 0.75036029923521208 1.4662984641430987 -2.5384842470521867 -0.22078997944564399 -0.94686140527194551 -1.3074823268346643;-0.12643454014264557 3.1013945778638421 -0.13738504876310395 0.19001763728686211 -0.052051492638110132 -0.17073805298677427 0.055716876320166739 -0.22222523951548862;2.5727386318194476 -0.30223320363012762 -0.025209506149125746 0.57382709998852888 0.41947450592542856 -0.35353355985799195 -0.34341903655411166 0.94458086011876263;-0.95167382546906232 -1.1757017403423993 0.016875364724667233 0.5115894949691101 0.18279900518636458 -0.69579374920509396 -0.11173561130452316 0.306873622589595;-4.0565469708544581 -0.98846257511132907 1.489357185070328 1.1420108766962263 0.37095099371060652 -0.15020052328414252 1.3524464197423851 0.26183017251887508;2.9345364698530307 1.0420093121381977 4.7240532720094377 -4.4413783395654987 0.47363449591599982 -0.93331267394378026 -1.030967433923103 -2.8349484335230013;-0.64305750167171571 1.9856146146280713 -0.26097567385686338 0.28979439406301372 1.0750479843194329 0.50349000326122584 -1.4027270829189185 -2.6588327972365411;-0.909043560690039 0.20675910017425561 -0.53386198230450987 -0.65257132307647692 -0.53667250500048225 -0.096184609833861512 -0.35191156758603659 -1.045136853525781;4.0282143896271494 -0.18873404217281617 0.54069976014189769 0.29522690178691274 0.2996283925530589 0.64325618882543545 0.58193428573787631 -1.4089067712382251;-0.30471926956914092 2.8037875578769071 0.60094830796807408 0.25285350977414767 0.044554624817210245 0.25108060149400169 0.44217078643678837 0.74967521737483822];
  
  % Layer 2
  b2 = [3.2870507802894928;2.9975268099398753;0.20540500744804183;3.7876857478213033;-1.3293773160847118;-0.14367915347962387;1.7984316392332576;-2.1107784135925707;0.17775113991163061;-2.3103850024151655;-3.0922865612749404;5.0050193262153186];
  LW2_1 = [-0.91990961765248214 -0.13846343998719798 0.1406289657672323 -2.790731535794571 -0.42445550402795013 -0.93098019294577217 -0.61443282040024816 -0.057005164106448875 0.29197733571540424 0.94593184306713907 0.59130068129366398 2.4740290960552596;-1.9104312820468419 -0.14998737780384999 -0.031678502336471494 -4.0252775371522915 0.23964564199307475 -1.0988745790248775 -0.85276657637154796 0.00020750285732748508 -0.53175997477766423 2.2380222382851902 0.53225869365197875 3.0742559725723888;0.548673538209278 -0.8041512481106613 -0.1278123635489217 0.18818861829402031 1.5443671282777767 -0.22401845804149165 0.048948299358876582 0.78606880742401997 0.0021230378925811847 -0.5354262564101665 0.84807811989600812 -0.82924034557076731;0.22065909803985015 -0.57875970886345895 -0.74050471022190167 1.4964776749129385 0.74725274055443325 0.2461052636727534 1.3366588320962598 1.9759587302881085 -0.38558141756447317 -0.82154004212242493 -0.82717230949018439 -4.1708702872507111;0.53629995391878793 0.77671404663914168 0.91432106958567161 -1.4583669544600877 -1.8795512003435377 -2.7001575237668454 0.77642259469604225 0.38477269238881828 -0.96515002595043564 1.832965490763216 -0.50416538414773404 0.048953281905625368;5.0042626113543793 0.78762846551313626 1.2519752626202194 1.0192506613317205 -1.175565504706823 1.1437632054067641 0.78852334676999125 0.49396516683522773 -0.33442603246597685 -4.613122550891263 0.2821496538157453 0.25912360192842065;0.43106005227214722 -0.40152652742713307 1.4896421904479691 -2.4380596913724513 -3.1510645486525029 -0.037194423482705186 0.57477482255774337 0.7699712158709946 -0.53202499946590531 -2.3937887625494634 1.880166996704395 2.697316280983745;-1.3601077346503312 0.31928961851397136 0.20439499627242316 1.5441106405592511 -0.041461552922235023 1.3519610403062405 0.50518162915508402 -0.25597982191057328 0.81155412676671357 0.58788446294927443 -1.0872306191760739 -0.80111190629796514;-4.9547113283300499 -0.67233575001307622 -1.2504067405894137 -1.4147126847673885 0.74443135204462729 -1.0389691975385349 -0.82993129178569724 -0.46599674817505421 0.2893215596927779 4.570032955373903 -0.35121588909638995 -0.058995932134154008;0.73260855247302592 0.79552663568985937 1.1106895255144178 -3.8398122766529066 -1.914626271408409 -2.5162580145265308 1.2631433216640848 2.1619052290501837 -0.90078730190033529 1.7465522953606794 0.36035263318308397 1.6410191903568638;-1.2805705349427652 -1.1362638167015526 -0.078341627924691168 1.4830854750368108 0.24469945831604925 0.93993698437004236 1.1848762026693607 0.52435571176901452 1.0649130757947693 0.59274033420613692 -1.9314923452303536 -0.78090115856284581;2.8856264083916576 -0.19324453255344237 -0.086334996482071408 -2.0287035223741934 -0.076090212504472149 1.4233884009856137 0.69440538828244003 0.2717389872806818 0.52032762851844527 -0.65256060159761453 1.7731519084675973 0.67526799598662823];
  
  % Layer 3
  b3 = 1.950509851201472;
  LW3_2 = [-2.1112690554842262 1.0289176870466272 -0.40997711905900158 0.34437656356875734 -0.73580725056642626 -2.2104358626030551 0.49289517601372917 -0.54965089690364966 -2.5379590574077562 0.73084444288019923 0.57870725047317351 -1.9914983265460813];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
