function [Y,Xf,Af] = PM10Centro23(X,~,~)
%PM10CENTRO23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:07.
% 
% [Y] = PM10Centro23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.281968137600451;3.74531835205992;0.00773694390715667;45.4545454545455;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.0656159227375226;-2.5068120095434403;1.4318264078818483;-1.6539425456183945;-2.9095702242651198;0.018128227634594717;1.0962908296817502;-1.3024128587627002;-1.6156874507106191;0.41830781438087866;0.048944990627395969;2.0762636620253789;-1.5372438117236622;-11.007750189545018];
IW1_1 = [1.3384310739073082 -0.26502228208986156 1.1046864665133742 0.12118465432341069 -0.036607581038815444 1.540057298190233 -0.33096002722973811;4.3125811956840332 0.10660262264059862 -0.13564822564995146 0.034696853431242271 0.40744195389008497 0.71647840334342705 -0.35985952457232706;-0.81135925523197128 0.45853754709703493 -1.9138767438022153 1.4929337107249134 -3.3217749524190698 1.2357207670291053 -2.5405807695159841;1.571977258579407 1.9235434349465363 -0.92971992618626564 1.4049113566119278 1.1149982847011934 -1.719454805335384 -0.061277536514329788;0.63775769594993847 -0.30824820146302434 1.0046962946547677 0.18347453975520647 -0.51220002804905851 -4.2753338296671499 -0.25127655663115334;-0.1475151431764814 -1.6614337239491002 1.0132490463389912 -0.76668776570801822 2.093571621949633 -1.4753264495846565 1.3329889149279515;-0.9152521516308566 0.98790595082813248 0.16277893173234903 0.40457148902813778 -0.39763869348532005 0.81464565431969993 0.021070129592776474;-1.4483706769751619 -1.5353727806364192 -0.084619184381300325 -0.17897891630916504 0.49056976018438408 -0.9495716680108458 0.56584924409909321;0.81497288306509696 -2.3535549154935618 1.6186030072319366 0.20193111555752416 -1.421088832562637 0.74816130249075463 1.7219134592051837;-0.031159148368699572 2.1878630699405761 0.62941598898053197 0.094172415550642014 -0.68273549589737759 -0.78902124112660876 0.66551339878964666;-0.24793104592145171 1.9453108499645437 0.49675791540040182 0.23485892615851603 -0.26619330556494814 0.13639015646578276 -0.057011221751261838;-0.13425914997499996 -0.012782688404338383 0.99621471954154406 0.091259377382943208 3.6449895523355513 -2.5071718709568849 -0.10718476814711239;0.96223230262838011 -0.62810368712526066 1.1989913741572662 -0.5903146699010452 0.77457102794514066 -1.3277810614059851 1.5584096562584353;-2.4615157222535204 -0.20515274980338019 -0.093731056609827154 0.12764205274328 -1.3214078362164525 -9.7870490260981011 0.84531689456192294];

% Layer 2
b2 = [1.0609421306516817;1.8613204902925786;-0.90567894665469451;-1.1922716474931434;1.6182591467937195;-3.1423034165038022;-0.070483528178390736;2.1789747303833038;-3.0535642910897312;-0.98027193398407808;-1.9382883275348219;-1.5013046312573928;-1.912088416495594;-0.4958172729863039];
LW2_1 = [-0.33753482073337887 0.14125648012773626 -0.080540636853291353 0.5355795855415475 -0.14353700572665279 0.40498868494211709 1.328693974355184 -0.73091811619591585 0.45562820575558327 0.45212601550962117 -0.80533262984680865 -0.24751493539797145 0.39630655503926987 0.68616076576440199;-1.7110803164623045 0.14553473744175008 0.30267590426359625 0.18064385587993134 -0.13212483484127546 0.45751490944609929 0.83037027213619186 0.33650760973313576 0.027087576349790126 0.058305311697992745 -0.45162920776470789 0.57838449537209446 0.48662804450461972 -0.68635560005824492;0.4510452008438402 -1.2856531445516743 0.95811328118617933 0.056095853970994793 -1.1237228435132685 0.32293249733518919 -1.7723847993366486 -1.2223226035575385 0.48272929179086194 1.5666493336973721 0.092419635706776193 0.067440410206725518 0.28934304826548951 0.85523815785995139;0.14648650042978525 0.33701875866448538 1.8446781216394861 0.70180798187794191 0.87766526209915585 0.13744648187144362 -1.0922052003737492 0.37989563631310946 -0.36894860976253663 0.92931229116438541 0.16487227722440312 -0.087343094802710269 0.38874254007244774 -0.1262663990299692;-0.35228257348441783 -0.082188923175415735 -0.97723206658264716 -0.12905688404550045 -0.17815784383881372 -0.11695002155173509 0.6572735909607319 -0.37059966008946438 0.26093688540897886 -0.54544676974603168 -0.85865461846965918 0.15826534914271401 -0.8678496623291847 0.1075000805114367;-0.36409469471435424 -0.29164451311803302 0.9355928308317939 0.65541826739541109 -0.96783950182097089 0.71686161613740496 3.2378582234927156 -2.1924838158086914 2.1126231214232938 1.0788035459626828 -2.2528160745256565 0.3540503049394324 1.1863143757202785 -1.4836375957211463;-0.62803473139583965 -0.86138016216070001 -0.070736005721726891 0.046023128366588464 -0.82824777572639374 0.45475216609250524 -0.10879792425427946 -1.7682103052092626 0.54601722312684309 1.6530577267565194 -1.0232841058917452 0.4155569466943122 0.66871329165690196 0.10330410448968258;4.4368848116888069 0.50366235954921046 1.3639353971884689 -0.98547289459121101 -3.89632204190058 -0.12666994906734719 4.290845388623401 1.194859752587067 -0.26271453270220502 -1.5531321931504383 0.44425748404563825 0.24065213097745636 1.6207941326703068 -1.367747367789397;0.19207039214079577 4.0932099100945853 0.78522685955915628 -1.124184959786602 1.1828677273665884 -0.38489657026863805 -0.43227948289147922 3.5489880751492131 -1.36947042714918 1.6103105284346348 -0.021486916811299269 -0.21895866372551109 0.8184759596925536 -2.4519845186126226;0.89660374331598336 -3.8038897316305618 -0.91632049970505836 0.21540462290942694 -0.32238812163405561 0.072178874138038168 0.44196744410132904 0.74301427237559847 -0.13125052794236608 0.76092501770000875 -0.52406546260480635 -0.22124091213798178 -1.1722024895933763 2.0961300816826798;0.79831518418895731 0.1743617325493102 0.4780834276793039 -0.069293907632862944 0.24518514906771718 -0.25054952717388668 -0.64646356854463272 0.13352009690039299 -0.30519092984558305 0.10833418802754251 0.49743602240751855 -0.12541803694627238 0.4979644512864399 0.063500159385756122;-0.62008740218994107 0.28426668458687732 0.39877348830927462 -0.65132623209041995 -0.73390879248699004 -1.432058969543661 0.5752714794453484 2.5253191123526522 0.49968632166931187 1.8703509004425234 0.47090741253378299 0.40573755358120617 0.1131790528792718 0.87132439105961335;-2.2886883974627805 -0.5661902068562743 -0.22343044456006544 -2.0084886314881736 -1.5379735501168148 -0.88758726286676592 -0.49604469332668011 1.4506219630608537 -0.5673650538126076 -0.30790754509918117 1.2059870882736918 1.7657692281099924 0.62182479477822583 -2.6678281286787877;-0.65170313843164573 0.11025857151686416 0.21088300124382919 -0.024028061865281308 -0.058712371951935793 0.00070600276894328649 1.6983381716428845 -0.3159367305786473 0.57103645244906498 0.63958269810359392 -1.0101792277582322 -0.10803707907660492 0.21412654773050663 0.77442131945819848];

% Layer 3
b3 = -1.2016663438758615;
LW3_2 = [-0.83432755906356171 -0.7313029624398526 -0.39094358207309776 0.34895334907508085 -1.9850020563660884 0.33912305711950819 0.39402950053293723 -0.327165697399252 0.29081117488982539 -0.21330056797408015 -4.3663259553877962 -0.27510351576916831 0.14199148415737461 0.96331141621544325];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
