function [Y,Xf,Af] = SOXTlaquepaque17(X,~,~)
%SOXTLAQUEPAQUE17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:01.
% 
% [Y] = SOXTlaquepaque17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;3.03490136570561;14.7058823529412;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;35.0877192982456;117.647058823529;27.7777777777778;5.12820512820513];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.7820233359228803;1.0134947565225965;-1.4030828261787842;0.95669411076340316;-0.52563422233815293;-0.79096457863827185;0.38144038822519433;0.11722629961123414;-0.42164034828739994;0.2745950256126729;-1.1176361379959001;-1.1874151209668034;0.15396602948954535;2.4795430798902394;2.3881012150874685];
IW1_1 = [0.16084856081789675 -0.3109145192547772 -0.15216728814384314 -0.40407910692513976 -0.21309724462792365 0.34680455708654773 -0.52642616372543549 0.15107695289963849 0.087643484943909084 0.10606399993360195 -0.46565412103670439 -1.0583692212113849 -0.011605649886331452 -0.59607373890988291 -1.1069617742330793;-1.881625417900795 0.16346210545265208 -0.59320108189282406 0.35127287845679406 0.22776053493817525 0.19049406737042485 0.68076724745482387 0.010242376929786974 -1.6468085689051195 -0.26154679455199659 -0.61313088423457207 1.1373793957554643 0.1326439590956186 -0.2360984291056184 -0.11178328624453046;1.0647853770570903 -1.1485164897088687 -1.2226321938788158 0.16067068151478936 0.57860678430183943 -1.170433815577538 0.042215558030485781 1.0103316118081507 0.47644486478224124 0.37030065092536035 0.5236299856104164 0.91005201676615788 0.046621269279354061 1.0701296704272938 -0.38457671065089516;-0.17090767206268259 -0.25636502126744443 0.52664904645790778 -0.53668126355044266 0.18942529549350631 0.94153393076180858 0.6316068521048348 0.47832403033645454 0.29004070998449727 0.62832214855498569 -0.87527621203995309 -0.43933335102494653 -0.74000879870052605 -0.35691269958769706 -0.3888510702416208;0.13517277826315491 0.51353167409179246 -0.51458290951569652 0.80525024673655399 0.16517612830018313 -0.68498064553580706 -0.31737962700743311 -0.69394418392770352 -0.34498125701578713 -0.17102061435083918 0.095870557738157156 -0.2635509053617584 -0.23930760148245289 0.56227213824032507 0.27085023362686583;1.012789469917698 0.26741941265626362 -0.16899463994482319 -0.3848627176294786 0.22480310922408647 -0.12788274916551354 -0.25670414022793164 0.41262336310922143 0.5025945229594232 0.27920675305187398 0.56911640156843035 0.36544768377768555 -0.24781018458864157 0.34756842066144217 -0.92104954167222197;-0.26670111744441422 -0.56852627645310472 -0.1705209830150341 0.24456157365222486 -0.69477089041725471 0.31082067980195732 -0.31056893787812839 -0.55989451332436169 0.64757518134952341 0.43271256421966026 -0.09253452433038091 -0.28545541177968564 -0.1289868579826825 -0.2389345611731504 -1.2396855118349268;0.81174096870346013 -1.3449326771238137 -0.92576583874248852 0.13686972957858451 0.19841918687776094 0.25450940640526587 -0.11660047087799016 -0.032422908948911644 -1.4429317414666023 0.20106994767252054 -0.78514535803695318 1.7085651926928445 -0.2727660372914304 0.74122775905354732 0.18490428487741356;-1.1736292359334224 0.85003761061281036 -0.12362863841869878 0.60090472685479368 -0.030120741942540809 -0.7356384508950311 -0.73511005552816167 0.41393809509478785 0.43421020462605248 -0.39346878010965908 -0.54958124916480766 0.25431417281857033 -0.70433724403015352 -0.52832949609548552 0.12168686572509115;2.0672749913269217 -0.2884170738728688 -1.5964109400039446 0.34102534388935685 -0.62924335656001396 2.0066432867914124 -1.5350215913888676 0.37456286305582565 -2.4073940369291993 -0.012146666152292453 -0.2458415894102827 1.1855245125548068 -0.43365002134782277 0.13556505521672155 -0.057492321496301291;1.8916424053745289 0.25165397332110723 -0.71015306036614168 0.62375868263029954 0.11647816531889071 0.19371966137387642 0.25078277924715359 0.17206538845221436 -2.155264502151546 0.2500626766130028 -0.012629746221527113 -0.15435760472762972 -0.18967088345293007 0.6459696600392798 0.10000281844354142;-0.31409915104572644 0.37654956557471825 0.1021005841243368 -0.16470602362687445 0.041677752145656458 -0.39660299461542103 0.28232199241768979 0.38447847100202903 0.50593986261487289 -0.10932815885959805 0.54912737855468763 -1.0722249188515671 0.26059788322033567 0.40192678472610821 0.38559218093505787;0.048231586580552863 0.34883181233834532 -0.33844939274810015 0.47643637866751232 -0.08253117445171447 -0.56576155070151535 -0.51236300659821465 -0.3701752758593837 0.30371735819839579 -0.11603709748169259 -0.17016711294878215 1.5190919214648195 -0.18401884104380958 -0.024612463764090747 -0.27937707080397228;-0.29397489993445025 -1.2087861829046742 -0.58653934776776662 -0.10300186690872071 -0.10935306772186758 0.36302722741018012 -0.43367974043467217 0.17000375401076379 -0.17972137558969875 0.11930871769851094 -0.54935299934669246 0.30378848423862476 0.49229460141990022 0.92778851510575489 -0.44758139220593796;1.0713268181728401 -0.38865634216647182 0.95989241743056408 0.60517492400853601 0.25383686883518491 -0.10407420111047611 -0.28731591270348594 -0.48566055233939309 0.90793111797027259 0.26594918215104851 -0.43819658815944162 -0.060942406928001833 0.33516588936350605 0.033848666435467412 -0.53793930530166945];

% Layer 2
b2 = [-1.5956624665847798;-1.6345369758097323;0.96934850750279067;-1.1795896192273212;1.4560829683257921;0.47675866826079732;-0.33767705472288206;-0.17253090951420971;-0.42120411399084734;-0.28677726132773768;0.8433868636591616;1.0998505663672991;1.6445937724866784;-1.693638581701244;-1.6626425555910882];
LW2_1 = [0.25834276484066293 0.072635247708812217 0.61860954009711833 0.96142873532668793 0.17605408426011096 0.20915956188532442 -0.17831287299640289 0.17047630543144315 -0.44838878646469582 -0.41522807573196641 -0.48294009160652585 -0.4748572756635534 0.37578054134509137 -0.61609571713372902 0.30057236247580937;1.3290626155601155 -0.21542070221484694 0.82360893390704115 0.40938022876315217 -0.96035554303345017 1.1481183235083416 -0.88209774350864423 0.74697367934145131 -1.5004348371140614 -0.32645120275817791 -0.63217487854099974 0.72243240842769652 1.3686032566451636 -0.0094827122083902121 -0.27573694465446513;-0.45274653221142769 -0.28871864337049324 -0.038126676240519762 -0.21219322766018298 -0.28558576351896248 0.058377812394072658 -0.71410035109377312 0.59497848852737378 0.33608316815475697 -0.59988507967781612 -1.2034626554752783 0.27321366275418241 0.46100784283624741 -0.46317358012968324 0.24925828219784418;1.6792818368968041 -0.32158388858073617 -0.33876897140593915 0.13656225167037003 1.1035313998351706 -0.39326433425661073 0.24973864996404352 0.11572706262317026 0.36849079104834398 -0.73917512204622582 -0.029731286392078463 1.0069943788702602 -1.2593445267244636 -0.47270622405193458 -0.33602730637524209;-0.43349421985906544 0.61035459838343153 -1.0409906295699605 0.35583161303838662 -0.28520798102318151 -0.079207155658017059 0.27941574416261022 0.071346510647626135 -0.65047860887234477 2.3557326386308874 -0.057264381907308558 0.16815876729183085 0.24280853084976975 0.52427831579367035 0.26382751308316138;-1.5318279224605977 0.50178829927108715 -0.25314410039361335 0.34609453197441797 -0.72067224187004475 0.44987048998851847 -0.41773501920230949 0.036002634918349159 -0.56354163207986796 1.3859520708393964 -0.15996894433446374 -0.32575575415612201 0.85338418606870625 0.94960586163028915 0.63266176019232523;0.31410695085978324 -0.98020907990543205 1.172221342481085 -0.18531425485914935 0.98433781016632638 -0.14927365733754264 -0.66368668470397696 1.2260667713284179 -0.53971459408412015 -0.66305810324239789 -1.173955332535332 -0.66512015068208041 0.20310684031055984 -0.36622430966016767 -0.42220600225421512;0.44356229257853796 -0.68620017380247877 0.23029415694446645 -0.68411817924370633 0.052201077947907119 -0.32210002523994558 -0.22520386036752071 0.38588562394334974 0.45872802077375208 -0.45911825326318245 -1.0574653418445337 0.25876445314985264 0.50645551286295709 -0.36613975747640171 0.094038660816425299;-0.69946634838220834 -0.55104597304185143 -0.058163317843296605 0.093050335074269547 0.42233007251726279 -1.0869783521147978 -0.45888751413501921 0.73176330651778632 0.42147173855276354 -1.2332967637011554 -0.26164354550705754 -0.11066294983855525 -0.20992536432406989 -0.13397965892983041 -0.87697272887560984;-1.4030635046373703 -0.63960709934561766 -2.0572538674962022 -0.11743444963495325 0.27526376167271577 -0.14325392711767057 0.11735814119418535 0.25228376743762848 1.587750627311953 -0.035929367780248404 0.29811360562942762 0.35512664357825691 -1.9809509093962989 0.39810832544377511 1.0040454791968885;0.5628668666078922 0.70127526955692709 -0.94958340184768886 0.52582532235114721 -0.17452348613408467 0.31805084784474263 -0.24478456468846621 -0.70528159005647717 0.64836781763703288 0.036080135996223693 1.1653517540783487 0.54162564142121172 -1.3330732408779531 0.16808618794878036 -0.35320296300724963;0.55804191318155105 -0.14886297891933695 0.13296849245390885 1.0117888906854935 0.86317053522222986 0.05215439814265789 -0.77343289329199016 0.89951365920734327 -0.70037399357205332 0.21534604208167515 0.40125935353192338 -0.64519988134955897 0.13055028090892148 0.60430038588252877 -0.69201656352398555;0.56625663302850227 0.69373834774359522 -0.061083645909891453 0.17057248678132111 0.082588241828792125 0.042803465545200009 0.77313118744983167 -0.057334200285398859 -0.40359992296743613 1.384174913918526 -0.091281578337021871 -0.14386877414660695 -0.91329803258197884 0.15314915307391325 -0.93375838653885046;0.031616691422046303 0.30868914667960995 0.15555931059870884 0.37011426898796695 -0.421989700661839 0.43196782845930487 -0.80687287036497513 0.057616556831273778 0.083658779246099962 -0.086303404288907828 -0.51922734459669151 -0.13934995755105509 0.38908023694597937 -0.77076275176026288 -0.17039389487713774;0.48064404603786171 -0.3690302385184091 -0.41417401275001803 -0.18802167551908011 -0.20624964648868485 0.40322024126765349 -0.043381100876797633 0.49773727964338649 0.46669163487608928 -0.56708591398318675 0.034205012763692401 -0.38219608639233998 0.39643890595564074 -1.1463083436355597 -0.34516462298372635];

% Layer 3
b3 = -0.88082690722066781;
LW3_2 = [-1.2079059363879503 -1.9486859303132507 0.54413195065123965 -1.2375577852684672 0.99349569944800442 -1.010305135962746 1.0168635624651168 -0.4367497509407095 -0.22242803578836914 -1.4701381672202976 0.3993710190900181 0.3161425593835665 -0.5780931571403487 0.90170576333625896 1.250750783668471];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
