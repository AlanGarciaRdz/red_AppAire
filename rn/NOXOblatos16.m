function [Y,Xf,Af] = NOXOblatos16(X,~,~)
%NOXOBLATOS16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:33.
% 
% [Y] = NOXOblatos16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;-10;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;4.05679513184584;0.195790504160548;0.00618238021638331;117.647058823529;0.141843971631206];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.9752603608456181;-1.8950415620380185;1.3453804305517598;-1.3695849084538543;-1.4884669632817;-0.044991201879745937;0.53944887663633578;-0.2650745537977513;-0.24985707063672588;1.1394020181027587;-0.63075830428988966;0.86370055316167937;1.2320265378282758;-1.4525771943670838;-1.7245207303437102];
IW1_1 = [-0.99162310299345102 -0.22024869913471853 -0.30601064896276403 0.46294536115783175 0.3936276969188538 -0.80265048582076814 1.4231579683882047 -0.34815540224839481;-0.27772242198723879 1.2725271302592585 -1.1461085766795889 -0.10977120838033953 0.91496726697822217 0.24595453224260602 -0.73764285324416201 -0.87183487081855948;-1.8271179121864332 -1.1436860881349884 0.67030577283608839 -0.31269247764426533 1.3607400659235367 1.0320645511697824 -0.67884057821058608 0.43574767857433905;1.2539370490418793 -0.23978120706371445 0.52745486504972994 -0.27467665813773623 1.1284125299515808 -0.88902729452000839 0.60558842579634364 -0.47594111095992941;0.073398923799219404 -1.5350207412908372 1.014835657401552 -0.37585070907797585 1.2849714833431007 -0.082770287194733172 0.065591586631881818 -0.13226345836797343;1.4139724285026316 -1.4382508244619117 -1.5998033085226848 0.68627153294538967 0.48651385391318286 0.06349809875086751 -0.82332986798638041 0.2118828930603272;0.59423177438613084 0.010087634802785087 0.35187758294246529 0.11920229202239528 -1.2561695918516558 -1.2895702807620975 1.055239749888873 -0.60793851963372381;0.2122001789431455 0.085481804977495135 -1.3282087182626086 -1.246736944288424 0.4007994516575944 0.52221724061016439 0.021573611249371443 0.68093586433115971;1.4864645036642614 1.7820575883774339 -0.71298730968417856 0.38266312323828738 -1.1394405062572848 0.50870076336326475 -0.7553304483778096 -1.1503659955777996;-0.076772140252304 1.6380676306017365 -0.64848277636520402 0.37433663375955761 2.2160542695769458 0.061669603181555198 0.77674645830648947 1.1728520708071584;0.1135472209801032 5.3055195553015517 0.46456472853764152 1.6884179719151846 0.54052820150552905 -0.047522144602318364 0.037018851579414397 0.055449069224220174;1.5792516903312905 -0.29203090591168984 1.4171181376665054 -1.0532273894870081 -2.2990292760990991 0.073384973870039047 -0.25650082134738661 0.0042721600560823303;-4.8628806818513901 0.29646859947489812 0.61885130678392863 -0.67368752700165724 2.2945405981286933 -0.46702777912623455 0.22583151546734834 -0.94448260794145156;-2.237621337686702 1.3874484309364343 0.44950741233603908 -0.92682897964831668 -0.02718943376784666 -0.21012440663428139 0.6896183895048239 0.20547044439168893;-1.1268933464714477 0.10522506367899559 -0.15343050018551257 -0.602332766235532 0.63603854932147863 0.81676382508594303 -0.49895343318425661 0.46867404549053665];

% Layer 2
b2 = [2.0984104053003021;0.93780649442225583;1.4482128405021024;-1.026950277831546;-0.051387871080210638;0.3717771956593246;0.068246232542096941;-0.23474747264907223;-0.0079144795103596195;0.80994249850148681;0.6787918397884467;-0.83961732811552237;1.1356813879070733;-1.5722446257417915;0.97398913258774245];
LW2_1 = [-0.59691081187929107 1.1836524916594671 0.78887580987214689 -0.090556027681018253 1.5102015099659156 -0.25058097076065161 0.48951702307512363 0.080822045378402624 0.51267090015611749 0.72517271234371306 0.57956951151728353 0.69435164891227819 -1.1313999381557693 0.47887680227076268 -0.58230121820307468;-0.62430836343277485 -0.90195832119110242 -0.27254538355131391 -1.6623157832107767 -0.68681150406098046 0.41408070495363403 0.83520239142746588 -0.33278165632681084 -0.19676077365921354 -1.137896874380437 -1.3045888729404118 0.95005336503125304 1.4204449695061503 -0.34621018295172828 -0.60197787164531191;-0.57349673282248259 0.2468934110350639 -0.34036283800840633 -0.00708802593298792 -1.1061815646254702 -0.162777854500855 0.10815448861906958 0.83286519218070232 -0.005949598286281407 0.038478606800335685 0.36048464272837122 0.053829972229167473 -1.3149466520924202 0.23115726587214208 0.29874463344437774;0.59422471843906854 0.07230269980637799 1.1058662807900652 -0.19334985492784693 -0.38798858202853315 0.7050083951606223 0.49452974944604927 0.41927858568293691 0.94300165365884703 -0.60018050481556728 -0.088521709918487651 0.55149697867393954 0.54917014256103147 0.090087982951826587 -0.3609467667499423;0.29898832785170049 0.32546161566025128 -0.45931777824534747 -1.1790761805527099 -0.32985604809411972 -0.7442542823733872 0.73915095749585225 -0.096453309977782509 -0.30204942474777868 -0.39745512287668561 -1.7635253904715387 1.4726498186425026 -0.70621210756723118 0.27470913051628104 -0.044401759267063384;-0.92272769471698746 -0.25552464041094253 -0.64248553442375911 0.65762295513283031 1.2887019822615591 0.17702486003892107 -0.25937751552860094 -0.32785756034195762 -0.57277796641185452 0.39487834308470388 -0.39130262108746566 0.15221764420149198 -0.59875625710394731 -0.54372878560486781 -0.035882927150513978;0.66436705172006716 0.10557226689531243 -0.96456875354831118 0.27420210440038983 0.2921143533300809 -0.62325674777582285 -0.15175006521315326 0.14785817497919454 0.13079515269294317 1.2213737523829233 -0.097818520259404573 0.9190125444433549 -2.511607214383941 1.4639044432439614 -0.35672691761223346;-0.28753982908276671 0.3486977610484176 -0.46450998084871115 -0.5644361557081069 0.43372451565983394 -0.69174133552147044 0.32268559072605252 -0.087070737540989068 -0.32145316544571817 -0.58446831387856646 0.26597179084621275 -0.41103337318232092 -0.48057697496614704 -0.31159296921916624 0.21388518946320711;0.038753151824569801 0.79301051684902557 -0.15142445719665218 -0.24958988693031667 0.57906643190301443 -0.17612831701288609 -0.4513210560836593 -0.18308492101481466 0.39055029554868054 -0.23121862638452292 -0.97486027728906455 -0.61401406546120563 1.3889032254193805 -0.53227224426400765 -0.22333302410410005;0.25570599608905276 -0.82565137808661393 -0.21904676032621134 0.83013272420641759 -1.3891268448511143 -0.42645875004524941 -0.61325308575036797 0.62254192108692541 1.3539108132826492 -0.082915202119251033 0.11032644754039668 -0.31243489675644393 0.46345543653198396 0.039602431604576042 -0.47138436224666652;0.043468323823075382 -0.39254320437420315 -0.39734407887271034 0.78050921055088984 -0.55794698547255273 -0.41563544575830297 -0.62225930664149243 -0.10485061069046442 -0.44965987260568213 -0.010665666362613353 0.084315100774814938 -1.3548202946606136 1.244921507129354 1.0046096529538675 -0.71314373187590696;-0.18839663730440398 -0.14369204081558576 0.67603996843622893 0.3116893516905882 -0.012457374056763533 0.53400840148214079 0.81684200772624216 -1.1976455281223379 -0.53841588652874772 0.013767647856156078 0.27592565148434889 0.5663041959005749 0.27611547438591216 -0.41546747218637381 0.49014970370340932;-0.028002607014423142 0.062995593165605573 0.38208848628729453 -0.027642119635317861 0.26386927321337589 0.35061771843801121 0.34020005210705617 0.17764306920660233 0.44556868932181587 0.1879548308214665 1.3633595210089737 0.23522140866660393 -0.042212853020749383 0.33555139132875839 -0.14391818409275864;-0.388477798285362 -0.30770625765205989 0.73199855009320702 -0.44827428609567727 -0.34143059019455496 0.076824372655971446 -0.15469807858694173 -0.85842118708749782 0.35095029683180823 -0.86531148460445628 -0.362521664061486 -0.073014379326463652 0.43630695770551259 1.2477675433792503 0.07841689351610695;-0.37372740367444507 0.94611186191622532 -0.77460600307010663 0.030387538921427426 -0.35878295479467809 -0.81431955959387858 -0.30169427489780681 -0.5713632092607438 -0.41947283122206142 0.8042040076239606 -1.1858854335870155 0.062718497921034316 -1.0629214911042641 0.08071937676632468 0.21289031535005185];

% Layer 3
b3 = -0.8995872655186995;
LW3_2 = [-1.1750616178093753 -1.1541796432006513 -1.0883188243326147 1.1147205362474841 1.3654549586409215 0.86640357221195474 -0.87435164249901509 0.29383529391920532 -0.92061694376279302 -0.52550608109812202 0.96364831458728961 -0.64692149324795489 1.6206108065400076 -0.84653885208566004 1.2730929345432191];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
