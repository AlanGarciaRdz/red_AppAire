function [Y,Xf,Af] = COLomaDorada11(X,~,~)
%COLOMADORADA11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:38.
% 
% [Y] = COLomaDorada11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;17.6991150442478;0.00572573718866304;0.0175284837861525;0.0546448087431694];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.2700450431655601;-1.5639375999962728;-1.1244652633778571;-1.3029364966201853;0.76781407896844045;0.1866817546423932;-0.39327941732216326;-0.59401023753013538;-1.3777572862271903;-0.16423404795665064;1.5327262988976589;-0.7783895999721;-0.65829461755394625;3.9696924906194844;-4.2536581669231133];
IW1_1 = [-2.4064535362374233 -0.9601927761435517 -0.44113344798022247 -0.64026699979690238 0.19325446973924362 -0.85672530891500764 -0.85857874617734442;0.31773733822799255 -1.2352841929444658 -1.0788216042726757 1.1158660666418294 -0.2755894345964765 0.39164492291216507 0.16367890524821258;-0.1206997996550713 -0.28527832689342936 0.19801805218841054 1.5206442731787029 -0.29931557277018805 0.29554451544047738 0.3626401935956714;-0.12817699095880847 -2.507966045268994 -0.29354977331034521 -1.2662261799479908 -0.35635796608990578 -0.10105990494990237 -1.2251961453194944;-0.69378125993231776 -1.5417470987687569 0.43346991754907815 -0.23464820851430812 -1.5728359820712809 0.97390791221124695 0.842438966324353;-0.36541563048242803 1.858696223109692 -0.4030765967818421 -0.46725107245554542 0.15944090729057092 0.30391131750909489 -0.30111300216383674;1.0782532198603496 0.045046629356792441 -0.0023708483588461629 -0.43541408817897809 -0.85870871489088785 1.6523134208450221 0.85817048494927628;-0.20981776018970449 -0.79768778775351423 -0.76739479595410998 -0.91559166417485582 0.19251604056227248 -0.12141647603575385 -1.2775644048308445;1.8184677099355255 0.29057013862829895 -1.1529122486117975 -1.6529816057608364 -0.25961835875810108 0.89007094106554918 -0.40765828679954591;-1.8901278953189102 1.7442788207649222 -0.20684509893978142 0.011770499604455247 0.081861997904704678 -0.47643623235475796 -0.79960753687403741;2.0815859368871616 -0.63066590494354524 -1.903766953511546 -0.34276232648303495 -0.45923085733168373 1.0377173042636021 0.76346910984435257;1.0273148977912092 1.9597901541774634 -0.082888529525738358 0.71659769410351948 -0.41152206766388894 -0.39210416777468571 -1.0601927070529023;-0.34188591642387867 0.45457051175760615 0.8868371620608162 0.58320960459702664 -0.076341143511420406 0.53654836476178636 -0.44344001781504444;0.20264959950364589 -3.9330597507188072 -0.045118239066214233 0.83509032200783107 -0.67477144152747293 -0.099107890128229514 -0.68073965382191437;-5.7625664238305081 0.19189405827866207 0.14826391574135064 -0.32126028843680438 0.14719150193311545 -0.13660706266568612 -0.18337833295963357];

% Layer 2
b2 = [-1.8060684705087362;-1.4101303416506423;1.8856103082110336;1.4914078718815575;-1.2704809815146982;-1.1150192254345743;0.35650178877794914;0.40509212096886255;0.81154092874085815;1.0848253565283932;-0.71889858329180178;-0.1944292035002661;-1.1433822006892416;1.5799542436072203;1.982721925101141];
LW2_1 = [0.22977191226610971 1.6245956406796882 -0.41624973720503294 0.13808960572826101 -0.79850135898481001 1.8065220220969014 0.68110919735777975 0.29249624786761569 -0.93761259029147559 0.63685032825452703 0.64814667623264799 -0.2904218679127718 1.732387583380848 0.36210416570479603 0.041009695673321515;0.28948931663313826 -0.56874035013378976 -0.29647395354970757 -0.72334552840034094 0.12910605615286871 0.54708519829941915 -1.1673776174674135 -0.47696543383689444 -0.72004718558820535 0.17228973076388318 0.76735944119610533 -1.3979566387039308 -0.53927382865025375 0.10653897093029537 0.055433577696416214;0.60496433981663633 0.20034116598587665 -0.29571347770055412 -0.84269341442456425 -0.022457542394574023 -0.99964896087121891 0.24761885173986942 1.0306482703945978 -0.50498998551629326 -0.23435430454831027 -0.32369480767142617 1.417797228473294 -1.0399687914493205 -2.734174874421738 0.35149877840869237;-0.06710616649570976 0.48242789800127961 -0.64151458565827502 0.75651292691847138 -0.092148864610058209 0.43413629735575593 -0.52895581940392467 -0.80491891925125392 0.89172874212849718 -1.0065379109621653 1.1107293364684181 -0.92541514762056587 -0.044811335430827354 0.67522209008160683 0.26456590188777412;-0.6763602583424666 0.34425146480181318 0.55737986839732123 0.13181377863590066 0.19000582864205612 0.70695892160667173 -1.2375443292434565 -1.1241223870594395 0.2464891449971483 0.11630596652017666 0.1222237357209698 -1.6807900592713563 -0.69520010773825447 -1.3956654316512889 0.54771880202542178;0.09112977263604545 0.67447876263418305 0.16858136472601096 -0.73706588305716281 -0.14097899481938017 0.34194919945603608 -0.45806379154212934 -0.80320812826935994 -0.67581830105560314 -0.36395184816468845 -1.773255278885489 0.00023658971468312057 -0.49927929676226712 -0.79289152714133104 -0.71045053696346772;1.7591716274056421 -0.23326313293101228 -0.89381642984127829 0.48150367816852163 0.31011013044211311 -0.68782768249894621 0.74985479463320515 0.72442623625245006 0.32527895122635958 -0.19808989785162956 0.04328836590590214 1.6073485503108216 0.57139319616325246 1.1272130173056911 -0.25403305712708496;0.54747939877580198 1.052755337624945 -0.7621948186743126 0.94375301040259174 0.60599269479262252 0.013349404063622851 0.23512451934837456 -0.13827725106375979 -0.068646857810640963 0.23567215814659601 0.39531443199694444 -0.84830398068698487 -1.1035043610256179 -0.11742735670479749 -0.88698189728966603;0.31234156894985571 -0.87819069623040691 0.60591270622713289 0.18450868431766496 -0.31871853807735528 1.4197178873406999 -1.2903186672049705 -1.3381511518220595 0.49171597772693909 -0.33501231368645457 0.38545381186411709 -0.46139467900830061 0.11522187578344638 0.19912059957620026 0.97483909166852711;0.96359147458169059 0.63426986285331466 -1.2296569444896164 0.45215884059894584 -0.069734541569123606 1.5896241064642247 0.083097128526748318 -0.9914925278317146 -0.2323253328092254 0.68244527782349906 0.046513811340950131 1.6921230064763373 -0.96584232494124678 0.47772119266836449 -0.48288104706046547;-1.4542970633876211 -0.8762325278203188 -0.1931139579616177 0.81743231406441297 0.29138103238032559 -0.71902331736198966 -0.2470966002548283 -0.51637982792543868 0.447290008482984 0.93442824638357558 0.96731132887139004 0.064868019605332145 -0.57019837524059891 -0.35193592908470417 0.49364279090214325;0.22091771375302283 -0.049994560390495213 1.5074243475151576 -1.811121010316282 -0.86025782837101106 0.048599250412310349 0.41089859593877026 0.7784316827216925 -0.37612462435831601 -0.7876751409528544 -0.95921741887766199 -1.4308968364142758 -0.17291481622122351 2.4735042787548478 -0.30234388436826737;-0.58829253204467491 0.43601493801448193 -1.0448713118771804 0.6002389088897494 0.92231991207566166 -1.6891513799498015 0.78491930815825095 0.46187408780414785 -0.17210581009389248 0.14903415450002586 1.2788107667494746 1.4949624397273154 -0.025636678913603463 -0.89446243603321796 -0.18094733039974248;0.39406774974485875 -0.63182919077620758 -0.74818242749946462 -0.029457217938818798 0.21931528906442024 -0.38873346914140833 -0.099549599549302703 -0.41696073836727165 -0.088765149557678349 -0.12238764444291814 0.6296733167457147 -0.84668513670191092 0.37423563346806066 -0.20581616484132875 0.038362430795940802;0.93486682545362931 0.18167178014411969 -0.24586139988721326 0.31273951193382982 -1.2984264321952494 -1.7998577244777323 -0.23903699800381267 0.93036061878700316 0.84837782997906164 0.32484220737676761 1.4118280002573935 0.22960646730282519 -0.10865139462967581 -1.3973695844374259 0.3814670584326908];

% Layer 3
b3 = 0.58617729664133822;
LW3_2 = [1.4461653013705162 0.061793657216613278 -0.33084841937870729 1.8980195784359053 1.8134217970242634 0.93961799705907023 2.0289963172155345 -1.130902235553916 0.82793491208772108 -1.5660421008958765 -0.96274048978485893 -0.48720726598238551 0.70367942833886665 0.93033528231057983 0.22570144109035725];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
