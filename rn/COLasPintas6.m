function [Y,Xf,Af] = COLasPintas6(X,~,~)
%COLASPINTAS6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:59.
% 
% [Y] = COLasPintas6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.241545893719807;14.7058823529412;0.0179856115107914;0.0558659217877095;0.00576368876080692;0.212765957446809];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.4105891111809308;-1.3629218098137494;-3.6346008240902439;1.0699363313882069;-1.9627203395469495;-0.059538220296592219;0.12643526959554566;-9.9933259586600975;1.6987378486415825;-0.67847091401829296;-0.95672790823834886;1.6865388556206142];
IW1_1 = [1.8237191986539281 1.016981902907498 -0.00026591983928723768 0.16610646147104891 -0.11813082749252517 -0.12770475777621451 -0.048045732220980353 0.16324216608612852;1.9897608692568118 1.8609077908331526 1.5389564673038232 0.39466144407146209 -0.20936365287122627 1.0395061262607297 -0.34693572733006672 0.22471737045729351;0.21609155156254894 -3.3842253554166724 -0.10147897822662526 -0.43925706895610434 -0.59767590735308784 -0.43510320362693117 0.13406520502336303 -0.11132244502293474;-1.9016112424626084 -0.2009826905554811 -0.047806768985656445 -0.946856240428674 -0.052963836921579986 0.13370007093405059 0.12207857394860451 0.40348699420943612;-0.32566656530036342 3.9326181770453923 -0.99011863460653526 0.33020761552583144 -0.60580473033786397 1.2242719243197677 0.22768848082097409 0.18132270810276122;-1.7425133504828558 -2.1214880224906829 0.068789063007199364 1.5223081423108948 2.3116757010984843 -1.9917586725990231 -0.13907458103920689 -0.20917032545241057;-0.98389087062852454 1.6902302491060348 -0.80701859384053098 -0.67802496214965013 -1.3827639918483532 -2.8438361704582604 0.11402145414074215 0.23148885337817343;-13.477816106056462 -0.25456205424988482 0.4661034117057099 -0.12840245365736969 -0.77224201584789653 0.17923098472393659 -0.16188313155601602 -0.38656777072966825;0.0092186133713772177 2.217639632047502 -0.18508818828941015 0.062277018082215065 -0.1279971176765724 -0.88648616786410472 -0.13456245208813641 0.17695427334530375;0.17932301514279764 -0.92940354002222902 0.068532267008393169 -0.056724916360297417 -0.074420821237598606 0.095572109581293321 0.042142544385301545 -0.068287474363553841;-0.70991134191186012 1.4461826849249835 0.1628384793654673 -0.25375361140741476 -0.16137178651315762 -0.095335045301247021 -0.16874119337132004 0.18621410257349222;0.92200413989861552 -2.7222308457591846 -0.1957992354754213 0.63789606450633884 0.6059333129240434 1.3006592553223228 1.2406056642717409 0.053569805219347427];

% Layer 2
b2 = [1.5892411303009528;-0.90971215556100637;-1.5621384129489253;0.17203501307852034;0.53172314832597445;-1.9591244657547868;-1.761380405069553;1.1521227589272938;-0.22804361285808675;-0.28719352754624572;1.668426691243373;-1.7080150311309479];
LW2_1 = [-0.28654725571125672 -0.51804759140579104 -0.83872440650310098 -0.68690539324433331 0.6414267208695188 1.1995583521272721 -0.5104510589941611 -0.055845869108798747 1.2083906203656698 -0.49194873203421524 0.13866037545080767 0.23042353240533489;-1.0452667872725063 0.7585427114189226 -0.6582223307082905 0.31232873541437933 -0.14462466904499255 -0.19814193842931624 0.16765121246346792 -0.6352114872090141 1.2622989899151318 0.090685245260939629 0.028711321306344795 -0.059605471908896063;-1.6063463873428363 0.13702357480680316 -0.80802479599133603 -1.1328260622768713 0.64462438682054013 0.96649373210107592 0.13089266582475864 0.06978138106394681 -1.564110674074783 -2.4486679883808908 -0.48174778130933893 0.29971867275481662;-1.3440243894081076 0.24761498648559782 -0.19475100992074662 -1.4238055629785653 1.5647252591389056 -0.0039469969396988165 0.85780268433860607 0.48074982969520602 -2.1004871225952959 2.0002714345211077 -2.4375126495022825 -1.0418079395556483;-0.50834841711054501 -0.16391001994358395 -1.2220552643691895 1.3573072365899606 -0.2757212723300283 -1.109737697179169 0.76335605152132302 -0.55334441272008683 0.99037024813473096 -0.50539125562757781 -0.57818401500269467 0.14574364654948208;2.0098423792554567 -2.2667111631588841 0.75604689665305846 -0.097678676164168324 0.21466498988018123 0.34325150417924311 -0.13391856417370923 -1.7797991447667978 -0.74762296008848717 -1.438775948649879 -1.1814006350809487 -0.47755346764511503;0.64215260947378416 -1.6764758035206164 0.46861736260231757 -0.42250059207905105 -0.071282112165561962 0.30675736057794878 -0.43289828343914166 0.98706596771443189 -1.007352369178403 0.90921746123437941 -1.4531661543405552 0.095855061375111086;1.424572293480173 -0.32631277369750783 1.6893403943424516 -1.0073116393150514 -0.46991586775698779 0.98838147081357552 0.30999754226376719 -0.39802606080105651 1.8006082144771487 1.0780352976846461 1.3416193169551587 1.06584995140747;0.79959286940237728 -0.65672057852505339 0.53148976835675932 -0.77987059905439737 0.51721008557474069 0.81923021483451086 -0.074516264021720624 -0.023002758465799196 -0.78725050566895671 -3.7039435858704151 0.45009979147568524 0.31807064972779525;2.109139443532972 -2.324447956728001 1.8926764134073926 -0.54772237052481987 0.29289618318864091 0.70538847842790831 0.26753816982210771 0.0080312468955279874 1.4114602243506127 -1.1187755967534918 -0.9022625100935453 -0.44223230663504398;-1.9585508482840472 0.14161360887733954 0.37600514933241047 -1.1243993836121406 -0.98748042556532201 0.44787576459574002 0.20430684748332573 0.097970082223411387 -0.58108617345638203 0.14785526243859753 -0.96233765108269487 0.27274964439028992;-1.4482177705824804 0.84775450650242734 -0.61702765168316231 0.57624474828402583 0.34295047166274567 0.43562041602466284 0.050520116948192605 0.62356326748984592 -0.8009247133419013 -0.15158425147982679 -0.52640926505252961 -0.19124602824269302];

% Layer 3
b3 = 0.7944226142522075;
LW3_2 = [-0.2230045044807272 5.1566473043146281 -0.80827830210156926 1.5339861834570387 -0.66815148185200457 0.60542345954427546 2.7781204599370812 0.37402253052801232 0.85686223286029706 -0.53007664119428377 0.47648565666241521 1.6821087284172396];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
