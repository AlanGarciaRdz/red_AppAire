function [Y,Xf,Af] = SOXOblatos18(X,~,~)
%SOXOBLATOS18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:42.
% 
% [Y] = SOXOblatos18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.6962168285091215;-3.3999263422309669;-0.24837230354041059;2.9052196700546213;-1.2290936576623401;1.1053169826142208;-3.832422944121689;-0.70756224399707035;0.22857741540891932;-1.9697834934548373;-1.0213228356141302;-0.040795805662672185;-1.2476117002988567;-1.5376447005815961;1.5911371599569595];
IW1_1 = [-0.34934417536209456 -0.19478370963313379 -2.2243873689720028 -1.4797331670532861 0.2278817163768822 -0.40032600356916082 0.39127336321415107 0.57680119549268904 0.23972290127207685 0.3970869915154665 -0.037809914177184205;1.186116354510564 -2.0377795084306314 1.4828948183396919 -0.28271844562448811 -1.7964440669660231 1.1050080654081205 -0.22648301202500432 1.2902109516554818 -0.22690191383310451 -0.3737752525434116 0.57729538202648711;-2.5969805205110679 -0.11529667716525362 1.474436825491209 0.63945500816038092 0.33516789765125843 1.1599309300047171 -0.45380251095162982 -0.95076335349754149 -0.16279033079872407 0.45339058861917536 0.51360428850497597;-2.5411481927380097 -0.53283830779339203 -0.53644736273938676 -1.3244700735112327 -1.4145556507550279 -1.6129744176519456 -0.52230313460576239 0.10829277734252958 0.16360939763697202 -0.68207848652684255 3.5263686244127861;-0.6275363090416558 -0.18101219960951587 -1.4933667866973921 -2.1152149236562034 -1.3278086272215148 -1.6099722424183973 1.2554468691468068 -3.4024155435123706 -0.1606179720128765 -2.2201502089241627 0.58759153461420699;0.068697401622082682 -0.34106293554055744 0.037082640022259389 -0.8761857750494404 -0.7265624498899792 0.62050378912745208 -0.72371072968977967 0.18044983479260349 -0.10235155125477761 -0.38376389512810283 -0.90981149809958528;2.4113720281321216 -1.404436567711667 2.9792982391688185 -0.36390382016241118 -5.8948094333736112 1.7989290888600495 -1.3546597008461718 5.176491530887148 0.32232339485908479 0.63848771472795762 7.2233961677136254;-0.90535176930148942 0.062304504392839105 0.93755807605000629 -0.0025819978056652905 -2.1126858227285616 -0.99296639478601967 -0.47546542614726445 0.51385384682242585 0.37558510528676231 0.22188031186990059 0.52327061618445359;0.028294485362217167 0.36042188832452882 -0.69626959568103264 0.23002067973926801 0.078574251862938982 -2.4969536524327385 -0.36540624004940203 -0.87150406893277044 0.22136124433374044 -0.25376032514777563 1.8419028212963893;-1.5711697901173494 0.036734332768443123 -0.76244761856429544 -0.90944481624451556 -0.31915383320133173 -0.024647347660433201 0.01117285899536603 0.050795132399705227 0.13037537986763287 0.71465936003030728 0.38122810782234218;0.68988717099740327 -1.3258947339995335 -1.7005189832221432 -0.58834368242743562 0.53843694060887215 -2.2404353265211361 -0.40587594600882931 -0.037005974322874537 -0.52578115923818913 -0.47703168607444696 -2.3883879251771365;-1.9721087498538645 0.089597293809207113 0.25305217465603147 -0.66638628631840835 0.66885393560199946 -0.70131573620931142 -0.22214919199413441 1.1233486390746905 0.31109697404566894 0.098878176330109743 -0.54983691089194542;-1.30176872840297 -0.11146514773873292 -1.3784968456932707 0.46212963321647677 0.84475662142295316 -3.0282169444789293 -0.20036063596171519 0.28435415251927254 0.43281062422538641 -0.77501130031464771 0.27491218734947503;-1.2390278946221136 -0.081087136517109054 -0.090517306263973835 -0.66744732931480166 1.3794335406815961 -0.017565779675795527 0.11341804085223486 0.4211928372967696 1.0650777980966499 0.42785415699616092 0.043359917570183572;0.32267010512123523 -1.62559316187765 0.02724403363751839 1.0156657747230029 0.80712262217406439 -0.091921048657795379 0.66643079741221567 -0.77149320764969553 -0.023846457932169593 -1.0590508868945878 -0.0080757366348125775];

% Layer 2
b2 = [-1.3126100240655867;1.1005239493534522;0.19961342796702314;-0.4880821628621701;-0.074497983134119872;0.39065363127589831;0.41528233091758049;-1.1391421027530071;0.40217554287806123;1.0750705176109381;-0.98404897830326621;1.4924632483095144;-1.6664450684473131;1.2489568265031137;-1.6939664971086301];
LW2_1 = [-0.69872650768724509 0.29800549334094106 0.15305397333310755 0.40869906691173136 -0.052739110755841305 -0.034460341242036528 0.198397323466422 0.12201454920618726 0.11368001964074292 -0.33229214968654047 0.22437255934569736 -0.51194672841433664 0.85415314118291452 0.53679906647174735 -0.15946710407288481;-0.2250907934867025 -0.40702758545943174 -0.7943499262110254 -0.065566087883891261 -0.059942606929883804 -0.19259778887241039 -0.19294881056686464 0.15344733588904921 0.67243656932746554 0.50659813927702724 0.3597808647673737 0.43621514853694471 -0.012464592788718656 -0.23194543041156362 -0.065331033942157779;-0.6097996094560767 0.43489587049686967 -1.9575675213478916 -0.20293306521449539 0.0012536546719821373 -0.86929545587985391 -0.77163505954777689 0.51285176620225148 0.28910108128869194 -0.393626134567997 -0.059629577295471352 -0.62049938085116052 0.87032685248103769 1.3639591807250975 -0.2336424302031514;0.040785480337071092 -0.44778588068470898 -1.1275373027606246 -1.0549784840414382 0.12127527939721724 -0.21147606891895532 0.50847132219201074 0.20874707068928383 0.16618892932420937 0.26913334391029842 0.68313550244194754 0.32174989480605848 0.2952663013733916 0.22200923344094112 0.14702152770710722;-0.44758781530115066 0.60058819771011218 1.3369029016522207 1.3706882880586055 -0.19139060572985628 0.74859519495004589 -0.59206963329348172 -0.13157509360722258 -0.1142637537096218 -0.48246272170410104 -0.83594237403802363 -0.46344379966373073 -0.20021165291787016 0.073593871593490887 -0.19732602472482405;-0.88411808113166401 -0.5832657287792743 -0.71196559253325475 0.50542819556827134 0.3214457224673794 0.55997507183552964 -1.2770047634206052 -0.028947577544884685 0.46755788061115733 -1.7402705292051581 1.0692285101636598 -0.1473884031890299 -0.094628409894228077 0.92808287357174613 0.75683179617369256;-1.0171812667949238 -0.058452478355803784 0.014312795846137982 1.0734577160589704 -0.26853752766245587 0.79956888114342417 -0.91350825161898996 -0.60269884056916279 0.85943073787399571 1.2442175155033282 -0.25524258917922382 0.88372803595640581 -0.14269096784026461 -0.48847062458911245 0.60790770521717852;0.60593522788885323 1.5771136815579365 0.090993170419800845 -2.6228158733922395 1.3137718528209417 -1.4333005739884253 -0.46573204389023115 3.3248349580337635 -1.6510082240142048 -2.0408179877749864 0.74646717775142957 -2.0746768305188454 -0.15322017804861723 1.1436411825237816 -1.0143524594096489;0.40199702329856163 0.96831728274390028 -0.74123043494844065 -1.8647377577175219 0.76766694492245113 -0.025042568974465978 -0.00094886536988943865 1.0497938395012461 0.096129661672405928 -0.081925880664769135 -0.21988448736433799 -0.43393887488097271 -0.67571894972867486 0.55362829490139176 -0.20371086272077454;0.88679500634027408 3.6539895410224985 -2.5343257795090457 2.1896024047222027 -3.2370708157735986 0.81161347285549057 -7.861188169028269 -0.60599407642075054 -2.7487875858827597 0.73644649492489966 -0.23535195571982881 -1.449428357428681 2.1207257898445904 -0.83671895887537406 3.0671986656971706;0.063145839867372211 -0.50318866617958269 2.4596478064610374 0.32713376051177501 0.64261898679473484 -0.7091365771755348 1.2280879147956096 -0.5182132705685597 -0.12904756857435445 -0.29265904624954325 -0.073880848016331865 -1.9509403690253735 1.2247990491027356 0.058423961164427454 -0.54008656333600635;1.7161582914622442 -0.6863928493409871 1.4306248837372637 0.66143290457138981 0.38103263209499927 0.11440260833558893 1.6825889549955533 0.5929529409273171 0.42732816592933803 -0.31412614687094326 -0.46350725749110488 -0.85645893508532145 0.35437776569200069 -0.60701384347160159 -0.072231174846524249;-0.63417458807698057 -1.6388873110588122 1.302843664961894 0.049876664271776686 0.9068503754178634 -0.16111740684550357 2.7287749982901688 -0.018834302067295472 1.1204624302879389 -0.40979919570098178 -0.41137059258972053 0.37944454602440014 -0.41499020607374193 0.30200092188929339 -0.7114208514998086;-0.5388471591795162 0.093447881718582718 -0.15479642436171787 -0.90612291049673199 -0.061149042866535788 0.50026508456773111 -0.35718861642362382 -0.029606435198008416 -0.18719647404348583 -0.078529515639898378 0.27511640347774219 1.3361376204957931 -0.82470254615558936 0.68919471237411833 0.24304229186895365;-0.29528689856379747 0.71895120503910925 0.37800955109034129 -0.29457503844979577 0.32637088838564082 -0.67355035519840656 -0.2855368646358919 -0.8992453648943487 -0.10078752873769455 0.045883285780164693 -0.44422536109550331 -0.25635635048262234 0.4101541138153757 -0.62059382381844308 0.37988202866961318];

% Layer 3
b3 = 0.35146959398468902;
LW3_2 = [0.6240936444871662 -0.45789825410541962 0.19910159734177543 -1.4602940936348698 -1.0822913502549225 1.3471582025149578 0.61359429536117727 1.5886115504234557 -0.39676355173359562 -1.522847224700991 1.958328720600963 0.19680090208086179 -1.4098248872097645 0.54286113173428685 -0.44450755783834872];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
