function [Y,Xf,Af] = SOXMiravalle8(X,~,~)
%SOXMIRAVALLE8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:36.
% 
% [Y] = SOXMiravalle8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.0208986415882968;90.9090909090909;0.056980056980057;0.0063552589768033;166.666666666667;45.4545454545455;117.647058823529;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.2959934852206634;-2.5661005143634443;2.211161895760668;1.9616560813268307;1.876878013690386;0.1686926567557363;2.4717754742910527;-1.3299003035673318;-1.0304642758019271;-2.1494760838789619;-1.5858537093358602;2.3845340030370759;-3.8581203638468811];
IW1_1 = [5.4337244193569072 -0.43277189333522953 -0.6263390169526688 0.69061238442168982 -0.58837828961342709 0.24821947737169314 -0.69243372487564636 -0.20021507797815777 -0.43161229888846098 2.0046060098686223;0.43702824040621668 -0.8040824605577862 -1.5148248214746898 1.1989257399478837 -0.60996207525906021 -0.037161315165968198 1.0766480517844108 -0.99277368962224199 -0.30727339777826995 -2.306735862669548;1.2704860935523503 0.19492158795276762 1.7684343603821426 -2.0298622741008026 2.0481260186591457 -0.7593738239128045 -1.2396193570033776 1.4582537040587671 0.61830629349916189 -1.0780469509819817;-5.2218927271229703 0.019543349551497662 0.52029329246803069 0.78666522468876166 0.5257584140382443 3.523746756963178 1.5382336390799303 -2.6042789558844199 0.3125542769905158 -2.1019212612089255;0.47284309761455701 1.4132583309952396 -0.78878376791774873 0.54982794056179884 -0.91421947405128412 0.72707333718620559 -2.3373690340760276 1.1004538879350516 1.5497067879473729 1.0805096735769419;-0.73739637516298573 0.90149331365458263 -0.15589832447587301 -1.2820979031166915 -0.14617665804469673 0.15597923831519014 1.9060437231767806 -0.80050759926326709 0.4249760032469897 -0.85619818395129221;-6.9901321271683416 -0.22748430178195322 0.75903300652616612 1.9190641212842343 -0.35295376752460816 -1.2089276720734738 1.2338761104022384 -0.46485944368589438 -0.11008820967723199 -0.15390532199098977;-0.91291812817586093 -0.02030943695210987 -1.4080217157236838 -1.4537135514889912 -1.3049105501396305 -0.090538324955142899 -0.78188702643993147 0.84136465289010109 0.66027722255539822 -0.76498595468764286;-1.4800776627769605 -0.3956512348931327 0.24916522769951466 2.0831901560245614 -0.26161805633855012 -0.091498823595757561 0.35728288795595625 -1.4927913381055171 -0.2754639407421739 0.14433723032864326;-1.3585675924690674 -2.9796505877383557 1.5710774250761612 -1.5630231766417391 0.97247075688821361 -0.85697950832186298 -1.274260351705722 -0.33685748338358973 0.74090615661326553 1.3780665070979843;-1.2903361613160238 -0.58354412258056387 -0.98096235189205516 -0.11340997588901372 0.12922737959245492 0.15540724948759863 0.26346572831051179 0.082880836585237816 -0.17327178580287125 0.68159879784325839;0.70288681098099515 -0.44319765536628625 -1.1709685527430147 -0.50333205547108795 0.05971723752629185 1.0302844716918063 -0.09290331675021693 0.6063860654469887 0.22704746190784758 -0.62020128508433814;-0.71406312821357809 -0.28324987154424375 2.6920430312188364 0.12450251590575029 3.5844145170783999 0.23252435849050973 0.23691972649633011 -1.0093946523348343 -0.98456168781049325 0.26686340125483959];

% Layer 2
b2 = [-1.9254700634329414;-1.5830290781926566;-1.8713285435673801;1.413559453508451;1.3253474302259411;0.99655215050388524;-0.11461371476224666;2.5985219741535439;0.15513480587027781;0.51319098289733489;0.86133448253686351;-1.0193665480620755;-3.6293133725067332];
LW2_1 = [0.14570144097923088 -0.15636447616802721 -0.93864917614375321 0.65629809964329278 -0.24548806392599845 -0.15895550980478676 1.0314042248580602 -0.22285016307020866 0.60031005463044596 0.057509124630154423 -0.68771015043423189 -0.46199187802810271 0.31234129799901605;-0.30772841835339465 -0.015291758468356488 -0.070503606952804942 -0.14725843702334673 -0.093614340234743257 0.0082451865083069033 -0.16073976015989661 -0.41069821584976529 -0.34252414109995671 -0.071270183366324694 0.51469423829491234 0.25587205052394763 -0.048841482279752449;-0.068070633886684925 0.48307109064908521 0.41233752195180479 -0.33426692563632215 0.061076854060070587 0.19190131568638474 0.07802289552458691 -0.14935804383794524 0.39668007981464082 -0.21012722904578662 0.33360943566514978 -0.70389583760266483 -0.49199964036787841;-0.94351805608021777 0.14896732286487377 -0.059312701815001673 -0.35719084159303527 0.15027667865625899 -0.3628985584478997 0.22173547278505557 0.16562307305328469 -0.056642738978923267 -0.089016758373345189 -0.086077433843381485 -0.47247558885472385 0.88368540267849205;-0.80057307758523211 -0.44673367642729811 -0.097354706591467277 -0.2034275679256059 -0.22459320252065704 0.39166454654171934 1.4327372723855294 1.8739889348446128 -1.3745280244894322 0.8523016665817772 -0.95278253731329121 1.0773346254945457 1.4228373353235313;-1.0725858551626382 0.64366301340234033 0.49899772274422438 -0.64293903322064183 -0.67298130114123467 0.52194687693262731 0.26489065205966983 0.55207602101023978 -0.41487571454779204 -0.79928818273833291 -0.21737148892222971 1.2984956003197734 -0.063443836957140745;1.5065848837182005 1.2417121425358657 1.242684980886462 0.22426836488728563 -0.39472791717255251 0.93902727221581805 -0.13270166266917807 -0.63457495659460705 0.051394566551606222 -0.2558567651145468 0.28997602315493687 0.468496130367478 0.70383360301423659;-0.69678469686754485 2.0091261922362826 -2.9032940198841324 6.053107783588632 1.8649802054927576 -2.1523576829704969 -3.8904937582148675 -4.1845485072513551 -3.3698291480323235 1.2160452456820832 -2.8104085835449184 2.2503591821349889 -2.7319363197016542;-0.23502516061977011 1.1562013698085716 1.6384801227678614 0.57775025785501422 0.69861945195442887 -1.4112429196392211 -0.49903748214673832 -1.2318570022644335 -0.42908870309915464 -0.62715148810104226 -0.60913329173789599 -0.97131155983596995 1.3246725002314288;-0.37228649775902944 -0.23126619175707974 0.4044816026283598 -0.15382008631093125 0.42755064400510046 -0.76632577963432524 0.55930604115902427 0.62528764424865302 -0.10551807263325674 -0.028210959296210342 -0.24074433374017146 0.1467167816231531 0.82304461066569012;-0.5143850958818299 0.6949445156755012 0.80388224406288966 0.68226199577824009 0.66610885317137547 -1.4288189096746524 -0.67268837842746632 -0.95074414617152458 -0.41768058779625933 -0.60973084787063925 -0.38940335262842068 -1.1711358140444481 1.3876724545321795;-0.78659107701921804 -0.012385983984975301 0.1206453423202087 0.8650534545132873 0.58065852435524434 0.640647507975454 -0.43100719971590989 -0.055502839950559789 -0.68502025404567757 -0.44287299317148238 -0.55949332290151288 0.94055277119145075 -0.69882419444127375;-2.1928093453747497 -0.61288130213188285 -1.3367193251972966 0.21534192616436396 -0.88672654049680122 -1.3529105676459798 -1.0574170723949781 -0.97786253018499492 -0.82470066217037785 -1.0822823599878686 2.3657334308035636 -1.2793443159342108 -0.82283624199322203];

% Layer 3
b3 = 2.0753272605166155;
LW3_2 = [-0.1751568847430339 -0.66380857334209131 -1.4182677441271865 0.28783596553863894 -0.03753546636070159 -0.7605459656559187 -0.061915792373629576 -2.822746783861092 0.28599919272060587 -0.24520677197310792 -0.25157167153697452 -0.019421153240750791 1.6013284041144276];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
