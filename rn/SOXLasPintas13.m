function [Y,Xf,Af] = SOXLasPintas13(X,~,~)
%SOXLASPINTAS13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:45.
% 
% [Y] = SOXLasPintas13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.0179856115107914;95.2380952380952;0.0558659217877095;0.00576368876080692;0.212765957446809;166.666666666667;45.4545454545455;29.8507462686567;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.6909435395058858;1.7831715279279956;1.0176848044653388;-2.6685198118062301;-0.20393983692990328;-1.0925579473917852;0.16688011838938291;0.64067366878111309;1.4006685354380175;1.0249464906953685;0.16646327394725946;2.1986838535006545];
IW1_1 = [0.59482281389327873 0.34792917836326942 -0.056466439749113057 -0.41408612779246057 0.47946970322942489 1.192374779381518 0.49956927422154668 -0.64315380522454424 0.3881582054389886 -0.48176128820434011 0.13834987076931798 0.5102367643145056 0.085400787104500914;-0.20612292299349549 -0.42518731366015472 -0.28501086569315359 0.1205713840928975 -0.030973288351477613 -0.36008972781920023 0.58062759019665511 -0.59522473986306457 -0.38839711428444196 -0.067874750285243521 0.22722594783214173 -0.69060874396930882 0.25725044393510144;-1.6324712351230071 1.1631646914576639 0.04581503313792562 -0.26675204531818675 -0.23210627844815113 -0.77473212115075929 -0.25855567810950841 -0.10441292649720499 1.9398331508276347 -0.2437437660867614 -0.10618750411637895 -0.7260583402472911 0.11301232760559837;0.68672444636144003 -1.0455270898312243 0.31309619648135523 0.19301639759607642 0.71979616686997017 -1.2863859755997853 -0.58233505434415567 0.056562669778240642 -0.19793066593849895 -1.2939981605661162 0.79662704052193045 0.21726740101761782 0.6003703101427319;-0.745881825160433 1.4729841529213648 1.1363473107286937 -1.1989182080227112 -1.5598667819389702 -1.6492492431756711 -0.39881405992405428 0.43780927100877454 -0.14926372220227174 0.66925484050762873 -0.19879932189436417 -0.60601435235358281 -0.69210925738507145;-2.9704243788834819 -0.068520980026243059 1.0556059405664455 -0.23278130752693252 -0.22565157030185712 -1.8845512019828177 -0.04926620596948688 -0.20465457779049731 0.14833440998216119 -0.38951020619384841 -1.050863785698569 0.78947098260027304 -1.6453166316846808;1.375779133356597 -0.26374332288683022 -1.1735521288274255 0.46264188202174789 1.8840461533827337 1.4878797212178785 2.5223347082201406 0.49998880308255189 -0.1193826758201003 0.57219395743630441 1.691637263782346 -0.49972888700994433 0.18199671861625455;-0.48620655711945349 0.021640254124708665 -0.19235755429012957 -0.13838195588012212 0.79454139241906385 -0.096362958670928214 -0.072877381688913806 -0.38333743143918425 0.30535687851153043 0.52330138660310777 0.72322616620429658 0.21460706407746022 -1.2047293163018609;0.15992223112007933 -0.20719784415855749 -0.16010913882115185 0.21675399899170045 1.2201800531690226 -1.2955810452688727 -0.190564354238698 -0.34942183469552596 0.47283809722559095 0.53092244315213633 0.87218889039782321 -0.63812911272328987 1.1875418490112015;1.0805920344751956 0.090620816918092095 0.26838549155304464 -1.1611484381423804 -1.1144418898123598 0.11313548578498932 0.97896151889791183 0.18497944960235568 -0.32140261285974076 -0.97536602971287079 0.71814793084588535 0.33324737505883933 0.69469442226282851;3.1665801471843995 -0.14132206720479079 0.58989960107326633 0.95560510310126512 0.92543293594162668 -2.8694754628640209 0.62303356154706924 0.60123073720356968 0.01635679611313267 0.24559879707254456 1.0880636351685595 0.73605055180563872 -0.43505846481351751;1.3071910234719919 0.14925635402693452 0.16788193573094828 0.4850879072719525 -0.48062052409621897 0.70708090929854794 -0.23585926977396302 0.14880204317071824 -0.40200489272376372 0.41177369905572847 -1.1983094234852141 1.1104427909511165 0.0050413864972463978];

% Layer 2
b2 = [1.7705637941679429;-1.4180297770140509;-1.2362481487220958;-0.85482916328123781;0.309427784416898;-0.34571184126768362;-0.091489728530256345;0.18440618045626384;-0.92163742941007298;-1.1261306112044842;-1.619220599303191;-1.8750195992760603];
LW2_1 = [-0.79693111772606073 0.85561716074543892 -0.36370001647366179 -0.20496343714537579 0.6345600615613195 -0.06799471364916912 0.18786744923640447 0.44322767729689877 -0.36700055954019717 -0.23534809802790471 0.67821422195741532 0.0016531380560129774;0.56609484217668404 -0.66754827258962823 -0.043076737401694223 -0.16040540097169367 0.31764461465499627 -0.42283333605530826 -0.44948614469715525 0.16381453520344175 0.98712639632614418 0.011054204211800218 0.40827085646706457 -0.19747783621596596;0.50348152634865961 -0.66928412546226468 0.11443108266594253 0.37249467369798722 0.95067038005607651 -0.38140511089330259 0.81370715275267358 0.15762676121229285 -0.058023042243089032 0.32245700612492845 -0.84391337017677759 -0.23805806944736407;0.63968838078383927 0.14887013596826704 0.43481834022842752 0.50105294857463201 -0.058980864980860775 0.37718446266294881 0.78115073746799402 0.53724345092012527 -0.083286862000383627 0.27897582728659459 1.3448320038763177 0.21399250712605092;0.023922593818248638 0.15625242644883072 -0.10214512921576945 0.66905664050603331 0.7204574523402888 -2.5477462803539725 -1.0382931802009809 0.57735879693907677 -0.58343250468127406 -0.58900048599153521 -0.12777745485343917 0.71529108209085279;0.575933167634331 0.20095102586727978 0.35191658936573161 0.56043751590504698 -1.0370243056405659 -1.1089894353070997 0.095396336564290043 -0.89398740880486594 0.6500909508733026 -0.89618374406464374 -0.78695447910551541 -0.39111095378287558;-0.71724068959114706 0.21677265072849339 0.13701785529263363 0.54915640464065862 -0.69472085569363762 2.5988040155414311 0.95705468201662014 -0.38643637889756255 0.43307151128804633 0.47263666039739521 0.2549813693286041 -0.89623412080229048;-1.2193066051019732 0.52294922014140421 -0.014455589787424967 -0.47351322253623418 0.062439044402921688 -0.28101593299214922 0.038173873563508424 -0.24540344652071294 0.75256351663249543 1.0792700520837675 2.3351896347475831 0.85024035558524358;-0.63639046898307061 -0.11433792435062601 2.1515853875222994 -0.023133404785895977 -1.9747138805952222 -2.4296108604342588 2.3405348213302846 -1.3454284136271641 -1.4967903200154891 -1.0846459111266213 -3.3596149154137036 -1.0369701775504858;-0.39684731178204169 -0.3270571500760594 0.065159462010423691 -0.046265489359340564 0.0066269881623097771 -0.4448138476923939 -0.23392100405433516 0.25911598516340217 -0.49868066717248105 -0.76695033179016225 -0.92762293229499582 -0.788829667806212;-0.30748378161985096 -0.35212394609158204 -0.039226841556273748 1.0159572706919722 0.19705619481833489 -0.89856561893956721 0.024631051815446319 -0.091832724072343205 -0.084515962591690669 0.13987105529517055 0.3437583744761622 -0.40935825300123158;-0.49916406429070875 -0.55260370682145799 0.30174111601824477 -0.37018676755161667 0.49592974512991345 0.28884124508132059 0.26315458642971584 -0.41106766087862112 0.095556049173271068 -0.48571344796134419 -0.13264067806856478 -0.4861268009585154];

% Layer 3
b3 = -0.41367259072516788;
LW3_2 = [-0.52899026967142293 -0.16012830045267074 -0.53846568811720219 0.059999313542742953 0.9660394713409165 -1.3285954299283451 0.9021289110878733 0.92386853380722389 3.3159167696874317 1.3567122486884351 -1.1361379428377656 -0.64600897558844494];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
