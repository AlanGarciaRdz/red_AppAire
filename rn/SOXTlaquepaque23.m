function [Y,Xf,Af] = SOXTlaquepaque23(X,~,~)
%SOXTLAQUEPAQUE23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:02.
% 
% [Y] = SOXTlaquepaque23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;3.03490136570561;14.7058823529412;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;35.0877192982456;117.647058823529;27.7777777777778;5.12820512820513];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.7075058667560752;-2.0563301353591723;-1.653737121933172;-1.4828957560242468;-0.27322109879073136;-0.99646072267733965;-0.14022021368109566;0.86932905049290532;-3.168547618527441;-2.0977642770103171;2.3141247417942865;-1.6728695201326949];
IW1_1 = [-2.4251928612368259 -0.17743925339345462 0.14342464134435642 0.50897889050915335 -0.82663971833894689 -0.34687143244606838 0.53273879292001602 -0.22800638021500183 1.456580187543405 -0.82742358594416143 0.32671214362690743 -0.51867792722206807 0.12529263158215434 0.31881260468637812 0.28100654934014829;-1.3996999295670494 0.24924774305634817 0.27019904911046533 -1.0789504670350902 -0.1625635163990001 0.1099340624899041 -0.15249159615812469 0.035092189137353229 -0.12125178093214951 -0.009130107376566856 -0.019902731514464547 -0.40558282181770955 -0.15128284673761905 0.0091175866855809501 0.89818465311518003;0.27170945053550533 0.65144921156066782 -0.2884344950411758 0.10588511688464958 0.12823978646513176 -0.099573562953669911 0.2245844299567592 -0.043633087141958064 -0.58890211360193956 -0.059940715185934482 -0.37318783701592068 0.36125439034324863 -0.6186335668993751 1.3055986252319376 0.559974985029837;0.38051383452504262 0.5653125034659775 -0.80926187572746444 0.87879062503104755 -0.07653167868324548 -0.13570205743951214 0.68689282033200783 -1.1702883635088213 -0.30754740703080224 0.22076935549090598 -0.15052475555791256 0.066608669399927184 0.27524871170090481 -0.24980322615108946 -0.35111944657220562;3.3978009746719908 0.13977667645085037 -1.9222819703498406 1.4658736307110141 0.48895453015599488 -0.18923044050736409 -0.022923862686660357 0.33445882431915702 -0.79252483439654808 0.24439004721443933 -0.059649258013584852 -0.15185847909010292 -0.91220365544097681 1.7526990519767596 0.49395347994426769;0.85871418431790081 1.2725901404342157 0.1875578573180548 0.51682368097859388 -1.2322849506126217 0.8130935774110567 0.30624163762290835 0.82809861516495664 0.80812532528836245 1.6819044152739846 0.076943091861532045 -0.77475357201760309 0.3880418732821847 1.3481155296025653 0.025416350639077878;0.91863817901456701 -0.42910604377502881 -0.66363472506552212 -0.019838312704624751 0.87299871232958814 2.0208489716229221 -0.43040845903575908 0.22548497728379704 -1.806937886083726 -0.1841193437402345 0.66261610661049564 -1.666959701692039 0.12149783689534729 -2.6691991208134125 -0.0082052038499182915;0.23075404309218608 0.44341492478478728 -0.65989492375696623 0.599008142313741 -0.042621357850623723 -0.032199677239279134 0.48979893660684715 -0.83412465244145073 -0.28719897979848852 0.16034531810587804 -0.095566264687688057 2.3669392930341093 0.24048925202958146 -0.38418181180698174 -0.21630300877938236;0.036397203879757957 0.40831956621883908 -1.650450077074159 0.64433797452665253 -1.0488651971933451 0.18872156958875941 0.69918957128926562 0.118649837033939 0.6750218739600331 0.19827186021887655 -0.62064223236645344 0.49494893371536991 -1.1313522336223361 2.4262941816401375 -2.0451296346850216;0.099257763874490285 1.4780195403518455 -0.22545966235517528 0.42674970578712434 -0.08450433318718506 0.99595257066854459 0.63381906166614765 -0.30941848204992373 0.16720181019396316 0.62852736501115292 -0.007397407459948005 0.25205745217456998 0.16561397394539035 -0.46258430974903658 -0.46400790543793052;-0.28085661257676098 -0.008455312916681796 0.96533042462768148 0.52694966143841337 0.60527254240203288 -0.31951325015840715 0.48261505564174279 -1.0583052832968907 -0.60515937179656487 0.02811862528247442 0.41519764269476067 -0.58554098681120681 0.21700405428471892 -0.26782312829680993 1.9532069015547171;-0.41909435838589676 -0.4472423952788252 0.43700234351202272 0.16564649962271788 0.06134083531190445 0.43686133644606462 0.49283939015428047 0.48105863726265768 0.69978082909703188 -0.0070531710276066483 -0.31991352538891904 0.70876534356443888 0.63494699522841391 0.092076514413517052 -0.15721970737861055];

% Layer 2
b2 = [-1.9898083830807307;-1.4577472551026376;1.2570908837349133;-0.28688034594710754;-0.13500203497198854;0.073005813660435209;-0.65596082943522005;0.4387970144276277;-0.89829762708426375;-1.0129193884517906;1.5589403399672672;1.7615339094225417];
LW2_1 = [0.63554878192488684 2.2731926999024341 -0.14005855693613581 1.2448034295788544 -0.82984028855206038 1.3769411528719273 1.8380945558307171 0.61776567929014636 1.907623243763612 -2.0013068496283228 -1.6833565474711356 0.121760594112197;0.028639403721253998 -0.47995837300213023 0.96558854160851149 -0.36771159200745163 -1.0897025791770527 -0.80015367745057142 0.76657699729833029 1.1124501843685728 0.58178520103860398 0.29299190905834172 0.1703420611537598 0.36990286529263333;-0.034415495249261803 -0.84618243673881732 -0.3753850845910941 -0.65384392849735784 0.2321752287895241 -0.76140631590845309 0.30755905071935408 0.58661580878910968 -0.52689337820786608 -0.038732131970571688 0.12382976252692711 -0.64369630654936449;0.52174781227218803 0.16455725372561217 -0.91624541373343082 -0.55542293709890289 0.65363328230040374 -0.93858408341814759 -1.1523275129965382 1.4185625553392136 0.28203303636280397 0.23812732483967797 0.17435944532641845 0.23915084505564194;0.44339077113815095 0.19467617287463312 -0.95421485470009815 -0.88742599494161001 0.26402690706603488 -0.43655687752763972 -0.94740861288666456 1.0365186769620982 0.5120661413711417 0.3407749570770513 0.44599116549340118 -0.29442795243386116;1.1140903388358103 -0.44195232088554248 0.51465006014282211 -0.3800421005274659 -0.30641704729809627 0.060064230766194888 1.0233693683083658 0.16234984400364222 0.62150039108327748 -0.121928022731148 0.21993682913061463 -0.062542535038988517;-1.8333134404119342 1.2545655134489904 0.18727457762957572 1.8987788249213058 -1.6852045232062578 -0.37942682776368958 0.87407133872824738 -2.1509642890603047 1.0704137976020915 0.10920371723325381 -1.069212516997226 0.2156390812405507;0.085866849839129789 -0.22345242284099465 0.27684833185751234 -0.16392893435462194 1.5034799737520859 0.85367963989247631 -0.10277258260203626 -0.56411095867671224 -0.43053707663545082 -0.037331658956423756 0.39644560457591888 0.51565810803857337;-0.20715366259564424 0.085837300638957489 -0.12248984446372772 0.084072555565865834 -0.33964536466465739 -0.04230861597986238 0.15548533266446693 -0.70445218848946334 -0.15811345588139336 0.6443471340663427 -1.1223337979484767 -0.46367660848524994;0.23214465398936984 0.11474589660571019 -0.20562590619386673 0.29608787528491531 0.82036225225246173 0.77276680240248163 1.1507247477332199 0.1328624764590689 0.056805800756512224 -0.86368359992396582 -0.73670098938506634 -0.63434441632052097;-0.19061478318018599 -0.23066370189636518 -0.33189381164628029 0.20722500656338211 0.56595043251082155 -0.044240256010643478 -1.4286293083416308 -1.4726763172384505 -1.1878989289452266 0.56633999045780903 0.39871199440506078 0.35182006390821502;0.81915920387664665 0.809303776528708 0.0076835348319690897 0.71176167885107844 0.62168844313879612 -0.48672502010563024 -0.058524308581636028 0.052172299326620861 -0.1678094081791395 0.097163630365996942 0.51173271002276832 -0.27731191600930982];

% Layer 3
b3 = 0.76113301577636694;
LW3_2 = [3.9027062646518975 0.6344496487013539 -0.23870157264779632 -0.17539555480192717 0.51654505014629326 -0.18872608732115101 -2.2582771005733289 -0.26098936455137223 0.096243589419736014 0.48873192708423191 0.63333426151239625 0.18328874183098601];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
