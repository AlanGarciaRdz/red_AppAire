function [Y,Xf,Af] = COTlaquepaque1(X,~,~)
%COTLAQUEPAQUE1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:11.
% 
% [Y] = COTlaquepaque1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;14.7058823529412;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.448430493273543];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.77693337290979636;-2.3003715106680787;-1.8618713054695171;-0.85504531221079383;0.58073785037199788;-0.57302707568356326;1.3124166576321856;0.84586063494405328;-1.2542383072690713;0.068540415338887162;0.58438165841414758;0.94311238068086178;1.114557066565532;-1.1423270985072036;-2.8326138876214606];
IW1_1 = [-0.19782733224538063 -0.33923720981039096 0.47648160516920157 0.38686371004143127 -0.077431460967423232 0.2389261278495855 -0.12630197734492035 0.06752657694358126 -0.39281377378145171 0.41681102766359762;0.27252306331592224 -0.99086575345612526 -1.5357176366526335 -0.014001494704599628 0.17093655490614873 -1.0929698235719083 0.34826958871904329 -0.27608437745306691 0.00065492461559730152 -0.019119642771041907;-0.045512153979967551 -2.7786585676453663 -0.26331255426685229 0.034180138780091837 -1.1058061527298111 -0.11907950297735503 -0.071460249971404807 -0.051259127244546517 -0.42505307514133428 -0.86025997315096614;-0.086913361104912726 -1.586791886143877 0.57830203537269009 -1.8262234407536861 0.66155579818550536 0.56025030920477903 0.051753928610415105 -0.010212890532270641 0.40303320304953805 1.1457139732350856;-3.7666437783571025 0.96539591205887276 -1.5285693877986981 -0.96551507120582025 0.045338887309357617 -0.47368085148679984 -0.71857020409748529 0.037743436298278914 0.63540696616978121 -1.8442789391154477;-0.31270385775606768 0.0032385222059953256 0.95274413245293732 0.13202186215141209 -0.14195259427360851 0.47653884996323864 0.089087849543091749 0.099252731914770215 -0.4499522340214111 -1.7358918174400677;-0.25705587284067538 0.4629981363475506 0.066035151305746026 -1.3454109978439681 0.24472039496072454 0.7807269580651981 2.2235308836033831 0.18624109453176602 0.62024070734376113 -0.27561707989312412;0.56752287810695679 -0.66525709861395577 -0.6572117406543827 0.293818472744166 0.46086341553474502 0.27012766668632737 -0.59742121863417108 0.67355631568709395 0.82124335060032883 -1.4017840867719757;0.39995545679720046 0.65706102476351291 -1.1095804375094485 0.66188117614898956 -0.2053500875517752 -0.26954365194484842 -1.9737070599397033 -0.2677247558701521 -0.41962922528722962 0.34421888328886424;1.6244906659883791 3.0664674955900377 1.006599743128425 0.29806906099147312 0.37570623811967313 -0.25033214723583258 0.26291336130469228 -0.069320800588804965 0.82120722321330786 -1.1794239996635121;0.23618226970309383 1.4675564675403783 1.593596359634063 -0.99266646172828732 -0.15448892174527853 -0.2560119994106107 0.29345280535091561 0.069230644879301764 0.71722922306258563 0.0015837989366814451;-0.21188378266356092 -0.60125172858313847 -0.84300734654188858 -1.201565851114778 0.41996261249056932 -1.0480257700302391 1.4030111247633368 -0.97300194327753864 0.13246878738399029 -2.2738745628376269;0.13362516377394121 1.4530995977847381 -0.44494295176681647 -0.65005313727729419 -0.18868467715271919 0.84184083900295203 -0.15701670277355689 -0.068061926940739009 0.26421761601615146 1.5065524983282377;-2.8398566650112884 2.5961075356135392 2.0368506736476464 -1.4389303671446911 -0.73442419832658079 2.0924625447161138 -1.2587293807647983 0.2760191805124097 -0.38086126410584387 0.9973326145777841;-0.40899193280897728 -1.040488480412878 1.4743146180707454 -0.43573548118598893 0.70935163393989276 0.80383135609109491 0.69025605767029352 0.013071424935839984 -0.17717089814037804 -0.61932008808432848];

% Layer 2
b2 = [-1.7525800698806566;1.3038714880258799;-0.99249362635844707;0.92609330465613049;0.20987449978873576;-0.5015356955393443;0.10146807592004931;-0.3760887555501175;-0.15015210021072417;-0.024501593743124741;-0.59310408450354479;1.0087453296955413;-1.0829251678380807;-0.77572076155678726;1.6736193764573088];
LW2_1 = [0.14657047640076623 0.25906873281746345 -0.89195839519292752 -0.31665911579981271 0.14184027529179344 -0.84247850662596702 -1.547857608647933 1.0269208318979102 -0.67603352406203465 0.19011676169111311 0.0094295032480302913 0.046792617820555715 0.36660655544256049 -0.069831556007678791 0.80681083315415647;-0.32663677527142665 0.42831100771979796 -1.1191599280909001 -0.63519899402711466 -0.45748764436031453 0.43395293356117109 -0.30782014179905254 0.98502465586579246 -0.42838247007091124 0.47875212698746628 -1.8127979993744385 -0.054872606122257438 0.39754448296572786 -0.12849693145963106 -0.19701704045929364;1.3617491965858461 -1.8707565083275925 1.1614839474024421 -0.89960533981926261 -0.40051423994821833 -0.68324228305532964 -0.59088706694048876 -0.32470132131592722 -0.66879437315753876 0.40416735570087287 0.17014441303630001 -0.72245256036547012 -0.25975451807829653 0.37918690208368117 -0.72636339355558976;-1.3085004888731582 -0.5216820596103533 -2.1645298082782589 -2.4043617554227987 0.37249098905614125 1.6036773177179171 0.18339373916384483 -0.3097771056017925 0.13126880504431698 -0.2284540949207253 0.55675975218854268 0.28491055740406568 1.5351960556758393 -0.11532054540611822 0.29381804668394523;-0.0015071361166705682 0.87376297582383178 0.20678423807756763 0.53048982991377258 -1.1385853695374033 -0.14667366523969461 0.4253752350236516 0.67792417698078589 0.42333910880840608 0.16094457794183178 -0.24152072660451665 1.4355942495576932 -0.28973110716173883 0.51910327377856191 -0.36617059101431065;0.65518050152047846 0.54000964491890691 2.0633256513653215 2.3800841029463191 -0.5819372020113649 -1.4913057939689387 -0.66811443998800946 0.18922850889248374 -0.67461647848750672 0.27770287332772048 -1.3775944339089372 -1.1586143821637034 -1.4814113052247382 -0.83344245805890127 0.54234453799201754;0.22895374546787944 -0.91226231669847047 -0.43125916197730346 0.26984283465213244 0.24711707467196853 -0.54223360049588376 -0.055144498237343992 -0.31980799245343583 0.084095768012849736 -0.55378062952514162 0.36866602223640976 -0.11542552592863517 -0.14467596561828724 0.10231779606593377 0.0064603607725665872;1.0915560215295481 0.10680728410693116 -0.55749943960126247 0.6658787533336864 -0.41309564946485111 -0.74215305461240233 -0.039146110238857085 -0.12584082151691917 -0.026549534946652683 -0.11702439555883107 0.88863029004942218 0.17118256393198444 0.15262590224187658 0.508893017358232 -0.31347154911081399;0.3838516505851412 1.3049344958198552 -0.057689353217102862 0.72558927331236511 -0.58651655876196707 0.22974699342738825 -0.6881334671829249 -0.45447536668071525 -0.78629099358155796 0.085896482883121739 -1.460682958983516 -0.19713134309089919 -0.1597380295350484 0.57277264010755147 0.49162513720611412;0.37790657738219591 -0.2549648085977716 -0.43116622239366986 0.18518446704726099 0.042869223128611841 0.044953683291447652 -0.49434935029082216 0.32999282435530153 -0.33105718255169109 -0.26897942823077736 0.33974215415335901 -0.1034776462035287 0.2757436461314014 -0.72269430880002417 1.0135839874311081;-1.1663494670150425 -1.1293798149370338 0.20143382157890835 -0.29559256123005151 1.1122655307597933 -0.20838371236184544 -0.11649753386942388 -1.2208782802571949 -0.09517589256014794 -0.15589219580103009 -0.33340178728674946 -0.42088167435662482 -0.20183254351319094 0.21060850473257514 -0.16071192992016495;0.4631696001104334 1.3890829641559352 -0.87186916344666399 -0.092219087750541842 0.21370802928608729 -0.2342887291663194 1.2517357810435168 0.32259830184496829 1.2540020469318993 -0.10373685710204236 0.43439869034505901 0.97440871328043965 -0.80662818459624719 0.62867038655476082 0.60481095349854053;0.24264948280753806 1.5037561039331107 -0.0014167427824345966 0.60424687587043757 -0.35730337042170818 1.2250365933866041 -0.45480753173119498 -0.53023368463857223 -0.22988204007386698 -0.03955147894716915 -0.85000974376639626 -0.28323175473020817 0.48019251383431338 -0.28738562203107898 0.75335370838461624;-1.1726090483751985 0.18947200403134257 0.018470980660020536 0.018638291813190086 -0.39776746775602306 0.070170647748814041 0.23019331674186064 0.16211211663440805 0.4031877567194776 0.33514776983077216 -0.19426460465926695 1.2084322373936935 -0.057922909250873095 1.560232780888712 -0.14921539930512775;0.79361639238157478 -0.41487626373074765 -0.36500092367387604 -0.057553463160869567 0.011717119740051952 -1.3621561618374185 -0.43174973145712126 -1.0883080870693831 -0.6809218364491374 -0.27042665365023627 0.05705245506666938 0.49345539261277016 0.76197574464083351 -0.092994237666087207 -0.50738640183625972];

% Layer 3
b3 = -0.028749323281672706;
LW3_2 = [0.27274330472955455 -0.2422753130611425 -0.47925314325600599 -1.1967829092189535 -0.64963505018125423 -1.2202009306982013 0.69287187454476307 0.40150863346141391 -0.26665975391464253 -1.5565227292871275 -0.98401190520587456 -0.80673459785328883 1.6048814062507453 -0.39429215002572204 0.81490353018920092];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
