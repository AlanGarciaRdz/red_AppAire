function [Y,Xf,Af] = O3lomadorada18(X,~,~)
%O3LOMADORADA18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:41.
% 
% [Y] = O3lomadorada18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;17.6991150442478];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.8959181987415366;4.2080717459400878;-4.4702779260907448;2.2108506166611699;-0.39762134211163891;0.49330414570271441;0.82200953568826918;0.43389415873825865;0.20879552707326335;-1.4748532909278251;3.4312377134352636;2.5129869070252258;1.4588744301025742;2.3390727671254936];
  IW1_1 = [0.63798074813395356 0.46428550380721889 1.6221465967025206 -1.2982229419220075 -0.86672993334348669 -1.3367065849952071 -1.1972525589922947;-1.0318511412983893 -0.008893044766626999 0.10417642209794473 1.6324138424016643 1.4267982454860475 0.14579857781805969 -0.3353479918907486;0.90883221855306517 -0.016129602211761046 -0.16625325390279536 0.2289871790727947 -0.20860765629925765 0.47481239099245276 -3.9113669918874265;-3.2910869778149814 0.43450031785017335 0.28302894141357554 -0.16923669888677759 -0.078459323710251189 0.29504610926719005 -0.0019568448126856125;0.40020637855378521 0.076311626489886278 -1.0592936052199289 -1.3298350935223324 -0.48110657996010869 2.4460141552613144 0.62744278644579865;-0.68974241693408922 -0.91173163753487307 -0.037855015335473759 0.067936434423738756 0.12886209145592734 0.12457706600727503 -0.57934192669117401;-1.7471013441032295 0.38411527764541153 -0.40136546577505566 -0.32157013819967717 1.456417733783407 -0.36718083184584416 -0.60051686668557069;0.41480832312986277 0.3362517460457749 0.69806015398393473 0.46073739444332396 0.82068180536931978 -1.3550048688086322 -0.85223739893688055;0.98479500280108545 -1.7134600626516074 -0.5391215471339228 0.4212929672368772 -0.45763412987334312 1.0650900645667163 0.46662365602073008;-0.90456214985003636 -3.2341318077879015 0.060839756705408546 1.8983731654817841 -1.1981076658799519 -0.0016678919806883616 0.13966147480021016;-0.41540515460251604 2.2314460545000037 0.26132723825481352 1.38289288765082 0.4925006593557158 0.35942593668455125 0.28620647420035461;3.2175552100106577 0.99716299807057884 0.39434573244476762 -0.42429681281284903 -0.015752732070815102 -1.3629278577673349 -0.078039658306076704;-0.26840074061864033 -1.5383232765770487 0.31670867525930058 0.28261678652516875 -0.034993468364082111 -0.44000990774595672 -0.37157551629581898;1.5226137963673887 -0.58368246993253292 -0.048633347648903889 0.10315252908948162 0.28379748651615239 0.42779056499382428 0.067032881287916804];
  
  % Layer 2
  b2 = [1.2474069042488538;-1.1001135786379455;-1.2634421903472879;-0.93475029734999793;0.98039961048023883;0.13814592145229318;0.39974109744216446;-0.79542411310809047;0.38920310762816757;0.11430568693374496;-0.12657829836452805;-1.0375993606985254;1.4263545873496133;-1.8500974105206396];
  LW2_1 = [-1.0388074234741775 -0.51050550796361172 -0.28684983043922374 0.42429162877178617 -0.47251495753269845 -1.6581985847570631 -0.43433770872494903 -0.85517213487805943 -0.18762706608507745 0.088184714508765263 -0.23848280452065185 0.16127935571208152 0.8725831010585603 1.0122998412396187;-0.24706690805660353 -0.26583019596486857 0.36593843396375614 1.0688937239136003 0.24122352675877368 -0.69674088416847968 0.13606168607948457 0.78113651654063765 0.46606334031786428 0.95135502473619216 -0.23546162160885067 1.0920032729755063 0.63644707376947474 0.21790522759797185;0.079452500018793865 -0.44889621187626128 -0.17561576727564426 0.69169545081383887 0.53606422396436704 0.55827314603435485 -0.72273767563994673 0.41042592926234556 0.25929309204856571 -0.31667045203738775 1.110707402214463 -0.82327937007855789 0.66092895682895725 -1.4315194598485195;0.76202581010171599 -0.30208376504405987 1.4786728584921174 0.7067520651577559 0.57444508123399018 -1.7493669606956306 -0.3644991448274213 -0.35077838405574691 -0.39757018758540863 0.099774173869862981 0.29402383154978085 -0.41657341736649633 -0.78231371747937484 -0.25876140677741466;-0.63065131452137835 0.97438205662039612 0.10828986229718035 0.11573958895510164 -0.59981778989725243 -0.29218291693837373 -0.1210307145056795 -0.18846332718202663 1.4673759526799579 -2.0778847232154884 0.678970482814787 1.5379404936943226 0.39200655003865065 -0.26432540148700301;0.19043501246909056 1.0087590820105712 2.783553218530229 0.10005973865227978 0.14270030762539584 -0.16354296472160007 1.2006336073083625 0.58903898806379396 0.2128808185689163 0.0027898687589035295 -0.047752638711894689 -0.84474500626628046 0.88824877163752536 -1.8052242004020624;-1.4982810566809952 -0.96549711941032057 0.89178984111546422 0.98672162019091869 -0.18020694293754724 1.287846070059977 -0.62700385858884955 0.51755594628035373 -1.0698016272200528 0.38098469303257604 -0.25323868187984677 0.68423550800133792 0.39781071661724221 0.71750918406223418;-0.13983156128992164 0.89989846967573928 0.29174899217451461 1.3121402854197637 0.78601028913426774 -0.61522614330582992 -1.3828138520122015 1.5463795319822553 -0.13589104877402486 -1.2614770225209029 0.34763146925183136 -0.34137359999930289 -0.30096285888359808 -1.0143948362567641;1.0945530255092211 0.081055219670051609 -0.83454372521026299 1.2505444503956722 0.069478470532281761 0.17202722487023281 -1.166902079572335 -0.36952081355703298 -0.17782946033825719 0.20022433215771865 -0.28429100780434552 0.44376846934550807 0.76182991867965144 0.98228729992792985;-0.022846868620924568 -0.67319264243895005 -0.17087496488664677 -1.1937074844174513 -0.36541388526598173 1.4939065356273968 0.52041062147361816 -0.93924951237977972 -0.78479433802108367 -0.8787016078308848 -0.28501548291819767 -0.43174369762392756 -0.83370724348653491 -0.12458899363258691;-0.30556661242138777 -1.2659699324246261 -2.8452978704883063 0.27623113954239659 0.48436194813022582 -0.3775636234282394 -1.6812257679371168 1.2513026768995719 0.94864230664845484 -0.56875767763156493 0.79443360826906084 -0.29544831962934948 -0.39062048055790305 -0.86719783500532954;-0.60577558764093886 0.65368300872457263 -0.48934284628822083 -0.79171324081614702 -1.2686607471264786 -1.5069585904259493 -0.53562291412603313 -0.19325835552925585 0.81087523555397101 0.074369840389062664 -0.73279619412149255 -1.2880955988426313 -0.11715304202545723 -0.84391047381010398;1.2452502635546945 -0.12655112508975691 -0.34934702968948494 -1.0699777602534035 -0.29158563659261305 0.8826179563813138 0.49628362403975951 -1.1971900809776943 0.56694647980883051 -0.37917911298974116 0.83614545155362996 -1.1830166746093258 -1.0053778316866364 0.12530061291381198;-0.63648490169917948 -0.28532992032638099 -1.1401295625104348 -1.2143692741497736 -1.6554030792030328 2.7508263729822566 -1.1767511704328397 -1.272951691953544 0.5017524403290885 -0.3699120896196747 0.6735836655431694 -0.7353581857859135 0.032208367796047632 -1.470895434508986];
  
  % Layer 3
  b3 = -0.43561079021885846;
  LW3_2 = [-1.4424044651040857 -1.3233800854530202 1.7814512468054875 -1.0132009252496856 -0.95697345789329635 -2.0717546361970549 -0.64562847764088982 -0.4906284124046324 -0.88263795091375874 -1.2910477581903153 -0.26324546561894052 -1.3949874722191353 -0.88534261720911589 0.71943626955249129];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 17.6991150442478;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
