function [Y,Xf,Af] = NOXAtemajac15(X,~,~)
%NOXATEMAJAC15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:16.
% 
% [Y] = NOXAtemajac15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.04040404040404;16.1290322580645;0.0210748155953635;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.7196672153375743;5.5277650416119855;0.20630346156882029;1.361808766902816;-0.18591356420186117;0.17077026171480847;0.76160184049520352;-2.7575966636984859;1.5832704945200369;1.2134752579147292;-1.7963168919717536;-2.0689199679584371;3.2858211947790279;-2.5119676862946596];
IW1_1 = [-0.38198090698772236 -4.0757092774520132 0.33426042034530679 0.13587120825102639 0.072832523412758698 0.22743776132991872 0.042872512171064442 -0.072672864719103045;-4.2481203674550478 0.24297002468094986 -0.37515913285019953 -0.51030659227655273 0.4304623680948112 -4.0556345824574409 0.065320290551882321 -0.39984568260698194;-0.14650297665566817 -4.1607930256941996 -2.1434743000590193 0.088090353276335701 0.3016999756249773 0.17269908980090856 0.015476427318014428 -0.033366275572304392;-0.45038589356900138 2.3462100476577383 0.48318393019962458 -0.64191802550339683 -0.86014861631950534 -0.71518545039372072 0.043925465015409774 0.63531969488142404;0.29311257655790907 0.04906366915247564 -0.19561270873385722 -0.043318756001641701 0.88147720441595323 0.74841257412774997 -0.0081239853663951835 -0.51307239591318432;-0.96908215491513505 0.17614954670301192 0.28223752629914106 0.11577578157508618 -1.0826175464891399 -1.2360387428462638 -0.06728623142683246 0.59916670731710231;-0.27147505922001858 -2.6983865518969523 2.1185818664178648 0.47652059838858679 -0.83332279868816994 0.18462864640894761 0.63525466497659355 -3.1377383869393185;-1.0252447241288216 0.47749097180438227 -2.3745194629152886 -0.07822361405390664 -0.64414992642779334 -0.62982623338387356 -0.1626679693374706 0.3495742682325142;2.3009115491452508 1.8342739239061061 -1.2188577656905371 -0.46758837905820949 1.0671043947968544 -0.81868766547283234 0.224157640351073 0.26084683212418597;-0.25941563030345416 0.090729898067043374 0.36691440916246154 -0.63953065887015659 -0.017944179540265934 0.41388225290764513 0.65996100037739513 -0.33860397331970821;0.16609301172966529 -2.0370031518745146 -0.84142832468547757 0.56189356110669864 -0.74845749088872349 1.5525610267630634 -0.040698432668746898 -0.67496231733844381;-0.20138066201774255 -3.6465692659693096 -0.074094705006221104 -0.09679180932390874 0.11298430369164479 -0.10629886583280726 -0.15550816498964087 -0.13052432319609203;-0.26541139202241615 -4.9557370080757188 0.75959368654977411 -0.023493085650166123 0.43827765241514938 0.12016753334885967 -0.07819794406180354 0.039790822503167463;-1.1338825040961964 -1.0729221291990774 3.374924006992666 -2.4531233439337625 0.50476734252406097 2.8312632432154041 0.73699797163898617 -2.3143786192400255];

% Layer 2
b2 = [-0.73415015667788386;1.3462705154778523;2.4935962020886167;1.4722963645254037;-1.0212837962797643;2.5771036819266895;0.33086899714307283;-0.35989891030012455;1.1755824982689826;-2.5433818950538329;1.7887832318367018;-1.4337044715477993;-1.456527682378129;1.8007834835964363];
LW2_1 = [0.17826823369485731 -0.082671938659698435 4.4469487983492195 0.11297118941626477 -1.1420277488376669 -1.2321232078200288 0.44823565292721673 1.0910555253329854 0.051047624677392947 -0.40840350508063095 -0.4129258930692391 1.3656323968951838 -3.7675665837418673 -0.17085763005963917;0.060761798431094936 -0.52640622806929571 -0.27401089847593679 -0.025016037401513393 -0.86743210543696703 -0.79190098950243382 -0.17540315865217265 0.54524495280155483 -0.47071779791743951 0.55901632845700056 0.27858278488930432 0.98136384546681221 0.82940486904030375 0.29571803497414584;0.36746345513387235 -1.4103302032809546 1.9460017424581464 -0.20458195984301009 -0.82477694005254709 -1.0744945473477814 -0.19646152873423212 -0.15476235085992071 -0.69079527222683623 0.053324557476559065 0.44179685537280028 0.40446248515904687 -1.916278389619545 -0.031318970582938505;-0.14672809922620758 -2.1214830302825431 1.4395720991515606 -0.25392733501052178 0.30895669680244808 -0.28057419522859089 -0.15227748663032195 1.1207576622021596 -0.090187475069547704 0.83853928102258679 0.41259271730832553 0.1240344173304414 -0.93072609796997563 -0.53517433906392997;-0.25829404808495626 1.3279602929530387 -1.5046229978723187 0.18151199158119796 0.76510480171152662 1.0267313003032472 0.082719295080644711 0.080565543636628822 0.63972408908550171 -0.083601721395110073 -0.10158624896673719 0.5013650306710653 1.2754862882360083 0.17438890332442308;-3.1891112465542979 0.26314203614355164 0.38606578828394567 -0.35513313197391538 -1.3296115026470656 -1.2021231596885324 0.15866203147658831 -0.35357758114552879 -0.35084321016510972 -0.51152133322012316 -0.12310562695257997 -1.0949246216420752 0.98243456141673668 -0.1399151933687629;0.49972325656941724 0.11932108150635228 0.1241021410144071 -0.57010801585484994 -0.84934238887624169 -0.59400520037666427 0.234205915759503 0.3148037648665854 -0.79436487299099046 0.27748593112423514 -0.06551433247215882 0.096661663404615461 0.33090379814851656 0.02797134120365842;-0.2851563378948811 0.38238692750198122 -0.76822366426205535 1.1292846786534285 -0.02053483359669064 -0.23891097737998288 -0.23818182233157092 -0.06174025800785056 1.1807879338087957 -0.4231440099285827 -0.21710116441941585 0.2229191670245122 -0.37902448934265809 0.075814757060265622;-2.2723639658869024 -0.91516199107075225 0.28061086061285839 -0.068114641947730745 2.430031368341484 2.5527487683908863 -0.46553042215755869 -1.1410408799938616 0.2917472643203714 0.69504749308433911 0.70828882760406231 -1.1634032506608296 1.1070094642036761 0.10372995105429612;-0.12662627761260994 -1.7257773377662862 -0.69023113592098673 1.2059761699536526 1.0707476799824314 1.4337131858691046 1.7270840155369576 -0.77401726903132995 0.29446130364884654 -0.69378607055765795 -1.6734984634351935 -0.15077646457826044 1.529818405538558 -0.35028870114868432;-0.86913551633598685 1.5030414801003047 0.11186391240835537 -0.89841166175636444 -1.150306962607075 -1.4917028947644684 -1.4843618384295003 0.98848585392645205 -0.65390425013282705 1.5109391629503497 1.3378365995628896 0.062682554694597992 0.024438932780731733 0.43921633111677905;0.61929669375682039 0.47194896200481695 -0.38559490594662327 0.86643440258840954 0.24861320940733689 -0.44495249362209444 -0.20311519302065806 -0.70058728348690769 -0.8014807042114882 0.059364191866183386 0.14737071184349407 1.2297729680756397 -0.65597853150576657 -0.036373142124544892;0.17292107875943746 2.0042927081989417 -0.69013594227252473 0.23061728043505958 0.19431537845568314 0.72683739743253262 0.27506991706151251 -0.86768255139797745 0.36612353964434485 -0.70898219076680369 -0.21298982397162294 0.036166214454277722 0.15343731228379112 0.21837601881528834;-0.41318086026871498 0.15897429900995069 0.27077815366908825 1.3520090609965267 -0.11659070735417018 0.79779116773692038 0.43425257231165881 -0.13537123710804891 0.43238755855356698 -0.68556354134834119 -0.039887039710277662 1.0039044391953131 0.74308307651281869 -0.05055494923120931];

% Layer 3
b3 = 1.6607647998170543;
LW3_2 = [-1.8054693462062104 1.9511829502553022 -1.7847224810895224 0.95695629535723736 -2.816769785971049 -2.2026286269986071 -2.8487986635720031 -1.0827042889340681 -1.7432961054635672 -0.70325983029786721 -0.9734259777318286 -0.84495282447500453 2.3373783559013921 -1.1827058611287484];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
