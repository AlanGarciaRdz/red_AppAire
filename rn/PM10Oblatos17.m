function [Y,Xf,Af] = PM10Oblatos17(X,~,~)
%PM10OBLATOS17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:24.
% 
% [Y] = PM10Oblatos17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.2749465941321911;1.7425094326167074;5.9234905547375014;0.076492426097744662;1.2805922578884616;-0.24214238648862976;-0.099978355407116831;0.67781436669663198;1.4229167553012272;0.32979600817002341;1.4884045853760968;-1.4114379755914537];
IW1_1 = [1.1082058349774138 -0.94486132605337747 2.7770212677794501 1.3004630787775915 -2.1882766896963171 -0.12037980738610229 0.86698961464960311 0.56153160957800985;-0.34307855980707597 -1.2388382244545757 0.79353043676968582 2.2303132155371523 0.019905060569988246 0.4228964330459789 -1.0748580446498819 -0.017240749651864271;-0.27761664970754923 -6.1019514132548673 1.6501938605699458 -0.7711274078818704 0.65299435369562642 -0.12943741231943509 0.16332945963130313 0.16848546438947812;0.37217459673253361 0.77131670324308133 -0.53649136221220139 1.3527754390600453 -0.33883096880767616 0.022267284834129011 0.022461401317090686 -0.22557681000886012;0.28317433777813428 -1.7211627692415301 -0.02664186870693605 1.4737178549067369 0.12249999795196119 0.90957554103206661 -0.83155681563675243 0.13345620127260294;1.7402914334091479 -0.15368550544568527 -0.11326323011247344 -0.86922421060396549 -0.42951717168614478 -0.065315561843943049 -0.14172795941980329 0.070414338768164386;-3.2777991322000033 0.13290421700469965 -2.4545232541275457 -0.55034691171865524 5.3292903001725005 0.11661994932563001 0.5858747980802349 0.53072042227841709;-2.7927600510735497 -0.23201093586318897 -0.074299346088453219 2.4509824867492838 -0.18286774640489065 0.66070542765608675 0.21263737595433677 -0.3687732852492428;0.02449442685336169 1.9564631102938543 0.5559822092742901 0.0994359412021939 -0.33983800241843243 0.61828050940696055 0.36666965270974389 0.3267474665858135;1.4709562257094562 -0.61807717584711663 0.31155246934381775 -0.68095675815183576 -0.5429349737637893 -0.43651021767233367 -0.20877936225192167 -0.15342651893794848;-1.5974114878839181 0.23796595717186184 1.1928397482704707 -2.7031215752156537 0.83570002732913917 -0.34704636972157621 -0.07639562833185129 0.80470775955474716;-0.2743340156044683 0.82121701670024327 1.0902646099533335 0.058881752065481421 0.13012196870605552 1.616358770427899 -0.51855280003318471 -0.25012564143260185];

% Layer 2
b2 = [-1.3772872520898281;5.3674804222672012;1.0166690706084536;0.8068081190368287;1.1613929945533781;4.3001228802195355;-1.4257867060615548;-7.982785620639552;0.63424351680099;3.4310613814732185;7.6514201413504512;2.3339080846294369];
LW2_1 = [0.58155178730525914 0.55622432240913955 0.03935942550665085 2.9205996117346777 0.60141511077992538 2.4239204959335305 -0.50634330574425956 0.24675000092587346 -1.3666279742354086 -1.331652759990819 -0.050893971055991936 1.1105416150512215;1.3301848339259021 0.52143798102775996 -0.80345987156786203 0.81317447333435811 1.2692667742967372 -4.1953758433571089 4.097951260396874 -0.8165951862361136 0.74664233475803155 2.0554444549395758 0.90449053133228596 -0.8063420267709227;0.30118585070501963 -0.13439916714051467 -0.30105936190046145 -0.87271604025365035 0.02428120877696735 1.3143611513900371 0.16974447400669188 0.66384888982736268 -0.26429110845033843 -0.33162849514479281 -1.1639946899258877 1.4007902064411515;-0.047902106431851735 1.3833227649930382 0.26307608530573939 -0.81538619147101177 -2.4070337295628867 5.1364874257713096 1.3956800077831035 1.4642207571400179 2.20374144355692 0.61034878354606548 -1.2616272156898416 0.060639632174147653;-0.55207543431427397 -1.2189976847016302 -0.11795378611722224 -1.075577367948614 0.3317901701117042 -4.2025937342730657 -1.0931334116941243 -0.32443197728103368 0.75267099652777891 1.909395774452586 -2.7461513531710753 0.033312034642859568;1.1046122723833822 1.7168342022303897 -0.35746407382382539 0.96552779354128648 -0.034969839543914569 -0.64516797136049431 4.5775041353257979 0.73141227215281901 0.58956658132100692 2.115861906950482 1.5970758218635048 -0.043905332023096572;0.53160772571939363 1.1923140928149887 0.048014599755201906 1.0484263242403196 -0.19162787338578352 3.9197103791181838 1.0298799459940273 0.14482290068365777 -0.67706196321676393 -1.904559301501439 2.81119677132956 -0.22826712522046053;-1.3368807112461545 -0.9113926722813448 -0.29871078805820261 -4.8661613628245766 0.70192125575555941 -1.8338907668340902 -9.3564564231803846 -1.0137635170689978 0.3323364452660072 -3.3694157300160956 -0.18047763292796259 2.121111544191939;0.0072714889316650919 1.0937311997339012 0.49358032436847749 0.62049574734684043 -2.1159340748120044 3.340060320257197 1.7746249603545967 0.50354654263481669 2.3613073715342812 2.2610619922058044 0.086667831548529584 1.2569674785565179;2.8254662568719411 -5.2977847165088487 0.14037751214410787 4.9789755808979796 5.2210460694765235 -9.1932262757506606 -0.72585256625805261 -1.5096197575241359 -2.5957618311947144 2.4267592872813419 1.8247387568394644 2.8526699529900101;1.3342152140733821 4.2052905235960054 -1.9336016872083357 -2.6124546442764207 1.1755888995946324 3.3094558798124689 0.45138608069346148 0.80140566746053299 -2.1736619004441757 -0.4221861073964579 2.333387035722287 2.2370459479447664;-0.479601585917033 -0.60670543824705991 1.6444742012744058 1.8964187019929395 1.2133550689276358 -0.9786426669327597 -0.28117190204819026 -0.032454161722648367 -0.67384883898997794 0.44988471340973774 3.0880579175480669 -0.799915561478304];

% Layer 3
b3 = -0.011540707854422461;
LW3_2 = [0.4699625120670986 0.55482718339650727 -1.0029193320692449 0.54198204471514233 -2.3968424931683301 -0.49767683085045833 -2.2495676675521095 0.38006956824730664 -0.48312079925414564 0.10913875252800453 -0.084335058344851541 -0.95684476521966721];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
