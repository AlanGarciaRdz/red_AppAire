function [Y,Xf,Af] = PM10LomaDorada12(X,~,~)
%PM10LOMADORADA12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:11.
% 
% [Y] = PM10LomaDorada12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.9654415057776478;-0.42706884716823534;-4.2704977157697881;-1.8131406544312076;-0.96945800597196985;1.6234825004251643;1.4645741052327537;1.0908698720297136;-1.2436935526211936;-0.59705540959316949;-1.3230321169392678;3.6854923107327293;-1.2047702137273286];
IW1_1 = [-0.45921444843742759 0.38139823442717979 1.4891653151546349 -2.2635238618076627 -1.8722112828248385 2.5975242353244643 -2.195663117266093;1.8865416521075389 -0.34307716576388481 -2.6867280502996715 1.8605237833588872 -0.45944245442272713 2.6118692691531815 1.3450043785765577;-1.7697761340451668 -0.52415135285047543 -2.8706285873369897 2.3181050938439243 -0.29261569292298439 -3.5270544134450406 1.0564398415978273;3.0613620856382409 0.92812353874381959 -1.5891768995887561 -1.8407652223638475 -1.8713342476642731 1.2389613953559004 2.224396384825118;0.76354780240278131 1.4416938482985451 -0.77947061407983986 0.26948646139334598 -0.025767893717131486 -0.65432222633923665 0.17542476890175129;-0.65921004621909618 0.20243009912232152 -0.21368415705955218 -0.11538322300562368 -1.019656839831325 5.9321072408514066 -2.8799574502284924;3.0004919559235459 -1.2317806522047763 0.48251908956683853 -0.42922829306771226 -0.0049891206099433177 1.2687557238042451 -0.092841594558025514;1.4390386519159548 0.040263242968583371 -1.2467974085870697 2.5146590502515043 0.20001514505337253 -1.4454856590823966 -0.91827021987418367;2.8996735548611019 -0.22684277622338958 -2.1342220354686394 2.1860525918562677 -0.2101370195881358 -2.6826059378933529 0.19293236699250427;-1.8387593108538622 -3.3786972350036275 -0.50944258935504361 2.039485740771199 -0.91618203005226106 -2.6981096867734493 -1.4942197820634942;-2.3823342844112063 0.43563360074045004 0.10705670863027322 0.29270322747475291 -1.292424666274733 -0.53320621709876226 1.0325692973107674;1.106543429113148 -0.82767670141563277 0.22003573785673272 1.2021638497031726 0.4290720723130193 2.9541408550996673 -1.9117488512900509;-0.26431560268030646 1.0914433416792952 -0.12910837451789442 0.29226964180904486 1.1608726263634712 -1.6760819785597825 -0.24817444329149652];

% Layer 2
b2 = [-2.6551646269369162;0.49614002681411068;-1.5593338445702833;-1.2268526615417303;1.4177311444321632;1.2892634320949852;0.59694171348043423;-0.82007393666368211;2.0899220129467255;-0.78460077663900341;-1.2341500419992186;-1.3436716578777868;-0.14217169844256036];
LW2_1 = [1.8195169812288055 0.35470474828709453 0.6192990289423953 -0.21216155517330776 0.20067395235008534 0.15609384039936203 2.4248562141840471 -0.16948945558193357 1.4170787949687287 0.51284632107458072 1.115320079859796 -0.51417901791896437 1.173611078989663;0.20916228176324453 -0.19313378532426734 1.9858953360430558 1.5592655028588904 -0.92081605367321906 -0.31952296577731154 -0.71992595069595877 1.9737536962647297 -2.2330716583996559 -0.17864627488497176 -1.6542045756857302 0.53853665044074461 2.4061302659085779;-0.56038339223668276 1.0121791911228466 0.19124094938611164 -0.62020687699079524 1.6391109549813276 1.1368049278079466 -1.9920776691551527 -2.932863065131897 0.60626744516191688 0.83355816754248202 -0.043510525114910326 1.2204344505229123 -0.031973305073380531;0.55837995060420276 -0.02127116697169476 -1.1438169950330925 -2.1876854484719632 1.7469771570732107 -0.30693848110535515 -2.4969338426400101 -2.9628070234487986 1.5187784317757869 -1.3293923332066266 0.55951282779731137 1.8634073637668265 -1.5003784047095086;0.34781268007251487 -0.29299476414275327 -0.25012740046633181 -0.79799704868655119 1.2705337282238571 -0.030218390590631861 -1.1097919480092391 -2.4334868402866698 2.5772950266441064 -0.21469929929726236 -0.94239584399559528 0.86300087392259428 -0.56798871963378894;-0.081853566053971538 0.73228048163697723 0.004715930977108207 0.25913270652429587 -1.7516858532969874 -0.29218372181042529 0.96556692612685924 0.47026025453895504 -0.88648395143675784 -0.32639787922246383 1.1638775339397673 -0.72112469866910955 1.2788482741284353;-0.95762382989238515 -2.2858355620790034 -1.4931121775362932 0.51726880538217923 -0.38605171155932522 1.3090360386534226 1.5832515214691143 -1.068924708796154 -0.68140954431000955 -0.13197907764343575 -0.48004025112059062 -2.3246290553581286 0.30325140001326695;-1.4580448282887202 0.22219196523735396 -0.4007101734119573 1.2551116449627986 0.48294676832337602 0.1714803970703318 0.29963323333159964 1.2754386461274283 -0.15391265260510267 0.12017054859472387 3.0111956787834884 -2.0379768037296619 -4.2197759838165023;2.3177706730867302 -1.7417440562255302 0.97093701700516122 0.47645122835732373 0.52147337176207764 -1.5518262447717157 -1.2596868883241137 1.3515051160162619 1.3972351665154568 2.0604902490696819 -0.75367167971160121 -3.1877800103548521 -0.13121652568386166;0.26750205420607759 -1.4223788382223559 -0.90090558602627946 0.31082741126515762 1.5406862336767249 -0.065798536207273023 1.2290038404082002 -1.1401494549610982 -2.1159598619658921 -0.72808720866875998 -2.8106655410251427 -3.0939157494524077 -1.345632226371217;-1.1599774369336682 1.2912874573560118 -0.01188523058813333 -0.43663214294884173 1.8640311689806033 0.76572676483206659 1.6033256671379681 -0.17259274904576744 -1.7705039419532993 0.38775484460845433 0.26084888502605003 1.3610651784618633 -0.5785246918094693;0.59232185652194391 -1.7341549691502238 -0.014919873483578289 -1.4952106767680864 3.1930209332233064 -0.072016195299012181 -0.15648473075455965 -1.5706616441495107 -1.8265142395015421 0.061445724684946273 -0.25477762540561355 0.18583981526072724 0.9877660973098451;-0.14450259566186308 2.0218140098496957 -2.0177458485443611 0.61708286434931581 -3.0105473679071677 -0.47058675590108545 0.18806129948586361 -0.014477112914426604 -0.13326373320544418 -0.61608084812372521 0.74574199749094539 -1.5413908433638939 -1.0660154659424936];

% Layer 3
b3 = -0.50743849341843128;
LW3_2 = [0.75123345295371491 0.1452202394257395 -0.29293847809866141 0.1737227985649413 0.4410844566568437 0.41150298412485703 0.23305785617466834 0.047290835142511686 0.1092436535101545 -0.1274282725398046 0.36172884291211005 -0.19209958187826606 -0.12902362803401543];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
