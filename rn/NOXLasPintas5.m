function [Y,Xf,Af] = NOXLasPintas5(X,~,~)
%NOXLASPINTAS5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:47.
% 
% [Y] = NOXLasPintas5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.96825396825397;18.6915887850467;0.0175284837861525;0.0546448087431694;0.00640204865556978;0.138888888888889];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.88115758207545292;-2.2047288573127886;-2.0748533984613968;1.2938756294389773;-3.2768159900376794;2.8553627641213817;2.2861178258272035;-1.3506477048317995;-1.8341063559782462;2.7094281209927327;3.574381368798905;-0.64325769236678387];
IW1_1 = [0.1123537888044622 -0.17403713269939824 0.75072327450593546 -0.24956680571056844 1.1236020599688235 2.2739908038256686 1.1430180037373383 -0.34638970683269793;0.93931369201263226 0.13296837176499579 -2.7379829286919013 -0.24788838571232175 2.1991946601691659 -0.027282501081627872 0.21427325510597259 0.14742457057846775;1.8439076557041374 -0.11320710160982558 -0.44853399767235125 -0.3689704285112877 -0.16174994881796556 2.7313212998159724 1.485431067653429 -0.48737859290190527;-1.1254569711259899 0.21460345245169665 -0.43390926551196451 -0.3186494321974398 0.3669734851580746 -0.45540786017062962 -0.18238501162889958 0.32158151106598126;1.3875206835152591 1.3635559782475428 0.44895583174847631 0.9502425899352317 -1.8425584769716961 1.2766505742196519 0.12891241295671221 -1.2093695486885727;-2.603328814876019 1.2939148939938212 -0.50056676227829533 0.48568723149456439 0.20031004210694009 -0.75718248335073823 0.044455172022713749 -0.29260048059350491;0.37903791652093283 -0.0031096909050348093 0.8824745320573103 2.6907392587689802 1.1501500002452671 0.0097529379278597228 -1.6496863000517361 -0.0072451590317318473;-2.1457989404932314 0.68856753446175145 0.82941272589650794 0.93843330919828316 1.1697011652871951 1.8556544318796804 0.39993621067981472 0.42871002131633817;0.12089050219390124 -0.41828510193585289 -1.6330519940068564 -1.2692848727536354 -1.7953422722470023 -1.2853926499576644 0.64515028915634554 0.11847425445317884;1.6353486300120523 -0.44408432158801175 -0.34919817647331236 -0.4793138773439648 0.88582070429625281 -0.034963368599602099 0.61321420506309865 1.1363431928245782;0.48820832405537645 4.1944890220604645 -0.012808840501645623 -0.016039894926277228 0.12334941044811175 -0.43320632278263493 0.05574478536788155 0.33861287977698884;1.1109264237733256 0.9024040510869753 1.8428679508460708 0.68713444796986911 -0.68839560164130098 1.140736743239168 0.21984079478462476 0.58380792940498516];

% Layer 2
b2 = [2.249509023055658;1.6661871642231598;0.66258044271977057;0.87652206744480221;1.0988827125845277;1.1196494986131356;0.14855704838370579;1.561812960424708;1.3100216535935592;-0.56493638782490907;-1.2451524551312614;-1.3679534905621971];
LW2_1 = [-0.99774484415071385 0.40161796109188225 -1.0213495649594753 1.4589538625782794 0.99835343957795342 -1.1574170820032141 -1.8401304434218433 -0.35555632384762537 -1.1058288986915508 1.8104209103355386 -0.3934729973243824 0.57109310484456965;-0.85155376303349428 0.19044915173237845 0.25036069994494309 -1.8112843134397221 0.14990510878006311 -1.3523612912447183 -0.65093639067164166 1.2403611502691037 -0.50304312739193868 -0.39094874136078711 2.2751919539364431 0.2586535177201803;1.436065599103878 -0.29466715054819081 -1.2451329324044969 -0.91317443845673996 -0.73320553613592476 1.4122961666008742 2.0533754875939421 1.4049965697720475 2.642003285687013 -1.4912297352177297 0.082062069660500406 1.7457827638521444;-1.7092133181378928 0.1592071747702197 0.53285554255232925 -2.5780639465341095 -0.40003961456644477 -0.22426531768073552 -1.049641967963149 -1.4612147092905183 -1.2088720508609061 0.69808161582168315 -1.6139587640406392 -0.82847415148720593;0.58869396989491196 0.078580837669944337 -0.39714473327883154 -0.98247971011567814 -1.0156142669380805 -1.9344853116380751 -0.052170220269224202 -2.7874696948449369 0.12063698981310335 -1.8676536000356982 -2.4195269613586095 0.16219707266443836;-0.53261615708457855 -0.22859153357062648 0.70231965251864548 -0.39042865402446958 0.61352699397120625 0.1993402452455727 0.26164614166223205 0.65444912411733192 0.088259178195912641 -0.20140505446566878 0.02880597094177061 0.52796696141708144;-0.60510436276429624 -0.13204631829386307 0.97521075347066677 4.1083922347443744 3.0404131524236688 -1.5432415228814769 0.06183893797312584 -0.86448633902073457 -0.5815061408403106 0.99929408038942968 -1.7477561590307722 0.019676584337427194;-1.0251398990241913 -0.44750976532936243 0.21449314862303545 -2.39221001684274 -0.84152880054515755 -1.9540939517088527 -1.1435514504990225 -0.56593949615648398 -1.8148399387319198 1.239797863626279 0.12341083110832882 -1.8557215324075602;1.8747442823044871 0.059548293983036057 0.50547837776994098 0.55445237336456565 2.5456970226757605 0.71171133416647481 1.3347051063894766 1.6943532948668256 1.2374024502669412 1.0108159960696754 -2.6859065996417888 -0.67964428945607813;-0.47701059844450316 0.80626036384701294 0.69390981752494996 0.76071808046552991 0.24499692713424692 1.6984409368851576 0.29720335258831299 2.0716333095392709 0.70641752285948789 0.54998229227929796 -1.0803117105722571 0.72674527530065369;-1.0755375353191889 0.34650915897817836 -0.17322588927539001 -0.76325777922081395 -3.3416584913265055 -2.1210892160804362 -0.90048152629540268 1.6172412767464479 -0.40445293538638155 -0.86236992213892971 3.022640428223057 1.2896694937874944;-1.1279281058909352 0.073981054229794924 0.037063144855369608 -0.34552287119769232 -1.9059272626833463 -0.44674838003475487 -0.52500045467305689 -0.22230903953037942 -0.43405266061090031 -0.25135764027757779 0.24990561947115181 1.171080358010048];

% Layer 3
b3 = -1.5628148975864513;
LW3_2 = [0.57799169878145562 -1.9429029618621665 -0.29102122946057329 0.63650197863467628 0.48839274528326643 2.5933595076005225 -0.89032604304333185 -0.62921112380620192 -0.216539553194106 -0.34088498229540265 1.2013847326545966 -1.9718593628229761];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
