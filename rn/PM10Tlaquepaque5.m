function [Y,Xf,Af] = PM10Tlaquepaque5(X,~,~)
%PM10TLAQUEPAQUE5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:38.
% 
% [Y] = PM10Tlaquepaque5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.00773694390715667;0.00572573718866304;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.9719095805007658;1.2021287496356732;1.2477719241699772;0.99963682077164395;1.5652689760952621;0.90269941645791019;-0.53835308323568376;-0.66641607625192911;0.5728205916879554;-0.85767470862011874;2.9441784459946949;-1.2127701341771133;1.2771641830202318;-2.7630727586391535;1.4840789505692473];
IW1_1 = [1.0966032763968641 -1.0631909302614169 -0.86773657323880915 0.18742520921585892 0.64541496093109141 1.2112107275696284 0.0074251743382342163 0.23478840224696423 -0.22653145920738296 -0.52928267210391922 -0.034094151545762688;-0.09033992506356027 -0.12987414654128454 -0.044499831440806936 0.88768935105704994 0.43487940817854265 1.0298143691846098 -0.15818128364447787 -0.021495677937023214 -1.4387047130019883 -0.39188617964244027 0.37896223880150265;0.019530052097578243 -0.34966750218863135 -0.4719871235041122 0.47158216781804629 0.1504546981972314 -0.34910221793470492 -0.73573454888294476 0.51213847813348701 -0.72323437524605017 -0.051288910269294295 0.78694909615594821;0.17744261931991578 0.56524158348825726 -0.81811707903623654 -0.69363679505690334 -0.49383214999468161 0.84653721531253856 0.10491017801098683 -0.45326471377164534 0.35156480657892208 -0.71127941102888814 -0.20443665459548604;-0.71716090653763309 0.29016041463922726 -0.56463175035700996 -0.48976571488960535 0.79211909968994898 1.4594067345949602 0.29196594446289847 0.093621325956715837 0.076784937809522169 0.36580480958039979 -0.57173795944344052;-1.2951171248719864 -0.027135395673442187 0.07731439158143083 -0.6969468127696784 0.97707607859081624 -0.19605293600910526 0.21735626857521501 -0.27528219432271561 1.1351112818639992 0.23962970104245213 -0.42299042489595523;1.3972318050244505 -0.27296798141637169 -0.49253220520179847 -0.22099354535122409 0.3455739904403774 0.62316769207619249 0.22048023089406288 0.0022874681643261976 -1.0186382716792686 -0.28391803233695884 0.49382459976242105;0.58426571952726269 1.1495024355941506 -1.1032556738197909 1.1976526500861542 0.84755700592074912 -0.26946326549351901 -0.085750014381255582 0.29463144722203083 -1.1841423155405955 0.78775557677007091 0.64072309757194656;-0.052404446217503481 2.2866258179513679 -0.28251002852587281 0.066840295036845757 0.10124891682131097 0.49223420752200153 0.072074171428723549 0.063302820056070339 -0.53890716347558809 0.22778325919294873 -0.27911313847295316;0.63042305199195925 0.25671355621829495 0.069696123412178054 -0.53943777532194714 0.14650538117538209 1.5937465689227601 -0.32446402898802912 0.076409136153749557 0.13642253164947959 0.011536387200564021 0.79443340255988404;1.9620521136852249 -0.23847244219211067 -0.91021373496558344 0.77829432447955027 0.58927313970661122 -0.053671223493232126 -0.033105661654602825 0.1694301403617797 2.0283841097620869 -0.30700337762839991 0.16223954353467168;-0.11275512375891382 -2.0882181166303604 0.49570773698252801 -0.067070513302380813 -1.2459096978081496 1.7655493871792596 0.22706107978009923 -0.22700112714286172 0.42740276751483586 1.2145245568690195 0.18671392137198548;0.17709956331760507 -0.032744239011515276 0.29019254477445433 -0.3596692128306298 -0.97008742720052987 1.6511629891213262 0.23787320717164076 -0.088262818414706179 0.69603214329402829 0.66702007043287281 -0.22137496981337726;-0.36444185460281031 -2.6231223934535297 -0.31340170479426904 0.21482587935595535 0.09224646477453026 -0.18392027989004547 -0.023132194783676254 0.037005951373333436 0.10471277036964979 -0.25495923535266196 -0.37588381897624812;-1.2451070858125814 0.011983391843417623 -0.24252937678888006 1.2126739127602861 0.97626870328736792 -0.56019823657331791 0.21507897541901475 -0.086829801938111642 -0.54021327058761415 -0.30519573841859476 0.11755686293606947];

% Layer 2
b2 = [-1.4539676240125849;-1.3490121802667474;-0.8363636781913365;-1.0021561026854413;-0.27825385981456457;-0.19089024869720908;0.055123627377000481;0.39957339889872773;-0.45922022399634971;-0.24944815995777106;1.0378523429051796;-0.91486220550397446;-1.2497521991553338;-1.5405283264901033;1.5917753936961692];
LW2_1 = [0.049526658481425984 0.28512656525738722 0.76314830719179327 0.18098982513033701 1.0401831181857382 0.6107543949564378 -0.61404865082635174 -0.48435972009211375 -0.41111634254341956 0.50177911264167285 -0.84159933806082254 -0.17527883662656438 -0.75545736919817785 -0.41650201175961399 -1.3141946339441479;0.62603362154978515 0.012551415076862318 -0.11069948628863105 -0.64234356776661394 -0.25883528211294471 0.1001030718281805 -0.83673184824760205 -0.075779494102574424 0.30548599869039061 -0.66882385654103182 -0.66712034387131414 0.0078220633851361215 0.81489380909514342 -0.081878987801442746 -0.076658726787512899;0.15483955990911324 0.095740360517304723 -0.36264702554191841 1.5042808655667979 0.56861794935329657 -0.12362400362392224 0.67082185798186145 0.51068878388662375 -1.2742525938310714 -0.38356658978114461 -0.18807200723900319 -0.22706048692041159 -0.010941126855086818 -0.35558462498238691 0.27478686309485068;0.50863036801123929 0.20662075336792021 -0.75477545879158692 -0.61480625731709304 0.50867492724663244 -0.30208758345408881 -0.33032233101774389 -0.16162129185082963 0.20431031517442472 -0.62433949513937104 -0.19434458574689625 0.32476488948389653 0.65623432232191414 -0.17791471026133224 0.27494711900711111;0.17929439900532199 -0.78630001035240871 0.47682337028560828 0.67723102622118903 0.90175863213475604 -0.3804784149777557 -0.085126742745380471 -0.35823815566175837 -0.78994343023490488 -0.33009531664891695 -1.0700616085973427 0.42320061244363816 -0.66945717123048165 -0.49845866609509765 0.13381155057950309;-0.49422060249647454 0.088728513286110589 -0.55849130982022566 -0.65985406898223109 -0.46687541267035199 -0.236544678165653 0.15945318777298245 0.7958792386303386 -0.17404042205042258 0.37838237856701074 0.73820973748759611 -0.72700687860363111 1.4351566098087587 0.18906928634153733 0.96097901010466014;0.47044698273008201 0.21397763073135012 -0.44721554374863054 0.063693358923115964 -0.67188915187371134 -1.1498043127374351 -0.56220115638447798 -0.1442780645661226 0.18710227678677344 1.4856089099421588 -0.20995872232288554 0.12226814904894438 0.23120107739443585 -0.1731478274761889 0.10570931752134273;-0.7290042060528884 1.1440948359212937 0.14217186544471214 1.1290055141936548 0.86621655878862291 -0.013401183444552045 -1.2789120259518147 0.85290187855892163 -2.8314530638734849 -1.6262962721362704 0.55146742587886599 0.23286326107893685 0.36459413614158775 -0.37695636250593423 -0.15101249691258764;-0.26144512058641889 -0.18701707348793783 -0.66975760227223724 -0.83122119376858861 -0.29143280769216723 -0.1070441700880983 -0.41194358800239111 0.65999595231583552 -1.1804389371523545 -1.2937747570707456 0.68915103205862016 -0.80367673229940539 0.73982267534757984 -0.74222227335515167 0.31584063995939954;-0.58273453737047642 0.62592413492889254 0.25006372041317315 0.19022981876699521 -0.55911830688021291 0.066698099171065339 0.43400931023996403 0.56043690575383465 -0.39955410171207728 -0.32930242019930461 0.073308342727116088 -0.27603538796571336 -0.30260013267949049 -0.092617759216460274 -0.7414606057942954;-0.18120045876194757 0.29838316280395849 -0.402707826177714 0.42153497702468123 0.97360595597409727 1.3488916152749932 -0.10800999477477909 0.20143435495761469 -0.99270075032940897 -0.4688700686748748 0.43482910045570433 -0.21273241685066782 0.15960226229706881 0.36468321400991327 -0.57690872765048495;-0.41047407843512435 0.49344031234869029 -0.13072003704904728 -0.1403490765147144 0.55958551604019358 -0.89885733519256206 0.69219793927783324 -0.35647467975997188 -0.15742301758076277 -0.18350604141875401 0.1996151351464433 0.64066820257517976 -0.22632940678207478 0.033307970032533586 0.26727684472932423;-0.92650234736937287 -1.0632727261479231 0.12973750332743988 0.26642167986332704 1.1708300515951915 -1.0297582264560408 0.92662161490669004 -0.20414773090344523 0.047073401520310351 -0.60509090577906088 -0.44561213740381123 0.51903879949957721 -0.57917019930150482 0.040453041939256501 0.57394291454497526;-0.061596371425464744 -0.35090319971982192 -0.15438084141107966 0.28903754516133656 0.33808763374764211 -0.4063325588226171 0.1518069357542064 -0.31737327066820559 0.74781049691008228 0.68797218920911807 -0.76436732800134244 0.10559094719301353 0.073152463559866321 0.55208896793778872 -0.20070544006911809;0.98398145123939518 0.99464233032035487 0.88065817952262848 0.25765240436999659 -1.122764802273674 -0.22099828468868227 -0.24972357556125163 -0.37437067308735883 0.70507538130615055 0.061628200288506935 -1.0022905610760957 1.0995344466581405 -0.27254286656745069 0.7672151422575858 -0.18472765999494556];

% Layer 3
b3 = -0.11762538652667934;
LW3_2 = [0.50029747638832678 -0.62849203866187509 -0.58387210212765506 0.69835527955032806 0.92984393600397419 0.6724991404222127 -1.1170416068197726 -1.7317333465506488 -0.30709106137116099 0.68872479961083 -0.36011220978234609 0.5960562391074673 -0.64594629893609357 -0.78526120103320041 -0.38624572180642702];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
