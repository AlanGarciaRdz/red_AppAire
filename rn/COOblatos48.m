function [Y,Xf,Af] = COOblatos48(X,~,~)
%COOBLATOS48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:57.
% 
% [Y] = COOblatos48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.0271389249585869;1.7048391782832844;1.6011012632446577;-0.46698129762696178;0.54089189707522245;0.2149636088287819;0.049015739797252898;1.1850604250025181;0.38275808756593854;-0.84535587449336025;-1.1801799921954128;-2.2186524077061436;-2.5384266318180893;-1.0016513215854763;-2.0619191050886063];
IW1_1 = [0.027391055682721627 -0.68419506386627915 0.43614701617712776 -0.57151198665051828 1.319577303680334 0.29596511651936896 0.72784600809773259 0.45825360868328807 0.36551627006704318 0.14651831918165342;-0.66855858668299695 2.6454751444613733 1.005489708622193 0.19745122286011269 -0.91636142175210256 0.62855681930713658 -0.070370739508318264 0.54586838297963691 -0.26666482556839372 0.39609373191106739;0.0029113845166014451 -1.0780436425652686 0.33072168705958732 0.31405454167550217 -1.7300881240122128 -0.58278574048735998 -0.60109075430404713 0.12298127917689593 0.20054335218586183 0.026464261629910286;0.090951669322738987 -0.017080998295119471 -0.1778461661412406 0.86550432552412859 -0.96258851728495876 0.11305124625172505 0.27715766186458501 0.020466631510921762 -0.47494852275507926 0.70215529358260631;-0.69437630395041783 2.5231764855411671 0.57932246407210963 0.34499116733418894 -0.26834649073874195 1.0216566391328141 -0.0043753911795031963 -0.05308676360740068 -0.31317817487710015 -0.26984369715838774;-2.0033983062012939 0.054186904894129806 0.53350260943108518 -1.3244855571429273 0.37927407018529363 -1.1064507615759904 0.33633122805076754 -0.42293652800905818 0.66301154733082024 -0.44643518148210848;0.056759965352254027 0.39248143898334759 -0.66735726073539325 0.56242972996180696 -0.86136817693292755 0.50291884730784253 0.40434484050110897 3.1038116905257902 0.099292234010025918 -0.16730126040830806;0.32246617815806305 4.2708256817981614 0.5785608391790088 -0.38355827160272449 0.45523323921620185 -0.0094972576630689212 -0.13739595244016192 -0.50446980179625112 -0.088148895571591446 -0.029556779942329619;-0.71058145577795517 -0.42720368758611355 -0.84697924262132873 0.2003618573904897 -0.35215629645372171 0.45616332011403488 0.29252008529402623 0.054636299843973286 -0.21430580515179201 0.015756451447493391;-0.051923105852921349 -0.36950215239045475 0.86924193841531117 -1.5676489670804856 1.3961329861604967 -0.17641018770382549 -0.21612877000515701 -1.823543673344751 -0.31302919039806293 0.1098903808168743;-1.7207920761686075 -0.079122013404805278 -1.6493214600276129 1.1587960530116714 1.531200670705229 0.27371728975140852 0.26307620786361419 0.062027022371070967 -0.33756808643616365 0.47821419367560447;-0.48738739729084185 -0.89507127654748175 -0.10649754649855703 -0.49771450970393866 -1.8412991060509287 0.058485848422896544 -0.65991294747034401 0.55954538224053463 1.2870304978987548 -0.18083437454794565;-2.3743581327990864 0.98899807339590651 0.21361300578895406 -0.92077013931742391 0.30357378882618391 -1.0223497038335156 0.15352889162382932 0.36593400379657404 -0.29814421758699161 -0.30107684475276592;-1.5466877056565378 -0.13443516081483617 -0.41556828351192193 1.2161832389806622 1.0780857641621249 0.16143590529693086 -0.028598314498752834 0.57123526992493823 -0.17251492258881479 0.46781386499595845;-1.4625295099300699 0.075601340511922771 -0.31278629815525116 -0.50161892457878365 -1.0416194150746558 -0.5497237076233602 0.81214372967157133 -2.1823997590079784 0.4310555244887046 -0.13370992879216417];

% Layer 2
b2 = [1.7076701687112523;1.2492912659946416;-1.4544976198051389;-0.91573291014761338;0.64436302164625237;-0.4293473604428476;0.50310990731158756;-0.39896579540840849;0.45755064265237833;0.20882788574948874;0.61851382702319935;-0.71087485646844395;-1.8548013699053023;-1.89985799794318;-1.8890181420265899];
LW2_1 = [-0.54695362774430767 0.87349729556058675 0.48229706088680668 -0.52821264592206407 0.40918041750918854 0.66338065266308366 0.7491749167840055 -0.22531924805668496 0.34521369883774611 -0.26292869158736454 -0.49211761984752317 0.56343364857784728 -0.068524790760182391 0.61654682442033248 -0.18506323673621966;-0.17729010262090997 -0.56701765517702196 -0.56192163174778975 -0.37815157265661853 -0.78200098204167712 -0.56614046181764521 0.88843162445466295 0.19585743856469809 0.61571237532166012 -0.40572858263139472 -0.35668884219212871 -0.095850990544368964 0.14680893503242881 0.81713221094553057 0.54790409747473801;0.68854672988859056 -0.18532031548287878 0.43752423141782343 0.37001278165044982 0.063106717645502103 0.43438825025027272 -0.69291769060702024 -0.087432610988020659 -0.30725839068729427 -0.37648174342184204 -1.354489508485919 -0.3864553334823968 -0.32516554080458659 0.58998571003022093 -0.7130700471271405;0.43625680569665304 -0.21784783444895869 -0.10976903010430188 0.50764947106671965 -0.17291071927079135 0.61241242437069388 -1.0915377169734184 -0.28334138136925757 -1.2317060376081994 -1.1891459905208865 -0.74251190228866559 -0.68373505788670563 0.28016904349420829 0.13715049529806228 -0.51317637988031239;-0.39618002777752265 0.010686286887276689 -0.069952159226989427 -0.032603766220225136 0.45266397167522321 0.18873634407950968 0.080536566858681727 1.1018525774195416 -1.2192803687201688 -0.24625574471823605 -1.1029226887901888 -0.1676712620314971 -1.674990824943843 0.16961771783096954 -0.15607393214825407;0.78807405129231645 0.40075533036754585 0.4321379492414425 -0.099185796576804777 -0.42594898681331589 0.18047098440498746 -0.19743054534237467 1.1065327901776905 0.02951472619962428 -0.80575534148916683 -0.1523799240101319 -0.21309628262909255 -0.099912747814810882 0.41305199618338834 0.17093835471889651;-0.3391117086914654 -0.35045172679029424 -0.25454291182008848 0.35214363918212538 0.61360358714852181 -0.22591472872648685 0.66761482290103513 -1.1732349430895894 -0.42253850619618832 0.71112012387174695 -0.086966762066796391 0.28995774493680065 -0.11031916407247019 -0.40405490276669803 -0.12899592385436404;0.32035428232334895 0.81328633062060818 -0.22367850268732864 -1.2401772764374219 0.032237573389453246 -0.89211313760404287 -0.57892362126963781 -0.31657938527252827 0.1050408692265543 0.20416826890811735 0.52063154726102678 -0.21203098147025748 -0.090869809206233734 0.73027261346360461 0.59848452752731585;0.29471259661860827 0.24952258516812506 -0.33018504677594468 -0.25850943607146004 1.3096214143033085 -0.20054766489622899 0.15336295539186398 -1.3635389302986698 -0.16436110673995608 0.93837422660550474 1.0364766031893091 -0.11356684399862375 -0.62268880269611659 -0.071292739439163755 0.28345941810351505;0.37418632059972479 0.024378752954402019 -0.28574810101400749 -0.15772383395217293 0.57341884986385472 -1.15824764216789 0.71886136573205706 -0.25195181456054294 -0.56009076660856527 -0.22912885138338301 -0.46055829057363112 1.0647820991756662 -0.25140183567469082 0.31305118148298067 1.4380839755880368;0.57394965683010368 -0.8236687979941385 0.043436593922008992 0.2999931489775286 -0.51806113914497509 -0.11506380597126639 0.021384295982748387 -0.72978111794633094 0.45699350556094204 1.0550263972451761 -0.24417113469850116 0.040915643059205725 0.14406345384287833 0.39508095518891539 -0.28234997791992528;-0.61163217953518356 -0.55789531192451891 0.62826207109073529 0.62148812133470765 -0.2069116084444334 0.63514935400176908 -0.72677978234755791 1.9132717718689074 -0.6057104399211467 0.30081749928762186 -0.66039699071061975 -0.045222016381184518 1.1240630611042182 -0.93289717431282482 0.6563119537358133;0.37395009498570614 -0.42654301165159869 -0.5442469086780336 -1.0258508169244396 1.1613193431510123 -0.54250817691373654 -0.15310629034855794 -0.43444643180065901 0.67708391637965926 -1.1160270401240728 -0.031460574037109945 -0.38073178110058742 -0.030252493018587612 0.55775534733584431 1.0947313784803994;0.40440076999930435 0.6139116063746064 -0.16016537739784656 -0.1433906173090746 0.78441097816764505 -0.4264386192093742 0.092347395003808036 -1.2743815608209652 0.53293343705779339 -1.0863953565491884 -0.42655431749972483 0.16099941426610687 0.1829648043583027 0.31821410431351455 0.98507001747124012;-0.54406011947778543 0.55775956530830828 -0.6793849136433705 -0.30403410623776383 0.78186300582913726 0.54451878151198452 -0.8980944252265104 -0.66700999472898503 1.1377760956728944 0.49652674135424252 -0.24188114115516929 -0.17735777941493555 -0.55432167519743392 0.61951358941726897 -0.94643622395353255];

% Layer 3
b3 = -0.7000600085003359;
LW3_2 = [-0.48509834067690227 -0.54191439659839735 1.8702427483108559 -1.6096775299864359 -0.46788251763563082 -1.8851370371387126 -1.506399313229559 -1.6333334477521384 0.81769847123152062 0.32440107104839777 -0.8215279197490144 -0.3054708252861284 1.535265293632365 -1.1384917646338288 -0.9934301882726434];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
