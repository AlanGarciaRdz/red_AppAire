function [Y,Xf,Af] = SOXMiravalle15(X,~,~)
%SOXMIRAVALLE15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:36.
% 
% [Y] = SOXMiravalle15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.0208986415882968;90.9090909090909;0.056980056980057;0.0063552589768033;166.666666666667;45.4545454545455;117.647058823529;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.058576431913095;2.0852118184244386;-0.71398666666854138;-1.5153195510805979;3.727504410777065;-1.7096234533205266;1.0310768291034638;-3.4377274918254512;-0.57875018666633316;-2.4426851071007247;-3.5788391840594169;-4.2311381720526056;-2.5510008166763902];
IW1_1 = [1.5581633729060678 -2.0302556631415349 1.9042788281870942 -1.5170242735241461 1.4092017212660803 -4.0368374993012957 1.2641340032487516 0.53356244247427764 -0.8782888136702377 1.3256974087795832;-1.4547569918398431 -0.37150182672509446 0.93040940797328109 -1.9265334764648507 0.74019249222589878 0.51301648806191502 1.2577185523867891 0.26708051776807407 -0.039988839865820101 2.1286404483538721;0.57477906359437325 -0.6529133219461275 -2.7115123229961786 -1.3329029949022411 -1.6181364075185951 1.4980038151344848 3.5908975445987594 -2.0757531694115667 -3.9402296214079531 0.9430780970966689;0.44365245148778459 -1.8880062351694789 0.40987065105944526 1.3504200324605795 2.063250776657465 2.0785529054321521 -2.6383893941202956 2.2134554592666542 -1.4120034896468867 0.22791749547286519;-1.6414746464743881 -4.7963708720581177 -3.0689973732620319 -1.4830454476800969 -0.3569448499380064 -1.3241535605258217 -0.73810752199781959 -3.1369134897165609 1.2997886048320826 -0.5953620754258655;0.48978302617583397 -1.4706466571712633 -0.82160700472910952 2.1943277818841787 0.16900928061783332 -0.15360978625111249 -0.38737771714749147 -0.35432357547813254 -1.5156115908755428 0.0090512667805248276;-5.1993182578625436 0.1413559961553626 1.0209187808312181 -0.45426411589835425 1.261072240283839 -0.041480350238137682 -0.60085662380416427 -0.2762780968111691 0.64283855851497262 -1.2017377741447701;-6.5284294580502955 0.36981230054039654 -2.6835333873702143 1.6789975904490138 -5.2166621460677645 1.2297336924752855 -0.67514523756428213 -1.1815497476616428 1.1299056771323892 1.8456389236904809;-0.48041559397424283 -0.36669483528641017 0.72939052550768768 -0.23058159405887568 1.4567833571902473 -0.94302530793087014 0.72068025040326789 0.082399362169868706 -0.41779338926926163 1.0410525917607658;-2.9656234408428581 0.02006145938024214 -1.192226006881359 -4.5187243269834525 -1.5941273297560563 0.054161712418042914 0.040743734979646652 1.1669795861178538 0.094473293463360974 1.4013862313694898;-2.1772425075188657 -0.081137649514540083 0.22523343848151822 -1.9410601974132511 0.6795250549686912 -1.2983028763562141 1.9103123588116204 -1.1086032927938334 -0.29764306685547237 0.32053044887501814;1.0257637749237356 -0.017488210662155307 -1.0359524339021156 0.26319101418516272 -1.0007026389855256 0.22352537356944074 -4.899186652725823 -0.086589991303055905 0.58833369521671464 2.0585035016119391;-2.8283916834177285 -1.7226713178957944 3.4835945850481265 0.71966280645249603 1.5925688702301666 0.066317279653940561 -0.87174868272722028 1.937159235172969 -1.6597713593574364 0.13378363782885619];

% Layer 2
b2 = [-1.5898029261633466;1.3450692885622895;-2.3624131524920022;0.60914496755076364;1.5836254291231682;-0.58320991948077272;-2.1329232703764944;0.66619390753511232;0.10073628541648225;-2.7987461395219873;0.49050347507104874;1.0146593789537315;0.72762547164256952];
LW2_1 = [0.46172873314136864 -0.34130764894280674 0.20173767697016223 0.032765118636649153 -0.44065769497866181 0.16433594318627079 -1.7207522005045295 1.234940617068518 -1.0385848823977468 0.46972145013049643 0.52958117927102222 0.18698139616202281 -1.0887656450612762;-0.52872348400680302 0.23419954083076885 -0.27579667801030122 -0.3327647250525223 0.25792621930385246 0.013935424373995101 -0.0065241300871052774 0.19625869116215711 1.1789548219794155 0.72666515252900754 -1.4122677981656213 -0.62639346550997921 0.20208732358680681;-0.29643615236970727 -0.92774229270434472 -0.77133470308666086 0.26022384108444518 1.9494890884483909 -2.7258274197285033 -5.8085226923005102 -2.5147476033638987 0.5361009102389831 1.1166123678245363 0.52757564376378674 0.7698459291066666 0.22409208470197339;-0.17985785813430163 -0.85769610663106455 -0.77814929084006501 0.22403642746565683 1.8113522119068193 -2.6332063874733387 -5.9070276104616202 -2.2026631007255988 0.14243267015305161 0.99469503758367606 0.77135678444227962 3.2335707893929997 0.35254488446237903;1.0216934867059886 1.6340110487707187 -1.2248287640885769 0.91277822205454817 0.47557684111274051 -0.12265158947381267 -2.3401996119853634 -0.36132134708137864 -2.246084579828628 0.046125616892710733 -0.615618173493784 -0.81754273967337077 0.51440165878320565;-0.025959964029804918 -0.75612268404866656 0.12371526823171723 -0.1820085389203849 0.39118155143102212 -0.19433107304349401 -0.87976422557483203 0.6175953890861301 0.64271181349395745 0.01662079091963322 1.6849879612505367 -0.23557238911316356 0.43295499763609557;-0.95776063304490167 -1.6205606858222597 1.280504816525613 -0.94724978194010823 -0.51674250461708893 0.15335214626975707 3.6410127849147966 0.34898191121671285 2.2249741714392082 -0.074797557017084959 0.61401125082537833 1.5615873937259115 -0.53613927690981911;-0.39820211817864209 0.36867606420644367 -0.19459270627287698 -0.033741074337046921 0.30340823547757861 -0.11349997323582556 1.5730303643680084 -1.1328862786444467 0.92928196649837069 -0.37100004951038651 -0.84521296743940311 -0.1782920980592477 0.49007496647364568;-0.91278828491595443 1.1891630267819422 -1.2969167992469703 -0.84121148970892856 0.84674443585839987 0.64964308256134606 -0.40500362155540393 -0.26899163771065754 -0.25905832433864528 1.0851092106106781 -2.8887542658627146 0.82730973461038626 -0.23196672585515155;0.67450500454931395 -1.4015224284616443 0.064237284734439376 -0.2292263254034769 0.36401802691913193 1.0540228276894519 1.9764401888530363 -2.1386469647660986 -1.1200843596566787 -0.69839873451387247 1.2083114639435171 1.8649219392532219 0.23248302907182025;0.53440267867554681 0.95417864047378631 -0.2584813478293817 0.42041526834780624 -1.4049068256456632 -0.13791533723792004 2.7422958863812661 0.49737570708706003 -0.39145581290554987 0.58577673285528564 -1.4216710540250337 1.0952719757464051 -0.12226001069909956;0.11799143346654957 -0.02669959630826067 0.016614990329143015 1.2824518291550193 0.94615291285113423 -0.052034263915155241 1.0661385131234984 -0.15557218418417568 -0.48077072390382369 0.24623003274322139 -2.4467390043954103 -0.30610014020623655 -0.57655517698720271;0.26850291037591661 0.80964573259150252 -0.17215257678408288 0.39937807018689614 -1.3353443723264489 -0.27315032967554786 2.5182243131206627 0.84387843312986965 0.064718459071241852 0.81761782429263341 -1.6213916529746488 0.87521920725358493 -0.14316573154136167];

% Layer 3
b3 = -0.015709386252751343;
LW3_2 = [1.3963144503272233 -1.0036455259449408 -3.1868755868915892 3.1286136000996736 -1.6958021568423085 1.4385282417216854 -1.5703239400229678 1.5046094258721374 0.19973959159910656 -0.18715644293015191 1.2199302124778801 1.1127540099791851 -1.3046101423818213];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
