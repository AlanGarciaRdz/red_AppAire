function [Y,Xf,Af] = PM10Atemajac15(X,~,~)
%PM10ATEMAJAC15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:58.
% 
% [Y] = PM10Atemajac15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00968992248062015;166.666666666667;0.0561797752808989;0.00614628149969269];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.8425847347325739;3.0208855470228908;1.4440977515843461;-0.84894276484389075;1.1309489779569863;-0.48563767850986622;0.61646993902177094;0.81234469773976037;-0.36788072013763973;4.8107803897942789;-0.19398872850995091;0.56501795829020629;-3.7315540797861759;-1.9102412856251325;-2.4212738441514037];
IW1_1 = [-0.49478127480386053 0.79117272144383244 1.0450850015664908 0.37827779909580123 -0.44572231331788537 -0.20889640997259581;0.2045540891499549 -2.3468500778733201 -1.901443991866326 1.3128838294075447 -1.7337188716266789 -0.59706387717628651;-0.64201228830387014 -1.4650859346383061 1.3296776258933858 0.13532069072010258 1.8443541509670429 0.30175664380767347;0.80884290356204491 -0.8059051866950897 1.0940269581274606 -1.0241946404298503 -1.1702773024401072 -0.22282946673738929;-0.8533055238906655 2.3667853768313636 -2.1160895843460654 1.2958524582093092 0.089043750503674954 -0.35650533279531199;0.29638048761602326 0.57423985287200707 -0.99471998553570884 0.55125367553130755 -1.1511414458783564 -0.97676539322893097;-0.58197753718695566 -1.3206300072696002 3.2693878558572522 1.7504302939937069 0.20027742560756737 -2.0603457890286574;0.116207968872068 3.7625500006943406 -1.5681929105947154 -0.56167105730819522 -0.21680212307652719 0.016156006545267838;-0.29430371371630915 -0.30126294254144992 -0.10397232581547884 -0.24030703099425299 0.10909885214433043 0.23679648679003926;0.21165245088523355 0.29070121104705926 4.1123388068591513 0.065989841471220667 -0.12086260672145661 -0.065214031423420846;0.11161019555062474 0.73206240066972261 -0.82992161239903905 0.26996436244995575 -0.41018067300508554 -0.29204203329951228;0.93925660572037306 0.35159558685138226 -0.017887759251247033 0.19291456125703885 0.16300986129320516 -0.31306688339718858;-3.308785026090594 1.4169453885493712 1.3026023328985865 -0.87737071693821944 -1.9926687823244942 0.22253257553116207;0.31202020453538704 2.0345769444159565 -0.56446322389446602 -1.5220085869517703 -3.6829963288514493 0.15426956645376563;-0.28966665173816392 3.3741907776913536 -0.16417810403107941 0.43287438254951338 1.9104735851162395 -0.034125568972739675];

% Layer 2
b2 = [3.2272610718327757;-2.5343525017127124;1.3469606960760456;0.18570223327563645;0.98982908041067552;-0.58142791347501199;-1.0571878490945679;1.2841637977396736;-3.6080383199931365;0.48658792767453157;2.6171319742441979;1.2491923157511575;1.2037232396361723;-0.87138286389456587;-2.7126313202596912];
LW2_1 = [-1.4338050293987354 0.26195620141129289 3.2335128939337339 -0.47988988790168485 -0.75586188054578851 1.549935032881069 0.16904879149952415 0.76467365231456463 2.1369178620412579 -1.33836228981677 1.6695074398625915 -0.15854087299876035 -1.3014280923011645 1.2627448256813842 0.69603262001580846;1.3475173968038761 0.80387749220385429 -0.017713734342392165 0.1020125562607081 -0.56266783937701226 -0.39844279126065757 0.30328631207894391 1.1660580794890907 -1.8994660439314135 0.35158021687703239 -1.1288084753078873 -0.50043107039897983 -0.70351184728222282 0.32899026646229035 -0.81696165167665558;-1.4976365695416094 0.74403742182261801 1.0710678139537617 0.17944194170183672 0.091198222287278419 -0.73530072758783471 -0.097206264554731053 0.32700567869349906 0.23458867292167004 0.10501061566118877 1.6168673366748725 0.03715498018259103 -0.17037293684817084 0.25621288472692982 0.16531229350887089;0.1779979851842477 0.51052393615990088 0.18271331663757462 0.66083760169045147 -0.24448706730284137 0.10657129241380976 -0.16569985760244904 0.031151273634496372 0.29759055608809998 -1.2150506131677266 -0.40732369937289775 0.85865593900823589 -1.1314642550953986 0.80740825379917103 0.97416061493014516;-0.047501470850880606 0.77156560269808894 1.0938191536467099 1.2069936414549589 0.0087979154664275805 0.13434808061255937 -0.74555965219620024 0.063058386895350288 -0.99833087629487227 -0.044687973713688572 -0.22103823026877664 0.55217231251648102 0.50463997867966448 1.4866646724359143 1.637868969654372;1.6663271015702601 1.2665845335004322 -0.26251462290794736 0.65601677086338805 0.20946066769136742 0.10614863898491431 -0.13287225626384153 -0.38295395082915029 2.0692324748676554 0.18153909248000791 -2.4057219197737831 2.3747363616739938 0.2053398654241734 0.03446939329171915 0.19153878821560363;-0.51586075028121503 0.09066816031790266 0.13773905217956073 0.28056930902091215 0.21687884290065185 -0.13377155626522858 -0.10676480126462987 1.1383782773166999 -0.64286469454920492 0.37916999904906679 -0.79329138660265286 0.012953621245823915 1.2101774371730949 1.0178299476629298 -0.77627310391090065;-1.0786327210544202 -1.5875397475805992 0.033517980576513035 0.54375090769370171 -0.54757151595883047 0.55195327049526144 0.30225917124905261 0.71258188550070833 -0.3629594070618688 1.6753732860132475 2.9863324105618272 -2.8870234545082685 0.6618850079696752 -0.62756785302823559 0.44132234797011904;0.64740564101119091 -0.072839903509337167 -0.19257113337465043 -0.28513120468503073 1.0945270896456505 -0.17294938298239268 0.39082893109133598 1.2784108093081485 0.73771051794387121 2.4296161310913544 -1.3702566737349171 0.74909703449783194 1.0843922835645636 -0.19898744378915889 -0.32352293477179367;0.89255070298967576 -0.12541778300351175 0.15723813519128438 -0.26678102536478104 -0.44661872701792049 -0.43902465496934834 0.25082534217953695 1.2972945499211506 -0.74008830935102643 1.2915835368558941 1.7626651029429232 -1.2062203373250415 -1.0527266645529996 1.5576704790939675 0.70753845951094041;1.7451387215478413 -1.1090377482344351 -1.7575156737488471 -3.2253464568197066 -1.2831079877357787 -0.69187174004653473 -1.2767562172873848 0.14855946292992328 -2.0823280765875194 1.2993437300808077 -0.34070749880089074 0.54933568764554341 0.46426074582877652 1.7043369273587541 1.1494286286191167;1.6949030933848319 -0.078286923914352602 -0.28505482122639514 0.82300396787514907 0.061502234014152696 -0.27624206227839637 0.7835280002630578 1.506624893352229 2.0930221304251257 1.5986053930166833 0.55075882865904446 -0.1001441760996834 0.90097803435165424 0.81985764790271376 -0.14297021250056458;0.37870663823981732 0.010866885020924921 -0.17440146834477493 1.3929138259810629 1.1299197840121027 0.20488715855548714 1.7929559847193202 0.22568712583238823 -0.34486943158642136 0.75996257288764646 -0.99079631378522015 -0.68954246080917181 -0.054668575062381111 -1.2171491227729754 0.0052961211408430187;-1.5314811805586928 -0.71110513500306904 0.056076717623351965 0.14869380648867447 0.88268550013386504 0.14617077145576035 -0.06735805615668744 0.27392925250075284 -0.19638961097274305 1.1069345487151883 -0.20467762329653147 -0.1873384132582834 0.28981860996437325 0.19133395664160013 0.36643279156230202;-0.7823751077924197 0.68356908513841474 0.12783358351711832 -0.43495866881967116 -1.53981491635151 0.3489344124949148 -2.4806448431198813 -0.22124920293407921 -1.8507597184317659 0.0057685501313601978 1.1456542430848042 0.4147708703836086 -1.0570622407275774 0.29178999719875237 -0.56780118358613751];

% Layer 3
b3 = -1.5925404946307555;
LW3_2 = [-1.0006347690507407 0.60472845959974164 1.8866406940790177 -0.83030398297691399 0.37640109208275585 1.1122959912620534 -0.48933112551268276 0.55193851338589517 -0.72010502266165977 0.85070793489111451 -0.22482430062319889 -0.74570760991230944 -0.28647991299720704 1.0847068564652567 -0.17849593168859512];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00968992248062015;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
