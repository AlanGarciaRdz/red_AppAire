function [Y,Xf,Af] = SOXAguilas16(X,~,~)
%SOXAGUILAS16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:20.
% 
% [Y] = SOXAguilas16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.0246053178993972;-2.7363801890932931;-1.3873854731524258;-0.87886995964001946;1.8615959921874508;0.019770685014784982;1.0744512683780947;0.4922615490895148;0.18316779887920628;-0.7963512483973707;-1.1354353914615363;1.0385083575664598;-1.897042893017763;1.7814762272230755];
IW1_1 = [0.42983061018082941 -0.30751127981331672 -0.5536314256372139 0.42577799563892971 0.20122579742349292 0.94808494588463421 0.37631741784594874 -0.38022418197511998 0.037384430402244047 -0.32980044288323251 0.60763510996776215 0.78834423593421266 0.16413070977584682;1.7984203285336151 -0.015941449495848622 -0.083791172268347508 0.1616728771459553 0.16881110510256644 0.12932532636263824 -0.34344404341813795 -2.5557697167169375 -0.24516239634028641 0.02912228036932088 0.025331680452783438 0.09259352199424406 0.011782318641106855;0.5848157863297847 0.23637153250967854 0.24984012724846516 -0.23001823909577457 0.18174584333223731 -0.28023864810932575 0.11285578272325915 1.1435046689580544 1.4792692789637343 -0.48548578742692272 0.34576017536240089 -0.48192147748077829 0.021403555524532557;1.6183353796652411 0.31993483782610976 0.7962933265631561 -2.6932548833007965 -0.37241990882332343 1.0635972341410675 -1.1000831858445181 -1.0182231203153294 -2.2423973786012401 -0.68572600188958543 0.059339542558261744 -4.1866215755457814 1.4973424901823347;-0.71814467570364349 -0.59835949581586023 1.6711588224574785 -1.2528073658116881 -0.16297763441348512 0.29441189740601198 -0.39550784450046983 -0.056205720455707348 -0.87865828420627146 0.0031557987752863746 -0.30087338910894251 0.018559230187776415 -0.11043381593133347;0.52170010344499962 -0.04550564513555691 1.7643568372647171 -0.52600580174208778 -0.48252107636489072 0.49672667690325678 0.70714189167340824 1.2396896161930218 -0.42689778872888912 0.18010554832270129 -0.62177099466196684 -0.45913319162839583 -0.74926348559172118;-0.78072263153850818 0.91345949299128759 0.44959051824854485 -1.3413034580818894 -0.34855343523547139 0.53623193657568979 -0.10923314003087481 -0.65271082743670916 -0.94701427152589357 -0.13956488664736039 -0.84939856995044249 0.72446636205898529 0.059215490390582888;-2.1832297659532114 -0.054967466404621836 -0.94070066048528056 0.16814845085541971 0.28739840257448185 0.21057122994085617 -0.68828112184002355 0.27967396673335893 -0.41569522435759843 -0.52872337015413551 0.044770350353441304 0.022926390802470414 0.027386605410800739;0.66289007712605441 0.072707997516778117 -0.25245453802949386 -0.72519437628120309 0.26157954719504772 -0.15995566858158083 0.63699138864855798 -0.72467078358952663 1.5794303253866369 0.11890970201441403 -0.099772925838561302 -0.1964796390863606 0.60932232890088078;-1.6160350179230356 -0.05985085566611683 0.061133668125762652 -0.082221714039984919 -0.28881772275011358 -0.011900960520332947 0.22898578366392627 -0.83561129875334661 0.24859420383589731 0.040130747625117313 -0.063086204879152993 -0.24120177251492059 0.27608179341949374;-1.5790070873198945 -2.3435686811977492 -0.23674244651089002 -0.19555586744674977 0.11897301835918442 -0.18651179227835618 -0.86464921921419013 2.2161458646106778 -1.1951743265414605 0.30745713243003309 -0.20532044544587513 -1.7259358870382506 1.7735149233381649;0.81291635181857724 -0.41467450012978441 -0.51253518655494934 -0.51054781492285473 -0.26954900007075083 -0.22671405763114366 -0.13067460051201255 -1.6834145456400202 -0.38768935168599905 -0.15627588286024885 0.24784533000008374 -0.47841148459201821 0.38442580918820479;-1.3075983918782861 0.29356457359809685 0.033983197043734689 -0.14013480678978124 0.16841274447667884 -0.4118198555943563 0.45645182579074134 -0.87951288322173016 0.18142913747894554 -0.15355684485151933 0.21398542424937128 0.43654022794089625 -0.80504675169059403;1.1278531440026933 1.4477383611451673 -0.2132833896658973 -0.28146237368891486 0.12960553990477192 0.53793486559847747 -0.21097441221861921 -1.3829423354740442 -0.78147273314197263 -0.0020023591238137253 0.52494611075795661 0.56857110231630714 -0.26116026157461747];

% Layer 2
b2 = [1.7614365393717546;-1.5030361424234184;1.2410372601404323;0.85706698891781929;-0.51047123854861731;-0.26920213502650769;0.14479439339770686;0.21275013034643867;-0.64218338543208919;-0.54200793028982297;1.0530534087139634;1.3536562933120286;1.1132316310931292;-1.5505072809312987];
LW2_1 = [-0.61900329028838119 -0.11035026057731849 -0.73615310101363862 -0.60781810784744084 0.11408083091186202 -0.49517772206582761 -0.53582092160078132 -0.4155711850403524 0.30052592682969048 -0.18994021360054708 -0.21071303957498685 0.79398841820512378 0.07351253172490553 0.1969756705181718;0.322461481793616 0.023482714620599643 -0.12686305081758806 0.80132807701269559 0.81918076444807275 -0.24942158570373521 -0.50565114628389829 0.18078102577693175 0.16858400536136905 0.37541693925835357 0.082610793138846089 -0.31423656319327847 1.0350164989370059 -0.4390807108375423;-0.58716645549501856 0.30303625091224962 -0.45313070963305996 0.16116599930394188 -0.43950959412840063 -0.34992614410132433 -0.63187785058416512 -0.93380768075942355 0.37260781758775835 0.29130839976259387 -0.013492437571544247 -0.38356430137534714 -0.38257873318940916 -0.47905153787666305;-0.37660465948302724 0.17535625667901472 0.33296984757227904 0.024238814036428278 -0.77758581416671679 -0.37004556707008562 0.33690925133573824 -1.1275936598863523 0.52468362119686363 1.0545254882125756 0.15508112495231163 0.30246277898855572 0.29594788907721681 -0.74451114503739124;0.23773707775899958 0.29771325977233959 0.82925852313670201 -1.6898165801916638 1.0199068601467081 -0.48488844257300828 1.0714337683701423 -1.674074570458906 0.021268123382840586 -1.6727791656055042 0.62736592089747789 0.39788120704469909 0.84310899147916241 -0.7652873986613079;0.25632989440999276 -0.94129193465505756 -0.49827488028708966 0.33972350217424091 1.265895701112741 -0.27477859249491909 -0.1112342607127057 0.16718534123568612 -0.75621958779244924 0.64929067129841522 0.89274853783446884 1.1896592048511014 0.43752208179657381 -0.1298106322323638;-0.57725645157345118 0.42974030327329776 1.2114306751531343 0.047431219451106336 1.0046186044471981 -0.22441720729889131 -0.90700845971480004 -0.64829944221619318 0.024923527782097263 0.42501886363571711 0.70832420046490341 -0.043739483871224907 0.17034621831738822 0.1126656706861902;0.21103269436981043 -0.83944799054278318 -0.33785290556694497 0.89770401807168143 0.3818519189392095 -0.025853963912068643 -0.14378890417445911 0.59873126131001952 -0.89397817724371187 0.96253899707548507 0.35453794077417999 0.010638263297934198 0.25691656847411126 0.55027883590644977;-0.29796838550285409 -0.1302563685467624 -0.35291143753225973 -0.45326535121885014 -0.63613633595594488 0.796446569260573 -0.3924672484333051 0.06186376192874276 -0.62744141952457078 -0.2874039903626307 0.5735327734173169 -0.72833749924619318 -0.22015836030014577 0.03983163774315715;-0.32945507818356401 -0.2076322828487297 -0.75868104152352422 0.14613035608824471 -0.89003907289485362 0.21690952089590321 0.85532416026351388 0.67837337012490673 -0.0093573821004443222 -0.1628007666589209 -0.78075941069971211 -0.4205435006636038 -0.2759880692463445 -0.066295252864271459;0.77132302216067961 -1.077183677900494 0.16481316190716866 -0.91829772763948447 1.4107654918114751 -0.45008631330967436 0.78599317390445766 -0.41857269951461956 -0.48615540533764995 0.48713065157707813 -0.36891620950696824 0.68678435491670708 0.47897646012375505 -0.53086671902719151;-0.083493427550593927 -1.1778844082853925 0.1078058591496211 0.0015979783830480437 1.0963612765621658 -0.16363840390485598 0.14833934945459934 0.45347634743613086 -0.6912092411257974 1.6089042389388934 -1.3509089792714388 -0.27411427436326125 -0.10336726568586159 -0.32366665522008975;0.63487615916281825 -1.9038553830395271 -0.14237864452712776 0.13257232355789592 -0.43102861477269749 -0.25948493391988559 -0.73126350600719359 -0.64848279685267163 0.2758657911910522 -1.1301162272970728 -0.21019024315458731 -0.29397504457656293 -1.1690861784484097 -0.13625793979993589;-0.54013612076845652 -0.49120071655866587 0.031769693277783929 1.2583696712806383 -0.54456098377199746 0.25210076791041219 -0.09943182168243829 1.0599093257348757 -0.42790943047913393 1.2992212583796141 -0.021789564977317141 0.72500543127438255 -0.34516985466241495 1.1056705943210368];

% Layer 3
b3 = 0.19893147860404153;
LW3_2 = [-0.69797667630911442 0.17624406399833972 -0.70086360956179827 0.24631210526838454 1.3860072472471154 1.3208650936601039 -1.3902043543008609 -1.5299049193456582 -0.37455144666925055 -1.2987788457892491 -2.1584650023621816 1.7027175418549909 0.50337136952616923 1.2803305314340354];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
