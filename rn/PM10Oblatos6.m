function [Y,Xf,Af] = PM10Oblatos6(X,~,~)
%PM10OBLATOS6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:22.
% 
% [Y] = PM10Oblatos6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.5598576853035295;1.8878174581424114;-1.9021140945704049;0.98234660904573945;1.2863849382347137;-0.32747989122034599;-1.7716127061640143;-2.3712026480900734;-1.2047170272543395;-0.79706230251866839;2.1604335035529041;1.8932219892660944];
IW1_1 = [1.4752045398245077 -0.77940775179320998 -0.71293451507789896 0.178816952968818 -0.10278923742102754 -1.5408381424613118 0.28257811627262908 -1.0974593948529641;-1.4429915196553369 1.5247339217451612 -0.47682887256136269 0.33484913358116264 0.41183744847771037 -0.91599451506652596 0.28356397663642047 0.55512379853566052;2.0724364060247544 0.28458694912986754 -1.311810208919574 0.695721679177288 -1.5583662764203223 -0.97522533104999631 -0.38562070127604031 -0.21257423805712181;-2.1037754915732201 0.4028454269829333 0.048421253959325186 -1.5721022609815865 0.95827377152648585 -1.4770242253111374 -0.34204545580564893 0.45673022336588603;-0.018888887383586503 3.2191800371404242 0.36030424057389121 -1.1993571669503038 -0.28216025451233406 1.1721044448116624 -0.3827686380919082 0.011650654299959271;2.9766971627657273 0.28863843720318777 0.4477960663920193 2.628977945256044 -5.6144696557000087 -0.14742278946355261 -0.56978768697187621 -0.25149647829179966;0.074345802286128221 -1.4088987236778874 0.69566780773957781 -1.5443551767785153 1.2614026153672946 -2.4227160222168043 0.62695109792390924 -0.3612099805131167;3.2021702778206569 -1.1298984658875557 0.92934466456103104 -2.8139496268341033 -0.17513075952920421 2.6390052676841163 0.41111993267230895 -2.2687463194952482;-1.3929510798766376 0.096673833681627505 0.87825364372421455 1.1733625971370847 1.0428317005769101 -1.2657743971493314 0.32129100016147916 -0.24046501900905615;4.2124209477759855 0.34171114967887156 -3.4556923940068085 -0.67509246822054048 -0.77728916596362374 -0.30713663131297481 -0.40873398100581915 0.80662551099656099;0.57807905799421189 -0.13412814927302921 -0.84990223220610683 3.4731013525797243 -0.31326678223294402 1.1218836120393454 0.40737658187171882 -1.0170184404948504;0.42759476764176735 -0.024031711635860587 0.15415013040793832 -0.25879593243504628 -0.38506373638529107 1.7770773159885715 -1.4178135559558156 -1.1129845864312982];

% Layer 2
b2 = [1.7539357114242586;0.44551158706218497;-1.3900822073373087;0.033779486892683848;0.85254955687728995;0.54681010670258057;0.5920554286782963;-0.92115455411086977;1.3341567525288052;1.3827730482802214;-1.4592009083349602;-1.7182670927348851];
LW2_1 = [-2.1232282289956235 -1.1403854235931508 0.4187019758539956 -0.70698076480478833 0.030589073507163087 -0.53610100696426521 0.39642116754683793 0.42721948498945989 0.73476143224344004 0.53822434859977231 0.4392701384776605 -0.3698375425103147;-2.1976092458131924 -0.79164915925982438 0.41276445744803769 -0.34186451814235147 -0.0042956130776665123 -0.37279550446840642 0.48173890533067959 0.60022269612008672 0.078697253829919073 0.69525035801376245 0.3844446861873384 0.21612111417064012;-1.1290352714865688 -2.6108971550244577 2.4316670462311865 -0.061094751548952511 0.75298230992728943 -1.0348769675914724 1.9614428313563952 -1.5957134976365359 0.37790029470354042 -1.0359098162132161 0.96562641573408459 0.2291966481162418;-0.91171398753918276 -0.93368259969846623 -0.071301971032421085 0.98848822339465625 -1.1719930630941273 0.51461098289595886 -0.80041270720198965 0.22293113759348981 0.46434485385086233 -0.37215003273930569 -0.61239763254921098 -0.98059750635392051;-1.8395395006681321 -1.4433331302751837 -0.83778992189693091 1.3376604303056896 0.2349761302904414 0.46855841354103028 0.23916705648019804 -0.8743917434620857 -0.29551335699042086 0.88585531912463844 -0.56855835026629153 0.30439934376326883;-0.19699563649953508 0.46227568029562155 1.4581933474631892 0.66275598471598984 -1.475935423527855 -1.2118675368297702 0.39348129425080214 -0.60524685883180807 -1.2107491406960587 0.039389425590415653 0.61977347616088452 1.0630224859690363;0.94424231303284478 0.88603889938784763 0.17346741242392155 -0.9249376427993582 1.1808478745973432 -0.86821678038773642 0.76234109101816505 -0.2740547839073334 -0.80445649043670542 0.23811237650456968 0.72315813088440684 0.14866874010986708;0.65014652767270509 0.42026782610871216 -0.32372913381530799 -0.53180102279162622 0.22042405148065322 0.17746906535348492 -0.67866393254393509 -1.6671521768997342 1.2576026619457605 -0.95902471890043561 -0.11162966232177129 -0.40991317816249084;0.95329434222686793 -1.6901244607361254 -0.56878706460216644 0.77475227246616818 -1.0344339821405211 0.66911810186888609 -0.52807731662337332 -0.39643978751295739 -0.09280973131294401 -0.47510323944201704 -0.0041103636546215017 0.18449858908981628;0.85073360880064419 -2.482514385825048 -1.4971622858767073 0.4916002265056531 -0.088636751346134426 1.6322211964847835 0.14963530292832442 -0.068971363656103651 -1.2004339670713018 -0.81228670077558729 -0.7141502368437912 -0.76139591812797003;-0.24451515659179998 1.3320713385489609 0.65730457054669689 -1.4322849295381765 1.4115606238056915 -0.94183040295713494 1.4967481800252411 -0.20583604521487425 0.60566123914514647 0.98600585837589172 -0.69117141548450611 0.29869060501700018;0.48822243676313526 -0.79096468124425545 -0.90966060766162427 0.41296503015607594 1.7150926412968208 1.3504873933323731 0.022901868353892338 0.96721591192359124 1.9033820838605284 -0.4628108356725551 0.099832233620991112 0.15117415723704899];

% Layer 3
b3 = -1.6384450428454125;
LW3_2 = [1.3533448859794439 -2.4056172259292894 -0.73244569542027915 -1.3554781923013779 0.57957159600422559 -1.1711598495426208 -1.1627928401310348 -0.94213491444270925 0.66671845932110996 -0.44377986883690851 0.38658144435278369 -1.0551187454949815];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
