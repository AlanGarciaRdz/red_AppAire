function [Y,Xf,Af] = O3atemajac18(X,~,~)
%O3ATEMAJAC18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:36.
% 
% [Y] = O3atemajac18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.201288244766506;4.04040404040404;166.666666666667;0.0561797752808989;0.00614628149969269;9.52380952380952];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [5.7733482582501159;-3.0533859235540914;13.638628320038919;2.6192375332707156;-0.031632461820524538;-1.3465639946967976;-1.8406138123095095;1.4744681264157393;-0.12059532222948445;2.2977097712429431;0.5472779184960348;-0.96253859074534365;0.57240131791650417;4.1438121136818706];
  IW1_1 = [-1.0508257155664298 6.027527422812355 -0.39887503883553771 -0.19579425880254159 -0.74935008002780701 -1.5801284671669336 -0.47025761610392275 0.086992609866425763;1.1134709720073546 0.54950518028767115 -0.035346586275264283 -1.5782750575552242 0.1304257948110378 1.2635749378449617 0.013856651403847751 1.1680371249698533;-1.3865629894814679 2.294192933475752 -2.0554412552404435 -0.29332061053624625 0.068795905007542651 -0.42471637412126578 -0.25800573646219827 11.404298713168705;-0.18230729072141347 1.81457118854503 1.4448423103593779 0.0070573595612457955 0.027368096676273379 -1.3940526215601872 0.1111088502463813 1.3578922943936493;0.71479498123146534 -0.97605345531502441 0.58111821873334213 0.11323077905621871 0.040544032844958382 0.78526640775397571 0.34403591630059011 1.0224990936306422;4.1585885297307374 0.027838055304921509 0.62534862282331338 0.46651935650962839 0.6288718497295841 -0.40295944604975409 -0.072436115016555211 -0.37881804296916211;0.077064295621921117 0.24156749007890504 0.06436077093870439 -0.71923306777005835 0.39508931862825725 -0.013164744598314914 0.041550572680532104 -1.882631903852138;0.27816220537538 1.8578010865399757 0.72203532370519108 0.38201885987716422 0.40115968237033933 0.15408491710645833 0.18442290593183286 1.1840113785603998;0.82399340845595748 -0.15318153120231459 -0.38918108707201954 -0.09104797825109838 -0.036319908287561375 0.53935334595913187 0.065260535451100415 0.044343688655909784;-1.3290859053539756 2.0083834363473496 0.48171536402028026 0.54793624737557711 -0.2197494279829634 -0.77858210898699054 0.13354589492643401 2.1793831752599817;0.043928366805780522 1.5392378663986497 -1.8592293510943196 0.8198456950805717 -0.40742398638652166 -1.4739235195472846 -0.12889813202180461 1.0773278908888442;1.7005037198077519 3.0661102066398045 -0.62282453502566981 -1.4693414010572239 0.83980348445555486 -1.739269871803927 -0.14286917112896061 -2.0678461170665821;1.4434950593575915 0.60341386387593099 -0.53165852090360732 0.30619049056211156 -0.015209379805873731 0.21196261018447293 -0.098528454970598325 -0.35523115721141391;-0.35738314830189588 -1.977620613018036 0.32200846326582067 -1.0145876195530197 0.83344731836918307 0.20293976599528141 0.072287983269374231 1.9419116013870215];
  
  % Layer 2
  b2 = [-1.8998380682092906;-3.5617847495622454;1.5378811223740645;-0.77224200206280169;4.6232742364224011;-2.7235183887482846;2.6912071821756953;0.35463012255179804;1.0270499059583154;1.93891146533789;-1.5765878058784124;4.8192206893828464;-0.66971976772598651;-3.1043836924820281];
  LW2_1 = [-3.1051604210595629 -2.1427479792893087 3.9314190677350709 1.0035751480986843 -0.35270408336701009 -0.80545503021716525 0.061385032325305511 0.3551146627190474 0.4169440530104942 -0.29037431119214596 -0.43652450549946148 -1.068958554508614 0.99253295253170593 -0.039714026682400608;0.42652244464527544 -1.6245489273902514 1.8665840180617634 0.091302194992696512 -0.22170169652898389 0.33236538332052845 -0.64462269131107353 -0.3393093974530198 0.71726955108294321 -0.53414835769046531 -0.49447832716920764 -0.43251421092641745 -0.066589744816719879 -1.1522152649109287;-2.0045499447034771 -1.6248447350224851 -0.0093435439251531652 -0.90732882827464512 -0.18758751640477078 -0.36536491374970437 -2.2525127874885538 1.3292897661361658 1.0899048380236676 -0.24228986945351727 -1.3778201590190926 0.28835513633116527 -1.0908796417805957 -0.12643154365723555;-3.1801982992434907 0.077086495576429229 4.5506426350555618 0.94425374268651985 -0.088450668085831935 -1.0116685562150978 0.9699928369763362 -0.52350642630024258 0.86051394521760427 0.3450224865217052 0.62535960682202063 -2.3222158469647214 2.64330319906477 -0.4434784805248283;0.062990568256500942 3.5297542551792027 -1.2258913482596812 1.515029690947389 0.30618330075125927 0.6873037418726784 -0.15027345010532514 0.21891119059057551 1.9044527090519616 -1.5510107175228018 0.856366749958824 0.44613889367641618 -0.20199634058606264 -0.47913428662553664;-1.6577826726758764 -2.9959394354600613 1.7583505978047023 0.15359729229685282 0.65944932360779807 -0.71232971215689256 0.40487669029379098 1.1918474680824609 -0.66580916127776391 -2.2724689232151727 1.3149852642396309 -0.029257667157581602 -0.22824119162104353 1.0739993859127388;-0.42905379727929777 1.3710050226806825 -0.6150769116225141 -3.6099431074124153 0.11938620738062586 0.61311456769380668 -0.1997939492072871 0.17571538757193508 0.31631492773811115 2.1056813095422591 0.91713797710150313 0.27797474953848733 -0.93145050696265297 -1.7150812468953571;-0.22498540524409416 -0.71911095232249811 -0.094973740791826092 0.56720960042587953 -1.248131641295299 -0.53542765026098127 1.1309821255192998 1.0271739585901647 1.5743927253116605 0.37928434947272227 0.017456585468292839 -1.0206599529048304 -1.7901734014336126 1.3980538537532388;-0.4197456136908948 -0.95938863593284873 -2.6665053168041188 -1.8243749526346571 0.998927096973386 -0.87897650046829678 -0.046394846758383332 0.35508961257588106 -2.3473718052733696 0.75161023271393756 -0.01240898361288835 1.0581460893067325 0.86456451107970789 0.50345168532914319;-4.5267536445196752 -0.46389330061829603 3.5813781184729261 2.4278343189530656 0.66214840209223336 -0.84782629501897577 1.2499892587151318 -1.0549264330258299 -2.2943700494221084 -1.4507862308170283 0.24698326731688541 -0.13524004855830374 1.2993391874416362 0.73687602798207297;-0.15423426327334855 2.3088470796901417 -0.84882252628085875 -1.1373544352449616 -0.62934511288105954 -0.93613079500072849 -0.30521814992554119 -2.2359797510041708 -1.3555326919513029 1.8709375649448796 -0.025461945574882541 -0.36734295931274852 -0.25120465518571405 0.25532559993339338;0.31605501442612982 -1.619352519543884 1.0600654351463485 -2.9770178103847531 -1.1182698424756541 -0.46449260510480461 0.20232875573425543 4.8445798815316685 -4.4224339360016902 -1.0751330208226637 0.0015066858623669355 0.33063101069113754 -6.0709542487814501 3.2878160419601206;0.73214230844557104 -0.11667001208942292 2.0796060975069262 -1.5946999002033877 1.1349201374058038 0.78995667000926384 -1.8613969666910195 0.48501790684168555 0.21718655253446723 0.75308400981871626 -0.95701024626825482 -0.039413035566659434 0.8282369496431089 -0.1257685109994241;-0.11295946608946507 -1.0111409725489036 -1.3579659158272173 -1.4188933174214196 -0.40828744775294201 -0.083062778101602008 -0.22570258887079125 -1.8300792475264014 -1.3578928429952759 1.9338222007725143 0.033227113944652283 -0.30619227167372859 -0.17019623926019331 0.1976008053319353];
  
  % Layer 3
  b3 = 0.91911598739536782;
  LW3_2 = [1.1323626686346451 -0.59007222905629586 -0.39313410242027402 -0.56362710176402664 -0.40654169954935732 0.30822103111774962 -0.95736911972420835 -0.63151501885330219 -0.45216090915359392 -2.0917432049325515 -3.4262085625547143 -0.4866600172735488 0.47988906885797111 4.3828537804698735];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 9.52380952380952;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
