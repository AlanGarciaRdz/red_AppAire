function [Y,Xf,Af] = COLasPintas23(X,~,~)
%COLASPINTAS23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:04.
% 
% [Y] = COLasPintas23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.241545893719807;14.7058823529412;0.0179856115107914;0.0558659217877095;0.00576368876080692;0.212765957446809];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.2828555842687868;2.4840449313580897;2.8439652132735942;-1.2342918832452832;-1.3264049884008158;0.30633543521103435;1.3808025358212552;0.56926989236405634;-0.68591133112876057;-0.32746100653607635;-0.099517140003940491;1.9692441611068987;-4.7815500282889039;-1.8119330315724751;-2.3970432045720678];
IW1_1 = [-0.017576443876698135 0.17583768154180843 0.54135014295462558 0.20736752845271994 -2.0433810723468424 0.63154197743351315 0.36267324488773522 0.078483803816754266;-1.5677847868524366 1.2339747320466117 0.36433285422588318 -0.42529867227992402 0.39596432593886716 0.69865953866121944 0.34249179460958906 -0.17480354216017646;-2.5280276477535053 0.033018372654147046 0.10994890277465935 0.13490541996958352 1.0038534581048704 2.7333015628128998 -0.0083533919165705468 1.3802195655778533;0.87961122852628759 3.01222257781499 0.41668396746449499 -0.13070924323755018 -0.31341333543705524 -1.2376807557234022 -0.29992405240103126 0.15235602013581301;0.68939057521110314 1.1952537031311914 1.6345061887734382 -0.63182713328135787 -0.45512506434267286 -0.34386399745630741 -1.0741175815170507 0.50716718090751767;-1.6210712561496008 0.11959414908148902 0.39235246966163939 0.031944365262011845 -0.96328415643076371 -1.4909406005642194 -0.07108469559963379 -0.0078730832816973351;-0.85535366164797599 -0.67368093134232265 2.2170866490644814 -0.14336473317210932 1.1018175189577941 1.7915683225676591 0.67327686159953115 -0.08088484139414652;0.94360117152595957 -3.0964659112531754 -0.13265307801775825 -0.016970318020265197 0.39778072300127393 0.5928922363944098 0.22484520584016024 -0.41346048319942319;-1.0989031064630599 2.1994768635500965 1.2442657870290701 -0.16327292608910018 -0.41473326073674061 -0.70384640317337499 -0.8260515812884841 0.64721629514855006;-1.0276610568701838 -2.1364681968226162 -1.9507960488573317 0.052944910390172961 -0.76725936385376126 0.68578993931417198 0.50582799256748845 0.22404068610550393;-1.5397485889422706 -0.2739193987689198 -0.38582972583026381 0.52104264885539786 0.13896612216944665 -2.0512840325685264 0.26369974315529643 -0.22391521638365092;-0.12474843046943226 5.3429949941121109 -0.011652608416501335 1.0526965310569212 0.39135762276822872 -0.32433578146844844 -0.12166869383799658 0.1631403290543573;-7.2518534224760147 -0.080690225051572528 0.6228354149144798 0.44594466259169291 -0.12100643871683049 -0.056929512923875346 -0.27479764313620847 -0.071574793038191559;-1.1021042943157067 -1.3591378957597766 1.1016548755452686 -1.4268204677697605 -0.13929293020195527 0.23506127876669811 -0.21376895795547302 0.16850219661540844;-1.3303977013567971 0.63397937739141141 -0.45467855614244257 -0.44361108891708878 -0.11534589090218239 1.3506571015661439 -0.7841419305176992 0.49415919798330277];

% Layer 2
b2 = [2.0254300894391601;1.7403323206829269;1.4108084463321477;1.0147723524449066;-1.5536588958318975;-0.72391539019695816;0.70287071441511129;0.54372726693980011;0.20404082031081353;-1.1534275978548214;-0.69914206403962198;-0.95516503477216674;-1.2748886289924051;0.99395731852371882;-1.6331276520974205];
LW2_1 = [-0.74937269912596971 0.047888107614706681 0.36772960454346854 -0.50897641811266148 0.36944238569831878 0.61967426830413852 -0.25480463322219904 1.758864459017796 -0.29427370142962261 0.20207621881750437 -0.45469421799537207 0.56283421993785487 0.30048613565759297 -0.70143460782462574 -1.0355321819607266;-0.94173758608443092 0.89326548104242443 -0.93145097020683665 0.0014781258981319129 -0.11544026709638035 0.90594835095777315 -0.31165063764026352 0.36040176544568536 0.52172537882314363 0.15933739836696159 -1.048109614790786 -0.41562267365038469 0.58605665822508779 -0.31585398543776055 -0.83976914679933523;-0.30440570442020054 -0.38353583793905849 0.31934260198752651 0.89633875527806817 0.035053319889711991 0.31896131172710201 0.065500458539055381 0.14063047509900134 -0.42252952194419902 0.42882787849962384 -0.31931639410650381 -0.61413541443452158 -0.43425587930771509 -0.52893377788410278 0.03331900796286405;0.077394962653399013 -0.33579318759228105 0.90833898988590722 1.7717625509032344 -0.79634844590527698 -0.91637806593555804 0.094301407918442021 -1.7561351803285354 -1.2964379094400953 -0.26376269616566855 0.032721492585120131 0.63430197793139242 -0.28428937294923134 0.066089385543948428 -0.037313434038363867;0.13466104001295059 -0.95557632790522928 0.19949350552200273 -0.78279722556215425 -0.1803719150988411 1.2690463825077352 -0.090604337332470419 -0.53574797729691348 -0.80944443552638179 -0.42225905816860543 1.1970458291599686 0.31105177033310183 -0.6093539137645545 0.21528257822627467 1.105223301859849;0.3311804681894942 -0.12549512074103597 0.42244429999477096 0.62894067820451838 -0.49317461408238927 -0.033144756165556691 0.0970851550279897 0.32193306037038805 -0.066353430312060063 -0.058963370253239819 -0.37015689443804817 1.0084664431072001 -0.11726652106335533 -0.061832454644859841 -0.44162163252688574;0.18471542817553011 0.031963889550988375 -0.79732049729056753 1.4620792120211081 -0.78186516118359195 0.60065531057471655 0.070087277326914388 0.94144037687462101 0.066636950053474531 0.57836314135393596 -0.62122263554966872 -0.92029625386756986 0.30192138195740359 -1.107846793978003 0.19291131503664863;-0.34863597699192655 1.1950407737494722 1.0519134844136868 0.37542131427311504 -0.23041748461151193 -0.28708304256412259 -0.97949422663524133 -0.24889066849985664 -0.90733373444027499 0.71709271669773933 -1.2915916362044391 0.59804441073081849 0.15399315720908313 -0.80408967920108387 -0.91127495459989238;-0.3887991231124025 -0.47303291398211728 -0.53202632258685867 -0.91834337426914969 0.84351068312459165 -0.51492390198323801 -0.41800921664063539 -0.19051965328996731 -0.35812966396077955 -0.4979417142657746 0.36474873349322773 0.0037472266000163346 -1.9049296012606112 -0.18331453328984848 0.37688683202517448;-0.82140771624919384 -0.35570893531609027 -0.45777861953792609 -1.176027158644954 -0.27686522044600093 0.51362139232509774 -0.22224525043896265 -0.022831951033084129 -0.18201107740455502 -0.11911878127808395 -0.84425889841567181 0.90477152659412208 0.86070406288516743 -0.5347055461536866 -0.57733245882551842;-0.48046969683463153 1.7183493417908922 -0.074268362684898767 -0.72565092683719856 -1.1820254732247633 -0.59075965735657299 0.31583646237822138 0.16025758064199286 -0.961024633613764 -0.5671972839603916 1.1745475439919351 0.11633963291765084 -0.78468690459687729 -1.4911229269462065 -0.16202878727934483;-0.43979865200168494 -1.2388450749484972 0.73682406878109841 -0.1350442807641358 -0.063921130262830764 -1.9758111642792147 0.084925606825796016 0.29656254811147909 0.24036928454972828 0.38162976530712106 0.84603142391464647 0.17321701278954418 0.60183086072033509 1.011792437450953 0.23318844503362751;-0.8798458580582309 -0.33559562442128127 1.8373380310657885 0.50857385371592412 -0.84555586838120533 -0.83074608049292598 0.27968849159296383 0.028985578435688275 0.75062192293913876 -0.7159911631731759 0.59242173661568565 -2.3838892828054457 0.42767073646775022 -0.44653138100322576 0.72583478457484818;0.35342542087189682 0.080447658083662971 0.34548932880505706 0.29103995388156828 -0.30934556852958617 0.38451381879392421 -0.027497283323437385 -0.19887297569318541 -0.24839885680035179 -0.23514657497437999 0.85742625220928603 -0.3674324120149064 -1.302511974646225 0.20984953863753372 0.61140775706572492;0.39804776079349874 0.20609380269449343 -0.164777250369325 0.16116216231005595 -0.054324130955253916 0.19980427432292738 -0.2001428567737408 0.35143444304864113 -1.1092255343512036 -0.21909596287514854 0.38602593929879808 0.22897814639435871 -0.74853821480554539 -0.36777567024309993 0.88424704295359091];

% Layer 3
b3 = -0.04493196220305367;
LW3_2 = [1.1033411359922896 -1.0527364004287092 -1.2807329221192318 -1.4611899251837825 0.63579156234896494 1.9274834396818286 1.0054733265209899 0.8447548171668704 0.75651639322527953 0.64325136870554589 -1.1943149536955422 1.3040052597738958 0.27155999257471441 2.1593220293956841 -1.0213267877125722];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
