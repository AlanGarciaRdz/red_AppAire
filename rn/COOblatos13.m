function [Y,Xf,Af] = COOblatos13(X,~,~)
%COOBLATOS13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:54.
% 
% [Y] = COOblatos13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [-8.47332492237644;1.3879390296678222;-1.6857461556007378;0.48781391260713414;-0.21889072146150768;0.78294115687545873;-12.636588556201485;-3.3407651177362925;-0.033258958849545106;1.0427192607658391;-2.6435346719299888];
IW1_1 = [5.6236809295275032 -0.13729157442816353 -4.5293325155809656 -0.46894759078822301 -1.8408805197435858 0.11625095637992719 4.1378109836716002 1.0398567424099032 -0.6085338916040467 0.20318124384053035;-0.3948139336887026 -0.48166977861847032 -0.088586916922316683 -0.25279306399545992 1.1915595130267969 -0.16574346787674948 -0.35531438487214695 -0.6233678079077043 -0.080558452562888058 -0.0036421054339796522;0.058006971852909421 2.3001638053733946 0.37573195739293991 0.14019087378030226 -0.44537877040637897 -0.067530219832795196 -0.011453848188467258 -0.12990434612103566 -0.027888079782509064 0.032484168106034335;-1.0714726397529701 -0.27360587879270731 -0.86818027973746459 -0.43924281965624923 0.15986461723836579 -0.14751038834876043 0.57402310565725756 -0.066697157479414404 -0.044306510354255459 0.36175294602407942;1.676757379062461 0.48919023452211474 5.7806221861787526 0.99286305065096903 -5.6132573448824168 0.6186790318897607 -2.0799712039522982 -2.4566763315995286 -0.26875587735104334 1.2742412615658052;1.2807226488719519 -0.60605796533327683 2.5534367403062346 -2.1123845681768154 -0.22081418314167151 0.73751326806118167 1.1511767028184505 -2.5118211953285949 0.54841533378986562 0.86969369355747395;-13.670839033470386 -0.55768605646485847 -3.3753617277703674 -1.2614789759929657 1.7323868456451983 -1.2007063883372262 -0.18192476679855868 1.3800544798710941 -0.25575052817765587 -0.18115004923172154;2.7997317989859938 3.7699104055101014 -3.5667705269080661 -0.68518711805330978 4.7767505169943991 -7.3675076208036812 2.2252142710406759 -0.0097069640948141186 1.7354397930152274 0.32094265765051055;-1.7233695182961819 -3.2046385423229955 0.20733552485073145 -0.19304827890411966 0.34169828231275812 -0.19468281374881519 -0.32383843846211313 0.18379824636535835 -0.07354102001998275 0.2620432021951124;1.2666638149581608 -1.0626543782829172 -0.64953573482652693 -0.10130925839378009 1.1512595569133495 0.45379490977794962 0.78238866071169844 1.2108153414594764 0.11171060954657695 -0.25216891881464198;0.74737389492338402 -0.87501227028053918 -1.7212601119227191 0.17234058729053284 -2.8883904839446832 -1.7543920662026324 2.4696175615725013 0.57232901140434245 0.34939204473397134 -0.048608201885913818];

% Layer 2
b2 = [-3.4250402703385148;6.6105234226555591;7.0377170588428823;-10.250594265658785;1.2940243641258296;-0.27893959461103168;-3.571133364612324;-1.7200951751193132;0.67894740684484567;-0.9764903027831433;1.8736785159316269];
LW2_1 = [0.78537005179307517 1.3624222388584168 -3.0517366334897211 -2.4208269166081262 0.014942952932207321 -0.18105438220426218 -1.0066168417553267 -0.14943954880170324 1.3389592487258002 0.14966060844508697 0.46196380374322038;0.68293938064256132 -1.706767302321377 2.8600146677740219 3.4827944022480937 0.54764342038571701 -0.12665548997242265 -0.181590735884605 2.6821143482826568 0.56737858370417182 1.3811221464863688 -0.5484203825700007;1.1785200095937243 7.9001855587596621 3.6799297680743628 3.8295979364918757 3.9175434819066055 -3.6585128212089439 -1.2737077174609657 -6.0717345826590039 3.4701552240671787 5.8587739783553294 1.2090816210770441;-3.1711201053239142 -0.46257847058252927 -4.2692396121210727 2.4257734963821727 -1.7371212463843051 1.6742454208681679 1.4257942997163182 -0.17303985129410704 -2.6898604497874703 -1.6500397599497114 -0.2784571021408051;-1.8831583051836069 4.9965063619542951 -3.1652185130472135 4.2470880962998674 -5.0303992893270539 1.0005740044773126 5.138225147493019 8.326126855276895 0.28946020045186083 -6.1533390191256734 -1.6392539759696227;1.3569989914126181 2.2992192825877389 1.5005512460117068 -6.6652604884244004 -0.91245376367748932 -0.33373680648107917 -1.4234206241622089 1.4651982541800614 6.2672747737863297 -2.717180608072796 -1.2761802597012606;0.74956149091315249 0.78457068543069453 -3.6610654985946391 -2.1885590743153016 0.013629667144334251 -0.11746806349439479 -0.77370640567148696 -0.067025381370869747 1.4382946281222815 0.051129884692737146 0.36785457217830431;-0.88633023226840169 1.4419440231003475 0.0089211506371475006 0.06426239490989985 0.45155530331170812 0.35329539051870035 0.85672199747638611 -0.59959974163151386 -0.34210028573713647 0.36026093676591231 0.52942496832079;-0.19060595959814874 0.409097922608257 3.7375799410293422 0.12415772260237884 -0.39539411129629881 -0.076419962726909915 0.38816086082342344 -0.091025511270879295 -0.29593186133696814 0.56664759401556464 -0.13868933724385049;-0.64623191820347226 0.10273296956218698 -2.5040561208299641 0.16582010651840876 0.46635582220959959 0.013362810426723271 -1.0657215161215579 0.2285986386116769 0.98020168088548476 0.07676824758961856 0.11327481137817669;1.4749504108110796 -3.7856400488219251 -0.8274000195363348 -0.85257287388267244 -0.98384615880428805 -0.23123709211320867 -2.0347033196396564 1.3011187114777127 2.2419073595355501 -0.39352865991335106 -0.81539217870483238];

% Layer 3
b3 = -0.25636265757762627;
LW3_2 = [1.1925639295795856 0.32976160718073394 -0.27916689574171538 0.40869652751939389 -0.09555047665321284 0.077072608710099536 -1.3432388598482288 0.25942437106080518 0.75591919474126601 0.66573503080395358 0.12719807011365863];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
