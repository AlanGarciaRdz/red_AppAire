function [Y,Xf,Af] = COLasPintas24(X,~,~)
%COLASPINTAS24 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:04.
% 
% [Y] = COLasPintas24(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.241545893719807;14.7058823529412;0.0179856115107914;0.0558659217877095;0.00576368876080692;0.212765957446809];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.0951680300308717;1.4622587239258797;-1.3600190285217431;0.40416176182664404;1.6415223558091607;0.27049098229366653;-0.43389840992861156;-0.83422914527498226;1.1323242026696523;1.0642717373325019;-0.84216394304173403;1.273809913319923;2.343953018988389;3.0413793369466062];
IW1_1 = [-2.6373536202476546 0.89270393374168733 -1.721499175095355 0.11060601374914683 2.0178384710327588 2.2397034273186018 0.22894575878992057 -0.97193292046480684;-0.23136714710594503 -1.2439768174272976 -0.057335806259784544 0.22762307884864147 0.1935034549643152 -0.57305244793719778 0.18361007624522985 -0.056811819825330956;0.10225098081435696 -3.6878798927519645 -0.17842015484197216 -1.0103712996122021 0.22907087433836251 0.32931347997404675 0.59069499415543181 0.29049319505813231;-0.7181682056866181 0.11251133611407027 -0.31077893805989343 -1.3923637468310126 -1.1783675129408515 2.7519438770001234 0.29768355932168983 0.05333501116285097;0.18320881225329105 4.3186924228698134 -0.059235420679985683 -0.0032178627667936374 0.45112215743802048 0.29469205882224453 -0.21913304719509405 0.086540718300383401;2.3080484106322272 -0.026581724393369054 0.14221364866839387 -0.37882568060246591 -0.3601884200608057 1.1082187344137782 -0.090375739622275436 0.11898567285454087;0.64183478535612126 -0.70886649198818819 -2.414987350800633 0.40887100026179429 1.4900162411496867 0.26934288100139514 0.15757491766471771 0.42162127491417922;-2.6678749355130353 0.19495959874002827 -0.085901257556221036 0.58471626299006874 1.3784649319957381 0.07896072517976549 0.062419630346462252 -0.0021190616275592261;0.89308626590169538 -0.72376060814732723 1.6473532302218135 1.6794318176108485 1.4577718022597166 -2.6335659007513557 -0.47757222891819073 -0.030130294079244911;0.080841526029782618 -1.4847918449678779 0.003088352448497908 0.062648631510104441 -0.97634907879943933 -0.00053752080214920783 -0.20776567788335767 -0.10008605721071322;-0.045360431857516759 0.49566264051984366 -0.072375708422461091 -0.010335374197224311 -1.9210574400285196 -1.8769026046233368 0.44200923912860274 -0.29228756048393001;-0.58927685458313217 -1.5795869304123371 -1.8693692497698349 -0.36048019901501099 0.82527452607962248 0.21216892151434608 0.79854446599547591 -1.0074587100682095;1.3960390302609669 -0.91850258724245648 -0.29998427172467385 0.59854422997768209 1.6944219026111402 0.79404408415370697 0.66209745423009769 0.29093446740918383;-0.5721334659469679 -0.83414755705206756 -0.21597030602969455 0.26474408300213337 -0.23633249003182899 -0.082131167296905963 -1.9082883620977453 -0.059489004423989397];

% Layer 2
b2 = [2.6894045205855264;0.40952928051013715;-1.5985464316943401;0.12272457173479023;0.23630730837377692;-0.047320873022309015;0.75893719778911017;-0.092182807760966073;0.66483778332929966;0.12675526216837124;-1.0853149996874938;-2.076361312142518;-0.88531496699670675;1.6366431023687151];
LW2_1 = [1.0023281679787057 0.92297800028425625 0.93602078761598884 1.3841063606747008 -1.5947218992696173 0.49465506739503279 -2.5626592197544213 0.0095692621097490348 -0.17442306644421068 -0.44529172133226103 -0.035807716174819787 0.23048719887338032 -1.0008735091131895 0.55894405948023695;0.029066225132347703 0.2237672691084111 -0.48349944792410354 -0.93835832974402256 -1.5561083085148775 -0.21995944992266542 -0.04207472583011769 -0.5283304942059035 -0.75618276676052565 -0.95181169747078476 -0.01912309018184671 0.52125670785784095 0.86234294071797468 0.47468499345301629;-1.3984961955020956 0.041729470222181639 -0.2145273230312654 -1.1304555719613825 0.3750693319135982 -0.89559610093076525 -0.87944512302743405 -0.26774421963086742 -1.5766036864800625 -0.49607431987056561 0.46581895356289948 -0.26886300387967749 1.2354750049288243 1.6228433393880386;0.29904547388911973 1.6477104860204088 -0.16371205118769094 0.17508857634364317 1.1602850930342008 2.6618564672419507 -0.23541965670774037 2.3988009749675254 0.067521419574576941 0.92573612965856666 0.099275000363634819 -0.96387671959430088 -1.0861649316697264 -0.87986867834740423;-0.26800275850306032 -0.88282024192775754 -0.38245514625673072 -0.021243855281142407 -1.4462504685914899 0.579120889312005 -0.64812833167033279 2.1984318548103481 -0.61171879381925676 -0.10608031931468885 0.44055602877135336 2.2419454399652681 0.035315679186066581 0.68517298176851693;0.0014455192323102849 -0.14945103810647919 -0.30740123571846301 0.99866147161636509 1.0617113493498243 0.11033511961608557 0.60476309019061936 -0.66693866882260466 0.79939153606745361 -0.70500871111350938 0.4844729586805589 -0.55878358323727184 0.14943714717508691 0.40393570048959465;-0.13890278489450655 -0.81998611188118931 0.92987038217920559 -0.50483931843364382 -0.85562187731262151 0.015605391775927516 0.058423989527130391 0.16105018386215977 -0.19523852901150909 1.3457165290143194 -0.33196442909606022 -0.57424074850909301 -0.74525893749815408 0.031030000167070221;-0.44189171347057232 0.58213126661725245 0.86674628549589305 -1.7152229731281612 0.20529279510408327 -0.93012379654481658 -0.54587223945928665 0.97145913596000422 -0.39695690132860684 0.89656124809158921 -0.40505992614050801 0.065589272880919952 -0.7302701412267979 0.90080470234119492;0.25653506327128794 0.26233181939551448 0.57629360270318775 0.48084581029610385 -0.082530131067604012 -0.60732926132946241 0.27490795059037776 -0.31759539750584798 0.61523327401204086 0.69040612093358522 0.42377694895600498 -1.1763128096107316 -0.55223259623299381 0.29888042707598006;-1.0492459291735388 -0.76024704766749851 0.51888940728286215 0.46198008338787649 -0.38374430371544604 1.156150183719157 0.11688478255615711 0.57923910578072935 -0.42111433989417696 0.33395528571906818 0.26684094649239332 -0.23712761276748734 -0.69391558568945688 0.62291607529759396;-1.3459259616252848 -0.72751546750172691 -0.4451942881263326 -2.164236076597756 -0.36517340101132517 -0.12197679756807929 1.7949105345518064 -0.20196769005224707 -1.7022959040396626 0.23193805240740353 -0.44292934842376658 0.35192985527991955 -0.12743455363906731 -0.57209945504523296;0.24170328785941958 -1.5165028223547068 -0.76232064357884821 -1.6606019201077058 -0.26845320222953961 -1.3532862177754605 -0.17263302140416645 -1.1140535352916274 -1.3297698242850116 -0.9412715432541281 0.082241958369686299 1.8855200343504057 0.59283905424782424 0.36544532369202176;-0.015593327383011668 -1.4559036818933082 0.35761859397058332 -1.0122774750992012 1.2300361043299683 0.20002422304298598 0.57574921610672791 -0.25329625459855809 -0.55919228592637915 -0.31994735408478109 -0.81020976917166432 -0.58530574322078699 -1.0217225361135041 -0.47985112924276718;0.50406586225639871 -0.63833451902023808 0.15703577119960666 -0.017569375097825506 0.44428877776591419 -0.74111088803870051 -0.4567729968344319 0.1228778866911534 0.64444778028057237 0.0084235647065029548 -0.28525440526347162 -1.3399820816613521 0.39226564685456433 0.39975213917439401];

% Layer 3
b3 = -0.47588044998472756;
LW3_2 = [0.76814732519923623 1.6721508982877682 -0.51852474285664263 1.0078844742760673 -0.39796767420000562 -1.0797672119847854 -1.486904403681728 -0.33393848668154369 1.3487723700377634 0.91193080555824868 2.5551597932275363 0.93167519123141029 -1.0655058090505738 0.93380723304066815];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
