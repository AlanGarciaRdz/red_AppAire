function [Y,Xf,Af] = PM10SantaFe16(X,~,~)
%PM10SANTAFE16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:35.
% 
% [Y] = PM10SantaFe16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;0.00341273633199099;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [-7.5086730490057452;-0.51619079304663074;2.2333875910131966;-0.15729169568784845;0.85207222700641805;0.23267599525804564;-0.28212918871957032;0.93275727602999781;3.7426853855106299;0.73189720203852537;0.5326568381144684;2.7900471293097611];
IW1_1 = [8.3048679038816609 0.076270751575576029 -1.8738466820880924 1.7455135429670563 0.24742073973894896 -0.12650193161869958;-0.65781257869492249 -0.068684229269506861 -0.20064136274397243 0.52472030603696385 0.54634041029006664 0.064582474181279312;-1.7382828734085123 0.20742489365160724 -0.72992796814940863 0.52631395732894148 1.8921262484209547 0.31703611267418952;-0.64388376565082284 1.7979374043883647 0.35119831917019145 0.12653645380178707 0.50465315837763491 -0.068499011950595878;-1.6652328218636678 -1.9895023793764204 0.23204235749320609 -0.34178223266199848 1.1315887702761849 0.11087860931505011;-1.5837528895924984 0.061871606686996476 -4.6598074641231726 4.2413081433426747 0.46899163909435215 0.03280263656045096;0.68826835672155129 -0.16909804252743132 1.2413029828177049 -1.1996749081832536 -0.68911179859588645 -0.079356384176969386;3.8259397174861078 0.25085299939549027 0.055911205754954285 0.5458966530958006 -1.9464252928529517 -0.22818477631236012;2.7890489028468712 -0.96488524643298501 1.8327242023899024 2.9060704163750777 -2.0524103881769262 -0.057795617295919595;1.3491319934029646 -0.7536360623705437 0.55363846820081852 -1.1534832961203891 -1.8158482826740046 -0.21917042170651141;0.93685909033686499 -0.53249143755436723 -1.2762483154112847 0.004135892242214112 -0.34081031412071638 1.0952565309449089;1.3921668743615814 -1.2687020882379185 -0.024402843660041224 -0.26003829909908793 1.065500890956105 0.020276017771435121];

% Layer 2
b2 = [2.6944681984038654;-1.577193330752356;-1.8635500213406471;-2.381953936652172;1.5332812510891767;0.80581034617209735;-0.11385995778804484;-1.1546604577903534;-1.3187043146894006;-1.8652917283376458;-2.54145565129715;1.5325992988046626];
LW2_1 = [0.29370831140113307 -0.910147260258096 1.2388928779747654 -1.1924631245562936 1.1767354135792931 0.10164461013125661 -0.038062225144191303 -0.88160323986637523 0.82320773733479247 -1.6646699335546347 -0.68449653600437799 1.0043260663734519;0.5957200498652736 0.2887367128098548 -0.76170875818571759 -0.16541601724447963 -0.38265832887620915 0.91408155891270948 -1.6623874480681731 0.04520251010443762 -0.41333192163097593 0.039426479653122334 -0.34962853337116939 -0.35507125475382112;-1.6730051551709848 1.2577551760160746 1.8062957716568553 -1.3283272575680241 -1.6489556385053947 1.3101202402667989 3.4132894054170122 0.80589450344798452 0.19579662780952412 -1.2451857485970383 -1.8783061152816016 1.0042686206597899;0.051613044781517403 0.62964506461110248 1.1679557762454049 2.0819640659005465 -0.956858203622865 -1.1574050191079759 -1.0731996619043704 1.7852437733742526 0.20338297367253882 1.032301403463763 0.96444148736983437 1.7711633804333127;-1.7096041307573668 -2.6976229459321037 -0.38140698272870166 2.2558619120890184 1.209655142160083 0.5257716979020064 -0.95979804901015886 -1.4070588639531358 3.2106613530870614 -1.3440096458533703 1.2621058539490466 -0.73208878790277199;-0.21013862425227969 0.22523487905030523 -2.3175063620410841 0.68661074245460862 -0.24041023061594141 -1.0331192586419626 -0.53675092277202818 1.4894341799328641 0.69257835526359779 -0.41719944132794035 -0.97343355370554607 3.1688093216828817;-0.89340228289540347 -0.20188459914453155 0.89239603693305258 -1.9709603041154715 1.3646135533962018 1.1626775318618521 0.027300492608427776 -0.21983377710782245 1.0918521807242847 0.8318601474377022 -0.94391462005406901 0.40338871696573825;1.1293951851875672 -0.1713155129423371 0.35617572836254413 -2.2615308563115839 -0.9983220274415856 -0.1936023473762444 0.751600669936898 0.00069107369499768478 -0.90942008245023787 -0.56740175589765818 -1.9492845852253882 0.23278285759623743;-0.65643066144903439 0.34732363648356807 1.622780749295639 2.3660179604763916 -0.17430674010887215 0.6399154845760463 1.4475613025788274 -1.2108575442840637 0.17893174494007391 1.0955121967048453 0.46800724927359966 0.18167583370175264;-0.77291507492170131 -2.3424288538186389 -0.86614392999007273 0.32211653300605514 0.005928378519650758 0.052627220015296454 -0.42227615941367647 -0.58606848854247029 0.35803507478840757 -0.21599137964016024 0.37039954831392541 0.94340778532274794;-0.65609332716617974 1.6946004289147862 0.86876699991657447 2.4153208417546619 0.085712600033259922 0.97576319708851145 1.0891217152041006 1.6506179016126123 -0.029447991964629484 0.38736803290098215 1.2723722286739385 0.63371775911893646;0.24807373273547842 -0.46266892969351087 1.1351621840610977 -1.0534830370907329 -1.0482910043721663 -0.17876766885141124 0.19445656203784112 -0.86565090245975951 -0.12345926311228038 -0.2669138380882653 -1.2456060957228232 -0.076616857494032228];

% Layer 3
b3 = -0.50085476960238462;
LW3_2 = [-0.38841520109155947 1.0956012345210682 -0.45125644148331334 -0.29843970820027077 -3.2300642300563189 0.2408083549200212 0.30161187018073882 -3.5042304622600522 -0.49175561052602723 0.40045988913250991 0.54507792648327036 0.8928916901616748];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
