function [Y,Xf,Af] = PM10SantaFe8(X,~,~)
%PM10SANTAFE8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:33.
% 
% [Y] = PM10SantaFe8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;0.00341273633199099;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.1958117510895196;4.8861205643846093;-0.74206086753325984;-0.78821849140206979;-1.0150195281173722;2.138567824907426;-4.1172108257392575;-0.039814030718229448;-0.4283479264912739;0.89345760194418034;-1.5775951863972864;1.2774412141586502;-3.3865107102779581];
IW1_1 = [1.2801094983239971 -0.98238596427085145 -0.17415601917258441 0.20399228999160321 -0.9486906356846152 -0.6842373185260654;-4.7429709106992739 1.6503702366064088 -0.23462830238508056 0.33070287907841106 -0.54171211411476694 -0.29159498628041125;3.0409417547504294 0.35825467846534154 -0.64193308708969199 0.13290436593518859 -0.67888832516727504 -0.11651612356700676;0.588444177241776 -1.4673805753992912 -0.044746912772392358 0.076713244619603063 -0.22411567047708522 0.070679173040334178;1.2926349246543114 1.3948881060576146 0.78082000262283102 -0.79787913969159674 -0.837182991537749 -0.17136512564395762;0.32134040869764013 -2.1044688839855752 -0.39184519920831129 0.55712994297190788 1.418228434528725 1.5725239422837101;4.7027205892114905 -0.43010145714898107 -0.18009590030940353 0.10710381721069998 0.21808923944017472 0.13219497921708878;-4.4733749414540398 1.435809634753932 -1.5664328044331233 0.3613298138285726 -4.0034571091273401 0.09430599067576706;-1.9456056166521778 -0.2452632415386479 -0.41343643715377087 0.68126661237302288 1.400163740102055 -0.62800560605343558;2.8208221191083256 -0.33525706095237279 -0.63559017797684081 0.28504789783742557 -0.37992027920963845 -0.15425640294921061;0.083183026542187871 -2.6319641571658523 -0.02644923396098204 0.017062850022371037 0.25510479885782422 -0.020723562737648065;0.74564413856491829 0.58992276454085568 -0.60291422410132023 0.72810914672650751 -2.0071164608452743 0.26685117475542197;-0.70613062320300923 2.9233647353160688 0.46025492121984501 -0.58010565886904741 0.2244224552630299 -0.33442635106818452];

% Layer 2
b2 = [-2.1323149344203172;1.6464783714292501;1.2831047695570268;-0.35594319004470421;2.4891099866290509;0.78022152444341319;0.27903673653387157;-0.79789404447442513;-0.77248955402211017;0.65157831832038426;0.89722338540047553;0.92363699159627799;-2.1135734995374489];
LW2_1 = [0.33446844647721058 0.98860026018180169 0.73757183734441589 -1.5109992883127121 -1.1123358480989904 -0.10314944212027385 1.4613622337658587 0.39510026908281737 -0.45958247123516188 -0.27927969414998643 -0.099104402787117143 0.52222516546696462 -0.5972167612008894;-0.13622475954941157 -0.59158717514037829 -0.60888068869227696 0.52221003152634293 0.19436243783486024 0.14979984493689974 -0.13070086109878762 -0.44257278797240701 1.7779161120725222 -0.38355242207822321 -0.48267735555330804 0.80476710768048909 -0.036104451102874385;-0.46280741163752009 -0.70245463976051459 0.092422474407748464 -0.10716540228639282 -0.21237695293559355 0.42251403281169275 -0.7258011708876031 -0.51740782082512449 0.70173337620674714 -0.35989816069939196 -0.42001829352660741 -0.41709454695846776 0.1341037790142498;0.9177265531378771 0.30294165440607634 -0.38849426028921308 -0.80550581060433935 -0.20968657265500576 -0.29754738063525182 1.3191814702018132 0.62098549576595552 -0.90092159504846125 -0.49668557456231482 0.24002129501968461 0.33676095144124091 -0.44596973985299387;-2.4326700206969925 -0.55299312098997977 3.4610725125524779 3.703568269175316 -0.79414299083356243 0.013303262407521036 -0.63192782952454363 0.96545801728003178 -0.13761130916297903 -2.9935827029699773 -0.52264197879427621 0.23466675606018339 -0.90772785786078036;-0.3681592033241356 -0.79541565381058921 -0.60529457598789138 -0.90845089665358436 0.027911317582594242 -1.2897935523053887 0.46378592435378718 0.82345133199927256 1.1943568158655735 -0.083772906143763509 0.41046140352720001 0.29361277344061321 -1.4594398655558902;0.55827448345918917 -0.041333709417811976 0.8758742169768754 -0.28914880757467692 0.24222393585077384 -0.41567250343253853 0.092256278585206464 0.61698613762585108 0.23261124840584177 -1.5780493629242496 1.2976857345669293 0.55247242244646122 0.47208677608507132;0.53780170384901615 0.58679483715441971 0.33034113818217042 0.92196115100768894 0.17951763049610139 1.2014811817467095 -0.67932136369464169 -0.7336990791035386 -0.34656401571555306 0.1434020217440696 -0.49117107305747271 0.53508130739005333 1.4331347337494433;1.7867903046289513 -2.0583325458572492 0.11620822293118653 -1.8312880179088908 -1.3441127084636244 -2.27833618146121 0.30014127616381392 -2.242987006305496 0.012628272044359488 0.11855248871802407 -2.199371853904128 -0.59055902734839427 0.58045192973169091;0.46830585181411427 -0.7251695594939942 1.4988308465863307 1.9978112057361275 -0.34996235559576816 -0.20875276526288958 -0.38781410662623395 0.232254472598104 -0.11093002331766598 1.0346582586257698 0.20541720751921014 -0.071538852068698477 -0.19999396365958166;-0.14190420530805581 2.4018357124039751 1.3805785049650923 -1.0555578787308197 -0.93828338016332258 -0.9163581243458041 3.5359234969401516 0.27123521619186081 0.14268782170079464 -1.608843133714474 1.0979377649810731 0.41441450239811806 -0.53788691036906;-1.0683884431644504 1.3105295715282463 -0.1759579851908479 0.77451185949966495 0.96643524113601664 1.6738919987282233 -0.12707115592763343 1.7310225452691066 0.71438627073980576 0.49087686708695999 1.9079793199267823 0.94027529195614146 -0.91550554513291094;-1.3090689359063958 0.99653879674233847 -0.42638276906180139 -1.7937899486513433 -1.3779688542168496 -0.18411790053422389 1.6560001082863507 0.32760955456257379 0.60630581778907566 1.3253398028713774 1.2774513925146196 0.19748689592590418 -0.0028886502574748322];

% Layer 3
b3 = 2.0303294399920397;
LW3_2 = [-0.87469995993027494 -1.5459861449924173 1.6388168978720061 1.0200269765407275 -0.91023395637399573 1.4345233956104066 -0.48008426795615955 1.6323846204797308 -1.2770273778879286 0.2495178328117221 0.50146916912772632 -3.485577483143572 0.78674769181366833];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
