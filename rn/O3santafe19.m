function [Y,Xf,Af] = O3santafe19(X,~,~)
%O3SANTAFE19 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:50.
% 
% [Y] = O3santafe19(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.172786177105832;4.16666666666667;10.752688172043];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-4.349088876332651;2.5488880412361259;-2.8621772341285245;-0.12283774973278708;-2.553018621275716;3.3290643152394259;1.4853173198476612;-0.15045492393999652;0.81648297973244288;2.0185365107329125;-3.7871235658574025;-0.91975415720892872;1.9325839384667547;2.869178608819281];
  IW1_1 = [0.25633604223456297 0.16737479779290959 0.25695183265304483 0.69973129620651198 -4.57505623429729;-1.9443514263019623 0.42655425669095398 -1.0369967300521845 -0.11338634475575571 -1.2438513236191544;1.5542942053643602 -1.6745066076247321 0.0034878218879586809 -1.8415420252452201 0.54426192459860845;1.1392199978929636 0.92583489865234836 0.096194056812357112 -0.019317326886838206 -0.74843519754103527;2.6700797964773777 0.93983116270087419 -2.4464853102765582 1.2447357230648524 1.303494001929473;0.17343875186509752 3.5370480359499292 -0.62026297367536842 -0.20619422044418406 1.7741929698686607;-1.4198029908625616 1.0031199070417749 1.2190523981687744 0.94233139421836742 -0.87187350579858114;-0.061799274341750039 0.57477190950358581 0.5595166571116964 0.40394775269557143 -0.43238873544572859;0.49447380719517908 -2.1701545223118583 -1.7524511003596379 0.039696810435521056 -0.35388403251246026;0.39383908632417064 -0.59827835275720909 0.16425584200121177 1.807674632140388 0.51257053106474204;-3.7518610387517879 -0.43033386498549059 -0.49508141899250546 -1.6245872152078171 3.2759863141758396;0.44142994669192426 0.96925505218649 0.89205663800071511 1.6045587228808194 0.59116760904078991;0.63172382969234564 -0.72630511839449829 -1.5785263444287039 -1.0927916007725464 -0.30470394652698163;1.8366251064712023 0.11779153616596995 0.84580280379714901 -0.016531749054539083 0.62481943966792508];
  
  % Layer 2
  b2 = [-1.2399985348002815;1.8020433089370016;-0.95673342984047338;0.72729248888952447;0.98570991122806484;0.74524407587734132;0.1789674067808309;-1.0269800882713749;-0.1450113230048336;-0.24279926812865638;1.1098804160991427;-0.47404010805221897;-2.3897184311454267;-1.9962039272826082];
  LW2_1 = [-1.263746154639259 0.32502260324330118 -0.85028569133089094 -0.77062912382695137 0.72468519471842285 0.483861783707981 -0.52716880904278463 1.4389054753546333 0.64188184974274742 0.77564663226775243 1.611714495664031 -0.42955859765471177 0.68620959379593238 0.7358253956110643;1.1918132649611279 -0.44667481181810903 0.24742565015866566 -0.67750725717610516 -0.28137937718360817 0.50950314135930108 -0.75099551479889659 0.42935919871535944 -0.38644990128556211 -0.45395232373571687 0.66819030030907534 -0.9678980121721652 0.10151815407373183 0.13774645895441026;0.59179902314546973 -0.34441117378920472 -0.29358836347246642 -0.80175318075883695 -0.087143006999281791 -0.38371017106340205 0.32524030140458277 0.45582860137146741 -0.39790867777040773 -0.4244169015326924 -0.15246064816932173 -0.46375167631566172 0.10840933681732012 0.49392270211819367;1.304932429086318 0.20594331777628228 -0.11743240016997293 -0.73092694688498061 -0.43377436615554577 -0.17517582615946761 -0.67300249778493826 1.3660315923549777 0.25861913976727036 -0.95796767549252515 -0.2103382619828526 -0.064149273748286037 -0.072288799457210923 0.096626413132415351;-4.4945473423421438 0.46835483092103986 -0.21338643444524447 1.1947676871331374 0.59175565486524384 -1.1438302503230735 1.1434358279827375 -0.5953136077806358 -0.93058193245966758 1.7450061358593811 -0.49627647331773106 0.8365435325235262 -0.61593266677737368 0.22249968167265025;-0.42333361872488301 -0.68604581813824106 2.1239021626867749 -1.7735180091144083 -1.0609303450443963 -0.51153209565238056 1.2874798374016412 -0.098797642733785399 -0.092576779795391625 -0.62129831327781215 -0.67402134672850189 0.25455555845054423 0.077490128604216946 0.81581850199941097;1.5658495283321576 0.15327937738529335 1.1438382844535147 -0.64733574797160698 0.10722246919694858 0.18193100316788569 0.27304538002019563 -0.97626454920177419 0.20651226797852218 -0.51442811473646244 0.93648235632109234 -0.55028281503063403 -0.15337819734642655 -0.68082344270438044;-2.2939614295678359 -0.20441954564212003 3.037963132659649 0.32282275322052018 -0.4482555325361044 0.3493937509574716 -1.1807426289902874 0.39412482904191481 -1.1178403723317194 -4.0929126739415231 0.20478826626341079 1.3828744426066182 -1.3343528000807763 -0.13009348386466207;-0.83379266873042157 0.57817306350113062 2.2917921026527921 -2.021468917467137 -1.1494672890053259 -0.73869965083469646 1.6741309474773256 -0.40800292037029068 -0.36644745874042278 -0.52553787286312992 0.12175640284828389 -0.22704403634161524 -0.27159588815081498 1.1818133069272094;0.34576261718662998 0.20111352867152427 -0.51064156442411024 -1.1492674962489509 -0.24739254891011228 0.021722474347986589 0.98512634426668444 -0.64954442869401374 0.18760605517660481 -0.61115635107790167 0.57882558297875253 -0.85640259936496199 -0.064230624184252336 0.35491165331650792;0.81353860807034262 0.99800323428507032 1.028780970685925 -1.0051345759986701 -0.62250289637719569 -0.038891687895968176 0.090265076953955137 -0.16385448641876951 -0.32265174336848357 -0.89844716022769699 1.0502809094646686 -0.72136661557182014 -0.24549219068666686 0.012138042900160859;1.9789146484499196 0.18813902160801474 0.19215687742378468 1.1967388254714113 -0.84014609285127773 -2.4730009871878349 -0.4877920152926371 -0.1682688873259775 -0.21094724492634143 -2.7402990506325544 0.26462591328705654 -0.06920668323950907 -0.10015262190913932 -0.18174826096303842;-1.5588035824579187 -0.35617321206202185 0.055469980147576509 1.351552453966667 0.4850772206835311 0.25841372798404494 1.3674008006986611 -2.6242652046766737 -0.57942555822055442 1.4722926197139232 -0.40907648088349235 0.28121009138246517 0.35380343393609137 -0.026990771569393238;0.025288490241379954 -0.52632018105818812 -0.28124060216560459 0.117025838575295 0.73924713074816051 1.5370865437535601 -0.12323091035118999 -0.19933596275949567 -0.35524385596468955 0.94528969758613479 0.55078230014960583 0.53263910025751993 0.025581197484723345 0.45405619136866437];
  
  % Layer 3
  b3 = -1.390094046041058;
  LW3_2 = [0.88864838155969694 -1.0764781558902299 -1.1197276959291775 3.4787640534797992 2.3551595632331921 -1.8646300853934925 0.93782316138889021 2.1469169841786329 1.3203686318053733 -0.88226768497209995 1.3584363641072763 -0.57857880265809192 1.7117811588882019 -1.246461911281715];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 10.752688172043;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
