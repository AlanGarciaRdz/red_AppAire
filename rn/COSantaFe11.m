function [Y,Xf,Af] = COSantaFe11(X,~,~)
%COSANTAFE11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:08.
% 
% [Y] = COSantaFe11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;0.448430493273543;166.666666666667;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.4496763504927881;-3.7439345056824274;0.96947996090918465;3.4016141504716892;-0.82144501279212478;-0.59674209232250386;0.50674990704962275;0.58369663302921349;0.014177446502545672;1.1901261104824794;-0.38321080028360793;-0.83433209068891911;1.015129941125503;-1.4651766067788008;-1.0148810347849999];
IW1_1 = [-0.30311111178901579 -0.29932817623351932 0.091715672864321807 1.3278703069800266 -0.46451718903029221 0.85248444014418134 -1.3352502884432031 0.16604560858126982 -0.15010315562740328 -0.024950336372788429 0.75614253146753296 0.82298900851394752;-0.22974786730130339 4.776911095383964 0.58190039910234381 -0.21827103156925809 0.00044034853020954133 0.20997613798120132 -0.72191941678742377 -0.01028947383617293 0.028483683552255737 0.31682478889855342 0.3942013937870969 -0.015359995784609514;0.0030713158651018519 -0.42979266446478293 -0.88012960059504997 -0.54608658356356188 0.65764519659851572 0.46351297180291495 0.29072875779396823 0.10948328576500051 -0.039628991527297486 -1.0299528953466941 -0.14707687463210595 1.1185229298653263;-0.63045194865554954 0.52745143830612429 -1.0123304689732087 -0.23647240879333234 -0.36669221444577527 0.84645176150993251 -0.5084972727954814 0.38173634362301156 -1.0900507383502078 5.5152583954930625 0.1964555766345312 0.14208618563487399;1.1083986644285069 2.083702609841898 0.71351520519562617 0.14620838832871799 -0.065522579312114249 0.40859165955938459 1.2916465251788518 -0.21464978446823174 -0.39626867049155912 0.64530259201944506 0.51019229490451834 -0.046283115308663227;-0.020704259808412836 1.3142428304721014 -1.0131819150376409 0.76104638171483208 0.33048649868082253 0.8183514608104222 -1.1831471368922901 -1.3051515326919818 0.22818574139708492 -0.94625257321263512 0.59738355458010128 1.0309821429197543;-1.57271333633824 -1.47374209519691 -0.56391470298264812 0.57494070823497534 -1.2219158761587581 -0.7148724601350025 0.51260488338842392 -1.2015408081764611 -0.68837343898894643 0.73971298360163185 -0.59839111430157721 -0.58108789152756257;-0.06979698017016675 -0.64605072517091455 0.035172739715992302 -0.58786064290819418 -0.31678092684159176 -2.0653045931665122 -0.24833931744485868 1.1619711685388359 -0.26249917085788987 -0.44954580940654798 -1.142464115617448 -0.19560840685416109;0.41698269687302586 -0.86125098061963135 -0.20668708563066385 -0.6932681698100206 0.39696623542479664 -0.11213290336552934 -0.25061832602241113 0.18877440055690609 0.63803940571678597 -0.71880967406158625 -0.2106301851301548 0.15682470045960431;0.14196149512821729 1.092603564632632 0.24790884647575023 -0.052743910329466084 0.022067651648539903 0.13722802737761947 -0.25820657804509184 -0.0017287042938436683 0.024902329031941138 -0.26625386713515153 -0.058296595514447172 -0.046636254962679313;0.9719957721046345 -0.73271976580826625 0.19070010125114467 0.81709410003907712 0.38711200977210508 -0.24755278354013394 -0.15352878381527696 -0.063155939790961638 0.35184043992456937 0.32645985882275796 -0.1005409901656622 -0.15714470775809558;-0.72499857412446977 0.56094414014537308 1.2775253271609994 0.80628110816893672 0.20715051098016229 0.30660646035712874 -0.3804714142768556 -0.28409852503034555 -0.64244809196679165 -0.63646074102671313 -0.19456256470477104 -0.54729219513146388;0.355284306790001 -0.98323757127054112 0.38489321590999143 1.2806851829768047 -0.2067484436523904 0.48347859031635881 -1.2391159431220977 0.0075294009237599812 -0.043582308131779803 -0.14066611403607204 0.43423240406777491 0.41088265512504279;0.82872495030362614 0.43534815682568018 -1.3559796251834733 1.8972482059515907 0.20788628558154099 0.10691590620611312 0.85815254681110442 -0.51630222356129329 -1.843331257170673 -0.97891786217798293 -0.13730657670050611 -0.17844051033897693;-1.4811445328895425 -0.36557701756768718 -0.14380109114240519 -0.1022688624362835 0.092184249600398505 0.46797039660298961 0.34714925564741789 0.16817197275042955 -0.49161441659572447 -0.73872450757801855 -0.034403914728771509 0.31085738003400809];

% Layer 2
b2 = [-0.97876479982534481;0.58956191772730104;-2.4685686886978657;1.1322520318764075;0.81904394917447498;0.7862887005039344;-0.2883873986188622;-0.42994068837360216;1.0336591650732341;-1.2401168679747943;-0.7143708461862176;-0.65242900966826756;1.5800977222915353;-1.2498491037323949;1.6007241287233627];
LW2_1 = [0.95184175376922198 -1.5800203552030145 0.60355957819268591 0.013543615421293349 0.70781021918451403 -0.31814577453397436 0.33040210618919785 0.44862001536697405 0.84366836196749373 -1.2108736508360576 1.4866553427371503 0.57151892653839109 -0.56034784106619939 -0.20309533976370064 -0.2124705837435201;-0.44611704979705158 0.065402525329703198 0.050562078094994189 0.050306497236131183 -0.69953614535376818 -1.2775355697839774 0.1709412556515913 -0.89962319822512526 0.24738098410117451 -0.12972790829683117 -0.011594980066078654 1.5193569151250694 0.62918335273261716 0.6481988999217273 -0.47525925250956153;0.15728289294795503 0.14461489346819403 -0.6075617978868777 0.75292136040437008 -1.3164602680107436 -0.38862848823469914 0.46494488325313166 -0.83458195965197013 -0.18764343162846359 0.91524988306099964 0.16233588493354936 -0.59932232292250587 -0.67428992799617471 0.0080378936888521879 -0.087976082039260883;-0.19261397631505775 -1.0960922457095132 -0.27344815565210301 -0.93396420097587418 1.7475078377881577 0.19755564206157042 -0.31066415886285431 0.96779351525021562 0.11121701647785999 -0.14307701924082061 -0.32196952251875971 -0.33665963121814363 0.55749834588782288 -0.074656495027583453 -0.3876729483848842;0.031015995118439124 -0.34545043118887642 -1.4680325828980714 -0.049453852274333507 -2.0321404348063523 1.2005473671588098 0.65107143061031125 0.013676415414474369 -0.97645517615611932 -0.2745084307306051 0.95755356313551154 -0.53325286327454968 -0.45599337737569634 -0.27833026221208212 2.5049451730104115;0.31423783071461875 -0.011483354835584842 1.4283908392588218 -1.2942961981124879 -0.63688001316416087 -0.34991691620519316 1.2131857980406802 0.77168401006021903 1.8687103249840227 1.6912241529735761 0.73032145957137395 -0.15454287682904647 1.1856491770108031 -0.75988608741358621 -3.1131570955062284;0.031720080606983336 0.020746671646054631 0.046181603436321418 -0.13991296942183698 -0.68442720676303737 -1.5122334347105473 0.76943714642062644 -0.57796109262572459 -0.31891654102703532 -0.53159193725691978 0.13900874491537704 0.38482936283478364 0.13051390507481767 0.83067401315158274 -0.705123647821569;-0.92205094379267261 0.36048885473962544 -0.73637449808077371 0.0026899831059195856 -1.4590319629089521 0.80391961938646994 -1.0061632792124935 0.18423100460152217 0.91067137996244585 1.0844830370698564 -0.32173599586487167 -0.23031373524150228 0.87693354060645901 -0.77041501901462317 -1.0734274212248334;-0.23703391958012571 0.3655459702355276 -0.2743584409030333 -0.19856631258868887 0.92140047192071928 0.26016232046353438 -0.26417371929468864 1.5196104851057517 -0.86172445342956283 1.2402922884927567 0.27177795494877177 -0.55368656101414593 0.21911900963591643 0.1230077273401005 0.64793047132665238;-0.656648336115909 2.2748781826231261 0.79718232239866804 0.68060389320251125 -0.41323441751373768 -0.37523783908792957 0.35705405839809279 1.0276366629657157 0.23114799652381468 1.7962273997233538 2.3041028126082734 -0.029359263171576125 0.48222915445848058 0.41096256333126152 -0.22292475788652316;0.011178570353105073 -0.059124197154986798 0.016833984368291144 0.63631259215466318 1.1688345055827938 -0.25930917246667001 0.28832465760274401 -0.26317902712052443 1.2590936824547156 -0.68285102801956499 -0.27526894060127466 0.46217928531346997 -0.40620979936960167 0.013345916940331963 -1.0441362079942269;0.051458022677901144 0.13403369384058128 -0.063877704440319427 0.10966269007937796 0.49660328480693255 1.267892178871759 0.13209313300489556 0.019845676475758037 -0.29792580100975619 0.34024563039008876 -0.34403740740554806 -2.0030004212129895 -0.15443050621243995 -0.36017044822750577 0.44265726284892576;0.19887590912947328 -0.24442460726207116 0.24084771140207917 -0.29272123011400264 0.80076634437118455 1.0487013826678 -1.5442206276136377 0.5425348108854513 -0.86465832148365063 1.0851900896844839 0.39402707153884686 -0.30386003126038214 -0.73541388809981068 -1.2667208067217499 0.23685986363509409;0.10754773720074154 1.9284748250985739 0.56432871878957513 -1.6445639036602564 0.31537602565806311 -0.36644699531430608 0.64671019461343904 0.30828769375947424 0.16940972948202587 -0.62608937670453901 -0.91761862091330959 0.92664318177451055 -0.5888817913891492 0.40974838907334216 -0.20694965548801442;-0.08076906969583858 -0.17926938491758279 0.3622353812244023 -1.0780932998115873 0.8866603659546477 -0.65872051152510425 0.21355816258025942 0.29264480465696896 -0.41619106881814755 0.6208411471547981 -0.17499995325251727 -0.54589339222372102 0.17941229870854053 -0.33363112725513849 -0.5587752414409799];

% Layer 3
b3 = -0.16172663136388638;
LW3_2 = [-0.56146250024624178 1.449185146753877 0.82705391608639445 0.68681014296568732 -0.30796407760444372 2.1142893680624253 -0.80067306813018879 -0.61339225011744725 -2.6272244286159925 0.52751708874773839 -1.6343844750034568 0.87979867414649204 0.2292008779118343 -0.40052607490331615 -1.9312062697433952];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
