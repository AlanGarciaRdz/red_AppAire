function [Y,Xf,Af] = O3lomadorada17(X,~,~)
%O3LOMADORADA17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:41.
% 
% [Y] = O3lomadorada17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;17.6991150442478];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-3.064342652526622;2.0940092315507575;-2.3612353349008215;0.74777692895857861;-0.21914206568546069;0.72235151493770089;1.2421833865079437;-1.2946915370276257;-1.9485989088156062;-1.5420454222825861;-1.0188987506172613;-1.5905273753717366;-1.3015283130531765;-2.3368520607081646;2.2957076523669806];
  IW1_1 = [0.21861319998150169 -0.081979299635581135 0.9436973156803119 0.78350213168740745 0.55839692654525708 0.4917739579398559 -3.1451125017985619;-0.2791219931525129 -0.54664752895726054 1.0051309360666463 0.11092172649861878 -0.80748844694119815 0.9311160525265858 0.16863627862678077;0.42017432340858551 -2.745256776083437 0.62678015796561704 -0.035331587025549047 -0.010302962294446376 -0.22088215620636881 0.8677152151309564;0.12612130967651022 -0.016412197450135658 0.74910571856047625 0.72510046896878122 -0.46151136978567497 0.69892248556821479 -1.0823873380736528;0.98033268633799653 -1.8673818821290249 -1.4645596350210897 1.0439579942655075 -1.3388580031423525 0.16034559353461822 2.6759265567854333;-1.8669395048613757 0.15382862278320608 -0.16840274625882032 -0.74565316031695639 0.51594621407126295 -0.13631632613251873 -0.41858961005091938;-0.56490497854021748 -1.5140755915412876 0.84436043511682035 1.7157085943676442 -0.60013502955387688 -0.30567839205635244 0.14844594148587822;0.99287656425108273 -0.45987651470562985 -0.78803691056308667 -0.2740886959461607 -0.27576892797116553 0.04014984848607589 -1.2680478064263692;0.27868623127139541 -2.1479132825189198 -0.31888670764457749 -0.5331033036184547 0.42204796362030611 -0.44323496747307378 -0.13265015986589121;0.004087420290913607 2.4447847230718631 0.36940488457361986 -0.3785459192696925 0.56424710576514425 0.10084642782866138 0.32198024726568431;-1.0284898567019374 -1.4545372033335624 0.31117150946930822 -0.73375503662759334 0.62706899314870157 0.79358249427635208 1.458817881475601;-2.6216285066375002 0.076143338310810382 -0.75310592446936619 -0.52958149413540145 1.4167437223580577 -0.11141129833577722 0.02318548282587524;-0.24720015853882316 -0.22891730163230306 -0.80610751930636471 -0.28876071034831202 -0.11166051642656702 -0.2821061622718149 -1.0498589491731045;-2.0981623487926462 1.3210135420107538 0.87350349923301085 -1.9163755991819009 0.14797955476936195 -0.45664510889940529 0.3770464212475072;2.4130955458625767 0.51044284752737912 -0.33176432714431925 -0.26945264948018727 0.93530399929771768 0.74326736520841119 -0.40972676904884031];
  
  % Layer 2
  b2 = [-1.9842768518704359;1.3324488874588871;0.69281879277758518;1.3365154329102846;1.0435896819255543;-0.34066502330596671;-0.26115420627109481;-0.60651995455799224;-0.25288367972333653;0.60118307874729837;-0.093464799637435869;1.3446764872647785;1.2822930781220454;-1.6985969953720197;1.3283493201164591];
  LW2_1 = [1.616382054759844 0.27617227325950366 0.37296147216126507 1.0318605461323418 -0.23268145020572079 0.22415196647376295 0.23208199597889795 -0.4747063599544617 0.56304792681860971 0.76556832269526642 -0.33961541693947073 -0.039833557361953695 -0.47767391622187982 -0.70481152120837798 -0.81915417461868012;-0.038434157264223494 -0.39476615554782307 0.57112180195337858 -0.70581794894444672 0.21520792905245556 0.48765444733364666 1.0750636018739244 0.55884056603342258 -0.77494389054844992 -0.67835987598287617 -0.17102383360082477 0.41606897605854659 -0.29615736507760004 0.52132756014699777 0.0326363078649968;-0.42647966973716916 -0.7075882669254816 0.75831189737676397 0.57328872136661269 0.58362527618265259 1.7378095756001504 1.2462163893775098 -1.1329124272472533 -1.2205783428302375 -0.10899995990747602 0.77153268347610471 0.65369407905665633 0.4725205208381747 -0.72489770781365981 1.7320706810576072;0.0043577904947294244 0.27411565296578111 0.87185137370781163 0.006752006507511836 0.91749792916166828 0.9929922979559751 -1.2234801582070651 -1.5434412955898389 -0.39372800570507072 0.27251621020236472 0.44985334670397631 0.088071072119743465 0.96677622585092327 0.29523624165387852 0.35969308558510293;-0.31326535022468038 -0.26939012621573644 0.8471131112392476 1.0059942349234232 0.47601333261010781 0.28843553903101143 1.2478841112740302 0.45750589220239402 -0.27792775398353559 0.63907713514996323 -1.2154001406670416 1.6663568806505331 -0.78647481003005859 0.34610201461122136 -0.22377974829889247;1.4232010656281762 0.61817050464267442 -0.29036854441636267 0.62430061882024568 -0.08686258404856799 -0.66192988899348526 -0.86418884377380012 -0.89740999505122576 0.61872108248943136 0.23735255385149023 0.80203946788562364 -0.74056187568970311 1.9133272341056313 -0.3107621121688412 -0.56367497713212344;0.61994559642183955 0.50092184184402044 -0.69443055551718835 -0.20998645051568832 -0.36727828637241045 -0.063515144714881983 -1.1734135703739665 -0.15154260591146623 1.1627372751420035 -0.81915882595816569 0.097091742667510236 -1.0595436330646955 0.020467804208738012 -0.069473628669268164 -1.0761912649589684;-0.15360942962640389 -0.70246039131508065 0.31798555047432248 0.39713049478118034 -0.66776879948176504 -0.59739247951391616 -0.23666146537398688 0.18833679190032196 -1.5320343731874819 0.856416470259447 0.85098829984378499 -0.059111486385507589 -0.54053556491570631 -0.15943892904854001 -0.40675062662435768;0.9351492939939019 -0.1798911656506379 0.48160428173606157 -0.89919034117940111 0.65505221467505548 0.6188167245093199 -0.30481977693772666 -0.43437617982951576 -0.98755786574038285 0.46292629930123064 0.86862382937494953 0.29491208746247327 0.80381299565724829 -0.46132363575170277 -0.28425165160347565;0.78660810024621552 0.47482145870672698 0.58573320504744852 0.057158425992953663 0.64377371212801293 0.55885436107761699 -0.010699779645530191 -0.12293723257164312 0.78376062859037887 -1.2318610436501125 -0.95140378055566244 -0.62871455085238048 0.1488185983309771 0.66874371244429098 0.69560255277294381;-0.2802425910824774 1.0727140918453351 -0.63548029248218907 -0.85046258202028635 0.14846795299556489 0.75134545837031297 -0.82170765709368954 0.19919123544096035 1.6910689114590385 1.0319046884931233 -1.0398383249886225 -1.7852510635107568 -0.12726460826023978 -0.13265100865354226 2.1215382058687728;0.63619059727068161 0.24283443653728531 -0.999965610242459 -0.014056396874584725 -0.53783222479882364 -0.9329015505889301 -1.1141412814002576 0.69760272292783931 1.5739482986950695 -0.36408657643609343 -0.11814284060891593 -1.1925831913227483 -0.95298646991990255 0.26620812078751604 -1.6541529386547908;1.1678641444144204 -0.69952009325939923 0.068557287002563111 -0.89896378135863442 0.062863650801629894 -1.0162355578663471 0.53457002534914966 -0.47345592062925823 -0.16545389302897057 0.70114746550244966 0.180799046459927 0.18344913592699075 0.19767092318747262 -0.70347321238866622 -1.7165522310549777;-0.43778298091363399 -0.93007010549482705 -0.66323932643768835 0.7343619407353863 -0.266366521255607 -0.84087440636227739 0.7487611402927723 -0.050038517385248921 -0.12094662055065855 0.20729753550615251 0.83852469572071575 -0.23647142497416734 -0.62365061641869046 0.34530807655595225 0.59873299438861582;-0.47769823100629588 -1.1544817350856558 -0.13748482880402646 0.19536728526972619 0.30020970508996564 -1.063488774118069 0.29731068759375462 0.96927575074734262 -0.14536337239370259 0.37064110562545938 0.26262060453635749 -0.82433616257872944 -0.90270679067673176 1.11350627900323 -0.61340886526743266];
  
  % Layer 3
  b3 = -0.31665922364152504;
  LW3_2 = [0.54889298371257822 -1.244022968857381 1.0419144347438385 -0.28132219923738827 0.31362851834419792 -2.0279699934697026 2.3021715644081406 -1.5737778580723825 -1.3577592065853317 -1.2789491018813672 -0.21952872975651358 -1.8065677791234553 0.39933802354035736 1.6862894019093828 1.58685746331378];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 17.6991150442478;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
