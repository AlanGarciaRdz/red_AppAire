function [Y,Xf,Af] = PM10Vallarta8(X,~,~)
%PM10VALLARTA8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:45.
% 
% [Y] = PM10Vallarta8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.12820512820513;0.00782778864970646;24.390243902439;0.02710027100271;0.00630517023959647;0.141843971631206];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.2990876711742412;4.7143849985030766;1.1299835302426962;3.3082974881199547;-0.7482529186844058;0.64769473722335291;-0.050519791899897568;-2.2135501052431157;-0.057286473419630862;1.1807648379609597;-0.40686613073645378;2.6475478196858298;4.9115987388985625;-1.046993768947184];
IW1_1 = [1.0291720547534375 1.5264283365910289 1.3246414936479969 -0.90682526598783808 0.24850023010410055 5.0074144794121898 0.78259506613230123 0.32541154981732906;-3.3334131085381062 -0.50378542598743958 0.83923858853530164 -1.4402511840210501 1.4009937400857682 -0.5411549639069908 0.33395237714058018 0.060461649115958756;-1.1752904473592976 -0.26196138577755768 0.71415179285991104 -0.55760734270555723 -0.4202606832979055 -2.90587475072283 0.013827290194852876 1.5000730847209125;-3.7181322119442592 0.5248691426346791 0.26508844714670254 -0.80967038030105631 -1.0192933516653737 1.5292907620131888 0.54477441232755353 0.3289819371294942;0.14525701745894457 0.84399178482171089 -0.021934529685910704 -0.58720741687846045 -0.057986917904928242 -1.5098899272583157 0.22397491460104893 0.19393804467079467;-0.2895553259227896 -2.267727540360911 2.1267777332663855 -0.72435076775882301 -2.4608558465269939 -1.9041035701841531 2.0873885646542854 -1.3394543558225314;0.52233943093597923 -0.0035896669361342934 0.16021374954698864 0.71851690310269323 2.2252207081924018 -2.6741942331838837 -0.93256395135097447 -0.47011829605217076;-0.56456970849027155 0.68230951686562957 0.31792672445580428 -0.36780162023667151 -1.8682922266888438 -1.855537770101199 0.076301004779673373 0.18620330908766697;1.2265004741840932 1.733155109838276 -1.1931114683846491 0.68567626327685538 1.5709850356627701 2.2014496286387439 -0.26982728269663886 -0.70316554019845401;-0.76823743942165612 -2.4404484805399265 0.59307908591674807 -1.2090526119961429 -1.1521682447938477 -2.2888749239470485 -0.46156597989072085 0.99389101021323678;-2.4303988736169697 -1.1535871370724813 0.032696084328039256 0.22006620142430622 0.55036105685660586 2.9768435781514939 0.0464197429575023 -0.74216421445477132;0.77903159896140195 2.8052018860360022 -0.0007699809940304031 -0.59469397533499557 0.47551874101729524 -1.1833739649414732 0.17081005808013097 0.30486116572786809;6.1125364817547592 -1.0991855700219708 -0.65846525987773286 0.38225374975223747 1.7069453684770515 -0.40593843164023097 -0.3900922363396121 0.92561424928161862;-0.83711670017536155 -0.46996286886203975 -0.32557587105582209 0.1245912157800452 1.1441960751180744 -0.46668148332614579 0.27162874174723928 -0.27508904251589783];

% Layer 2
b2 = [-1.4064020739146423;0.31912197197748926;2.9144629291380011;0.66732032434418109;-1.0992971455412293;-0.48160525714104624;-0.086986197164249199;0.24529614554079418;-1.2144467732951487;-1.1912650520772265;1.1357503529528159;-3.1297404832730438;-1.890522871473159;0.24943415474118899];
LW2_1 = [-0.24705913332598733 0.057105862893388502 0.62978564175294305 0.034116985360855223 0.6345162290005969 1.0488101179077998 0.39801392482293069 -0.4071601567564837 0.89321997650750284 0.055214239016372957 -0.096628736418840191 0.19758897045553889 -0.43128516144879686 -0.41433831760066875;-0.87855794140539623 1.4639655646540544 2.11149228371595 1.4742257156596663 -2.3094773373053203 -1.0832515484023093 0.2451326060632158 0.13849061172066138 1.0134262357956791 -1.8155280785493497 -1.7825993698758302 1.4987582766393199 -0.46148400332865952 0.80186849435663821;0.0663040845063044 -1.2581228589627809 1.6576441872338972 0.59302661788495037 1.5739901640989471 -0.57139408206461029 -0.13148534804009854 -1.2370321682183276 1.5657342950359403 -0.38923251943264325 -0.87715260152600327 -0.5265975148324068 -1.0810772301211575 -0.40178484662474334;-0.55718120621678369 0.60782214376452948 0.70200477414320961 2.6533359406922874 -0.4783562823742642 -1.9441803989389903 0.94897128599321556 -1.1764958196056383 -0.52735889562188787 -1.6127157102094742 -1.3461252640336716 1.460190645447093 0.10159722299493923 0.57079036088648727;0.6448177285953085 2.4669224966842171 -0.18276058766905251 0.4247924216700576 0.10373128436174578 -0.53242360662461519 0.58001791365911082 -0.30428718576416752 1.0050029240588267 0.92362549097972979 -1.9519357754133506 -0.97328207759264884 -1.0394238628812993 1.9393177264565744;-0.86344537639925201 0.74719624633424375 1.6271414954777568 0.69136840706849845 0.83211067675118788 -0.4976477001986902 1.2776343051127792 -1.945110842966157 -0.30408126409959635 -0.76823311134683148 -0.9092288402306713 0.88861232576414528 0.080185098836050323 0.26395074346325681;0.64509183598769249 -0.96967916469416426 0.42443450654277337 -1.132000090240846 -0.76962244809328106 1.374883067768226 0.14871503369095729 1.3006670987531184 1.1676905303907794 0.71646401390199355 -0.068276933920632346 0.89320258992358204 -0.57597829721045857 0.45218355261675502;-0.7771056618430956 -0.43456181273261685 -0.36028794946916315 -0.36893361374625977 -0.11338164340419743 -0.57061206145906851 0.43407026414470251 0.53637197647713686 -0.28685247649996792 -0.77828729799030771 0.31583173641164936 0.25289537507418391 -0.25080352109822723 0.80705478502873917;0.20864561652992411 -1.5468155465368298 -0.68230498317353327 0.40614939795022592 -0.38533628522023294 0.75627906280693935 -1.2691802372913212 0.7926302964720483 0.76808354183650418 -0.37863128657348211 -0.088103328493833025 0.58328845441155164 -0.3657444859893309 -0.22609419205718642;0.25401053670449325 0.62115978391164961 -0.55109581640750183 1.0760197732620747 -0.22226932385892781 0.14172051954172574 0.37848919420813787 -0.33558166920476507 -0.24170538219045998 -0.19659493734898867 -0.30661243411627209 -0.63331126933979298 -0.86342354161386758 -1.035971892009129;1.5823403880466005 -0.40415280754097282 0.786504337079865 -1.8029221625716165 -1.0166250276028197 1.1141442145567308 0.34310649037708618 0.78794818363937447 -1.1119873475120001 -1.0176487715586184 -0.068162980143764831 0.61531102190512388 0.58854976462458164 1.7584140159086079;-0.92019752407610256 -0.30153922340827805 0.23917227145801168 -0.58857086936038949 0.042896831756098215 -0.25780862571562774 -2.1608470257592933 -1.3790515504335106 0.83217639115204833 0.72285658178297085 0.44276178936544436 0.60855626750815073 -0.37388362645192835 -0.28024757572867776;-0.51326543406545577 1.0078779088573158 -0.49474922835319413 0.86497361603386658 0.52566536729670632 0.19645736539331099 0.32300491845501017 -0.64488651050661172 -0.24009389767758621 -0.031978564332348428 0.47404523671243148 -0.25688911108991519 -0.23316119953551839 -1.3456474283980162;1.2299626195755762 -1.7633961869985415 -1.7535761522817892 -1.8816671624512109 1.9682452542555773 -0.63571263856510773 -4.1337275399060376 -0.28949144722907882 -1.0951138297433389 0.48608094842370642 0.19437472529551597 -2.6488719603697497 1.2659053741536721 1.7736243949147108];

% Layer 3
b3 = 0.66962916159656294;
LW3_2 = [1.0705334981873902 -0.8576376405826337 -0.77747468426737842 0.98886164312460723 -0.56292299289266612 -0.74678669778390327 -0.67061721526257645 0.83989426883966256 -0.59743093493373234 0.82652876683199783 -0.34121131983202008 1.1203007329482559 -1.6240763400947906 -0.91376342735028904];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
