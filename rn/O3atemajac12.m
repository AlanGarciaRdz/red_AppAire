function [Y,Xf,Af] = O3atemajac12(X,~,~)
%O3ATEMAJAC12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:36.
% 
% [Y] = O3atemajac12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.201288244766506;4.04040404040404;166.666666666667;0.0561797752808989;0.00614628149969269;9.52380952380952];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [5.0414304721384351;1.8373120455994345;-2.2314263824985048;1.1851789833691067;0.56330647321618088;-0.13822774780358549;-0.060707908515333045;2.5372842807857801;0.58499927867233648;1.8148917340206385;-4.640857030506452;0.29435848033284173;-5.1793868620351402];
  IW1_1 = [1.3313062839284586 3.9594144545088303 0.85474248559499422 -0.71644917299035393 -0.10218435662719912 0.023237117336927418 0.10066315570746662 0.52664891021137561;-1.8767546690030155 0.19925633931806713 0.17050171833835337 -1.024152248146954 0.22999541003685037 -0.91666749747314213 0.19105383335810955 -1.1239582841023181;-1.9802658561319757 -0.7413441757052589 0.35467099018109155 -1.2007049593798265 -0.20118990496790612 0.79082779348408705 -0.069048566959518137 0.73127990832778278;-1.704672901344648 -1.12673034291578 0.16007735646908389 -0.15430523964044857 -0.065454436818038322 -0.7580413934451351 -0.069074305379893855 -0.58147824821797356;-0.98572748979697822 -0.019209752360164527 -0.95472195798018322 1.6791514308930662 -0.17260367528221709 1.5319018713040311 0.046441704883441556 0.62206203011812466;-2.9018765550685948 -2.9072788531754954 0.6491919892031518 -0.31482897147724703 0.19300432765597636 1.108586506331076 -0.34825214096091534 0.29323856948966415;-0.85817098331661346 0.091608616255588929 0.43284326074329682 -1.2165970107701427 -0.43648230880526512 1.6092717054289858 0.0084908682283989165 1.6675641802323464;0.85548480304497798 -0.57035298688569136 0.08093232943284806 -0.18460256799204267 0.041198488506037766 0.15457803257618741 0.024015293887850633 1.746343541812994;-0.86383690858879236 1.5088584168862011 -0.34887304625610482 0.052410657326787791 0.004905739129355339 -0.043998573810683568 -0.0017477177331939272 0.19366521802071252;1.0180953467074187 -0.27073392634294147 1.0110962347309713 0.23024463637777665 -1.4101097265924716 -1.4166104119327163 -0.14508067277355169 -0.75494846710552566;-0.7415217531531062 -0.73001916824186552 -4.8653115030648584 3.207520550780091 0.75828658738424515 3.0748479992146001 0.070006332624534207 -2.5842846661219894;2.9718665871205094 -0.053884860705047798 -0.091993007630948725 0.020335008836448985 0.086556095472127045 0.6644680584515168 -0.11075689066131722 -0.78980088388877023;-2.2345364578130678 -1.3863215064859473 -4.3070182333788267 -0.1195637967769433 -0.69999378109882249 -0.6888473503441257 -0.13529711746583251 2.2342176433267698];
  
  % Layer 2
  b2 = [1.4047023805079173;3.0226142368591846;-0.74217174918955175;0.34827003882658414;-0.39660773426029805;-1.2144995402379433;0.98023178313437709;1.3881791301390694;0.17256080945216423;0.43556141276153892;0.8595032975059117;-0.94020590792446113;-3.3932186596686118];
  LW2_1 = [1.1531661693915092 -1.8045189572851921 -0.80386498017930574 -0.6614029031800075 -0.81578826473172428 -0.15122444281350614 0.64566516266218343 1.0525326604603593 -0.2755847344217876 0.80163410504556898 0.78161833485137655 0.57833899836803437 1.6829940457006192;0.011286698906179641 -0.47158858943972431 0.58040556200279181 -0.85014147204483748 -0.35486740968324726 0.20383329307754108 0.36071086897380394 -2.3138471988901474 0.46493122088830607 0.23671143166408351 0.8863407998051428 0.18809597783755216 -1.3360539433233989;-0.28151677528353281 -0.054882029524858017 1.834374316222082 -0.90744618052193982 -0.27794046588903232 -0.60926010168184119 0.54405365680398976 0.44265461649850796 -1.9715854437585092 -1.5790942090659796 -3.2670228493888529 -0.38768901877288986 1.6145589204551132;-0.085453437719420794 -0.0093757545138572242 -0.27583566582506069 0.42368403602679405 0.30593562951578751 -0.092749138684478635 -0.18171002323448704 0.68030285767746534 -1.8681602411372586 0.10363526507225791 0.11294574563164299 -0.85622067950080527 0.21913786023282381;-0.0073120789538066201 -0.07530492828292995 0.30418123555827936 -0.4643937803351445 -0.38247066587581358 0.085517620763161648 0.22477817552170046 -0.8720051747922255 1.2305448857433088 0.22051452214949666 -0.043132514955330561 0.83529742194503043 -0.53543266299371772;0.7018054785327531 0.37996795490190094 -0.17621756127749669 -0.43518325035020616 -0.080418099338053925 0.11369503536952238 0.089474200836963502 -0.4997642610685985 2.0762916609553832 -0.42259743073425421 -0.28277840909503571 0.60425857897322721 0.015349838743999936;1.5651997580568824 0.60073211707143781 0.94195542055831227 0.82563909594790275 0.041737399604358835 0.795127870439993 0.29651864573020825 -0.83547107944098442 0.41950901039029648 -0.14502669047906375 -0.13782521382128907 1.298307361188803 1.1344795425777872;0.052316392547462884 -0.28819767846889327 -2.260305316816543 1.3468907174679761 0.41199598614594773 1.0080337743306029 -0.39681303494291176 0.021260469903782817 2.34391406733066 0.69548374592672335 3.7721941489453146 0.059571119417595041 -2.6854369428043254;-0.32998170933648863 -0.372470542003208 -0.47813414233010687 0.7581296510090354 -0.11481530819919139 -0.34316651865109371 0.13643809973834597 1.6835951781554073 0.19490050268361012 -0.87744173323101926 0.13206398870717587 -1.0794841183231527 0.50038619152451957;0.52091605004315211 -0.53047219770339038 1.2318224319030517 -0.62083526688495339 0.022367402523857074 0.1738443215433938 -0.084975718173304376 -0.14453537894448595 -0.46102539370657292 0.84503736677417529 0.45215913667123614 0.80510865658071928 -0.16121979467990735;2.1332700251674925 -0.057991894630644802 1.4787506806338555 0.35830804719279552 1.3382724118093787 -0.08225019886597533 -0.94225352889774328 -0.5481227167999928 -0.11671582563719107 0.19947543048211691 -0.37667338268051515 1.7593345950148926 -0.061443284268073189;1.5749327325013418 0.97881538707671734 0.80133907418762951 1.0273297996485873 0.10366407200206729 1.2720312244108101 0.46530066702054862 -1.6097372468821214 0.74291962137247436 0.28020488306802005 -0.17072423537635614 2.2457708076276894 -0.3743054875972312;-1.4690704117496869 -1.5861865725344488 -0.2377879002250961 -0.94088123287061332 -0.41916428977869258 1.2322615817694818 -0.8538905123785212 3.2834580959025486 0.99608578896331934 0.34734500029208371 0.14502609827605373 -1.0948581900319034 -0.89486871275768753];
  
  % Layer 3
  b3 = 0.5144393366111667;
  LW3_2 = [-0.41510078023255353 -0.39705915802077663 -1.6714336508612349 5.0552842732989482 2.9581716127985849 3.0251947147331064 2.2435902551876752 -1.4313010097136423 0.76774148193186575 0.99125105397240321 2.2408280066912747 -1.7829856061742588 3.4404710017680333];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 9.52380952380952;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
