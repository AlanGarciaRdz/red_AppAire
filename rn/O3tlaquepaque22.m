function [Y,Xf,Af] = O3tlaquepaque22(X,~,~)
%O3TLAQUEPAQUE22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:53.
% 
% [Y] = O3tlaquepaque22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.171659085057077;3.03490136570561;14.7058823529412;15.3846153846154;10.752688172043;10.4712041884817;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.2553820772558475;2.147634781690269;-1.2742268345324623;-0.36628412673558441;-1.133168920769329;1.7180012145351486;-0.60668405628429911;-1.214261951077114;-1.6550735262287757;1.8295878055349228;-3.8433412517153398;-0.11948872953047598;1.4439146041253095;2.5260504964704329;-2.9990382767956305];
  IW1_1 = [-0.34598829214612026 -1.9884354812730518 -0.016906155149468978 -0.63653166692893748 -1.1622545412379419 0.4490965973633565 0.014466681405995663 0.10388384832007948 0.097866613172158431 1.3475459882172729 0.46755977003754468 0.020487897248237949 -0.012807446137877945;-1.1047441450848035 0.79220119080983764 0.27787536150971159 0.2686345613129808 -0.34810304038700102 0.46463922047594491 0.28560839259656728 -0.1361106259512323 -1.0567154969689532 -0.65133692182446368 -1.8816993161400648 0.56405340655824576 -1.0187126472235857;1.8403697005463118 -0.10007064558830332 -0.14179661710386346 0.9644167779740892 -0.73334710357969679 0.53435234136777354 -0.4092412560588462 -0.018824656408199449 -0.044786942034523838 -0.026166504632309684 -1.1186926905937098 0.084772747466720727 0.46989466034627614;-0.63062754583577629 -0.996091491879322 -0.22287085228416806 -0.3154883056801292 0.6391548472910914 -0.33639866134648788 -0.63502360169290673 -0.24197425876366754 -1.1155661498392861 -0.047394868523506745 -1.5028363927620969 -0.03676893700270565 -1.2381807676334773;1.1370045721329047 -0.064561626707113517 -0.01957217340308056 0.026109564474993463 -0.067264690213937731 -0.097766638455866584 -0.12562240985507811 -0.13317460890887695 0.037377713190105459 -0.68968170068395296 0.11771041873886152 -0.12990939286678646 0.28779657849567702;-1.0712666362445824 0.054457081350750641 0.47424982944571936 1.4069516745299961 -0.27306209185074931 0.24309164522143242 -0.2567752871421673 -0.11869421167358621 0.09757628091877979 -0.27152312502701714 -0.2887636020936607 0.049100748534232838 0.13603750629410014;-0.2782808339513409 2.7806646612247725 1.4699806489111507 0.35954987910544889 -0.27482011076238871 0.71655314547438298 -0.17539366736397302 0.035573702042777974 1.4309192249981846 -1.4372179389917343 -1.1243349224432622 0.46000906294660016 1.3184345149474705;0.72653936948324627 -0.59812920479260689 -0.75433117749578227 -0.71238358436979732 -0.15797432724569818 0.23849413850342302 -0.46595765826967334 0.5042295893955151 -0.55169000560510417 -0.47792619377379492 0.65767545520272885 0.34214352062894937 1.0638900462575129;1.062410299113 -0.22203801637885903 -0.70191121689003955 -1.8357798685863198 -1.3746446645045509 0.63271503587133893 0.8306927047211381 0.182202862575021 -1.179886632321357 0.69001675470646173 0.71136838737488484 -0.44906576323372538 -0.64450163380952297;-0.12586922730905731 0.044521452082446795 -0.16959964309876002 -1.4526090495314345 -0.0938413714163438 0.82012702517381209 -2.03862969485923 0.66332441894379435 -0.9984129439838787 2.7460072065255767 -1.347387378039582 -0.98378014695255556 -1.2016175021279456;0.91747831724479589 -0.28736628210786785 -1.4825775359270559 -3.2098453103325273 0.46043198339511343 -0.38992603864935205 0.38392732322685375 0.22341236298091599 -0.13282836558509648 1.1779365997204012 -0.045610936336294317 -0.22157643280499403 -0.90225440212719732;-2.8088063531963909 0.080628552144171931 -0.40598366749059139 0.18564121637784778 0.35017153135846357 -0.2279563630222089 -0.34885787422922404 0.1544731313186071 0.13526892547909 0.45261492533631148 -0.4781328639227147 0.093778667312965414 -0.058776268228327627;0.022959576068575044 -0.4400322831720912 0.27469303677916745 0.12139705980530249 -0.55085212703459752 -0.70499548777672616 -0.15703889676039554 -0.77254433841443082 0.45652724904043979 -0.74731792085124316 -0.58623689904868193 -0.94985175234841202 2.0549803232671442;0.15689587207005309 -0.62113929611045293 -0.090379885629395196 0.39606887710474842 -0.40696744109975985 0.57016852298403875 -0.99243790881945704 0.091162074081364342 0.12517406333912526 0.0349633260130046 0.040177152660246698 -0.070977141293009582 1.3298796176650443;0.91107094969222124 -2.1601125055079251 -0.85787800755709143 1.1579294087992467 0.89777100407526322 -0.73424633777882209 -0.14608000702588259 -0.18973971763510095 -0.48708158605856805 -1.9715756089579879 -0.036341197085425415 0.28573119202860747 0.77026508422778528];
  
  % Layer 2
  b2 = [1.7038356006091333;1.8840584411444354;-1.790432475674917;-1.9330742621685906;-0.29809713082481937;-0.95466795655992875;1.3346306755301804;1.3371617626882588;-1.2294642459378262;0.53325766053970769;1.1235357659352556;0.7083931993836845;-0.85393083712751905;1.594282039358907;0.75015904885212992];
  LW2_1 = [0.84457552865760055 1.9104107578794052 1.7353167684676984 -1.2553038218210482 0.18517406492451763 -0.55935221677685221 -1.1214139551424758 -0.29271917189530089 -0.53243252396364527 1.1094859560228516 0.91304913978014657 1.2940968324053053 -0.45168241476508558 0.86236567489110505 -0.39879623650024543;-0.20400876820426933 0.69682000013933532 -0.63566372169134955 -0.94767652008516878 -0.1199312102931451 -0.63182492043370087 -0.60316863517599006 -1.5396741498910564 0.1343432002317631 0.15216095166943422 0.43731998501910757 0.47486057994479564 0.41463147943001571 0.40606308562502108 1.9592183499523728;-0.30460667327579038 -0.28112894035216246 -1.6263902893699977 0.69504393678058118 1.6628663167496816 -0.99876396248169663 -0.18412205367794404 0.65440044583670198 -0.18159973538628471 -0.94029938337371188 -1.3448421003150999 0.21074301245592594 -0.75156437750562977 -0.57811982610065205 -0.31063067538243438;1.0743452159457219 0.34807925679474039 -1.6327860844971795 0.16982440438940555 0.70738586672988768 -0.37244066484074501 0.88829773033201731 -0.1837423427355141 0.3358955957430631 -1.3954385654245267 1.4258655041008492 -1.0958040496845149 -0.698825552619875 -0.088278712249173066 -1.8220903953415863;0.30298480046484927 0.041194051006033489 -0.31609976315344429 -0.20350115170801572 1.0191653425145941 -0.52568173876732516 0.38560000724138682 -0.54295940318530145 -0.073127005605952533 0.13153340326260521 -0.042128439328493313 1.2618448368619115 -0.81815722778826117 -0.35156682324687699 -0.14527090871540041;-0.90033597458024428 0.12991600773883522 0.16837684787708815 -0.16202767472819932 1.2700967073747955 -0.41285692412021929 -0.38698432978023323 1.3094729305253408 -0.4524222150277688 -0.48464075785100547 -0.58239095975283939 0.51813719089238597 -0.15107642320716544 -0.40349320122854226 -1.0648641466227899;0.91227333302845814 1.3302824806721256 0.96321230828896831 -0.86228589706485015 -0.55885951387063759 -0.62007721840669472 -0.73736817691576995 -0.50789675963340908 -0.1499278924101487 0.80947551823127095 0.42696106967055092 0.93940823265631856 -0.035914016549915995 0.4676944226702795 -0.11579967195646527;-0.49692746775715768 -0.19274578436406942 1.48225837743502 0.13381541365091781 -1.2486308738991887 -0.81059390167205692 -0.89913124963018975 -0.22004975141996391 -0.64758656141453663 1.7494444849336723 -2.0141628277991575 1.6516850970928041 1.0125412251991435 1.0961473808885782 2.2636476777086645;-0.026548435050824201 0.9835925368291083 -1.0977425846614104 0.8244963574266061 1.2662699628088767 -2.6921223399282139 0.07465988806964069 0.32078897243927584 -0.32405223322409066 -0.55300498608010928 -2.0722074180470593 0.97963945178528755 -0.67160430946079785 -1.5472662862008184 -0.060469306500430697;0.60982883789038456 0.30651059801288127 0.92861216229868726 0.42211665518015218 1.6935502334375745 -1.2360716492056201 -0.03467942143229355 -0.041662526627366143 -0.012438513657973731 -0.44050870618516019 -0.80900110872519859 0.23848860825412987 -0.77360729748761681 0.92670037155730078 -0.09777442683312218;-0.56517192793178084 0.070733739546262123 -0.47087429970695066 0.044715809294516309 2.0393808047247557 -0.11014334682910223 -0.20859243765196717 1.3244675400193191 -0.40929875843764985 -0.67352996738388027 -0.58497285186533554 0.55583746616913288 -0.48268606447021745 -1.8541678148915581 -0.83880020906845587;0.4953733696494888 0.46209144809088382 0.50719457587619143 0.25805074433232578 1.6024962298602503 -0.80690557254690798 0.44246104390469521 -0.079474131711334231 -0.10356469570253846 -0.18170466546091249 -0.21528485516903145 0.37100823231996155 -0.46440123785203802 0.22557965176094702 0.25008134593824793;-0.44244145197683232 1.166899047150723 -1.0140640233675193 -0.78597363285169231 1.6529343764069007 -1.2414265484823199 -0.086951711246805133 0.11195812375702154 0.63901638533716232 -0.24103070533929946 -0.41033678227424986 1.9362140599339102 -0.82426539690986567 -0.30797319734076972 0.33499076096979075;0.19683824614498335 -0.2883650420946815 0.92389617562380733 1.0335506864495283 -1.8496123156961577 -0.031055814419250642 -0.0043175334930605283 1.0558404428148824 -0.10924425030865642 0.43134991657444921 0.037600905879868501 -1.3559672095721786 0.51399884726111311 0.59434694389547327 1.0863830840892104;0.82550670995109376 0.28174742868918223 0.34421870399112103 0.70045312538447213 1.0335009756507836 -0.68538217919581523 0.78779339346448818 0.1087495080954004 -0.4475603935894516 0.11651274416152226 0.26402199229419754 0.36235698714349612 -0.31102843322763435 0.17237717477960246 0.22526440162978381];
  
  % Layer 3
  b3 = 1.2446023082159001;
  LW3_2 = [1.2685370897444717 0.6804765097209392 -2.39179468477862 2.1722983322533671 -0.81628132952671151 1.7044733439981183 -3.4822593318413908 1.406484254872846 1.9499824749798162 1.6406832331227186 -1.6762928752939117 -2.3967596816853267 0.71789360966684357 -0.55166688370908612 0.76250552768846314];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
