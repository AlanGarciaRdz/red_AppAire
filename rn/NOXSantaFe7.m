function [Y,Xf,Af] = NOXSantaFe7(X,~,~)
%NOXSANTAFE7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:50.
% 
% [Y] = NOXSantaFe7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.63417024233547459;-4.5102101839821804;1.5979691760757;0.59379832312445735;0.75896694905790518;0.89585495359435929;-0.74201215847385893;-0.32307579925738139;-1.312284099865235;8.2327121045648024;-1.2233238250165555;3.6253133795562342];
IW1_1 = [-0.074930530305591811 -4.2813119029377527 -1.6629797575783782 -0.35420600262170354 -0.38576573816408932 -0.97079938051725834 0.63234070658970598 0.10246368531920333 -0.6105374247732529 0.67756667605810883 1.7067430613102412 -1.3878520117296802;-0.40712651266988581 -6.7946025901556686 -0.32923940929878431 -0.19341199789100838 -0.17491405370937488 -0.12850290261955083 0.045330019154520368 0.21215436881034058 -0.0026344717444198558 0.55822624609439331 0.11910470958140597 0.3471246638655659;-1.5435158534112567 -0.34955204664315864 1.7595621160106907 -0.80091912594315839 -0.26720767612986018 0.05810685624425517 -0.059409206023811931 0.42837126417770122 -0.012923344867764313 -0.22051091788954796 -0.51960046730286069 0.39939281026113993;-0.83183988021468358 -0.84305137212156067 0.98794416791400075 0.033673919022227244 -2.3598365193775228 -0.39240870438062903 -0.3458038648331479 -0.9296236729309526 0.46975261089247738 -1.8264309553969649 3.2430052240470952 -1.8940053942101891;1.7065646107603414 1.0466552742107358 -0.87660666030722534 0.257204680969221 -0.24999352816631912 -0.15210550083815932 0.17807983831291299 -0.42844684381210779 -0.036123832683346881 -0.27818101428088576 0.5142942154702983 -0.49803370209525433;0.46130002403515452 -0.1955637109169503 0.7219253091543677 -0.88825039868467304 0.46095106876708919 -0.19420261166515612 0.16934990236071901 1.1111918171747854 0.33106209354523936 -0.5861519905964645 0.15735400047865936 -0.19783930887093004;2.0712578401439949 -0.2607126461841337 -0.71999499233833619 1.3327018854806414 1.8298714965902809 -0.42185155394320412 -1.8109805425860861 0.5340752794084308 -1.7352048343794331 1.4431022480611262 1.0519305439583451 1.3713087888525635;0.44933935004222703 -1.0223136890510096 -0.87627012273696159 0.34425039392654333 -0.36569266392140204 0.042039936941470395 -0.035315432889595197 0.46847458688885535 0.051409376024762157 0.40052881600447227 0.050104136686596912 -0.075320639426897443;2.1212708196103178 -2.2275512503718309 0.52466211698405962 1.353912798520984 0.071076845819289705 -0.6881873465243965 0.26325734177748478 -1.1487386071134755 -0.33749750159639208 -0.45731187399777251 1.4342784392852896 -1.0901603841711409;0.9946749951605901 0.11248169808641977 0.058887667842778005 0.058586876469307596 0.099326672875791569 -0.07338656980096521 0.1220317359778742 -0.23698302377639535 0.065444516597214356 7.0216130738111273 0.3380126230720028 -0.36656339177918595;0.1014253424042576 0.128657845275364 -0.16862919242570173 -1.7846343991256142 -0.62292586138483486 -0.48520623971571197 0.464607864757906 1.8222129157375599 0.82944100358187034 0.58771461693406901 -0.5098577621225413 0.69276862133650852;1.8361099960303728 0.66259089452823117 0.99358013442453619 0.8227007879120859 -0.82212005009415667 -0.30795727250871363 0.28976758511390144 -1.0033997586749406 -0.11139273871932485 0.53163200901605934 1.1690622856295318 -0.32259789309042936];

% Layer 2
b2 = [-0.66164360853478166;-1.2190487011702782;-1.5364822261963786;2.280888721763235;1.348572942415089;-1.7798370675897153;0.27289817244136055;-0.54413943684009602;0.60666571570816374;-1.5902370120687137;-0.89555926008981346;1.7667399912829065];
LW2_1 = [0.34336425550696842 0.98694367840159558 -1.2672275267959159 0.26619032064119996 1.5785200943964499 0.54806302918217742 -0.74454232744927107 -1.1868111269730546 0.16235133721771616 -3.8095355798623034 -0.33765282557773774 0.030859265507466236;0.32849627275684112 0.94937124969162756 0.46676598017709997 -1.1309363419346883 -1.8629802476908373 -0.35970324221242023 0.15559527100331594 -2.593546193588343 0.52607473365614288 0.38311852529240398 -0.66961373223799558 -0.56512408102080003;1.0032086818746822 0.00417206209129655 -0.43767244837019664 -0.55182321491977415 0.29592740631686493 -0.16716705586550126 -0.35657537538963535 -0.81371247029989258 -0.71510000382155203 -0.4724582743219144 0.20069927393681375 0.56330614429645298;-0.78183404366269338 -1.6632331807795355 1.3288276952483835 0.14190866343376582 -1.1191714128157502 1.1306712349258556 0.048721593790948689 3.7921779603070451 1.3813960598984198 0.25910367337277812 -1.0985556667186891 1.2355249951475455;-1.2183632775279738 0.23110197002348354 -0.072704279207406214 -0.038737898823728203 -0.23043193243529045 -0.027957906345574428 0.47476074753369485 0.21003402537292201 0.82901169408031894 0.00022137566457449201 -0.016350694130619788 1.7071128437263143;-0.94152713668251808 1.3666662692614364 -0.4291011317161304 0.28709725777289408 1.6713029323433066 -0.18883945723951509 0.71721168758851706 -0.81919530042441879 -0.46213727279720079 -0.21801455744668369 0.46864944891985716 1.1734763997977971;0.23446204921955441 1.0720541743414502 -1.327044685653519 -1.0089461127816843 -0.26983220542131059 0.15482786403390811 -0.97338566397360649 -1.150336466211451 -0.71401539302072337 -0.68015873639466407 0.11402577019755636 1.5228214114634886;-0.066705171786166237 -0.23204370597244689 0.98899578791297149 -0.28641419163554421 0.92330153869743381 -0.73352091203161407 1.6086016961860592 0.39674336675232735 1.1119233558053789 0.98209803286172304 0.12810250833641387 0.79071674299310257;0.25453002635493432 1.3318091994215007 -1.4935899016015772 -1.19172067680934 -0.26365495872183986 0.17129781323727505 -1.1132170303291917 -1.2208223784974122 -0.6702466870091629 -0.50118288772050634 0.078234327348687252 1.3261631850115196;0.34765027360800449 1.1600739761696375 -0.5626588314371066 0.090752051631694974 -0.1216809261331218 -1.1579065135518787 0.35923881507411931 -1.4799743303609061 0.72451463376407033 1.6841331670508182 0.22073065890816246 -1.6021246317576296;0.52449735123651164 1.398748680197901 -1.2938652113216143 -0.50506911178580272 1.4941531107781554 0.45494940236895326 -0.068512502491901731 -0.61747469549375877 -0.25101792948059654 -0.12042765707974762 -0.36961668546814597 -0.33406914622072847;1.4408685701471722 0.53538252371042139 -0.011810207892927979 -0.96368043056439145 -0.023295062639473653 -0.11783418205776333 -0.39487954165051176 0.30564373420952828 -0.011890929014661315 -0.72769528961953844 -0.35398430687817173 1.0803748347465605];

% Layer 3
b3 = -0.8837792745725791;
LW3_2 = [-3.6571255747558418 -1.0077161610854304 -1.4687035023531454 -2.8431345277430542 -0.90194170108476202 -1.0800127675638924 3.9790116373453106 0.53812800313649256 -2.8207886609404977 1.5649624223906089 0.79891021073506818 -0.54868194278377436];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
