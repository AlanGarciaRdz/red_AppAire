function [Y,Xf,Af] = PM10Tlaquepaque4(X,~,~)
%PM10TLAQUEPAQUE4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:38.
% 
% [Y] = PM10Tlaquepaque4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.00773694390715667;0.00572573718866304;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [-5.0995802123016016;1.0603150130422785;-0.14630434096822717;1.3052866581199749;-1.5266117818093672;-3.3588835492321056;-0.8635010658078085;1.7825562914160815;1.0648908235445615;3.5560796511309092;-0.85900618307175525;2.3620778585873476];
IW1_1 = [2.914624838664885 1.1841278545209626 0.7076280064267817 -1.2722380731079395 -2.5184323642326039 1.3371697773671503 0.64992757351104613 -0.1255576500655638 0.6554634912740096 -0.21085364417577737 -0.90850380604654357;0.76648121138158587 -0.87359989621286693 0.19979105823443033 0.78440496905435331 -0.59864186124261187 -0.49440126716117155 1.2173354856034537 0.030757756273528048 -0.75764389096803753 0.31528235795953974 -0.50320773194140622;0.46952269045772171 1.6385096986752519 -0.32967572801196837 0.69835186321902887 0.98576304290910821 -0.17221763414066252 0.020518108606005971 0.15880255979141658 0.84938804261596779 -0.17597838047749259 -0.3080633991053176;1.0955088908660491 -4.3996834115500381 -0.4612548386516433 -0.39745257145528767 2.298515960723206 -1.4918315430699944 -0.1186227187374916 0.41269887980089587 0.39627465205232659 0.81907533064243232 0.24225830228450868;-0.2339483247015397 -1.1854016763691675 0.8648830743303384 -0.56183270758737813 -2.1127415366381181 -0.044627003909233992 -0.13871658795040839 -0.22760632687600374 -0.37969196945686523 -1.1799203377090637 2.0745192603745353;3.1031130386032122 0.12631689622006945 -0.18050959595873559 0.49710514819788704 -2.1080209462719335 0.40809536432819832 -0.081994428549653331 -0.024334067747537796 -4.2867976783184742 -0.078929803082174399 1.3104341478030312;-0.27488780450041395 -0.86647724999940068 -0.094174254057711279 0.22793327627309737 -0.056079806938702952 0.20027316306458856 -0.090084124040963692 -0.078607411720627948 -0.16799281118462298 -0.36771324034573777 -0.45549811509759758;0.59297880355349253 -2.2300845704408885 0.13761851196577213 -0.30354031578344215 1.3078875476771783 0.21979896849856645 -0.036203543231916317 -0.10093372186373044 -0.32518356342359284 -1.3523559113483956 0.9820811526924389;3.866744899040536 -0.011344543563637691 -0.54078697921994834 0.70361549857165839 -0.559090307018976 0.67380860041294033 -0.087583294368475548 0.0084449953037758988 -0.016041875978033068 -0.27956512973275405 0.3609735627819608;-2.9742074974554127 0.72311841857276371 1.5707846409915582 0.20673467691046532 -0.88756157932085944 3.7476445264434162 0.43184510026105433 -0.57952020737549581 -3.4544144065311695 -0.7136398031430724 -4.4901760839853004;0.20298376160595899 -0.27422040985668689 0.023028241269399365 -0.038502186454727749 0.76772039039835838 -1.6587464484315448 0.12092558100993693 0.028345308504263741 -0.13767386090979833 -0.042983365170802909 0.36794001475042054;0.65168992828747818 -0.70218036699868225 0.070808960275089816 1.2546017959308531 -1.8433081165157748 4.246958751399351 -0.048367097615580786 -0.48910269510071502 2.2517389206933869 0.58867558219063487 -1.2887284882080672];

% Layer 2
b2 = [-3.0613177201921582;-1.1627909896844637;-0.74366465349036526;2.277430391374013;-0.84028396792111315;0.74073058961131699;-0.96258382199855674;-0.075023803475634587;2.1822012149799401;3.2960861737572369;0.79420524293408712;-3.1986580580358428];
LW2_1 = [-0.25657043840563498 -1.109863426289559 1.18319593950971 -1.5826005745196325 -0.3693023310585104 -0.90789485084971033 -0.18075983302862367 1.0967339757359869 0.88493611914936965 -1.5802122988803569 2.1485159732651682 2.010491523680169;-0.4139984738992179 0.092846009915536987 0.64754478515408354 -0.30201537502342168 -0.45799743412444932 0.46119698837736794 -0.98051708760005607 0.97219602626875623 -0.66107472724959737 0.71274824720168162 -0.19413779923654081 -0.24992423080466544;2.1811556279693081 -1.5497668850618258 3.2011781493407856 1.5454999769691891 -1.6151236960611253 1.7213450528584897 0.10714922919124117 2.2482225168614987 0.25260899754197175 -1.2529005588003068 -1.0414794044523792 0.083857291612454893;-1.9130480130516736 0.1114652918261515 2.9104740439463384 -1.6864912219630481 -0.6087086959576461 -2.0654765803596673 2.6871914437599349 -0.0052808650924896991 -0.68526700960278875 4.3704195641403345 0.85226346234301098 -0.93479440710607142;0.13759825815573107 -0.33292176848342736 -0.72887610683610071 -0.53197114208553131 0.41698109394766031 -0.88736910756645571 0.81351915808390085 -0.71091054197197956 1.0525236991391074 1.2935000001793908 0.49671916537292482 -0.018077204762242019;-3.1765084600933258 0.65471123746211124 -1.6700926509397009 -0.34864173012184208 0.36513236138032146 -2.7800951530917986 -1.127325178757592 -0.35896477745856797 5.1485207989528989 0.32161708673727329 2.7983828990544453 -1.268157388556137;-0.62884937336310087 -2.4889984150622086 -1.2918632806035539 -1.1664256314896753 0.053620800420544089 -0.56297360318356127 0.094019434095831411 -1.2385028201189929 0.68376890335713825 2.4887985669161661 -0.042982965190125039 0.57306790601452007;0.074025829849086233 0.57132363201914793 0.54986599151699034 0.83350501438333346 -0.44928758673955921 0.93633622804716699 -0.45542301053138973 0.26293217566271354 -1.0457910498096172 -1.0842219681726375 -2.0324356800716048 -0.42216272354781587;0.65755557289305278 1.1425568963620154 -0.85946302700105381 1.248771113790258 0.14589098539706816 -1.9001462390775128 2.0613763303765862 -0.7954627772628694 0.48466196398711092 -0.076244740672618661 -3.7329529628979179 -2.7307161457489539;2.1670714103061552 -2.0533666709535932 0.47687820083355859 0.57971867180930148 -1.3484002209847783 0.088641080432518976 0.27586259649606681 0.74411489280231546 -2.4193287991179226 0.63546281879374855 0.44917525149491438 -1.6010867486807843;-0.83755608556151706 1.9021201602338864 -0.63143614691827332 0.027230691751771903 0.56035890341821881 -0.50634262242577788 -1.8031750635260457 -1.660433774539998 0.4802058325520876 -1.4115911089494879 -1.5282577406290072 -0.30868183158136997;0.78195599336897703 -0.15613193688620791 -2.8189795002985525 -3.5381763595371925 -0.63650281190547542 -0.00069621201446043966 -3.1914122108582039 0.26360121588774243 0.89432161323756276 -2.4288356399460218 4.0133828177011575 1.5534543741144355];

% Layer 3
b3 = -1.9813684349155767;
LW3_2 = [-0.84170345580296901 -0.61104491763936797 0.25045349604239697 0.44019757654792291 -0.99264183816759377 0.18952910249879432 0.30654972391110313 -0.57129838956694523 0.11406369238032008 0.1287200618968691 0.36123221708333331 0.38291155026601587];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
