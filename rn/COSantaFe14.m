function [Y,Xf,Af] = COSantaFe14(X,~,~)
%COSANTAFE14 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:08.
% 
% [Y] = COSantaFe14(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;0.448430493273543;166.666666666667;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.309009816746864;-2.4173171669888851;-0.67314344452401387;1.6284641615087887;-2.3330853834287222;1.2884375536652728;0.68258358619538995;0.55649764543042957;4.5808594989510727;2.3314605316373056;-1.2350905002756001;0.95995865343295772;-2.1745255959493184;1.3039996735466322;1.623501057223272];
IW1_1 = [0.47985070793534723 1.6776872548474751 -0.12027575683170133 -0.41149383182693272 -0.0085491725859339097 -0.45632530067222693 0.22221476855382746 -0.05294611498631089 -0.31212697065831174 0.033667039643223949 -0.7535026201598668 -0.47411426093326664;0.73327444283845422 -0.58038649026649847 1.3882133016668337 -1.1543795104044008 -0.77082579349296432 -0.63031600500664797 0.41324359881102479 -0.097294571871414909 -0.24231995170222134 0.32057328453780926 -0.79833140149075488 -0.13123840271728524;0.61420468249475957 -1.6167429289583757 0.76190442034168715 -0.14208657640197683 1.0004953615269214 -0.082299716255446229 0.040160433019868193 0.30737167423578887 -0.27586881684424003 0.20226666372962623 -0.44519149764683497 -0.54638851819276424;-0.31628152224771011 -0.49488153167158183 1.0325615510700155 -1.0985731050472927 -0.2797247761697898 0.029021397106161279 0.45265958932200318 0.60253902709621121 0.33852618528811795 -0.29989193646094181 0.099220522597090299 0.21636952501862164;0.38389184384784203 0.1772367648124788 -0.71126090962374644 0.013381576683733833 -0.21701275909110251 -0.40801265348173676 -0.46092280368073318 0.1712770422336363 -0.11250047013685049 -0.32601714234891266 -0.80699228393671985 -0.30949008326201205;0.81883938201259576 -0.43495217799290425 -1.5148221472680474 0.84404752700361696 -0.24106402125143617 0.32769575847435839 -0.21835146266394034 0.19350663120232939 -0.41439526718617575 -0.56696065878781599 1.6310169467326205 -0.17142169670734961;-1.2958453469304039 -1.5910295390365614 0.13854075439109667 0.0030165376970699483 -0.57895836568884629 0.69619478671375368 -0.66172033600333879 -0.11704137993135717 1.0150108618651195 -0.58296918103408468 0.922200742569242 0.65450596420092899;-2.3263896360513212 0.91933941392163054 0.16916743406016266 -0.82401819665212594 -0.39977549087880837 -0.10629949259828168 -0.61899054681758336 0.8305312573634297 -0.66682856661093415 0.038313820017093547 -0.25405558752123686 -0.0099844508360549186;0.12565904099835468 -0.025865904632228244 -2.5419078420285732 1.1055201042451863 -0.48499475839531708 -0.13368881242384248 -0.35404779571271855 0.24013064897562331 -0.44494988615639436 7.2252417237025384 -0.60533214038762884 -0.36620807489607521;1.5667057647448488 -0.56911392915158476 1.0915639045239958 -0.65771766651891983 -0.0043382191618255017 0.14829203125549151 -0.21223028109382938 0.065298280180398419 0.41588392482164221 0.32305743427346867 1.035597407749016 0.059000897716457605;-0.075207754738323279 4.5634278946073854 1.1985542918420988 -0.30468594542066935 0.3671405993512703 -0.083516146635129393 -0.049407825207821748 -0.0021431381781482732 0.034583839008850203 0.2669120865091722 0.1371553665227298 0.12128956180771445;0.27770520976937713 -0.69991640194692373 0.62932784371603989 -0.57388929174098435 -0.74468329875581651 -0.38701538981756528 -0.59155981439822225 -0.53620232488990782 -0.45963184970732307 0.8509990531812851 -0.025112722524458279 -0.056407320075912773;-0.86630572632518255 0.6843829253020548 0.62867226264124731 -1.0547924420067378 -0.20118746896130613 -0.56849106540243366 0.94939898736068085 -0.37915423669621751 -0.098737701437191627 0.94537079306290861 -1.2841419271324015 0.067102666506331413;1.0139655101675566 -1.3221041397463238 0.36721064434048156 -0.033585437103027596 -0.94111322810539022 -0.2879373824921021 -1.0767684612675164 -0.38785571493666116 -0.23896159414142243 0.68848361688096538 0.63729811037250528 0.13171274602970839;2.4631573133480029 0.64140274359055449 -0.21200949281001102 -0.74418091633242756 1.5841642846123143 -0.076105665208942547 -0.31420622557344585 -0.29483698699877614 -0.11986187941167421 -1.3159394771912218 -0.78011886255768403 -0.98220237004586675];

% Layer 2
b2 = [-2.9069992486881624;1.2728663702502281;1.1561060869331363;-0.23601973514355609;0.45843020125850853;-0.10229859622251337;0.48789157990990889;-0.029243122803634072;-0.26442369020766326;-0.657130845801013;-0.33093770100037589;-0.55412481723881268;0.97013925056189043;-0.00092866177467444688;2.0329126908652646];
LW2_1 = [1.176036224338314 -0.42294166681581641 -2.0480820450014874 -0.32165272751179241 0.95018979380134327 -0.2433629056464256 1.6090335343199724 0.87614644549177045 0.12939954351318997 -0.40489793278033426 0.14371193009816496 0.28065203883586648 0.37644346113154165 -0.79064002997859695 -0.38016543728080232;1.1369662316870928 0.3421018827875395 -0.47415949666270757 0.49515424228905092 -0.47174259275232905 -0.63229697540962759 0.41037216133890514 -0.061909520456714801 0.062811066248922257 -1.2943672744747758 -0.8233696173399343 0.76968991332029102 0.02959371711764705 0.40160147262461954 0.24212282653495085;-0.72271128730598633 -0.014251766457970475 -0.52496274600332904 -0.82158068605460044 -1.4830933637266321 1.5911621587241138 -0.29305737956585876 -0.058783958004796577 0.26676747176983301 1.7864292677166302 -0.27921498396943811 0.25449321045375628 -1.1343044558940103 0.53184288147133263 0.090375032752186946;1.0319356912757791 0.037843652049350217 0.35089227217498109 0.67351336684709162 -0.14310867125647675 0.32414067718336914 -0.077401047069493578 0.15698559399210557 -1.4134122738376389 0.9315032659365976 -0.98988823620729172 0.780620525744955 0.59201392120033836 -0.19972072003901825 0.19503909367766736;-0.038457573598250666 0.27495735656357934 0.47379409899822666 0.11346387580688402 0.3779083596887195 -0.16118307507774843 2.0547801556683063 0.10850522017457549 0.54232058486366441 0.10525063999330471 -1.1299037153975038 -0.75285149781405469 1.841103819942586 -0.16325051791193942 -1.588563599199293;1.2525706977063866 -0.35033594997430895 0.53619550876490996 -0.30670988312880043 -1.6375751884327348 -0.64426329480045685 -0.56061121780577317 -0.11087469745887825 -0.5861091306525511 -0.30943970195418324 -0.53622615088037373 0.39736931861814706 -0.41852344483487214 -0.03107699665318709 0.7372734053949539;0.82190864524649754 0.28986951806476097 0.1633939128351376 0.045802877911901692 0.68028924863806373 -0.19295684057366774 1.3665019506977423 -0.23419872857176449 -0.23300579927995985 -0.56089631266861084 0.51625907922327707 1.3893996848032197 0.49028813194430365 -1.1516077028801281 -0.304204424999797;0.55703793701590731 -1.3764899001190471 -0.16180496190841284 -0.57216505193207501 0.56747264014471022 -0.65540189599172005 0.11117134129898959 -1.4098826512866782 1.0051998707201157 1.00824104087726 0.44310822703747949 0.69389362766391693 0.76243160955205613 -0.25756996622373596 -0.00075392233972364914;-0.021505418273786707 -0.14909800823691924 0.85591218354344756 0.47067739514472717 0.18668131994831988 1.2296979097184204 0.39821288330817811 0.093484002484676615 -0.8547076763409408 -0.21694396536099234 -0.15557942243269332 0.68652946173914386 0.48346729353821638 0.11097937345518961 0.59731335524426987;0.53559677914995207 0.78224325091000479 0.11514732271826671 0.52412368669387732 0.11118392056501951 -0.31141507542939906 -0.44043446081182785 1.2435111845581683 -1.5999682952452241 1.9533617740166731 -1.6625730851860074 0.77047373336193625 0.14799720931823263 -1.0501130361637134 0.24076317486471577;-1.684933278364471 0.83939182362723641 0.67743148171062439 0.1132825265141711 0.25192651727716103 0.16484834731599235 0.57706457534503364 -0.70856179405923914 -0.66197851802369045 -0.96194925859941771 1.6712381115321082 0.65966541693584946 -0.11705189666720014 -0.48465833845952855 0.84258357401367034;-0.59664499608686783 2.0467309918147478 -1.588956331846392 0.17660900179091787 0.10849392620827379 -1.3915601177323067 -0.69954062986665855 0.94341136302600015 0.51738124508207395 -0.05257536784368242 0.40784063340331217 0.39122908536122697 -0.72918754971596955 -0.80635274822967495 -0.95291118207631609;2.7314560443878082 0.054585198509616836 0.7229648304597458 0.20497431938406219 -1.0614697882372572 0.75376177843822556 0.59623555189546362 0.081673973407027312 -1.1284625830081827 -0.6269625366272189 0.96416071701045869 -1.4732319726633183 -1.1753441194141514 0.73882438442786436 -0.54937577519651337;-1.888010955675417 0.47583623453437884 -0.41299100831938801 0.31752012103189226 -0.083393768480858652 -2.1597029927222544 -0.78675930964446072 -0.21600387387611097 1.0966615549605099 0.18257557446099179 -1.2549036963068563 -0.27291835267580739 -0.085774520410762847 0.52102501352339492 0.86538415690814807;1.7814223198644239 0.13540848859369981 -0.58566542771709296 0.040386892300501041 -0.30629969968348558 -0.25003898481704101 0.19629003836796999 0.89842099802124253 -0.11762380620047916 -0.13371879108538404 -1.2641240398714988 0.080564044893059475 0.45739312164196888 0.63601811353346149 -1.0354923143709989];

% Layer 3
b3 = -0.57639705938302377;
LW3_2 = [1.5292987414661015 -1.0615813553814326 0.79032533928537663 -0.89190383158989772 0.27994880090410906 0.3883551797372089 -1.7672292478868521 0.67105009666457882 1.5642838047968706 0.44502733341550704 0.88922261835182936 1.1462651807351307 -1.9621350537281592 -1.8113640704110963 1.1922503473892188];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
