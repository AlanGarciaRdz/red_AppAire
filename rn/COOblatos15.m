function [Y,Xf,Af] = COOblatos15(X,~,~)
%COOBLATOS15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:55.
% 
% [Y] = COOblatos15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.908792771888741;1.6413945299713129;-1.1698660636099822;-1.485166851608237;0.28569657357064598;0.68761840795764162;0.71275496388877868;-1.3570785402083256;2.3208224499332681;-0.74782471978403386;1.9670298213815447;0.15878857749837261;1.4376072132988038;-1.9199187713534902;2.4343538739742554];
IW1_1 = [-0.63518032710006156 -0.056672931585923618 -0.11034509706519488 -0.58639253889546605 -0.58226229326243406 -0.33721835930092647 1.0534174863282857 2.0782528962879736 0.54379189720136878 0.50684515288620735;-0.70067001924959682 0.13559902693823056 -0.50303764788102101 -0.76613085803596748 -0.1954698879703605 1.0029461727255931 0.042115067698204625 -0.45867062415614707 -0.024184240041292555 -1.1204850998463072;0.64498360553847034 1.8440483663906837 0.37558319334287099 -0.44450796107972451 -2.0547401316726153 1.7425505570323114 1.6392264225893491 1.5771856113393035 0.20671037715858911 0.19883308514920275;-0.03042982522846029 1.8899473980119106 -1.1930458165672775 0.92283466087794619 0.31974520586788674 1.375387991808422 -0.36594877619111826 -0.18633452197899 -0.32701127899231591 0.10867489913138466;0.89321296444021991 1.3599233652872418 1.3436829565359218 -1.4807755053774978 0.58227536168800531 -0.93548269256505923 0.34368596538941132 -1.4023140429739793 0.015908230343219733 -0.03290854721017808;0.9401003669132707 0.10281242318412838 -0.78535245972576373 0.52430420513025144 0.54799894882836253 -1.0430562180038023 0.82713412656176089 1.3311122856269424 0.47443553372508862 -0.51169165686838947;-0.82743461054420753 0.096816083387966989 0.035420043566214122 0.9102882026898339 -0.31798867602183933 2.1901484275925713 0.10156540209413276 1.7629535835190784 0.042124797108725111 0.27522880282108131;0.80673246241979701 -0.30112575342740278 0.48781918092494497 -1.9508575054585748 -0.92180569388756639 0.024223080392942464 -1.0022534425593916 -0.88953923720019812 -0.76886396415366076 -0.23209264609499428;0.010438718546458191 -4.8217582359984847 0.43514431935300918 0.12553944493440367 -0.22954126543890024 -0.22978634295605221 -0.40267108967975912 -0.40109763412842991 -0.05876575839443459 0.1843309761151446;-2.0677587592248274 0.2629560577245873 -0.065226608458123628 1.0801332658477716 0.71984084085320321 0.067099226478139706 -0.28302274827286494 1.6758979727516761 0.15147034259725378 -0.11299499506775604;0.12496968927661702 -3.7057647818062676 -0.0010252682321914184 -0.23169175267113193 -0.11068344686633315 -0.058412944286987338 0.048583001082260005 0.041695656288065687 0.2097287510580485 -0.1911035925721393;-1.3417722536781926 1.1246570380080376 0.30784184014650051 -1.2228064696965206 -1.0083587729862271 -0.12170782424446051 -0.27699789846214895 -1.2896234854950068 0.064051112431368379 0.94436637842668492;2.6470195259300242 0.25228924472413222 0.15943713859924802 -0.39769469077845604 -0.13250299362834039 0.41231946683881221 -0.32202946768708957 0.70738357008569097 -0.23210656121233947 -0.66068961889404099;0.33463578765666074 1.6441757525292779 0.11124973513931655 -0.45965851276379333 -0.22895714164830736 -1.8142689508700469 0.028388931280684166 0.16320553769546906 0.067136040685793014 0.60150542600752244;0.5673580147482522 -0.07199899595880821 1.1426304218256496 0.96599764770081997 -0.34914460540755093 1.4244873483178326 0.37864494675317129 1.5958061653770408 0.21607173673139937 0.76014636742844566];

% Layer 2
b2 = [-1.5494898781830972;-1.6636685516559624;0.73208448471764787;-1.3390959860906648;1.2321414331748157;-0.65435866683474009;0.68018991422544228;-0.17662806618023455;0.50962104193151991;0.88576661769762588;-1.6427060756328298;1.5877803298126196;1.3694107414716397;-0.82412978535750492;2.2178234164203685];
LW2_1 = [0.077631298067612833 -0.28191619484682529 -0.17551969602347062 -0.29741883125488527 -0.2342732059037331 0.21491915294921157 0.70839654993641399 0.65465169294099734 -0.3978140208113628 0.77865170810184603 -0.23618823927460358 0.33752405624276544 -0.85944902113523991 -0.096250902003771899 -0.28556537938839177;0.24937268499888587 -0.63678619224502508 -0.63151352053862497 0.39862839286877516 -0.80696478236270175 0.048780593914991739 -0.59305967218066757 0.78829430533567735 -0.22337659706656543 0.0692557581253362 -0.63361062850799466 -0.66287475376364635 -0.7651621953067762 -0.1099037678414659 -0.33323503687464523;0.95108360562482497 -0.35488996924531441 0.12088133806585671 0.25117177144900182 -0.95785636308464861 1.061852961469687 -1.8487399482665625 0.58769284235343244 0.84715666888721286 -1.0955631999987052 -1.3987468359403796 -0.36245807945472641 1.9083338628123547 -0.43403380668199709 2.234310336101335;0.16342612771728457 -0.31790887718842992 -0.238988987058456 -0.60769208028887156 0.083501943257799985 -0.16199957229305106 1.3840151775169751 0.53867607911749604 -1.0424615040842407 0.571559684169761 0.42290137647843395 -0.39842510307160439 -0.24727621496025909 1.4664749947191533 -0.48955668932906604;-0.3314623683661308 0.67062857940396037 -0.095556457356615179 0.00038914389591157561 1.4457721984333132 -0.28543483555124505 -0.46593642114497852 -1.1902353559583241 1.349847959629368 -1.3022385391788287 0.78173320188611251 1.1979007696547248 1.4779734541422567 0.6953206439908195 1.6510460927631796;0.50973591448609723 -0.36320723645530928 -0.13334852414168674 0.058249116817283689 -0.58094801200054014 1.1050996328371574 0.17732765852080981 0.71424278076376635 -1.5739993780539867 -0.68363538723649919 0.97980055090931717 1.5666028548345061 0.41497670001317266 -0.35237789419705418 0.69020597328587152;0.059608937618581249 -0.14153859099390961 0.49850091652946832 0.060287837628731404 -0.16057634591199102 1.0226784255442734 0.1199728435389113 0.55217207849696071 -0.21058309911472634 -0.6831519435193687 -0.22412416879137437 2.079716669107567 0.16435033062417401 -0.94194817890142191 1.1508647199219293;0.27430372441947687 0.58404992089138319 0.010012877981643357 -0.50246594996581451 -0.31671756043656935 -0.40083461254409131 -0.30651489387878372 -0.21553993766950674 0.89830128880909865 -0.0079507864629377225 0.4602052684094336 0.070064837687345519 0.17179328123985449 -0.30625407935640098 0.16067338393402056;1.3733921751039138 0.10504921689929592 -0.22518383100764977 0.56261067135475162 0.35154644165791366 0.52157820890567019 -0.028821774607779699 -0.23248502150560732 -1.1190974758813239 -0.60584085230803886 0.099242743637426051 -0.1612691591248003 -0.19645007850393095 0.58060670360265909 0.39511593378175192;-0.13255025851219929 0.49933379147882451 0.24519855793824638 0.13584181904594597 0.55083113574542619 0.050444919865972354 -0.59711290540971096 0.60583097036030376 -0.33660165331167224 0.067716733788150879 -0.69704154760848314 -1.2580248912728824 -0.46149591450909477 -0.92345584817648485 1.1680346030333175;0.46745234147605108 -1.0148556912430777 -0.19732493497022724 0.4936330490914565 -0.4307222461064843 0.044798093127940239 0.067913956939069542 0.84900266977484795 -1.1071331397358717 -0.92048359679846659 1.026392011814353 0.10741411309608996 -0.56118959867778695 0.51984302176843844 -0.1570208088806137;0.57641087667313506 1.6802392080299167 1.8105688088991145 0.47802626887299854 0.1494344166032002 1.0384565366064513 -0.87865376225724223 -0.099743456825880705 1.2106170025184109 -1.8731685377579257 -0.59734421532212489 0.22419083221472047 0.63912880530751848 -0.38572119036622743 -0.16083088674328264;0.212147168404972 -0.87359612211686921 0.22251860788629654 -0.020299893494377656 -0.16836696801046397 -0.01488089723908831 0.24058799465978051 0.43417044332934762 0.30706411308652543 0.24946041401743355 0.21553492796506157 -0.30757330061554672 -0.50407691199307048 0.54738383037175764 -0.2166982587015634;-0.033490429909052287 0.39447000810211291 -0.30911820075110119 0.0616846265230101 0.36152487112596343 -0.25477719860314962 -0.57293094569333669 -0.43692463036360518 -0.74172431147367801 -0.17477874798899143 0.46324929780974639 0.2377538747320159 0.74611199359704761 -0.71517198325733999 0.44389097759435631;0.38341639850282672 -0.1632813785303065 0.057413188368916526 0.024837649372816822 0.34877830732122433 0.11929189429434189 -0.095423610109644327 0.50458598241874186 -0.2588768453097875 0.62314173094029013 -0.41805224563893406 -0.64662602545851644 -0.86738774101374416 1.0222697465727926 0.14407981373931192];

% Layer 3
b3 = 0.56677132502378802;
LW3_2 = [-1.7937256673585904 -1.2830917992633575 -0.44092999172612773 0.7999989150831226 -0.76927285291080616 1.0349305870652583 -1.1517476794119834 0.88654399293998731 -0.50554468907541616 0.27793983418017154 1.1946473744162811 -0.99399637437730604 -1.7798633495118283 -0.86446757782769712 0.49501870969759004];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
