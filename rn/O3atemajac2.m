function [Y,Xf,Af] = O3atemajac2(X,~,~)
%O3ATEMAJAC2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:35.
% 
% [Y] = O3atemajac2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.201288244766506;4.04040404040404;166.666666666667;0.0561797752808989;0.00614628149969269;9.52380952380952];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-1.8804074524639072;-1.9338455250550985;2.345548711593028;0.76744505751271797;-0.99566713932949213;0.4421788470333366;1.2956326844249324;-0.13192598130195679;0.34207123923453581;0.68268913539632403;0.91538662476803268;0.021356005375508164;1.8897785746723126];
  IW1_1 = [2.7928419843555745 0.021900884743129775 -0.31491988333862464 -0.59088585704852392 0.035563756192730479 0.49280158831177029 0.091227398038586857 -2.0130717361406014;1.6935889963001665 0.18882650166402751 -0.27080168196735471 -0.43583216044544093 -0.2898711006935486 0.38274255223640025 0.2303202941066283 1.4740676235516557;-1.338532390672337 0.11610100155354015 0.20278837276149692 0.092137177190146982 0.016286436370246397 -0.30024715413582914 -0.11514765433832026 0.81852076738871049;-0.66067923888042912 -0.77806676054543356 -0.25494797268847241 -0.030480142321321117 0.20316913978261619 0.13056286094568725 -0.198528173917321 -0.60533365892612734;1.5542704291175813 -3.1453792504706275 -0.27266636959454527 -0.02051170930081463 -0.010587736028900414 -0.43576992647294854 -0.012510960629597723 1.2550074063746475;-0.54164452239932359 0.98134349436784285 -0.9424318523025399 -0.76374550508152816 0.036701151603279455 -1.2156969034471008 -0.32867842578659356 -1.0198974954923528;0.83874490722914863 0.16740175935558305 -0.53069105877631451 -0.16014172010056996 0.17408944228651443 0.24880390829262414 -0.00071925753566495082 1.7465338611592169;0.31462888639165665 -2.6167876447736349 0.734174468133306 0.77237002742110006 0.073988485895811473 0.08967673265785793 -0.12062852533058431 -0.7339711248456221;1.6400785045622182 0.27089324528795872 0.44723836265796679 -0.014880236328924755 -0.026221028104786413 -0.23466629444857542 0.089454142446837012 -1.4081151322639383;1.7249177270509364 -0.059822713687460137 1.7753298355350049 0.33967201954219195 0.18631781154664875 -0.28426068043881642 -0.044874609556753438 -1.0735493269944565;1.3659072427453431 -0.68724980006334513 -0.82851674484049476 1.4309117977304837 0.25835510780705978 0.41195046594202617 -0.10260121819219252 -0.46303633446189846;3.4591786464241085 0.18203395975641873 0.44557153278340078 -1.3337945250897338 0.038426556669062119 0.33379371018372367 0.12902992655738996 -0.13975709965852151;1.5981585880037066 0.1919635879912375 -0.061990136404602221 -0.057260517515404161 0.015693943877712741 0.042048717826105961 0.065425501060877453 0.90017257900036418];
  
  % Layer 2
  b2 = [-2.6334145925555505;0.9313228615209953;-1.2371801083335228;-1.9790551426903953;-2.3135562057123731;-0.68988980321331017;-0.2993736099869726;-0.84058463947086703;0.082269018259182175;0.5758400167359411;1.1361675494984573;-1.2318438411835304;-2.0373433161615586];
  LW2_1 = [1.8471953051771854 -1.1978568925746338 -0.17182921237090867 -0.48122013032274735 0.9881306366277125 0.020230335615648853 0.5864826786803109 -1.2250852941245409 -0.24554313998185889 -0.4586364896255587 0.47243263871369745 -1.0847961488555049 0.50269679562216296;-1.3934885057748605 1.0065877710491389 -1.4271831031265145 0.0027723594081925304 0.12935283015620455 1.3393938522329063 -0.41526213107705334 -0.16696690059811151 1.0780529660725171 0.033670402296097628 -0.21050460221063075 0.87066182435328277 -0.075220551423206453;1.0328188413013009 -0.34432468777673586 0.3031605574492896 -0.96275760689271661 0.159948893762209 0.43748750343007115 -0.53936175209825488 -0.36674124175374684 0.4236688344452621 0.44123257197233184 0.56338178428987118 -0.33638875173257643 -0.56712835631645198;0.68835522627998691 0.2085593574926472 -0.22611972055179766 -0.28974953350735771 0.58974936913111298 0.10232049010745957 0.56386487374741601 1.3031369430781683 -0.22819286962520605 -1.2375415066486868 -0.99320094592748531 0.12371912106594381 -0.57063594797571826;-0.021643173085446398 -1.5954585885388075 -0.15047038743004168 -0.84647253785940679 0.84914652233476473 -0.0073629720743673575 0.093959545117501375 -1.2728308734740275 0.45678996586516807 -0.60987125518474306 0.49362475778311066 0.58344490039871144 -0.98915695520937363;-0.2839358012870134 -1.4418096186255176 -0.29996239612231318 -1.3418964571118845 0.80520390469227965 -0.34701446483366688 -0.78883193809672236 0.34382258445204039 -0.89392322152348536 -0.20585382218922185 -0.5921739178268256 0.96823415738523355 0.041775101125938845;0.24438478645653372 -1.7999015917806902 0.36102588628979582 0.065112791823460164 0.22388232008943543 -1.1500218628046326 -0.59253039108588079 -0.47932389900783429 -0.76373544548114991 -0.81311006293064625 0.19244553779968726 -0.31870869509943128 0.46384066225199244;-0.64430366916725312 -1.4886634926522515 -1.0058018496212175 0.65503660437382183 -0.60817850849634403 -0.60774837308650786 -0.32505785995917724 0.27993726518421291 -0.004098357382098225 0.3424126364488107 -1.4970233725503521 -0.11365895024356347 0.50602170715481853;-0.8095882499879079 1.5413771215777279 0.90114979806386497 -0.097698329807133166 -0.19889741553500792 0.83234061215897504 -0.37624261181162527 0.65733181702299925 -0.71735401544322819 -0.023352670952766774 -0.81401344681626708 -1.0324493484455464 -0.18820721229041773;-0.70365051477846141 0.11525367788650959 -0.40681013951493766 0.26136972376141887 0.044595867285033342 -0.40732708623039793 0.27509341280678223 -0.16648768746141168 1.3341261731288536 -0.67942188537398851 -0.1216324158478464 0.41680938330504919 -0.9397180569289787;1.5000884680475663 -0.80798648695429154 -0.61035306842606907 1.1269266519303411 0.35440435276565185 0.27689016195561078 0.4155565723962158 -0.21224186436202941 -0.65614344932878144 -0.24652540903358489 -0.69807844982251688 -1.5945692756472156 -1.3677024890346055;-0.028253089056450513 -0.24709360946600753 0.46606804127027229 -0.35667185049007188 0.43692677978267846 0.91030610102267739 -0.48097539033967418 -0.11589559946787788 -0.76448440752871705 0.096480390440408528 1.0121598381515375 0.38715777069233798 1.0041286555551507;-0.29380070264936192 0.49473016506663692 0.40456871090257235 0.1076748558590261 -0.13053568718279865 -0.74923542721544034 -0.11618868994735325 -0.81441259408203859 -0.34693085964641968 -0.28424518571452217 0.50547659166314851 -0.73369184205332938 -0.52524158490710338];
  
  % Layer 3
  b3 = -1.1958188917937442;
  LW3_2 = [1.1764580041122386 1.1182642427302825 -1.4371020172045537 1.4274933466069246 -1.6666838177221084 -0.8592924268597304 1.1824352920501346 -0.74828129650565345 -0.16992209787729262 -1.9987984614781125 -0.79831856851614746 -1.0415467405433687 0.51332675257429239];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 9.52380952380952;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
