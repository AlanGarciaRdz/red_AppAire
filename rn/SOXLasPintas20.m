function [Y,Xf,Af] = SOXLasPintas20(X,~,~)
%SOXLASPINTAS20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:47.
% 
% [Y] = SOXLasPintas20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.0179856115107914;95.2380952380952;0.0558659217877095;0.00576368876080692;0.212765957446809;166.666666666667;45.4545454545455;29.8507462686567;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.7479995949589013;-1.4020251933719619;1.2541622281509077;1.7910161581007915;0.17015900185869193;-0.25127400385826426;0.21836554282086787;-1.4807825789954367;0.19695324100115269;2.0442239078965261;2.2025100849273063];
IW1_1 = [0.092832758014860794 2.6048979757221939 0.0011585993641258924 -1.8883194807341641 -0.47530938451413374 -0.72148556748327075 1.5516075827360871 -0.43790235658330956 -0.24895729507066175 0.76888130256296361 -0.15926914042911336 -0.87044317372024149 0.95891680053776651;0.038163849749995024 -0.0071121724610038808 -0.44493106443004626 -1.1762382807380631 -0.35675588046917894 0.22203015466052173 0.36969466242289217 0.075415253553998723 0.44457402841990257 0.45908878132638209 0.41475880316295333 0.24701333703531264 0.65385138675074683;-0.071367218025924717 0.68881659148908936 -0.43824246590585758 -0.11392905307305026 0.265309801391163 -0.66327888922948575 -0.24690164769247364 0.62920913132637135 -0.61957656312129172 -0.064493487512308975 0.19183652626025841 -0.56484154811397247 -0.69671860180072076;-2.3458098090162993 -0.14456533112524272 0.41416222805584757 0.055304820946261754 0.57218535345310151 1.9489080688742915 1.1134455140471391 -0.126842676112986 0.30309908890536286 -1.4671470547800041 0.29349446527716228 -0.85335832896473551 0.37323438610301518;2.3650900814030944 -0.3745763386575518 -1.1331751541824138 0.33629891582175414 -1.2286863531267196 2.2164571710274386 -2.4676663725616712 0.016903701200397414 -0.4038520311633918 -0.1491066308832687 -0.38582223774696556 0.87855352222093885 0.0047527065262125134;3.3505888684922929 0.27146353641518917 -1.3583438095289406 -0.53692418530848274 -2.2029663300212534 2.1283091833370666 -2.5264882466789986 -0.088702705138330021 0.22922337950846197 1.0238939099622641 -0.30037458048826438 -0.049150114119252644 -0.64741607269172441;-1.3593175815474132 0.45466472346220499 1.0009771389643185 0.63613716319687541 0.94208282496396545 -4.6369397498950509 -1.2515258249122476 0.15980515944322587 -0.48329088608008214 -0.75588014429577688 0.34765666953405927 0.33752996124292434 1.1273438369279249;-1.6101446449592969 0.28121779132849556 -0.085943985310697288 -0.63700538537777085 -1.6832706268244146 1.2775479687730589 -2.2053969843030372 0.16890003956633193 -0.10895356104600851 0.099315435297773924 -4.4589986662590366 -1.2156244041922184 3.4637798191731344;3.118314334072906 -0.43164778243337448 0.46412655244226331 0.014621465925278326 -0.033034077691943477 -1.2819056176141665 0.9463991146378945 0.22217815152022283 -0.39863472059703581 0.1699890726430397 -0.86726260690961787 0.29737868877141971 -0.036859368683569441;4.1990546152901675 0.02123978055577826 1.1906976172562553 -0.0053622241982907992 -0.89823802219647964 -3.6709572857857076 -0.67994589285154317 -0.25507073933853985 -0.13201527900768067 1.8368574447634225 -0.68232442703572804 -1.0772511888938174 1.6613239795149548;1.7458944196518884 0.042356812505334136 0.016656660991328537 -0.12830574429634606 0.72731042288434355 0.25852921365277004 0.68635613940794915 0.24840873901600199 0.086255100085106493 -0.48754953847514826 0.67257282991189482 -0.691359623054834 0.90424624936438081];

% Layer 2
b2 = [2.7027033303775494;-2.0115635313006468;-0.96194495608071007;0.3762937918181426;-0.52984955541022671;0.03683663263287431;1.2564622464212851;-1.4677399982085932;-1.3709592319339223;1.9556957757593718;-1.789249000936499];
LW2_1 = [-1.5369111105606068 -1.5077806589647484 0.6350855528497602 1.4070133527320621 1.5029471279887914 -1.5641859141358889 2.8728365082896716 3.6950697509407795 1.3370339146940355 -0.42412117050211312 -0.4908835778877379;1.5709918718441644 1.5412030214134043 0.062562921034039182 -1.3689733636966976 -1.5293093139695959 1.6647415457969426 -2.8719170744834677 -3.716402652648175 2.2958793268376945 -2.5464242296369841 -1.6352912161710393;1.1367922552652279 -0.082436630687393889 0.17797659022542872 0.79796491878222042 -0.54181720547457302 1.1087311708867731 0.42735993832663283 0.55734269268012926 0.092644536688625378 0.38700107677026263 0.71263956716974675;-0.34671285268136282 0.12266402687340291 0.28096123217391472 -0.023635016168016484 0.41029458407091524 -0.11604714259471099 -0.57134951964525804 -0.8512619780435019 0.53563519552060457 0.70832787392801411 1.2033389936592305;0.6355417372761365 0.50351428361323058 -0.79852952829565427 -1.2666686917638694 -0.18398915067433119 -0.56931823939202242 0.065181307204296102 -0.14443138997187846 0.091699391898212274 -0.15169157909980602 0.69500599854704392;0.75975632977580432 1.2048543227817659 0.38448813145778749 1.8549880635083023 0.025664662955169254 1.4750249306840229 0.61827653748587863 0.12360804214498658 -0.52941209028868352 0.42372302146805019 0.057168748753040517;1.4951661788453752 -1.3981819604060743 0.9968434454062276 1.0221730488572403 1.7361554453780308 -0.98369250434685496 -2.929479146879185 0.29263988444467043 -0.91600858483231684 1.0393844301945194 0.37058409008662002;-0.72302355803324891 0.56645476818444296 -0.016691455659720023 0.21446291392764966 -0.88185836615584989 -0.79604263744920767 -0.37968393116704857 0.062953429918481768 0.77487401676594414 -0.053967051437509989 0.5406775291246575;-0.79079429888411068 0.60616128982607598 0.39060105162742648 0.33005483394226554 0.17538854239037782 -0.18162659051547697 -0.11152525673759472 -0.69553173748605313 -1.1173413690140053 -0.43414335181566915 -0.84654097348842461;1.9300296194365709 -0.59534344587467669 0.10928542052835627 0.95637428918257017 1.0575845140641253 -1.5642474500404682 -0.4799276055643269 -0.48410036073326146 1.1883839856490095 2.1542473265722304 1.9245336392436789;0.13750380996980585 -0.72621289999156613 -0.47710495114043328 0.76221548692511565 0.73742084431402399 0.0092000855450724561 -0.43961665471236461 0.65078496471967351 0.50695823022982311 0.36115013496522536 0.66549693649101194];

% Layer 3
b3 = 0.63924972463288665;
LW3_2 = [3.7288523253863755 3.7066033416268316 0.34855649359983404 0.09977135942186291 -0.3126148734590023 -0.20929945587620111 -0.40236651451318378 -0.17733570457222977 0.23319293743783415 -1.6361340170406189 -0.10855456205911691];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
