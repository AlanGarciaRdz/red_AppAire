function [Y,Xf,Af] = PM10Oblatos8(X,~,~)
%PM10OBLATOS8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:22.
% 
% [Y] = PM10Oblatos8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.444418616528909;-1.946405062184543;0.40329094542838728;-1.3826374328204498;1.3378360684469908;-3.5127693023965674;-2.6707216748347373;1.1917707367973054;-1.7431438150782901;-3.1713426336484147;2.1617203280969672;0.59716861673344646;-1.768620273624568;1.5836512819828534;-1.378106904546307];
IW1_1 = [0.51039223943032397 0.21048242547751625 1.1923977061681545 -4.604173059503041 3.0990445028206985 0.10261290037483881 2.7849457589675466 -4.0404504240401193;0.99853724442154024 -0.13519496535127407 -0.90822413197786922 0.27022521451666831 -0.63189248739443571 0.19644351309677288 -0.087753042657748137 -0.62928363771046003;0.76550711098520596 -0.76907136314090885 -1.1600220135517341 0.75735032137178449 2.4926634196228576 1.0356257254052701 0.92929038498028538 -2.2593367004065605;-0.27058995529647634 -0.11241012936281344 1.0669527171180972 -0.65570580067428841 -1.8232775439825613 -0.066179331440094621 -0.67059127420639619 -0.48518506604361689;0.41476636744765383 -1.487421937831171 0.9846316807695642 0.9824902402556015 -0.06291886139142007 1.4967446610130788 0.71327449461168646 -0.53135106697966006;3.1735684463178622 -0.059781755659741663 -1.700549642927871 0.086774396801834158 0.38662186856352487 0.28652475601630512 0.25876238393793749 -1.0801997500636529;0.68445518875185452 1.5299200956801617 -4.4466441373439105 3.1363768411652444 -0.47390295904248608 -0.35334007445360593 -0.86607348393294137 -0.57959989278867752;0.14082519283010544 -1.1983148419784209 0.90188476965676467 0.2248015494868324 0.63518548916661799 -1.4259814089998739 0.56958940153307014 -0.32745964894750679;-0.13038441637096845 -0.20585181650255652 -2.0036942588799431 1.0189774406466869 0.34713125965221636 -0.76952901770606896 0.19398823853365385 -0.38311062516712041;0.45683676432965148 -0.98805095900748152 -0.52698040524563694 -1.5410369623438973 -0.94081026542035728 0.93018465590219024 0.1112902964414049 -1.5678002040768972;-3.1681590843495266 -0.2475487269269106 -0.070068775737157626 0.14853467472812745 -1.8105132609420096 -0.68187305876291104 -0.20222015888699793 0.18363047453067885;3.0346548111295326 0.21805662910830861 -3.8727302425742605 -0.54690336698479514 3.1814667678671618 -0.2466158054525574 0.068034272648116567 -0.11460880248372453;0.71058784015823684 0.38858246983560923 0.30857673718901174 0.021050401077410338 -3.038331217527082 -0.89954623860873195 -0.51768545921667153 0.64192248150878095;-0.22778726577688696 -0.64508515355881157 0.96344243955002284 -0.6035402160001524 1.0641877524406966 -0.27664543259854313 0.64055094543041968 0.085889610007358411;0.87247119185338395 1.257779442776729 -0.88976086128290077 0.83482213514169212 0.55983498555056865 1.6059289230481404 0.67674346504616889 -1.4589958816392485];

% Layer 2
b2 = [1.694992205643131;-2.9068353068204926;1.2055387436793965;8.8466232499337938;20.228220554257341;-6.4721856685659516;2.6304161374558492;-13.007629409773502;-1.334055087755976;7.7475565027626834;-0.30402312959998284;-5.5605345584493513;5.939756767650664;-2.4178096351076088;7.1721751538169656];
LW2_1 = [-0.14094677729713784 -6.9494311511362943 0.5699296861864952 -1.1449017258402276 3.1190665457709161 2.9484804368634312 -1.2318406078311597 3.9599363849823908 6.1597386466222508 -0.63252310430131875 4.1772548906762372 -1.3671005757963981 -0.88512044134226986 -11.568299045294035 0.93702371145060737;-1.585342137685199 -3.7681051380973987 -1.6048069199390029 4.0369810717341208 -0.49490982823402219 5.2275144996066114 1.9441248660018322 -0.82903066982207385 2.6935016262968308 0.24492989424047862 3.5935876200505814 3.0051467177874946 -3.1851591366781404 8.3686341670751574 3.0412479356106843;-1.2418391366659824 -5.4959939206840467 4.9973467107613638 4.553709173201316 1.5493929214979558 1.2506058329170266 -4.1333085084918064 -2.6098190312160003 6.8831182551864627 -4.6270898899768813 0.16744500019848629 0.81559768672471422 5.585022875629214 -6.201123807658548 -2.2487803736813001;-4.8462651462620938 24.115208425363019 10.161173670338364 14.586892974918198 -6.7241233142663495 -10.174117783012605 2.4738963722846052 18.853890343872703 -3.2766898555872341 2.0455289078176904 -13.202569339934282 6.4915956541720528 -7.7146809701766266 13.314662986265681 26.06977611703115;-0.026827737347561029 4.4439313939148244 7.6182690441452081 -6.2599993450302476 -5.5183990747883183 2.2716352300999123 -11.231521029041204 -15.529835131182962 20.797420271210491 -2.6285840882431968 -4.892885070504561 -4.783617107820314 2.8803964258957473 -10.192536861200159 -4.741255248714725;0.033485834607975336 -9.8082719698886436 0.3733494565461789 2.2720908022386599 4.3146872753962526 1.694127902560931 6.215661329028551 -0.027940864337078611 -1.8027728409894348 0.69388241251156846 3.1810711233943416 -0.43715444789131674 4.5638216975338572 4.7766132098821092 0.69041454542253866;-0.68820393847618488 -10.490218261538757 -4.6044774931528458 -0.72942386165866602 3.9455500114677728 6.3866903162047928 -0.85419776296229155 -3.2144325708744077 7.7710641656639448 3.9345888437072709 -2.2651965850607514 4.1262900992575569 -1.5059943560837863 -2.2539530303890429 -0.27563011223074529;2.8066167842810943 -3.6078461575540572 -19.293256513241175 8.4442714298913906 5.1350489091504476 1.364589665120042 -6.5723448048892568 3.3259150417721375 4.5343123628415984 1.036778643363899 4.7430123686294277 15.845294261379548 -18.573752818435242 -4.4421073759747616 0.71532025036604507;1.9565365557460797 1.1004623448174553 1.5508045509176671 -4.8574016914763787 1.9561713370698171 -5.0585329195571909 0.46852837676181741 2.4124492317200956 -6.5324264626818085 2.2718326582539694 -4.3322459085754232 -0.57569507164623723 5.4994859101663627 -4.83388343949842 -2.1463268474479249;0.14715786921027491 3.7485198173123386 4.1735445857996467 -3.931517109593182 -1.1745845327254236 -4.8310654617665145 0.75198155865687266 1.254282466404254 -1.4519581525841567 2.6000636062190687 -7.0750871201985994 -6.6037812160830196 8.9269099548048558 -2.6635677132996785 -2.3710189673988809;-1.7544438616695626 -5.6161504608872788 -0.67079764336416547 -2.1399356196727162 -0.46647345865996087 -0.074812513588308802 5.3249312229617392 -3.4124893189044245 8.6633314611284487 4.4080124904884093 7.8080140445640147 0.065526121461287487 -1.6628172145861162 5.3844161281505913 1.6886718118138233;2.2534465647530402 -22.767894340393184 -3.9307142603850291 4.6398403128240018 -0.5632164284183665 19.554867068940936 3.4832882052370184 -6.4649578182615839 6.9020605828243893 1.0410619968484816 13.746494729041828 1.6953692429826941 8.0730224595769062 21.247198580186751 9.7522217651302903;-1.118132537832643 16.944880869917181 2.3354131289226907 -5.4317674212959179 3.4783884406857228 -4.2389592542208394 -7.594369299182941 -11.140851608695723 2.4091822082876679 -5.7102857033811585 -1.4125038686239557 -8.0408644161845579 -0.6696082014239727 -10.505014321942792 -3.6631092395472904;-1.7977469141544451 -4.4782840045207575 -0.72018674477813394 2.3748510651573103 -1.0275274967559203 5.4325368367817939 -1.0182598034652592 7.1157552157310704 1.6909966833228232 -0.78127850829486478 4.1475695382798037 1.453534541840634 -6.6230760447697676 -4.7696692484905094 2.6889876468881124;21.818029833502415 -3.8564376505618849 27.959368816128766 -10.399914582907783 2.2522383357707012 -21.999356663162001 4.857385020547329 -13.416245795395973 3.949585977424471 15.371242816435537 31.876531260419906 -10.130471239249028 1.3563166637992083 -9.3170732838825554 -4.8580081677110183];

% Layer 3
b3 = -0.73714668091635593;
LW3_2 = [0.10384393205627911 0.077644864007612086 0.033235634389776669 -0.011324466975531761 -0.047690948385022601 -0.081215726459878193 0.07252259789089327 -0.029056149866718752 0.12364441570431557 -0.0497941867666815 0.036374546568359117 0.040695531343581823 0.012062559189125516 -0.047906102145219738 -0.03560914829575991];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
