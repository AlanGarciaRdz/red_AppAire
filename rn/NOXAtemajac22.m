function [Y,Xf,Af] = NOXAtemajac22(X,~,~)
%NOXATEMAJAC22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:17.
% 
% [Y] = NOXAtemajac22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.04040404040404;16.1290322580645;0.0210748155953635;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.7164053854779682;-0.77429421935225473;-1.8664490092361987;2.0850217017021873;2.546922489067784;1.5340677484733714;0.75134747004629332;2.3567539588285458;-1.5022983892052448;0.99548787684463735;1.2365054953559149;-1.0573911853568965;1.1956322210940549;0.98391340867630683;-1.3913634092867586];
IW1_1 = [-3.5970225564976204 -0.054906537278531724 -1.1267283130502834 0.12556210150681321 -0.42562946604133606 0.4256525452850119 0.47125499591464892 0.080963595659124921;-0.03192692993583119 2.4007595441138001 -2.3204055106293726 0.75919205832239978 -0.024091574116872717 -0.35984892293927317 0.28040490138093471 0.25154509340586373;-0.34565485981240573 -0.054360697348252621 -0.90996510882393633 0.61576845717705631 -1.0487272196766559 -0.21286488999827324 -0.41741100075035176 -0.74996248644523433;-1.2249269395050701 -0.51481056087317112 0.36851399918716016 -0.99000962096621303 0.93236525693998096 -0.91863935433417343 0.10000122214804984 0.096015628574758191;-2.1582472186245889 -0.040975507036660856 -0.097351851036077658 -0.69621042333971273 1.5384233908313394 0.90125326714605403 0.23608017974640139 0.21956671310666925;-0.87587116237374529 0.26452965329908029 0.98988188202916971 -0.36146001730206023 -0.067271238096226746 -0.036858715772067702 -0.13031848113320324 -0.4276857168460127;-0.77224336038089403 0.11521726867839482 2.0204007671138871 0.1903028805852644 -0.9355180497735418 -0.55010531547549169 -0.2073086956164219 -0.22135524049835548;-1.563095777130586 1.9493667176693925 -1.0637805409704491 -0.095980883026890645 1.5390050770141339 -0.26892443083926798 0.079412498698576611 -0.3163229841407556;1.8725141982460765 -2.9678460892288911 1.6940585849887591 0.2079935987540098 0.19433822560908323 -0.28691181193914461 -0.35929838226331667 -1.4916865746953429;-0.26843899613741234 0.99751276360353225 -1.1248957239943904 1.1466324078772185 0.2668756444657881 2.014670442421278 -0.35387946123976716 0.10609137541774778;0.83198727359386537 1.2476530775522432 0.6563261167140364 -0.63973728712016509 -0.098194482251036622 0.051990989245321403 0.024145147764139979 0.59220136772792076;-0.92897941236608994 3.5823684690340265 0.47212254251527608 -0.55189428760427006 -0.12451862002566616 0.27290278463104395 -0.2610230674468455 -0.45299587147194431;1.4221469944511529 -0.50091052865287844 0.53521911891171592 0.17812270599800789 0.10329366924959134 0.17974291109225715 0.028713599445502922 0.13111911254216993;0.17131609278996146 -1.1291048537555894 -0.34731839437873374 0.17067500539942124 -0.016390563270321422 0.50281955328113048 0.038234789961958685 -0.1437234147315023;-1.5730096924873758 -0.34477656270144241 1.0661270751719849 0.95618042748305532 -0.81057816917969006 -0.75540666477363627 -0.0044373840118769742 -1.0238475212097471];

% Layer 2
b2 = [-1.2390728588670317;0.89255866884833512;0.99903924101600128;-0.74617075740226302;0.55875667940880025;0.82428233266484829;0.52324449569313136;-0.29312348475573047;0.78485995157108457;0.22714998636558018;-1.1719844648627658;0.48678348593713211;0.94876295373540931;0.67193915843953278;2.7050372050229785];
LW2_1 = [0.56210892159963954 -0.47168040431060709 0.31759088526366547 -0.17045951882622554 1.0774383914886778 -0.75326395124919021 0.1599134992993938 0.17384061684146959 -0.1030095181828404 -0.5405324062684167 0.54946231929515388 0.34211729208451225 -0.1833818681178401 1.5933630136532355 -0.6127642092701;-0.68127016652671335 0.19292568431894511 -0.41945594784679491 -0.58880735824037778 -0.75324319034814957 0.35082175040835117 -0.37881973141457825 0.43341226276235761 -0.1774543574451333 0.61096047618970373 -0.34412679461932655 -0.45759850100495703 -0.51170705863926225 -0.6442101168267077 0.94074771763331699;-0.35454723664346005 0.010203104100675632 0.009539678741872757 -0.83475662683825624 0.94614772073204356 -0.80690730726316695 0.35744716942220595 -0.19804330483720703 0.1796712778039892 -0.68141976360871936 0.57862421612222237 0.10428188394078444 -0.70629188626780814 1.2053772748841283 0.5276607106988711;0.67691958647868566 1.0888201717487751 -0.33938385334305582 -0.63339093285881554 0.67365949588227014 0.16364918075828969 -0.16354131516249021 -0.70554632368615966 -0.11960288352539547 -0.26396479141170304 -0.32929050269159937 0.074897038925270581 0.58386751760124556 0.33188761597626182 0.25641519384980793;-0.25606075880375528 0.38256217959018707 0.22278912207726631 0.17684083807683029 -0.10046065543085209 -0.67396288965804163 -0.03428960146259831 -0.40403150375501812 0.023237571060686892 -0.7730183736992835 0.32584695670621516 0.71362052031738765 0.18685893590539859 1.2345549865730558 -0.14044184700617995;-1.1370519020290255 0.12670070689970614 -1.1064951017345257 -1.2803181799682875 0.40636388635384452 0.54596394237387891 0.59733401375490913 -0.74478201611205397 -0.69586587881146289 -0.084068450925023394 0.12011040010707136 -0.12757117617995556 -0.45164749184907599 0.2151936311496995 0.23762787059185064;-1.6651643769357631 0.63173905627181304 -1.488509352512152 0.93789155953502168 -0.82602574281170571 -0.22832867517316546 1.0877170976922999 -0.91714003350096873 -1.5425091923805567 -0.40240255770254002 -0.70658701545008173 -0.66699222788460333 1.0753885684881035 0.10701158748521389 1.0012552854113284;-1.0014489407059721 -1.4488983326858604 1.514318235978217 0.10486048434679875 1.4257851998865161 0.56996207341219951 -1.8611959436535821 -0.21846910276902382 0.9027340964831736 0.39136655957699984 1.1748085090377702 -1.1078965576667807 -1.3306203718567324 -0.77924918179189262 0.087898365085455177;-0.95131195460867857 1.0012767225567281 0.082620151604914038 -0.069147629269335459 -0.69847129588210943 1.8306069747625837 -0.1894434146961512 -1.5831635332889316 -0.5541740753677582 0.47144625990899874 0.53194413325480161 1.13963409312218 0.49484472646549504 -0.68977714758423037 0.023190017243264777;0.9042341650739335 0.18449315764196342 -0.14617917706504205 -0.0078348078698992352 0.57979372371073779 0.26537993970145707 0.66741276339112332 0.7338762692408568 -0.32987407230712767 -0.20664572333834097 0.19812625051114188 1.0418725947445804 1.4089591404080974 0.19713904476106184 0.15814092882213276;-0.97514842420297365 0.39075435395156305 1.0049451687472151 -0.44709983584722707 0.78355131292624991 1.1683955687046299 -0.41422180253887286 -1.2735934832377633 0.43458168336053166 -0.5500344597857354 0.59096374712466426 -1.7607301311357193 -1.2054395478422157 0.39604491507533762 0.56840625080790996;0.51030784111856775 0.46313499003716968 1.4001875079289836 0.94667961890124586 0.38707986694743002 -1.281278578353622 -0.69999575210325382 0.10682313205022509 1.0803883741668037 0.2490381156247046 -0.4025690672251786 -0.48615548515045237 -0.011544076220399428 0.032490802604858385 -0.68212925444122852;0.50360482311358357 0.5014828245308558 -0.26575080524146355 -0.29438323916516945 -0.053628925260774181 0.35488935989802584 0.082275828841839954 0.90224835668265091 -0.33309699416703942 0.33422171260791994 0.14322984458167695 1.5788066720531977 1.4818255730841896 -0.017535269223417208 -0.30979918916807486;0.80474712113741298 0.22703275699813674 -0.64792201970347951 0.015342815125661777 0.80883853278428941 -1.1315109230943194 0.18249753780212299 -0.20624194068032803 0.54142763280301021 -0.45437332502156497 0.058979659374209917 -0.34263077866458536 0.30345031442611331 0.92954182891341985 0.80618062247097488;-0.21352642819084819 0.13139371010696105 -0.60840459543023684 0.73302397238323025 -0.05567726351664061 -1.258978626855235 0.33455122933929909 -1.2558963682340953 0.38271935397162321 -0.41986530313142251 -0.10563417397040599 -0.13276301442427435 0.41935636270742832 0.31745146513028438 -0.10851176796644969];

% Layer 3
b3 = -1.6246807416461779;
LW3_2 = [-2.0289578985811452 -1.4725434627934983 -1.6199472338581749 -1.2227306025331184 1.702580924102685 1.9989608716843712 -0.76979246375177779 -0.71492650263171376 -1.0504952794626479 1.5519460721754139 -1.2376370144612328 0.88009431247096304 -2.0892734078655089 1.8627367899099161 -2.3824313332236979];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
