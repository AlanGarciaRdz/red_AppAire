function [Y,Xf,Af] = PM10Tlaquepaque23(X,~,~)
%PM10TLAQUEPAQUE23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:42.
% 
% [Y] = PM10Tlaquepaque23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.00773694390715667;0.00572573718866304;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.90959220959272;1.724313509505873;0.073239502264825174;-5.2024416568161289;-3.8489297423230262;-8.4757344753841721;2.5992428579668916;7.3313116402145946;0.077925338609625125;45.369315331315669;6.8072947283184906];
IW1_1 = [1.5745746184857246 0.39224924627428304 -0.025968101740932524 -0.17211120359764728 -0.97916009913787538 1.7179613252785737 -0.24043548087026601 1.0170207384208447 0.027679642511372952 -0.21651837798932874 0.66899693647132275;-0.21767534084014128 -1.4698888453494396 0.88170670339698054 -1.3629699646214548 1.128587597103947 -6.0517037939245837 -0.56850162326596321 0.28284677511885731 -1.0898434920172373 -0.97148774473678456 -1.1171167919430047;0.42406915900551229 -0.71160641199641506 0.70119711530233952 -1.0666909143455028 -1.9633213027302618 -0.89539962685770857 0.28750955721467381 0.21482197566443426 -1.3299632466516489 3.3274662268773341 -1.3530747452502914;-0.26513076035249233 0.67101916844637111 5.637491825691459 -2.2152238993889068 0.24155428153870995 -3.3527917109926322 -1.3276124698472853 0.22979919198747248 1.1764440832019574 -6.8113881453509713 -6.9547842821071324;0.094639610643077104 -0.75869498460913443 2.2239955199614854 -0.73673468192300673 -4.0103110229800922 -0.031672806152896284 -0.037130582394769386 0.16805673056234929 2.8024744147283926 -2.277681062112956 -1.3738082443210415;-9.0101522906845357 6.9020731512259088 3.0221600527571066 0.77878063906834327 -15.308738056997466 -1.3732875980603336 -7.3395901597085675 -0.57286951881142623 11.394844562131478 -8.2756062983121588 -0.010424200363691072;0.51142596191500034 -0.19050584007439919 -1.6758012329224949 -0.060907339653221031 2.6516426661110959 -0.49357730721210563 0.037513640329206115 0.10422639510605747 -1.726332236115049 2.9241794303157311 0.91073659487021774;3.4159130693483433 -1.7711156364670078 0.37327558952439038 0.001632840243079324 0.97272378502781986 2.8840901536596464 -0.44433808089421711 -1.4648021259636526 5.3526478200587819 -0.70911391873078777 -0.41129169512032276;1.1570105583823955 -1.3872345583574792 0.077326553654273433 -0.12763630062041847 -0.1777377209201321 -0.88449223319546244 0.026721714188680974 0.27235413136139708 -1.2011780482037582 1.3419912952718487 -0.61772717900994112;2.33310662689779 0.087289535310180744 -3.5300593175379689 2.2614396381846116 13.25377434296365 3.6578983954869644 -0.56118995537427363 -0.14434900013236129 34.278172499948106 0.1585845872310597 0.029617096312257812;-0.56951897347965663 0.58254966350693038 -0.73560422207691889 0.12133666131924881 5.9160367311607143 0.72385680909975691 1.704516110495444 -0.72876103635389211 1.1428999355359899 0.1494188054402073 0.49697287553100317];

% Layer 2
b2 = [40.881270354573878;-27.585355659890631;6.2853910320362827;21.636452375845362;81.814827709191889;37.283788668459366;5.9937283133464367;5.1843309626884615;-13.563694299170926;26.030443557117291;3.031938834269813];
LW2_1 = [-82.828544731714231 -3.4806599430627361 35.583193053296526 4.5469964621608021 -24.466211714566693 31.785305380147079 -31.211959932290572 15.212952299859205 34.739479872943683 7.9847253204370299 23.828270535104963;53.053559849282479 47.812190468111808 -48.359353027816347 -4.5904550531021924 -14.910798831352563 -12.380396206182256 4.4971728809392619 -4.8007929765509294 -7.9677484156858664 -20.828652740262619 -13.758955067390104;-12.651507971668433 -5.4428497585762941 2.7237806455405376 10.849361976057667 7.2321482033610218 22.575428239848176 25.280124183649558 -10.835658178041335 21.594728003902787 32.272915818265673 8.2779081942684059;2.8339809822140323 -5.7406284242957266 9.4795629393759526 -10.199880782232428 23.717844249192872 -10.852465258128973 23.347788534054892 -11.184049148619174 -12.411397802081456 16.810931779275183 -13.200457325891302;-33.484202513434404 16.073382951292075 -44.387131241658636 -23.283996943362979 73.272980466280003 19.620866137684615 39.198356766730143 36.927175791054729 -27.152303953607241 7.4923133822436574 -9.2224075761529249;-28.831690749494449 -0.732212024660851 -0.64082292302540955 -0.42224237405768783 -1.3571394265121435 0.27089642081297738 -1.7508980882897609 -10.118072918727657 1.7636933758397719 1.4318418131554276 -1.1142477832274549;1.9158775586218602 -4.7815761842288245 -3.0014306177250125 -1.6134668839591897 2.6788265953346659 0.68355039426943909 -2.3139501824297097 -0.72896004775935597 3.2165127762623733 -0.64555675449215522 1.6272788938611544;-4.388147949325317 -1.7074370862989814 -0.79454821223272321 1.1324213216062127 -1.3529476051762537 0.76040557433818334 0.6217735307990776 1.1784840328106698 1.45172087223348 -2.5285888627676925 0.21108674968328955;14.195750061481515 -8.3784623523449451 5.8635909860180897 2.2437789179214334 8.3205495690655127 11.252698849012626 3.6612140586810638 0.90455426802340688 2.3721277894346819 9.1121418494618815 -4.1244824324674081;0.88226581719371988 17.483064280580908 29.179668297290352 -10.237648194197826 -3.9539857098028914 -10.563177460242937 -8.3034283998781699 -9.9113077825189073 -9.0643248630475792 -32.564346864978496 -4.1180984331552715;-15.061952546806044 2.9592135161505451 12.728833019460319 0.94384734412531657 -5.2214487169412962 -4.199426709874448 -1.550385190519022 -0.61645661404915997 -8.4859587379721066 4.7366319174875056 -2.3253233489290523];

% Layer 3
b3 = -0.70334212567832699;
LW3_2 = [0.01414455860426495 -0.018826383601440302 0.0010276648593594911 -0.007787108861998941 0.014123797459433575 -0.12870811350475292 -0.046776553284149487 -0.071754920690573237 0.018959916044388833 -0.016703754290805652 0.01779910934877461];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
