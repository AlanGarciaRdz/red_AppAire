function [Y,Xf,Af] = O3aguilas24(X,~,~)
%O3AGUILAS24 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:35.
% 
% [Y] = O3aguilas24(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;5.42005420054201;35.0877192982456;0.0561797752808989;0.00588581518540318;11.7647058823529];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.5590173070008002;-2.2739468014432398;2.9826146425728108;-0.95383928705092247;2.370670701476457;-0.99110662009208672;0.087465815498178792;-0.045364779394747437;0.40232589713351186;0.58507840310585346;-0.69960922778944623;1.515115869963884;-1.3405064415333157;-3.0573520502878644;1.4254239730020652];
  IW1_1 = [0.94742253827954137 -2.1783712273316462 0.063612373442743647 -2.4698955796851556 -0.1057954254775251 -0.37529479393356135 2.5904199260568488;1.4590161353219326 -0.73356224818275706 0.47568366708991111 0.24761192130477913 -0.74714404388389899 0.52910640081962024 0.089958674928053484;0.023439115056529684 1.9424552739441574 0.13448854691266282 0.59835481020250048 -0.39468893063726274 -0.2818844379687705 1.149018363986259;1.1496282919046559 -2.062151202187525 1.0928236576427703 -1.7541815233085276 -0.58222788651373447 0.89933980122596013 1.7610504301167662;-0.27998601406972135 -0.17514811487311036 0.97533234559198356 0.22533655518709189 0.44272246886333183 0.13400392410521472 2.1452269854166301;0.23723291306280275 -0.89513921327481016 0.14723863536294945 -1.2485873693007388 0.089682750688730467 0.93384679164627804 0.50215346155053053;0.38095692580968599 0.13508942459134327 -0.80902836165355019 1.5274165633489325 0.97491989218745767 -0.14570189619603183 -1.1896705934782372;0.22782371862805381 2.4012526130624092 1.0547350707289089 -0.66899745515437881 -0.86799402479765386 0.59439713114271875 1.2570325570606238;-1.3874558014645515 -0.8058190451357925 0.26035121118926985 0.33831636723842506 0.09352938750417919 -0.17392819962006112 0.16057597098450865;0.85004239346124955 -0.022449524572738105 -0.055993852883285469 0.75124496479639691 0.74732892025814224 0.13179223804323856 -1.3443405670792761;-1.0101041251437322 0.67862113041557637 -0.098000308841783068 -0.66078879994719109 -0.20216570762929703 0.90498831500268107 0.50025007782068764;-0.082514398295591984 0.30121870824472297 -0.28106159385786633 1.7839284888524232 -0.48952447365336382 0.54798505327360025 0.77584138905460986;-0.26118887985959843 -1.630017601273348 -0.21232001255644034 -0.063638710304273025 -0.6210614915774979 -1.2024638028860508 -1.6691710932453252;-0.24154700852054445 -1.5043954301779323 0.58472372675281847 -0.018912431239943468 0.065134055334788582 -0.47850391678720705 -1.792093092215763;0.37679399114949413 -0.48048190408418678 1.8977440215253836 -1.2133182749467559 -0.87180674670990055 0.56982986950471981 -1.5006697897327832];
  
  % Layer 2
  b2 = [-0.77221446112280534;-0.36424709237977054;-1.8413147586916121;0.87638877014901728;0.5012473332711872;0.48739301489286735;-0.30746180594824613;-1.0087414745383205;-0.17016511133794249;1.5186665248222184;0.88209388857872539;-1.2625201683168912;1.3145460088085088;-2.1390730838964296;-1.0077765740946216];
  LW2_1 = [1.3369676711578709 -0.33587570973992475 0.26374425787532352 -0.77596489301729221 -0.42027542303348281 1.5039403772264071 0.35901815721441349 0.84932142034261504 0.46094728406668217 -0.71955946319224273 -1.7153471284726682 0.0630683802597721 -0.34399555623422612 -0.2739624879988945 1.0712605724404205;0.96478965607472777 -0.21516862328743055 -0.00085349148770103717 -0.54676394031862086 -0.24173447235677892 -0.057048641451946623 0.052073610001164485 -0.092778320573249307 -0.27248455398076948 0.31836750584935491 -0.41225164723728847 -0.089389546887731569 -0.24017490483196779 -0.47562027976487992 0.27906134993128462;-0.028266168822714779 0.07627678362229845 -1.367635335653254 1.0491888798689291 0.43524373751441237 0.17045357923530202 -1.4558640729799932 -0.29228337865525844 -0.69620437677083769 -1.2609166128067499 -0.89454699958638861 0.14264401816796674 -0.17565940810856062 -0.49641440438325635 -0.27722127124048612;-0.44859875739040245 -0.81357634511504695 0.53570062497525073 0.48141420774133853 -0.58959733961597127 0.2986638237170956 0.061691271373437731 -0.17583634687575994 0.5143104573886419 -0.070816558707541083 0.46051340722996309 -0.19675792842631507 0.45119730378281231 -0.66864953647195846 1.1995041881966975;-0.39367062702175315 -0.40412829654185106 0.15466854065952623 -0.55663867316508464 0.053119106471902704 0.17097297159311481 0.9004014824264237 0.57801031121976443 -0.26007025185504495 0.3135485882946768 0.044436046329129078 -0.46716603659256228 -0.14476334770669458 -0.10208961914468619 0.97530343783929219;-1.1111545683950974 -0.98490601963720859 2.8404705543713185 -0.56116319285131677 -0.44963105966104777 0.087219570769014529 -0.46263742518629791 0.5146981574924947 -0.79697391015360386 0.57141084158199917 -0.0020755098048635817 0.22000869425060471 0.20318456283452327 0.29919635167999065 0.064405287093749528;-0.33592257893532107 0.052421924385653684 -0.046742864366030895 0.046576073155251974 0.41500615648142875 1.0333332605321999 0.31951841999907499 0.52999506370236027 -1.61526663813286 -0.18086469498275431 -1.2883636146313444 0.52465641064598156 0.6755220456475709 -0.038632383608024623 0.071334656742742156;1.2981026422680539 1.2675704031362178 0.80472927048759224 -0.17102348342785784 0.040420843922610014 0.15819282631537293 -0.044919719017645222 -0.12484523461937821 0.50216137781644721 1.0133049386239181 0.028359615732704367 -0.295902143926628 -0.33481602239245944 0.0019573473786716339 0.31975126702406276;0.20431766111182692 0.45714334546292257 -0.23173195533279239 -0.69768237801148214 0.17159286164216475 -0.44349950351945605 -0.31741557810162857 -0.27222193342807105 -1.1372900786183422 1.2029009984894234 0.39843087359019547 0.37200067733551123 0.66769751525496746 0.28814209294146242 -1.0643920118218924;-0.98979607082446863 -1.2952900694582925 -0.55097933872762916 0.050699469334712463 -1.0040657122047996 0.22562098813281128 -0.48075998011140514 2.1289319754539369 0.56792208377995901 -0.48579225727269038 -1.4007425498064325 0.48288006269152217 -0.44604836875122994 0.10574541457160509 0.5241581802590024;0.41114309226498508 -0.78567979106444263 0.64295069137959227 0.19610754276637954 0.055949674830823221 -2.2106425707421677 -0.30255359111999558 -0.7903498093861091 0.77964648010407678 0.7786860561041824 0.75913092991894415 -0.14990877200382768 0.91819498608675754 1.5137459837808573 -0.50690645835524473;-0.7092210695092086 1.290621795816197 1.7928092080233564 0.81029695353688236 -0.20363331705767654 1.1748112383181617 0.1964477639432223 -2.0451249380412717 -0.066742358315170919 -0.78879427006472036 0.85390166662926315 -1.7937602050237536 -0.50046761759943281 1.2222110552028558 -0.86133329496379141;-0.67342834327226408 0.17468859645787255 -0.39556259648263059 -0.96361517532135987 0.10537092172032039 -0.46666211465894158 -1.3647653079467883 1.3013862363490554 -0.8569371109802284 1.0426247811929845 -0.69403003430886989 0.510067065506567 -0.015087661557126429 -0.57044530580928854 0.058566481756319691;-0.21801985114499658 1.2857669325868517 1.2399871757429042 0.80172848692232757 -0.1170984785002917 0.86375309594169902 0.041552811791148364 -1.4663512981175146 0.29181019060978169 -0.63836709984198448 0.5737651350104076 -1.486829672335406 -0.51496593331294926 0.47574330414409544 0.48650340669604142;-0.65095673931852316 0.25547068126255024 0.52882519919955528 0.46432521513069192 -0.30869312524807807 -0.22107579736120286 0.16785836858531583 -0.23269675007664065 -0.65399786387199665 0.16837296668974194 -0.121416450068988 -0.23085408969767132 -0.18929313453522625 -0.22619811567758849 0.68563216903407675];
  
  % Layer 3
  b3 = -0.78438694241138918;
  LW3_2 = [-0.87876375152727881 1.2486304234995635 -1.4559531108929236 0.61779869507721152 -2.4353331588196867 -0.43301608231138194 0.59385100024191029 -0.9183878034605556 -0.86867959394362892 -1.1336801951015028 -0.12868150114850105 -1.157398349796362 1.2287925413766057 2.1198749135116768 -0.87862307791704808];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 11.7647058823529;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
