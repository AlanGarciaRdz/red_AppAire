function [Y,Xf,Af] = PM10Oblatos11(X,~,~)
%PM10OBLATOS11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:23.
% 
% [Y] = PM10Oblatos11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.4362462575615966;2.4359858060226007;1.4368949246807328;2.2855011587625893;-1.540909343545616;0.79079291368422833;1.8904254717019675;0.2982570292685286;0.63309346692552382;0.70847359473709504;2.2225109985487617;1.617292533804356;-0.20954605938257739;2.3154570293659948];
IW1_1 = [-0.32247463195788656 -0.13991590583349264 -0.91306704735092392 -1.5084066519754948 0.2598223053560143 -0.44276230684148754 0.57955617405535409 0.79476633268554042;-1.3366390213744901 0.91539330579408529 -1.212863744137636 1.0011705121782479 0.5007323063224578 0.19369095215179397 0.57180532127995343 0.55858143352066025;-1.2757217382056691 -0.73886619597714887 -0.13968206950318768 1.0703295055394915 -0.63191430366417434 0.83242502639958815 0.29891691817305255 0.5464050909538809;-0.58338708425072405 0.16713063739116851 0.01576774212306354 -2.5140389080839367 4.5527539245483988 0.16709503729989358 0.025257471648933241 0.65131260356845022;0.89418344904360569 -0.97634758098391938 0.41265366138068665 1.3202965620171596 1.7218765804255698 -0.59553849038206441 2.2311118865230299 0.97331196533448683;1.490914466316648 -1.9451059092676044 1.1209140723850946 -0.43791630180582863 -0.57090042771007465 1.3690388077440894 0.36929573666762527 0.92013245086232975;-4.3678632518857521 0.75543042730241905 -0.24136855678769181 -1.3448332404163867 -1.2722736653333895 -1.4322191775368891 -0.56349808598946649 0.057618879597946357;-0.53061867723650069 0.91362226982522954 -0.1093018195900532 -1.3243530073310874 0.55030014270035632 0.42301667098313461 0.13591541052317194 0.041017640076374179;1.9357936673195411 -0.66827315924837927 -1.183681100813891 0.77133660294660333 1.1574738567235388 0.48710197033428909 0.093212417121755695 0.75583951144788897;0.30430076121318222 1.5490133024951775 2.7239102660961563 -0.85065840040862306 0.70359732775460249 0.48667242156672413 -0.038251133388331006 -0.14575135059602545;-0.28682436918052517 -2.8330513243209188 0.99363554327176773 0.7501158958481321 1.4766020501312962 -1.8509462447167793 0.45807018905754709 -0.13409920524614624;4.0231906358841396 0.052402511386127032 -1.5608546914710706 -1.655958735067681 1.0077028781812056 0.14831009355390914 0.51074099165184983 0.31979363996659887;-0.9326355162561325 -0.68416570983756753 -1.079315512015959 0.36307594904608997 1.9848477902574624 2.0645614444142044 0.68726181151802834 0.23117793474797405;0.13552635646138878 -0.10740941275401808 2.4416689173876551 -0.59411346014969246 0.50912376780955215 0.23917401919115089 -0.094002498568780651 -0.18614003671404369];

% Layer 2
b2 = [1.4309241816313751;1.4509515273129765;1.0721648143155955;1.1327986545005979;-0.51575907323776837;0.29468665506796521;-1.2227253084883634;0.53826177658011753;-0.21211776512456887;-0.39554308144539924;1.0774751457282692;-3.4413083336202828;-0.52477241540741659;2.4793531864606146];
LW2_1 = [-0.01135079769915525 0.15526907572245197 1.3312280103620235 -0.98163912121173713 1.3629327844707264 1.6005659374860606 0.098703476725154837 0.99903028525644488 0.42828168403420441 -2.0583174535963056 -0.71412680484503865 -1.2996321934387671 0.62534171899896585 -1.2871087447620062;0.018956448842036247 0.46080753518446066 0.49048088383315724 -0.52220020790983668 0.077031342034106845 1.14934594648524 -0.60924134441865918 1.64399354083208 0.99362769623405367 -0.62193775278502916 1.3509883868669026 0.4566236857583218 -0.96885085185572817 -0.21796789445679765;0.20613697773915349 0.28325535143901232 0.15430606036635275 0.38056691680593507 -0.18363640216692489 0.26711110917705844 0.89818596557652652 0.23345532913634454 0.85829573275678683 0.53980196151921067 -0.098832129148970438 -1.6227808017137069 -1.0466188466398481 0.27338828979137747;-0.071310228932425432 0.41707739930189947 -0.16963925112048964 0.32769054336093467 -0.018634085824229436 0.86681384309010756 0.52150267828468977 -0.5705211523564081 -0.30057903620001197 0.088065025051750193 -0.34320938086241187 -0.65405539575313443 -0.96935187778492293 0.66984309165082379;0.51827332631427192 0.96891384327209629 -1.3486551018597739 0.86366277577131323 -0.44617806654777825 1.3002006354194149 0.13302670525517069 -0.28659044003022083 -0.47943600508715806 0.25367021535653861 -0.51370959869351152 0.80093628992766219 -0.11176764555927493 0.17902186845067711;-0.29422317486956756 -0.35220234842651382 0.16691941191675044 1.1861599032653427 0.20842054229053047 0.61500716530282296 -0.44646762363043613 -2.3132628949101974 -1.7180236796600334 0.21789701901583211 -0.70024078609284746 0.23220034473127529 0.014665699241252644 -0.26216543468018527;1.4611551307737098 -1.3869899544269368 1.3231775183728176 -1.1822708960630099 1.0550100087874872 1.6802390605618602 1.5520035370071241 1.2769672816228177 0.63165386279271407 1.5548316298655476 -0.3237347128117673 1.0359453290848013 -1.4211813483870417 -0.97740777772623533;0.70402039716625286 -0.28821292582040692 -1.0905083795077901 -0.85265307224699916 -0.91875319187443527 1.1406232591265906 1.2410615678461334 -1.7354496632265271 -0.13613863499583603 0.48725003483695906 -0.052148104561128492 -0.89065221489883095 -1.3723160089454962 -0.49217345116512262;0.28165109627008222 0.26476410276000173 0.39113154361487518 -0.23482801260356215 -0.76897065045159185 -0.78937374477526567 -0.61721206670331419 1.5646167954468011 0.37499057634717331 0.16306775098072171 -0.5224700347393374 -0.14442894056627809 -0.62949293478921198 1.3225616938682816;0.90302070323831407 -0.017793318275433925 0.94784732979859432 -0.63209841762284091 0.22185296881632954 -0.67874122868227227 -0.17055029988573581 0.92818595710155427 0.81435903097570594 -0.99387006727859784 -0.30120085479223352 -0.50432928388955367 -0.25596932182774712 2.0454091171925328;-0.67491905008902209 0.21628592888783119 -1.2786940044918356 1.1922285851136867 -0.30842960438798217 -0.51671838510976376 -0.55471708249965501 -0.81574562496355452 -1.5754649291505785 -0.47913358867772426 -0.18152969628725565 0.50577973717595814 1.1490621680473743 -0.17364878080451665;-0.64588268961766238 -0.40740553746171088 2.0390820377292571 -1.6001649971777618 0.49636173122593552 -0.41037854873270196 0.60836923225542683 -0.20769125891496484 1.3749774999945923 0.68647864675075787 0.006036592295373143 2.9101478755106034 -1.1400657172285049 1.5460371334658998;0.35589619761590591 1.3029664360634365 -1.0485967755984171 0.18765740815514453 2.573250503480554 0.91313118330363241 0.26395599540864767 -0.44492304087501694 -1.2576139262469503 -1.1739329908744911 -0.43565165445481274 1.3139085014844281 0.3484870958212592 0.74833206799599428;0.26114089021011971 -1.2726161935894582 0.65983989566804602 -0.3415588787417646 -1.1957805353620918 -0.83425552941066505 -0.25870247149400616 0.42363774692149136 1.2229461260760892 0.7287769014963994 0.30435509585389481 -1.1054174303766147 0.28130847711496165 -0.50730585102399439];

% Layer 3
b3 = -0.7860822475348076;
LW3_2 = [-0.09907264106262674 0.20811249501016277 0.83997791497591712 -0.4607013834830847 -0.42815420124345588 0.44476785206594466 -0.20918225892678941 -0.17591266696932673 0.39372029721116647 -0.60238419243471908 -0.40763397844326493 0.25616786981481843 1.4397114895935967 1.2420022123786698];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
