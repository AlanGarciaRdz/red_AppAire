function [Y,Xf,Af] = PM10Aguilas8(X,~,~)
%PM10AGUILAS8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:48.
% 
% [Y] = PM10Aguilas8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.8293235047131347;-1.6682456669353483;-1.2293080851222857;2.581725930103274;3.013963613870021;0.52541838365125959;1.0507750762227375;1.5118275625420097;-0.95904580642430715;-0.28189451208612215;0.077791546015492305;-4.2081503649158636;1.969484296750502;-0.12624674849363896];
IW1_1 = [1.3167393307302937 -0.44155131057835678 0.77613019784835868 2.1818551272832969 -0.16768752183491811 -2.82909470173955 1.4001249679464247 0.76552637742736107 0.6857739490984015;-0.088850583513659501 1.7856007261524127 0.77430158637098667 -0.35585427379593382 1.5267026924224523 -0.17840250625992601 1.7546879610729811 0.92077259594315874 0.20909983679408362;0.24167499503662501 -2.1752940859119585 0.34254549782551891 -0.075899129924708056 0.40199929054082884 0.26905571319797189 0.32225314925613618 0.19137280120623934 0.24629257870140803;-3.0865854258750902 0.98822664701916285 -0.38174226739247136 0.95988003265059085 -0.51097740865485564 -0.64996782016806376 0.11508694226941579 -0.78436503571868854 -1.1387233420801675;0.40425574399694664 -0.53042204404923754 0.12097368000549898 1.076993728515661 -0.2581409831622466 2.4047754373723236 -0.12258780199077694 0.093625231608253132 0.069694369761339414;-0.43617860639347256 2.0971086427120635 0.64328191743508101 -2.1702842153984916 0.72952686243261378 0.66311578419475059 -0.60716046837285753 -0.2549990874728148 0.041047522683331832;-1.0223768852108419 -0.072774953648822305 -0.1791300380111967 0.81386732395031891 -0.73070968540460912 0.71341765884831421 -0.48353996270717481 -1.0373138060431122 -0.79750266566186689;0.67656625096428691 0.73883732228145949 0.78583987112032017 -1.6814747644464081 0.49173263514269028 0.94728628568616657 -0.89666028830644584 0.24689682061322185 -0.25702258446841575;-0.37638548545633771 -0.68345916395991047 -0.36985975821605865 -0.062917826423547013 -0.67702887104307796 -0.88433029634826543 -0.86790801375672266 -0.9584630902193888 -0.90543013176647513;0.065474858711651387 -1.4256182997150668 0.5032991760745078 0.31918258540052685 -0.19255482444675615 -0.25662070035141865 -0.68653375422240626 0.42276035430553599 0.38677437177396762;0.74261872605271939 -0.37521342752499071 0.17154285905455691 -0.74899148170377505 -0.33738733926564979 -0.35603672830278205 -0.70712252907153728 -0.77149942645352221 -1.2954401281881807;-0.36513784626827861 -0.49837595305379045 -0.2410758234897549 -3.5390929334845826 -0.094022364685730331 0.63917082563766725 0.62605782427757395 -0.12525674444387974 0.15716299622411734;0.14648099257162403 0.80516927054556331 -0.68780724533018878 1.5887183798878111 0.47309098295281699 -0.30169794533417771 1.5768374898496644 -0.459734378143698 0.43847043773246769;-0.091629608213751657 0.72692233345071078 -0.3647565795088864 1.3085458459094637 -0.85658241702368698 -1.3025761828405384 -0.87172722877387598 0.14445256376966067 0.59564187829826321];

% Layer 2
b2 = [-1.4922031054386593;2.3394166183958554;-0.81155852530569528;-4.0517456524478934;0.71097595798076174;-0.0067757935838415016;0.54003810268841246;0.082474755717186071;0.80198381269599439;1.263455366170761;-1.8879553125298363;1.0406713326072374;0.53141406649001355;1.9766053306677995];
LW2_1 = [0.32616173733859372 -1.0632315245055244 -1.0112503614376849 -0.39485895823973988 -0.045681552730448285 -0.95985002827672539 -0.45719890461687418 -0.0086879535310437142 -1.034459624454815 -2.2108983021642445 0.56447274772913281 -0.84127173914411113 -0.61015543816546569 0.69569619210500289;-0.25757252900922473 1.4332847633321297 2.1646698193780267 0.63657650555508249 0.76890017597079441 0.99580735243925089 -0.38275187719054332 1.0982679610202943 1.5616869918875993 -0.20743816358809719 -0.33722846444657351 0.63395051979907446 -0.76521576550045178 1.0993518771610971;0.54730114662540852 0.46726065239642184 -0.12448226079402538 -0.85651350167562379 0.80846190114381178 1.1882281552198388 -0.19820993283964616 1.5063254243475548 1.1379223165708519 -0.48141440331826951 -0.37190989591356738 0.84748494139951136 -0.5807153544333149 0.18728518444314285;0.32645777163141532 -0.051187709240631318 -0.83723602206805592 1.0320456896598471 1.7285407286495118 2.0156958454422513 -1.5596954414298867 -1.4126435879898624 1.9238147648019006 -0.56186315028635592 0.11255321669467537 0.5178704381377307 -0.15436638449718743 0.78912172405574343;0.11443763383202547 -1.4906658422383794 1.9016139585531044 -0.50130755290401463 0.25371418976091503 0.69798418721501831 0.37758655893658699 -1.1551917873134003 -0.37655926983077564 0.084500026210762316 0.36888133904608372 -0.48883644937356113 -1.4280838569540675 0.11448180441633875;1.0665156211413827 -0.98726234115061073 -0.90591663995191429 -0.071291999868250855 -0.13683278719854575 -1.1089678824287654 -0.3664669802003846 1.3764594834886845 -1.4564966269077215 -0.45107961888058745 1.1599986831377349 1.0007653016641829 -0.40286765381653378 0.28913258881061155;0.33447921614600362 -1.3184663306714732 1.7736062221565305 -0.12403880958185851 0.015865810122828668 0.80075175678266386 0.87499164243684624 0.78685616747435749 -1.6193459995353354 0.5103780966887479 1.246180801857445 1.3373139563184684 -0.86851928248927057 0.70789449640005175;-0.0313021067590206 0.46105461081287225 0.11984971092235998 -0.97958064001632827 0.12460995223058211 0.45465915240542437 0.39504658790699348 0.21920221560581288 0.24966549712856589 -0.70600813821733133 -0.23376423613048652 0.068085619068820685 -0.36140603627107615 0.36914925982813307;-1.9345268113330838 2.1064049798264946 0.76893679423669714 0.31050397422383247 0.34886661619438658 -0.012479672716784677 0.77165643337365852 -1.4467165248408547 -0.94687822152726775 0.073804899248297959 0.70781769917114012 -1.6952087430074942 0.73023109809046305 -0.75581761722868179;-0.21735542364100638 1.4075531529882719 -1.0384639791095793 0.43076940875894126 0.1784119774997199 0.48550772516560481 0.5268099701888671 1.3012517635799656 0.77281750439571206 0.8488132031265333 -1.2687813869211255 0.49828428869401992 0.27565295148356772 -0.26228051807807612;1.2516459978017254 -0.21168500524925599 -1.4252078693232499 0.29960881646137333 -2.8121587332472266 -0.24134994996548867 -1.2358762938225822 -1.8754833003143643 0.38637896289034124 1.0494930788590529 1.7883739379068366 0.32863620925203207 -0.36658626433072566 0.59960252186976282;1.5823086556989407 -1.0078713970813966 -0.31169235768719172 0.50299367011840057 0.30613860821633282 0.52664475587623005 0.7724174182458341 -0.9328385075717146 -1.2029583607207062 -0.075395333103520229 0.1155023606279721 1.5620207796834402 -1.9724071862340802 1.0668365086503611;-0.17019646740192773 -0.043807982463391182 1.0203561626878956 0.70575807859918538 1.5575940606346406 0.44283054635417951 0.52304576267178116 -1.273225019284731 -0.19467700730958468 -0.3381424966001601 -0.5678995213664394 -3.3408254263313046 0.45013955716579102 -0.38999325368869864;1.0813557825783833 -0.72574543613706866 -1.1312598530068125 0.1765537811692274 0.81284148878746221 0.31638225983881019 -1.5304181462296238 -0.58363852230316493 0.41309072929785046 1.233877940494059 0.6166501428489074 -0.19242669769481763 0.56613488618667018 0.43604364625547115];

% Layer 3
b3 = -0.59430183616852084;
LW3_2 = [-0.26430325689767503 -0.31078726391317874 -0.41635867107911362 2.3758041214812553 0.34227838790314369 0.22503875366956083 -0.23143073162124347 0.61787956295806701 -0.16479795880217041 0.2790511854074153 0.47816094701788142 -0.20315915292046147 2.3183547944132767 0.33417408785345454];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
