function [Y,Xf,Af] = SOXAguilas17(X,~,~)
%SOXAGUILAS17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:20.
% 
% [Y] = SOXAguilas17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.0795115362431162;-0.78459397219217075;2.1223021214738114;-1.6481354848165672;1.1558299456502308;0.62007044237605458;-0.21013296507120255;-2.0951561820069875;-1.2692061522193361;1.0847107764238626;1.8260758114328208;-1.4074944943239209;-0.94261850611757991;2.4051759064369347];
IW1_1 = [0.29493939372044875 -0.10341326964540019 0.15097274578872813 0.76330706533209536 -0.22424057404412473 0.31337083673820909 0.42690090392087027 -0.17863636056387089 -0.15512167425808196 -0.61166596123383621 0.93757359768073489 0.73173732300336913 0.4550230580476437;2.5287086399006307 -2.0086989924864391 0.44228029069773295 0.47035409194089661 0.73529336848278093 -0.89281036162277361 -0.70145989677377019 1.2648000494900467 -0.53362898228252531 0.49856077099002855 0.099639373191275069 -0.53039482940834071 1.5362966440057699;-0.096844456532272638 -0.34314199132702661 1.5498982384780535 -0.90904760437804133 -0.041873352115770077 0.36151781644645398 0.1583410988176189 0.79839132770049126 -0.077844192727629893 0.41470168258526596 -0.071991918438818303 -0.35863730237898295 0.50233422106564307;-0.33682683182363621 -1.0266402916444088 -0.34727831577267687 0.01797150423175925 -0.13029078494991703 1.1144271163526911 0.82683610279731823 1.3042609645159644 -1.0052136987393345 1.0719072702980137 0.14419703102691611 1.3247553212231282 -1.4573757018135414;-0.066086657706188226 -1.5793417451368648 -0.78174763819805548 -1.8874081189928962 -0.019452556489661328 0.97266243876509662 -1.0128130095934667 -0.39625232159835472 -0.53705473796799752 -0.33492821561064301 -0.23755611095725493 1.2622448986555406 -0.3142217131687533;-1.2957057563875924 -0.18461687292280377 -0.12865385007540589 -2.5641116806917821 0.35060056156955732 2.2008269728448004 -1.2222470214523977 -0.17505207784243729 -2.0411935055787764 -1.2053050603204829 -0.21072176743104659 -3.9660336637037314 0.16086436624486064;-0.078111173349051932 -1.8759155867417245 0.8251179732109899 0.18475218316854278 0.83090861912589153 0.25872722641332591 1.0486437932250841 0.80159302179717906 0.042976315276122876 0.31378917939032597 0.046545251594298481 0.64776283347243691 0.41298559471159746;1.1014453401834139 -0.22638274386881163 -0.1971054613017551 0.0034577800603355913 -0.071369379282204354 0.026962514171121096 -0.2047563017420172 -2.0076848083292163 0.015606081122882524 0.21744145021018857 -0.042522123699394003 -0.10673469764551591 0.23771461209374306;-1.9756113459477078 0.4122575110424227 1.5487769323330896 -0.18127914100850706 -0.05077224732121069 -0.54748217060707671 0.32724948955014521 -2.4476553214448913 -0.63264106472102177 -0.40273120961563713 0.21305754384113651 0.89725686806518912 -1.0767113086867883;2.1276110370505341 0.009253827730235184 -0.51043171741908577 1.1488690817279501 -0.96237791015392249 1.667857044405759 -0.1288341165530125 -0.13577055875695493 -3.8001832526720993 -0.15148200893286146 -0.17224942326874354 2.0998833978623068 0.1910026521649805;-0.49774423397789097 0.73475530363593211 0.38518509213481988 -0.15710612865277812 0.52906462954035383 -1.5870172273272953 -0.86028441045074411 -0.1570744014648284 -0.20949599999571783 -1.2219902204124544 -0.43264604405786872 -1.2417730067011512 1.546503490126526;-0.71702950014219935 -0.51824591642801277 0.34180727045065284 0.040812335772305093 0.30234166454799738 0.46740078461763435 -0.13971298462784051 0.35701594432138428 -0.18389065617469708 0.03476272509815375 0.88846888960063575 0.9277211940205814 0.66566460649879688;-1.0496686117725107 0.41428458309804994 -0.14231374915904582 0.27025448829003329 -1.2020688475191443 -0.97568461369545256 -1.3940411567580249 0.76075022545501747 -0.64658561954048699 -0.94053162671224144 0.28128753613942026 1.4258488742472182 -0.26127627094589845;0.73584080651218875 -0.018255911168197816 -0.24503501619349083 0.092014777140360493 -0.055882263470441548 -0.1542152746758578 -0.23183283092966267 2.7966833627848731 -0.17656321532010669 0.009179137546843897 -0.0080846792479861984 0.18366568538304151 -0.014963557700952118];

% Layer 2
b2 = [-2.2104108018479982;-1.5104249161635708;1.4571454639743007;0.44220271234701991;0.6626240772930968;0.55319828788194125;0.48082820677466348;0.057904327979602044;-0.97541108104718655;-1.2388575619781166;-0.88217020132745971;1.1909432592774041;-0.84290319954000181;1.8145566066773593];
LW2_1 = [0.7698188345049044 0.16907564363983518 -0.88717641839837114 0.39616027987687069 -0.59464356761302961 0.14417404276368662 -0.28571521266614064 2.6579109377041803 -0.55893306112222896 -0.26887009623821628 -0.2536904922906682 1.1557120917491863 -1.5031665890026562 -0.32713666982105261;0.64537822205715367 -0.13138084858813007 -0.79981725646332424 -0.164237363606242 0.55998172314153338 -0.092469443136487223 -0.72248340387678722 1.387295101889471 0.51289797876472543 0.16179085155973127 -0.37967105288743463 0.34326260315259199 -0.23095328020115652 -1.3171890307072076;-0.85433038490851876 -0.49835849001103505 0.48706182578295282 -0.72082772491590541 0.40342163826220162 -0.59835821494484454 -0.16912673639736026 -0.051438733176303188 0.52460869590542991 -0.19175308657951348 -0.47731809880491793 -0.047538288202414743 -0.22097609044210978 0.65517852183670267;0.41831012824093028 -0.41270772351122559 -1.2560695449715256 1.0102189073132066 0.30240903848539857 -1.6506718960903237 1.2232927893826477 0.39878499463826617 0.73372746346453599 -1.4035670494497112 -0.43730708729696582 0.67011593201011221 -0.5653387248478966 1.2059913016887784;-0.28679079078587888 -0.37396250668604525 -0.20134684996976437 -1.4971015094517348 0.94623007033007001 0.034890805865932767 0.74612918025435926 0.94847608931187732 0.56893457855596441 -0.12402380483526856 -0.049279056669915722 -0.69891047464171763 0.66120304497274085 0.66191769433879877;-0.36251939966171592 -0.56338761004857463 -0.037115444662237478 0.043691450425214884 0.80392447784899934 -0.62713462714716328 -0.75230410186990293 -0.67800209605870898 -0.24271806100015794 -0.41125721835058038 0.80841466484004176 -0.6058567035184188 -0.25190808119354674 0.39268360080352116;-0.85896684509033427 -0.11032269345958631 0.97117880847319293 -0.014829574328877812 0.9428790574033955 -0.20860739839932677 -0.82977887663941341 -1.1035554066715763 1.144778434531682 0.57334634159124553 0.70884545378304931 0.13342754015308433 0.25420102354982166 0.48640572190936199;0.5719790333964182 0.20101124187033975 -0.70570331409063691 0.51109672944228202 -0.62408637738835737 0.38797517369610651 0.88149828976593281 0.44931957866528427 0.40758975821656557 0.49591695618269244 -0.043127323623590265 -0.21110695926504361 -0.69104767763039399 -0.58905446694903807;1.5860219347474089 -0.043913969702369882 -1.5396471782890666 2.56214013134784 1.6687429412624144 -4.2449958761973834 -0.16278046509942859 1.8312309205980701 2.6744205439841058 -3.8733473948056809 -2.5812662042233314 0.58344783740125672 -2.9985004538302826 1.4570195105024903;0.17255247149223824 0.42366453914444752 -0.91746264502972785 0.71908960389697152 0.69230943039181414 0.3881377205058697 -1.1539420009096863 -0.1854779555524867 0.20973380402645053 -0.42182034942409513 -0.60727032894599042 1.2877973212495857 -0.14575387038329299 -1.6122326999283756;-0.1626381594572999 -0.43715216609736179 -0.57445431099249933 -0.76549255539712191 -0.72602120153429506 0.2627689003106129 -0.19157149610765781 -0.067911087119627261 -0.46223405872500711 0.20617226321358512 -0.92170180623501474 -0.80019647989821008 -1.1343876861562494 0.29931921312780052;0.12707553340918798 -0.47847873807851588 0.084151984907000113 -0.56162807056979103 -0.39315657595841763 0.62273664805865525 0.18308586756439418 0.48725769871064462 0.55657091950035897 -0.390695129310143 0.66687821936502811 -0.81629059397307746 0.04731751832769631 0.39740497917737083;-1.0971537432717784 -1.3589308478207367 0.80136236867773225 -1.478514128837803 -0.79603452281359965 -0.35417033347747429 0.73477692484091994 0.99863010639057781 0.2008047767751836 0.63525464747830629 0.32961117885576036 -0.79074162819725324 0.10488575602139223 0.66775742538197869;-0.11679294945477096 -0.17875008155406674 -0.13452753325787525 -0.46528623467765795 0.70957026899780229 0.091498895338352246 -0.91355665234787764 0.29457711765363098 0.86356608206255137 1.395271557782565 0.23604100713463763 0.59589444930926239 0.19909794613720627 0.79873827486922511];

% Layer 3
b3 = -0.72194563277082258;
LW3_2 = [-1.3260228976413659 -0.15830568446312918 0.10958729484585752 -1.5680678462657989 -0.73660961314638829 0.22946657693940861 -1.877694458982065 -0.20412034543464447 1.632240630190791 -0.87405373024866351 0.045514862954320411 0.28343668366266778 -1.6154222984234201 0.89279776060239369];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
