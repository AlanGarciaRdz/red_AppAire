function [Y,Xf,Af] = O3tlaquepaque12(X,~,~)
%O3TLAQUEPAQUE12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:52.
% 
% [Y] = O3tlaquepaque12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.171659085057077;3.03490136570561;14.7058823529412;15.3846153846154;10.752688172043;10.4712041884817;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.9931157385789442;-2.9013787138672487;-0.58897323775160815;1.0793110903803642;0.39763388578008002;-1.8417091278843325;-1.5350017833299909;0.58868366171538367;-0.74985143695344569;4.4655879873990774;-1.8918945202603348;-2.9631273840676662];
  IW1_1 = [-1.5092406648465568 0.23617130306854783 0.58351313622379419 -0.93821839897802317 -0.71851935697201552 -0.68253934681157058 1.5313411502555085 -0.018155595439429201 -1.0356724648438691 3.5332517866838717 -0.69544126740657219 -0.4541060109715559 -0.41103309593455561;3.8480084635133633 0.34919114062618023 0.34742803749638529 -0.51911089793588561 -0.28160869487920687 -0.062888440948229513 -0.00084085132621888534 -0.17257557143281332 -0.22226114444005132 0.40988804733693746 0.012664352976391097 0.025552748382176797 0.052622453794413507;-0.44465872807658163 -1.2254686918731992 -1.1552240873452271 0.92925442943643122 -0.080074315400148893 0.056632929683396629 -0.067399182704988292 -0.5389265846719663 -0.088063163702709821 0.80591345645467549 -0.25096910610681417 -0.021878014608168427 -0.55149868308921413;0.11937476257709854 0.0077818999601211095 -1.2622560873951039 0.20882727350951119 -0.28620681321460451 -0.39985080982620941 0.065104160605562428 -0.43165741847300831 -0.012779958800869205 1.89241336764546 -0.18289774162073508 -0.389530254888594 -0.46176636369998808;0.13482959872127659 -1.3901602194015079 -0.028305456102124531 2.1779362721513631 0.25564586758108676 0.20368017871157867 -0.080900935675295133 -0.097641368304402898 -0.087477195974590735 -1.6706316364457388 -0.24183699980657547 0.12239488067926321 0.72772822584016283;-1.8049589628936706 0.97436273703312304 -0.25204943215755382 -0.14551505837401599 0.10156631762851323 -0.97799128947047431 0.92606576415176156 -0.0069227570181879181 -0.038223107656364649 0.2271326012019719 -0.1273726777929324 -0.33730466695397532 -0.93403266784230998;2.2650298284121342 1.1950105896160972 -1.2221483887399429 -0.72021696828334814 -1.4566115273173108 0.085299009589105149 -0.64332373009177124 0.35071122918847358 -0.4549304055827777 -1.9131086689488328 0.26263185605006423 0.15551054226099803 1.4805719339203252;0.98138567442575342 1.4801710700765012 0.89770598100128707 -1.1207111719190936 0.0095155328737857245 -0.30202572556648988 0.16847117866387259 0.39283139717733684 0.34917464199394488 0.83311335280827514 -0.061389401338914046 -0.078824951853580738 0.1886233702921658;-0.72700054102981626 0.30342699178416277 -0.135290761034282 1.5724872347422003 0.28341382377425223 0.096999159647704669 -0.46523922119104039 -0.097593171266867035 0.20991235454901142 -1.0587602832095231 -0.16513148173848791 0.044524513887387859 0.019671898795993428;0.82990810984052044 -0.4023556136795895 -0.24525936102683682 0.23004570512265293 -0.10826077603142975 0.12079404740278088 -0.1007261551337226 0.32128390855934286 -2.9501293383229954 2.2447800470971071 -3.6937794846335015 -0.60855219540221228 0.32296779401664344;-1.1938393519225854 -0.10755375447039556 -0.58420813908761049 0.061794486275382796 0.11452257970183102 0.054531546190816377 -0.30277816150876213 -0.24497292800194659 0.40595334395574262 -0.22451729309010049 -0.07755669601388078 -0.011353521065060814 -0.27202543487787084;-0.3824141356154323 -3.8228048164749002 -0.10119274881672276 1.5757770033126377 1.9875432908568196 -0.249260377232039 -0.51575620851040571 -0.57906722079387696 -0.47554067043171899 1.0571986262191 -0.96165231167104925 -0.056200274611737523 -0.90251065655986684];
  
  % Layer 2
  b2 = [3.1513930424927361;1.5603995821904331;-1.1914121487612694;1.5071068917617541;2.4973890716499216;2.7297754539259915;2.320553403720095;-0.6828935933285567;1.7954049383923716;0.20873710983860044;5.1598553046474471;-4.421693670715932];
  LW2_1 = [1.2752738030268833 1.2898683556441028 -0.41797383484161854 -1.5635837259418093 0.84204464637954102 0.1517337575364287 2.5305546333778373 0.94730709026331072 0.28639477870183894 -0.77113587214540558 2.5039957534840052 -2.0015759618249627;-0.630513037652219 0.47235970889925538 -0.44616868209897764 2.0795226746607205 0.48015652080305493 -0.76191224083091869 -0.84225853425568287 1.6575413134404033 -1.7734596584415252 0.15412591575919163 -0.44472409251038481 0.36107070013781523;1.4999676495777905 -0.019194173636028045 -3.6171562760707969 1.0005375762321276 0.32772187371021505 -1.2162428623620738 0.01775839884319564 -2.4798594921032233 0.099738850819918262 -0.040132514609097711 3.5404673453665692 0.1290582965106892;0.0039392928333441823 -0.18268897435887388 -0.87513734707027124 0.62236877043885874 5.1819583603771529 -0.35809808655637732 -2.0090809293488849 0.2237767846855051 -4.5243572540911812 1.4757130515552319 2.7451204408092993 -1.1009419614118137;1.6043677786393182 -0.93808479889051455 -0.80333632735332472 -3.2499961890704272 -0.95481253558110457 1.1333026454071031 0.55791102169905737 -4.2623488010491926 1.7597280160908768 0.23123202906782106 -7.0347267357804002 -1.9541149903951287;1.4257483774688215 1.1658903023763065 -0.53291102178654071 -1.2743766453305569 0.91499934712140041 -0.13984797453272885 2.5165234070771652 1.0061648178591442 0.15217482700734541 -0.64926811879738311 2.534615070383917 -1.800941194552641;-0.49058332768662694 -0.43214618031509883 0.36377813767642919 0.69191864688191473 0.82707136132449066 0.0022722936024160839 -1.0917240070074363 3.038378369178441 -2.1538756277572531 -0.065508366747378421 0.078903891819091451 0.62498367572031466;-0.76678736764528654 0.96675280982381029 -0.64544501801066156 -2.2915582383843369 -1.6998761130253794 0.38764987193242112 0.43262136576812282 -1.3805028846385932 -2.106935156597372 0.76191530973157495 2.4462105659316795 1.6420320669024802;1.2992899127631494 0.23231500055445914 2.130253810614783 0.80112101346788256 0.39400469547578476 -0.81692818717984328 -0.071509140793766107 0.46696523635959686 2.3299045440648927 0.36852121608588562 -1.0459036868674745 -2.6739019083712616;-2.5792309517646763 0.34948523777048113 2.9823629758320003 0.61347267874497691 0.24635926176903147 2.4783725530083567 -1.3091424210530365 1.6109595769151634 -0.47423141311768807 0.39754746782819239 -4.6183177611230786 -0.92724392148882906;-2.8263633555157468 -0.65038457179843523 1.8427332829159304 -0.63120928488706163 -1.3328298026170675 2.4467294262396799 -1.3660117040709663 2.1348856793808908 2.3240118449184108 -2.6250168843187813 -3.5738865477034416 -0.26026212091433726;-0.7037063652140898 2.4320203818792674 -0.95959071619563296 0.80395261343810709 1.1122997681909985 -0.60124190679784872 -1.1604726500724412 0.062116751845264828 -1.3700653906203037 0.25540341768731567 -0.11809545341812774 0.29131788216926802];
  
  % Layer 3
  b3 = -1.590328613990867;
  LW3_2 = [-1.9075311726910773 1.1428827785362361 0.68238773767793026 0.06241539269478312 0.26519610917306513 1.9666888031619894 -0.94542998826921332 -2.3231411639695985 -1.5630184150683055 0.33615031081613067 0.18438963819743495 0.49246836952562539];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
