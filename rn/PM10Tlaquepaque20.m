function [Y,Xf,Af] = PM10Tlaquepaque20(X,~,~)
%PM10TLAQUEPAQUE20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:41.
% 
% [Y] = PM10Tlaquepaque20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.00773694390715667;0.00572573718866304;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [-6.931470822143841;-1.4831459103585398;4.6762249502444471;-0.078601336437296027;-0.080864186371486735;-3.4392500470763561;-2.1595915760689546;-0.81120307675268921;4.6364023771205103;-1.0773389745085309;3.0463652242469594;-5.6078164194490112];
IW1_1 = [1.9322432912129273 0.096524832132359906 -0.79010073394134417 -0.27036300580437772 -4.5432371599297898 -0.85005392027465632 -0.11274751167924685 0.43765185034182047 -0.31038527508491892 0.29533932656363726 0.80227910016627901;0.12414726269318155 2.7384138679653822 -0.38409763995941065 0.41379706926221427 -0.63291846255931128 0.19715705995739183 -0.088345910543538297 0.1516300397494825 1.410331467830543 -0.12529477628416588 -0.85180297673373073;3.1750584092139151 -0.053612288607790534 -1.1623515490035368 0.92856042457372034 4.0927271928970042 2.3746282833200389 -0.35602235630693196 -0.1738411212222403 0.46081308444694868 0.43314840475822053 -0.12324641531905479;-0.91718794771252121 0.014330309903237444 -0.35370794745750705 0.56769185865821981 -0.61424647226308682 -0.09923364056468556 0.049715779760100019 0.071293057698424145 -0.21293910488630424 -0.3071504684182067 -0.25429586102205648;-0.024246089993818942 -2.7018256658706536 -0.17729148457771871 0.41442740693215602 1.0272232021442094 1.3952878748934348 0.32751118458191497 0.41003362851936198 -0.23253768682480236 -1.6756998141638164 0.57316514373188243;-2.6648415009956481 0.18434281431724683 0.95452293406397981 -1.6516560844454427 -2.3217164948095115 4.0924848514003669 0.52947449856368789 0.48838285308129936 -0.40724713061512635 -4.0044945528893701 1.5707246842892024;-0.1021396199326666 1.8450849961141511 0.10267771750300481 -0.69704844047278547 -1.1787033147683004 -0.081883137421416854 0.11967677101351801 0.17577425567257268 -1.1870345916053684 0.23134556362158082 0.8083504845179541;1.5775497601377659 -1.4913198527838281 0.050626116545565369 -0.71192559910283826 -2.4905584379211794 2.3640472841448874 -0.63389885819195402 -0.32279380241657779 -2.4681798449492622 0.47885563809610787 2.7157120019226157;0.83005633828117942 -0.57323065406410811 0.16010041290969695 0.30151644169826719 3.8550809644189874 1.0798534620038516 -0.19398579613380107 -0.0087369978605435425 -3.378001661515122 0.40533917104923045 2.7407860938681767;2.693034320232643 1.8240040963022273 -2.4122537171848402 1.7018836774993671 3.232351434279118 3.8545574243919321 -1.9905504019859004 -5.2580245764860676 2.0453106219241053 7.6273695612092443 1.024708104335051;-0.89194822764013071 -0.036287084409515932 0.2296345391537869 -0.5173608611583923 0.60046982814332572 -0.89806223276876396 0.099704272731707594 0.056509421842515437 3.026847847462383 -0.025971378497468767 0.0077312083178776164;2.0749272117865747 0.08498148328293989 -1.6115420052130651 -0.54979379973071418 -3.8884779225349577 -0.3523730674637916 -0.38157889575216258 0.17810911462178836 0.80652113387000113 0.84048208580953132 1.1827579431328312];

% Layer 2
b2 = [-0.73663957968592508;0.68755852110005489;0.32394022721560045;2.0513762668030511;-4.4405035480438082;11.905782908937759;-2.3663415659165246;0.48239208678728829;2.2637417001472278;5.3663080357391495;4.0728015013976515;-5.147512104383499];
LW2_1 = [-3.5099696787769532 -0.86885255321621258 0.69351284669523217 1.1441905054135442 -0.51153909574515288 -0.2922069254535074 0.55766679084427362 0.48752612757917779 -0.1191547522378793 1.3553160147512902 0.90269737346774137 1.4944320318745115;6.1262907416875469 -2.7774753821591598 0.79129529949997679 -5.6823400412650074 3.3952080711610253 1.4642712337392532 -3.8532487174045724 1.0604088020416433 -2.8271920390436365 4.9442057943816842 -1.6001792578207099 -6.1774864154795486;5.178401190822119 0.79776278475240714 -3.1542205498525093 3.1653975603691475 2.0666121663460144 -1.7188270286929919 1.2544303270544364 1.0534728989491602 0.79448120532166466 1.2593220535547871 -0.87556250164087568 -3.5540073701606936;-0.18572527826985508 -1.4882805874886906 -2.4197421460799093 -4.6197021614531248 -0.29010630762911827 0.42373885797910033 1.2802785179117704 -0.029973172580844018 -0.039272153754794502 0.075201513521109181 -1.9300190084506206 0.97934997641862909;0.995797685333215 -1.9115387025886545 0.0011449603390299851 3.8527737699130871 0.048933299695434279 -0.69542926516384684 -2.5351959738280905 0.46896779701531743 0.51600300308851177 0.40249596631125983 1.9125021439034979 1.25948407680361;-2.22396749460645 -3.0875284308101278 -5.7886607607448681 -3.5941404749156596 0.36598930660343015 -2.7396250345133137 1.6352966878651098 -0.72360088475610373 -12.272436201265204 1.9329169690106887 -5.8036500129796647 0.59867408520226917;-1.8505152353039875 -0.51416355497925414 -0.65208743783757062 0.24547797890455381 -1.9998732044972878 0.54802893057372259 0.1061457202102913 -0.051122104052507333 -0.15920178210929875 0.23219939189458139 0.651723380007173 -1.1498628813001082;-6.8356699026746686 -0.81878912130461567 -0.048065763040354925 -1.4279823650101671 -0.0065613542289087862 -0.27441501254540945 -0.47421397022536993 0.19544856683689765 -0.87739070035128852 -0.44923206337559191 -1.2532361188601675 6.3901367370277482;0.75668074655473894 -4.0463463331973761 1.8543047923742577 -8.1476327849748564 -2.5128326446290536 2.3725819626287881 0.33808083836097785 -2.0759587505261612 -1.542816465899173 -0.49377138686632649 -2.2823262992697706 -5.8958429278402127;-0.98067271317096971 1.3756711644543345 -0.51078651877683223 1.8405604735390237 0.22183377254647174 -0.69334582202375594 1.9300791388445246 -0.58882942406174976 0.59441744857661638 3.2457857203671914 0.88586448129128248 0.99570893472448907;-2.7058062637745155 -3.0923481835177138 -1.4122710432950381 -4.5729727495632053 -2.6500554655907238 1.2172040766271282 -1.9091643381218515 0.75742128658805741 -0.40233153551322759 -0.99765989145949519 -0.35826112119504522 5.8247561815590254;4.0078963044204876 -2.5172990083716584 1.2053315023995659 -4.0915069755426536 0.077698662366787657 -0.44620173582120415 1.8723804426779342 2.9022783423455718 -3.7019752731785411 -3.0894861662380402 0.51446449416128603 -8.8866822586085785];

% Layer 3
b3 = -1.2083641634166029;
LW3_2 = [0.21345292535574645 0.11483535602678828 0.067456704894874986 -0.29307474359309915 -0.10173318805924901 0.019979452331265652 -0.13573836796130298 -0.12010689007742273 0.051144744547831487 0.1849144334053022 0.086983093549919552 0.081456454276758919];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
