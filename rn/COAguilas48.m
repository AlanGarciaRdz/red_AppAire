function [Y,Xf,Af] = COAguilas48(X,~,~)
%COAGUILAS48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:21.
% 
% [Y] = COAguilas48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;0.281968137600451;0.304971027752364];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.966845900215259;1.7607824720209067;-0.81912253917469258;-0.76948198246713539;-1.1369707769821276;0.3471649842429993;-0.65739594447427152;0.59210304554855486;1.1243043049132857;-0.14933869291503371;0.11811138932327925;-1.5303879489723775;1.4215570388721523;-1.7014496440857751];
IW1_1 = [0.61178675099209401 1.4141918667144855 -0.023975060906113625 0.2554873995558658 0.62306772307359171 -0.2396436860913497 -1.5496937962939594 -0.82890855908899619 -0.2309743210814669 -0.44577524875873542 -0.60932510499256853 -0.54842541294034719;0.24284386413207126 -0.19728022197905798 0.11191172033392326 0.095347130624627352 1.2816861814977865 -0.84865507879563262 -0.077554695324783263 0.51517522678413441 -0.63774778598782877 -0.037962301166464693 -1.1702445241044035 -1.1631177122291385;1.9674742105082981 -0.059740961320145121 0.32566060811671804 -0.89016638195309994 0.0061922201882312405 -0.050778802317370503 -0.92599291645059412 0.3419487547200874 -0.21705414746205975 0.17859269280374609 -0.22017971331235622 -0.14080646238008915;0.51518613482974884 0.58175407565021187 1.2212709992806805 0.23811222321803246 -0.94650814433383479 -0.64725376152143288 -0.44512074072333502 0.16131614662245097 -0.020797903595436262 -0.25067317631436037 0.70434410932384772 0.23980292702650424;-0.1166389726731847 -4.083436452809325 -0.0096413754722285503 -0.25534020331290957 -0.19170147540232901 -0.15925333792664351 0.23316947671241112 0.055906458818272095 -0.0050414848315608338 0.045608497562140568 -0.15756027332988606 -0.091762982873083224;-0.36428957507555126 -0.4377547079561957 -0.3719495278151872 -0.69551819068567333 -0.40341111258282542 0.54277608156768153 -0.77758195098402982 0.35388738543132103 0.014341889696916396 -1.5493817386369029 -0.53501899879507553 1.5206689887796285;0.64640656671319963 0.14495624321155637 0.53095361384099526 -0.56813850714611969 0.44865237664180019 -0.59373588046076953 0.49147474163391941 0.66568282523468958 -0.32463879755332103 -0.055287868703501608 0.0019025760121836877 -0.75582220844671966;0.065102477785990667 0.066979077295826611 -1.1143062487794921 0.61953571102430149 -0.33064193203773273 -1.1608990994971669 0.12871788328554326 -1.0613412119420145 0.19895316157081847 -0.62194709759787226 -0.60214023512461112 -0.091071501661985382;1.1255431915314447 0.12111621045844355 0.53168114128659538 0.69939681355028471 0.12707952101540493 -0.50479352992332771 0.15066996934957053 0.71736851243408972 0.42838707206034699 -0.13585670142066608 -0.044354489804728281 0.042924617740040194;0.63351376111373958 -0.7480590646421682 1.0286486694427088 0.22803767163710778 -0.8686173527485016 -0.70014195078919084 -0.25374165294496254 -0.59869381074054095 0.83319737945443773 -0.21231583021042405 0.25769228459305704 0.41517702090768804;-0.25192620110157182 -1.2190952399088939 -0.2166083170565524 0.21396781889516525 0.45937890350795707 -0.21917716530951939 0.038317653849839976 -0.62818963293392649 -0.16722421797336512 -0.12346303777400378 0.06900537118267551 0.057128372288179241;-0.79026238925635228 0.80038089746997143 0.72420461186866303 -0.74367506212431345 -0.92265193926565159 -0.29943820304519247 1.0339145136492442 0.028355766435536042 -0.323279269167285 0.52842513840200922 0.0064359458732692713 0.17951096209917014;-0.70976144143168063 0.10413929981009756 0.32114120737065072 -1.2104807532600415 0.62852312050847869 -0.66458088328266296 1.2879300254782964 -0.6792941401832413 -0.28284442551814065 -0.55874684710642764 -0.027196612529578688 -0.77073796897754254;-0.85138271805368881 0.12616346918227164 0.75114550138148495 -1.1485700674851396 0.42578112908789295 -0.72756952413922149 -0.27426998952040571 -0.046363999847987176 -0.73883468608715053 -0.38387179642638397 0.52159807805377512 -0.35869968729285634];

% Layer 2
b2 = [-1.5934695796117875;-1.3449958077529092;1.1246860106926309;0.79578535212020141;0.75620081269671546;-0.45354915210540359;0.2314969531196571;-0.24478472316924971;-0.72422107606320374;-0.39667034506909565;0.9927950192839563;-1.570649141530071;1.8294687801527512;1.5127292746825314];
LW2_1 = [0.75016479467767661 -0.18297268059635463 -0.27493137163780779 0.14658626787204593 -0.52504369044047339 0.91518945103292026 -0.28164619001569713 0.96447530530365155 0.28658263409337176 0.61274490185229136 1.0240478546495562 -0.34744955526126142 0.14363308305029987 -0.25014030111324598;0.12010399849274657 0.12635708978077603 -0.14197617256349901 0.32817603515617877 -0.49202023563404629 -0.66916023984749418 0.57303739988745983 0.081153659536880737 0.33741542302512806 0.66082316261930441 1.1321546482717741 -1.2947663412026968 0.90582737259871615 -0.35275973645092762;-0.18186828529585694 0.31897568831126216 -0.85668779133048623 -0.3432381236974249 0.039139019162692593 1.0690561282048641 0.11651519091342022 -0.6913198098905744 -0.43357983713950227 0.60673762659143127 -1.1655416641821308 0.056212349636523988 0.55364256549026891 0.29937911172072063;-0.33381640122272771 -0.37725823183073848 1.119240124853121 -0.94599222186877285 0.32119811107532004 -0.12021249337328124 0.15855948802055392 -0.75343875278897676 -0.11376799729081088 -0.60541932484348571 -0.74540082780765871 0.033025562607428477 0.4722662577427818 0.082717851700156789;-0.19942578772434028 0.4486468894026055 -0.22254220702913391 -0.58850879474004847 -0.74127593641518974 0.10279507230152876 -0.37492168363196904 0.72047435887086231 -0.32504405167646333 0.28978016865530587 0.52397045492192773 -0.74500093454483307 0.3691089035135906 -0.21839225020090991;0.87590481549665 -0.073085783706397095 0.35821641172497121 -0.20354780352696705 0.21885141055116 0.49704633701151257 -0.67420380452597661 0.090807806239153382 -0.057702124151839757 0.55911422194377658 -0.20556866283588199 -0.29597073570782384 0.27065694827357006 0.77497075790499304;0.33070272987971727 -0.10139111742379858 0.75602338404045677 0.32706464303409361 0.17660606377870447 0.35787945918325359 -0.1186823861290096 0.8787024163338919 0.89811824813502394 0.38099130563595718 0.54122098143309916 -0.063182208095218559 0.50096570704945531 -0.24777049170251692;0.49442637681855961 0.92675883841123863 -0.56892585943482199 -0.5900286837523987 -1.2997493629314505 -0.13363814005741237 0.88785679212732294 -0.91573355801344947 -0.70819654590734615 0.86546081820062837 0.4188494298461376 -0.10526087211132104 -1.0722933091449436 0.12515923670767665;-0.00031830175641659603 0.11041910456471286 -0.8544058869160065 0.29101262740341066 -0.95198345262137896 -0.98737646427899561 0.0033457817725364662 -0.82485411025905497 -0.50994392397240973 -1.526873447715372 0.49639676845548986 -0.14201832435261877 -0.57945447917148141 -0.58028081646621654;-0.50963527874301939 -0.29800680783409128 0.057976392064647421 -0.068976661633515207 -0.46866359617684827 0.59471967372577861 0.63233591381622645 -0.27943640148965582 0.48584544563045834 -0.34194752784889826 -0.091125918054392852 0.6996494142357419 0.91475038490392435 -0.79092083865260698;1.0406132469114648 -1.0727303178531598 -0.093296219368496858 0.19504141653580803 2.1624797444462494 -0.41055533885878193 -0.76705637855649922 -0.19203176755533413 0.04797539196737434 -0.19644505253241976 0.097696029657663538 -0.099236787124202336 -0.44427956060532303 0.42367116700847818;-0.14295565625536993 -0.40379901273733082 -0.96389384673241385 0.35531750063512924 -1.0697118944158972 0.56087013705571187 -0.70663818739269646 -0.032118495462804826 -0.12634452522608691 -0.14077526758469205 0.37234532033519269 0.63907771340714981 -0.41605616565658537 -0.50849426320100899;0.62468623488651298 -0.11194986614665706 0.2236712218893229 -0.75143636309784745 -0.16635740310089059 -0.50210598396167017 0.30457690919315666 -0.73201132593201657 0.9224348680728125 0.36448904881752048 1.3312110907449821 0.19764633051310015 0.8456665418793079 -0.56591797193666515;0.5461647477207483 -0.92900579076245093 -0.054931379788306409 -0.54219969444439886 -0.15470785444531282 0.13139432767047993 -0.22504454387456202 -0.85702926003179047 0.40245838505015835 -0.9056713495387545 -0.34665707644710664 -0.28647352669765791 0.041933555798429473 -0.8596558863358329];

% Layer 3
b3 = -0.50315572471936687;
LW3_2 = [-0.42746622223526337 0.3353623946401168 -0.69292039764032043 -0.090620949963716071 -0.53855094055811914 0.40015102151601495 -1.1322386274090719 -0.8818260571700004 -0.67709384330422295 -0.44267009656207262 -0.54217642108349307 0.51411826013071915 1.0397565922918799 0.2773739325216904];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
