function [Y,Xf,Af] = NOXLasPintas11(X,~,~)
%NOXLASPINTAS11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:48.
% 
% [Y] = NOXLasPintas11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.96825396825397;18.6915887850467;0.0175284837861525;0.0546448087431694;0.00640204865556978;0.138888888888889];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.1885317705860328;-0.12786536256360892;-0.4000361480122383;-1.341593138527899;-0.3557224673792781;-0.054606267169528939;-0.86940141844174956;0.28235317753881334;1.0898502519908575;-2.1216766770908699;1.0357484112938935;0.073884922066542832;-0.34571363627764307];
IW1_1 = [0.12701889363370972 0.12271854890016481 -0.36889401205092121 -0.61741612575510951 1.3619815490489429 1.3266331302379359 0.1553245141763519 -0.71325964446301193;-1.1055444575924693 -0.45442867400254883 1.1144670400888563 -0.37051066218608059 -0.87078904021150894 1.0881302762871101 0.069357798618149544 0.0072406197538470883;0.61498155378361252 0.048507627370836498 0.94778176066783792 0.55411374210590836 0.24644186138671764 1.1946836664573783 -0.020740817058815537 0.2682337169430411;1.569642950436698 -1.9394120687192524 0.05690834281987258 0.27768379989587028 -0.72521433762506504 -0.57318386962467582 0.37113214905137981 0.49994899168870377;-0.52962627789757832 -1.2133930155490584 0.14687920081237282 -1.2573496574422769 -0.4234645953668229 -0.48861203450952267 0.609503101819031 0.1478083389840443;0.0019644197910426305 1.1880834476127518 0.76376185548494158 0.60728407806398721 -0.64434290421778784 -0.74061337259936366 0.21173018496064316 0.057865036450180714;-0.27622323917805114 -2.1635909749036992 -1.199398169766501 0.061174303963185239 0.16561928299335052 -0.75152778448536606 0.33512022113452244 -0.48201596340133307;-0.080700351871373838 1.4196581329925264 -0.66073890450148565 1.3087654669671474 0.43156300796184416 0.69698610057484078 0.011329865817963178 0.48220089568007474;-0.955292152725562 -1.7632889841936781 -0.66809338212263558 1.5607150403104277 -0.26641037276629964 0.60603174078763256 -0.52174887245254908 0.0030016270830200871;-1.0397322732723466 -0.043946865958097867 0.64474437081575753 -0.51397655482474947 0.56509667033198896 0.51318918687157189 -0.37295560812756745 0.31535224433973791;1.449713147972866 -0.81900425434356716 -0.66302927504797793 1.0926826470052449 0.45769305367013907 1.101311669460086 0.39658084738610638 -0.49486373249197174;-0.84372043938430352 2.6200371523765309 0.42610585967572895 0.46853170050229953 -0.041943904747167346 0.113791336709254 -0.048448413791810738 0.22483142989444574;0.31023545484656667 -0.052927078803047728 -0.62667017884174925 -0.42879482229235177 0.29425242275591174 0.35137354732418824 0.40713734195808909 -0.73100031185234282];

% Layer 2
b2 = [2.9886445338522822;-2.480615125090301;-1.2252769968008643;0.76186777239903825;1.0211503287933519;0.044458057872787018;-0.18807074979544217;-1.1965722155339229;-0.30572099979411438;-0.041117392157982206;-0.07469237014002425;0.57981447491690363;3.133753028406566];
LW2_1 = [1.6623836405732353 -0.64110270677815007 0.22019222737970465 0.5429350898511629 3.5307280213643648 -1.951714056065541 -0.042180315258429628 1.7226187694273583 -1.4514067879472492 0.11875732319652034 0.61638492049085702 1.3503447411557121 0.15002459253503136;-0.75545536270030866 -1.1966923710981301 1.7233506407134396 -1.3066393004494075 -1.0932868710719099 0.66537813729885931 0.75160363602244973 0.59057532605306107 -1.2702061892731118 -0.33330348835145357 -0.036396897257410049 -1.4622319588046493 0.8371446187077638;1.8724178867228192 -0.37840334127734765 -0.6279084782973734 -1.0004860994587477 1.1520556832176683 0.54151619350878555 -1.5826797081111439 -0.19812908821103409 0.74988659666332835 -1.2456434735348025 0.74772569904701425 -0.47899065755511228 -1.5293034442131672;-0.0076003330982716208 -0.16428062526948128 0.58365770342747814 -0.51591876595033181 -0.32591283851696906 -1.4561096831845737 0.75830887979844164 -1.0747892153490022 0.36385505745520136 1.5666704833728435 -0.0073875156408299099 2.6360880554440005 -0.082186043445824322;-0.19952473885985197 -0.45407048345902834 -0.01896952067939172 1.0116858299449338 -1.5100769525719047 0.9236785676496152 -0.16766232345781293 0.42651311257491448 -0.79308853199111373 -0.29579476576666736 -1.1363465394521179 -1.4895519136982192 0.60354591289664372;0.76962789359633599 0.90528353574431364 1.2951323205890897 -1.1431788677011505 -2.2040089753941539 -1.9721406177302652 -0.11684085841329092 0.40034539958104481 -0.23498071562125616 -0.028895672220027604 -1.0430526473336992 -0.22357144060575379 -1.0334063754741667;0.27992754200158909 -0.037058070879978706 -1.0253419465198976 0.11200684792165393 0.91873281938882245 1.7155559428096563 0.49016297756730404 0.13885478703819931 -0.51867929655812473 -0.7301385556756409 0.54489757030549613 -0.48486021045476074 -1.0526713029086729;1.4517829665406681 0.35665265974732052 -0.44663701449046811 -0.50070783666691687 1.268782097699414 -0.26224126363941214 -0.15370256905804999 -0.16355608154008033 1.1257116686341664 -0.70634523487014211 1.1826351046929109 2.164818134484285 -2.002708265730659;-0.011167240903552936 -0.78931182726054649 -0.88964462654040877 0.87363292703778828 0.57912716026695843 -2.7235056462191141 -1.1785601434165025 -2.6824416623712222 2.0537261832650366 0.45107802793419194 -0.55469854846677469 2.9497985787432861 0.2312610067970603;-0.72522002890079507 -0.054265211970244698 0.54479933168364303 0.38437405290381427 -0.78129479905630173 0.29981482146971211 -0.24366591959734873 0.54632909157408194 -0.55359345053432274 -0.46651705107378927 -0.71690652348153705 -2.1419762001572042 1.1818097619255785;-0.10765388082316063 -0.65301524490740104 0.314658195240274 0.93835001660890283 -1.3997549208336348 0.18312844560862343 -0.16926801526101667 -0.16790193808913306 -0.42720914789360764 -0.58180110862914269 -1.0552051140053909 -0.53483964159622999 0.3343082898798197;2.1602096769777868 -0.76587870455686113 1.0231238756113235 -1.4848736747124871 1.1437872106835927 -1.6092086660798421 -1.2290216946348163 -0.9182233361319454 0.18041003038828068 1.1043896074502044 0.63337933203186791 0.37574593152082658 -1.3590819486449144;1.7728804349850871 1.417007478763747 -2.1934473364718508 1.7127131691065844 -0.54966119194867147 -2.0159240523882032 -1.6659105284666045 0.79512949799860388 1.7669516113588009 -1.4886624788869225 -4.5597403667180512 0.69234487402524481 2.4203714675350154];

% Layer 3
b3 = 1.3296697724625752;
LW3_2 = [-0.43788245517051216 1.3806474072926229 -0.72993625417785524 -0.94914689844163347 1.002035846974076 -0.37219065856596489 -0.86950502890556147 -0.64368155704427932 0.68246985689511375 -1.98840540646155 -1.1126995873437706 0.34159104189362199 -1.6530156557932849];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
