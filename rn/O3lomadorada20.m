function [Y,Xf,Af] = O3lomadorada20(X,~,~)
%O3LOMADORADA20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:41.
% 
% [Y] = O3lomadorada20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;17.6991150442478];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [2.3063769298084926;2.9428448288897258;1.7538307721078363;-1.3936976963060808;0.76875018917699411;-0.14680111775845464;0.10547557012926359;-0.0044341299532445304;-1.2910970482401429;-0.26661563833931451;0.099936800106310397;-1.1902173839290324;1.5588003025793753;-2.6612372572565053;-1.3451143657834457];
  IW1_1 = [-0.60439144437124359 0.18973293777468062 -1.323208249642742 0.22797453547061894 -0.24004676945332504 0.21762541527741208 1.9865527710946707;-1.795576095511404 0.57883208656055163 -0.73103370710024906 -0.31866734289003384 1.1901054918845129 0.66948719491209951 0.083599588365641103;0.84306983052954576 1.5906134091745345 0.20978706013610185 -0.63198397246340554 0.51643124026890608 -0.11693414091667531 0.20428173496976687;0.46678354938220762 0.42578018521965189 -0.87008605427990804 -0.50657209250582236 0.67332691019895696 0.13121134028561077 -0.86980102180596508;-1.2951243825697927 0.52124101668094169 -0.81401888156082614 1.0626580740519307 -0.12192883048845381 0.25173644875827333 -0.48591745737128361;0.70218227737848926 -1.1774529993732263 0.013449721501015127 -0.20996861957083091 -0.52437948670413037 -0.11137549928924573 -0.29766621685108341;-0.30099935616377266 1.4651529650271498 -1.0154975980078185 1.4880974557774114 0.024213220109339975 0.47113106194568366 0.26462368908606648;-2.0352863887353441 0.23538792319909183 0.73361603933028852 -0.20943369042227034 -0.16371732090639868 0.071482202642646708 0.61907958588408418;1.8022961118152547 0.24383008173607212 0.045621233749300182 0.15193064359017 0.23975044295649942 -0.13687128500213611 0.78770393109735737;-0.57786868801781954 1.8788578402335092 -0.69937765287890086 -0.30223746189767864 0.61897821553036492 -1.2763279313003157 -1.8568740278507849;-0.69073807031074619 -2.0541252656879965 1.0106326627259579 0.24517292914240119 -0.46234747061101389 0.50321511975726108 0.96872595029436581;-0.96855218570935653 -3.1377903428408596 1.0297809585192024 -0.84308180741541372 0.80595796408944798 -0.094157016091248213 1.2501746808107599;-0.058244942848290585 -0.18788862950158963 -0.86128901950790626 1.0367306536836223 0.27364013326219905 -0.88964139890004001 -0.78698582215089119;-0.13811684107078395 1.6245538773351751 -0.28573722224182568 1.0824817720900601 -0.60553572863117155 -0.36284903040905564 -0.84954874063754626;-0.63248548068448796 -1.0636742436789397 0.51740678950972274 0.61914122463837384 1.2174017080717792 0.28010654687961939 0.45884191793885992];
  
  % Layer 2
  b2 = [-2.469829568839859;-0.85724310648128754;1.1873354936615828;-0.92873016282310583;0.95400623696861986;-0.4207407531376367;0.4335536798828214;-0.43144177437416742;-0.55989308387678582;-0.12525763815052338;-0.24294804203241263;-1.5673391907378866;1.3062131175318434;1.7853695736348614;2.04525208227302];
  LW2_1 = [1.3724004970084842 0.57640082639950529 1.4023453217323674 -0.67917802122221971 -0.98511785841215815 -0.8996238016676712 -0.16745637241942879 -1.0283274113009255 -1.8986198074526104 0.29941072390550005 0.15541762021412259 -0.12870289579577854 -1.3073310613220017 0.50486223089091209 1.0682896782765721;0.31999634001457417 0.56880481441079822 0.87227043918163749 -0.075288834253279535 0.19589074546534219 -0.2889318087607497 1.537869255675042 0.3716059032652686 -1.7759413786108189 -0.018708565515802401 -0.11620802093190466 -0.49881634191937313 0.22352432532309391 0.21268655976061468 0.45557488871923096;-0.068773571552025306 0.22123067838340271 -0.5826296515339271 -0.80047773968198632 -0.49186588410549892 1.487844202045687 -0.99444344622382375 1.01349422595016 -1.1631120902350909 0.67419493439510314 -0.26046132591494481 -0.18311200423939103 0.58902099477559333 -0.13602135344089411 -0.29993286099757477;-0.033330733366338613 0.24185419086875626 -0.13860238981635925 1.5377562735481813 0.011773460261968648 -0.88727712073906184 -0.49571939144150334 0.63307062949415172 0.26253928387370484 -0.33186737871214944 -0.60471390822954774 0.034546498915332097 0.56952121006269119 0.87334939707143944 0.29043823685508885;-0.063152716650165863 1.3304203143398943 -0.39091816771899657 -0.47707387587113786 1.1104771355023235 -1.0135296645277962 0.57717774504796127 0.6170134829782481 0.5523054501809318 0.019636042700240379 -0.90969595420248506 0.73750698202825571 0.96809675154983332 0.50436808968549507 0.27536001677767319;1.0724507465498119 0.33126226043228402 0.99313390253677647 0.0081155481800422036 -1.1238319593289439 0.88223944294752332 0.42529336254795358 0.060284270746209609 0.84043644137420648 0.24447585283177217 -0.23008375706230821 -0.012089929717415456 -0.10350326452270445 1.3929052638878632 -0.049167055462146364;-0.28764603412092138 0.48865315838681367 0.86831961858057172 -1.5691849661624457 0.50857430361812805 0.17555198205970238 -0.38652571701699145 0.43924116983464578 2.2607580582224305 -0.063925884221966933 -0.60445741858568547 0.34980520675895627 -0.33994653269088582 0.51216562016438361 0.50924363808802697;-1.5186180835850216 -0.24471560406387316 -0.030608937928876909 -0.43750581054897519 -0.49213801965734894 -0.55488592691552441 -0.45179982934561774 0.74139899001336573 -1.0763445556804412 0.70745899733545103 -0.11138548029960965 -0.44591029125487652 -0.66452707720570481 0.5171791427925736 0.16128857224084284;0.19440989786345886 0.69463942949102842 0.74524702993979264 -0.4079526858263503 -0.091156991170936869 -1.1329426781401934 -0.32361895846148769 0.25770978605333733 -0.63787890451014351 -0.1227749375856784 -0.093574413844430548 -0.36801777384937023 -1.2722044701219106 -0.3487940184870969 -0.14094556162117;-0.10534446543250062 -0.18197901478873804 -0.010685106913007131 -0.82557938628211136 1.6519548162703002 -0.13449073079817461 -0.3510974893903282 -0.74071938404624926 -0.092375615415053791 0.59238712991174913 0.51281281771186926 0.33132383597749082 -0.41845003942734904 -0.50956136758231363 -0.59778369904987783;-0.64393146157739745 1.2900336812189799 0.68375227776435654 1.2211867448045843 0.8730012853780974 -0.85302979172583993 -0.75571524617240804 0.71481143171324057 0.78186944840604655 0.10895020570985259 0.096418002331266392 0.39328524923144342 0.60093890381948489 -0.47264249078599285 -0.62573598159970489;-0.0047298750487139475 0.83084033256084866 0.75370145743415795 0.54258722615158139 -0.49544353572611122 0.57854149724477444 -0.89733127609350294 -1.9517085791198594 0.31588328755162143 0.09260369476017502 0.87199372001916053 -0.54509530771492976 -0.28075573897161443 0.91288848491852126 1.6973260681068592;0.056638415156382758 0.15541979448403184 0.45326607368531108 -0.69310017949387726 -0.098710146958839229 0.2920327964436813 -0.36002510204453042 0.18333721219650054 -0.15723297001201078 0.39854134159581278 0.41094386191902649 -0.88785907039560263 -0.32402487994000595 0.23285920829596671 -0.85786473749749792;0.33020460056294221 0.02555619473121469 0.30446936271368596 -0.84347739505061947 0.39850521667355382 0.035362224741039006 -0.30730529234258058 0.072318086958909095 0.47856006130190287 -0.15872936852850156 -0.80441858201681238 -0.60460810454100444 0.6403947422953582 -0.14044268799377529 0.28968316570779223;1.1903535849377771 -1.054574747992048 -0.9631841184361174 -0.78068068180422412 -0.059337448624987951 -0.70739171544829105 -0.088403370610449047 -1.0934026960645371 1.1736123339335509 -0.91223971244066659 -0.16838219376609223 0.3827575438029856 0.98754328354799648 -0.65402943004511616 -0.10831702991015832];
  
  % Layer 3
  b3 = 0.80974893788599511;
  LW3_2 = [-1.5508849273684562 -1.0311006728448326 -1.1073892499019065 0.85740785858780399 1.0156929847869105 1.2283075752905717 -0.62868293354955129 1.0939972987681905 1.9489542175362713 2.1857046892630856 -0.72369761716614167 2.097453889627968 -0.31010374586681266 -0.81307166767117689 1.8768346801412077];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 17.6991150442478;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
