function [Y,Xf,Af] = PM10SantaFe22(X,~,~)
%PM10SANTAFE22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:36.
% 
% [Y] = PM10SantaFe22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;0.00341273633199099;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.21487199738964274;3.6970677020096501;1.12855714628681;6.1716634169428506;-1.1224330440671522;-1.4092671803272359;0.53117006868952799;8.4981180137735031;0.011333888967842782;-0.28288302662801829;0.81585641763184269;0.19247354509852316;1.3572067054478016];
IW1_1 = [2.0904688379449872 -2.0368100123363746 -0.17035250271854835 0.0010865816516546951 0.21936315542718055 -0.2707235081940137;-1.2103675056142775 -0.95907600886822719 2.6819443024491565 0.59774122451794498 -1.2787854244592085 -1.6557228725838031;-1.0692520532116785 -1.6926350065559852 1.1489405100892673 -1.9704062292097448 0.69334297601283257 1.0607181710954039;-6.3185716333142237 -0.099048781561424909 -1.0209983202107995 -0.15623576342597392 1.2055992201973906 0.408611484139278;5.6664836839563462 1.0593794640274206 1.7198492110712311 0.32903903911175625 -4.8286312517944099 -1.1237950638451759;1.7229245213192652 -0.91452326164779196 0.60087022661170097 -0.26516881818940119 -1.2634789575387895 -0.072189523514712445;-1.065846289049774 -2.9480362914532177 -0.25670044670170045 0.53452517821127565 0.1171677065656726 0.13267344970471093;0.92538287680278952 -0.1407562080149255 -0.085149700332953729 6.8716453011854517 -0.051974378268647127 1.1388406363327788;-0.46077032638993498 3.1636545131877551 0.98708465740220941 -1.9302633784914296 -0.008113364051289873 0.012190064022044634;1.1289175668660638 0.4476570310785617 0.00043521204997138546 -0.54854150136449775 2.2279544847759709 0.24584092256451909;0.096735106483704564 2.8344255782323389 3.3952988871837189 -2.1344524476591413 0.50884859150539241 -1.0575828231209639;1.3436242197704236 0.95610523359353838 1.1885944709632743 1.3476525860728428 -4.2605104912574641 -0.71341861144208585;2.2315275197227056 2.4866209474315975 -0.054052215189660045 -0.67330475356398511 0.75047170397784158 0.022829705113691805];

% Layer 2
b2 = [3.3290573949407141;2.8077724454903148;-2.8167374463134065;0.50202135514507251;-0.53192086687674889;-1.0944299515417701;-0.062234586073405346;0.12555017882412114;-1.2950302095513446;0.7096650695646971;-1.3329014692734247;-2.125343563642367;0.24172565170421828];
LW2_1 = [1.9221447929828901 -0.16639012393014263 -0.35305893954925349 1.5761468695682452 1.6877317726265406 0.063003066216403836 -0.42344629957221092 0.88928438763388729 -1.0078632107578762 -0.51791209436541896 0.66538737945591475 0.8174247234937807 -0.50254171571646389;-0.58930336823696705 0.035317422304622252 -0.25209535347451983 -0.43278682194689599 2.0102662085839902 -0.038384084294729635 1.5047519239193909 -2.1703260340348334 -0.18329754901525722 -0.7550303879100414 -0.4355142183846451 -0.38735481028902663 1.6720238560562073;0.94636836346337028 -0.14202169617119809 -0.55582747354402517 1.1105920490707046 0.97514166775886035 -1.5737427545068208 -1.1283511480555917 1.72504022263345 0.58621275815515905 -1.7950149111385396 -1.9250010090165748 -0.94546394470819006 0.65316873955038002;0.29310084784998341 -1.7396771807758447 -0.081193507588982944 1.0632801719935556 0.58016606951550387 -1.374032650468318 -1.0827143653133309 1.3513100516063294 -1.4721225874176074 -1.6440052355498409 -1.0770886843757057 -0.15103577412967362 -1.5097443064797262;-1.5171644158290709 0.29245008552382212 1.0867261994055131 2.1002663647707207 -0.32107143010382982 -0.051662627947421338 -1.2951192972980441 -0.73028598239309417 -0.23438053487168214 -0.75251233096153203 0.47615459639888585 0.55680160501395515 -0.41171433423054382;-1.4573038940235514 -0.77144668634678604 0.10115537828860913 0.059625402504278127 0.44856966838103512 0.4388542981741968 0.73608993590073446 4.1884080819278342 -1.4436366256838216 -1.0738772065056874 0.094016672937342394 0.52810677266405714 -2.1044242811726201;-0.73718829082401616 1.4860716799028073 0.72382204172881459 -0.1372583600580502 -0.84842346736499086 0.069341366653371622 0.11046419533980692 -2.6963706234082423 -0.5314109022726704 2.1115037226035684 2.1734619575400607 0.77568254329892672 -2.1091811709278065;2.7805422170555603 -1.0606103576420713 -2.5469579898612329 -3.3118691220211987 0.20184165328649289 0.47166265607766666 4.3803033726501175 1.8581551526798514 1.7790705303410634 1.6997823844468942 -0.8928276044124076 0.081841858470341852 0.18639692299188584;1.3413226465534822 0.4644808211957695 0.11293906977661 0.085919598326971214 -2.326526102657712 -1.6068628206159692 -1.9289566279012573 0.0590042390231868 0.81356112181618057 0.96545278344769536 -0.061457733096482295 -0.26347560233549905 -1.3492707500375787;0.96595096909152334 0.78623720652554374 -1.0012819526694419 -0.98013377704674387 0.34675486694578378 0.21329141120372325 -1.492106934750099 0.48234122111286071 -0.92206189375567793 1.2071017982753873 -0.68025364720931147 -0.77356797721797477 0.86873931330314258;-0.22700606390058103 0.043505603663437628 -0.044381483278880043 -0.32505804717129833 0.15411683154445138 0.70091794790700634 1.6968976710888772 0.80253088813327378 1.1873542184524315 0.89721429170174094 0.40925074807944928 -0.48469519566097669 0.11960614539103299;-0.72634805569167438 0.25371503377357774 -0.38916925439728478 0.58791374598454904 0.25761798872367564 1.1722572085943959 1.8405847009216492 0.78779672299568959 1.3038621685505467 0.86022562003477177 0.30386094059246876 -0.54750564458585116 0.36875583732062395;-1.9578860037947432 2.9575836531872088 3.9240977228344334 1.6966377027200432 0.41960267066211154 0.88485143848449122 -0.21338262126094176 -1.0995472072181562 -3.1055228222108573 1.5497276027638367 1.3986557443760088 0.66092230720059297 -1.0902507535810522];

% Layer 3
b3 = -1.4313014597858162;
LW3_2 = [0.32659746770801712 0.19410976783284181 -0.44039257266414328 0.22854875279545989 -0.52671781573568555 -0.18135970055038197 -0.62043650240808523 -0.32290988552352778 0.18327993665265938 -0.16684738530045556 -1.975573238940268 1.9403552874187486 -0.025092520030692195];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
