function [Y,Xf,Af] = PM10LomaDorada17(X,~,~)
%PM10LOMADORADA17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:12.
% 
% [Y] = PM10LomaDorada17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.4384991738904445;2.994161361815658;-0.060614241229977314;-3.222588737557404;0.057045014730876004;-1.7756451714368304;3.5654973644685288;-1.833553558267101;-0.8209242632500614;0.72366444903982841;-3.6696891130098934;5.5461793769958598];
IW1_1 = [-4.7959330486255372 -0.12687883428729663 4.9499320391698474 -4.7876997325604167 0.37685382298060649 4.6860038378577853 -0.5847059111024443;-0.26772180193268597 1.5988195299835211 -2.4422693741948729 1.3639058733302374 0.62443997577503085 1.3055743737518954 2.8394941817051351;11.193122189014783 -0.10515733396609357 -5.1015771232655762 6.7461579250046722 0.12148794788904832 -4.1671972903261612 -0.075962532776281858;-0.86240886503265135 0.071123030373659829 11.677496029254009 -7.4211244821479649 -6.7217105305288003 -1.3346736138231452 0.39345427337185823;0.092767499570930639 -0.26883851889761318 0.34315288724137605 -0.18736993259226403 0.25973612704418253 1.2722747892611328 -2.5395094763756552;-6.443329976294752 0.49956213058743687 3.0750201972952893 -2.9498702029613288 -0.51974850799609862 3.3271348466864241 0.74132653282875727;0.26466952319353854 4.3946790062397447 1.156600351709181 -1.6564362007284625 -0.1883557257445829 1.0044867645812774 0.65104842012159325;0.40843801904532873 2.4887770189261298 0.13232182544036478 -0.31657377296233802 -0.15518847682384115 -0.50414174723768423 -0.059923662148775328;1.443001021961706 -2.4771413068693966 -0.24330344613755728 0.30056730259471953 0.18381746785899733 -0.58154438005320741 0.58233964728201859;4.3391097502136304 1.8490602570393782 -2.8783030581331999 1.9079207322669967 -0.34028644059615909 -1.0191538197527388 2.9663699199986766;-0.31949813254326676 3.8439402277210384 0.52264599883197205 -0.3716822985333082 -0.25858445243390893 -1.9939205284421062 -0.046026073608530262;5.1528294557845991 -0.25069046586735877 0.37699951295429135 -1.5940584490781935 0.69551995693071333 2.6189331503636302 0.088351617258282986];

% Layer 2
b2 = [0.78665372456113958;0.0096057779498110174;-6.1085838623638207;0.47774587855350653;-2.1129636994466683;1.3480089415926673;1.225397187734687;0.89006393685243146;-0.33054708110931086;1.5189513873704314;-0.22802027605560959;0.76860304035557359];
LW2_1 = [-7.4283930984854436 1.1983840629328009 -3.6749913577666655 -0.60808873461921364 2.4837536946176306 1.3085297034463208 -1.8993990377251104 -2.1397245295755196 -3.5242610303539825 -0.17248107725588546 2.7448450961200583 -1.2521549685943794;-1.6943161421872848 0.63348324594896865 -1.2279727879104887 0.68441239968173118 0.76187158000091948 2.1871222414905058 -0.23862547194707148 0.12278379251248257 0.13563173887527527 -0.087337426094545118 -0.39051709876411783 3.0565462654307263;3.000519598899031 0.49665429348437484 1.1557758652496861 -0.087460278032689631 -0.36867948512107451 -2.8319946200838282 -4.662916071391229 -10.064208849408031 -9.7726287670617893 5.4909416302555272 5.3240455921617116 -3.4159090371478191;-6.0506361215509061 -0.50881594471073488 -8.3917938142772428 -3.8326853731455057 1.0820429114389116 5.1023010076983129 -0.8791579729037674 -0.30537803603473823 -1.4689303492964891 3.3193701216781526 -0.043076447791145611 2.2080583622706293;-6.0485884462119648 -3.5251882613988492 -0.79869689559884782 1.7262218488520726 -3.3864463376112734 5.0852560340613753 -2.6412636553534612 -3.4986058980287127 0.069947261431124272 -2.4210460454272993 3.6666722323696974 4.2403719632499204;-0.21539707306654013 -0.33812544662874622 0.71788157538797481 -0.43696780985944572 -0.14706248201987976 -1.2082466396907126 0.12653780945288684 -1.2863674640306337 -2.0751767137484558 -0.87860342362592758 1.8024068734953131 -2.1083882943034773;0.23037683522143526 -0.010870103935344062 -0.83768942548815606 0.25817898459327615 0.098945904002761265 0.90046943462486828 0.39528156345529891 2.4467885359776211 1.5934338590489545 0.54741809506556294 -0.35879770426015389 1.2966376215246531;0.78796049719909333 -0.20848349218790913 -0.63188526269083056 -0.53852483529669937 -0.093350034865324116 -1.92760096496343 -1.1462845061661622 -3.70317314667468 0.49110776677507351 0.40680268447232237 3.0857289635035441 -2.3000584284132293;1.0822193779002525 0.39720206859068052 -1.066637936852491 0.58421547935302554 0.43090775559879102 2.324780856138382 -0.80193792332714497 -1.2378695090083782 -0.524560780095774 1.4554723030520198 1.5176365729909955 3.6918556003594851;8.9221456319762922 1.1453330976697322 3.4977092303358375 0.76485105942782239 0.019563230900425319 -1.9461179955795549 0.95577728730419409 -2.8240865368700971 1.2263908322090573 1.3938029369774187 1.1462466262711095 2.9920003068070793;-0.39459446110087226 0.58312329307593702 0.41541567570151422 0.047219457258681444 1.0565711571978724 -0.2745238125032971 -1.4847219245318426 -4.2085412504810389 -0.87120705473951943 -0.50003184815797042 1.603070834745008 -0.15328612580607623;9.2300902863406247 0.020102547704012978 3.9057510116823382 0.17901238121206126 0.75666628611442044 -4.7827698047137499 -0.52731499047069263 -2.069862758954601 -1.0750868512893537 1.1565427324505599 1.0396047509221666 0.075020759034591461];

% Layer 3
b3 = -1.3398537551233782;
LW3_2 = [-0.03699413980980417 0.3225328899055302 0.065923557139491565 0.040853057741686898 -0.042128954378078384 0.24750143957714357 0.31036561823187053 0.14470538885719522 -0.1703299632880822 0.46691326304681402 0.15183646221295313 -0.30365481263148519];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
