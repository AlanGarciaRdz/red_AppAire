function [Y,Xf,Af] = PM10LasPintas22(X,~,~)
%PM10LASPINTAS22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:31.
% 
% [Y] = PM10LasPintas22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.0251256281407;14.7058823529412;0.0179856115107914;0.00280033604032484;0.0558659217877095;0.00576368876080692;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.5698438255807456;-6.088074681517484;2.7545791740341388;-0.55111790931646465;-0.53882204640486564;0.59522902798284161;-1.2822735511909753;0.33330511760002407;0.71122579530124186;-0.27244731246955128;-1.300581072575641;2.396621647146298;-2.2387913180077228;-2.088169599172228];
IW1_1 = [1.2031347110065198 -3.8150967582222535 -0.80038461564720964 2.9418852614150377 -0.05906785273283318 -0.20004158205403572 -5.821435756886701 0.48658205302925672 -0.67139655159927092;0.36879361046279024 -0.43314596979716985 -7.2113520403427511 1.5107021460219194 -0.22962821883825468 0.36429784739610405 -0.55535223715620485 -0.020021566854957037 0.65649068417675216;-1.3762559866677981 -1.0878223815141652 -3.3404185646755029 1.0907682305505357 -0.96178236629068614 0.2220647567383931 -1.2191843699963301 0.85043742458270066 2.3616622105805556;0.15366879660799704 -0.73216934114560994 -0.92663543481926236 -0.15400403179344582 0.094200700925524336 0.74159605991217081 -1.3843356328265939 0.082051151187150256 -0.5090213764049808;-0.21148334778624134 0.82710219481248659 -0.27018810174696295 0.29030336732365464 0.041352290444025913 -0.49039156442404119 0.81362216404023213 -0.01851323809464233 0.016431289090432441;-2.016567831264414 3.0463038297457135 -0.49488825730644687 -0.65190905211463335 0.067743080485955051 -1.7793491491126288 0.8948735533110147 0.95571008858958062 -1.4646082483638105;1.0483779875811128 0.3827754627975794 -0.93936244317885675 -1.658195412347695 0.28497420887547043 -0.91128185818850782 0.77389770018522008 -0.077792994845774274 -0.13493459732381191;0.34870233290009417 1.4850858783158765 1.7030226114225453 -0.73745859321035945 0.4465234454747305 -0.73647355021169569 0.38856353264118559 -0.026484240635827459 0.033203057884427754;-0.41768334698825837 -0.74891790057165464 1.1839740549556079 -0.64481153456248763 0.57131728953381311 -1.712972691983468 1.3978601617916921 0.0045329818070377649 0.72609810520522455;0.66522856877030523 1.6504840927010573 -0.022722350784318408 -0.25865908983837199 0.31085751201138662 0.15321893702012279 -0.35797022575809567 -0.031335925964156609 -0.51258937041261365;-1.2549796933833384 -0.90510633947719432 0.10905699392966457 -1.210237348090681 0.97013247527255886 -2.0615549242694726 2.5471129498789185 0.15952350302699367 0.78439922313677457;1.2027647506897607 1.3700046132869659 1.1575172146769466 -2.5515044133155156 -0.45630213140051296 -0.47507769791136317 2.8160227339466104 0.6052902163176046 -0.43146501035548612;-3.5435524466906942 0.29507665880415057 0.6652078047020602 -0.35935945336757413 -0.50866420590385197 0.56585801451533269 0.24737867830292096 0.20020923557839748 0.082583706239508725;-0.68314556641825852 -0.64330375713795596 -2.5706246911560267 0.57850814789304439 -0.5173938326158205 1.7349030246541421 -0.38430112974245206 0.073333343244206831 -0.44843785434498779];

% Layer 2
b2 = [2.4268179454216456;2.5366247730760194;0.36086702400617354;0.73542814894895647;-0.8566840797723857;1.2658589410336805;-1.5972921705762435;3.514382558118839;-1.1999502875235581;-1.2755301956005511;-2.0417101128838371;-1.1356207686833297;-0.97387014837632024;-0.80142499512757714];
LW2_1 = [0.10857831966766102 -1.0748171747494468 -0.12503566740208194 -0.45651545982582453 -0.62867836215185302 0.23882583068974086 -0.73347911104506414 1.1998909182525088 -1.2734165035459379 -1.2245186960162411 0.60260705250436297 -1.1112258700366153 -0.27721040279604342 0.13783456907512909;0.20955061477211689 -0.85549391895389282 -0.25793913547721475 -0.031773901067180539 0.17340531518481858 0.1633089499065413 -0.89194611921274625 0.88939513851727336 -1.2360808322667187 -0.97157099160697169 0.45454407688866838 -0.32951519864341716 0.6417328880270311 -0.25203341237421112;-0.32714624888308835 0.58733659348463874 0.38160547813926415 0.62668203055565164 -0.56585465536314183 0.23915353377969462 1.2154087866092715 1.3818461393434349 1.5694599904359847 -0.62668540033762687 -0.43220222919667761 0.33692904728403239 1.1835327075243771 1.0401969840671152;-0.088620478138051309 -1.775873627386134 0.69087519118132135 0.18067243870401345 -0.77558710350716853 -0.62269228690632406 -3.1415044194212469 0.57700887879327611 1.9167933195477043 1.4468368044080406 -0.083564723281378289 -0.2723398959035816 -1.5645470063689377 -0.95235073351728228;-0.60125825969463709 -1.1257427271809723 -0.79905768990305415 -1.0033820644007858 0.63333530744068345 -0.2101296232519457 -0.54751711256563296 -2.5092711598405946 -1.674940878323711 2.153496529620305 -0.31132442562512941 -0.21934744047648388 -0.56951325565224575 -1.1506025744215509;0.094415343046672318 -0.40317500804504708 0.047419749975282255 0.44346607597995413 0.47985407387219414 -0.81321936222240976 -2.5523096352103023 -0.45518441592645992 -0.70781867349280092 1.7465152539835165 1.878507963558792 0.36962605067255561 0.13424601665998087 0.17035520811583149;1.1048847054258542 -0.93303396151653595 0.045329121311495912 1.2680036671074539 1.9898737538122173 0.050926862860283813 0.74159766742214062 -1.505696313561383 1.1468260933482797 0.59562763627269466 -0.61255598379546772 0.13404648054376875 0.41763208159919396 0.60623799469463557;0.55042785923577464 0.68032477868161034 -0.12242566630861797 0.30305199221695789 -1.240648420320416 -3.478026639377267 1.1377834725746785 -0.12899761881497604 -0.16331831208557201 -0.21244410798137042 0.35785242474213386 1.2856190618371159 2.0329205080984423 -0.82319765561686831;0.40210386122934222 -0.81254884590067289 -0.16459939758370146 -0.38386033016320076 0.824228865702053 -0.3607809547488901 -1.3376229716411474 -1.7533546410022709 -0.85264399785070077 1.3753947644869253 0.30697326224620719 0.17807133648290877 -1.14278740161597 -0.8384427474144398;0.34271174920257835 -2.0572350333689355 -0.36324974744337912 -0.38690004145881962 -0.76611890490929091 0.28321453473245128 -1.6636812636827203 1.0445060518354148 -0.0608240445933622 -1.3721301375997652 0.14744688560170047 1.5365760582737236 1.2089646273928583 -0.30437100823152813;-0.27367695452391066 2.3429773259944588 0.35163786647150391 -0.30130121340255284 0.68111243465916982 1.250457628420842 3.966655125403372 -0.17337721616177471 -2.8346441997143894 -2.2639181180877337 0.27255436289375878 -0.14228103600712036 1.8390611447107927 1.1008678354446524;1.6794062006282131 0.60361144674096456 0.46729797131294282 -0.82342090849582372 0.69375197081212014 -0.84628138588919122 0.13381871246167804 2.0481670651854436 0.13987499824451471 0.70436505709917419 -0.6438422304857716 2.1242563975527897 -0.18237890705805831 1.8214403759758611;0.83910815381743109 0.80490016317772839 0.24304655033808661 -1.221546956915929 -0.19012268040202762 -0.41066279524035509 0.26955843333735391 2.116755479723639 -0.28959440207526055 0.6040840242642862 -0.39816667387205923 1.314446491934556 -0.11285183645707017 1.6430692613568187;0.86654739455575325 -1.7021256208951123 -0.28591256104100532 0.73461972287046051 -0.14660634213969004 -0.020573831782347701 -0.81673169690066849 0.90472081079652145 -2.1610571850611122 -1.5147101064022581 1.0639273721939151 1.5339655803421406 0.24978207120180743 1.0168072927252167];

% Layer 3
b3 = -0.32557694299862394;
LW3_2 = [1.2340046314624105 -1.8122931671593474 -2.0442657967727795 1.7918079711020591 0.33753885543102935 0.25257697263254586 0.48459096817577341 -0.38875275588684477 -2.2907113608193854 0.51042132752850933 1.46085054759585 1.5221841603768058 -1.5647740932343677 -0.22456718330347203];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
