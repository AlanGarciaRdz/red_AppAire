function [Y,Xf,Af] = SOXOblatos20(X,~,~)
%SOXOBLATOS20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:42.
% 
% [Y] = SOXOblatos20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.2570699925226414;-1.4342269152186617;-1.1196087191682691;-1.7289244537933652;2.505151310292753;1.5614180094207482;2.1262640419348289;0.28582908672528201;-1.8006138467875834;-0.46003307139688909;-1.2517383668824591;-0.87542370523939206;3.5127694598706412;2.268691275653222;-2.1644069423733421];
IW1_1 = [0.96430952989874974 0.60779118915649988 -0.23337862617738231 -0.21542012828269191 -1.4866402669328553 0.80812449903813544 -1.6043762007658262 0.10784270448276032 -0.23073680237781768 -0.41708871299043271 0.69385047852999371;3.272412075138905 -0.41387946472152015 -0.29267059081247493 0.22587270275603316 -0.75655595342467763 -1.0396662621225654 -1.405288563170926 -1.6433400814432237 -0.15682236189183607 -0.33777555306407203 2.7322286323874945;-0.27890656400050295 -0.32753246490379095 -0.80517652019858943 0.34535554883592373 -0.52781602982794873 -0.37521909981723556 -0.56109891967420999 -1.4355035306868442 -0.13893554026730953 -0.33825695052853255 -0.59176125666910107;1.3476640863728866 0.27604220156347908 0.75397914297528279 -0.034192042980866241 0.3417463014510001 2.3729376469472498 0.92255804392077856 1.4274530477129759 -2.0682707796050073 -3.9127148656087201 1.3866467605264516;-0.22637505437786859 -0.42863620173407879 -0.64030994288258591 0.095489600987835835 1.7475987248399276 -0.95537178954083268 1.4361535548903268 -1.509414333047103 -0.98261805531106905 0.28883240525798576 -2.8857226039105477;-1.0038205638162836 -2.7422010304207149 -0.93079407410064385 -2.2730281748316203 0.68946907623610443 -4.3622461414091047 -0.19187129187440374 0.13825061523354271 0.61215838803219258 -0.51276642682081086 3.6290528817307957;-1.614747943495296 0.29835796260403302 -0.49576780728267877 -0.050355583042726741 4.4205252319142749 0.40939453642100171 -0.65949777969750556 -1.5697025055160745 0.70412755541316996 -1.0230495155742221 -1.8739128238763125;-0.204521630246917 1.7038976008331708 -1.6015941056512328 -0.4937116772649261 -0.48934352304445661 -0.22070207809684522 0.075667769656086459 -1.5971800236495275 -0.1657650355361337 0.23356534069736062 0.16020381667792372;1.0604294798196023 0.20161374952413089 -1.7789487593821429 -0.9425410832495712 0.34377897720832928 0.49888116869937238 0.5795950447996282 1.3731085685282922 -0.29442834956349373 0.28102086030960255 -0.39064261372786868;0.32925766346711804 0.60209268311409248 -0.34127677899480829 0.16301633640676086 0.61080871437304507 3.4258533936119937 -1.1886810554095677 -0.23776673178431781 0.27193978813567132 -0.28608004466410419 -2.2133878465253285;-1.3059573594439191 -0.068577266460546002 0.94831534214131707 0.10848673877200923 0.31559546416876277 1.3381086153683197 -1.3216228034679887 2.4622349000409649 -0.45407868534425461 0.80626130726885503 -1.0705901473858936;-1.7115284123301622 1.2179912603346439 -1.574582408727013 -0.10112290545179337 0.1060024024871557 1.1181346849512037 -2.1874107992627039 -0.96570562219788914 0.060397297847047289 1.277570521131272 2.946162643051462;2.9914202619061894 0.03157332793591977 0.84650753486014441 0.96826328372577097 -0.23483620355214413 2.212412639995732 -0.61940396571560685 0.77868152210016028 0.0085496714068672933 -0.02919481751548423 -1.650427595949798;0.35758086385496457 0.284551549879966 1.1960947277028902 0.89113788295727603 1.1616041384825311 0.099485032955955191 0.21606429852790743 -1.2350633152923924 0.69745864005169611 1.4514374592375381 -0.28301878033216776;-0.32457034823373404 0.15454473676791297 0.7984493617521351 0.092272030103529828 0.38349036034078754 -1.164642664566143 0.31757236927827442 -0.80493115652930036 -0.76016535376714667 -0.062652456537592049 0.11884188101826913];

% Layer 2
b2 = [-1.7507625289280873;-1.4452315982561041;1.6085157995055903;-1.1923467098547491;1.9054433158696318;0.69543210802155031;1.9680238548426447;-0.42912526296803571;-0.67551176411123193;-0.96822280871046762;0.73017835191385383;1.2536491323362027;-1.6034860696813915;-3.7497543977640486;-1.6989288305092702];
LW2_1 = [1.5245336335364392 0.27334863145811894 0.93504906128693588 -0.94734920407078838 1.0032746182086503 0.052707355442814227 0.82807483457259423 -1.0844958758805956 -1.4027110428272536 -0.48438854475985649 0.36012951071121563 0.69396530580089122 -0.92419983612125023 -0.22266788925813874 0.18998663756470835;0.23082478904606724 0.21658698596255188 -0.51701056345301999 -0.44903560433803547 -0.099419308001403542 -0.50635467477802831 0.15915490488978251 0.3743464912692393 0.22173064554252567 -0.67043854443742812 0.65756880189867406 0.57585265847739531 0.47867513512311349 0.63396166989082225 -0.18131838159367078;-0.22243042887418152 0.74662389481450364 -0.27804356925273349 0.0515248525687141 0.20291221955084771 0.0055556272331956924 -0.32327392253581261 0.22325707112847779 -0.3183582643433317 0.24550155421079281 -0.052891832115429707 -0.047544504605073132 0.3299742380195253 0.39491121222586778 -0.39071137868184957;1.0551440055986148 -0.18063552372056843 0.33383252425685378 -0.74885266581798537 0.52152234324981372 0.34634705428664858 -0.66714849248208885 -0.44046210735848257 0.43880565690909917 -1.0557986110047968 0.46372755504820495 -0.74574853552586118 -0.083389400712831852 0.42451076337499682 0.28066656567375553;0.49261967747038354 -0.38888872284224235 -0.22525834052038979 1.0881560400203809 0.6178318402470907 -0.48842490976053754 -0.56473219679686071 -0.12278024938685722 -1.1436983041404063 0.10986557054720186 -0.47478678557262366 0.080063902578228291 0.88147930359010374 0.92528276434313339 -0.4298001737328499;-0.42191520566541429 0.14276715314980182 0.1380841048600662 -0.41523839000349205 -1.1573289610976922 -0.080107186893542529 -0.30814265691095044 -0.18787737711251989 -0.067681821692628236 0.60750131715744626 0.46306088816196789 0.042053334192992453 0.14193758363930015 -0.42113334337550479 0.49425884699018308;-4.1281743488077618 2.8954549048738611 -1.2264995176353608 0.67453242816315007 1.363860406979402 0.29687802863095908 2.2591264845778598 3.1302487888574677 -0.10430171130918209 -0.94332531722475765 3.2676168409152417 1.8566483050505043 1.2287145983390755 -1.5232749017060947 -2.114269357729063;0.2918333855134761 -1.1762291617448781 0.38029559472793273 -0.60849303340689298 0.43528288065490411 -0.92600566281487628 -0.76336564114901728 -0.93040718280099632 0.57112559876599878 0.053898512348152176 1.0041328874706856 -0.892466435582141 -0.60345527192643456 0.53216407265410315 0.38774158756871302;-0.11799820097242117 0.14153584463308375 -0.64110637546212945 9.4486637977592158e-05 -1.105119626076704 0.59630115102303649 -0.087378388774073196 -0.83595518438492844 0.80194702789102568 -0.19650804988275428 0.60521376261150661 -0.14844945146058108 -0.70987814022353934 -0.26818788241639413 0.59027469417184986;-0.054972381710513496 0.60863357213463742 0.96454730508921227 -1.2532034317941956 -0.46102474676944905 -0.13936962791341279 0.0024884166058588043 -0.23889014845029546 1.8234524616966492 -0.53857357962516184 0.45498145638270898 -0.23305055249637652 -1.0293371088862746 -0.22994784070997731 0.13670624168523562;0.97425868467587518 -0.44010908832492573 -0.18028758267963102 0.92232256702037796 0.94386808470346806 0.098293969610487933 0.034711375383584174 -0.062924386157970608 -1.3394602981764383 -0.79669840158762772 0.091129910884042833 0.083023738714646772 -0.61941673624062754 0.51028429652965779 -0.040143731572824873;-0.55677300337455793 -0.036365570813338167 -0.34235906604417088 0.19175609811585873 0.12567965014093174 0.4569672859635508 0.47687720528600042 0.88745727585311907 0.49834424411391459 -2.7384934141603661 -0.43179236152617634 0.13623285352983799 3.3865367829385762 -0.040884911506756147 0.24581988217932527;-0.19670791419259681 -0.39349056904305973 0.54505496728162262 -0.055889569944419244 0.97872361342978087 -0.071506388840459123 0.44550742507306157 0.28739869900379633 2.0995946186761687 -0.52551114188947279 -0.97085469334557695 -0.15853732230996007 0.79664198731297409 0.20428398094466266 0.99447204466905847;1.4246304461860073 -0.96346730556635607 -0.58640184957318953 3.5336005208089758 -5.7343756211844576 5.853017515088685 -5.5707957117165483 -1.0694649069691704 0.858333166691299 3.2690110493719726 -1.4065943056187293 5.5061101086853874 -0.16776803922925024 2.5629224898738707 1.9004524730678902;0.5796340861940652 0.85683651130991578 0.078887874226715837 0.079015315531320879 0.133859709992249 -0.16468750958405326 -0.38027290952790144 -0.6320810806171917 -0.4850150499273056 -0.5315274112220828 0.23459881716217731 -0.71380491727878803 -0.63205595102461765 -0.39042368696244056 -0.22303309462715598];

% Layer 3
b3 = 1.5640843026809266;
LW3_2 = [0.060796068795815124 0.014500822916984478 0.39179650445097708 0.086282869420769764 -0.14813107529294051 0.1430118292341023 -1.9175772411046077 -0.041106904307682927 -1.753869000784007 -0.14144893284414753 0.069514521943633736 -1.6394185844847913 0.13572855938555495 0.99240516135831636 -0.070094057753089731];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
