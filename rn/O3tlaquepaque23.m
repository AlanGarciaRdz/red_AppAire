function [Y,Xf,Af] = O3tlaquepaque23(X,~,~)
%O3TLAQUEPAQUE23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:53.
% 
% [Y] = O3tlaquepaque23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.171659085057077;3.03490136570561;14.7058823529412;15.3846153846154;10.752688172043;10.4712041884817;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [2.079765765553073;-0.9152141457671279;1.9087568297377742;-1.1365719858264904;0.10845643715655916;-0.16478220976615221;1.0205326703632163;1.2800662143145378;1.9898959387712736;-0.095376178709418419;0.6484888540864624;-1.8732567447842878;-1.826690444807719;0.79487758867684732];
  IW1_1 = [0.43831968463541676 -0.83529981169849155 0.9293472926369597 1.0817031311561303 -1.2065753216548685 0.31619759591595842 -0.148366864163782 -0.34829003835121602 -0.27599032318294142 1.5373326311554714 -1.2355158025340596 0.2532306593741841 -1.2091526149223588;3.1201088113007573 -1.8329438042342179 -0.8958440613997406 1.0739891613754355 0.010639635968314866 0.19812938706588737 0.56600307628035762 0.052144417760451242 0.3739707156885001 0.69049907303932123 0.91729369763759638 -0.053786254110096805 0.64064549646681368;-0.51493295174899223 -1.5777673184723469 0.42288480676457918 -0.54446371938659244 -0.29104282229683975 0.25708142411566098 -0.93101430830751575 0.1739143556294549 1.0038774523942504 1.2106473668002842 -0.17891987893104508 -0.50264148243557694 -1.5262311088617402;2.1217665434205011 -0.13535740896345458 -0.22454181386298172 -0.036436100487312946 -0.80243678705542687 -0.54389800047314074 0.42560907202073839 -0.32417040050754709 0.083297463049181106 0.3146720886774359 0.17190826084575564 -0.43163163580623676 0.72843563545750123;-2.8307667101139238 -0.34464851657996931 0.60496272103100779 0.069352719836955762 -0.42238518193026603 -0.70335379043319823 -1.0051815760471856 0.55166949019277678 -0.16812000648976919 0.24577070751710345 -0.52901338577608326 -0.15948754323254322 -0.72197753268185549;0.6482280766494023 -0.96656948111347241 0.75944809455644946 1.4850371172610954 -1.1736607146575126 -0.1462499559311318 -0.0032191829375408688 -0.78252339656211012 -0.14102447008490049 -0.86145657933248088 -0.80606580659751803 0.5122926090452391 -0.14408653314142222;-1.7008549417057857 0.13619493016133016 -0.81900479395829862 1.0423168816521713 0.56313540371747883 -0.06250026851886771 0.049749542969449494 -0.54755810865184618 -0.025329797741438374 0.40754461837329992 0.61805441390148363 0.45727776354419014 0.13296742389178678;0.0069789696065965324 1.2625635878893262 1.542462516228932 0.1675653012681132 0.043895933611262955 -1.7732910558074297 -0.16753154785841295 0.43775468684689933 -0.084266411341980138 -1.1683110190386308 -0.58247562621186477 -0.67897467446840032 -0.24341012337115153;0.58899811753556808 -0.55206792480267808 1.4981195696546623 -0.1178453395296423 -0.33210133305868084 -0.40384724334182842 0.86083330133125235 -0.38338274240509235 1.8682222074880455 -0.74933647361684785 0.11522389153692962 0.065605119528677244 -0.016742669295297601;0.33041078809677443 -0.40172147706005201 -1.181557092329043 -0.44895521975393832 0.44931128577335633 -0.60283696521480734 0.74314602270773911 0.75963963562187609 0.011382059858170764 0.34349021163918236 0.65023300799373929 -0.13075922213469346 0.34317689259050188;-0.63567081258080993 -0.0062187221657141398 -0.22134628803107681 0.2657554102355475 0.41561562899573495 -1.7090262105225915 -0.13918724999223997 0.31529570374865667 0.72959021087578246 0.64748778498266957 1.443048509387028 -0.56020843668761766 -0.48957676206949513;1.7041285443695826 -0.055322809692146264 -0.37616541997260983 -0.39587331501809042 -0.14105123912193371 -0.037351521932832456 0.19175747065309243 0.079159756867795417 0.059114358141434391 -0.036545209720287575 -0.25131956197877264 -0.047706122450044422 -0.62151317009339702;0.46468560335272335 -1.6286112530300121 -0.18904985715111505 0.090834377112870346 0.73516495066538834 -0.3828879521303743 0.95014558381733039 0.24976019831680293 -0.68206743845112827 -1.0433997973011928 -0.3535121022141729 -0.04470856348390103 -0.96436777483646341;-0.053084684802604129 -2.9055574238197588 -0.94622036796643993 -0.2834592635062898 -0.33596762953435105 -0.36111004378406608 -1.0000824230138745 -1.2745114789360594 -0.19045621434076848 0.73641495829943238 -0.24013837398226279 -0.66003713336220859 0.46874550268088283];
  
  % Layer 2
  b2 = [2.0502309569904997;-1.8294888126931332;2.4538274982125254;2.229379290825622;0.28690401281524591;0.81023986669461801;-0.37304920735123592;-0.05410555114633999;-0.83823519178320838;1.6515023348063718;-1.0727578848980028;1.5843084703251344;-1.9206587434349853;-1.5075932958302938];
  LW2_1 = [-0.34687711309465757 -0.11451518525192508 0.57418292987620612 -0.24194609411836099 -0.2868385645896368 0.57122542232010709 -0.50900846118302612 0.19830793450911322 0.38373513510970253 0.78579810398488947 0.5633884291494915 -0.17706503842191817 -0.22215366316515087 0.41469723262294866;0.45600057856300408 0.70999923592191561 0.77895313623206475 0.52356735722675152 -0.29212021497170693 -0.43809152110498817 0.90478599085640543 -0.0543978541463895 -0.43567111451377005 -0.11660862720803583 -0.1594997068794575 -0.51531893448699895 0.83151106814316522 -0.60455978242946962;1.2691720036846041 -0.94017915463564661 -0.091912760678693681 -1.323074893582749 -1.2466975527458273 -1.0158612857846558 -0.64911304585403362 1.0730713944454449 0.089715994670324706 -1.1354992432075091 -1.474653594803607 0.22892767794811264 3.1781495997009852 0.6939580482953267;-0.36816113713995807 0.5164910637907959 0.22421011397319007 -0.82652405759714165 -0.57280581414045173 0.10301511903713292 0.077154348251765648 -0.21615391268767153 0.74396248309638868 0.95499893059185659 -0.46056707966572707 0.49885625346176654 0.39274855286518418 -0.27490510541014834;-1.3492792728286751 0.96356339073897945 0.0043979082155483074 1.1442555007237241 -1.1422264645601461 0.54944196613675822 -0.54516636213891168 -1.1868787647426542 0.11464462091225819 -2.1099920277388544 -0.22340462972292763 1.1743099570341495 -0.079577553691896979 -1.371689140496025;-0.71389450152507739 -0.85986328397237033 0.099042507686896847 -0.68099521458287993 1.258656464270496 -0.053888677383466629 0.58098508124882231 0.43530850075048094 1.7028084317265542 -0.44402305672070114 -1.0803220184341491 0.4430792120111236 -0.68127279298314758 -0.31323214390986387;0.31976348127807058 0.82577119418332534 0.47425811474786683 0.6216838664103097 0.26411502770304607 -0.31213524446888513 -0.043778704726221952 0.69666641512575311 -0.16175567225372306 -0.91410578752166083 -0.76819600506042707 -0.62504776890503522 -0.46020564404284431 -0.24148306680011361;0.32905359857290906 0.19120945212293861 -0.8694698173446046 -0.46720188446621658 -0.66115665051025674 -0.22744954284219551 0.36611852458620409 0.26781803102740348 -0.22162853772820851 0.29031884097302435 0.43308052469969716 0.055671199566849718 0.085941449206923093 0.67575462769517947;0.71495638691832297 0.78148079944137394 0.6897752754155354 -0.56982016399970359 -0.47295358714233482 -0.50435371036011767 0.74692382364584819 1.0528491601636716 -0.16352931950562152 0.014084911961867508 -0.078981359030387277 0.08984935742430572 -0.097109825387103513 0.38742505499185798;0.25719208666714205 -0.084881088452409964 1.7421761202091606 0.80689451727826556 1.249796993884315 -0.097694740520189699 -0.11512914714245502 -0.40186695844644738 -0.4078423174701245 0.4867404589568321 -0.72092846357103002 -0.11968951241741174 -0.78710013858493744 -0.5046885267678084;0.06070614790005107 0.50145091937418096 -0.43578032532665351 -0.0028278022340773347 -0.18377183799434321 0.58982388021907728 1.5478354717239642 0.68966889151506228 0.23378745189003247 0.80752528837383952 -1.2241240840107941 0.027861018669319067 0.3905665428883402 -0.27858164192769425;-0.49647180792817514 -0.36076153372392716 1.2291177820612313 0.69264813249597346 0.73748278632580322 0.65048652791469019 -0.87580472300512724 -0.88425787114734244 -0.053702262918391155 0.46658892558593396 -0.17507885522591174 -0.7577351417176893 -0.57209300006541131 -0.75477557491501968;-0.48286430623432008 0.093490649569525242 -0.8012807097287501 0.52248091912446637 0.21221537224046888 0.23889844069320573 0.032570555798994462 0.95753598358599512 0.10254680130675961 0.16276794857002316 -0.22018656289465391 -0.13667347815603659 -1.1046094824104811 -0.10168633420661355;0.27893737199738539 -0.04521879315720656 -0.49933439118187251 0.50214246524228057 -0.30009304736036757 -0.21008724613556501 1.1006232182292557 -0.22829705120232449 0.38584329686595609 0.80425149009944352 -0.19608756150881437 -0.36909922498837366 0.21473832535796708 -0.0056730080591836235];
  
  % Layer 3
  b3 = -1.1945299732436723;
  LW3_2 = [-0.80501860116767243 1.0569145242007265 -0.47589617373542864 0.51772258447547193 -0.24138909749545498 0.25106482402480956 0.83583240173361162 1.3143376531683306 -0.81706829305421458 -1.850117614246968 0.42635417059269887 2.1329197387539764 -1.8202682761252891 -1.2729219254080093];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
