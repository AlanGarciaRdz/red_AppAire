function [Y,Xf,Af] = O3oblatos48(X,~,~)
%O3OBLATOS48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:46.
% 
% [Y] = O3oblatos48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.100381449508131;117.647058823529;0.0560224089635854;13.1578947368421];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [2.5540200643146149;-2.0345201252615972;-2.1158418224781812;2.2669526951101346;-1.2975957944043435;1.0832463174723981;-0.95244074994798344;0.27908142627964178;0.51106179689280107;-1.720267291662926;-1.004152609548002;1.3491182921865787;3.0782628486421117;1.3432904676396651;2.898574873589979];
  IW1_1 = [-1.1090104481294851 0.91776228910821667 -1.6083007828176357 0.92073508322615116 -0.58694431711202255 1.0372311038343625;1.2362565802176686 -1.0413247349481254 1.0137579511333705 -0.63407593128146689 1.932682241430548 -0.55481655134873709;-0.59120334549151499 -1.616520830108767 -0.79016313825669493 -0.3118763921224319 0.10608635964756059 1.6445570697158989;-1.2798856748805028 0.59049812311467553 0.96751990648955477 1.4949805634332283 1.1625647389566822 1.303172918210036;2.102784057047614 0.28873119177322804 0.82837819096335208 -0.58687161091016671 0.17913274439002708 -1.1746942150594857;-0.51657756070394212 2.2369807786331308 1.7172739704024758 -1.8754006265671048 1.2452044458444889 1.6718965312190985;1.7500946945647622 0.53688016664392701 -1.5219006281790923 0.13828908178056706 -0.79567221520229581 -0.30898370479395354;-1.7335692772144888 -0.89504684913204569 0.71403910433293261 -1.3653898106250069 -0.69677400184967386 -0.84815671233044332;0.25451861468626752 -0.39536334711369769 0.26543055846640257 0.31429626812039846 0.30603581602876578 -1.936924795172162;-1.1778571144277576 -0.66773827798769236 -1.2204304775301889 0.10581333354426947 1.4862312707963081 1.7663196741331459;-0.31922647217668215 -0.65497217047502587 -0.44881077422367266 0.1974041252549899 0.48277731222154507 -1.2255279441017561;3.2509764452680434 -0.67592786316440678 0.68096358870660145 1.0104947690136943 -1.3775752308422273 1.8830606680543143;0.30199046897255155 -2.1057810410911717 -0.2343923857036887 4.2013649846089569 -0.39138262411448405 0.83751140144723013;0.99321226196879608 1.6588631413372181 1.3586570654801891 -1.6232629384040385 -0.26638075725078991 -0.41470059688011351;2.410651157504355 0.078202308571344206 0.17767214980598273 0.87070951025340948 0.13095702617723121 1.0611562175591622];
  
  % Layer 2
  b2 = [1.082397857187382;-1.654321734037963;0.7169582308909157;-0.91816999521244302;0.66222800275555149;0.17344644030476808;0.12038166516673768;-0.79671140261261608;-0.84537011794164185;1.0055581428376466;0.93853165321045295;-1.1930942881788364;-1.4443773959742114;-1.7665700541802403;-1.7454166868791596];
  LW2_1 = [-0.78583787562101193 -0.07764581408914864 0.26104981320063375 -0.84638784280294355 1.108849229958643 -0.041933544369615883 -0.032914103037920583 1.7032248489505704 -0.25270852142599609 -0.95872284586519385 -0.17306706555333498 -0.29362912541719977 0.32759619410669399 -0.70082789751860708 -0.50236479530199007;0.84153652410637692 0.70667192565095405 -0.93010355466688932 -0.39794468583738885 0.95493904857846734 0.2758291556900091 -0.60371638517768889 0.78628855865293967 -0.66365620892096699 0.16352413517316183 0.0054524641855998174 -0.4671245680746281 -0.34425914686798659 0.062536043953990997 -0.30940469407416205;-0.50269810609243948 -1.4055172384749066 -0.62692933817732599 -0.0596906161410624 0.14632455941094874 1.3597074325408285 1.6671945763146931 0.36630196500620216 -0.38873997884843248 -0.93423726745571889 -1.036500090151617 0.23767600365154706 -0.74109862285181638 -0.36003438998578063 -1.2303616741880754;0.1738992591185809 -0.27851929092286498 -0.87738229159516323 0.12341342218197551 0.96287411204788187 0.037929057500210452 -1.1625275024940898 0.18091200341560457 0.10901172653393208 0.72705773659549722 -1.100361058574856 0.38669994316328815 0.58576627887452992 1.0613171974150175 -0.059505053391528645;-1.0701246313978749 -0.092081648496824708 0.81254951751326698 -0.9281094599413684 0.68455980446261389 -0.17447141082019976 0.27917987104855813 0.75811099772573931 0.27466125605456115 -0.011373860432876373 -0.52042410955850216 0.063836351586121637 0.41995069810044694 -0.54824047952013111 0.06416383163965679;-0.11492638256347776 -0.20576718160230983 0.98760556622103979 -0.1446168801438347 1.5147983135857799 -0.012433114054296493 0.43472255957481359 0.4067073023375945 -1.1723927166161692 0.08162101477275438 1.6973630111901321 -0.25919814858320583 -0.81327268874778513 -0.59580635800016624 0.16627924374397698;-0.17517899235355697 -0.97602394227842315 -0.52974285335508098 -0.17769161438893039 0.61283908397719766 -0.11950316415680252 1.0622406077007029 -0.036737499533306239 -0.59841841593851042 0.23061944272928533 -0.08386803572552351 -0.4368438178898042 -0.87428332765594774 0.16527743785911292 -0.56049126359968671;-0.38213150944177005 -0.53738137813326758 -2.3810867025791382 -0.6041730293443478 0.65044520695699781 -0.026380595763815969 -0.75104020755168799 -0.014882616325263692 -1.0651527252188986 0.93294062670582578 0.49885827936690497 0.93580768898383238 -1.1822207331170764 -0.46147475911804314 0.89610472293375365;-1.3980155082259573 0.012765633468312824 -1.0128407055445761 -0.90825737093894532 0.72001248446994837 0.37154381935190561 0.10898737937723732 -0.14715338588752536 0.79038402161097543 -0.047267781086050925 0.10117514428474025 -0.51493668132545056 0.21463902204117402 -0.17268910273006716 0.24854051140301953;0.13980470137615558 -0.36141410500694632 0.42241034770725955 1.2310071212469627 -0.62707967957310007 0.69717409339527336 -0.76217011631447784 -0.44316853288181712 0.1888408389833019 -1.384616420969651 1.4396827586203178 -0.081562594422912804 -0.73170017916617192 -0.55299570340325632 -0.030517119025999226;-0.44769956797765198 -0.97376523009997829 -1.6125979439850167 1.4784572110090044 -0.98899670950888774 -0.22675262149129904 0.81210075438945317 -1.0074712645050374 -0.64673367706006546 -0.79073717730032811 0.97179549346519378 0.55050503180708665 1.2680486725222826 0.18216815384667276 -0.22894532145603258;-0.42121794908721349 -0.92971373159083015 0.34849482084099881 0.12470165125444072 1.0834573957606703 0.54026768006714865 0.29899189160707407 0.012542219776641737 -0.5070186214923631 0.34896953273600262 -0.26589325564316313 -0.24229535969755644 -0.55418077956116385 -0.51377488404411964 -0.3532277976872803;-0.4104179681863801 -0.70695505518589008 -1.2933672416223387 -0.81194943160552779 0.29501624226185957 0.15491608248945063 -0.13103743621457473 -0.42833971032895901 -0.80576670642179593 0.87690292714334284 0.51970546344495583 0.45277405175483687 -0.43150412813224842 0.36387950048079748 1.1079057585508321;-0.65153860216532999 -1.3815161815960335 -1.295306851680065 -0.21194213391013814 0.58292825816439364 0.54452965001994635 -0.14938566286392571 -0.39011234353253149 -1.1195110560487764 -0.24509672935372873 0.58692850948401243 -0.14967337836214323 -0.35869954568900903 -0.34916242094373412 -0.75166615386614943;-0.10350990366998743 -0.13067421488725017 1.0162059671368422 -1.1065492364560237 -0.12736863204062154 -1.3514620890097053 -0.076011267774249741 -0.17192660297198312 0.0040133130155498853 -0.23435374470665429 -0.34206701178113985 -0.14980325879190956 0.49051103448601285 -0.66783209272638611 0.11486423481472416];
  
  % Layer 3
  b3 = -0.96932025472493955;
  LW3_2 = [-0.29331402451476463 1.6847020655083225 0.27962193148646741 -0.5350132278031885 1.1934397810181172 -0.56756503392352131 -0.52555309025579067 -0.60665385641037217 -0.3874771820644119 0.49320107487828757 0.90133429388704678 1.3471128149162697 1.3034531360373864 -1.1890520253482186 -1.0065085614879918];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 13.1578947368421;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
