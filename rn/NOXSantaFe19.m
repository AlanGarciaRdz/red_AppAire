function [Y,Xf,Af] = NOXSantaFe19(X,~,~)
%NOXSANTAFE19 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:52.
% 
% [Y] = NOXSantaFe19(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.4209022057316805;-2.0915927122008737;1.7028431660407006;-0.65847910079009619;-5.006326365674874;0.81705595542610987;-2.8906413390690031;1.2061496357758807;2.4402323085376372;-3.7717166592876814;-2.379614795867202];
IW1_1 = [0.74386970408488562 0.14326712332717223 0.5270581550980119 0.013160484221828214 -0.18625848073095957 -0.16222030012025673 -0.10622235461921825 0.19642993550257981 -0.13228518207221054 -3.4984591307557174 0.21768027715332136 -0.42833727443860531;0.2495870026269271 0.89926329027210494 -1.3833018800915664 1.2815099991971968 -0.20001357932289274 -0.0071144898384075533 -0.3900801145475094 -0.15698755664246533 -0.44663827504118081 0.45539146099038991 -0.076615877089647663 -0.31571548415954082;-1.5735213700761406 -1.3367497600183482 0.60008966127649321 -0.1937287326324787 -0.39893940278540241 -0.70784254121474433 -0.76790055647143352 -0.052935408372616732 -0.15155932173603698 0.49904149281466542 0.56551022467734868 -0.36612488228964862;0.441430173508982 1.4616552788341748 -0.26678677099302561 0.67592857865284839 1.1241993922948403 -0.33670549318510956 -0.10634995364865467 -0.28565103771161454 -0.037068621828792857 -2.2466714468023783 0.60767921268870329 -0.67777438264753997;5.4628610272760323 -0.30531605870366557 -1.2690809912921552 1.1073107099690609 0.55246532476245314 0.36862905187268219 -0.069666041205287646 0.08641508897053185 -0.053646014784188407 0.56986264861701974 -0.41630656596553917 -0.18058227893022527;-0.075895504396147825 -4.4268719607338243 0.61581325894615968 -0.73192380142019953 -0.20227684239728985 -0.15093774464104584 0.10717387395861298 -0.01496403169251124 0.40736680350442089 -0.57797381420955984 0.19428247420132444 -0.2272679467089716;-0.42624647537487859 -0.20198715136175016 -0.12314288211011577 -0.096750244649712686 0.23284950074685398 0.21470520026997883 0.10749113869324634 -0.17477188917712982 -0.052192533090596502 -2.1296624583130543 -0.10493037806294986 0.067522358426987755;-0.48085968799334045 -0.61662221969349418 -0.32107887260042572 -0.085215711468193733 -0.56462588135211933 0.029581092831175916 -0.14930615132743008 -0.23019885009882812 0.22380656744480548 3.4706411931007439 -0.51818403198358831 0.35097423329145561;-0.46470575305383977 0.2300263461269085 2.3129589876860432 -1.8805820851136807 -0.12104310132783096 -0.53189612144030429 0.25857124427780176 0.40555881712097969 0.005424272141531291 -0.53427640810278165 0.65611539319645706 0.58829779951132488;-0.91817657295570132 -0.098374690335550768 -0.83266308536427236 0.085484402839158202 0.049866406739281458 0.19768753733443725 -0.12755405215914636 -0.78468179465494436 -0.16825643461574011 -1.206226833319741 -0.049389269745255523 -0.32625911700658894;-0.50519244039350319 1.4819531803054602 -0.80590422046175614 -0.28062196624312152 1.2259787075630308 0.78675489771043283 0.59399033812168611 0.39207446974960536 -0.091276471973181325 -1.2769220972842386 0.10938773412593079 0.93445404411980559];

% Layer 2
b2 = [-2.4148173906960015;-0.038345448426138434;-0.65496143853505362;-1.3431450795995776;1.0669283108315621;0.14211053356388309;-0.85849148912442308;-0.90234493030701346;-0.84465543364306483;0.57805782538443218;-1.1810055388286609];
LW2_1 = [1.0819799273384232 0.69930297587529877 -0.38978061054894553 0.22048915867798344 -0.88785296314200313 1.2161565251632147 -1.2825461253608166 1.2784442652876304 0.84079002801268754 0.98893037995243915 0.10153688830648101;1.6220975154123807 1.5213465245599949 -0.36332564190541877 -0.11868978133674903 2.976412716953992 1.8287556401695164 0.2122947846404257 1.1934726425322564 1.4258617794992721 0.14568598734073684 -0.69720509714033085;-0.52544385800233551 1.7165104180384545 -0.43789323793940765 -0.78112884769489965 -1.9022342455043373 2.230800417284545 -1.4169062697482784 -0.86631643419315219 -0.5945144707545762 0.72395263064684867 1.5096438865494635;1.7752446656332317 0.72117364439593656 -1.445465560428941 0.03210231818034763 -0.10003229149944912 1.1366882898746888 -0.51419817657544598 -0.47670845062540779 -2.1647072589486536 -0.27825358493797103 0.91350370886919752;0.68280937260526786 2.0048799442338878 -0.7261770790529497 0.30930962280830271 1.7356985086363022 2.7861517401842826 -1.107830070315039 1.3855706465323994 -0.35420733302457613 1.0659592339524271 -1.1297095264144237;1.2091566747644646 -0.89057527661287983 0.065474096568690909 0.92149210100086232 0.40744080632455393 1.5639755313383366 2.2310418403547003 1.9628406323875141 0.21324462863270338 -0.014648689226307559 0.70151589484165811;0.098605758731938664 -1.415720814930497 0.40325278000557463 -1.1103072406158008 1.9728969219813333 0.2963849652262685 -1.5154437189544698 -1.1389315415866301 -0.8684171584299617 1.0307547324270301 -0.32966898213459911;-1.2665340182159384 1.2764138589780132 -0.16903322969500445 -0.74379481024622873 -2.3492472609464325 1.8049505435121804 1.8444401074258332 -1.6307997245932242 -0.88630291703793374 -0.88015320522261897 0.40588665863312551;-2.5139485207146852 -0.31211076324103387 0.087904249690919131 -0.39055222957624675 -0.52187941051019204 -0.94305146217985181 -0.1228015419599312 -1.7736482109079457 -1.0488637882728453 0.2065357434565778 0.090772877468822163;3.0215336310639422 0.092224420933298551 0.03357445344389038 0.80380368858266726 0.75802479729219352 0.73440243202229472 -0.39109036053917212 2.3683851799186768 0.936436627668921 -0.1687242254407639 0.10551580566485284;-0.96962642126509369 -0.38434770542771102 0.15494052897237873 0.80983468970130912 -0.68430948374928868 -0.7035628800744772 -1.1637243333443588 -0.05668957722661043 -1.1106187087751547 -0.046281550117041881 0.46787803889108953];

% Layer 3
b3 = 0.10984857350606544;
LW3_2 = [1.8454028855390092 -1.6571507733404078 -2.7766067159359737 1.2001846826354876 1.1154394328690402 -1.051400879517445 1.2593039910979065 1.2504475618925062 -0.94067538368188319 -0.7652960768862157 0.320122854313175];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
