function [Y,Xf,Af] = COOblatos14(X,~,~)
%COOBLATOS14 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:54.
% 
% [Y] = COOblatos14(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.281696750681566;-2.9654770717417978;0.40186137538461431;1.2417021395692525;0.19689826787501807;3.6907407223331639;1.1747025396813291;0.51061899604459116;-1.495794197900467;-1.8968435365933691;-0.68418620745681491;-1.5125479891761913;-0.26751433573024996;-1.6629166471570602;4.1042760002910335];
IW1_1 = [-0.59508737304248138 2.016333759357174 -0.69665619533743461 -0.041856268841849391 -0.080885833535494833 -0.94641844976156353 -0.58566202066937301 2.3391649363160538 0.30557348140597435 0.25269453054326568;0.79233427205880502 1.4319022994986403 0.95569935476635826 -1.5728189246455073 1.5715177172072543 0.39160481359094756 0.097147923984348419 -0.26870938108346826 -0.5285269979399162 -2.4101025205729658;-0.36663750214787511 0.061903409183026295 0.60546069573106542 0.022324760963256408 0.099446530947560743 -0.23893495693114575 -0.29311495091960277 -1.2964646087125846 -0.076614680305818361 -0.10449949929580983;-0.76688285737604778 -0.76821798578285061 -1.1294937127342521 0.85406556265404843 0.22967591672553153 0.022354490374041365 -0.76375114934974686 0.36188870963775238 -0.23917421651092499 -0.018277772239488191;-2.2378679771435555 0.25845790437491994 -0.15455897023427903 0.030080125986033518 -0.21832685309777766 -0.44152883461810072 -1.6531986842520559 0.11782690224576062 -0.018885222234575005 0.012318445521624498;-0.083955712648870792 -5.1644503105379691 0.78118560360104539 -0.094029054949921767 -0.145811801391698 -0.15577357389522087 -0.14932416477314295 -0.058190541366960502 0.11748711985341974 0.051893804809995878;0.60221363707994191 -3.1176638917336228 0.15772702623549342 -0.46848429154403182 0.17001870357209142 -1.0281331212429392 0.18228581562064777 0.33660219119854212 -0.26660597034785888 -0.61028824180066132;-0.27406743772924047 -1.8728146611637058 0.64279004613176094 -0.051548392042149421 -0.2253284721082105 -1.9845506911855793 0.64858249009270141 1.004675452034828 0.21678072910856486 -0.19923832812476044;-2.9707609230840442 0.13358884890525932 0.65807675018659595 -0.31054428357467462 2.0254165857691726 -0.94451160670971779 -0.42587529554620868 -0.71328851471418186 0.36971065411638587 -0.09082285672914131;-0.70839409939433629 0.12408949852783491 -0.42830294120554668 0.372892413969444 -0.39397082765806563 -0.4056184048858919 -0.23562690272727879 -3.3976904221597182 -0.046049826617190606 0.64399638338704424;-1.0391860624550593 -1.5714470669644227 -0.31574197610749977 -0.0014787188713173676 -0.23629406101310044 0.16739753729918172 -0.68962817535926824 0.50139645658240484 -0.010855791676224207 -0.2864272241938936;0.81134391096743863 -0.23396510304181029 0.47917277740118436 0.32441490665390249 1.0542516843936875 -0.48467759123381565 -0.46997932707219192 -0.20123121062576177 -1.0792761430475655 -0.35188566553666734;-0.040132049547614748 0.68836881881864076 0.68257500481166733 0.64579475095758065 0.97071093685477194 -0.3291965840761944 0.27919865489938989 -0.39948451017219438 0.38849165054187856 -0.48369390883531516;-0.49035922222709011 0.98567077758603538 1.6363354080127444 -0.070278305752135103 -0.087004821720762474 -2.7962282489865711 0.16342332768313719 -1.6887916619887395 0.015665653540735711 0.054538611698812203;2.6050220021189388 -0.21671570573495758 1.61431561765078 0.59486890144733184 -0.089801247203492585 -0.069375935715779227 0.43304655815453968 -0.65309089168826107 0.055715331526288228 0.26607071407213162];

% Layer 2
b2 = [2.165298527800712;0.88877351657486225;-1.0702263777041414;-0.16903747160963684;1.5559977946356911;-0.2361833736496769;0.14648033877794867;-0.3174895976065199;-0.15562993631599137;-0.56506600305189036;0.32624137102691714;0.96801885568498602;-0.83569694788586291;-1.8367351310565219;1.753954636971808];
LW2_1 = [-0.26031702682820579 -0.7007049709931592 -2.1520082348873646 -0.61957985660130088 0.47437371754661206 -1.0133481685151158 2.7712701201440142 -2.0324112089724489 1.4884070063973807 -0.27876592685699125 -0.75672748664180445 0.73177162065565904 -1.4418538558113743 -0.68238593106510448 1.1805007314767884;-0.494880093754831 -0.76622807009878846 -0.38311785773033991 -1.4780396896558954 -0.034151128320110566 -1.1307318382863634 0.16819526988525302 -0.88153262063470295 0.042989695430984444 -0.60871821004331328 0.29983971757491962 0.25345726087198384 -1.2313928918973382 0.5335900677823795 0.06287977971421424;-0.21846872364069597 0.068442392124969456 0.84050962233871751 0.24383629711959867 0.042587618334391314 0.57601100954824747 0.18361661460959278 -0.16909754750870379 -0.37321297280559546 0.036057816567345656 0.60023170817275284 -1.4729878309904465 -0.1451665609645687 -0.31738830539172125 1.0773991756337093;-0.31264111495350766 1.0714240278436089 0.16812575226078305 -0.41853640476793463 0.79292853318393386 -1.2393502606572804 0.073879051638745086 0.028394091813565413 -0.14276381699449614 0.43488796782388561 -0.29701836197313158 -0.86230821609936492 0.83175569725200549 -1.8687218975373701 0.18044374583931119;0.55621971466930287 0.51017461993382829 0.66303939704560566 0.84663272817048685 0.25588649218250853 -0.85604244211201908 -0.25217423726054333 0.64874496980594709 -0.073374851024666649 0.72030290195602098 -0.43940136657860646 -0.44772339235668079 -0.55240269239876061 1.1776230165102128 -0.54954460310902353;0.17974276646602155 0.40719607966840621 -0.699923380944942 -0.14124954964097203 0.75418245860752375 -0.51972816184135018 -0.026430361116439774 -0.07713769484534079 -0.029856064029786376 0.058584229291634871 -0.51847411113271413 0.019301758651680701 0.36969700948214823 -1.131462100424669 0.71915351092693525;0.93445269719544155 -0.59792466942702649 -0.49046600020900633 -0.54192974610853906 -1.3947252836211257 0.67928721444629236 -0.36208668187462417 0.47087868750118123 0.58563245211171089 0.007036066538928955 -1.4277247192599867 -0.026524908413791924 -0.68831115981724644 -0.32590916364852757 -0.11946942243436728;-0.27800718931322416 1.0203730573790821 -0.43860395255413992 0.11845142759831134 -1.0636383415588109 -0.35179326800177335 0.28518838229791438 0.32116809458484391 -0.72181559712056098 -1.2280962340862831 -1.0404156223969179 -0.04435644919782241 -0.15612175840786863 -0.65061739088738291 1.9033661027825846;-0.081175513179690711 -0.54292896014952785 0.11829730688255775 -0.38926311256938789 -0.64152345911408837 0.5322898419818527 -0.11766891179715515 0.33171427630133171 0.72927266550845649 -0.51689138902941445 0.74745258063922859 0.52563995806629249 -0.037879299792404661 0.07190897072397813 -0.47334914234178777;-0.7187004327702623 0.10572907140073882 -0.43693891816062558 -0.13777940550652487 -0.13625667280544035 0.94784525268070163 -0.42516757684569012 0.29362891576410999 1.2316266716532365 -0.47147451371883775 0.98008458826081069 -0.16184795870073371 -0.52982269922471059 0.046584409622336252 -0.66577984339835339;0.59348808888510818 2.0702716128564105 -1.2910356769304887 -0.22731562063950311 -0.34332686210416063 -0.91567804393404373 -0.19305030410730481 -0.59309638759197181 -0.49210162561790538 -0.83237100416746213 1.7147853097019405 -0.23772723271570026 0.27058288919457185 -0.019806579727978758 0.83884616680913349;0.23159475748124148 1.0171899259079851 0.80782518262572822 -0.90247860201932162 -0.03609534806371785 0.71460731721058235 0.16432008716141519 -1.2971556743039041 0.11561883500110334 0.044172167894685824 -1.1277920826532968 -1.5181927707407832 -0.82738932871644655 -1.1673119325732166 0.36697614883714047;-0.69760852482136904 0.45445729921537048 -0.17908328364757786 0.54018513895646247 -0.007492279593932563 1.6470386499811835 0.0049595202784134488 0.14285285276215995 -0.10640131818622901 0.29287656166667542 -0.28773967440162962 -0.46207794572834704 0.32291976780549325 0.05648462110221239 0.077615607653556531;-0.77547066949975052 -0.39273578629179334 -0.61691138037613014 -0.45832615182678338 0.25230955296554408 -0.97296780049664788 -1.6337716793009638 0.62092758535842552 0.68689637615090093 -0.43557955907354495 0.032059688939991282 0.005922465520433972 -0.85917501465512824 0.49224650456398539 -1.6855205062670884;0.7221596345950736 -0.27038193866133114 0.40793515702874505 0.62475448983809956 -0.33494879072536021 -0.7326420892516754 1.4373791578429751 -0.36323654029556768 -0.88170832965176993 2.4446553473828523 0.20198753216717263 -0.28730449754759507 -0.91854160916099215 1.6133120132024215 1.0947632182709726];

% Layer 3
b3 = 0.039220110440925528;
LW3_2 = [0.46630523285471942 -0.87594509091393624 0.95580993392626745 0.86432833369306361 -1.26539751097057 -1.1683733897697723 0.17497977067883241 0.53948278238457847 -1.887728116085353 1.126646395188885 -0.413797370207726 -0.97120131035778678 -1.3086038087000054 0.57420224883526905 -0.22178377418637335];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
