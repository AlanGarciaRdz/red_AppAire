function [Y,Xf,Af] = SOXSantaFe1(X,~,~)
%SOXSANTAFE1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:49.
% 
% [Y] = SOXSantaFe1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.8305864619481251;-1.0282438723260452;-1.9275080559586182;-0.77341424657248314;0.83245414677315177;0.48806759259819066;-0.40737460115401897;-0.36382793893945387;0.39483389018857479;1.7896696667315606;-0.61477143612169549;-1.4707866519279067];
IW1_1 = [-0.36135135749144148 0.53366579443618423 0.30261642874051148 -0.37026569083587585 -0.61611710922877527 0.28575286029883062 0.048398183452062607 0.43590269592494602 0.072659762450549392 -0.97964970773953242 -0.20764692043571012 0.13583636744320754 -0.13755923821611324 -0.15028315664827005 -0.69153436371035204;0.34217295838875461 -2.2186678422505803 -0.58267488072436291 -0.59849808585123287 0.07492013298755637 0.29524766413914322 -0.38889013003688333 -0.28547900014286282 -0.36725605097400321 -0.26860086407389672 0.32646060679700156 -0.15199636798029578 -0.23474460106874454 -0.21059681334232086 -0.73891052715826866;0.45375675288646844 0.22424545369352145 -0.14290035454226943 0.17202870994264577 -0.0013711135073461748 -0.065984307551850474 -1.0507524327292697 0.11275980703659721 -0.1987056563019704 -0.073200569431616805 0.14272513479348745 -0.087908246203339757 0.46454143837298467 -0.043802053693791324 -0.50988358418619839;-0.67120124517983526 -0.16553327911531937 -0.063796211534410535 -0.26320178464947214 -0.43025602455427581 -0.37214023916676237 0.069390723880078317 -0.080376230177888988 -0.47475268704520612 2.5467281187190896 0.35105295029598899 0.46460357647959233 -0.50011351472787258 -0.66005102949013594 0.17121160874423491;0.48810239406441158 -1.6040839256563524 0.58758684139287265 -0.047330713682513556 0.21297832770351588 0.80600868683172111 -0.025632212644962987 -0.16945622565517368 1.6413285282149062 -1.4097410283836378 -0.54722664285065548 -1.2488778864683714 -0.58397287344660853 0.12926786679595834 0.20268705632021591;-0.20229975165072744 -0.17279501127274466 -0.25792175819706109 0.0087576200875131051 -0.81105546924186822 -0.61074623064534772 -0.19037825806546513 0.3470924530900204 -0.42770370333094893 -0.25897360297602501 -0.95158433777756535 -0.19458179875856702 0.044626409566513717 -0.60488149148946413 0.037508609021639494;-0.42366886344868432 -0.17887405639144544 0.15888472415434296 -0.22508203441872282 -0.025155551804379998 0.036877390532359812 1.0639416391839862 -0.10559553910762079 0.25014323043369863 -2.2595448902109725 -0.11521556837685576 0.043196934519089035 -0.48784664360736602 -0.043004175600633507 0.69448878047038476;-0.34369041692625651 0.36391337774612237 0.60817014991152007 0.46300705051144098 0.21042611836760319 -0.17462870656605231 0.26727485944694762 0.44170520703210964 0.16867569704368021 1.0111914232051957 0.22223459010200444 0.50458744065561367 -0.21659326275718624 0.18952716588656843 -0.16143968692328151;0.82002466587832723 -0.15065574170593893 -0.52438550506896187 -0.42461370290374945 -0.7830749793759072 0.30877507632822326 0.17214200074414926 0.052294514661230349 0.2250469852950957 1.2614346843881503 -0.010921993445709911 -0.85021775567218461 0.14467657658289812 -0.28232438892736417 0.87000461391745665;-0.13891652829129403 1.4854766237998036 0.1085325159899653 0.73596923608968867 0.73396964174343571 0.70673459845231024 -1.2061437982503822 0.047815982883284161 0.55629638632574008 -0.55675052078107645 0.52847015812567599 0.38150123375458822 -0.2092054917222145 0.14327796920691097 -0.29438999242172303;-0.55495251484256503 -1.0168268315438749 -0.068222350422246697 0.37725367511933477 0.60547473217173531 0.26861598429166561 -0.29360501932571026 -0.16598295691859194 -0.21916437521037813 -1.1128251486680711 -0.19888039468941046 0.45832921413373046 -0.441273328817057 0.55120081046147062 -0.73499253720063773;0.27438973059739513 -0.47806597525174227 -0.231207811346956 0.60674753198971487 0.30304705729924852 0.65366678263444988 -0.66869883141726727 -0.076792538862808526 -0.38664778589816012 -0.98060094831302658 0.34087878284474099 0.27724999954709445 0.30370853505693568 0.59918487857783664 -0.98980865119054506];

% Layer 2
b2 = [-1.7743784259124513;-1.5870579518182115;-1.0776323438010442;-0.88664907386198799;-0.5209081521297243;0.24333449564833909;0.10282918264035887;-0.72135671597476936;1.1743848382644899;-1.4033927059134601;1.5378641980754286;-1.7729682168586791];
LW2_1 = [0.57833989808249742 -0.4622008379379004 0.47944378668896681 -0.62895910776867869 -0.41539636058331375 -0.057738470094793458 -0.59641512790857243 0.49751387547866538 0.23005990836696436 -0.32798758617622759 0.23122239986306303 0.7969514788575236;0.59657650700247256 0.78800514373599739 -1.2482217453168716 0.35621449855972359 0.71962112437950354 -0.63913282643202218 -1.036143860062797 -0.56846867945680724 0.16540965606524485 -0.70764068413003822 -0.56621395862545421 0.59426405321897069;0.56119016215148765 0.69335511879382961 -0.3065310797990432 0.14743478032961235 0.31530654408435055 0.29664444107493004 -1.1066103880813645 0.75566721015565197 0.068327236567478744 0.82811265924084598 0.0053531995828099022 -0.74205721464468888;-0.063073362308227285 -0.81610750304886359 0.17693257065098711 0.56617548600854839 -0.32132826259284086 -0.037812787742118513 -0.55685316723429334 -0.19170571510036036 -0.023869222555792748 -1.2069089164058764 0.20779843074013629 -0.18976435136838532;0.23373179746523867 0.24766933595144608 0.49061785551548875 0.15841849570782504 0.1521009567200908 0.349950193881925 0.9988243159882414 -0.016228211533047796 -0.65224512402688195 -0.22286537290066535 -0.84790047938261837 0.48637294870005382;-0.15915433405021837 0.32964608998688483 -0.68894609280787034 0.70257725194876208 0.19699837462665903 0.46666608077958327 0.15703847527321591 -0.031415877897206623 -0.65440984462038465 -0.26851403590511458 -1.3081041477491915 0.67202163422768246;0.48318139283885747 -0.22574696091994789 0.94597533302696446 -0.67344994352871768 -0.080105401140333071 -0.74945691577716989 0.6369854033473199 0.13261842749067188 -0.12829664704339522 -0.039387412843368261 0.59688040833520251 -0.20099624214998937;-0.81767841306491429 -1.1287332178501983 -1.3323595017688188 -0.5084367147349087 -0.57741669757953795 -0.85220394220515727 -1.1667338345317411 0.80661218226209297 1.2680294532106922 -1.6030882302042855 -0.48218952483678423 -0.38235357237627976;0.97154418346901406 0.13615975897472052 0.21221708281025273 -1.3973098685706158 -1.7739233181638459 -0.24288877267315093 0.31923715717610518 -0.78223419876297573 0.068308980282920151 0.54851956488169329 0.24271246121191106 -1.0256477609712444;-1.0588306760155166 -0.038512973538776502 0.79028410621378276 0.61856558960734032 0.26159601809202954 -0.13540979064324143 -0.56847340252658918 0.20677491517674687 -0.21426723257088662 0.019638952859318288 0.31078357505754717 -0.20454778953592773;0.72817927584820119 -0.10147637933092726 -0.76480442892023548 0.31597809859856951 0.22086359730303345 -0.34990688562921118 -0.4246351391307488 -0.67344918156299527 -0.2930987362633321 -0.54559045257926397 0.14085830913072658 -0.028692402604935389;-0.25636366563897756 -0.1159343734172691 -0.14776227471027875 -0.039833060871737817 0.4894806188701642 -0.82074109269014417 0.66328862473320416 -0.22813056051548414 0.75189832684600511 -0.013318677789732418 -0.65517928637865586 -0.28547248451305185];

% Layer 3
b3 = -1.0266488172182555;
LW3_2 = [0.0081356767278442585 0.10611792489887489 0.093461149132548882 -0.53898179286417025 -0.93059375930024035 0.85505646280804093 0.55357742186360959 0.89940380613719728 1.6321918343727175 0.44553426617999409 -0.86982637299539889 0.016579045183254607];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
