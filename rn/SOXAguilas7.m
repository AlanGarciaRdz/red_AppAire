function [Y,Xf,Af] = SOXAguilas7(X,~,~)
%SOXAGUILAS7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:18.
% 
% [Y] = SOXAguilas7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.7772580334582337;-1.650372870408743;-2.5042522367634783;-0.63370595732963952;-1.2477655006513457;-1.2115948806673871;0.09936749205720341;-1.0190000335740663;-1.3697525964563722;-1.9577804481498369;0.98275005538773141;-1.3671637894410522;-0.70396686829463218;1.9300305269333506;1.4709023722035239];
IW1_1 = [-0.37783646164947932 -0.33657663202309923 -0.78972300528931716 0.59512769590233194 0.2549814633454347 -0.48562480430085764 0.4880435912412262 -0.51219605745378172 0.5248976880337386 0.06455081095555322 -0.17926184356975502 -0.61083795005276431 -0.63338117334915101;-0.26044671107382411 -0.29862147488508078 -0.051361771717528489 -0.16719406591258518 -0.36206644565812024 0.70051966721880599 -0.20666862060803984 -0.3092253110253923 0.75447218144322292 -0.40359921044143471 -0.45207810091540318 1.1308976354832516 0.088834267417587182;0.85041058552265159 1.035879845444976 -0.65027272916163847 0.78307214433565442 0.020174779978242505 0.53003254106616571 0.92198819307939972 -0.21237364879981788 2.2301879484931959 0.48720150169004756 -0.086785907899860668 1.0436476057186357 -1.720359148032059;2.5606316844442003 1.5346955596289913 -0.064569528553977087 -0.036555492731272177 0.76022463113240446 -0.40605358912082051 -0.014508628876911844 0.8612225879582327 -0.115263731010842 0.35892902148676986 0.28176339175157866 -0.067883491825228931 0.81739728861421967;0.7996301566202324 0.34726591784072036 -0.024341215168204394 -0.21522837203371561 0.74405062317942527 0.85353830728661062 -0.67794922543608893 -2.3106700467116306 -0.77324195224148828 0.25519486047751844 -0.22462669123900744 -1.473311686012108 1.0917233700297539;0.087095916008182783 0.10652274305211233 -0.2069918454518975 -0.061594379294126381 -0.50256684733681423 0.064736326236465164 0.465626662098518 -0.34996165685892799 0.40189616809851358 0.037106509243311464 0.071373656167397687 -0.12712004065012772 -0.60265368901103644;-1.3617544091074965 -0.53847494580513666 -0.95387050587000111 0.33359702178410999 -0.39568111437461806 -0.18785749272916549 0.68655067787121338 1.9756158020209578 0.19225653758965117 -0.22680220223539146 0.113668163492241 0.73277352965474107 -0.96707928887265804;4.086411606284897 -1.0655942477492788 0.18937409308818093 -0.32252349184576223 0.92240194776607076 -0.44950949691487779 -0.18506862720175732 1.1460916735427791 -0.9262694819845767 -0.084778108710478306 0.4995506879639669 -1.4447367221192831 2.0462665027856861;-0.20665632825124566 -1.6980225703345007 -0.42591161016189227 0.37030386146054911 0.2033521311516566 0.56521283666679223 0.27566343344865152 -2.3007636688713733 -0.44117151193414916 -0.33026097982019154 -0.34404672777709777 0.96841430360483327 -0.60946045730380261;-0.061027814451091365 -0.14744320314571097 0.20358484221853607 0.079432440653631989 0.39998344639111993 -0.022837563429123263 -0.40455690839113895 -2.7376738651048362 -0.34097477641105772 -0.044526801980220534 -0.082302786472100709 0.20701609392570194 0.46610212778658533;-0.81388616517680579 1.7688228483918003 -0.15063873786068907 0.88557157216936777 -0.6178308306622794 -0.75175759162169675 -0.34817796058878692 -0.25662813295593012 -1.2746271354551397 -0.85423624929831343 0.090754351483918638 -1.3300484483933526 -0.030473890666832898;-0.53020865928997651 -0.97782491402235516 0.22171395527137377 -0.37790851511102425 0.27428181685237274 -0.046934128698699451 -0.1400108642005356 0.83951948466187276 -1.0662376425207207 0.1242169673260895 0.25094831828739994 -0.1551966100388468 0.46243790767158299;-0.20916049273955817 0.066823437335958191 0.20089892055429148 0.34748494930920293 0.54388601321440111 -0.70933472760201277 -0.45048633881060951 0.40244102127958375 -0.090816929036307628 -0.39917604544676161 -0.59759827095591878 0.39232421686632585 0.014978716523994916;1.8016870265685161 -1.7523627385464988 0.26163839394157939 -0.17444075672611867 -0.090488457559394705 0.12331882345966957 -0.7938181412602564 -0.7174933049798663 -0.48578721227053973 0.14044309765398544 -1.0873666500937675 -0.08978721607594603 0.95795731971781661;-0.33203781976737512 -0.15656087335894298 -0.31252266625780123 -0.44522226220648653 -1.0503268521553262 0.36499817914912064 -0.58853181253615439 0.099521694553500448 -0.738468810483625 0.6590958475519566 -0.90630166870426332 0.67338586116265708 -1.0532855238700769];

% Layer 2
b2 = [1.7449759194737551;1.4154044874174421;1.7066953949369823;1.3105795363510007;0.81265238961165065;-0.21314344384337883;0.12762139171470452;0.0013993043347864595;-0.10806703931153275;0.55235023766607483;-1.1477052033071096;1.3576270502500725;-0.79413642179381838;1.5563287510136279;-1.5534141697750914];
LW2_1 = [-0.071276443941453729 -0.062716806843216996 -0.34392928819910723 0.27460898599394934 -0.42664043719334915 0.014157292387514824 -0.64639810399953013 0.26039335123138879 -0.30167254147896494 -0.27572435436720494 -0.44789123302600892 -0.6967913276642913 -0.3906437710440287 -0.50852901277061924 0.70323051582054963;-0.68926657953776682 -0.52216978046862472 -0.96964824676031258 0.54377223734427882 0.60335886842017927 0.61061678983638179 0.37327325430750297 -1.0819677267769274 0.064050352265010047 0.36080258758191869 0.41513180636526859 -0.82159195868271628 0.55612878703426505 -0.30805852173418496 -0.61566800590510684;0.071735371515170912 0.83618923552682944 -4.5789779361581102 0.094469022602498259 2.252778459673535 -1.0161718011430469 0.4545419778849043 1.2844080898003314 -1.5069338289507324 -0.87623707417740193 3.0865615960895916 -0.32596770454967583 -0.45929467345316838 0.22354862459936528 0.45509781996242882;0.090127687044595645 -0.050794456529830265 -0.58143595684730143 0.75923030689031668 0.072037678436415661 -0.46491725403428957 0.13222413394972304 -1.2221497068867153 0.23837930105614133 0.32682490542288201 0.38788100811698012 0.33588836392656829 -0.39513994403030928 -0.52965057674392302 0.18636908526098228;-0.023935266091568708 -0.82667877521767374 -0.43389272527857337 -0.21697050803555684 -0.2684595443121307 -1.6084431744684928 0.88687709241851709 -1.0911302732373669 -0.69102729537991792 -0.37710311255659063 -0.080714097203815366 -0.39627209015295256 -0.11720393981750654 -0.35368598233381032 0.30560934535183581;0.67544286541029919 0.15918783060914218 -0.15536790690407756 -1.1043400737242599 0.17080675431680059 -0.94176343269931839 -0.93613869679538841 -0.71659671511904299 -0.88617330586070686 0.22034101682218329 -0.49073995054995845 -0.84223018612707834 -0.48954083182078767 -0.062180014263386062 0.53397402637743074;-0.42812744993084573 -0.37220745894968854 0.61735847253591725 -0.91211850878630329 0.50770874195556059 1.2094369812841554 0.83362804433731563 0.536052821847808 0.0019538249796955537 1.1112314474578575 -0.44085464173227784 -0.03780874517616567 0.10464076306746473 -0.10194511730006141 0.2874724290801951;0.25693788776043675 0.26463821196423704 0.7703912593420984 -1.0713749532380643 0.49710252453325193 0.20299044729468893 0.86465787458002907 0.96137862023926735 0.19478035290188017 0.022986243394830574 -0.69908425854745004 0.078579175911739185 0.13020575390000541 -0.20923136433179154 1.0691410262133703;-0.43408476141054925 -0.67404397459963417 0.12344964466222932 -0.1317327588611287 -1.0007328553204544 0.30527978139601269 -0.28764035033114249 -0.79054696793348711 0.95884539028883986 -0.70065975560426241 0.09075825695001416 -0.32623866076564279 -0.66820613924097616 0.1132759530546418 0.58846490850429012;0.45713722752318381 -0.75775408747374207 -0.013317420713495266 0.31364924386997961 0.4454577360448424 0.36141858914372238 -0.23283839830958661 -1.3855247232859353 -0.69869610705120178 1.2199545820371063 0.08181187053949579 -0.050789859810386508 0.10107452775324884 0.10854874371910037 0.13002613232997429;-0.64943047171026513 0.5539768819780807 0.063327471473986721 -0.52873473474535093 -1.5001673722449544 -0.23114505914951217 0.7135954549879856 0.57231917664668397 -0.1012870660289984 -0.4527503459096629 0.18765867867967778 1.3250895000300689 0.56752080244552827 -0.097910446984877858 0.20505139547529649;0.76591941273890285 -0.86195885041004772 0.12167389994004024 0.23508857814669046 0.60942827442506298 0.46323945265470085 -1.7380943189486204 -0.68404812067096255 1.5813633858211111 0.23328659249202394 0.39995076825221754 -0.13875191987608232 -1.2495932807090495 -2.0833533137111 -0.56456769865880851;-0.058399895755509766 -0.48293483379794166 -0.28736442110886057 1.1580189360693038 0.13249613572244001 0.43039112303327065 -0.32279553231460756 -1.0920310073755777 -0.55278092860174721 0.14742167364694372 0.5338271874873235 -0.38430717482112037 -0.028944577217491656 -0.46344507108301708 1.0808777467601454;0.48135162494107409 0.27260799410559561 -0.25590404141237605 -0.91926129525206202 1.0845237915853163 0.78398370771182868 -0.13433220184864375 -0.5581517740354951 -0.13311343609435172 0.34810425120916788 0.71688390986258299 -0.0065967607967623663 0.35437315336887532 0.14495550232646065 0.458481279319852;-0.44043659851009509 -0.20218821433326031 0.15816986405654646 -0.39921728433709863 -0.47461320480059527 -0.56420591069894999 -0.0035311703008518228 0.9348909837438234 1.2011960302640146 -0.06852973823887118 -0.17235608702177405 0.083821182794714885 -0.43960164565992027 0.10236879409302088 -0.21092601889332835];

% Layer 3
b3 = 1.0922432671495599;
LW3_2 = [-0.39420495361049107 0.99058491614747068 -2.8472908951870921 -1.3909528598056018 0.42524112224483918 -0.90293912563179701 -0.65535914374370785 0.6198989881442879 0.044613801869214667 0.59187167156268283 -2.1872867094368544 -1.2844124943125161 0.55537848438251514 0.88461779744293489 0.90284722268446982];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
