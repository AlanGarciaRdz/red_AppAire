function [Y,Xf,Af] = NOXSantaFe15(X,~,~)
%NOXSANTAFE15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:51.
% 
% [Y] = NOXSantaFe15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.7334318338683965;-3.2712466263506599;1.099133993294189;-0.95575867693179939;-0.73674478528471787;0.84672173744366741;-5.9434857846591465;-0.85845925883662566;-2.1101121405364527;3.4807916213471897;6.7428444609035454;0.75690552971310876;2.2515204497113865;1.8568069430056804];
IW1_1 = [-0.69753854250454939 0.51901090417827178 0.68609667401642727 0.86153478762370395 -0.4710754782571791 0.33983460551347172 -0.45840474256656871 0.19924627624981042 -1.5639167696039302 -1.0038409324071969 -0.2499449533648275 0.67122526823308548;1.8496001256453978 -1.0976527528447999 -1.1584186107503711 0.081398333830535796 0.99942021822748672 -0.55636967855384634 0.032049951691967803 0.43721888372132445 1.0024892659587514 -0.12319562542264652 -0.7185077647154986 -1.2636845406863353;-1.2235555296952709 -0.42215859630039182 0.28630139407988431 0.18706855225525229 -0.28087208518725665 -1.1233561873411826 0.84042420564508569 -2.7250005189175188 1.1679726222533224 0.78814989369598465 3.3872970164344971 1.1944549739663113;1.2245199826386541 1.5044807107366145 0.85921968240275526 -0.7287592990638585 -0.12441626781599859 -0.31023963468130467 0.13003538577789103 -0.28152268787469936 -0.074777971898683362 -0.18540714752964341 0.28921320192529182 0.16697709218802703;1.3156573083909051 -3.2938366097052549 -0.96047535726575906 0.50359984693285642 -0.013103647455360141 -0.50408837213328406 0.29777152482719565 0.15823005565254991 -0.68545288087112899 -0.26709626371398437 0.49773564787734909 0.2902044510592936;-0.17478397788490968 -5.6811144161580645 0.035224321232117432 -1.653818306183521 -0.059813668745680476 0.19460059015185852 0.1212013730488163 0.45034975528226295 -0.71571735403471659 0.8440751252124763 0.16635737891914332 -0.5740341052786393;7.0292051577110293 -0.23144314333000565 -1.7879619387107946 1.1763616996909456 -0.1041660623526335 0.67216806404529517 0.10647437990934186 -0.58878874792438329 1.113776043688925 -0.77449961097793241 -0.98464410489366072 -0.13901625807297854;0.31651217542434223 -1.9079409443634474 -0.90505284212235237 0.69498936610312212 -0.23559107304443722 0.11573707000932429 -0.16583248682059157 0.14695376428415924 0.16884241031006755 -0.65977156764263878 -0.32447360663916525 0.081922647246938082;-0.59442979137039376 -5.4276479957488988 0.39001821244492491 0.34911533595613581 -0.77506085290511495 0.45714964310407896 -0.18350182943899387 0.49887537219210271 -0.56665857349622251 1.113762191834972 -0.28058335372649307 0.37640959654003553;0.15720056224476764 3.3754936750381477 0.36349994486388026 0.37245721826709843 0.25188197406368423 -0.19015267871637381 -0.10671640162451981 0.17431213450926564 1.2999050266187635 1.9092972131903969 -0.55854908953048821 1.2866417728508628;0.25293040836551151 -0.065808531858026237 0.1312064185619605 -0.33371906403959395 -0.58802760266753673 -0.037059664760814306 -0.0047317781207235239 -0.47937232922225281 -0.9354219973686857 8.3061355544334532 0.22871913170873384 -0.42059086181011629;1.6235302334417288 -0.73819262409257913 0.35887119384566019 -0.19168561858705191 0.057463291697874452 -0.62250665692715346 0.12766389751415894 -0.39772024476332701 0.0039027551326898807 -0.12139978297535001 0.22367023880717782 0.15625743682295584;-1.1794660197353046 -0.10167529264701275 0.6797312096058411 -2.6274342876069814 -1.4769519346202105 1.9409166856067195 -3.1396489617026613 -1.5536578762687274 -0.65456397703809399 -0.70033683486086518 1.1273255557805109 -0.79432937953502747;3.2248790241954586 -1.8028733233646241 0.36932855122179864 0.26232169011097856 -0.8411824292348965 -0.14906877419927933 -0.25101870129311821 -1.2240435518827555 1.9024015576813496 -0.76966807529625381 0.1843672390041389 -0.72183614084218506];

% Layer 2
b2 = [2.4007026050690907;2.0627117968418562;-0.29313274117903676;1.6750282192950801;-2.522484870715175;0.43263221804826835;-0.8048038993610005;-0.52371517877788443;0.40052788003046702;2.1155714369117202;4.8209485905342246;-0.042667908124703904;3.6913197036512813;-0.098819473884940334];
LW2_1 = [0.24025656447828031 -0.65639487634472349 0.0037895197060408975 2.2651262319027436 1.6272193626359388 0.33127204037205726 0.22300841044792691 -0.58421929995617772 0.48246530464461163 -0.49874760269246798 -0.59916435583285921 0.13545090136718413 2.3393354617902964 0.24330953605213318;-1.3311103563184974 0.13572836713632908 -0.056878942487775121 -0.45259797436304361 -0.8724894215630582 -0.65940567338689204 0.54487468649935134 0.98803445389247113 0.38388835154413653 0.25648294468204952 0.48705566245055493 -0.70925090662559953 -0.84727849407954181 0.76633411732278567;-1.6806630994306206 -0.17008163383448716 0.38297940638565814 -0.66417685668526083 -0.47671521997176858 3.0613151364656184 -0.021924327852454406 0.42461264177617314 -1.9310271315706866 3.6849377401761592 2.2030936933478196 -1.0671262050802075 -0.22919157185174471 0.87256205446313673;-0.49596709140967266 0.97821840586950493 -0.18599825133109144 1.4210683873984677 0.17693565453518606 1.4279150945469286 -0.87956547273745822 0.97676743777017483 0.11909224965126228 0.053750313457370892 -0.55416992903795315 0.35074396707572936 1.2003391426800811 -0.98969012009194046;0.89668675480134064 -0.70195255235958398 0.13980988070137185 -0.99756306797093097 1.5265688237454742 -1.5660195263086314 0.90525575159684069 -1.7913765291681039 0.75705569540464746 -0.29891876214310703 -0.13329543970770871 0.47679529913468183 -0.48213368779484839 0.90558782411442273;-0.83636747502697784 0.27810374815255512 0.074415783176766753 -0.83293928143229556 -0.81602132222824975 -0.72040595771958926 -0.20042522826525963 0.33354388745674091 0.77550508611268143 -0.070580023145509707 0.52009197697348686 -0.44142878337427921 -0.63585795284044011 0.73829698815311173;-0.078722567087354617 -0.15406266580360087 0.068343658292029374 0.5854162118695011 1.2537394843117786 -1.2935637173420007 0.53883141680089464 -0.86092030728460389 1.3247561608886931 -0.049489977060180407 -0.20640333208408149 -0.03618878205388415 0.69325265684799409 -0.20816182793420265;0.42826897074489961 -1.2072853085208277 0.072790835227754702 -1.1484682385987313 0.33894999333533399 -1.3412232052899959 0.74038627679258506 -0.34662378316928782 0.25251527051589434 0.064513513033219755 0.61796477971346642 -0.60933637473427071 -0.67599801759327161 0.32748967945982721;-0.019924178123867056 -0.33254744314822243 -0.059589061168986199 -1.7561387290436226 0.75729570818775271 -0.56165313967704733 0.0030151823018477394 -0.27286255619840372 -1.7651452197975315 0.17365229979054114 0.31027100864450091 0.027171730899765319 -0.04996114361116491 0.60702103015001152;0.54849834307671497 1.3189826072041171 -0.10098488037429389 1.5207840569644568 -0.63564870577570665 0.71740389403201432 -0.64823972524254425 1.0090720469391981 -0.84112126471898407 0.4009374706356123 -0.63714300964863591 0.66079515552881163 -0.32529399603324327 -0.44564066777395678;3.0709974200130161 -0.62903030410612826 0.83954177883007708 4.8570662619081419 -1.1119061621935857 2.3201371238870472 -1.5965413113487048 1.9273522913321548 2.1911253182916641 -0.45156255030474984 -1.9662155265559025 -2.3962014081991816 -0.1135314271245654 0.75201856227816466;-0.54296881646994377 0.24056618461273124 -0.0079369293461451218 0.63871175885062403 0.018619587418132029 1.1013282750042608 -0.5926363882691762 -0.43287563946099711 -0.19974937651604235 -0.24328312904170848 -0.4558913501549951 0.51111954823054639 0.2343416903640457 -0.023967562912503619;1.5931551580871302 -1.1411462842346789 0.95378148924641304 4.7902572968152439 -0.0020783817018204184 2.3321624561304586 -1.4556936261273348 2.5435689433337401 -0.18124320894358109 -0.66240763484173304 -2.253225121234069 -2.3818568470606514 1.8533717181294174 0.55905848127407365;0.18415710938256905 0.060147773806397707 0.15176511864497938 -1.2832712397685995 -0.60249699455035921 -1.3263704310686992 -0.073641051750193379 -0.15022664325921214 1.01823517805258 -0.2215060358764884 0.4847841715182728 -0.21347746062637829 -1.1221015528412881 0.72024663282096224];

% Layer 3
b3 = -0.91270158692985293;
LW3_2 = [2.4847300122909375 -1.2472634693376168 0.19050983637446767 -1.1333207921905535 1.6829873287589314 2.4111703744362187 -2.4686276609880675 -1.4662797534082288 -1.8537611579915012 -0.89070743596022306 -3.9933927784369714 -2.0029283127220392 3.6805921098295511 -2.2990047854630804];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
