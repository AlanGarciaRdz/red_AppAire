function [Y,Xf,Af] = SOXVallarta12(X,~,~)
%SOXVALLARTA12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:06.
% 
% [Y] = SOXVallarta12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;10.4712041884817;0.00782778864970646;0.0208333333333333;24.390243902439;0.02710027100271;0.00630517023959647;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.5118195544796249;2.1351394577324867;0.66270136889156794;0.97342640800266111;-0.5266179851299756;-0.30600777587368183;1.048505517234295;0.77795658127114731;-1.2548838619661959;2.2314222067618772;-2.0211636138052493];
IW1_1 = [-2.369415632422001 1.3525027601629021 -0.84918532192000007 -0.56689029666883772 0.085536373633376378 0.17037841635962833 -0.99767233111544329 1.1462418153379959 0.015764709625118681 0.39233144647668744;0.76641034994320179 0.043308742227234409 -0.66418794740250098 0.18988795313721343 0.042742704094808237 -0.010450553250552875 1.569516564732667 -0.049782997895364986 0.05640235079178596 0.14212676615636916;-1.7472849553663674 -2.4672620016438436 0.42446053034755615 0.11838428452502241 -0.93579049829952377 0.021158065998833669 -0.78781686000804407 1.9390258037777848 -0.28091537110101938 0.74360003542270836;-3.3410567017117376 0.24778026780571136 -2.1558860155392785 1.6029976530334846 0.21048774460648839 -2.3141310531684596 0.64263133920022963 -0.28397608231695837 -0.37584482678064429 -1.1436536247976063;-0.37072622971993152 0.66477487281844938 0.22734001067343379 0.65255646300468018 0.58571191299740799 -0.34853514144083964 1.2117939113490197 -0.26536625073812498 -1.2006178966970433 0.68452310824200679;4.0160169446665499 -0.023983800392376218 -1.9306912154698281 0.20822017190901482 -0.054742252811118206 -0.076395892440673199 -0.26209061226455471 -0.39438192967685981 0.044474630021816244 1.2873988209819185;3.8348656939570973 0.0048126970398499162 0.5280827782938966 -0.21661645544609368 -0.13376346969496095 -0.23865432176733339 -0.35167494473404814 -0.63991063832242023 -0.012090306940630071 1.3260213232436731;2.3676169790437327 0.23951628798453892 3.2578032360531104 0.039806959990494634 0.33703209731442096 -0.53676414793485239 -0.99394228178318167 -1.5793202675440463 0.09292403851000168 -0.50936491545371931;-2.3631470948854574 -0.046642949866618377 2.2512225792261193 -2.4554401159629169 -1.6803345875847961 -0.1144837513618366 0.6572380503737929 -0.078112126133672799 -0.19217881846820828 0.39218883944592858;8.7106911023823113 -0.11427297889972469 -1.0072525642086534 0.015590498390307501 0.18095067607560961 -0.43463243855548078 -0.58157308268009167 -2.1049125801267068 -0.14473596882384804 5.2321641371988123;-0.89523931688140534 -0.33948610132768037 0.71145961364312582 0.50871521445183498 0.17039275726391495 -0.11501436134793035 -0.63901976663860416 0.9585547857407527 -0.41144408746627392 0.90302257935345431];

% Layer 2
b2 = [2.2487590535312791;3.9104756886480816;1.0781443585849386;0.70185630209732597;0.26269233554469928;-0.27420947138481488;-0.58211017155638722;-1.0107325214320697;1.0937989891993252;1.8315992304921727;2.2609372324831121];
LW2_1 = [-0.20155774016515576 -1.3407169158721199 -0.086466921581518474 -0.057328394823871733 0.14574914976192171 -0.4153988118154463 -0.57807553670564871 -1.3738325954282762 0.23739986710895655 0.77323138778058897 -1.0067394216634933;-2.3052341220819361 0.29257118546072153 -2.1703406793789366 2.204249337550046 -2.4252929411059121 -0.26247021936650816 -2.0686346898005721 -2.1921869986508922 2.6637816245022274 3.3064560344264273 -2.4661299980409743;-0.13796127298496211 0.57790315252471947 0.14675157259786442 0.091675141418449999 -0.020326082710383518 -1.3651117843027205 -0.10519359910003814 0.98226791095582144 0.43763918268597324 0.47787355235361734 0.7350200615617215;-1.3625906728365835 -0.035167864505685001 -0.083767387068401644 0.16920439009136326 0.68712985560190376 -1.037517964500549 -0.19651569320258397 -0.71337442840091703 -0.5918500135013921 0.28687643775380922 -0.33292297471212007;-0.6062406832785916 0.63524194632173481 -0.052302794314475161 0.12018761543529011 -0.015461708548840998 0.95079467768305792 1.1844196729245553 -0.76337704183814581 -0.65124761362739214 -0.64779674760252604 0.68234261754347481;-0.28875490438202939 0.62680864251220891 -0.23759676432683297 0.078756092909078729 0.11444800156777113 -1.0680086971770253 -0.19419385396632172 -2.2200982810408756 -0.65706368251930258 -0.18549528643342308 0.67513255768272062;0.28367186216958068 0.54428393268463149 -0.065654567548598122 0.44428866588760962 -0.4291617136412082 1.1110747157065024 -0.68178585247583179 -0.80344237497286963 -0.38969589618401601 0.62853387192954369 0.5494638005454584;-0.59123936106541242 -1.4325796861174123 -0.26727456521123261 -0.056481484811264249 0.41748282006629045 -0.88809453710982489 0.085832978598502224 -0.91652643924438848 0.60557898912829877 0.28403746146242392 0.16530229524546908;0.51110693606260504 -0.36506710411033549 0.27415656968775975 -0.054359757200892783 0.6151541276674547 -0.72743393861459349 0.76282493387051464 2.0013089372847355 0.74914607738456063 -0.99196492482692611 0.23689202036991955;0.26515873799968354 -0.14633994694882857 -0.082912863811586968 -0.059760693720885515 -0.90722492813879529 -1.4050365672673828 -1.8371408645227532 -1.6298339584302866 0.37775000544494353 2.0532492574948167 0.19988334666621552;0.52173820709613361 0.051894326805244459 -1.1245428742821988 1.2158423787663468 -0.92602675680723201 0.13434880208161321 0.40652398808107715 -0.28424652732694067 0.59792145796462703 1.0224341822497749 -0.74236285140542613];

% Layer 3
b3 = -0.26228853312294059;
LW3_2 = [0.88953222428840206 -1.7234415565822541 -0.53681169419587937 0.12897728975493714 -0.44566443587669674 -0.16785612310501777 0.32684151258643629 0.29074710326523184 0.2956870439580378 -0.66729083073108642 1.1328619302438172];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
