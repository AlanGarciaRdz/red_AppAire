function [Y,Xf,Af] = PM10Oblatos5(X,~,~)
%PM10OBLATOS5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:21.
% 
% [Y] = PM10Oblatos5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [5.4557313443750344;1.3593847812456152;-2.0059080995557346;1.9121209371778911;1.3924227979888379;1.9773927474262927;-0.15168256780584544;-0.63891687619856441;3.7708177770195794;-0.44905835239825354;-0.50188562188316355;0.48785008748462039;2.0400699174648329;-1.7978333096580015;-0.71257132315745464];
IW1_1 = [0.23109621746132386 1.2318397782802786 1.1963613124290251 2.7058454577551854 -0.18809579482527619 -0.86115059443846831 -0.14964312729386953 1.3182469344357493;0.85950509426281707 2.7591607720900608 5.2264485246380481 -0.75429249695533429 -1.5252023887526187 3.1116882106746835 0.59575416177339924 0.66088782979056448;-0.58563369657529385 0.68688336364635372 1.6336098155276182 0.59430149396244614 0.23424107671146588 0.78328847735861862 -0.1823490963781651 1.1972275659809668;-2.9302215888343253 2.6408606388627831 1.8232584825842353 -1.8815651135480678 2.2807266714424568 -0.71117628483682971 -0.17684205701669523 0.20496091822700002;0.98804841674414279 0.75504885923811282 2.9469488037515559 -0.76893463289995678 -2.1138188256862054 0.30812233240201925 0.28801992337963722 -0.030147617360154096;-3.1695152501732697 -0.64924945594018446 2.0211309474650898 -1.473431879770323 1.9047725308143355 1.9264935129930609 0.762545867735961 0.78889375418650698;0.44397598146691297 -0.14057296888943047 0.39471312702586547 -0.050074365371085824 -1.2804682877081563 1.2581694548391522 0.057541639739734279 -0.90140060548533019;0.58376256557641182 0.50695408525210273 -2.4588737601846367 0.58932184119469211 1.9175220343077408 -1.5217967509734145 0.33473248121714183 -0.089418927700028822;0.47236060070550473 1.0293241162672853 2.0294875706997382 -1.6818019902633761 3.6164485874000447 -0.087026472504767902 0.43121481968341685 -1.2413493014340826;-0.78333390966212191 0.78942501245716601 -2.8919581895843747 3.1237233828106268 -0.19789643163622764 -0.19255280703460728 -0.69158134133073368 -0.34127304934108565;-1.2482153994114225 0.67317599810983442 -4.5788628001345124 1.0898721353763559 -0.63201243981447408 0.12018567612929759 2.1178668954435551 0.53580889414667332;0.35090928145788242 0.58984820217734579 2.2159228532054254 -1.7335741033976702 -1.1580811240647231 0.4502630575181894 0.60604773329713224 0.23395491938210275;-0.46100629161173245 1.3578515251908823 -0.6228841565137786 0.21650327070591835 2.6868266573385498 -1.7680723163389211 -0.2290559528295959 -0.90001999244721909;-0.70208781387168839 -6.2496665151605075 2.2785719175010661 0.030510928770212789 0.8574751328985285 -0.17852912246544023 -0.28748375446122781 0.30996630110167306;0.48488720986936346 0.20707468405707177 0.04146740203595109 1.2677560522517288 0.42345307886116162 -2.2700198875681727 -0.3486849225551652 0.49986254443395167];

% Layer 2
b2 = [1.7629452733481081;0.94227416900967764;2.7575749775740008;3.1570580625923439;0.60767022640145651;-0.700480537282685;0.2265386434737672;0.5350416731001546;-1.741248247374708;0.18210149150849247;0.7793670850727259;0.79309182738284023;-2.8986269155904134;-0.69495459460880848;2.8073958816450642];
LW2_1 = [0.5410136462745686 0.020117620028406995 -0.48548965953258616 0.77315532944730248 1.330402832812378 -1.6698151493376865 1.1338689987847577 1.33406138128445 -0.56434402339457601 -1.3385911741704299 1.3088820322727976 -0.37623282412036652 0.33924843412205263 -0.28689442037053431 -0.42511753514776174;0.14649489087392245 -0.42030814458471716 -0.29424254000166428 -0.21171673105737157 -3.7433581282352502 -1.7400428562000918 -1.1892672505607957 -0.008699865254468012 1.5905482099490731 2.0093888982652257 -1.4913280196188698 3.8688417313104377 -2.6789549508719506 -0.22764600615406833 -2.756643894444593;1.139154704632541 1.103995694610878 -2.0210543149460842 -0.59210147508594246 -0.1740496518375253 0.73757727026026942 2.3895624120999743 2.0291006796397424 -0.22560395199816613 -0.80659307798497182 -1.0381422740176887 0.30083171853708285 -0.23162605052761254 0.42092696749155534 1.7037855606281136;-1.3410185507701318 -0.55252236188779724 -2.6098758645122064 0.85297639253714541 2.4364523888101872 -0.65243622042497451 -2.8549962697195856 -0.47715957240706042 0.61815563578084232 0.83454400286451158 -0.57140595852298681 -1.8293238958128515 -1.3192074898777113 -0.76555787388452434 2.4620325545363806;-1.3574349877690821 -0.15611439092210627 -0.22482306497865928 0.13196565077314948 0.33881787146335957 1.2353526059941988 -0.43149900965239008 1.9398462033249733 -1.9812774969741387 1.2962297880657263 -1.1270848224543486 0.26843045044336172 1.0397714680256001 -0.022526328619846006 -2.4785195699291251;1.2029718502637849 -0.51614383367670247 1.079953649605738 -0.77266814021206309 1.087450948514801 1.7626170391076397 -1.7836540744715066 -0.26118631684417748 1.1849405584737418 -2.3584635555506317 0.349981761823628 -2.1362472442359293 -1.8833656443217601 -1.1409779008482575 -2.235708740368143;-0.82064344206394013 0.14436553370399446 -0.3767949882089775 -1.169682819406529 -0.58564923682316117 -0.88944407895862243 0.18928575549120796 0.013845218426998016 0.56010895760059487 1.3029373297808313 -0.034077312086856673 2.0281938598846887 0.98822715991498045 0.70277327325313688 -0.7072907735574484;0.01209222274229315 -0.19740154287200345 -0.24457261626948623 -0.72957195125679275 -0.81907183728281452 -1.2214490346195523 1.0948773200927959 1.2258202705239694 -0.9367584453689749 1.4972313008975244 0.39618683145335565 2.6319023988972692 -2.0882614939488895 0.74052325130509389 -1.4198349488433062;-2.3483683545411185 -1.4276006204632006 0.68900122651656703 -2.9680928508006459 0.13677745946294473 0.83866442983555534 0.44078868775334129 -0.53990166610959778 -1.3621755057594744 -0.51385921100059584 -0.91624763902455997 2.3784802641503808 0.80589985106246864 -3.1730122571648001 -0.20898348840008799;0.39698555685389125 -0.48716399673846705 0.42377638066497603 0.55465225137669283 0.43179363028342443 -0.76268227473159123 -1.1957729083686008 -2.5909022817358367 -0.42114434147929658 0.2104424120262357 0.59713180877073213 -0.82743944798501068 0.81555447640126622 0.0046646459206608031 0.58586555945962882;0.53724952000238846 0.72696357968626157 -0.62392503446339598 -0.36213846584923176 0.081884341681307898 1.0121890068807227 0.85581110747304023 -0.11485053383796048 -0.68074340958640855 -1.1835689271470673 0.47639253120228647 -1.5811048934191456 0.65672612706679134 -0.53528471553332324 2.5561275606611322;0.028286339798304735 0.57464589355437379 0.049168288446126404 -0.90349897760320153 -1.041783117213978 -0.2399165721401762 0.29355924537143208 -0.22939329588049748 0.31947221091847255 0.79567660838228749 0.058388753696526796 1.2690283470260686 0.40588473761689198 0.48681223042164756 -0.067506656863300193;0.7031509300719565 -0.39385318057983132 1.9252064877488517 -0.25888652719263716 -0.022771757854938027 0.66715784272007239 -1.7395422763788826 -1.7333418493137465 0.73216281967715524 -0.05927201974795715 1.3145430017752404 -0.13188252090340177 0.97320802850663934 1.0907873212579706 -1.4071664106352515;-0.051799694694814991 0.48551114362919418 -1.11276858346955 -0.78704015362772217 -0.78064589115877803 -0.087533641354052505 -0.37998317414483607 -0.71437458292397138 0.21466101910659863 1.1458041977103395 -0.045694571700515225 1.2178942482888482 0.47470258182181879 0.59908494440183191 -0.89457584881544649;-0.63723473717230483 0.88050252387884198 -1.9386517377265555 2.1131704829328393 0.93384957752717124 1.1070361213609163 -0.3944513578670511 0.51869177548162237 -1.0230635644223298 -1.0302873497731007 -1.400129676532335 -2.0508969695871935 0.96850510523862909 -0.6466687731596511 -0.92481690703115038];

% Layer 3
b3 = -1.4411180737392228;
LW3_2 = [0.20551328152868914 0.37380385573149949 0.39782429751463355 0.31484830540717301 -0.14172579269966581 -0.12712271169537473 0.43385449671445464 0.086277936425038657 0.024480923136251498 -0.15514104269973911 0.59521196458875369 -1.0262344423305489 0.29526587928077336 0.64482339788811216 -0.1064542804501916];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
