function [Y,Xf,Af] = SOXAguilas6(X,~,~)
%SOXAGUILAS6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:18.
% 
% [Y] = SOXAguilas6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.4378510313121651;2.5008570254182656;1.1432142359830677;-1.0408361117653899;-0.63231879791686418;0.62445909754431361;0.13305737487156208;-3.6433614173804223;-3.4012079501995229;-1.9946991893578485];
IW1_1 = [1.2848162058466603 0.30724467560268875 1.0051359470390211 0.58469016294330767 0.95144697327599004 -1.1577326477013017 -0.053490507550985923 0.796988664199476 0.94029556667167125 -0.50969294508406127 0.21886716276633292 -0.89278032491750603 0.83715840487703752;-0.26616723788301705 -2.5620589081721286 -0.27786196802845853 -1.592350258164787 0.28314664113246174 -0.83108335111484366 -0.98438733881057239 0.40024968854767029 -2.1862598426898043 -0.33578511402218231 -0.17658137790020634 -0.7949511767938191 0.66498086912252274;-1.127576931822994 0.4675247041400134 1.0145050052699578 -1.2127530860942142 0.15979308653486873 -0.54698003684314589 -0.92383522146230934 -0.73268868173200619 -2.0632354479579447 -0.59498659668678133 -0.033695532482008128 -0.98831173337754441 1.0422011752585629;1.5130378203745665 -0.92726423169982541 0.35292291652131469 0.074847740955672704 0.87574899754136604 0.24429366456962154 -0.36419278875248495 1.5838745172950501 -0.049713653504839826 -0.66467056651230538 0.23667932958869148 -1.6704887193609796 -0.44114889184254502;0.42776045840892235 0.33513419989807974 0.10942122564863403 0.39254796557794336 0.34594579278142984 0.42086219599258906 0.1100532806405996 -1.243297141030768 -0.0074583019077513329 -0.4196722713792152 -0.28450131469095835 -1.1253227821051999 0.47011602250391937;0.49704079765967896 0.067557423378847223 0.73772847515113715 0.018454884382157324 -0.76640313025590701 -0.88376197297371606 0.31977033901017088 1.196421623961835 0.48967020339599454 0.84431221622563968 0.49513361644303433 0.89058390252617559 0.20291380149388372;3.4427136114339669 0.88738123914315314 -0.5284928472587036 0.38785313335150701 0.33782138986872795 0.77013736759075968 -0.19203871721367882 1.6418590365464121 -0.1132743940836087 0.020907197101984284 -0.47737179037103644 0.57824653046478414 0.12538548542697345;-0.37003390634207789 -0.28007369225793211 -0.077786514102107226 -0.32598222557548689 -0.30117241907602238 -0.30637631237849383 -0.096339919355217296 -3.0864126862037025 -0.0013811286852101791 0.34845571066844011 0.24372333595001508 0.92656633301737978 -0.39766079285919637;2.341003854003092 -2.4505151422758731 -0.54197000873863366 1.1824549260972148 0.60099298138014956 0.10206626709327873 0.47622953539935509 -0.46061220314539586 -1.6025795670586875 -0.7986991329857388 -0.45942236952491178 -0.9374339668138324 -0.0466293998478986;1.70784066790994 -0.62967461540859815 0.14673405869770481 0.39614185025961579 0.75955950566540764 -0.41281790859773421 -0.17285532358484784 0.51848036579693546 -0.74187523338947725 -0.78632241587202578 -0.20149180979295087 -3.0694916419474452 0.91969442772483312];

% Layer 2
b2 = [2.2794537846717398;-0.84465372606206446;1.2957049718401827;-0.036526839782242221;-0.53693607069937954;-1.3347501332384877;1.1746055938457558;0.2838476866663916;-0.85271825532560586;-1.6386960323512032];
LW2_1 = [-0.52019510634176513 -0.21518863420915171 1.102962631862898 -1.5759930876704407 -0.84821555466741438 0.50118242050184236 0.62494477831849982 0.33425248479857694 -0.14204937682493285 -0.44982777412946429;0.38400724556995475 1.1531604982416406 1.0875810284989171 -0.28045328833500216 0.86801735148933667 0.0093830238396175672 -0.092325914620902422 0.010791776326233942 -0.81235238346862682 -1.2473838437793427;-0.16430380853889792 -0.20160106794666582 -0.045756766081606316 0.23599996603281764 -1.8012441409769349 0.11503321321260834 -0.061685726159110096 -2.1862589489219202 -0.038368973115726998 -0.085760867425826809;-0.12949974881040308 0.83904977733459574 0.56125021435723788 -1.727532610920318 0.80479525270334373 -0.038612886064562819 0.22351956140404458 0.66793412783364625 0.43590049375293144 0.29591034580439202;-0.27159052610878726 0.084774561203547427 -0.90160205252114023 1.5079529857370642 0.25540449984083918 1.1879776231677257 0.051723313777081344 1.6785836387910855 -0.94095604989911408 1.5524335200260015;-1.1430231388803869 -0.82145588724449237 -0.94132340851478202 0.85925982802343392 0.25046415480843154 0.93039111150651499 -0.86547760648033034 0.91889022360271233 -1.3163335504621922 1.6667733450697002;0.025385665846212532 -1.6870870390363444 -2.6009812504552392 1.7244272932256595 -0.80563278050882547 0.62589060229718751 -1.2216617363602473 0.8300236459144813 -2.2938845602819709 2.1703567179009462;0.85725399274270009 -1.3093983834279266 -0.21256779189410549 1.5388665678300566 -1.9985551893260576 -1.1240824997427108 0.062253328580150404 -1.9404970629719314 -0.42250624931922343 -0.18662274248219637;-1.301756721543283 0.94038894627312908 0.35807896512279402 -0.78811184426428793 1.7943551252344179 0.0050410109121198947 -0.24173575853970142 -0.42607000340150319 0.10540448914819268 -0.74851667054598692;-0.53079088775197725 -0.90463021704575619 -0.95145290772353475 1.5863562887435751 0.070846182101377914 0.97142157774648652 -2.4634978382490567 0.78504949867943286 -1.5441382494137597 1.7232843563481632];

% Layer 3
b3 = -0.014378807729586454;
LW3_2 = [-1.469625854885765 -0.00027835397858505181 0.85210039772490132 1.5606222437159922 -2.0637318627563657 2.1313298240944021 1.9807811473744543 0.3854525704495958 -1.2533447467453205 -1.9133595226445066];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
