function [Y,Xf,Af] = NOXAguilas11(X,~,~)
%NOXAGUILAS11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:12.
% 
% [Y] = NOXAguilas11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.0693375109867596;1.1310182572002012;1.4374918367166805;-1.3817777119583388;0.042882425137850087;-0.45839896306615868;-1.474004342142891;1.2173589268816793;0.59213198995833871;-0.62961239639369082;-1.396413400360375;-2.0985886459000103;3.0430763364462776;5.7732639112065671;-3.3071620000612199];
IW1_1 = [-0.4438655715293861 0.15893280338108409 0.88203100406350465 0.41089099034255733 -1.3306717321286643 1.7747917078311892 -0.22032772061897912 1.8290211929246301 0.21668637749950931 -0.086501701292479388 -0.42060178947452243 0.015273458843077093;-0.34523340517369328 -0.51323551325418204 0.4282127521278552 1.3853986430244196 -0.3585508761059345 -0.0042243297344077557 -0.28675259954281018 -0.030672009062716887 -0.21755113316606692 0.36318374171232459 -0.19020142408812293 0.012173385066373246;-1.090330030108547 -0.8191630920649936 -0.64797911585796797 -0.48851286074350742 0.38327022297476848 0.6540993154777528 0.39156538904385962 -0.99573861867342117 0.97326709237011433 -0.75811601040457166 0.033537585036267123 0.25744620500129795;-0.027994247550686635 1.554414359630079 -0.88906622297326432 -0.16819733527227618 1.0250928676287328 -0.64725238863272205 0.60309924274567928 1.6642946455254557 -0.75195434951501816 1.1821539271321215 0.44432754543259845 0.20159635406811011;-0.82674112315773196 0.38519022617523818 -0.048754982785631854 0.73894970898347423 -0.95453194420339549 0.30446689216325223 -0.28234743401543627 0.0054319414509478615 0.93927550951847039 -0.99611163502388977 0.038624872806706484 -0.30489242538961991;-1.1206812799305832 1.254596090375603 -0.25613393419982716 1.2342952404088561 0.2962002647610078 0.029978588497575891 0.64127683996886176 -0.15447290153480264 -0.080046741867155602 -0.93602410209717424 0.079893850702441288 0.64566216156065004;0.24361929996434234 0.96963556370354198 0.71947559816544471 -1.2321354790237902 -1.172828314737371 0.22441934841324565 0.5287276639146008 0.017660518105837388 0.95560661423881721 -0.93759085182199631 -0.2711183136477871 0.71114302222145354;0.50901066615104018 -2.7023602633439454 0.70694137984128824 -0.83134922715253412 0.62081941580100963 -0.6981249360456957 -1.2435530036535607 0.21436759673046527 -0.5926931666881784 -0.32411628394567771 -0.55705076577522938 -0.54162293716365062;0.81005227727342344 -0.75032884060566596 -0.26201008052610325 0.85177318931111412 0.26410658111663415 0.18798472866125876 0.42888570105918361 0.12808851907244587 0.19824947509829882 -0.27537135341838975 0.058850961768917374 0.28970114849721973;-0.27386403099829498 -0.57564880248762162 -0.047997499435605426 -0.79336803514023302 -0.048710088566143298 0.16838121502169545 0.32580263380122854 1.0319493113479272 0.12681865247071367 -0.36932387189585664 -0.046758471760493005 0.030193963952497752;1.7511822866336904 -0.18287121344053475 -0.48890963316508468 0.45066440597165969 0.39369257261617685 -0.90778195392888017 -1.2786493180767979 -3.4595641226005016 0.0081403185497467122 -0.8164672682444386 -0.20965330880115587 0.72236892277914388;-0.93569075094600729 0.36037281262184462 0.1059729692751667 -0.63941516776734575 -0.37591233418090408 -0.2302903864504417 -0.76469829942183742 -0.12044721390357271 0.39173946601313292 0.39285022719101659 -0.11297860549998302 -0.10014453776030126;0.33375186585279371 -0.71594281346341926 -1.0618049238991321 0.036738544466516608 0.88000509593951393 0.82602107578018591 0.40392226067533371 -0.41301493453251026 0.23042559225625672 -0.6432035022125715 0.83727673930485846 0.54734681286198095;-0.12970965029505394 -0.69943906267897471 -0.24834414608168448 4.6786650375481509 0.27443675268521123 0.58868641642692499 0.55976121779256316 0.41987374545637035 0.0067696933237126255 -0.47528375542528789 0.060132093613288466 -0.17458179228010459;-0.19244234929924856 6.4692133016915099 -0.5261753686859032 0.91355717226259614 0.57893315921577559 -0.23636841635598113 -0.23764534012458657 -0.25559326307444752 -0.49840625683583578 0.25013160244024923 0.37295932512951813 0.5144889791193471];

% Layer 2
b2 = [0.88173487290990937;0.8699688809672137;-1.5220788079112804;0.08354391671216696;0.52770523359023236;0.57906551054501865;0.3931130709941581;-0.1827209072349226;-1.0957185301296886;-0.1771923454224647;0.016075601013906413;-0.76775291790830802;1.7040105849095553;1.3913416472420495;2.8705858563418731];
LW2_1 = [-0.89357526565273226 0.80601096305548225 0.34781605411205296 0.13414231728511683 0.93249190773993729 0.50416436970249701 -0.4177211994162604 -0.86199187837586344 1.158872388315348 -0.55298758210665344 -0.77898582433934216 -1.2085371083624106 -1.0259901125865518 1.0313376410435715 0.79177142735564332;0.11053616864838864 -0.2187133522505478 0.34207991567440499 -0.03440512447831183 -0.1290545611082588 -0.78678722314541194 0.35602849073817655 0.19070503536747668 0.5154482965076419 -0.053471927817937095 0.21802324193831793 0.3546841821629676 -0.7120290985533394 -0.16988567840229657 -0.14363560242159704;-0.78114502857032586 1.0303624382796859 1.729586970348592 0.19680672113384876 0.70366598297053162 0.34843964581619569 -0.43980754886328366 0.15929920048547958 1.4365924068621585 3.0240366303519464 0.99724215755509416 2.4168294574206333 -1.0242105319641432 1.1044395802487696 1.5953774317095373;0.42858424946834561 0.055851709381031366 0.57094682642592398 -0.17014663070124378 -0.40712246092295684 1.3611576596550021 -0.86776197083511142 -0.19795347857573498 -1.4920932325294636 0.054570443660905361 -0.50972948916608019 -0.13116610453377425 0.15585708983750204 0.9630096332999547 -0.071406012238846767;-0.34427153374752328 0.74178867713806174 0.027133743170447925 0.5338827963958066 0.53465658641049152 0.36086306260767065 0.89041779903310403 -0.34067588920132308 0.50991782291573218 0.67119133869912273 0.7955576955240663 0.067299491276259366 -0.45127277178524305 0.31434788874760899 -0.94899530450957048;-0.33734658638506704 -0.65644599417110649 -0.72747254654494009 -1.1750116839913365 -0.018605962314141127 -0.87555319628400696 -0.074403058582600046 0.69511944434527295 -0.44213495050960266 1.6117987667337179 0.52426229862870211 1.7130540821758453 0.30054781218306537 -1.3792616767767401 0.2680400594624332;0.27699510540252986 -0.14866251501073313 -0.29201651908328197 -0.64422727450367845 0.53070200315756788 -0.47843006715328446 -0.43528772232155283 -0.23548417850638223 1.2262830587719613 0.93002422686312425 0.22396563270354203 -0.6603008190908688 -1.1646922811416418 -0.2988247540434274 0.32434064711196009;0.049644544830018518 -0.27366935881358118 0.070005608229983668 0.74148811424917715 -0.4526333344186671 0.097273223089140437 0.44245056502493479 -0.34696276076971355 -0.83678566856848136 -1.0247890162037838 -0.018245436316342106 0.67682749941340958 0.52370426678610238 1.0663912056819878 -0.5262842480923694;-0.58396239992087773 0.80705559271740868 -0.20928232477803979 -1.0639208529753492 0.24293170614316331 0.54075588806486941 0.91462768199615352 1.4194302535342771 0.72299568252571689 0.74232468268712282 0.49147331782587966 -0.079287675350625433 -0.7832594695391959 0.34328071982804548 0.39384399246922125;-0.23126560479214686 0.094426421750173933 -0.18669903367957988 0.032436639307214493 0.33965639546335447 0.8889481758033565 -0.10558512130924004 0.072397421518520494 -0.00055023103975249728 0.059118611878431294 0.28471847424577057 -0.57015392255239716 -0.48745976160319821 0.84638327451502549 0.45141026309067922;-0.26132151439114959 1.1093344671775673 1.0148383653250823 0.2225325817168966 0.29972985529781482 -0.0013022614801365892 -0.61140097608641097 0.66598274202775398 -0.84243456513190396 -0.95629729020166443 0.055676655931330275 -0.59251103519359671 -0.48884325468454126 2.0788389282610296 -0.35538146257140485;-0.78896202789669068 0.034741376860074072 -1.1423502424439149 -0.3297448471593844 0.21333212308498486 -1.6171753701878346 1.0262524143366092 -0.19158769138522672 1.2703740804300918 0.10523208149765885 0.31822775265763215 0.1745102368470437 0.35939380424328898 -0.71993976245173708 -0.29533049973276915;0.14938998680489007 0.81708586698046504 0.96972635288553344 -0.055161834213080824 -0.72824570151834367 0.21763962688184194 1.3702631431507011 0.88654925922525685 0.27590285592666974 0.096509069676299269 1.2309767186067251 0.047989927656774942 -0.0094313373938147375 -1.1238049448890719 -0.11899140741107722;0.42843128217985443 0.41736249849877632 0.49099100148679548 -0.31670587233145209 0.54370929296820547 -0.69026505157135942 0.47185623526664416 0.51374548864978331 0.14119470322425987 -0.46024248600603712 -0.36520645772555327 0.22594025835639234 0.36789634913917002 0.12092060362812576 -0.29782411662224517;-0.081663833401991265 -0.71829953789446721 0.43861627126523162 0.95561303325526226 0.58172728934707085 -0.022733581250065225 -0.16308214733065243 0.47960328273659897 0.84602097702393608 -0.34138343065640359 -0.89937482807687685 0.82015578544693291 0.72931817036096169 0.10312241845945265 0.98372880022973985];

% Layer 3
b3 = 0.37728132484317978;
LW3_2 = [0.25777766752024445 -1.0040111693894211 1.2801161069087137 -0.76429210216567645 -0.45525924466329076 0.20664683074709564 0.85415143600579957 1.1282474127249547 0.49203022988130801 -0.66749666100461158 0.69322937318333877 -0.78416384324321875 0.33734246220047709 0.49950023270825084 -1.015821981380995];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
