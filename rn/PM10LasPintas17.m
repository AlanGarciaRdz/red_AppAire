function [Y,Xf,Af] = PM10LasPintas17(X,~,~)
%PM10LASPINTAS17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:30.
% 
% [Y] = PM10LasPintas17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.0251256281407;14.7058823529412;0.0179856115107914;0.00280033604032484;0.0558659217877095;0.00576368876080692;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [-5.9720783238565405;-5.7358379702127031;-10.608824996464989;16.306260001360965;-1.7192535879391775;1.5901295361191214;-0.23067635930068048;1.0678603221950771;-0.11021614287440809;-1.0812238498841844;0.30832915683555057;0.3410390764355094;-2.6082806980567654;-1.3299412721908566];
IW1_1 = [9.9367388469772315 1.4714557409351441 2.4601125712849399 -1.8742528327386936 -6.2096037051280843 3.3690583175497149 -2.3638905522334777 0.23326476038843053 0.42552814407076117;1.0964183693732774 0.18194487804755369 -1.051926534811138 -0.33590797659762162 -0.68085557989842005 -0.13506528137033946 0.1247001854487481 -0.37220339164093852 -4.325246002213297;-0.43548395484416114 -0.076877211869823853 1.3637191641689144 -10.521540855464384 0.25924732880167911 0.50723058422710887 0.43004332799284128 -0.00061077880409449734 -1.0594241496869437;1.5040581781039803 0.18224865395215356 15.143771689329835 -0.60446551686204786 -0.11788792746140567 -0.43463450111296931 -0.47643576536176563 -0.11462416930750759 0.19149731351228988;-1.7485103244907914 1.1964924360420226 -0.92819743648243835 -0.89234967947756416 -1.1905758298604669 1.1826883503357781 1.6871383619559934 -0.21476500063329765 1.6838166127125163;0.748589039759883 -1.3321714091816539 -0.077645723823961732 -1.1737140658964142 0.5386400237936555 -1.3773523919725068 -0.90331640445707972 -0.38916402758105112 0.51264028269885087;-1.5491011021872956 -0.52842676457617155 0.75126120665419516 0.62313687198982615 0.59813291682700742 -0.24810106247959385 -0.70411185709567481 0.20948575359403676 -1.1267336989241861;-0.3018803665453122 2.2812847287869507 0.17982923920590577 -0.21619728370504121 -0.40440046206887392 0.64635964027919024 -0.70253333490301295 -0.04442341253246164 -0.52472817219341994;-0.75527967907656646 0.3296862247495092 -0.04621211118769078 -1.2861127372179555 -1.3550807238530698 0.31451241674503133 -2.0939157874782715 0.052324264622636035 1.0444706168961337;-0.46110704479040099 0.099248935856604451 -2.1474415832255782 0.029945215841221059 -0.22086290203826436 -0.48701497000659211 -1.2477445026244618 0.16728810005010991 1.4467348382916969;1.1000058066294089 -1.4271169915995627 -1.9376342857302167 0.83171493130855501 -1.8459159754117214 -0.87260953180630574 -2.3142403627380714 -0.16100887448560255 1.9383024705450524;0.13978974164846067 1.9677956016927252 0.56741342177152865 -1.0723945995341626 0.20022227402685766 0.090682359606013549 1.2083343274913829 -0.17818786117569496 0.36859875302700951;2.1345711399871692 -0.58055846909876052 0.8536791347301379 -0.16557352066413905 -1.9228717656064129 1.5477490482248359 -2.7309620642854378 -0.65822314243804403 0.058102721884943809;-2.0708609940449336 -0.19052905787804403 0.49895649863345015 1.2814662267424395 -0.061913242651124571 0.31996329769206699 -0.61025619635332251 0.16185120249947921 -0.49494459450199318];

% Layer 2
b2 = [4.3366867385114825;-0.65801208182428883;2.7611808128235467;-4.4054788730310088;0.78713606442062189;-0.4056801172513691;-0.31779998879971494;-3.9955221273689849;3.6592155419475745;0.72299061766061545;-0.79268512552051107;-0.31050598389331813;0.80827984052632174;2.1894127743399441];
LW2_1 = [1.6340347111008817 -0.74471128634720396 0.55992487240660083 -2.9878536367750619 -0.32217709735618938 1.9655820759974141 -2.00099718352307 -3.2252865233393981 -0.048978793610831579 -0.019799097326795911 0.399346378108004 -1.4131637719289005 -2.0299512788060152 -1.3441045760679955;1.7981511091386209 -0.28409079778581514 -1.3088336116161221 4.1363719106559032 -0.45847544205137075 -0.2079649447102396 0.025770693227467736 -0.59174824043252983 -0.69930677987997725 -0.42365231000449871 0.38443882993981365 1.1953832921314937 -0.38145881259816572 2.3261129656726744;-0.5828059669021104 1.8152186567351745 1.3484053210412674 -2.211055164693347 -0.84449443307793637 0.69723708424994324 -1.8581786557083919 0.38636838358532405 0.22472787863601013 0.94121381381529401 -0.95499881685832722 -1.4136299976972226 0.45246294613303906 -2.0937556332145508;0.17568014225348702 0.84797482100937926 -2.5334399248980137 -4.4908370585342574 -1.5395285991998942 -0.011597267710912587 -1.5570731484489104 1.7526154123375022 0.24830827890890664 -0.088979994332648818 0.27818232386335195 -1.2322906438942012 -0.75712097483684893 -1.6233641707834574;0.064074080209129372 0.01674928996380174 0.76581278605464964 -1.9959645060718703 0.081547833483711432 0.016925140991051482 -0.20136795633335525 -0.92139012283251687 0.47550547405747806 0.06261041025555511 -0.1560597247795103 -0.99682534439061987 -0.48912283105336696 -0.4031597769804906;-0.87426590931299586 0.15214483695358638 -0.30087429258795217 1.8269346937813531 -0.36540913361274235 -0.66183214164379534 0.16758548988599481 0.3793762135206265 -0.13152272166010742 -0.069195465074899459 0.34449869678857098 1.2787439900426247 1.6128052728810176 1.0968459739831051;0.59223928144151228 0.22136219017635939 -1.1969876177912968 2.8980767733835981 0.56164108194080919 0.843301624307223 0.84309875012411739 -0.36099797355525137 -0.26264621444937536 -0.27786022836736196 0.43169859036134528 1.6802192195730157 1.6101119865544355 1.7819792196221198;-0.89774379343032951 0.1323273755545227 -0.97249650321338166 2.9890613749584571 0.25160238791797868 -0.50332999720104521 0.83634370469787844 0.43301254469530287 -0.33670657064504267 -0.30904781018251204 0.49299102594559013 1.986149503942831 -0.99485447272754257 1.8560863775219989;-0.28434649937493423 -0.46789140655617595 1.9347539463817958 1.6107474030493836 0.46621973442434328 -0.04949215119238972 0.82402525940615257 -1.4974982555488003 0.16511025777163824 0.28671461013429461 -0.33912425730150991 0.52110052972548182 0.36382615770958743 0.14800152032896613;0.098449360364164379 0.055587791223634574 -0.80466347286944362 1.9554817274248066 0.50575775322367333 -1.0039814419465036 0.5663429634916689 0.79325375607149462 -0.45501051680831595 -0.10464623521130209 0.043825874930309323 1.041890877909929 0.50460929468629101 0.48275688385201015;3.6650217167703074 1.2401453197314274 2.0988774545948812 2.4436401359650781 -0.32415250992211497 1.504717763870336 -1.2378682763815556 0.011605824594009436 -1.6370858966273798 0.71807246257858603 0.066529831399439507 0.33701020476433918 -4.5543190109907483 0.76733809635755101;-0.25894170417689893 0.5150537816051346 -0.55372979183198656 2.2778612717880744 0.31919525990679321 -1.1285818010285638 0.96161855248638006 1.0705660042495617 0.056906120330204132 -0.12272665011884615 -0.33057049058541765 0.97141808897591053 2.3907714066725183 1.467511558581817;-0.11697490416690592 0.14268558208378199 0.43901467962971213 -2.7958643945695294 0.27970647491653827 0.15236880902466668 -0.1396515764224682 0.20410595340736512 0.53393991191323531 0.06274400456453634 -0.31632176936781176 -0.84175627223670502 -0.54078865800602449 -1.2875225733336251;-0.47428040315642961 0.58155238084681671 0.03091045689311369 -3.0871398255184741 -0.74984332254402641 1.0210786577646898 -0.51170776641182025 -0.24233662702924974 0.88423622279226832 -0.2055711033894641 0.51913517475713744 0.75442501246036697 0.81192461791200021 -0.068788535298444323];

% Layer 3
b3 = -0.38217908387009941;
LW3_2 = [-0.45090993307257193 1.1452368684194014 -0.27402956286100238 -0.75650856949255763 -1.5198415841635018 1.3717340977004566 0.47990722528330698 -0.92807443998671524 -1.134923034535827 -1.4949581284016777 0.18690372675350472 -0.8842856260491313 2.3776381109868163 -0.36745097245188157];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
