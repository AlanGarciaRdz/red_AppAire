function [Y,Xf,Af] = NOXTlaquepaque17(X,~,~)
%NOXTLAQUEPAQUE17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:16:23.
% 
% [Y] = NOXTlaquepaque17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.03490136570561;19.6078431372549;0.0212539851222104;0.0523560209424084;0.00632111251580278;0.294117647058824];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.0824542711559579;1.3025756977900351;-9.4572767694392006;0.90697671773846689;-0.43363986491852385;0.98952803896579;1.4092299728795763;-0.11521605200318592;-2.8138755139558009;-4.5817801740212412;1.7952518053834554];
IW1_1 = [-2.961452921404883 2.2680503534129555 -0.34008532522380147 0.2695797605450011 1.9626768404690587 0.72528823847220658 -0.19632742430702771 0.21736951183834213;0.14887257732334666 -4.2379899061919293 -0.10035958119188226 -0.15365851437814768 0.59952048323002982 0.17891371438507372 0.019864737352232754 -0.13430322602595721;9.3369244296778042 -1.595208727538038 0.69402760628759663 0.87841355291824352 -0.0066724195764367375 -1.001380071770207 -0.0045194744270653413 -1.0469636966926399;-0.72260448301736591 0.065501723435650583 -0.09985145270207095 0.15733130094249198 -0.13921871607554392 0.1392993618042947 0.033122545201752264 0.20006219372291631;-0.12135704997374291 2.936914722249627 0.072708875684092872 -0.12017562106570877 1.6734173190971209 -0.013999313600910196 -0.04592397296073146 -0.48533794564716015;2.3601372447022859 0.49814583833957421 0.26146692116417519 0.29602415074064731 0.75969316651622687 0.7451257330577945 -0.078318934478145016 -0.91158889386866193;0.57263298847805499 0.35482057952821416 0.18004103210067532 -1.6049663094118856 5.7471324148042422 2.682743188838733 0.81436561831826959 -2.6472522369729545;-2.4220844746666295 0.64908656307521073 5.8870462982734564 -1.0334584029033276 0.86634190756495111 -2.8741349066383002 0.63485675289644938 -1.0494678239850443;0.9903506956765854 0.71120671451840833 -0.13370478764478644 -0.63593636137896936 -2.3203167047617685 -0.59115345484003257 -0.54928799506048598 0.34900003542787938;-4.7006184286368056 3.3039055982279368 -0.38716177420648845 -0.7783533977250281 -0.22251107539473203 -0.44153735074591605 0.088874181817954992 1.5845535203073704;-0.29128709947189524 2.5023214773664604 -0.34547522624735877 0.063540207155020817 -0.33431468881024884 -0.16470556179724838 0.023779572354338682 0.1063353042589365];

% Layer 2
b2 = [1.9496693388487918;-0.0497372018461507;1.8261773326890451;-1.7149540521412971;-0.366531361831478;-1.2379206132118048;8.6974625248127282;-0.50262044735524558;1.38785460149299;-0.50792036297087051;4.933874987116261];
LW2_1 = [-0.65191224847910956 1.7587874665373355 0.62543694673534533 -0.18308270209204175 -0.83727894936623448 -0.82484584440482334 0.1003394813286806 -0.28267096339246917 -0.43312973940279609 0.080867215424634126 -0.31634008319036522;0.16380838563370967 -2.5351382940371718 -0.08844059545528421 -0.2093536284095209 -1.224254541693133 -0.77079624518506251 0.063760009573226556 -0.17810486865188865 -1.1939458035624642 -0.66169908505616248 -2.3878469985207209;-0.02926457772003975 -0.3726226831514331 0.11571628482067302 -1.7041773115789942 0.98091117569965369 -0.072639768271785685 1.9150136257384387 -0.42098943177436327 2.0991390737004618 0.81073904374280803 -0.86717041860839994;0.91415868340393136 1.6550882708994028 -1.2322521209222985 0.74227477623199611 -1.453577792439025 -0.10860414197393964 -0.68427194483424236 0.076343462841068369 -0.81119601611851055 0.33278571556972664 -0.23472093479621725;0.1566111188076991 -2.1832405457432311 -0.16892347394548499 -0.14406084145439707 -1.0427674419826127 -0.55816917036248703 -0.22944234360884425 -0.16773504604959238 -1.3757994694296434 -0.55718517392679567 -2.0040506897861472;0.0047888095178451051 0.35857600101849668 0.25175154906299424 1.6482443858179834 -1.0234862627088905 -0.04097954893535978 -2.4101081854379425 0.43118235044414988 -2.5720498034738073 -0.92588241896612355 0.67885691061516762;0.051889783995131236 3.1742666588490138 0.090183934299022772 2.186650976280899 4.1347594781603707 0.16647540592246499 0.7264853039237682 -0.22062946851068171 4.8889759680535798 2.6247185276185787 -1.5819010686874009;0.11498506409724479 0.75782442746883838 -0.83914066306570412 1.0071606723645563 0.30488775017170111 -0.045260110944083401 0.68349130097954169 0.47010513166336326 1.3155357810917812 -0.18667786059268204 0.52411325538043729;-0.47381379206214946 0.34739014634838628 -3.2764652629412949 2.0773598462778913 -0.30349561209928905 0.30152585089369388 -0.38787903487934894 0.80328231838116293 0.40324749323055958 -0.59126315196256463 -2.782522122377312;-0.24398498263700791 1.1794557512258868 0.6388377765748966 0.56694323580913997 -0.13021483697013653 0.47970014018592255 -0.4743499786758722 -0.066090969607980651 -0.32937635747682698 0.15515730628703167 1.0826091154845725;1.0845023280359574 4.043722592659079 -5.1157382095881729 3.0668963802342288 -0.75306561705788777 7.6606608453579046 -0.74536625888335484 0.23427232488515037 3.7116180257752731 5.5283206993822933 -1.4399136190941018];

% Layer 3
b3 = 1.1710018293241824;
LW3_2 = [0.77071653894345782 1.1758798069875902 -1.4618532743130586 -0.49308156042920176 -1.7162162507505092 -1.2136779817050711 -1.1296397396673066 -0.70920994176499497 0.43870775596086647 -0.64662064994641066 -1.2828598321812883];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
