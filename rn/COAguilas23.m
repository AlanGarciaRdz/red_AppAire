function [Y,Xf,Af] = COAguilas23(X,~,~)
%COAGUILAS23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:21.
% 
% [Y] = COAguilas23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;0.281968137600451;0.304971027752364];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.5522273157276931;1.608355210063195;0.49675571675310654;-2.2438936776284439;0.56728563738180193;-2.2807776857854667;-0.32848828441163169;0.3416347880053851;0.68399502329006912;2.5390919221033252;1.3577830317846928;-1.757057566491496;0.34403258233814871;0.390249567636968];
IW1_1 = [0.57691638747216145 -0.78435149252644543 1.4563562662730305 0.28699686826977938 -0.30972159139577143 0.24335082106794487 -0.54425287400020372 -1.6791450452267951 -0.09338582269141299 -0.19673467575690001 -0.48324335959616033 -0.76432382173790847;-0.69520429290289032 0.93262323922063417 -0.34082033928427197 -0.29949390580237423 0.11944727630536515 -0.22010496463127505 0.15034780847102078 1.4823449227292156 0.12442297231210672 0.60854406756146062 0.52151853346754173 0.15981763675952404;-0.27632051799887447 2.2335427208297491 -0.18395279995005892 0.15630386625236142 0.35784583103437956 0.53788530911980004 0.040806945207280572 1.5216704427138192 0.049400916205893937 0.30894603175204011 0.13115497934514736 0.10645997546725924;2.4293406559154107 -0.023676056763311921 -1.0775414210945911 -0.18959355588655744 0.30135953491422035 0.61320364605230071 -0.33638277312311587 1.1254632723246494 0.42946429535188041 0.43420383199568574 0.21242467029436571 0.42102276899366198;0.49611479960009969 0.64155285669874662 -0.3765998400819649 -1.2041345228914546 -0.59431978515819661 -0.75646903608901239 0.33137719336594296 0.15129337403353368 -0.26568074610971798 -0.37333251854373645 1.1315508313747016 0.86672976516576472;0.72121819936503562 -1.0033951809965049 -1.4713121949666215 -1.3947447872118126 -1.2553254085846757 1.2198763544575195 -0.04308783412090738 -0.82957200169770184 -0.2327144133799727 -0.64111729009513618 -1.4152303002455722 0.12542242153944927;0.43294184896826937 0.036467970864059611 -0.75362541763685476 -0.25156464012451829 -0.029450285247761349 -1.1231008416735697 -0.88468533974564012 0.44067429845005873 -0.23119357756545023 -0.27546262691304446 1.5867434839088732 -0.090627120797819177;-0.66192019596918616 -0.40038853070676239 -1.4275707333789214 0.74960644440603585 -0.52815673382740813 0.49512291747140691 1.2867596734829285 0.7572702360852418 -0.33969194595831959 -0.36531108571119902 0.24347673423514365 0.46858699048510283;0.23378103110684376 -1.394298387046462 -0.11446373083505369 0.60575263113408495 0.51072160009682877 0.28684060917529686 0.20030737586240138 0.11256630111803555 0.18653096976214864 -0.077903009591279548 0.12610156335655118 -0.21124815419822146;0.10313659019428345 6.9803770955180795 -0.28790393028139477 0.11542723444714686 0.38475379745210964 0.2705391581552406 -0.1093807308125772 0.50184640709900896 0.044226082918103406 0.20215210355057336 -0.081395913777398535 0.26987511801091069;1.5816828494672726 0.383111346767674 0.54492664371922994 -0.45597051864797966 0.23989658394851807 0.13275188635757193 0.19575828797544503 0.36843395431324488 0.11750832141626134 0.11240488757826123 0.066993376362787849 0.18078411618099846;-1.2304556700176956 -0.56497204895208564 -0.74481550388650086 0.21791796103765218 0.32460555375959627 -0.60673608007439439 -1.3986347262321512 -0.57571357412465374 0.29905465773338324 -0.13736407784426308 -0.41699287829075893 0.052356163354640106;-0.46003836155407812 1.2380446753374401 1.0890519270130343 0.21068076892873225 0.10490480698897048 -0.55535525328863389 0.26399205345615295 -1.3627114711888404 0.14586748075066919 0.20505955703916648 0.59706725076292755 -0.69602455707374655;0.059979660467466951 0.15810963762050451 1.3441833445907698 0.34183479801873001 0.076616238076401874 -0.60471711388538496 -1.1764403861121364 -0.42898902296778002 -0.029371829431194051 0.19813787867817087 0.54170691437217 -1.2814247172367343];

% Layer 2
b2 = [1.4604139093106026;1.499617863667938;2.1380241804619096;-0.48380093737721008;-0.54758419236376876;-0.75196035465612399;-0.65640217795959022;-1.3836765978225631;-0.52074412812787263;-0.44062645189711669;-1.9302395742734493;1.6640843122378295;-0.75414381258762386;0.76125673212114686];
LW2_1 = [-2.1954405639635919 0.096477622944026495 1.3241372746971398 0.38405204067720433 0.47293948811027431 -0.11029608599683231 -1.3073447796927307 1.5854132743355718 -0.13393902536691107 -1.1281002504413715 0.13973490954384521 -0.77777106307380184 0.93773969683227665 1.2465552942002345;-0.49469251918935453 0.0071326355472364888 0.11120268357971262 0.72455833088069665 -0.47842762953565893 -0.051484301050069251 0.46243124342152248 -0.027295896134312801 -0.89579555224640928 -0.52338479602161947 1.6014144022112879 0.65278374402811901 -0.098027209151308373 -0.42400229283542429;-0.28075756271637764 -1.3965830932685563 -0.53761700936949541 0.36580944276297506 -1.0524654168297427 -0.15616570178823214 -0.14273846052066869 0.47692139049598692 -0.71414128704950564 0.30795257552223371 -0.077822196124981341 0.44458022627592397 -0.9218767511794973 -0.23376711770811007;0.1350156061106064 0.49034163276832604 -0.76362717912975697 0.08422637916428502 0.48760091420011903 -0.11794570564858005 -0.29558737731569967 -0.87866178710493481 -0.31422748901125541 0.1772457982264517 -0.46961202629904519 -0.53277457512680448 -0.40930904708781801 -0.22459080457685321;-1.1885535267977581 -1.2628655559326292 0.96094156713306522 -0.11981045496446419 -1.0008754542197793 -0.27198115422677327 0.27380562648042567 -0.64491591806643545 -0.61666433565950951 -0.27088815621338963 -0.6111958654303431 -0.52105555774771417 0.97405677080717978 -1.6507688660632329;0.93079451126654789 -0.26089334408982695 -0.022962796217354919 -0.25539771066147404 -0.14681507273081273 -0.080171654360460545 0.36571772685698106 -0.53884893460390548 -0.25568433498314874 0.17763514881191342 -0.68713362467320904 -0.31505651318725181 -0.42614465929391609 0.087216678416510027;0.63228310403345656 -0.91120424514332687 -1.1797846333765019 0.8432900691818388 0.22731993812075293 0.60106536017648815 0.5767003714117257 -1.288553798817865 -2.0370971815748975 2.3454605856170394 -2.8425465008077211 -0.9455220867769909 -0.15044902249765302 -0.46874323000982437;-0.35601018747603502 0.48146497771214281 -1.1136683456182515 -0.073089670575169602 -0.41894886402941778 0.15201101156392322 0.48455837642669858 -0.54591070347671933 -1.3636449377643884 0.16268017893373735 0.64313836100024513 0.26031021834145518 -0.16824208400838742 -0.77755595281863754;-2.8005778612399883 -1.232337233668706 0.79377214662180406 -0.12813766590584846 -0.12292496151358753 0.76012088404908562 -0.38133232824282526 -0.84837218337979425 -1.0356100632224428 -0.13665364935781737 -0.99960101694927539 1.3557635907006502 -0.14792304882064747 0.862920631061876;0.68949357092918973 0.082754234806160704 0.14607042868816114 -0.058902736693216814 0.19013581946378721 0.67268382395239112 -0.18265900021644929 0.7998386687661353 -0.37065291693879465 -0.66131870478333132 1.7903023846278026 1.0815814915961011 0.76441142851151023 0.53821672581198154;-0.14088758345243707 -0.78941387124546136 -0.53696428471876734 0.67133388396169957 0.077142242923321364 0.45451977376251496 -0.69562564035115682 0.68663191721773709 -0.11086985708502185 0.47431705321780399 0.41073389720039283 0.53600077228465981 0.401750811660465 0.6949327535923695;0.22922553729179626 -1.4049185649075342 -0.023841219914081748 -0.33380985479869468 2.0599755390521231 -0.50953254196929354 -1.2995892717449389 -0.68417262271198165 1.7934112024307542 -0.6507983105086993 -0.36255179181225083 -0.97279353782745659 -1.2308599493960413 1.4116640827975737;-0.23064954557622261 0.10564574609179074 0.18579113068423944 0.18438740220612648 0.66260335492688716 0.093365999051653645 -0.33332568348506103 -0.24313806197287197 0.29665173183416477 -0.14615736515638653 0.052063041854304215 -0.16662538543765787 0.024093404509496423 0.30715440116382992;0.72490779439261865 0.27812971705611156 -0.50990430139302612 -0.32134823569813026 -0.36090290377667639 0.051119734627725288 -0.054177780732716202 0.27443346609849251 -0.45380730653141083 -0.20344128555660435 0.040084335212050473 0.077919447982722795 0.40629453612290278 -0.26239186697921796];

% Layer 3
b3 = -2.4802771508271153;
LW3_2 = [-0.41127483065233034 -1.0874199588747708 -0.43126418269783523 2.1801785901638167 0.72506588902560598 -1.8984284129366289 0.27042889003251291 -1.0166535859338812 -0.28433179617613041 1.2613353079298293 -1.9713830504015073 0.32930621832916063 -3.8597922633283712 -1.9504314530151894];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
