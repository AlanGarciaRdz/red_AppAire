function [Y,Xf,Af] = SOXAguilas1(X,~,~)
%SOXAGUILAS1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:16.
% 
% [Y] = SOXAguilas1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.9068709564155641;-1.6336846898429596;-1.5940051968907596;1.0541944781189296;0.12027560258384287;0.10842557770073127;0.1204183910162728;0.26846899165801219;-0.047909859063009659;1.1381735741591319;2.1260319888490025;-1.462489951872419;-2.0193992756881274;1.5649664427498755];
IW1_1 = [0.42736095640560479 0.37048838536346884 -0.35996742796971837 -0.19637077968761102 0.079374647758923556 0.042966933992356092 0.50220070870315781 1.0491009472908916 1.2017319438189324 -0.055542261624576206 -0.054000941232911825 0.36656730165416679 0.34995070058759714;0.83371189736239215 -1.1728840805622891 -1.2114108830882642 -0.054559271466691504 -0.79258776422028809 0.87677110190312135 0.042250514345427974 -0.46449743744579758 0.15650926753168648 -0.036408308799187897 1.78388616552746 0.042093351004289077 -0.66276313796724828;0.35758104054103568 0.39615238267520536 0.31080722858112836 0.18990048634257187 0.72607781639974445 -0.41512639959571168 -0.20749053849376764 -0.4311931877193656 -0.12927797935114554 0.45019601903099582 0.25221143738050167 -0.065374644604611426 0.19857361260015838;-0.36129676410684908 0.8990508892516359 -0.35994057359034903 -0.13679684478017279 -0.48750432334608162 0.24251451680594496 -0.60698134529165237 -0.40613207699440679 -0.1293821252754758 -0.192143619603557 -0.46518209187244991 -0.70444311170079499 -0.30298711976638421;0.35370441114217316 1.2192839703304359 0.0037942943241928463 -0.27629285637366852 -0.23277866552037962 -0.42333889979705125 -1.6058290046421109 -1.2204978880003434 -0.41356860169300497 0.021768230229067778 -0.1138287073901324 -1.7994297854313837 1.0646364675774056;-1.3248248741026074 0.95752112210969331 0.28644657112392019 -0.16440727236435382 -0.31076208433715752 0.86598598294050722 0.51755930052831844 1.5421815220803241 0.053597051948192281 0.0067465778230639852 -1.5454236286331062 0.51647205991718137 0.26594989649091244;-0.56094146386562005 0.47292169919035437 0.48420429549784638 0.22816293148076056 -0.030314810438408651 -0.29859544260538684 -0.42472678011622367 0.16321752604286371 -0.30435875455110378 0.12842359578337936 -1.0507699463217592 -0.00093047298033884472 0.39602307770994838;-0.049189174967844848 -1.5217173650542846 0.86506691597580854 0.36406254589034492 -0.27818770157441913 0.010678343657790221 0.026071582566133567 -0.64741422034950213 1.5525065565148359 -0.56077664944542205 0.41940214720117358 1.0549628026359261 0.050425306781345679;0.81231180388710233 -1.5472712425107218 0.89468863378772745 0.5578119484786912 -0.32827527410146307 -0.016886237417166439 -0.33366396662306375 1.0158120022874462 0.6094314712552279 0.16906487890126509 -0.81050878458105524 -0.21372839476155198 0.26547723005449164;0.097551650766626988 0.12054677519388417 0.12095331205624876 -0.43284077429501022 0.51034476701956955 -0.17093138746095748 0.38611276393313448 0.87608176683563121 -0.087638309524184957 -0.3617359744185713 0.044106834924135016 0.57440519891700415 -0.48767424959366951;-0.091706296053361391 -0.12207183751690631 -0.10460059537473607 0.45787475997989086 -0.49739399727894112 0.16564527159280448 -0.42668501776828066 2.3766982180639107 0.055803955821718348 0.36954813810124865 -0.043775508519239552 -0.57489896159242304 0.49750209112958954;0.00089697006640761245 -1.2722069514607837 -0.70221760614249851 0.14935048488431107 -0.1492732955180362 -2.353831143931238 -2.0424852784959517 -0.12392592383580821 0.73585032512397042 -0.54867061671810624 1.4584442324070657 -0.75714415420019998 0.66452519403020638;-0.059403682556497327 -0.28230966966536053 -0.15579620018803181 -0.16701364958933576 0.84793999797887942 -0.034921204612960652 0.055182243038182616 0.089317931574994958 -0.11525261492760949 -0.44966755239759831 -0.27602913323023914 0.77237528532430666 0.52165911235668572;0.52251202038230482 -0.67288493118303694 0.26660881379069568 1.0118509235836093 0.68498625996741258 0.76823097060459766 -0.9818374320121166 -0.68873106656716676 -1.0520114717782856 0.18244238876740562 0.31874939092113236 -0.20075640369430975 0.25060547398379907];

% Layer 2
b2 = [-2.2068073615686563;1.2610734490370399;-1.3994396769477329;-0.9372198788996976;0.57756292337897974;0.31976593671998821;-0.18759907961782785;0.30730459245189978;0.26357293540191373;1.1108740670029091;1.0046636275554082;-0.88760407234122285;1.638577419481468;2.1618226550266555];
LW2_1 = [0.98434941928462127 1.0001654820476829 0.45049734278339204 -0.93623059395818453 -1.1772210057540209 -0.57040195569427443 -0.64665945126243785 0.98800796459804907 0.74472388227284814 0.61360580492251371 1.046791238783968 0.48465780325845054 0.5192660580490982 -0.081415345971190239;-0.47962181701870071 0.61569217120714104 0.77856081242894959 -0.83920803946848788 -0.5590596300114945 0.45770414694432171 0.6825525509142617 0.21052278803028898 0.3249794543772212 -0.46182842989757528 -0.063809280840549459 0.35835380891626367 0.044656723304809368 -0.36075123647559526;0.68484461718573542 0.92364505217075799 -0.16871445268620519 -0.070095879587196153 -1.686571596465682 -0.085220351498318705 -0.12285519124055289 0.95959352702207734 -0.90015453838944492 -0.55982715902442537 -1.1831176458569133 -1.5197327931620745 0.12732421163913188 -0.64047791463726811;0.15752688480122956 0.5070067559014465 0.13071188720933899 0.061124890231430321 0.81267137112573617 -0.38042234929995117 0.83934636172680166 -0.35669623775802534 0.51352734129153932 -0.42267453202513122 -0.044150563592486793 0.26613071773323754 0.060137209330842878 0.28354767080282556;-0.13724934544363909 -0.349459536729613 0.60062356260014194 -0.14462920912925115 -1.0085642675125817 0.88257755841765873 -0.64302713573042725 -0.54367257282942227 0.83322506060234058 0.44857438553997819 0.59124369885565464 0.26110990599600742 0.17470059819516537 -0.045064035269361258;-0.52384022239941352 0.1681006658823935 -0.19640599259736952 -0.13090623458453549 1.0316047740399714 -0.32319014052558442 -0.49340409232595539 -0.66248146170449851 -0.43392142868461464 -0.21641166424257147 -0.5933943578063281 -0.15920406781681995 -0.29900724770246501 0.81254216308838734;0.5020374443811616 -0.40382421169821858 -0.37512838120456188 -0.34244042021032389 0.43650124207763175 -0.56207233456464156 0.65166824104301568 -0.60748290402946903 -0.56388743163109112 0.49169308797806344 0.37349048602213336 0.25509185790678113 0.55638962590636842 -0.4509841114802115;0.016921689729645945 -0.055695813153150975 0.41112741364168665 0.56353164701297642 0.1776955562289026 -0.44340589566704203 0.020026980124550689 -0.24306411168931644 -0.43663318932819678 -0.7984638573042987 -0.35348797785405967 0.14752957857896049 -0.76370981396589921 -0.97812454162106088;0.37591485530545499 0.48334941694045586 -0.39107785141168855 0.24894521685804935 0.90847458396276592 0.41291675004358619 0.19971752160922177 0.35874986069717385 -0.57252600325600955 0.62871698362041883 -0.03587019154390407 -0.1619141030368606 0.05246968027401458 -0.3298039305155499;-0.57876864277502471 1.080199950994837 0.057049149128316629 0.42048526638243389 0.01296110593949952 -0.86664398409395349 1.0682679353871551 0.5478588413998231 -0.68111979840783543 -0.57421507391026838 -0.97591510949564952 -0.41226957252464658 0.050001993129259223 -0.10356055421426465;0.42474219156082849 0.0082663502125036176 0.25386186879845934 0.050467574908526561 0.18794832721183916 -0.18077627254363549 -0.04550045964946494 0.11988181746691956 -0.070628358696765342 1.2731399587083603 1.2500673549725572 -0.076110755513952993 -0.4743050021118756 -0.11946142048527505;-0.92117157214376311 0.0022947426179390565 0.55204752939723301 0.38338340779949698 0.55556742514264079 -0.32138992787914039 0.099740976566933426 0.070887736547711674 -0.15358397381478867 -0.31231256345946024 -0.23934499825930741 0.011939765530867064 -0.64891612508395735 -0.072381518264515152;0.22153593598109639 0.5091340825429016 -0.70082702344286774 -0.32532792759961604 0.38227318747625183 -0.16259712701862483 0.12495489540887879 -0.67680404394781968 -0.54201573624211119 -0.78605537897382793 -0.17533341774292158 0.21229468828981005 -0.71974831753843382 -0.085317258278784586;-0.28669297512763497 -1.4364330161103573 -0.96179003884685499 -0.102500718996583 1.7645667304501103 0.1316147547418979 0.32883436027484081 -1.4917661619974789 1.2144037164099715 -0.010539547125846078 0.86954175540988143 2.3450151508411352 -0.91291554172118272 1.265307263530949];

% Layer 3
b3 = 0.43749716970780006;
LW3_2 = [-1.5047753095074039 0.016470365399479381 -0.59606037852465654 0.059642353360084811 -0.38623871096865092 0.2349825945400173 0.014936766637674048 0.08761051830208888 0.0342519474738225 -0.73261689227289262 0.81338588297351488 -0.91209496219623309 -0.35132515088333222 -2.9959333968387876];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
