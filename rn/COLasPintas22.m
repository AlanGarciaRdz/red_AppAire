function [Y,Xf,Af] = COLasPintas22(X,~,~)
%COLASPINTAS22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:03.
% 
% [Y] = COLasPintas22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.241545893719807;14.7058823529412;0.0179856115107914;0.0558659217877095;0.00576368876080692;0.212765957446809];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.7737203232142731;0.70323561992104933;0.33213771650688306;2.5951331549643255;-0.28366115557766641;0.7154739878222065;-0.40475481715949446;-0.10112574749439648;0.39433141544454275;0.36083399282458789;-2.5655377679782627;-2.0434314429382794;-1.8310715800191804;3.5379610675074415;3.5965430051864469];
IW1_1 = [1.1992144789984394 -0.27671540911129783 -1.1965270608903611 -0.11711387994044288 -1.7194542518165135 -2.9362240713841437 -0.085147822186551744 -0.1295837157231422;-0.087483935338325602 2.293585381490364 0.38956111791856474 0.20401480208643263 0.033234149518746654 0.44266761745246275 -0.090154527221081651 -0.025499403864541234;1.0562120647399931 -1.3189659780026577 -0.28643496495960497 0.70706818357957535 0.92914022907585259 -0.35410449334697003 0.38707120857547317 -0.6255815287919626;-1.6249140559294064 1.0881271533490782 0.30456758768172726 0.24598958737086363 -2.2989746229760879 -1.3321040066609586 0.10756875192613352 -0.67759994583638061;-0.4336496455776116 2.5539329114295675 -0.80749533569315879 -0.18904615084359822 0.1675697025977135 -0.27432950545587975 -0.071857072093147373 0.63812437180148762;0.28222268110658455 4.0187540674926661 0.07281882230831907 0.82385491308679615 0.35295499766473581 0.13100390668896611 -0.14358033877405046 -0.13314784696674725;-0.96935419832742653 -2.2574077553406382 0.16787507279867547 -0.755097779210534 -0.36063470182519197 0.11289735277990043 -0.078112650386671215 0.15796577619692717;-1.5143080610961439 -0.94986945703317704 0.59924560560139961 0.033765536218001893 0.90651664298543078 -0.85535515635282799 0.15671877620084423 -1.0085421509738441;0.75888167080266222 0.48408264568125203 0.34950701285511027 -0.29694679876767094 -1.0971873285605072 0.73040556219657249 0.15378955038637826 0.48271630896243767;0.85029637184239271 -0.32017720442259151 -0.12622364059150637 0.032058249760993279 1.7735483761134974 0.30882745074981077 -0.042718631429255124 -0.43740183065565524;-3.2190188629340439 1.4034238903277909 -1.0755299129010978 0.90058961454695374 0.81749948575349207 -0.30602711263491544 0.85097326969657139 0.0700500265877569;-0.27848677525578641 -0.076648065535156906 -1.0143807048176627 -0.64232036299585193 0.15659166593177792 1.0706689024763512 -1.2726187176870254 0.23272388707040281;-1.4084579544664386 3.4758760587286135 0.64592148184515852 -0.88736262532486232 -0.23673251287831884 -0.86309540829525389 -0.0045944959204939663 -0.23204043877494357;4.1799494459800819 2.1411684623537814 -1.2123586074130255 -0.47828677061579217 2.1697548904144077 -0.33744765191326437 -0.56931920318138673 -0.23078294016967876;-1.8989688257186599 -0.10036620038838076 -0.18378588347437194 2.1108261853354153 -0.50456116246091054 -1.6682903940833884 -0.18079387124825758 0.19574385259605107];

% Layer 2
b2 = [-2.7468255613117298;-2.5037310204073968;0.23195591168844143;-0.19505701887227472;1.5732470040968833;-0.51528500290690016;0.64059195702477278;0.78474818142364966;-0.57182196402760788;0.75789733173504215;1.4003422168814446;-0.80621362531728524;0.9984839725984237;1.0386314460533428;1.001721713064891];
LW2_1 = [0.63154450402260032 -2.960351485975325 -1.2374261086927514 -0.8617846865087887 -1.6612496529219172 -1.5783383631041539 -1.4213275561571816 1.3002815192510828 1.8519114742721223 1.193780457747738 1.0978829267528176 0.66849652774854562 3.930218848156287 1.8136788325927575 0.53224907634780039;-0.2365915620572408 -0.038408661035103063 -0.56344920086933359 0.38247299908781152 -0.44194568054303018 0.18775002513356701 -0.90983292696669227 -0.92988602220353322 -0.83100207678680493 0.063025693037970204 0.11607919187775728 -1.3297733623894441 -0.61719575139036864 0.72414400672133028 -0.20948251965963999;-0.35842163023758145 -0.72180099342505688 0.14184563517260676 0.53470508256783011 0.18961556047259751 1.6723135359021148 0.26877204949321248 0.69430063952255694 0.78157759914558878 -0.43077101124240763 -0.024658666430619525 0.38482873378401872 0.15539359296757002 -0.29127570326469454 0.021737251004533716;-0.2667046481100781 1.8379645755193992 0.32802868514904948 0.76173637942567129 -0.9516751535449649 -0.81760678154947819 0.018951377658315133 0.0019617696227458873 -1.0312684462107151 0.53263875327372734 0.51493319636265855 -0.056671452570031387 -0.31896549661818857 -0.36625915767338624 -0.17442840610317342;-0.51254813350097916 0.17416155976978448 -0.45699554642848528 0.016259687608537202 0.23189307781326052 -0.11881152652512766 -1.0361604890438314 -1.3828851646611275 -1.7766281300299371 -0.12359629808249595 -0.75033749641219116 -0.85919866041058968 -0.67194097112455109 0.20807134036654704 -1.4183613487873592;-0.72836960953763596 0.34345867593581575 -0.17587202406834021 -0.23561752239868719 0.140320352038279 -1.0217984435613578 0.15245457542724963 -1.2607787847558829 -0.2287067789566794 0.51460704457386031 -0.23630869141380018 -0.64305964789557624 0.036013837575094562 -0.20278947964852712 0.60674309235951052;0.0031963825079174765 -2.3344884512915689 -0.11791075361738669 -0.33364187484991847 0.0022406541820875333 0.77780610394164917 1.6190165956121549 -0.072070571843703982 0.58263813029013323 0.99998347844531577 -0.10880379304285334 -0.14921674301383853 0.24611894638523615 -0.51382907674617995 -0.077805991745073175;1.3291110439742011 -3.1370829137756391 0.3560958607471929 1.4235399474815822 -0.17545676823484282 0.56074523752792094 -1.0385640971631656 -0.82859915882703683 2.5515591512148283 1.8842531549723569 -0.6422417110026637 -0.97731275181549782 -0.50955515586753752 1.5332777153723995 0.37263806664117344;-0.50118201060526413 -0.21056652343336907 0.43046850593945912 -0.74834126082864916 3.3452112118391555 0.075144668005044227 0.94154550219488331 1.6500898940854003 0.93499358273278799 -0.32923226740239542 -0.67933781663179671 0.9264175466527238 0.88233008886367481 -1.0152902560635861 0.45344477657900967;0.21341736747195039 1.7033527097400565 -0.072463195426486965 0.052370172203731948 -0.63310803128476956 -0.4812468247422298 0.5482938897818902 0.37751851389615032 -0.18783279694086075 0.77035912262721984 0.46158771427016476 0.046054952364237338 0.017848649378030355 -0.39261913196097653 -0.043756351576596048;0.63707441500375672 2.0118451481311759 -0.89138606626560368 0.18909272470235025 -1.2449009729137253 -0.23217538773653532 0.44344755444306483 0.91433827793517941 0.089359715679476148 1.2445394221151709 0.76575306718055547 -0.038062902449958302 -0.025283957085534891 -0.7090546955068403 -0.22182351587527552;-0.23354457601811188 0.37545674288418851 0.45645925227542672 -0.7944461952839641 0.77703382713527314 -0.29891341197811067 0.73642653227447752 0.24998763143490682 1.0863094698623657 0.93583014448142454 0.20836713340813554 0.30819623310688182 0.47493097622033315 -0.67430105852486144 0.2311862723514046;0.63270313878211959 0.54855506048275982 0.093168473551383482 -0.15356996432351439 -1.3189550439822546 0.27645125539031057 -0.38040416244022079 0.96246792615434684 1.9886436122847784 0.66307229992547356 0.58770451202868579 -0.3574589951712992 -0.10104359717715443 0.55674451073415365 0.85276989972599804;0.34054818631690703 -0.20728403380609636 -0.14719727391968979 0.23718742326739378 -0.073456128983697147 -0.44020933516081945 0.042931310605670459 0.56271068468816232 0.35362385498304488 0.052352820755636381 -0.17146165775160629 -0.39067127374963295 0.011498465271700783 0.77099015901546775 0.17678430417365371;1.4075548100045785 0.049664364910527725 0.70668884869783744 1.0660556530279126 -0.93284628173475137 2.598999047364325 -0.73847163991401321 -0.96677906422606441 -1.8210585879206436 -0.91603413775165421 -0.53450692704851543 -0.92921379752764399 -2.2004721977439927 0.84936365783827972 -0.20444707720029165];

% Layer 3
b3 = 2.5130156988088936;
LW3_2 = [2.8577100101681165 -0.57065064683237998 -0.97341235113543134 0.93723966460868113 -0.8844562086780986 0.65102439188432637 -1.1981580307025892 -0.52750712519777532 -0.30593872724975424 -2.5582962173976229 1.10031210795891 1.8352112343173463 -0.83725448929707746 2.2717410306096237 0.70682541766371609];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
