function [Y,Xf,Af] = O3centro18(X,~,~)
%O3CENTRO18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:39.
% 
% [Y] = O3centro18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.281968137600451;3.74531835205992;45.4545454545455;15.748031496063];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.934412410903835;2.151043891386458;1.2524207707294093;0.42743536101538421;-1.4596488269753889;-1.6346004349071968;-1.7711048319057294;0.497375780335229;0.13917798035290474;-0.76870897763225032;2.3094075408344175;2.2383134656327695;1.4763917264710718;-2.2167586276650764];
  IW1_1 = [1.3772201497214565 -2.3837115572184748 -0.58752108516664725 0.7397001147414991 0.071689571263864466 1.0104063937263408;-0.49228195248490419 1.3954063734458457 0.70197850516954619 0.60386450172944151 -0.082669861079835108 0.19717781460508554;0.62281361869317864 0.92595287377959057 0.46395535733671317 -0.50916371428805107 -1.3742196155142672 -0.66563133157666998;-1.7572678831039568 -0.98899511616230551 0.34457601104276814 -0.061179370256733603 0.22641807213029103 0.54625770379127869;1.2550323414426765 1.1073981969252542 0.49216201090971745 0.48709552816673335 -0.066107383077385312 0.29723962233351914;0.16718731630241079 0.92247784773235952 0.70183305417152153 1.1153803636096582 0.20694021894806183 -2.7616675204210761;0.47443205954635587 -0.12979784486470131 -1.0699175046255549 -0.42749497317500623 -0.047136189840448192 -0.79846607160053817;-0.040467517231196924 -0.48250409684483248 0.21867527210863663 1.418872503698499 0.098937989372497689 -1.4572817287225932;0.52348471642346384 -1.878501790080775 1.1021021953402372 0.084869048367279362 0.63152703555384615 -0.47924735554129033;0.62545917180244304 -0.57810580530442035 -0.36243935270020194 -0.015246990597499177 0.12229761050646396 -1.3873212260405636;0.61627350830568051 2.2247745767105642 0.46002034308731876 0.67981156029608358 -0.14361674904967053 -0.3960606916732835;1.5430796144513204 -1.2710813943767609 0.56824561670157825 0.77296447166721627 0.248647193418818 -0.4329107100291284;1.3230095084837035 0.10069872374976239 0.38610014349485045 1.101238629586756 -0.036973783645995871 1.2588957732407915;0.33967650764990431 0.18303861415854455 0.13333289897977185 1.8454327494399281 0.19102994805679724 -1.2914336108031821];
  
  % Layer 2
  b2 = [-1.7421369423246553;1.4879738595102323;0.67696106469366857;-0.66186355885340498;0.32939843611892711;0.76900931730796407;0.54234713854620198;-0.13573484204783326;0.22452267284828609;0.39001938136298675;0.2005884837633031;1.4097220362462302;-1.2067138863147573;-2.083459722340169];
  LW2_1 = [0.63043234380641389 -0.64183637690847462 -0.44337815019886873 -0.098787306757066151 -0.63371737117971627 0.39283535929994362 -0.41484091604961099 1.2284643783022609 -0.68326944059171346 0.080000450172071094 -0.40375751372225588 0.4328148206837939 0.97686456477741868 0.56606019045757139;-0.81995347035484434 0.33195549198042013 -0.48308127704889375 -0.49302932882016265 -0.33910965244179209 -0.15531353165164599 0.3515394500976225 0.55027246862943446 -0.074629373538400517 0.6780743038845426 0.69252765133618233 0.068847728830705321 -0.83591626155577869 -0.35787345633477757;-0.4333565691828421 -2.0246309148039701 -1.292443301022248 -0.51215504965869951 -0.047443832253117858 -0.30798686252485447 -1.5901295712651622 1.2339418402536539 -0.94256212058960676 -1.0597512414853973 1.6784961905086544 0.072232318618151159 -0.95133389663723689 0.70775066124194408;0.59888493116416619 -1.4778728886246746 -0.38206395599411408 -0.75063607654496523 0.51875893270266493 -0.69657340225899789 -0.43015250182181125 0.06111046213151243 0.49983607861757251 -0.11993552052815881 1.7478316465515169 0.13891889585719594 0.638669282036055 -0.2789544359545264;-0.31265865528119696 -0.97282465038271715 -1.275499048064539 0.52179820431493473 -1.7354776137788543 -1.3735447555718854 0.56784620140586806 0.87683550543891597 -0.70440963950164792 -1.1992438656399107 1.2681075066065386 -0.038254812534911614 1.1476381249868726 0.62514500623959768;0.067307569261016095 0.30760394063132374 -0.38666024632422358 -0.28241593373821916 -1.3852874917449072 -0.21574207546342733 -1.2590353173940245 0.76779415427228537 -0.72869909424960555 -0.26817749472980618 -1.8696325096393314 -0.11505623412587687 -0.17131261764590933 0.50736883840484281;-0.62434302085851057 -0.88011536100629217 -0.38379060202253279 0.46926208388592355 0.60577942489621428 -0.50460543770491262 -0.11346593869077426 0.044969205611722324 0.12920755690929317 -0.057801020637434065 0.51837080489505549 -0.36065710283056607 0.22561061714747688 -0.34452685456058324;0.25256826605327204 0.62820113558485646 -0.55101792526017879 -0.64279820703736557 0.49690586961947225 -0.32160770045164161 0.28755867413794911 0.051618421174870172 0.057787265552244664 0.010714961792920492 1.1083489925856305 0.10545092109885419 -0.054571858919891428 -0.40474685180902958;-0.36151812318656523 -0.3236603228125628 0.037793783613587831 -1.2447703443441906 -0.765723157228823 0.12127074320274384 1.2716455864634486 -0.82190023883817187 0.79978264012590905 -0.62711619300753085 1.1583200048643063 0.78534077610762254 0.46668264070132964 -0.99569789076863635;-0.45392336750063134 0.30364867511662097 -1.3058419074764447 0.1448729113283993 -1.0782941205988141 -1.1579488936860614 -0.0082788015790174162 0.69131886430113587 -0.61103281375158325 -0.4630732962391283 -0.44706619393766783 -0.19632308961779626 0.79645672241574794 0.12059677266588498;-0.5348832455812067 -0.30945999472354985 0.84511712522066595 1.3371862552750298 0.5290479346171012 -1.236366411600105 0.44613883716794334 0.56449852001588519 0.20194864290261205 -1.4439094098172662 0.027202014809069613 -0.25803129647727485 -1.2441810558976598 0.91564435833671909;0.64265231643623955 -2.584494735500936 -0.007449298692202351 -0.21850021846258794 -0.77347719740745691 -0.04608173267454134 -1.480863805808083 0.40638145499163852 -1.3764791782044703 -0.88286066760352466 -0.37761145602022272 1.0420585888111402 -1.6901923662296878 0.13970983139862253;-2.2862779049999373 0.23918859274474369 0.014596712267368105 -1.0380863123148176 1.9114304877207986 0.66609810434314776 1.1678871865152916 0.72128024011931957 -0.85777904529583604 -0.55362636049391201 0.22557396078051101 0.43195676594173038 -0.0063982345479158299 0.13103246915291045;-0.12259965699056116 -0.34466688121425265 -0.71689269274929901 1.45045269631472 0.38798296264346338 -0.60822814399212111 -0.52622519324673833 1.7083866879769729 -1.3091527300057073 -0.74637222253636137 -0.7304821520204996 -0.73512273905310344 -1.9236565644524641 1.3950544949993031];
  
  % Layer 3
  b3 = 0.23464251688524074;
  LW3_2 = [-0.59718191358286921 0.39132844684682822 1.4470531158310247 1.0828949582307585 -1.6799211870062192 -2.1203288212464781 -2.8612392030100211 -2.0792237156394386 2.4730713934117632 3.1189741370465875 0.50439107035048569 -0.47991374927044084 -0.67857008303311206 2.1081017882601452];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 15.748031496063;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
