function [Y,Xf,Af] = NOXSantaFe5(X,~,~)
%NOXSANTAFE5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:50.
% 
% [Y] = NOXSantaFe5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.0310965106770511;2.5879879868065103;-0.76049998008114073;0.51621841398426682;0.12845191908907394;-1.1633575758411834;4.9562508249830843;-2.6352450077486576;-0.33792157093605996;0.14432533592088664;-0.8879389663851972;0.45316056720348064;1.5070478371859084;1.7818655545115814];
IW1_1 = [1.9541265308296385 -1.7642418858894435 1.435148461762344 -0.90384421175395324 -0.56764901943951984 0.62719669589744853 -0.23786049628064559 0.41164375922483615 0.6512309463164615 0.67457513752878917 0.52359022821224221 0.23297884323997964;-1.1357467622055633 1.0196395305413972 0.11148720016752135 0.5256771125271984 -0.43247857234912268 0.93449556273829171 -0.34768197460322869 -0.10553086652714234 0.25041560969442234 0.10965711550454454 -0.23088118464666152 0.86933980891275575;0.39104571911275582 -0.21115356838821608 -0.50917469593092535 -0.081280297954957767 -0.31831199728276238 0.23649739436525974 0.029029678973379269 -0.18997982601325331 -0.27330721015989429 -0.80920859436416426 0.28562282450545756 -0.084074905828991756;-0.86467814724370495 2.1601457378419835 -0.24263457390508555 0.38432339989849751 -0.11487425529359202 1.36495020612318 -0.12239558202147142 -1.1366296611366831 -0.13178326418299102 0.55715689882423847 0.83749464938308904 0.0088159240659223259;-0.75202397838652835 -3.8015465194405031 0.84741577496536769 -0.39019647961380333 -1.0951950609501702 -0.012960579517440143 0.053248873311941392 0.14186625394111529 -0.27520039806757823 -0.88301399996896934 0.58936411257261723 -0.61090090407309761;1.2115246615795319 0.27947949335440825 1.2731763832975704 0.42523860221598625 0.035575045914904957 -0.043402579842573633 0.15310924463197148 0.11352973974638078 -1.7036875792625181 1.2938434234837934 0.30197643707055999 -0.47808724891655224;0.27317657913445287 0.34941423312137615 0.15000679989188173 -0.030554471415141018 -0.19586397435221289 -0.034780509427996376 -0.0031468022116695571 0.22368108713595367 0.12908776204645681 4.2317900119312748 -0.28354867705872627 0.023559516210781513;0.21018875519812033 -3.6221172235816632 -0.6361127760511478 0.27989534780464864 -0.26295776873780818 0.12150756838623113 -0.016969705100223071 -0.29521273948901749 0.10193423839130292 0.23552486507529849 0.22687836916732995 0.22777261833417725;-1.7125405590565068 -2.1172640850569708 0.640907177678123 -0.077540256387487252 0.023847806770949692 0.58111273156380516 -0.16255256931806217 0.20070536228622277 0.0055284753615516685 -0.11698559712847867 -0.16813894880277455 0.39885951324264146;0.011954630628055206 -0.53837722634973373 -0.46247656204218091 0.48901025841556245 0.4419350294860776 0.5699673715314747 -0.094645583884894857 -0.60566239379353148 0.57758478558253112 0.6754138471581943 0.33058017263805228 0.18954697410810331;0.70872175374218183 0.69353463781308178 0.41805798769500713 0.039232647913779201 -0.9618697932699829 0.39648681470598018 -0.17018631535544243 -0.29039864299139218 0.19263506423289783 -1.7783578971344562 -0.4636479423440345 0.13544890683669802;1.0757615911645111 -1.6494472649114322 -0.86696170208232093 -0.15682398522909813 1.1779758489973724 -0.037813373382431258 0.24515683651408693 -0.46911705247872126 0.52698344285647236 0.74011187037397719 -0.11070533239603672 0.068582496318818076;-0.22042350050802847 0.11957211473996673 -0.2443166071621771 -0.30778798456863093 -0.14820325038809046 0.16840370772670316 -0.4923281640751252 -0.29615719908345783 -0.79945965812094755 0.50519284057577263 -0.50096304009306714 -1.275820652486291;0.3820170780729506 0.65449356975023498 -0.61313869692455225 -0.29182115653183843 -0.69053999649090314 -0.045657466116022137 0.60703741808270817 -0.71117433911580896 -0.19407993172617938 0.035565685594777366 -0.45214205581817368 -0.82580260717765142];

% Layer 2
b2 = [-1.7169915524767974;-0.97860943386437871;-0.89350129034951431;-0.10880395126816686;-0.73071129960494441;-0.59004902221525424;0.031150221043565351;0.36891318184392746;-0.33572465056450973;1.1365309087030508;1.9587941274804035;-1.0956012875831305;1.1919603987781078;1.4966634245436148];
LW2_1 = [0.55463532885168076 0.26253273067116178 0.12360209548948871 -0.55995272841832155 0.28928671232154185 0.50122821905796344 0.26050747096235477 0.90508399952774943 0.29429924121868106 0.41248881977483592 -0.7867771352374785 -0.62295833625895558 0.17491894582841772 -0.63253562369461469;0.56485194439609299 -0.87417758965533388 1.8221837208999749 -0.77251534604275363 -0.9923325513650143 0.5396463321123538 0.47484347667383542 1.4102142244980227 1.8003314166343318 0.48179780108329007 -0.20192474382598291 0.1373646278241536 0.70133792510960014 0.36307880157394223;0.21890017073891249 -0.28990622218719481 0.23930175663809616 -0.88710223758764828 -0.97361723472819306 -0.34878657136872293 -4.0899152770404026 -1.0861663097792711 0.89296490929283057 -0.17940017123164415 1.2030154071058861 0.35690419318586947 -0.022407854619978556 -0.41051863722694598;1.3089979048237543 -0.85578653006813321 0.14834898775375005 -0.010099712718417423 -1.5075425929568009 0.24273013104058086 0.1147666801765386 1.5201315702509945 1.6656858693738013 -0.7693217574288107 0.13400692480466508 0.42707703222048199 0.79436108558575991 1.0179891064400757;0.42212519305062135 0.57038360915597153 -0.29331786870980481 -0.036131703208537168 0.92386823454875733 0.069952987076462414 0.078576224072322925 -1.4644719578028076 0.56662665965133896 -0.56881322747875807 0.19446431526474514 0.98795230267533818 -0.44883001084303664 0.50197164485039514;0.32962419631533763 -0.19080960141320516 -0.75370140523890949 -0.42497179678755925 -1.3763072042450075 1.0647701322519054 -0.46354239763346056 -0.18463785344144848 -0.33984184371473447 -1.7032069997644352 0.4488177575006202 0.20934686129010682 -0.42914060932177106 -0.71440396586419597;-0.086914840542016619 -0.55334419813961389 0.27548595165626039 0.17596261990554263 1.4382519346331635 -0.69966540539837963 0.43034520008885696 -0.85596992008547523 -0.63480013398767288 -0.22289839224185842 0.73355326697704804 0.43724575985878272 -0.079084766941603962 0.3178795048500338;-0.1777780983869609 0.64631594245575485 0.67808189608689073 -0.17648008335979626 0.99968700498188545 -0.086418518334811734 1.0022410831112041 -0.099751249781192305 1.8001429754498093 0.34027905316130952 -0.59599266182984201 0.85627325648150943 0.2662048976305243 0.84171113813398857;-0.277715435691548 -0.69363319941528478 0.39065837067811704 -0.33855233824728886 -0.26856130243759518 0.13097894671354959 0.3042763456374134 1.292042811233336 0.047627488537179838 0.62028374289220412 -0.14689372380756519 -1.1187584930044616 -0.076378179328976586 0.31169785584407328;-0.042019019613724284 0.1734226471319634 1.1461349553433828 -1.2311920529891385 -0.74606690975703072 0.06969841474660432 -0.22095432320020492 -0.87612546685477377 0.90207602129255837 0.051269128771410322 -0.10734050248031675 1.18610964174261 0.61147823600094808 1.1047046396588798;0.21993891787906528 -0.87092019707341639 -0.08739236328047692 1.1163629141309257 2.6996529500737885 -1.298747026954862 -0.22835422275403164 0.076000766472760967 -0.57353612817973287 -0.70863193531496682 -1.6632344499600771 -1.7048900792505384 1.8862211107214513 0.46120877953106376;-0.37518704813564813 0.62522172252763153 -0.065610037046483119 0.44818776679643196 -1.1772029449690238 -1.5621217981075493 -1.1439954960988978 -0.12839081709768893 -0.18532527268162374 0.1893691079602825 -0.34631186239225736 -0.54705039243090625 -0.41976512618887468 0.64845601375492279;0.13268170175361141 -0.12288452990780301 -1.356841731748345 -0.47239685279839994 0.32561562245496972 -0.17010393342721636 1.8202117938617619 -1.0085290542332797 -0.021314083113831407 -0.17226355221746809 0.3814507168332224 -0.39647499161666067 -0.88514786183105587 -0.74586005613062578;0.4624755719702377 0.10309596932186028 0.21643156537417485 0.036932389651483009 -0.52069584007970648 0.16929712116414647 -0.79714468720093246 0.38903504900233021 0.74844318069063998 -0.27773313281694939 -0.19428241949698519 0.296002978216652 -0.13688037066366265 -0.71372307310671268];

% Layer 3
b3 = -0.87671217931145828;
LW3_2 = [0.63244479230599582 1.9940477130495218 -2.0069894364171366 -2.1019466888426912 -1.3151302533085487 0.49422640570455678 1.1852883982200089 1.1157481773178779 -1.1883643630725604 -1.0815385563227822 -1.8908389176719382 -0.15732262152577275 0.52917995981783617 0.95178239036231638];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
