function [Y,Xf,Af] = PM10Aguilas6(X,~,~)
%PM10AGUILAS6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:48.
% 
% [Y] = PM10Aguilas6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.1168933513833359;1.9082314843357355;-3.5820176723014332;1.4244582532113859;-3.2379447399138637;0.54727217057470712;2.2868406099846119;-0.12876201953125527;-1.3508603235633261;-1.3117273495343933;-0.78287877195045119;-1.7811364662859925];
IW1_1 = [-1.5191153054808033 -1.9161258215382768 0.55536981126132967 -1.234638853461109 -0.4297902538933745 0.06742536906985247 -0.35232175121684411 -0.07037788455212228 -0.25723458854527298;-0.91280422469435274 0.040050720183487598 0.20407433762807231 2.2991507766498671 -0.61582646969170307 -1.2144019761330695 0.90583106103752808 0.36565443564293254 -0.013556804123519041;0.10443758951894495 1.0104074654188648 -0.27856010965906164 -3.7460674752469236 -0.032930856607908093 -0.23289023935546119 -0.22583366197409604 0.066853411687019401 0.11244368739962372;-1.1088105956985856 -0.49424501444808661 0.013413760030699181 0.68677535748152951 -0.1364821477855642 0.066091040084045719 1.9705094996262909 0.32472665952438096 0.084611544716449424;1.2139374058386541 -0.48447214787466292 0.25240334431192529 -3.9877410396474224 -0.97770027826383554 -0.16248962886279872 1.0695034314679281 -3.3049524731045192 -1.1436704489253522;1.3459806316537515 -1.3212169187915004 0.04805682520837045 0.54423360069952009 0.67735071190394613 0.30393622792339553 0.58431087607244425 -0.26294241402156054 0.23568570774411746;1.2263359701024759 -3.4647691212582017 0.36527808960863656 1.3730850486416613 -0.97191694976245313 0.11109820499181788 1.051600006622986 0.16881420446465384 0.037522999881828653;1.6297791736983842 1.4686886647843125 -1.174151959358299 -0.39218025851158106 -0.58535844412560101 2.4227027863914823 -3.0761118115579342 -0.39789908041070909 -0.54792840190117642;0.37612257809895422 0.53118194773500638 0.56277901820581977 0.26348912641697891 -1.1738624447023713 -1.1560852065312386 -2.021228793887444 0.814304344188306 0.40623371651664791;0.41876804925538136 1.6176661794883178 -0.22412810544020528 -0.73754695328561115 -0.050256163409146931 -0.4497489485907985 -0.01577934342065896 -0.32722308335145278 -0.062767839787924912;0.69814408898825353 1.2287752681989199 -0.20182929683026432 -0.44969480316757332 0.44323316892082637 -1.1178634585190896 0.61980354436192742 -0.14870468718174723 0.18629035303203328;-0.21646886367529194 -1.9080794211498062 -0.074728415200566722 0.35477378859069669 -0.34945494644216013 -1.3907093246514688 0.045758961541126415 0.26556770507411553 0.049840878432483686];

% Layer 2
b2 = [-8.4382265924353366;2.742282192836841;-8.0511892127044575;7.0740455097257486;2.193598943777467;0.024948200016707358;-5.9269206303724484;-4.5017362696344643;0.12274200721245906;0.54552462894329168;0.79711369494969508;-5.9819385699364274];
LW2_1 = [-4.100610214769346 0.5901457289419455 -0.20148103386340951 1.1325440427987838 0.90893831427586058 -6.1318281499430114 6.3259857505821255 9.1985114613181995 -0.042741273362033927 -1.0031600400166252 -2.8966494657100963 4.4370201631558093;-2.5401770976078346 -2.5505209130937567 -7.9314284828983119 0.041958247503361579 -0.46218950111162899 -1.066614535683382 -0.36134572192018977 -0.29739524511387305 0.55418062411052016 1.0386897646636597 1.6179345442704585 -0.15276633572140474;2.5391495932047645 6.6653399000283002 0.81516162882177656 -8.1895631913654974 -0.59432018572478451 -1.715523413920381 3.6260933009188356 -2.7250368120469668 -1.5489360774273386 6.1618788856814737 7.0770361628350651 8.5659359432591717;-1.3290902299681373 1.2047622462845957 -0.063002192921252545 -2.8426611253303871 -1.3968418552385524 1.6183059387714276 -1.3475517773155128 -0.65658050081952124 -0.43153339800007612 -6.8779839596713961 -0.37763759628870847 4.4969737178429261;2.8398138646254178 -0.61094804169534078 -0.92491572407010048 -1.3141274927042792 -0.61327178502626956 0.66871025250744198 -1.4031330272123983 0.40903288527148518 -0.58444916026073568 -0.2779933067920089 0.96980295668434158 -1.5944356481300677;1.0765961620515661 1.609990530937127 3.1008381611244595 -0.47391957752307301 -0.041777226203800449 3.8963877417464636 1.516092977203235 0.88983083917647965 4.1583388563071892 -1.8929347728365307 3.6813719114637831 -0.35047704554924458;-6.0234242634693818 -0.20281726480012732 -2.1220087995070025 1.4422812629440056 -0.40978962444330957 -0.28842127550894925 0.052395528882681855 1.2903558392949761 -0.76099585661205627 4.7403722649447895 -1.2660494522523369 3.0958062538890538;-2.1203444540920531 -1.2366917237547868 0.83311893641147727 0.43523401449397253 0.57311900638650581 -3.0950328504463989 0.60393100146846668 0.059327189219851181 0.28983042840994777 -4.2994388647076489 1.430753246589777 -0.9439651169828589;0.81994530601690607 1.104183116967848 0.286605674645738 -0.47453801793795519 -0.096925856166999461 -0.093062660496190538 -0.19149075512682243 -0.57813944757908042 -1.2648769089185559 -1.0903372061022178 0.90727165241293883 -1.5347384278761542;2.4324515968501599 0.84605097018355324 0.26413626103960158 1.7045656148818913 -0.15871650256806252 3.2018109436049271 -0.8643988030481683 0.7895171306045714 0.49215319390232354 1.0721414240470899 2.2292507668889878 -1.1415559289495576;-2.9772304890205303 -0.62196138145406399 -1.9313021640938479 0.73621593015622033 0.37098824146257053 -2.5156603023945636 -0.41082366133177806 1.6381314459532945 0.57333804017669154 1.1898328426277742 -0.66248445612323914 0.4161183439375703;-1.3448051340903973 0.834357345680656 0.91156446847350725 -0.2535178730578167 -0.21126706350496369 2.1306270801169922 -1.4152507872468285 -0.43359325420552774 0.05108992869617876 -3.0607707400255495 3.4963817352332169 -1.8993110683640559];

% Layer 3
b3 = 4.0701076633237872;
LW3_2 = [0.13683968221027437 0.12707079912005248 5.1656121207578556 -0.025635798119950561 -0.079152670892656873 0.075239640430747393 0.09344971300188859 -0.18898088493541351 0.31902641357989558 -0.19858052028558812 0.1643935294958199 0.1300612504328976];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
