function [Y,Xf,Af] = COLasPintas9(X,~,~)
%COLASPINTAS9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:00.
% 
% [Y] = COLasPintas9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.241545893719807;14.7058823529412;0.0179856115107914;0.0558659217877095;0.00576368876080692;0.212765957446809];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.19710152157641;0.39930450795124728;0.17171329564279822;2.12908295605772;1.933969264420587;0.20926955390574686;0.27134371011460484;-0.36277811864646481;0.5163950771918715;6.911374130224055;0.38369985062151812;3.1384739044326957];
IW1_1 = [0.40862858123579066 1.2480528258551393 -0.46680791609634747 0.95591951268037201 -0.29989077981451134 -0.22765657537756193 -0.56778586566162315 -0.10016280858924588;0.15501038843405363 1.1623594881984316 0.58955465639902904 -0.80173076317139269 1.1033407327535432 0.89331106200999078 0.55344977444130672 0.25731455481255844;0.20511605258264221 -2.4112189491909688 0.013975662887082217 0.18161732820057933 -0.017038240306072171 -0.48027606130552958 0.18400358841472123 -0.18963358779095663;0.15300915437363352 -0.26220101344088137 1.6014139320928631 1.2054801016644423 1.0349346389895064 1.5232051090063887 -0.018098446748732407 -0.93443899105001937;-0.61092648695054197 0.07547325172206551 0.55565085947841253 0.3188513106810778 1.1965775231711142 -0.14707261885510381 0.1786406338670691 0.33937252236638277;0.79475495153073072 0.44183961569425639 0.60684045974437062 -0.2399251234719906 1.4315200350052155 -1.2283252751465006 0.34651843350703815 0.84150467511817162;-2.3247030888481377 1.8045009364063946 0.11935483512147037 0.26995486532311458 0.79293356882082022 -1.4812936503630247 0.31340337440684335 0.041997878554887326;0.20273284025820162 2.35776838512693 -0.3391239912925777 1.0290149793317398 0.060464444174395324 0.22925990173405647 -0.19932475332817887 0.13611714304052278;0.80153421187228446 -0.61424187423437537 -0.84642457077205191 -0.1310816222528671 0.16737359599473262 0.054339229045066231 -0.26941274917977015 0.30050471106127236;8.7183006195947694 -0.14088232160719802 0.56319729792405548 -0.25445993654316768 0.29809073457067248 1.4056042291098005 -0.017377664219279422 0.72038175295962403;1.80318545088675 3.9077564856702907 -0.084085640556220587 1.0360107936341807 0.20538276694518659 -2.8465799093644106 0.064590887755677007 0.99040174172332729;0.16749101451869017 -0.81384637934584059 -0.12927244536954022 2.4448643972295714 1.0981100634464294 -1.7775022041242798 0.25335388127218794 0.40741783833013751];

% Layer 2
b2 = [2.5217871841621617;2.3756255036344149;-0.31041099574797759;0.17867200260470822;-4.7395217107586634;0.11639456006463028;-0.31623862498022126;-3.1422609621734034;1.3933104590327545;0.3041924836359956;-1.8986335041491755;-2.9956091988940616];
LW2_1 = [-0.28878846339494285 -0.21903116618349566 -0.45608823122835301 1.1970871928441669 -1.9967730884139658 0.88165284085465045 -0.10735017164674202 -0.87909193446582701 0.62671339243625301 0.93231777960767603 -0.0068547174159817245 0.36404139971046462;1.1075165891666463 0.87796561520319694 3.1005251158106266 -1.1051050464429684 2.2662216454181481 -0.58121193525044434 0.57033600119643924 2.8820070088198597 -1.4304710686019326 1.0038540311854489 -0.10257816216912408 -1.8093775405633992;-1.4420265404917418 1.7011307012249166 -1.3467918329039104 -1.9071278383361776 -0.67539353023261062 -0.20078006368160117 -0.64817808942154254 0.72847740116533755 1.715185172693217 -1.2168479118984015 0.052600165626271997 0.58530448773737176;-0.4040024433064292 -0.78480282129640633 0.71807287441779533 0.43886263570656309 -1.1007931721672486 -1.6415109989003938 1.1135960403990848 0.63413195691502688 -0.55467422865975147 0.22808837438080981 -0.0083313875020797692 0.1886589248171294;0.89738513004093268 0.70718979495624268 1.2598214589491867 -0.15109958461210821 -0.76848216398728775 0.85051578982290466 0.37889167216003106 4.2639497490871996 -0.91559063101295424 -0.26389848276180894 0.81274349948855296 -0.4493418952396081;0.84895778752618978 1.8251852809346421 0.58262876873489722 -0.49173346558275943 -5.4357502894118328 1.2488842540600005 0.40776476781488502 -0.66761631644356823 2.7987038955327908 -1.1249110558389521 -2.34487658044312 0.82238714645859168;-0.83386704914948162 -0.77538536196031937 -0.65334340384713319 -1.2096000450461566 -1.5003958751126341 -0.30012160966331475 -0.88583139674621669 0.19221358849419376 -2.4490118848378302 1.7044574685689557 0.26577377724454448 0.25291185646366543;-0.22407725976184203 -0.1545451706074763 0.22173733488707226 1.1157414750900987 -4.8078490508390308 1.6347684395789366 0.0037658117130871527 -1.4632429982868267 -0.55452001982034904 2.3830922212625727 0.21869304510129825 0.9275381398148399;-0.23285539593940396 0.29952984828798579 1.9978062861628993 1.0829448672563768 2.3030199961782065 0.49682526117903042 0.41388338593133889 -0.015844332804395483 1.4481849674954665 0.077635822716113703 -0.30989470750582326 -0.15917223436235692;-1.448970955051375 0.47483998135077571 -0.40046613997531583 -0.27232624294610064 -2.0572935954221085 -0.47477383899089654 -0.10733525155686272 0.62100104919004018 -0.35870482631728129 -0.84414716634460296 0.26578463062000912 -0.075530692709899733;-0.87209982738475134 -1.2994772800514363 0.90952351979169799 0.64214293397972566 -1.2358938310628758 1.4895245268832644 1.5024099216609905 1.2421232886401887 -0.37471593300307754 -0.87272916897459796 0.6904871529919937 -0.3215741720218504;0.61128170290200989 0.40483161933538686 0.43265009466034887 -0.26030285653981561 1.7265989609265722 0.47137694852413714 0.77561328826760989 0.55819966284555378 -0.34160481851606006 -0.41486891425798317 -0.21030222748629143 -0.32650255898538333];

% Layer 3
b3 = 0.59409222615580204;
LW3_2 = [-0.35730952366649638 -0.86397186332992115 -0.15642338635912903 -0.17818470318844773 1.9329013712783758 -0.11252902473644572 0.67333532477712466 -0.65668578307293424 0.8890653848144463 1.0047195181152671 -1.0263805113525029 -0.67761863084824647];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
