function [Y,Xf,Af] = NOXLasPintas7(X,~,~)
%NOXLASPINTAS7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:47.
% 
% [Y] = NOXLasPintas7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.96825396825397;18.6915887850467;0.0175284837861525;0.0546448087431694;0.00640204865556978;0.138888888888889];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.2981426485380489;0.092398280645740738;0.24678474689326083;0.56258616836075115;0.49054487357316434;-0.99594018321187305;1.3563341972229017;0.23190327848944964;2.3888537176743179;-0.95509315956620711;-1.7607473686261754;-0.18539868449894278;-2.4594944833896037;1.893360179513319];
IW1_1 = [0.8755435407286779 -1.1080972872868562 0.54915894736810034 0.54192102545911613 -2.6025149288211664 0.29236922699273005 0.54663630214008396 -0.31155056807248172;1.1551226837240831 0.12722680797397024 0.58959330573552249 1.9334539149245247 -0.47480723312849871 0.027192368781544532 -0.57675042867350734 0.14694782841068907;-0.16283411503194273 3.0966133801540465 0.54963499314680497 0.58807743663028489 -0.28751541255323176 -0.02833046707655059 0.13968219563441495 0.14574211015054012;0.10389684071695658 -1.8720982409233859 -0.28384048950334417 0.25571153612139197 0.070851666538153085 0.071648761260655724 0.33601442469058634 -1.6907312522080817;-0.67348065040000238 -0.53636847296824319 0.056807280121512128 -1.0509140891510824 -0.41151397217744029 0.6432932356709623 1.6040811349957407 0.35843138313689782;0.28153775355325772 -1.1757814594110167 0.15685773999336403 0.074926223486595153 -0.27454950493967928 1.5617042635610412 0.87732906208353933 0.14848339679938097;-0.83959092675416813 0.7380836624738033 0.58756176946349081 0.31864955280734342 -0.29226747116646273 0.58585184655969769 0.60969268535011145 -0.038601062086316328;-1.3686868999825992 -0.33103318654940633 0.11493430873161362 0.27229518186313256 -0.77859062594544159 -1.0734447593260144 -0.45557324948954803 0.69406965350947836;2.1422920108624051 2.0951274614653128 -0.35849724490683882 -0.77406510513235038 0.090132603946955298 -0.84399773973722703 0.17845460903105595 -0.024561493729832955;-0.45635588344534533 0.22947427057176645 -0.94031425897832255 -1.0368031866679392 1.6577532697861879 0.78907611504331954 -0.15362990307324323 0.11478900926799696;-0.19506544981551677 1.2741072129285043 0.24885703329846426 0.29539595448271744 0.10411008672497968 -1.0124723906631077 -0.054048489391501316 -0.56104574451525646;1.2103598481924407 -0.39805930642077769 -1.3954601657188725 -1.9082724396648365 2.6864590840675282 -0.1706096726530747 -0.018018397482150856 0.41567115153306256;0.081997495092659592 -2.1749921977558624 0.13375805995635814 0.018624868417159161 -0.3155419345897823 -0.38476755420246023 -0.036174831921736629 -0.32071923590940388;-0.007951725964427751 0.96004378481652664 -1.1856911567219661 -0.29981021710945016 1.3795932977662155 -0.038950750029332584 -0.79490881956169435 0.035774963113437322];

% Layer 2
b2 = [2.3354413613767679;1.4483354280579865;0.46743932052856407;1.0531424499520778;-1.0765275914087347;1.0888237127371845;-0.034410062894852468;-0.53157355423709574;-0.080730226231268784;-0.39621645921045301;-1.3912779270434816;-1.7282660319963397;-0.60861860142469448;0.81911153928898739];
LW2_1 = [-0.29516020040675978 0.71701168589160791 -0.19402117680668404 -0.65427129532195472 0.081247006683501682 0.7068831248219728 -0.88448672248053084 -0.90927504144424576 1.2782091528967574 -0.54715711612710061 -0.063944980750800226 0.14417731962074332 -0.30389068794164947 -0.13092277558422225;-1.2486598420516948 -0.8146173522362794 -0.098756999041575796 0.47092210447324429 -0.16546387296173559 -0.275325511403197 -0.97023711084882946 0.0025205494216109514 -0.59916528535385383 -1.032266467256173 -0.36800127379759623 0.91943616877229895 0.051857931885557589 0.29471871087015689;-0.63443070963150572 0.63260101045661654 0.73435545501122168 0.34453610977155458 0.053135607048274122 -0.69267174337717541 1.0095273735844204 0.74460543968726844 0.9280132371966785 0.50233302921168033 -0.33150723785604785 -1.8443905841181658 -0.53231710738038485 -0.034527778703545571;-1.0246697080449709 0.68568622638993204 0.068942875064554487 -0.0038083574110981643 -0.98921599736888743 -0.85361315152197115 -0.27475557945056728 0.29303129140388529 -0.76918156743952826 -0.33788900668076105 0.22164118811915906 0.048077469382092453 -0.46936953162621492 0.9029906289888594;1.5473426157693901 -0.27754242648484678 0.35197803247887471 -0.31477747871057399 0.36337068520883981 -0.60109340895267716 -1.1418192000168588 -1.1521647500002845 0.28229404602464653 -0.065018305926937525 -0.18651468773261989 -0.54343306868269103 -0.88391132031053388 0.094729055836592663;-0.017037339984125842 1.1156475997150941 0.76145770720763917 0.25858385427316788 0.28439378352727207 0.78713116901254476 -0.63738400419039176 0.15996543040877939 -0.15516659474187233 0.75714436904651272 -0.3595209086193788 -0.24626306645008042 1.5359830320392109 1.1802015344425876;0.82148835963401468 -0.18255625996491215 0.018942959695397929 -0.11316061123644092 0.3392164654522728 0.32828876925011952 -0.38213810641291218 0.09690542839042543 0.2841520908297912 -0.58082589308815336 0.090775017859865748 -0.29538576596537008 0.41726325030788097 -0.30727893330333411;-1.7218070538688171 0.088441835706449687 -0.58768815391235274 -0.63845530261116057 -0.27559671177257977 -0.37741175567898605 0.65945785016387815 -0.9116706883225838 -0.10375803333328104 0.5018462967392584 -0.11063496042028757 -0.18335020124084386 0.55132268028406883 -0.9779860708262027;-1.28253357578917 1.6855627515228377 -0.012085065106384865 0.10227409748441355 0.59063915464477534 -1.4939325267564874 -0.47173235983660861 0.13579840969273854 -0.66413875701065905 0.73093708316644579 -0.22691373067725687 -0.42135631205441804 0.60466443950250715 -0.90845516245619684;0.70979814427933485 -0.76812084890826993 -0.49832595058711959 -0.61468603505572161 0.67173051672978257 0.083344027497860393 -0.39366071375756517 -0.77658488098743084 -1.4753364866502774 0.017488368312209568 -0.069580491545046072 -0.49077350662233643 1.0828623130840096 -0.032386196472514159;0.89265184988233914 0.23592726193467495 0.93659811545798932 -0.27737334702032113 0.5873445159857491 -0.17967023931829612 -1.3741945350620914 -1.2474515170165705 0.029807099813948357 0.26285081233349361 -0.60513472306988281 -0.71523591651928076 -0.67183156953994927 0.29014201247989829;-0.85018812928881848 -0.14763989175948095 0.47211235223946335 -0.32374696823485721 0.14006764181948861 -0.96367555392634641 0.35214388018557141 -0.31715659718360251 0.72714094664479123 -0.66315674880857567 -0.12502605327417277 0.18616156557440025 0.45702091520711191 -0.28113405055137036;-0.81277660669075225 -1.231711856586325 0.10565388519219297 -0.61597030216129522 -0.4142959200284862 1.6173992767826983 1.2581789681877986 -0.65059199200760442 -0.58396645479525966 -0.42623454019149715 0.99442289745599577 0.33402436584060519 -1.0584080397505129 0.9816117829749923;-0.24807393510542791 -0.75600745581075768 -0.96113673640940356 0.11474849372832036 -0.07413684161873911 -0.47349039098348117 0.1435298628450265 0.36826684133422571 -0.54928329577547541 -0.72226863391452722 0.57843723098112365 0.24218623218498728 -0.90932015728343352 -1.3611006717350618];

% Layer 3
b3 = 0.32522817786859159;
LW3_2 = [-0.94625338664183434 -1.6963782886510841 1.1453690762423432 -1.5867470148338054 1.6357435338229465 1.5933214499283053 -0.88261413019895096 0.6439510253119527 -1.1013067260938076 -1.0800382506026347 -1.4161240368003716 1.0726932856034328 -0.77070431851387478 1.2164314012491524];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
