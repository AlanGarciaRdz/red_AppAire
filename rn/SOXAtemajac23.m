function [Y,Xf,Af] = SOXAtemajac23(X,~,~)
%SOXATEMAJAC23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:26.
% 
% [Y] = SOXAtemajac23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;16;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.4454448680591803;-2.9208252043585663;1.213263099297937;-0.48865532257067334;0.37611966734643776;-0.70717629031992746;-1.4194096303937664;-0.18686853178412977;0.56954794069659875;2.2788778016913285;0.51438525479548802;1.4928710059165831;0.94181685790509695;1.1377085627472638;1.4478610818787316];
IW1_1 = [1.8693675835198151 -0.030509507618183891 0.51914284053391468 -0.50741435059852025 -0.21258571308681515 0.43487991456486874 0.21030979376782369 0.047200000740812972 -1.1720902246311971 -0.20157691504314362 0.77025685606088723 -0.51358630248103165;0.56825474020474398 -0.15732517579034094 0.057366147957588418 -0.8743190190250042 -0.13740235881740645 -0.65892887353800722 0.31529709214111373 0.20078182992089486 -0.41961276794819746 0.00036294879982356489 -0.12738087057792941 -0.9865641509530042;-0.65836658841650542 -0.6907869217168251 0.11847159263429813 0.43990233487040548 -0.23977131893460771 -0.48923917211403195 -0.35247454293339781 0.48033471715134995 -0.76944430115911178 -0.029595295143703241 -0.98517050343899126 1.119420123897146;-0.010054837289606679 1.7767026373605053 -0.79908411739572516 1.1754419528559961 0.42266542229296861 -0.083093077862562092 -0.50789845658158506 0.28753442861046319 -0.70084234483497365 -0.18182372344444156 -1.7245843200965214 1.7847679042093962;-1.433435829597747 -0.14263445625004215 0.75994776545915066 0.44290180271190183 -0.36542603268136375 -0.46475105583247212 0.031190754178549676 -1.4366959511989772 1.4799228241990732 0.0095153717318483197 -0.80526276117599138 0.43974888701488624;-1.0080123008196615 0.019350931251408035 -0.4270004475293887 0.35106684992620413 -0.93985706274525649 -1.4105077366813104 1.9148803661697151 0.24780473631039313 1.7533831161240243 0.28020825163244767 -0.72974599790350536 0.50548676289811967;-2.3966094187058644 0.17449204580321814 0.35732289147858737 -0.92868453573632015 -0.31017740542038241 -1.1261231544294357 -0.43222800713166493 0.30624958723915668 -0.95318645836267091 0.16336829308011036 -0.098296217568482003 0.086702659792903342;0.60652954424487615 0.45685416286285691 -0.097981219526408078 0.61703786307739683 0.24981265651052126 1.3090350284439445 1.4334632627668704 0.37515344855745325 -0.077398118118666676 -0.74664703785297826 0.45468032240048234 1.1735835994494375;0.80872627950088494 0.025405325135255556 -0.2366809848097863 0.32522599129491814 0.52439631706133838 -1.0139610326820014 -0.23484022656268219 0.95015347082648771 0.31542616716807981 0.4506285132502581 -0.73034544512222055 -0.48810337587048336;0.29335891288109422 5.5374995404112441 -0.65144060898877854 0.3885599698698109 1.4239953732395774 -0.011854915400239448 -0.14122040514960496 0.31540907546373442 0.44892393614921317 0.21368513134717329 0.066977766713748277 -1.7048032031983862;0.060045313202431665 0.42170844562869492 -1.9296021182748047 1.1136844153921182 0.34991643977299025 1.1150258191939237 0.34673343766307607 0.87773994679773559 0.4839317847034823 0.14263817182217428 0.85571536699047179 1.6200057905030723;1.4845131031575727 -0.14130255478734405 0.047623534182468792 -0.66474965467562119 0.18588082445842791 -0.5362240919462109 1.1037227061164319 0.29751782129868898 0.64234973608399648 0.21262931995630999 0.26265079582298928 0.45214531153827431;0.6640323575368523 -0.045136021521067139 0.042066518184699309 0.82583680236868862 0.12392120444556615 -0.74844694924571387 -0.28641317727500026 -0.45352333824011087 0.74124449816149496 0.3623363471051736 0.41990958990063498 -1.223337377722848;1.3244487367115858 0.102814188163074 0.079509777145653437 -0.0031203842588479434 0.51896831158189149 -0.53079614466793346 0.097848096924107217 0.26661235275409007 0.6356997863029944 0.27968197248540755 -0.55097521174318598 -0.48633903191913275;0.78243112874606591 -0.18688056154509936 0.2567254418315692 0.69378355356328691 0.31734976305722123 0.42883799798335626 -0.42236927977560218 -0.35135442510791631 -0.74466859770450022 -0.067524850903834102 -0.081526460319472485 0.26349162147637434];

% Layer 2
b2 = [1.5966360590187934;-1.6570406545697247;-1.4648062626008196;-0.9809678241681965;0.58072271760270033;0.30459264814531939;0.62117704438014332;0.38658795853285427;-0.43223757979658717;0.4333423716173328;0.57402859865874623;-0.80253034717662131;-1.3334655793162367;-1.3214138260076389;-1.2903535540594138];
LW2_1 = [-0.50252492582589403 -0.66708896345038526 0.24730978022522992 0.63039128573610215 0.51865449000734831 -0.18809038972701758 0.52477352068153826 0.27540304737373122 -0.6486182675225568 0.099841971429524098 -0.56389881697562572 0.066286481325548388 -0.052428041356641975 0.44544461171409283 0.26094906077482904;-0.47100949991398633 -0.26427867938762289 0.89174162281145852 0.57790390344078491 -1.7233219981441574 0.22898132558357459 1.3860296742144931 -0.40811769295038247 0.27140125824291794 0.3719454908753928 0.79436329489603819 0.31976253818460365 -0.76117938207883662 0.28865909104511578 0.20619809427015404;0.97315186004116749 -0.67087551743883955 0.94637674000782657 0.075319376159815002 1.8080396662378349 0.1083194499582996 -0.39281075747298577 1.0094844844354025 -1.107280601354234 0.073604331034700279 0.2120927805646052 -0.46674686712637675 0.46528778262983783 0.31788002476825933 -0.24209896289955063;0.19610795931716471 -0.76256545065861536 0.78986364423129407 -0.86739201353273077 0.61079041463048922 0.73095305996261939 -0.013542137475237219 0.74957830657820812 -0.24370946037266106 0.24645045544419777 -0.51979934381358872 1.0149197963735241 0.22274728112870262 0.12943895937528349 0.72334339944156123;-0.40458935085129993 0.13235814401045506 -0.70440909101696081 -1.050565115187184 0.076607822681422189 0.39885880899894582 -0.24841799780625268 0.11374024286603215 0.17912225325442291 -1.7112382550815046 -0.048262686126100601 0.11417725422354845 0.090858212245981687 0.29276646829786718 -0.3384896709411736;0.059970528521108443 -0.74374213335284278 -1.2032002950907839 0.79888663622793599 0.37285415280314654 0.75191436560111702 -0.38505586916062845 -0.80982612460272108 0.62099671844629989 0.011221034277714243 -1.1808791617536019 -0.42626882402491462 0.44675747325662651 -1.0671517592619126 0.14579776394589442;1.0675810528311755 -0.80280786769885226 -0.10467233446322934 -0.12110491506202298 -1.0302128864182583 -0.38084864901434934 -0.054375284825252085 -0.40243158685836611 0.65070935145894282 -0.12931282180433445 -0.3586990613535504 -0.89102406784145138 1.2233519818529044 -0.71439378120199659 0.17978821961450586;-0.29474217197776287 1.1174353704256459 0.1783490114458397 0.4707147512650986 0.28768645016755595 0.045352457467588626 0.28901274881156014 -0.46639761915283562 0.42646210222515518 -0.027283533846507779 0.94914311282759578 -0.16310574693765231 0.58617455775027194 -0.20873612370920497 -0.59453442114207722;0.84029721121550049 0.14912299837258863 0.18564388016599331 -0.067622858691910981 0.041236112809704288 0.6985037193097714 -0.10399825826622527 0.87925562566633997 -2.1432977363958052 0.1526147653825734 -0.92561587601622586 0.93958403731596407 -0.027216605944492562 1.4635728547812743 -0.77860848636136493;0.5134176703908262 0.92124350280414102 -0.73979679369915741 -0.018860042400284938 -0.3331785190367435 0.37193721384408102 0.55400752344206261 0.58158648715085703 -0.5005849396390325 -0.052137525956245101 -0.027666672807101084 0.41820179773757088 0.62908396886491325 0.12706944355457739 0.71694238629948692;0.40243294369683641 0.45774903872773443 -0.40721554583516023 -0.048495457668708358 0.39479299534163143 -0.011953014708322857 0.82147118949681064 0.74823592694370555 -0.31769540773362587 0.055305114053822581 -0.68698447853329392 0.75628025493501039 -0.6976503783699286 0.55818722038058821 1.8469616041721508;-0.17199584135215623 -0.055717572360815683 0.39099898764965207 0.18198092369803817 -0.15820229318604476 0.24248039781100819 0.27804900831047846 0.23546296452801735 -1.1220718080474361 0.041112161891810411 0.26423718167395699 -0.035311948032628708 0.95838936579876433 0.71705751701986031 0.038182368172668402;-0.68000763003870235 -1.0417882577624111 -0.38132108770117851 -0.25042669888626745 0.46254707075012158 0.026378630124490893 0.32689560009269225 -0.14384758612705845 0.48987000939157227 -0.061979935588500429 0.13148600812272457 1.1677780770905566 0.66110447016836049 -0.28382825150064628 0.26653682461973749;-0.62989184377886454 0.38133526087848496 0.0021661388778728488 0.39111017831597072 0.14267805203244677 -0.69397575637743025 0.51235316779558238 0.035061569813575819 0.56909827614838338 -0.028658820179666412 -0.011428205902301012 -0.15723211530912001 0.040189047202292182 0.71248723310362738 0.63551304488808202;1.5878715060365682 -2.4244508280220884 1.6347303803298063 0.24242761509247371 -2.411579386037606 0.97198218601301634 0.42939463477887041 -0.3391100872006243 -0.40502479262109936 0.27628566507674168 2.1079468732339013 -0.06380037450192913 0.9025283136043617 -0.48817247337644687 -1.336243305393888];

% Layer 3
b3 = -0.316013356324571;
LW3_2 = [-1.017232457419375 1.8756240817700598 1.846569694254691 -0.77667560226734345 -0.44152502094070478 -1.8664317301052973 1.895093542017944 1.4340444075479304 1.1380583447955104 -1.4896334762409225 1.4279825583842118 -2.2311242371816129 2.4262153999017673 -1.5591055384426 -1.8004932991870923];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 166.666666666667;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
