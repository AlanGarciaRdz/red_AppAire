function [Y,Xf,Af] = SOXAtemajac2(X,~,~)
%SOXATEMAJAC2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:22.
% 
% [Y] = SOXAtemajac2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;16;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.2654992346671703;1.6856836837837257;-0.87462367405939967;-0.46482225690631707;1.2062247864784974;0.80669570481504049;-0.56932126128043437;2.3164231212731869;0.77633225418701202;3.4035571008490488;1.8227502236881916];
IW1_1 = [0.23467597015446701 0.028217577014085404 -0.11251576058319993 -3.0954865497432218 0.15938850305310162 0.26218531036933396 -0.64376623851826154 0.61599474076290228 0.1965879898054104 0.033291802963705951 -0.23161190545128807 -0.24276039997099244;-0.60199374806804329 0.047032361685678106 -0.33231172517893942 0.30794052767058977 0.93303785195931921 -0.44656770592773481 0.73884682501977506 1.0917827283008141 0.5237687315913796 0.21475848336161407 0.66263581412075045 -0.31305252056809169;-0.19198830544136913 0.40883739027379246 -0.065849403471282458 0.17684656063301166 0.19073199775811889 -0.2905760260474845 0.70477349559578906 -1.054887567976146 0.57091941278553016 0.09207669654792823 0.30326697596120766 0.23346321774335027;-0.64330027437356452 0.35517513691380914 -0.66420106395641354 -0.010861261342974993 1.0991315047419681 -0.16429489565170502 -0.093518839471263104 0.36753861568530022 -0.21437125312354471 0.12369580645826446 0.54864964273476813 -1.6642295821487754;-1.3388642674304536 -0.31141625923122951 0.17906805164297349 -0.52859016740694265 -0.093616823060536369 -0.031040443232332633 0.13946404779039118 -1.5946871853084281 0.35250451941276439 -0.15688261861487329 -0.085882918850839096 1.0247149378465326;-0.024016648264087441 1.4245215379996192 -0.024339089540672078 0.16359980626588772 -0.81631380231525408 0.057907034537558681 -0.16317520399778437 0.48417532316071177 -0.42334475792627857 -0.0085450527228476125 -0.071847161460143097 1.1769258109598226;1.6320202153278147 -0.1716816036982797 0.94864034640446815 -0.25926975616177156 0.68939749157604335 0.94092885553616123 1.0993185557988645 0.035350240866615909 -0.25113600062766955 0.32699584320331609 0.66546134724672334 0.54767007926257982;1.1443372384420065 0.046489459551196349 0.041494090351568695 -0.39954920385223186 -0.12058938948995679 0.37790010456030854 -0.080154457940624257 -0.49712624892776103 -0.57635869032521669 0.16139715734560825 0.11655644225318477 0.66278528069368281;0.64965828413073112 -0.20378693487140653 -0.24882859074791291 0.21157032509157797 0.25201631076442721 -0.48845598762979681 1.1730456112441638 1.2267839288293099 0.80113782082317531 -0.16153707553619634 0.29976315646773821 -0.4976037400747334;-0.42360298105173011 -0.18476406558581554 -0.10747934902808659 -1.6997084702486029 0.17975670608904792 0.49276916226217221 1.4320172856672118 -0.3036489584248695 -1.5511936769994017 -0.72034540302425243 1.6397364864978425 1.0663015876715849;0.24969207836554064 4.9165042686171221 0.14077584277383465 -0.052851738185097377 0.44749384605855402 0.1777085446602388 -0.36699231252178532 -0.45203431523053644 -0.392047189758363 -0.27716040000897607 -0.16430013044019792 -0.48408395266196286];

% Layer 2
b2 = [2.3104840445315347;-1.3977532377618589;-0.085732529665177568;-0.53047349219543083;-1.1584293520778517;0.88104384941488312;-0.045813549358501057;-0.74775295664996333;0.44705355349414666;1.3525130028028096;-1.0367629196218915];
LW2_1 = [-0.28902147685513851 -2.1552111950135049 0.67132242784943075 -0.49346580821783642 -1.3404663092166047 -0.91891730547210271 -0.9762610854324737 1.8519777529510708 1.2193170668550606 0.44669601766502326 0.73939912500555227;2.2678400163909664 0.89435638846889487 0.17927682449434174 0.76125723916363264 1.2799557752253905 0.22941141215377686 0.54757815558964107 -0.19220646117656498 0.792430096354791 0.037637717928945498 -0.37155964839641631;0.49381174607705491 0.32780810171366248 -0.80598230640656021 0.072276541576197187 0.30311987453454059 -0.80825748538219366 0.093192809087003337 -0.76444905151240705 0.36852210980967759 0.81706664520158301 -1.4811463824450697;-0.19554637017017537 1.7637883130952143 -1.6921789667823712 -0.89265456735626036 1.2317627818528551 0.48233366944731315 0.8740312477969161 0.50434099235365837 0.068667568900293519 -0.4082501827115626 0.3596557355716159;-0.62879061479489018 -0.33625326540819223 -0.96848829595784935 -1.071623251534187 0.30677921809264203 -0.024354318049183452 0.8569963979247226 -0.11610145326631305 -0.78391950779591701 0.30569755169297813 -2.5274636008053153;0.042366490595689268 -0.48502262849855737 -0.034943458592458114 -1.3664103166496067 0.79400398037413544 -1.4702578705802682 -0.64687220378587396 0.3133396203897662 0.7423449178746625 0.61289470603665264 1.6322756426456129;-1.067092279454956 1.3909353416404509 1.8460683564168066 0.51948920320274405 -0.19195135331179544 -0.90411958940418236 -0.56269709162508308 0.88532622982709941 -0.88715148207615702 2.0660158853355544 -0.26279834472567948;-0.58459789311036925 -0.44191548301730477 -1.1150072582295534 -1.0211296026754957 0.59812593757864552 -0.53878835531797542 1.8917400816813552 -0.30345249794205931 -0.67216683368227059 0.38798517733377436 -2.5043705582804732;-0.89057429224156026 1.0387870848332399 1.6428216563777271 -0.50681042416823108 -0.51242079110932415 -1.0192181565681926 -1.3765458396808923 -0.43142540176012306 -1.0182126731667414 1.1479528388957958 0.55890739667023315;0.2393046112515376 0.18146543846835878 0.59151912188261402 -0.085644682488871124 0.24244792648398991 -0.44856552437159303 0.68683021656609011 -0.17874201435521633 0.27567100123957167 -0.49234716133828299 0.12642476627585661;-0.1441997174434389 -0.05998391344023498 -0.42383211385385833 0.0011334686620885354 0.071470987832356961 0.28784226557236342 -0.51054166763081121 0.18149532274533359 -0.26296948006175769 0.35405673161492374 -0.42345075364879387];

% Layer 3
b3 = 1.3674807936829019;
LW3_2 = [-1.3866393071587488 1.3795522087398646 0.25662341925639826 0.49999224378776008 1.7696101406731113 1.0725348893557751 0.34645841089744928 -1.6143967134151851 -0.99675194887949625 -0.95078878185019855 -1.1280218816868419];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 166.666666666667;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
