function [Y,Xf,Af] = NOXLasPintas17(X,~,~)
%NOXLASPINTAS17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:48.
% 
% [Y] = NOXLasPintas17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.96825396825397;18.6915887850467;0.0175284837861525;0.0546448087431694;0.00640204865556978;0.138888888888889];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.2647889866486368;-0.42492050097504369;-2.4281237439909544;-2.4835774030510032;0.16051974664717347;0.30712273137119872;1.3857492061786487;1.5976646749717562;0.02952306183605858;-0.28999392035047616;2.716039813596089;-1.3135925183799517;-3.0356052874824022];
IW1_1 = [0.30143651682063427 0.44938752132507476 0.56718314504473166 -1.5434173092543031 -1.223182144360287 1.0361666053647296 0.34008270061335599 0.09913925396908288;-0.21353897781507861 4.5275897629007487 1.2321072074843531 0.18518538891343644 0.62307481349181604 -0.5913711251615178 -0.016236320440742202 -0.22927519641992369;0.24134217192360716 4.0355301285026659 -0.60470234928239908 0.044467596478435144 -0.35490072636008602 0.77361502990833286 0.13313820019267983 0.15939696274117904;1.1394291598107906 -2.7615765997274972 -0.39636237211866576 -0.73978010785082748 -1.264116555322482 2.1737134308806274 -0.54088481078412198 0.35612891878708558;0.71938630073444954 1.5973046433329852 -0.58105000604405954 -0.15120837045059071 1.937292017664292 0.62656169126904093 0.053706441399427589 -0.25954761514393643;-0.12112722298638771 -0.59735856154977818 0.41494056116997002 -0.8026425376145383 0.47031417031938832 0.069995689604101907 -0.054905543950944269 -0.16287755424695483;1.0944891167098367 -1.5495535404615632 -0.45055712544354865 1.7241323993472641 2.6677498664372048 0.67322558583998882 -0.41798393177297827 1.0746082190040385;-2.014767257680941 -0.21547938479558251 0.039747822480885805 -0.25876109789783303 -0.27465902289180355 -0.32762931783987631 -0.060786764341101376 0.14050659799651663;0.024801330991768705 -1.6393067547856224 0.16880417353560814 0.9473661061866897 -0.19347873546639369 -1.5952768578213381 0.34549775165787328 0.12700443231954703;-0.12841989554373817 -0.64841392405893905 0.61855315582677572 0.71434783228097987 -0.63354933129285051 0.018019602206899701 0.26547043801295084 0.0045376544701531962;3.4976439259554901 -1.2025586641415531 0.12104587331860575 0.41278170195581548 -0.36636491239859542 0.89520313195398737 -0.14367342325265464 0.10890351744091457;0.88118702014228512 -0.10024959579781348 0.33753182130575599 0.92479886232344255 -1.376283991892137 -1.2350260601695295 2.0178322941398523 0.95784554063510585;-0.065817689006172117 -4.542178943291626 -0.069765128381210739 0.3525738981973473 0.47646265393602638 -0.1296262668590443 0.026252695231980025 0.65917903360537144];

% Layer 2
b2 = [2.633008582424901;-1.3292455618459964;-2.4946642125420535;-0.89544775149226685;0.15507296331799089;-0.11997670449932848;-0.2579325914576297;0.89065089940289588;-0.50266086145647071;-0.91976533911927694;-1.3991457727898264;-1.0632392851196517;2.760234840750214];
LW2_1 = [0.51377555672224728 0.14268348893105534 -0.55612657878124983 -0.097576301825377187 0.73568320131533083 -2.4002922742070334 -0.5928282529408645 0.32286462382383069 -1.5254296459332859 0.37851409625442839 0.40349792786259492 -2.0099161770781353 1.3489347195526633;1.7302556922864289 -0.92325715677155551 -0.90367170795314355 -0.48413178133084106 1.2929918283489985 -0.51118726971055006 0.49233651523426841 -0.24605958774112643 0.55466519090936195 1.6900476129073783 -0.0058599320549092143 -0.82093811579331399 -0.60378266919602341;0.17412396630381888 -0.73302678932966181 -0.21454360829731567 0.2802236944264061 0.73051388006504159 0.26073423731040107 0.63748183747728404 0.68955695622870994 -0.69722948175512511 0.25454429138973733 0.66641791381428261 0.66338799328034337 0.51842281581786642;0.34519551458858982 0.5011027199343544 -1.8989581962248927 -0.81700086944182881 0.42348690079539791 -1.9265318879016498 0.28190823906785445 -0.47384875426574763 1.5652231963100027 1.2191435290824391 -0.24571232063215331 0.50188286756928291 -0.13972426590800691;0.039732331850075936 -1.0658689072331489 -0.92455919002921882 0.75846614423705272 -0.67714679975374525 -0.022215000156991918 0.17083453823193667 0.28256920005086683 -1.769425139289134 0.88238813044878817 -0.33944956005915339 0.26637390405421013 1.0429440660723699;0.48389303690424779 0.79562645066978699 0.85889011632942491 -0.79476872237277751 0.95146151421782865 -0.022512888576918331 0.091122722270365886 -0.20046693225851792 0.89460159063661904 0.047886792238383172 0.3574662481088946 -0.58604090782498464 -0.49243653185719577;-0.032089663852437701 -0.91698864638092559 -0.98534896339926448 0.13103575748787433 -0.48654755842776065 -0.50185309164517322 -0.39592760010825384 -0.21651710592870579 0.35823700634413391 -0.37567686039493398 -0.58051601204413394 0.16892089445302391 -0.33996527835352919;-0.39783415746928474 1.2569705895608276 0.056077182519140165 1.1357323530880186 -0.98992779428937205 -0.81270926389990739 -0.17693824385258031 0.23046639458206172 -0.50941207027477875 -1.5912186287756418 -1.8275954458652626 -0.78116317890996367 -0.10996871171402348;-0.56598116555667644 -1.0219945355687592 -1.1527515133486976 0.51372456471224814 -0.50590993151424635 0.23765369487093296 0.031700498662936366 0.52079748963412886 -1.9956764200252457 1.1714119562596765 -0.14059760433250582 0.75092624487581316 1.3995681827398865;0.40544805015003516 0.0054406196673195961 0.25024362397556749 1.9485489903026647 -0.35115073482628589 -0.3775952942916484 -0.53557053776597852 -2.5571287373014391 -0.76612324889653305 -0.19458157582191904 0.42325935888260452 0.12965242711536767 0.72728109742245495;0.014797634892723642 -0.41246226085347726 0.1336535085400358 -0.61464318581826283 0.32351038776212249 -0.22858369518945593 0.32032528652364534 0.79303148005818258 1.0785675569546962 1.2510092964621751 -0.0057528600189022221 0.79443764634322211 -0.70669527757408035;0.60076105014725978 -0.29865821793743608 -1.1921378086354251 0.34952962329025522 -0.52301672295009649 -0.43798935945403211 -1.0342307835841038 -3.0982566770722664 1.1647913953347546 -0.60298509291212621 -0.20447706031572338 0.26736663885208295 -0.42209687885251418;1.4887246671067822 1.8742723335040203 -2.2974504883074531 0.0039181499736391651 2.134936144888151 1.1314895945724119 0.072436527381150903 1.4758259908498268 -0.45875770919895043 -0.60111070318544546 -0.17461475571251747 0.23575968470637221 0.43126663381644181];

% Layer 3
b3 = 0.64023124794033681;
LW3_2 = [-2.1910209939352101 -1.331190792250776 1.0252304573076703 1.5726631042270836 1.5398965691255462 1.9497616011788885 1.6194572822084949 -0.25504820840741677 -1.1617758476992142 0.31755020857662719 -2.39231244937017 -1.84961221457592 -1.7422194810561331];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
