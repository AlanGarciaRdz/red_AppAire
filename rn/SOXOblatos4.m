function [Y,Xf,Af] = SOXOblatos4(X,~,~)
%SOXOBLATOS4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:39.
% 
% [Y] = SOXOblatos4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.8432831542695602;2.382692647945988;-1.4811602924631797;-2.9339280569415664;1.3169575037230425;-3.6300149372214201;-4.6158310475501532;-0.58495368990823737;1.3208557482712613;3.130842381825317;-1.5415209649073767];
IW1_1 = [2.259613423561035 -0.68709607501615555 0.14054393339787724 -0.14958605502437447 -0.77918633896933676 -0.59191435436120443 0.67214042739219437 2.7461262703895919 0.49493893909072434 0.60425243016958574 0.85079009377655745;-1.7778339260918148 1.9585765943086608 -2.2125732271619096 -4.3413909947486555 2.9948974652732643 -1.3790654021700035 1.5368033536831391 -0.90256160661852713 -0.084085446426288346 -0.74219189079513026 2.7914106857757837;0.033965362738503257 0.3805484654472101 -0.6716566303474073 -0.65115148335577644 -0.33457234287825399 -1.4926775339661438 0.49949880551529935 0.90457536166424202 0.32885723398905181 0.09171079196398968 -0.082338789706882132;1.1917099077383189 -4.5720852057613754 -0.89873096023878529 1.0874570416269442 0.16970662372807896 0.32288643459597155 -2.398546733962081 0.46589682108543995 -0.43149024118924934 2.3604129426633556 -0.051062118596048513;-1.7546502126472925 -3.8153234351674081 -0.0067829099351191385 2.7531469517884228 0.79464039244728113 -1.116860885650278 -3.4992735040568514 -1.1173061442402172 -0.68996713462799786 -3.3720294735016108 0.8359399017279342;0.36773243310477766 -0.12869083854824048 -3.3249224228379908 -2.6099734533160999 0.51124385086391566 1.8714572870131447 0.43377134637300446 -0.25226242813910166 -0.090082705432685706 0.24783233150432854 0.016100214966993709;4.2277671917146487 -0.59348754053056174 -1.8825146928288505 -2.0450982412946241 1.2661509908777182 -1.1199821450201088 -0.022611263677778944 2.1189022732623433 -1.0615410243156234 -0.73390265874543503 -3.6673934755940576;1.7082701170085048 0.52853497641472647 3.0105754491208785 0.34227504010921322 -3.0965915548401717 -0.14656900935400746 -1.26345366801103 -0.90088510743357975 -0.38415696245250669 -0.47063849690308968 1.2253597654060782;1.3196228171541922 -5.4258248879400899 -0.36698670724018734 -0.29249882578069175 0.19491084566883313 -0.36314098505923198 0.21022891538429825 4.5242813502586277 0.63979618895270363 1.8298349793291375 1.1953419344057026;-1.1434399036330178 -0.29629727228657887 -0.50366542368003764 -0.30027096315547969 5.0765936228304378 -0.21183681659872955 -0.87260778994406663 -1.3807487297694179 0.37690199659042256 -0.27499386199008324 -1.9546993008025271;-1.6964372232004217 -0.063323281030454176 -0.23168476576621916 0.27922852044350827 0.447545324447926 0.51635145117867853 -0.84767164491251112 0.94340543666373744 -0.12267654570372288 0.19766369417284671 -0.25782229011036545];

% Layer 2
b2 = [3.295844933044032;-0.84496528288047967;-0.15222364294203344;-5.3603137547388648;0.93932742876834163;-4.299505540531201;0.39268019765797813;1.3110591678711379;-2.4244438500583114;-0.69742255415431886;4.2804537536590432];
LW2_1 = [0.075257426416953238 1.0026888506617835 -1.1976576199967868 0.35358149348221657 -0.55696683247234136 -1.0705470323421005 -0.93863385936045285 -2.4801077893195016 -0.14778007732905965 0.77870708480631401 -0.98030891520105179;0.37019820121405894 -0.040953252979609389 -0.2264744072221419 -0.12513256676056281 -0.18310137881775099 -0.80476205914709587 0.41271675499536442 0.48558164027840661 0.061846219349590476 0.57221286553715378 -0.95671280909152012;0.17609768209241991 0.24370317061016977 0.27184851911211239 -0.02510090555007714 -0.26131719241495055 -0.46662252089769574 0.31166223407687726 0.1108587848469615 0.092233304532791244 0.44713374252362975 0.14210242915145604;4.2937553462803981 2.8169839903505496 4.7441649877436314 4.8023506087468197 6.5413459249202131 5.686310630347764 -6.2191427720821721 1.5670205359420368 -4.8650887612550093 -6.0132537001246549 -1.1396404882581141;0.06704941328700019 -0.35555798565061497 0.34827760123375839 -0.035436510176538774 -0.46785431190618232 -1.9240837913252247 0.015922934293055836 0.39935136357941248 -0.72156914060909394 0.026697537964056425 0.11889531964690032;-0.4350723903775342 -1.0871573120917712 1.3635081153766968 -0.4743946752787771 0.53923064812943655 1.1527530596565947 0.28461348298303335 1.7716569973079053 0.2877205492763234 -1.0305086120928801 -0.88986257889984843;-0.82920540083518712 1.1084542336155689 0.18819698171682836 -0.24777369963257648 -0.37477345360329339 0.23097695878731198 -0.43764808802508376 2.3838204889643997 -0.5102026430012474 -0.25886198194660121 0.27746282495651514;-1.0259890177630666 0.5644027465895719 0.82736345228695629 -0.49400562302749829 -1.1975929790119453 -0.42929710857805936 0.90593413794181266 -1.5673467742586649 1.1148832632426122 0.79931864562763977 -0.59866619047770886;-0.73337573439580972 0.0029060466614237168 0.25829941026854653 0.27151254736045938 -0.1795189345943114 1.4199896717123508 0.29597620880158182 -1.190697058690696 0.021511977109315683 -0.51962048480224365 -1.5885130579277726;0.24411743949614198 0.49301645464883337 0.49537963449766892 0.019086342365200896 -0.22793559556367515 -0.017598375646884157 0.20292971523519865 -1.0291070118700822 0.38194754383304702 0.1724632787326596 1.1900517159708148;0.60661227949400776 -1.2344970874618544 -1.1617651252002026 -0.083772140871346934 -0.24091130661024251 -1.0210183492971372 -0.93220576977521818 1.3747011745403395 -0.26605230559889664 0.23691501394883463 -1.0184056590542152];

% Layer 3
b3 = 0.79162365407334101;
LW3_2 = [2.1232940287864692 0.11471452983063002 -0.13937614201743623 1.0691841185147009 0.028504157416997626 2.7022574569803179 0.024119763118773185 0.094846583606010712 0.042953508635233326 0.07922554552060386 -0.12823287597087102];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
