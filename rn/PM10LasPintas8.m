function [Y,Xf,Af] = PM10LasPintas8(X,~,~)
%PM10LASPINTAS8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:28.
% 
% [Y] = PM10LasPintas8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.0251256281407;14.7058823529412;0.0179856115107914;0.00280033604032484;0.0558659217877095;0.00576368876080692;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.68290846756061185;-0.62124194372648922;0.90883765024692109;-1.2425497788996827;-0.83824937353183926;-4.7835709254731826;-0.40314560631114421;2.0078796737987945;0.54322683688297568;2.8468230702329258;-0.36877435943125403;-1.327776067048581;-23.655762708407128];
IW1_1 = [0.76910975371432966 -0.36796558162306048 -0.14113938805690149 0.27244935876719395 -0.59399843797733864 0.059488602446938682 -0.43544199557670588 -0.063357134538615786 -0.25616289654786051;-2.7831149735677587 0.20422044316215729 0.75715105370880409 -0.083035128364473368 0.53615476978355459 1.074504957649713 0.94419201002382014 0.35025323028154282 0.26749877071300843;1.6245813307133681 -1.4684348380200329 1.2169397244136337 1.3465273597568783 1.2540495244201211 -2.1110586447153232 0.94212393328225486 -0.11390152293186839 1.1863321220338685;0.73019897861963556 -0.41287474058446072 -0.54654260151466494 -1.3168099432022782 0.3045505654433931 -0.77488664600556911 0.20025422252353292 0.070567000731703744 0.43090459830147188;-0.92606310379269385 -0.5162591039378398 0.51444684157125942 -0.24451370986804036 1.0403307524360899 -0.58135767288106044 1.1194238054366219 0.0093598465293831014 -0.20592183285986304;-0.69796948477816045 0.0042010797260503656 0.8902061771850921 -4.8642363043598715 -0.40945094419440942 1.2266756877531533 -0.41949449323421178 -0.27085861797017186 -0.55566655412085053;-3.7700189630713785 -0.07733665129743203 0.82129747192120006 0.16590028088879541 -0.20916829050108821 1.0065643396621282 -0.47017302157275254 0.3528230662084047 0.71668590242302455;3.3975428054038703 -3.2884319820772401 0.47575637408537541 0.046089989880226646 0.66896644841865538 -0.11986957602411605 -2.2527194528430137 -0.32755459915797075 1.751822943194483;0.17276397190235801 2.1921446299617218 -0.020848169346959131 0.10326598883217246 -0.65111017732251342 -0.13280931220921402 -0.99928938503020437 0.059996107340091684 -0.43475156290752842;0.1624978290579227 -1.3437783368593905 1.7219675530987262 -0.69765417606460112 -0.11589507272316414 -0.69238548935984778 1.2407024156794511 -0.21730984542326523 2.0944512093129637;0.93219206585412007 -0.026685252228821604 0.66503118055436816 0.24676513565284866 -0.2500268313267337 -0.048681752345834051 0.55309057709660303 0.13755054491275953 0.055785376652389966;-2.5005173836999983 1.0188920673981823 1.1649009480863459 -0.33312056111296384 0.27617723263198984 1.2796008782649426 1.8176764577347295 0.30059325486147703 -0.23603071256620406;-1.4781843694284251 -0.44392530359584365 -22.276733906853952 0.11729343545688374 -0.46365531341327276 0.51472585333222443 -0.40533428997305898 -0.045910923139562854 0.19275814689942533];

% Layer 2
b2 = [4.7036056934713066;1.4487883086062607;-6.2114297796771627;12.429183281344534;1.2746656544455128;-2.8834069196008816;5.5805232733879215;-5.367659221146444;-2.1066470468439666;1.3763969310265862;0.15292144985132108;-5.4744862144289028;-2.2453341432949112];
LW2_1 = [-1.5392954604346287 -0.01195444458165662 -0.13498395936875812 1.9895528787004475 -0.98234766752574942 1.3160138615483215 -0.20475877969442652 -0.36431470047434605 0.85923802877182576 0.22661386600373851 1.0386666507899358 -0.050700040702961108 3.3015947837896786;-3.0172293881096373 -2.4311092538290544 -0.64923241650312269 -0.8863652573459746 1.3586417873742165 0.74014723805332694 0.76702631377241171 1.8221397055638522 3.4825862453390224 -0.51275952117957968 3.8988780590000069 0.74697691855180715 2.9482860244151978;-0.20262420805305803 3.3119090880128375 -0.55712322137147241 -0.18461803065750168 0.89847717091095392 -1.331495281802987 -3.5082123672358376 0.44700821728499446 0.026524639151561575 0.077688877569895148 2.9615818250361343 -1.5460988642356566 -3.8258353283501996;3.3598597898527811 0.53908385949080828 -0.66345178764025037 -11.622208500778715 4.8090956442415482 -7.3119500349258857 -3.2182151751338455 2.7773238523678287 3.5229818200804699 -0.93404480357287722 1.0478364930381276 0.25316921794257519 7.2249572424331596;0.10256789793974222 6.8280591816792837 -0.8284110243076358 -0.37349366829137998 1.4950444791160102 -2.2041693849474893 -6.6244927884028852 0.73703764677525196 0.80981405933085571 0.24595575359054214 3.4883702122909894 -3.2224741438637476 5.7282091640128572;-5.5165082869026616 1.0840034214999537 -1.432030223682851 -2.8141879937337801 -2.9424533248302018 0.70542699462445335 -2.8466123239928658 0.82721244639180513 -4.5070786197975199 -0.20130385051168512 5.1188607904511816 0.66080972668489668 -4.414942736262363;-3.7423149080323346 -4.8826991993783526 0.5321285390181113 -0.48552333977743845 3.5882874246845544 -4.4855698129930381 4.6582603016435336 2.1054751575157926 0.87687505327785242 -4.1182647858777921 2.5794831480745364 5.7040715495095844 0.12193272275722189;1.3923700029411583 -0.56697328649347201 0.16105166262401888 -2.3468501781272035 0.98406251871203954 -1.1252901654938126 0.55001637732955944 0.3872639832293206 -0.9661433331067022 -0.21468007501508973 -1.5720095964537459 0.17574998968645453 -3.7163908419032938;-0.31298530896532023 0.5755154804187208 -0.24327195516065159 -0.13701838060238244 0.39919382637898715 -0.59431571167456965 -0.37275106588897677 0.20535274408927956 -0.46200541275490564 -0.1393138621340802 1.8276973973438995 -0.23344736148828274 -1.5637805445587254;-2.3635651219459253 -1.676038132544432 -0.57368716054420332 -0.46027047270141602 1.030556793459348 0.6778834536779591 0.63214792543222176 1.601260300234046 3.0621494807523688 -0.4589235042854819 3.1703322987385336 0.44694672270713648 2.7108874783892705;-2.7874797319269629 0.35777620455319614 0.2855345107902808 -0.87451124734432695 -1.6214616501953281 -0.87655655281144462 -0.89974926856759474 -0.82054053805062188 0.58979763385509543 1.2415111967253514 -0.10773385454469216 -0.43960508486434063 2.1990186114787043;1.3590471332870744 -3.0161100954914422 0.057164760385514359 -0.20130381512096324 0.5439747939680154 -0.12819254567202915 -0.53835546343487861 0.0054933802262219847 -0.16226498789649102 -0.19093069028653906 -0.84573150015765874 1.7610450424952051 -2.1791689317642655;3.3039357016680078 -2.3638014558086224 0.27554534907035078 -1.5429025663425207 1.2877754820991762 -0.87079049236659178 3.5630000806583202 0.44993977025141252 -1.6794810174698693 -0.73279660437851091 2.3100806858290146 -0.16916576488479396 -4.8443891405190875];

% Layer 3
b3 = 3.3081069142792532;
LW3_2 = [2.3681916551868922 -0.66102303626673553 -3.1056750891655822 0.12847668765325368 1.5886668385113747 0.074345097537914961 -0.0673046416880871 1.7987457159059625 3.2596396208454244 0.72087995632491719 0.51055677331773441 3.5312512132139777 0.14385875517831809];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
