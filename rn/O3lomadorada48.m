function [Y,Xf,Af] = O3lomadorada48(X,~,~)
%O3LOMADORADA48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:41.
% 
% [Y] = O3lomadorada48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;17.6991150442478];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.4518251353193059;3.9202650559261842;-1.9857426357494916;1.5644354231722495;-2.7908434214088507;0.60406264399698828;0.70299997943921089;-0.39581060504717902;1.9339561061860362;-1.2962792754933048;-1.2425355009862153;-1.3609269831864002;-0.79601598300236431;-1.6601713235052133;2.6703852062386586];
  IW1_1 = [-1.3209328621803018 0.18334405931574008 -0.31351057015105888 -0.27477164599160409 -1.2386870108810506 0.89360521389937453 -1.4883812341342582;-1.2652629563377134 4.1956668556096721 0.61163457189926129 0.017807437685492256 -2.6633724621481836 2.9407318971405041 -0.023202867806185398;3.3941600397904717 0.93409822595942127 0.014708037995330561 0.16798030123942076 0.18784662342221878 0.32411662606893915 -0.46075428208283142;-0.39513702289264413 0.22759564389626172 -1.3570740258621108 -1.1345345616281586 0.31315161070034403 -0.88956253415379949 -0.032336740171728967;3.2922206112210404 -0.87363324233832473 -0.099983380241002465 0.44889466074052209 0.48490466375465474 -0.6128896440719831 -0.22594392937158606;0.63321813121021853 1.8570318770338499 -0.10167297788198337 1.1068892048850538 0.12393077070739278 -2.0305848360068492 -0.36135674467359186;2.7118830090714101 0.11603936841001945 -0.32638011550042062 0.20672704673779702 -0.40440184940645191 0.14888715771859348 0.083356584872528089;0.78335847915383106 2.410888737813925 -1.6690471648517651 -0.68708317673392749 2.8404875668554892 0.94060866956046396 1.643165430906331;1.7366746922258036 3.8146596811306348 -0.085561507839451253 -1.2853491601521974 0.27854010940646201 -0.37283165010167113 -0.97312999709403003;1.3909797662372025 -0.30087816599960343 0.35817157857730664 -1.7299647489653509 1.044447173928114 0.024161654927924821 -1.9342100234327588;-0.97748085177364352 0.78412206502899762 -0.1810777825606138 0.55964344421542123 -0.62577021815495282 -0.29461931730717456 -0.77131110340301523;-0.48080418495963262 0.054681997009285367 0.21339531366290651 -1.9688765464249747 -0.19394000176750126 0.63316512354327081 0.13461596182127575;0.0043657828541038245 0.32004838359788224 0.17764995234734929 0.58633128026042591 0.39531559269137762 -0.64531885974677816 -1.2032792873217377;-0.62449023516306024 0.29029075859137632 1.0442167436825687 1.1225347385113356 -0.53134509116612649 0.038412965406843767 0.11435849725557901;0.45912376366634267 -0.54592578891154342 -1.2591367275600571 -0.65536672235266291 -0.73699513905048686 -0.075469845387589718 -0.44653061891839307];
  
  % Layer 2
  b2 = [2.2722553302008004;-1.1365446774625625;1.3927450866378042;-1.2548162464875754;-0.51533271270456649;-0.48884839146596132;0.27536467623379068;-0.52471272153248683;0.26203769229804968;-0.88446119085627506;0.09121565351839736;-1.149847225944661;-1.0323529351762861;1.6653622350729576;-1.7974276004966985];
  LW2_1 = [-1.2224379996596557 1.6720384925385827 1.1210124111143478 -0.085035229287753394 -0.76608568757913109 0.87046783158615237 -0.81643052877010036 0.24990231419243089 -1.728381971764491 1.1174625935179139 0.43778838978481649 0.18338614244509352 -0.18583102829229164 -0.25730754635919945 1.0293707118931683;0.86252033891877744 -0.094523211952952518 -0.021986878654803449 0.35979047914292911 -0.10701242516830919 0.36851759928193639 -0.33562485515613749 -0.4707022084679906 -0.94872289403832255 0.25475576567939717 -1.9915321021542798 -0.68729675545645663 0.25546082576887463 -0.6784302825802675 0.62283519500404283;-0.21455496345352071 0.4291060246566667 -0.20378963120233617 0.36106755887105252 0.73302791188483651 0.2541423677898591 -1.0722360874379979 -0.045360918366691927 -0.45383939765511705 0.40772953143177887 0.8236403830772201 -0.6325671523829498 -0.93239307232818958 -0.45468453381907492 -0.40100508833332399;-0.040875752695266901 1.2428678930091726 0.65820289329959747 0.42121001522640888 -0.21854655410433715 -0.76716391437546849 0.21585938018213957 0.54699466513367967 0.31527054829763679 0.0099007127439850566 0.067581683151836505 0.66572678266108287 0.44548017319187705 0.21270634467083643 -0.20333196027832115;0.19214421178252952 -0.58421938155438113 -0.58928205719310023 0.74266908555027356 -0.060183695351025052 0.25112774271857796 0.011650983626874238 0.58300180073495322 0.57334110559023599 -0.47162670991569472 -0.83922302925235703 -0.38115255460335407 -0.74359780154968091 0.1662441782368683 0.10186054840957312;0.30364643927217716 0.31180690751697848 -0.21329764773554849 0.23674917014654059 0.47413242366161146 0.19582485819643627 -0.54958522666161203 -0.37714094912472623 -0.21308232317045808 0.081023874269784399 0.23206368932334612 0.64915677687589812 0.18271511659158485 0.18244787597858025 0.15115458991653816;-0.88767880419034106 -0.24114621739046202 0.54257417516967188 0.090562417343696189 -0.053514585670963732 -0.048629404144196815 -0.22533148210501391 0.08640822434065569 0.44588981575505737 -0.31429771627230429 -0.31874685534918457 -1.1776096402622325 -1.0920199066697269 0.40577220418583715 -0.056212211552667861;0.56745998779914797 0.098076791136158484 -0.091521565293689516 -0.35739183253667323 -1.426434142906684 -0.25951472289046723 0.87716578065241047 0.33067916761512556 -0.76322416275516414 0.56633198632295645 -0.98484088376665202 -0.21541702600325707 0.33678230254053876 0.4515692285928033 -0.37061449953750797;0.014570808513038661 0.53099789720250601 0.2272356606498504 -0.28447774690127231 0.52980145907873899 0.49742227787185556 -0.016585329426987969 0.40836283177789312 0.30417313436140692 -0.47967823273204746 0.62706714919720108 0.033215753996708453 0.72316019681638899 0.023127025353214176 -0.43641390024301141;0.086562264025649163 0.11683282834162027 1.2696684126865927 -0.21188734851995508 -1.2170531858368254 0.49001260896298715 -0.25777759210254891 0.34409866789592153 0.45613402056961783 -1.1514411674941143 -1.1534927005966689 0.43042135057335079 0.85356419016282281 0.093865806509445787 -0.81412964826048773;0.44881453914412639 1.4380413351499171 0.48341091305483763 1.3174293129596717 0.86844641695222879 -0.99695677582130526 -1.7885474571815676 0.89243208777321692 -0.40293414332868371 0.56932124616353885 0.56611961027252067 -1.9883160692467219 -0.97467936981176018 -1.2757409035315275 1.4881588768581893;-0.44371618478258035 -0.50045823296100445 0.50802288552381258 -0.95513169253914953 -0.31529489725232263 0.93132568599625365 0.39316908808711382 0.37339467627186657 1.1030389173097777 0.61545649936691837 -0.41439614851736595 0.11034280837258399 0.40720686596962163 0.076734610512700863 -0.85363435569047363;-0.15119325069032002 0.7468309952124218 0.13346423511403019 0.77623655058065666 -0.12523651065977814 -0.086866075122739028 -0.2217515701694911 1.14812225777202 0.031937841602920305 0.41537682476024562 -1.2264469463456904 0.9428717705870413 -0.95367286896471259 0.63265533608457369 0.62936270237885439;-0.068686738403755374 0.97336005861302 0.43050988935167245 0.43657160020346886 0.0038889477236572212 -0.81509734473539042 -0.95624953426906489 -0.33752455774925133 -0.87712444679054014 0.18059045440080096 -0.71648394020059702 0.62346453403743529 0.39345953052409782 0.22647948372396529 0.78990557104917281;-0.079033501987991334 -0.073264293674586395 0.27958084888432666 0.17578351018878682 0.35069133905410749 0.10607521022612591 -0.57157788771878582 -0.16611801303825671 -0.87264837587046107 -0.061553549208332725 -0.28504668594454724 0.97677688423698028 -0.36400657793121549 -0.54390293663143563 -0.73064771460497469];
  
  % Layer 3
  b3 = -1.3913678956822961;
  LW3_2 = [0.65979049360736519 0.34509543640491963 -2.2672578498133547 0.97842144681550958 0.35970057699964625 1.2467257834741647 0.99999091711198984 0.36361771953472222 0.31913894130882681 -1.3281424451697774 1.5671016110766915 -0.76672132487982891 -0.25993749677515532 -0.91734222359512596 -0.31098103577202851];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 17.6991150442478;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
