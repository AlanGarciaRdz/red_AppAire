function [Y,Xf,Af] = COOblatos7(X,~,~)
%COOBLATOS7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:52.
% 
% [Y] = COOblatos7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.5635319104888876;4.8036477933026784;-2.9138852056874391;1.1404346417046489;-0.27360929217025626;0.41316269003117301;-0.9656687750570716;-2.1853405701477029;-0.19612898380314098;1.3636453884699071;11.235713355981627];
IW1_1 = [-2.7854889514747443 1.9795379364157468 -3.1671962414749797 -1.8093352840862735 4.445905018524428 -0.70851893159254498 -1.9493239135716187 -2.1710478438394749 -0.48514669340162542 -1.0715259549479479;-0.034956135854112828 6.3609970074878914 -2.1220232838514113 0.32739487819156804 0.46752944635552302 0.20354889767520301 -0.12796680719352507 0.58136806656181639 -0.26446452911574497 -0.075486875958985372;-7.1549352780847029 0.42693072651424568 1.6405083213617986 -0.37690073867345369 0.69127429108125238 1.9844929750851448 -0.37755989021651615 2.0374568892709441 -0.076365350684627492 -0.091834463611619163;1.3303897794472697 0.48964678413176488 -0.18014885636093819 -0.25488995394478986 3.02737338569918 2.0036466145677609 -2.3730541384347705 0.74649267192317459 -0.26952503857708021 -0.036100259207270349;-0.52767327480905335 0.70324056622896203 0.5638812055298883 -0.0066966408044162092 -0.54787030568576867 1.7875374696081814 -1.7655234827753348 -0.49975947183080993 -0.055316989878004014 -0.15880080226153515;-0.73108291185087448 0.52303999467298667 0.13073450704533071 0.052160353299741335 -0.483401172561846 0.14874661643865705 -0.024903520578348663 0.63117319643689329 -0.04372645340997134 0.18412390834268585;-0.22686171394804974 1.2291955309640608 -0.92217858042213752 0.12285335261871229 -0.069885576374022956 0.017779947981786157 0.024280331988709915 0.036076073572514918 0.05856567344111599 0.042293434258758075;-0.18156420220419398 -1.8490714067775287 -0.27869329507902152 -0.17759587972447879 -0.13738587405518191 0.49814800109836532 -0.30816754550937164 0.68818297234361081 -0.15097588423780187 -0.084208890726759356;-0.10423649267663093 1.1760826617458469 -0.83768995903797872 0.11862820515877236 -0.30101730698174639 0.15685157612262093 -0.027513821542941394 0.11585410634362589 -0.016506520171179088 0.018464234331266857;0.92723844368964869 0.13426800583787979 0.29396720391534814 -0.035574644783601908 2.0503202157983678 1.8150384436017077 -1.6922631991568702 0.56550236357936801 -0.23793423767661059 -0.06089978173483851;17.465881296964493 1.0131166443121451 1.5553722568094945 0.45585478072035474 -2.8367952688725677 0.11992722791705715 -1.172806891909026 -3.2618698454189254 -0.2062273086926158 0.12755876627080859];

% Layer 2
b2 = [-5.5633201896262046;4.8711466763623168;-0.94458696082884785;1.0509463341492291;0.82408804252561418;-12.218080691482729;-3.807567346008828;-2.1877395767677696;-0.7201619507452075;-12.031013467604193;-2.9848913839299138];
LW2_1 = [0.26709328190597864 -9.1356683214298009 -2.7589667763646424 -4.19421474474923 -0.55530616093830787 -2.147550281409969 -0.41487944712287872 -0.50214499115301425 0.1148116732521029 4.8201609884780092 12.544933274551502;-0.52598388481722302 -0.82198313470976347 0.98891053735426249 -0.016070795053312475 -1.8088909007388392 -0.96768601357549555 0.55712377243872102 -2.6174454190387464 -1.7685086419560676 0.14012846235240195 1.9126887055662896;-0.051030482417886922 0.49594397747507085 0.21429381047981647 1.401124301581985 0.45977524013373883 1.028534403281455 1.684437645274331 1.5789096630249293 -1.250306180837597 -1.9793398621375096 -0.72691096675040145;0.17995060508225777 0.49111860036966276 -0.071672954779319703 2.0536773231712004 0.69300524479011494 1.900133801004656 2.5387782704991371 -2.4099058714800647 -2.8022696570579315 -1.0274620059182562 0.078954210684893597;0.20068529684662553 0.40629116667851473 0.016393135862827819 2.3502754124520364 0.72349167073520593 2.1081083501821927 2.2801106851386082 -2.5080343465436954 -2.7805342357949305 -1.2788129658473153 0.17370977392918677;1.53086902779322 -10.196776561972223 0.39836313812680274 0.31815275658068581 -0.35659563460650995 1.1962109247320607 -7.8505009320661356 -8.8862144067697635 14.62903719610088 -0.35492751051303595 -0.60182826499013586;-0.55220863243966756 5.2883707047584618 -6.3892766883982315 7.1393748210041705 -4.4757101266539108 7.3483947661262805 0.52164902698682014 0.57680965183238309 -8.4586952129379949 -4.5045307907639707 -5.5868025532634551;2.5026530113764087 -0.71791378718741872 -0.33126146011196722 -1.7719790727757534 0.5004140054586762 -8.0368823002225724 -2.6730508946948843 -1.96991463991617 5.6645711889986119 0.21254738176939564 0.7639946548749923;-1.2459583547986042 0.39767603001406765 -0.43898110925763473 -2.1292972796754879 1.9215037389271321 1.6765544597408006 -3.0096697546295101 -0.88328984035511982 2.558805821221644 3.6200482923738422 -3.3433084022458339;-0.39086523413731117 0.65444412671939911 -1.4363029743127327 -1.0896090319836294 -0.17533869564855664 -0.89371258812313292 -0.97731270292719796 -0.43811143368328426 0.97383117397255858 0.64401338626707016 8.4648784186259647;1.2382845119302333 0.57947782169191242 0.24563354510497215 1.1163462438210994 0.34641159020200363 1.7487203022930067 0.94233081532588503 1.9966661558584329 -0.13137137796756437 -1.6037094204215605 -0.52112318381795586];

% Layer 3
b3 = 5.2154271779815513;
LW3_2 = [0.28766005435671915 -1.146928955940169 2.1917597386556502 5.723992817807499 -5.4425274656816551 6.3560552667934083 -0.062190265985800894 -0.12922005660565355 -0.11425189415192184 -0.96963323569482462 -2.6251081423355545];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
