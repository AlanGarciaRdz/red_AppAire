function [Y,Xf,Af] = PM10Tlaquepaque8(X,~,~)
%PM10TLAQUEPAQUE8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:39.
% 
% [Y] = PM10Tlaquepaque8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.00773694390715667;0.00572573718866304;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.1653084126299014;2.9635213729376724;1.4855982660670028;-0.79278667336577557;3.3633948232629991;-0.62471841619199175;-1.229757112976757;2.9406290513885991;-0.28244255869034479;-3.0087804181426128;-7.5814651036972984;-2.3708182018534951;2.9099062197684309];
IW1_1 = [-3.8427493154556105 -0.60663549786818882 -0.58642593897784923 -0.2286884408152407 -1.2854488877765842 -0.16215957353908078 -0.53381234930954857 1.0827286997886161 -1.4720017088817741 1.1057869863288696 -0.42680378837775462;-0.33499923893149886 0.88954175261243551 1.4662697526251094 -0.76447507796672076 0.30302369357751796 -2.0738886302373465 1.4148553087012681 0.017891245925232675 -2.5892191519821508 1.9957838317679706 -1.0621770981717005;-1.6214851101814214 0.18201783313551101 0.12837165263955599 -0.33067768272688303 0.83404046687309596 -0.49255898236651757 -0.14365311949346946 0.22981687731281775 -0.068546076200035055 -1.4892983813970466 1.3206863109089084;-1.4266852039220903 -1.0077820663298254 -0.28125568345319907 1.7966985905731969 0.30277525522552701 0.96299559101346299 -0.25026944637785498 0.4052835296700833 -0.97562546937244787 0.2249212883762455 0.20198913949454408;-0.36177762607596109 0.38109381960073196 0.79645787407824253 0.37297629503132224 -0.33701261140399408 0.77398733626664828 0.16240239706888746 -0.30114549305929172 -0.2812916595516185 1.9428672791850157 1.1933581997342544;-1.5233068676564891 1.8157662032563942 -1.1493928328480014 2.1541475465775064 -0.65161662640597118 2.0283857963845731 -0.27018678387507222 -0.38331590232311774 -0.13577646887592509 0.43410393968857658 -0.58581666624559392;3.0002954947960787 -1.1920420420561173 -0.50224984610398915 1.0904799520708661 -1.7293727752553705 1.6910694115221836 -0.14157948394106468 0.061627204703871327 -0.86861009053154437 -0.32527177169434529 0.3268764851712273;1.4504854210905027 2.9865957392708173 0.23325930201931086 -0.51440730734675921 -2.7572707256158786 3.6197066082075566 -0.15811275360117266 -0.4683752233590911 1.3118636644055879 -0.86234574031754052 0.18899718919436587;-0.10063667896106959 1.6202231749632217 -0.36465542080148639 1.2215186946667516 -0.26222923286235666 0.33546049560130642 0.29881686857564554 -0.059470468307410429 -0.29433053013249227 0.73513036310344404 -0.089376961529300664;-2.4244734927522602 3.64442592217303 0.82817757663891012 -0.87672454779256914 -1.4641926860280343 -2.4408403965188734 2.0190810200465021 0.48886361472142781 -0.69695726953888604 -0.60334389600493943 0.70701351748031849;-3.6976733096325622 -0.059114229197306044 0.87169044534190543 -1.2067726028929553 -0.1999413940383104 -1.2565105877655502 -0.019510312031789948 -0.16794217228179326 -6.2005934659491535 0.36992752077468077 0.014680875918895034;0.20774165864182764 -0.38865982229994889 -0.73382450600479654 0.33118585748694335 0.51651214874739937 0.89115245199022863 -0.23968665501705511 0.0749687302060809 -0.81620218193138638 -0.20457817056332056 -0.83947537797476901;0.44869078436116389 1.5360886322581742 -0.18558312211572101 0.70071377046007599 2.5177223550841119 -2.3601443193587253 0.50982613588016701 -0.18005499116587514 -1.3205903178048748 0.55686721518939941 -0.038797583845309888];

% Layer 2
b2 = [-2.3074093726311471;-1.128836247630794;0.14694674881609171;1.1642586333748495;2.4423268668625835;0.25729475425869253;0.59445605511479938;-0.8261565198820674;0.23739292166619236;-0.86068736349900676;2.0684006510729924;-0.82347737791511677;-2.8321989932312563];
LW2_1 = [0.49144591153382522 -3.1823746974103577 -0.5400516129839833 0.107691151438553 0.0353968405387831 2.6305955952119038 -2.2716879733483974 -0.50940621466266489 -0.33538839902112422 -0.039629216786933541 1.9005750284795977 1.729931828059073 -0.17544970683440861;1.5245535023662815 0.11982264779203736 -2.5616435369980293 2.2760291096397545 1.0023629122230635 -1.4023528203327835 0.13829281188746143 1.6503867126288567 0.16154463574499417 0.36788199536369509 0.53800812239497398 -1.9488688317573326 -0.84520384214481403;-0.43070263936172387 -0.25985400513724977 -0.74825376667509647 0.38016891138148279 -0.41195728382659297 -0.25892598021919722 0.76678620415161236 0.82387037553394882 -0.37594367960159125 0.45067070516070717 1.7255678814611073 -1.150545456423943 0.45099452936086371;-1.2056100939182901 1.3901953070770374 2.1939612256595882 1.2497254373982305 0.74635019876527608 -1.3550566981875971 -1.4958998163113313 -0.36754965476596346 -0.093085390130698165 2.1362253339463071 0.22572477985614448 0.32103932691360504 -1.8170203711060298;-2.4215507036883261 1.1521728368961575 2.3962586087787323 0.33841499406911729 -1.0563038708698016 1.0380705479172847 -0.42330002841201558 -0.4184282655929687 0.28025972738995786 -0.18688087567905151 -1.8906816065489274 -0.27959497730305527 -1.1300796317793285;-1.4519604215536406 0.58180518895869204 -0.32640498654742245 0.23097987946725984 -0.79942207124879627 0.39425184217922488 0.46476312918381024 0.66555602908813294 -0.39515705073915575 -0.0033092807227582122 1.4201081055483247 -1.9786974047631809 -0.24267322412806541;-0.88833077804591942 -0.48311298165582378 -0.70258209273062022 -1.5705060430787192 -0.75232388848508247 0.87703525922860071 -0.1935122702821897 0.10474396489747315 -0.63114772833816002 -1.131666972138424 -1.0650158053368397 -0.17719083710081249 1.0515907851606481;2.3646403123065318 -1.6888670021865249 2.0449735618299489 -1.1943025194644867 1.1054390116652553 -2.4462033345030636 -0.8213996420496753 -1.635660379667542 1.3905119946951878 -1.4416386242229773 1.0552122379455879 -0.8084475077230876 1.9372652442716416;-0.51791233242349255 1.0474619866589567 0.39995005463059663 -1.0495265067746355 -0.13578823100904436 0.69849540052348424 -1.123578092906953 -0.25631178326472526 0.88726711384372248 -1.1955928470163086 -1.7211312818040649 0.80928610396149536 -1.3655525038108749;1.5210005364427317 -0.016916895149390092 2.1394289544028382 -1.8069528421517809 -0.058445881727005697 -2.4535780464376966 -0.33281669050397389 1.1250748290114516 0.89359276718072322 -0.19782143204143146 -0.49054950666764452 3.1176425770536582 0.2835981545705914;0.033184561695886267 -2.0269705562916371 -1.0275338908302465 1.0810868947671819 1.7275512057675688 1.8133117585301652 -0.50296147915095657 -0.62768816380489534 1.6632659190889099 -1.4087332152593852 0.92390774143972476 -0.60794708364818018 -0.43332897794451386;-0.66150842804487053 0.35388431545540244 0.51771724319975154 1.2098261115577582 1.4275993085770211 0.95256897355143177 0.83882992836023906 1.8942795472376117 1.1168794998461209 -0.8367148152338828 0.97386758207844637 1.1659787545669758 -2.0679742893729629;-1.4762605063162892 1.7214963387596551 -0.65746378443014508 -1.3631677343561661 -0.037390584893084222 0.67664380703332716 1.7973084072027976 -0.12774037500900709 -1.7926716793182669 1.5261821371416713 0.32718872709193614 0.93651696219538494 -0.86653713344093797];

% Layer 3
b3 = 0.47041301878943498;
LW3_2 = [0.68480159781427441 0.14617570076785186 -0.5983882869230791 0.04362862952532346 -0.10352591192598261 0.37740879569288899 0.15811962218780609 -0.056063559755474557 -0.26060306608671663 0.14776456037689881 0.066290760748038163 -0.036527172896482656 0.68312092635398636];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
