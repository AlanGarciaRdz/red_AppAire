function [Y,Xf,Af] = NOXAguilas9(X,~,~)
%NOXAGUILAS9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:12.
% 
% [Y] = NOXAguilas9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.7108861844198131;2.5746577844351051;-1.229576468592612;-1.6282912276479746;0.19610419325777478;1.7547351847304533;1.5100930278231643;-0.76710255628008739;3.1478150728375085;-1.1754249239249224;-0.40346625601287489;-0.63861838417220451;-1.9278389568228784;0.26752942040850353];
IW1_1 = [0.5895340754797459 -1.7938139494488785 0.76834709799384182 0.22190030095560023 -2.3064331229765869 -0.09102566647098706 -0.44711902493300537 -0.0030928398426988768 0.56004893267790667 0.6273747522836145 -0.21608998103494445 -0.40531888214106415;-0.39450374204350902 0.18756476895772051 0.9037110641686924 1.1137833862004904 -0.69044821136678791 0.18772740959185963 -0.26971677137308248 -2.3726132411098058 -0.18685621137111463 0.34005483653311303 -0.72666250286247924 0.83487132386320717;-2.0511931146857476 0.070358918836356435 -1.390802709833997 -1.2614999668908586 -1.4734827375057353 -0.56473283130759311 0.11290020906522863 0.08829336100904793 -0.32623194068620542 -0.053879749363158279 0.51903366738703627 -0.28384977176388276;-1.283011551319108 0.1304710870850295 -1.4730046540769857 0.45408608754345681 3.5769802522481071 1.1470187173402373 -2.1353455543288575 1.5997691247380599 1.3941497449697591 -0.074207013600105315 0.69493018526066364 -1.6478074429175311;1.5583844599153915 -1.1934392680768626 0.0050948982994596798 0.43020439285055229 -0.13128029755708884 -0.6009778053983218 -0.13892122523216185 0.32827714767402449 0.25399630720296401 0.0043376408354706686 -0.10400028862162972 -0.30228819006905755;-0.52465188605448176 -3.2179759283439178 0.85795820538329315 -1.8893119631572417 -1.3027100771576872 0.20386994922498158 -0.23803745446725669 -0.11884539808509123 -0.3923241492252989 0.31825237259513312 -0.23535241600717524 -0.25265726111028314;-3.5725114563258131 -0.10697351125810782 -0.44987595407001396 3.6859526469699113 1.0464849554377758 0.0037207984182590047 -0.38022022653989596 0.011651161737635187 -0.013997834951382366 0.71332027757303662 -0.048272675677761751 0.045778142099625663;0.45230051967716728 -0.17976761756032669 -1.4022603203030903 -0.99122673505608283 -3.8610079588009962 -0.73123289403421321 2.5763548212109386 0.20891824137488421 -2.0108604245623471 -0.25756126163157533 -0.042052506236447698 2.1080209994731858;-0.6949134200797028 -2.283200806195516 -0.56462235063019617 0.3272830009367203 0.22472648157038172 0.10972014541769354 0.68709097889622706 0.34883511479691104 -0.27585081595363342 0.22316147127894176 0.062634952258352902 0.56158696843637912;-0.20037395898537469 -0.4989364819881742 -4.0303191609464681 1.3287499027814687 0.31017925296187687 0.57507754658633548 -0.1084857783415677 -0.092729399670375814 -0.78303464266256773 -0.27539589856836877 0.21331920061834514 -0.2171116786714877;-1.6532553676033623 0.095122265101670114 -1.1237224475027272 -0.73192278063174632 -0.25625230780352382 -1.4231435245694202 0.61332485854043339 1.8825946225050256 0.13088900385045887 0.12182716866895653 0.66405348937414066 -0.259332871294992;0.061831825814726057 0.43687772900585792 -4.5503081650271495 2.1552378052703904 -0.11142768874927972 0.50570447935440965 0.095283221507388924 0.2407506107870892 -0.87910882420452408 0.2359120509308317 0.030667171740226241 -0.043686430037719118;-0.74886465840005578 -2.397258497709494 1.7411382217000406 0.11540694342720555 2.6973854580192307 -1.9478326907113686 0.84004125433913301 1.6568952176387097 -0.44111103971081639 -0.90822128531204882 0.95146731065551193 1.3682490330820258;0.22603017573635131 2.6413906257067845 0.042549032276002902 -0.1871301538738831 0.32812105004606146 0.17711192057336539 0.11196891815925965 0.50488658128277197 -0.015891992634110189 0.68054624325246416 0.19713647344529078 -0.048678301844951845];

% Layer 2
b2 = [1.8817933570434844;2.454342117618038;1.4290934869971741;-2.0393316054880799;2.5090965688243521;-1.1634808488755801;0.26935163010140739;1.2846821456411968;0.74953143996287075;-2.8174981587369303;-1.7450191282655985;-2.550821791347154;0.6975248095776112;-3.3131906254580796];
LW2_1 = [0.28683735504047991 -1.4195552584314324 0.14858741128387967 0.26225033465446368 -0.64208994978877865 0.43130720342433548 -0.17190887697809029 0.32945626970670477 -0.52418228502318287 0.18827084013168519 0.17274661137239175 -0.10421474505960068 -1.2916178526744968 -1.5608896537371686;1.0450314539663204 -0.32486147474815008 0.28555865915391376 -0.15025688962566333 -0.27311282667079567 0.28423104293747098 -0.2825287821075152 -0.017643299711838676 -1.2218586828053137 0.063078337289960484 0.16102853745014922 -0.0076831788068110795 -0.14063631707594995 0.069976192158941034;-1.2813603558650832 0.4809893204109113 1.2703704551077988 0.35468032443363007 -0.82972549848072563 -0.031139429550315588 -0.65010276268475431 -0.38594131388809777 0.65564947980847921 0.67576095956378324 -0.88575418826359575 -0.59052074896243167 0.4549843239790774 0.25507441624522714;2.5665093725678751 -0.94690143981653263 -0.48011346315919878 -0.22629996367905617 2.6584376903236362 1.6277871337468104 0.035418883845269561 -0.29004251975924167 -2.1177581264835923 0.0075393272418863046 -0.47940717957642176 0.55954648328949252 0.8952498319740394 1.2487898792041807;-0.558845081056487 -0.54632826836923665 1.0703187870124566 -2.2121455243092929 -2.1486236122131035 1.0134353552838422 -0.27508656940090842 -2.1396590950365248 1.2129612911371315 -1.5130933089614911 -0.84019810279247253 1.0806351165749115 -1.4016677174355332 2.819492023720684;0.57842924969453025 -0.93704359425915928 0.48411043716435792 1.3205359058382538 -0.72535368516952303 1.9284505542505763 -1.3889206286102205 0.27967739520619783 -0.49033562601467423 0.15520609489295578 -0.72045751534715086 -0.69430664500492234 -1.5405638741199001 0.41263534703236115;-0.028776475672411497 0.74021691269504286 -0.26834484430039929 -0.40941801783486309 0.29683318766703942 0.39316375599849346 0.79865241097073714 -0.47084558777978952 0.2126416486301419 1.0360257441982008 0.22516768988570382 -0.68357867425347674 0.76933212218713909 0.6747078811787447;-1.2907979589498468 -0.60145209068590355 0.14627535713896028 1.0262626375664228 0.39174304792808934 -1.3336643082122046 -0.70783725145776422 0.21372770382833275 -1.1380004780126141 -0.036620655020733854 0.31626362488692245 -0.078832226383383025 -0.22780073294806008 0.80270268041569037;-2.1246171613632399 0.99799116601855653 1.6617128367422234 -0.18218212696737809 -0.50522914560393206 -1.3731444285939161 -1.2722017333723648 -1.0180218568453556 1.1948205701573735 1.1444050729182293 -1.1275909393841586 -0.66101530857286972 0.40127862717540252 0.072016344135470686;-0.10059369832944179 2.5264007874269163 0.17842004324701649 -1.0808937556890381 0.86204409882596211 -0.89761701687898954 -0.53626296780267402 -0.85376388338052078 0.69154050581913451 -0.42144852370265912 -0.78485135532907113 0.15477342706655906 0.88959052744848566 1.2773940097332002;-1.5554805189119358 0.68415564561797526 -0.15364842441131221 -0.19441433217002463 0.46602853274045825 -0.5446523245154733 0.54672312093997633 -0.17122247019288256 1.4285458305080461 0.60502129888563327 -0.25313662962501776 -0.41050608730940719 0.3992283646004593 0.72074440884440727;-1.3576734149478027 -0.14879542228890993 0.51496680164649311 0.12103856908140129 0.34034434001869651 -0.07953032858890921 -0.2331403379930142 0.16573067933868479 0.77767892708818964 0.14743401924527111 -0.41914318173689336 0.058089834299442492 -0.67499889592160822 0.74341672137673043;1.8136509840447694 -1.1035387433946438 -0.1569888120411114 0.54124948460321964 -0.56190951660481769 2.514186592204795 -0.7304472471829534 0.15813046832217842 -3.3762708528973873 -1.1422478623077577 -0.36334393165785606 0.80632097754295406 -2.2827968813014476 -1.1910676536129725;-1.2664029334213922 0.84504995903852476 -3.1670788141204502 3.1421430079640773 -1.9292329049447878 -0.31761391393446348 0.54524853297346709 2.7043275417704931 -2.17101350180875 -2.3725797196045764 1.8631442075572739 2.262453705685997 -0.4515604719419512 -1.7332957324722744];

% Layer 3
b3 = 3.1929004302957402;
LW3_2 = [1.4921578821212069 1.9802858865263684 2.0197274578268103 1.5061377459134393 -2.9860091475106008 -0.30676825372133865 -0.57454082980906296 0.44296168843346212 -0.85139170028028022 0.473710681966099 1.4215862769690049 -0.65910770099039784 0.32228244723363603 2.9824230517553767];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
