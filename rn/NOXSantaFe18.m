function [Y,Xf,Af] = NOXSantaFe18(X,~,~)
%NOXSANTAFE18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:52.
% 
% [Y] = NOXSantaFe18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.9917088585213745;4.0989286672914282;-1.0728310145538507;-0.68462238016237265;-0.69785387278482758;-2.9820950560836721;-0.7931095887108941;1.5103143184353962;-0.29642221404298219;-0.77890109556064246;-1.9028853073375498;-2.1478393977802241;-2.4400781794805564];
IW1_1 = [-0.20295014688674975 3.1464968536034563 1.1555948214008143 -0.79641291548541249 -0.13784003427118285 -0.90096257208710917 0.14715241257273204 -0.11133568007874509 0.38669628673090506 -1.1598861975689361 0.35457939300691643 0.67791286381543903;-4.8591244248750209 0.57814519478243753 0.023437224777056464 -0.17436935494846448 -0.61817013090728401 -0.19201005929383191 -0.045907454268570236 -0.031496171315146447 0.10184433702565894 0.2958086925902188 -0.14040607352140916 0.099391865912502347;0.54985345829299448 2.2111725130485866 -0.6557571068483069 -0.19167859395299178 -0.73401929121299392 -0.38569560006299131 -0.068436887230628934 -0.65451737758713602 0.65267077393192818 -0.18457277338913081 -0.48002218656567264 0.23045848885005593;-0.63425092763450963 0.62066207523960859 0.80067485485594214 -0.57711804749971884 0.33668364176050486 -0.47539030423352824 0.10898435586809892 0.33865718579930226 -0.15888331033832304 0.4136865787523718 0.28357044346623611 0.27554788751809844;0.081939253750253377 -1.7433596051125122 0.21411766942815233 0.87905441511112392 0.80745040040560845 0.98741883798794539 -0.56935164008484274 0.70629775236177961 -1.3829337585918642 0.48599340669674279 0.16098146521708437 -1.2242414041873777;-0.73022247181062672 -1.1745372686293301 0.58970848956184962 -0.59914004180903635 0.32115522120608325 -0.069932333286079368 0.15367038508800224 0.26649708455482896 0.035772948913002894 -2.6913676067414349 0.18744578520088317 0.17404313211016023;-1.6878038450792636 1.4042527807794241 -0.47574737807444684 0.12255502289376405 0.17496577359978724 0.1375349978857156 -0.067148143650221009 0.22727114418651895 0.072455060171674635 0.54724152507424639 -0.53424377700793513 0.26514817903793014;0.66857984445384289 -1.2307176873445094 0.54011528853766178 0.35957413539881095 -0.9597251399471407 0.18630507383509365 -0.25836511692172626 -0.079196981418312204 -0.35542239783311891 3.5212025016870472 -0.31699610092692865 0.33471377691094206;0.57828545916948215 4.0641928376560363 -0.39831412985873332 0.66025667985544356 0.080655600503434205 0.14730898368335951 -0.14105872483310336 -0.15920653460063736 -0.46733804282304459 1.1871061230645288 -0.42457055951261774 0.17388100056348282;0.58832979481700276 0.27871081494859945 0.1612385527243248 -0.077599929778609411 0.7909117063409753 0.71291014290486532 -0.88115539121138586 0.3974486228855964 0.69909199144432321 -0.53257615887586696 0.2405798468403888 0.21023929633254257;-1.5472958780962216 -0.073808595795274934 -0.31298328164197287 0.90832090960360201 -0.77622290319386023 -0.030218319719305848 -0.52599882674732545 1.0340745011118015 0.92646666371118624 -0.77366217111329771 -0.9256190109996919 0.99911677825511613;0.37979635039771753 4.0307563881485606 -0.048887757617970498 -0.14079357438300549 -0.028107526909674246 -0.014521271856552703 0.017616760634892089 -0.11906855644809074 0.083802894169222958 -1.3905734832314112 -0.085503480290389164 0.18649953423608939;-0.82550848792572062 -1.5558902457966433 1.0942608582413365 -1.4903025352062218 -1.3647103732742329 -0.89100108028341085 0.32353672279640755 -0.19771938843804379 0.49636991145874038 -0.74021901114288668 0.093583873288669919 0.82999090097649431];

% Layer 2
b2 = [2.0733104358889438;-1.0516059214372337;-0.93685284558824222;-0.85376438120655074;0.26633056430184709;-1.5384274614464668;-0.33633185358258327;-1.0351094365840272;0.58142993725463621;-0.53617118009612108;-1.1487825317560854;-1.4456371887781105;-1.7110188163939117];
LW2_1 = [-0.21470896153476962 -0.042753338611559132 -0.32908787657314159 -0.72683273231196333 0.17920930180767927 -0.20443658120256178 0.3675897207361819 1.1013588754033763 -1.1779459013420117 -0.51755937237670024 -0.4927731490451932 -0.42691368780368094 0.61129688022399198;-0.18498163457414746 -2.5346358856342137 1.4422587266362785 -0.23648804944715138 0.2449917075467726 -0.33758405169418559 -0.001726541612168387 0.47484856936942982 -0.33828525035135842 -1.2157811920047352 0.07165875962564297 0.60568917042195825 0.73936395619800577;-0.16300642567344881 0.85317155901540609 0.94221771462952641 0.0019240212369342011 0.13326388519246593 0.014069202596670421 -1.4186165565784694 1.1573358738554818 -0.0053208445613390411 0.21675718954919554 0.57129982866903894 0.78356892818554835 -0.018865504967222693;0.49652395381068215 0.60644358240749807 -1.1704972755949643 0.081338591106685301 0.16727082136176516 -1.0088203128339086 1.4196894439426027 -1.1238031673971129 -0.41417867475691278 -0.20025965027242665 -0.28748096434240289 -0.1596890303407191 0.29467447774885436;-0.63043830540122836 -1.5606078249210629 0.78892261615988624 -0.36077916138158544 -0.54781251329300895 1.1623834188595066 -0.76398833348246153 0.47464828235145501 0.21219271513300914 -1.5559001668726067 0.14004243502941535 0.071459861316469767 -0.41306990084029166;-0.35248834550276559 0.94551933972094637 0.52886868286789535 0.21297855977309801 0.4438020975737676 -1.3673056051232961 0.64437462027823766 -0.44950716362713206 -0.47142392382899312 0.59773635794526681 0.6024843180778009 2.137858047769353 -0.52015261702323123;-0.21609768665535953 0.50923522418817946 -0.065348852433803131 0.29530237829256878 0.52976906341439189 0.31068654136277113 0.61819389479044062 0.083943446658326065 0.8006483509802691 -0.18430906340375822 -0.87903173292804693 -1.1384957458216123 0.5947995869340158;0.78107929700292533 0.2881934180532037 -0.26771243963151919 -0.22386866822970747 -0.037671518767648335 -0.65886671002248298 -0.29414424406578593 -0.3511145554525158 -0.35323340623979049 -0.011848525785870503 0.84798515462784385 0.44265669317903761 -0.43032682188928706;-0.8518287649168107 1.0071452169096144 -1.3565399849957538 -0.47238890710120673 0.13415068809232042 -0.80446723629137584 0.48912577873697388 -0.68738750425480621 0.034791759602231499 -0.26017174651980784 -0.75805332978770468 0.18143928794045081 -0.27463519719297574;-0.99388963705331956 -1.2713824753664249 -1.8624588575475172 -0.90453250038553867 -1.6513007935359529 -1.1788364799026847 -0.27537899519661396 0.57483832246635902 -0.13442308559179053 -0.9438358070759898 -1.4808102477665179 -1.560281815955888 0.73320111344287087;-0.19919944625833341 0.0010916248806406553 -1.233626396821387 0.6207341791642591 0.16437488356735938 -0.074509209527585912 1.3371956311548256 -0.85165199688498738 -0.47683281315318243 0.86978782715039615 -0.26487752922242108 -0.033039110611260018 0.88034650679071247;-0.93430548724010531 0.088384084320160955 0.17696199601097948 0.41870287253809663 -0.70835238088132613 -0.082681363268876873 -0.58559238506074041 -0.71905621958894961 0.84079186803042316 -0.31142424235004967 0.59938569603055192 -0.021544500668680799 -0.52301975887485885;-0.32416943447957458 0.21437766863456051 -0.5277303249232983 0.62094133037579724 0.31745509182814097 -0.64527291671289255 0.6257080519563345 0.14152264943859497 0.1842233098562 0.51933843354908871 0.38898559877967198 0.39419433514812585 0.72294880859843857];

% Layer 3
b3 = 0.416053723337521;
LW3_2 = [1.031663092616329 -0.89121578449171091 -0.80934360768522295 -1.0081916700928499 -1.0854597066479434 2.1498891839357075 -1.2164913854716888 -1.2523800086878247 -0.8264130221527195 2.3444859485723226 0.81823720871068395 1.7768427348675251 0.33844378778463491];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
