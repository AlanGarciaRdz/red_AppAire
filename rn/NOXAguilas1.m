function [Y,Xf,Af] = NOXAguilas1(X,~,~)
%NOXAGUILAS1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:10.
% 
% [Y] = NOXAguilas1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.0093254638866203;-1.9114605820120891;1.3148811145205594;1.0191824888851915;-1.3174640692161104;1.2988942708702886;-1.8145973804268396;0.056489033123538979;0.088647433110930013;-1.0980265709103187;0.30740620972085275;0.91370532363492696;1.8149880477137652;-1.2089927431933627;2.2945506755660197];
IW1_1 = [0.39283919314481619 0.84584979476092037 0.40978368674918414 0.63034974871938709 -0.09050641013392384 0.086189064766662701 0.32955041630939508 0.66838774145259772 0.35860060406834776 0.30607871337578285 -0.22135641382066601 0.2760875095351365;-0.042116217338360636 -1.2278069933786528 1.0572975623216303 0.24676414285875353 -0.61706847158142086 0.8018368235386315 -0.068623183518723124 -0.60537837047383469 0.27827212370046844 -0.87327385792667966 -0.51755114010397185 0.075902829406654604;0.14103982303279908 -0.62189141268503112 -0.12293841414660547 0.47921631530617753 0.42093618223687829 -0.031135487350747608 0.1222872059340735 0.64273373505328635 -0.32744132567073492 0.77183382677457724 0.29664522110534924 0.61490806312557655;-0.17580410459907284 0.26331624053912561 0.48587351260647776 -0.50430971625847543 -0.24885013162561487 -1.0524131665118051 -0.99737477760373705 -0.062946021271980956 -0.38205121467271519 0.42447670189620251 -0.32706160696794256 0.062160600797276276;0.080230678811447867 -0.051690034105591393 -0.1626114873002612 2.4116685728145879 0.19496509030753179 0.41244009208003457 0.27866614046017091 -1.8866085338294811 -0.21116892811661364 -0.92535491243299262 -0.35048207386603036 0.47130892517238221;-0.074651754097895553 -0.73443997625006419 1.3689271794021145 -0.33455369856712674 -0.17393715491426798 0.27819991657926468 -0.0056111453508290764 0.022863639456690409 0.24242717765312594 -0.23852587159918223 0.092240569320170954 0.006696079551582107;0.003087489503630499 -5.9645100238832232 -0.79520566243480617 1.0237217701310697 -0.49899634433130718 -0.43193364977007753 -0.070652289594067663 0.26145563809564376 0.073708009749063524 0.12138854881700309 0.58671888878481615 0.40959800418703923;0.40108424559011202 -1.6645969281400701 0.38798573710678291 0.44934940120372957 0.68951875061316359 0.4862443206728293 0.51519009461366938 -0.17983945144172025 -0.14265325151263278 -0.07848770649544673 0.45945937383343183 0.63233884206550406;0.91004378507622907 -0.36062046777035783 0.15854802739790833 -1.350062083011051 0.35450144796196387 -0.28176676407052853 0.3557562315214432 -0.13235189201317346 -0.1692557100236502 0.18563795881170084 0.018943791961728219 -0.67025136510482786;0.075566242127821842 -1.017536209345272 0.3390499565549388 -1.4475273727781226 0.0061586416544036245 -0.0091276188130984606 0.061493381700174293 0.28454114291466892 0.043368234289837618 -0.062190170727833297 0.014721965439737165 -0.274087353698174;0.15132865909174575 -0.56433341609739252 -0.38155743695800076 1.4125446856027655 -0.010276049521064125 -0.24107392678467224 0.0017876920857103282 0.24626554597645428 -0.044330988257983345 -0.064693643408524182 -0.17500367311712275 0.041047464041764431;-0.024675190236554206 0.6692087227765452 -1.0523654498964132 -0.84057733206966978 -0.39231920777763024 0.11166947568705465 -0.46037718479493794 0.9401349645654079 0.9087226363247346 0.57102158336674613 0.25183357702462877 -0.52172399531256508;1.2078384189727291 1.8151432498385864 0.99391633257594891 -0.834091671718032 -0.35880829735244502 -0.33625082410290286 -0.089963549965161746 -1.3344579612871488 -0.35568393478442845 0.079612142395886959 0.14919705310493869 0.67070303097022921;0.031488171380338603 0.62700840713284722 -0.21047090296665477 1.1444137478674932 -0.21802322492694209 -0.35610941801353524 -1.437909017768078 0.43610810996568694 0.13274632539404832 -1.6499636130507291 -0.33640542123330736 2.0409741170708262;-0.24846539994241162 1.0654220371618659 0.89168090368546027 -1.6109032081287682 -0.35289444070722553 0.1414328180812276 0.79878635829961664 1.3745291179656927 -1.0607843350657225 0.19439490943022894 -0.54791626610732325 -0.89163047465218914];

% Layer 2
b2 = [-1.5020711576804548;1.485862869295568;0.7763945233855124;0.94001896041212463;1.1323274595528037;-0.52735485338537502;0.0047147040883940925;-0.062460450090371225;-0.28457264623386225;0.25520822134549392;-0.9531741959248996;0.77447109253792557;2.0451940049729704;1.4994242789081076;1.3909070999309401];
LW2_1 = [-0.0075372473706791371 -1.3732944906264486 -0.20207712556271379 0.38237286897127154 0.19125824923833529 -0.40212046649963518 0.57763982026418204 -0.12901763998092405 0.080530458853504905 -0.15995735719469562 0.65585777655848343 -0.40913779741912087 0.30817020491009434 0.67670701989207904 0.56859211082149308;-0.57753848573820965 -0.58547358050726006 -0.48839429985445892 0.012279706402230807 -0.46831903829023946 0.53664315502895044 -0.29823798302528998 0.57573300821817819 0.15089378908634124 -0.41214455506368014 -0.12925163072130805 -0.045520768483937588 0.58152977170070275 -0.55964579684423232 0.49093663145039662;0.36221502971862951 -0.029442915472809843 -0.31284063985870636 -0.053734881962737159 -0.19320673804886065 -0.35265336661140234 0.16062917671257304 -0.40928744558283853 -0.52622936309112467 0.91879596485516912 1.5744028395115519 -0.12510681669595633 -0.060975433672275585 0.53127852013733323 -0.73903501377017633;-0.28887572739606909 -0.84220871600914748 0.034588072025187835 -0.22318687902920065 0.70505372903049701 -0.18349026159383588 0.17862687584928158 -0.24195423492784024 0.38261869803923976 -1.033864000585881 -0.73085796917276069 0.24628312463951429 -0.10743964480557458 -0.19840339322834086 -0.42972271939034035;-0.51617415657691845 -0.926278742205217 0.2265377343483084 -0.33754992063391298 0.14026454269587074 0.54043185750179668 -0.14168163334243591 -0.26465746888909625 0.28835671804857144 0.20305024237594049 0.33727439969201539 -1.3100945219945388 0.059693458711799229 -0.36981953874315027 -0.52817738118037161;0.52342786588819634 0.33681195913047335 0.44694706287189018 -0.39920830231258192 0.5668445970253384 -0.37549540217829619 0.39373008965829664 0.57205447024763234 0.47448981686090902 -0.39071930583023978 -0.46128040617151583 -0.13007152230520042 -0.57153267779969497 -0.059646086259328851 -0.59545726639835084;0.018603357528753306 -0.96193625797800442 -0.49302482316374779 -0.36844725545087043 -0.12099334314038321 -0.14444674532405657 -0.038817166250717169 0.46895524331036553 -0.43602653546904047 0.81046023659758615 0.01616166741371192 -0.95191351774310307 0.2648548788320616 0.86625984996013516 0.8198198466447294;-0.35087403922021299 1.2423983963923202 -0.2452556677491313 0.074393353812611557 0.25060086161718037 -0.77539204703596498 0.99019349845185112 0.14797867802675513 0.079409742303458319 0.86092143501968854 -1.2499647757150556 0.19440220914941242 0.3513074498048892 -0.28391030846424126 -0.48757562320798442;0.130392192244695 -0.28746409740060191 -1.1010296824772723 -1.8822726454178049 0.24036664275889313 0.45745437188113885 0.55969051823093507 -0.75726779273781164 0.017653306319627977 -1.0964282303354038 0.64411028398784576 -0.35183747180450142 1.0020697185367178 0.65198609521032225 -1.3119568432511657;0.76955657870222594 1.3160581742471873 0.76250420796771934 -1.1062072398449274 -0.83212293909471391 0.01431334036309044 0.26839053772002008 -0.23413587735356278 0.21205993117885197 0.35363779631640829 1.4648539537405758 -0.14063012084285692 0.55143731811079455 -0.16552367978935373 -0.61002657497751644;0.13169470965518382 0.1137181941997087 0.50810829076730424 0.3058144294001145 0.21192811231112424 -0.1392029501985374 -0.46726204881114941 0.42689716936422145 0.15235326140530817 -0.48562227033264527 -0.17314878869986566 0.86110991293854744 -0.13312708161590808 -1.1004320005346162 -0.14402867207659897;0.26515535819106023 -0.34398431438756683 -0.75618456934970002 -0.74860667541155512 -0.47725778027175725 -0.095956445294732684 0.62198467202797536 0.92441667311383191 -0.085401968212617335 -0.61826537087134426 -0.024063056257882291 0.036743517750956245 1.1471891063612578 0.58838567757452953 -0.2680577262611944;-0.86687265939023617 0.78528646477937658 0.53652384677401788 -0.10669268309144929 -1.1167278699344994 0.039120737882955899 -0.27527888959355201 -0.10361327817929339 0.27539182419010072 0.36215357673961623 -0.30495630394675782 -0.63713242724609798 -1.5565392234581279 -0.39845761736303764 -0.29248885823619114;0.62696707613991798 0.81047636193509398 0.066176632788066694 -0.031652462180773444 -0.53757010471414857 0.45045128172323873 1.2315212819601864 -1.3352934965127781 0.59219959133981104 0.53119877524895764 0.25680152018660923 -0.13164387478397599 0.084011853172543699 -0.22761299310705793 0.31107303599665775;0.43933741047837804 0.59451361205429454 -1.0667582233794097 -0.27961151982308813 -0.78426628293702361 -0.61782981846422125 0.44133655191640092 0.42426397662026855 -0.97426176468372794 0.35517932623754522 0.53000196484736006 1.2241023451195094 -0.25405367777030802 0.81928933945733917 -1.1667327325711589];

% Layer 3
b3 = -0.18275680165155098;
LW3_2 = [0.5977639210393636 -0.48690897814555567 -0.94173121347013777 -1.2828825048768302 1.3785513916309773 -0.1107218561470311 -0.81718509481058532 -0.51476967996377276 1.9728305875664467 -0.41100478814530556 -0.34622020708670298 0.28877288866939943 1.9916567562623164 -1.3343562519632042 0.52455322079521138];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
