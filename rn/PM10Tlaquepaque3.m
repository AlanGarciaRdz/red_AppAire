function [Y,Xf,Af] = PM10Tlaquepaque3(X,~,~)
%PM10TLAQUEPAQUE3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:37.
% 
% [Y] = PM10Tlaquepaque3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.00773694390715667;0.00572573718866304;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.8825512408268124;0.12858267653836478;-0.96710081169247797;0.27501628868989453;0.99101804141375094;0.14832132937533135;-1.4241971816938959;-1.2343905678529672;-0.77811001862586304;-0.33888753832141122;3.9866300245477224;-1.6385143141712863];
IW1_1 = [0.31945375383599905 0.53812572402760073 0.04134701012795447 -0.85082750287021358 1.4195519488712143 -1.859857307401644 -0.49482437020033454 0.072889514500627167 -1.9455145615077589 2.7154981180498381 -0.34952316308208564;-0.086646052376947488 -0.49351730627572593 0.82839708273546675 -0.41474204093444089 -1.8922133327668227 2.37526659317628 0.37843432021615542 -0.36218617727834262 -3.0793270118126541 0.69639080484120297 1.0615541784531521;0.15677820007890259 -2.6119344284872397 -0.10686479210360136 0.3648001535533002 3.0363059820342686 -0.074496733922001693 -0.18476429875257599 -0.61820881504875114 -0.027607327884519511 0.54547897257792344 -0.75662728664520051;-0.6684817571217424 2.0709828030387896 -0.20376582882321753 0.67114499215536916 0.85315494501901901 -0.54983042654661951 0.083860955911024812 0.18029093234905949 -0.34111464912167078 0.16459392516600976 -0.045677222056435846;-0.75861767581398276 -0.58419810665630512 0.2487609807906502 0.041822165450662259 -0.036973642755367311 1.9715016558226499 -0.30599801056832243 0.1172911891961234 0.80634874891377917 -0.19213279324913116 -0.072968499715468274;-0.23104982375507432 -0.51520081996323752 0.097914447183858638 -0.082095203927745761 -0.064269151708894953 -0.057100250793298869 -0.044050587480793109 -0.019965095845436438 -0.45896354432676822 0.053354119385718456 -0.1027046725955709;0.38077798498169618 0.4784922095639062 -0.022972985994850755 -0.047508718691744348 -0.74106882566178633 -0.40501158974056184 0.071601381565692554 0.0040777448530410088 -0.35272049897040181 -0.049014891529044285 -0.056312862541638475;-1.0397552997646407 1.285255421492691 2.6360382711151282 -0.10781912867810074 -0.13847529359829885 -1.1883653972826054 0.32985811493821526 -1.1251657425974277 -1.6228047968886417 -5.0361056065635612 2.9601741330626692;-2.2820421662805455 0.52361054680558261 -0.60361555950002765 -1.2793597482812737 -0.18432008513922041 1.1958983612565599 0.25377515939768641 -0.22239506294173225 4.530029880404979 -0.18697335705316998 -1.0404035560804692;-0.5586525891377111 1.8592057702462592 -0.39221817030527939 1.3949143452487396 0.65121420479582426 -0.26191346848954139 -0.12495810853111917 0.35781407782230423 -0.58459839651967416 0.44707675234505739 -0.31265735573787962;-1.4142290626767673 -0.50635968758327166 0.49512111740666354 -0.18337169227938829 4.3197391372679732 0.22245117116213181 0.18693221901537693 -0.048998850244088205 -2.326146153291667 0.66280527030232383 1.18311466044981;-3.5834253853863718 1.2724686802642948 0.78585193239403839 -1.5563279097045208 1.4879412896091939 -2.1830935419872048 0.35660910642645133 0.0044398062937043457 0.42901622318226967 -0.43185976741170778 -0.79165719582962246];

% Layer 2
b2 = [-0.27626563231390849;-2.4331961563791968;-3.591076271293876;1.2505645153334877;4.9729927761450234;0.879329210649892;-1.4206080301946142;3.4433321593716468;-5.1798666311799346;-2.4697869181329959;0.40048302922737833;-5.1029789791468501];
LW2_1 = [-4.7007464693123691 1.3934493791625349 -2.1609414820616411 0.93777460367099219 -0.48793962947991659 -2.5921728818343146 3.8469765015792161 -3.718513230826658 -3.408116314304583 -0.55428056695089223 4.5754761271704787 -1.6800129853690111;0.14805649745289448 6.3805178028300933 3.0742395080774245 3.9611286666113164 -0.95260451395231216 5.3285219686818328 -4.082689889435569 -0.55934609908980792 0.33318771886223342 -0.91425216001076004 -3.7000547118521316 1.4407521770652736;0.41296197694950859 1.2810287446048212 0.20224881898378513 2.3232601612752326 -0.31971689963294464 -3.0401331468774591 -3.880219256326964 0.0097348724748721749 -1.4735384900046553 -1.080323627383718 0.5734985305203566 -0.54361831342143452;0.16036536369997467 5.8506711514375871 4.8220930970513143 -3.5318313411739495 3.7154132850830224 3.5691051191568159 -0.94202423136913493 -0.45432419314179451 1.4634966996777536 3.9688329265167974 -4.3498108413798038 1.9822751360674515;-0.27721764233461421 0.30778453914176124 2.2271304759462929 -0.079538779226222198 0.3117928974948484 -2.2567035445838943 1.7172648547381162 -0.29087642194161689 0.033515169468995874 0.18926856134352374 0.34032076671052797 0.1623654757026419;-0.87900117360060859 -2.649506141144975 2.1071644447638449 2.5381040220733446 1.0425074629615074 4.5109475613486474 -2.1222859708896897 0.13303104978770519 -2.7803683196598716 -0.11196980764772364 -2.6020475890858652 2.1107811689864233;-2.5024858427116516 5.3180400288088823 2.5335912090914552 -3.4665614784685284 2.9510162415281744 1.9262730317689598 0.17161247561184939 -0.31359842488158701 -3.201609568054232 7.6327458649355782 -3.7423497859483383 0.94916706078145174;-1.0863679620740692 0.54582839037250386 0.36103907932771967 -3.6662128046077851 6.3043205477126669 3.4318806091915541 -0.86713116205866181 2.2676706928751984 0.56078558720605076 3.5659665255062598 -3.0607314265530827 -1.6400003834989554;0.75373835356705754 -0.12806287882906559 2.5426131539721757 1.7125714499801741 2.9836713030134585 -2.1197219381183858 5.0214923196273258 -0.10172893854164994 0.4524698100393863 -2.3334203886745959 0.42762501358254429 -4.692685980331083;2.0963432111267819 0.52052399769750812 -0.52261895458769569 0.98894000450097619 -0.36072929594699144 2.1004609947892345 -7.3203882319421378 0.77934235524322826 1.8928461622685344 -0.75283426572809964 -0.29689314988169047 -1.5116897353458731;0.17657707977347406 0.71115139723226162 2.4931510135563832 3.0888253598094599 -0.33993379755183989 0.4360380368472519 -2.7485986913982128 -0.26713589700749452 -0.39307920281574565 -1.7620505628931427 -0.4720743965464681 -0.45383786424168199;0.20834646690870307 -0.47113819859129996 -1.6800952681668291 0.38215008301722692 -0.13485353113318874 2.9683427744456528 -0.92225239317981278 0.22801944454269379 -0.0073873878145256713 -0.37488297808496185 -0.15964081919351805 -0.24121040688777062];

% Layer 3
b3 = 0.3041418958487071;
LW3_2 = [-0.041490321733203855 -0.081857243252740575 -0.092200754429251949 -0.012182158819461568 -2.803337889866603 -0.084918931067489337 0.031252605764569827 -0.038661448222503753 5.1210141699254024 -0.055334017117464704 0.19879138576793159 -6.7638369021420672];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
