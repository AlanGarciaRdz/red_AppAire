function [Y,Xf,Af] = NOXTlaquepaque16(X,~,~)
%NOXTLAQUEPAQUE16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:16:23.
% 
% [Y] = NOXTlaquepaque16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.03490136570561;19.6078431372549;0.0212539851222104;0.0523560209424084;0.00632111251580278;0.294117647058824];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.0948622911420216;2.1560785186221345;-0.25557983095712927;0.92417303301780263;2.0336700344703416;-0.97653617880016608;2.481508705556414;2.5090693061972731;-1.4631519738342549;-1.2095309028924714;0.28599485448516881;2.2647152246891538];
IW1_1 = [0.20407723849171505 0.47502680671984365 -1.7139161771852029 0.86066898943392223 -2.4545966057137361 -0.54761509156749422 0.073743190382057913 0.13540518184527281;-0.33640182198699453 -6.7302297649909821 -0.96346254873615056 -0.48222739759186639 0.92884190421636059 0.81285214496524449 0.062342592086284475 -0.33076817565011485;-0.22455946343395186 -1.6107067939535722 -0.21845863054193726 0.45449121250228069 -0.89908942281289028 -1.7829556560837048 0.045668845317078689 0.3044063708144315;0.59328676806072655 -0.97448939339502672 0.39701973219649667 -0.27718249324826033 0.21780529564939524 -2.2275711134073468 -0.16762260852935562 -0.32642241442828251;-4.81630085112754 0.25077284302200686 1.0182752446999577 0.13767151878512499 -1.0569190125510901 -0.95843430387828732 0.17123762603163986 0.19659871685103172;-0.33786372132929787 0.53421098044639892 -0.042698241961758546 -0.69622938876965623 0.76075498049721235 -1.2782318596844673 -0.066526029280685045 -0.16034325271926711;-1.5252560818262635 -0.055255841932718076 0.86790560400055461 -0.72497176724384726 -0.84958229821497133 1.6342643559476304 0.30710606301493942 -0.20957006985579091;-3.7870692817800391 -0.051023041061385825 -1.0485657535968509 1.1457139668351146 2.4370698764540499 -2.6934630520437182 -0.48393669848800697 1.0232858643394902;-4.1103743942367323 -0.48430800883111597 0.136768958229354 -0.5101614380427868 0.59850240086016759 1.9098284486707984 -0.1153906860645188 0.66831350251255528;-0.1627451415204737 -2.3982761480609986 -0.28336890328270509 0.0047173326454442088 0.22735399435450829 1.3519996642069341 -0.038017495746512663 -0.019901812770781156;1.7351006335490566 0.40714475442308518 0.67489810126503536 0.74393227347248891 -1.2317508038931213 0.034334027683019228 0.042504354479079326 -0.45939403870674284;0.3122507283992606 0.81792897057432512 0.93741062618906856 0.38606137109612038 -1.1365927287069644 -0.15300496672342906 0.20554418121146345 0.29508046617660283];

% Layer 2
b2 = [-1.6987564507034227;0.1525804814904175;-1.6194075555444127;-7.2951946221740318;-0.86628846687832795;-0.78961219823361972;-0.75197698893305631;1.9744552710625813;1.8555933884247338;1.8398229288702401;-1.0481508240293749;-1.3228905673271554];
LW2_1 = [-0.81584720666772015 0.64067358513388539 1.3105057616809048 -1.8159012603490365 0.40265895798089857 1.4195638077902206 0.73337643100298322 0.33953614023108869 -1.3630794783727171 1.7268717523708776 0.84986454476632556 -0.24253569053950214;2.157926610046383 2.9164984081299408 1.5591827141313559 -0.35678396392066469 -0.0076001086645966897 2.9995649747963817 0.71649229985651508 0.26372282871596053 -0.94506202003195283 3.294600877476062 2.6842642520413404 1.0928589254964318;1.3076709690263471 0.1428251779994274 0.19669282843109787 0.55483792461510006 -0.42463967005873704 1.0510082812491162 0.35420231506925082 0.042900973039100627 0.53065927215533149 0.15983969130053527 -0.19750828447315749 0.16502958164773088;6.0726485038514486 1.1745494954822926 -4.347314730617172 0.057364071043954711 -0.51953128291199535 -0.22203646608609751 0.4200472053771549 -0.28876576918589025 0.79101276418869593 -5.6461611850608078 -0.73778314015599777 1.3115676669925136;0.12212851324275381 -0.13098051309856848 0.88138007214304326 0.10869264618258759 -1.0454583087776363 -0.87499954023522108 -0.086109222518307785 -0.045927907733283341 1.2479846537129649 -1.0304991865934003 -0.46101128327448471 1.4461791035005278;1.1127310135589881 1.3825474404711986 2.3118462704129978 -2.2046131287799344 -1.0938923640312908 -0.051586856300104712 1.8774606478692384 1.1249721660031715 -0.5478069655309068 -0.33100586884334487 2.2248126575746827 -1.6522052888812635;2.7626529127367569 -0.065839939847982462 -1.3111652319701983 -2.6227134610696767 -0.44102996854301579 0.10697491880305704 -0.31155493344884344 -0.55798075956012039 2.7568612648714406 0.19032146599605151 0.38355873988301786 -1.2467372369129084;-0.8525928116559951 0.36323005277595111 -1.8166783045629571 0.60460917743336329 6.02274976759296 1.0621867268547709 -1.9680985746572348 -0.98989242547295231 -5.55022127346197 1.9756510821091142 -0.94988183086894307 1.5096871140650563;-1.1698312972356228 -0.53647896227300806 -0.86159060430566237 0.47237840711252604 1.0167820424336085 -0.12984239418165935 -0.050417073041864852 0.035483885399552689 -0.35505222801224712 0.40546185790442418 0.50029511339940358 -1.0989344533656107;-1.5745518700839098 -0.0031178867335876622 0.72792310983918185 3.7276556238853433 -1.0998406617486292 -0.46363715134084232 0.34821948641014067 0.36351483648325683 -1.702666722656087 0.18049452803724048 -0.18108785789262385 3.3261492150743268;1.225036863380792 -0.3825881184981425 0.52806620924323211 -0.47922877167892836 -3.5977248939305557 -0.85310587968583307 0.96698750159075431 0.76423615291807934 3.235319536869083 -0.40013232450606406 0.78737237863165543 -0.62509537457528308;1.7584346367069992 -0.041302101262569349 -0.0089021560947592851 -0.014522744225818153 2.1370538174954463 0.56852379874374614 -0.036422141810194673 -0.11000304577057937 0.77896099034431965 0.83451190883502002 0.38568416917710757 0.58446592549484533];

% Layer 3
b3 = -0.11304614239588053;
LW3_2 = [-0.27870693617006326 0.19068843652417319 1.2045660111049141 4.7468490255636278 0.1211380519723505 0.11913698479936524 1.769296354603503 -4.1026849949120825 2.1662792177502301 4.7108697510749709 -3.799706634073404 -0.44920510609655001];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
