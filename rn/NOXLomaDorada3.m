function [Y,Xf,Af] = NOXLomaDorada3(X,~,~)
%NOXLOMADORADA3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:23.
% 
% [Y] = NOXLomaDorada3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.00280033604032484;0.0179856115107914;0.0558659217877095];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.0680802687917303;-2.612847292885208;-1.5935292477158596;-1.2785808448483249;-0.83254198131545831;1.2689447030438732;-1.0986094584655326;0.85158567922967521;0.30931058007732659;-0.90142832476541446;0.90829018971464093;1.2558186153579636;-1.3998008565782141;-2.7947965698838884;2.2513202405770918];
IW1_1 = [0.74302300866046889 -2.655631188128988 -0.55014037872961874 -1.0652215093728652 -0.37230138206671182 1.0792739084103997 0.070267117834442755;0.89675451565963504 0.21561700714376564 -0.67996410871802782 -0.84550095869492903 -1.2102592405746655 -1.020283467190146 -1.9914417692455717;-0.10677010790933122 0.98550358166845964 -0.19732313846402919 -1.3635342897871503 -0.43685103862367469 -1.1824638011180708 -1.9829126068413687;1.988797542284825 -2.2183359604707658 -1.0383354399086628 -1.1800966073551011 0.13520813766415163 0.61206267019558069 -0.22740821558143742;-0.092552836212842993 1.4885921075154875 1.3085412059574801 -1.0031717786278258 0.21195163120280774 2.3825339523493185 1.3207781638303353;0.047240281066552148 -0.35931295573174149 0.26687889080975724 1.8785870099618656 -0.26311201228470804 -1.9491559830363976 1.7143127135363576;-3.1515989208547492 -1.4920947061109966 0.83361868413695683 0.98498929134662927 -0.057498612630900059 -1.2283060805700741 0.28104838712807317;1.5859256913164905 1.4220116378212635 0.4575920883413756 0.98364720352862978 -0.025940521490793483 0.27239059965223128 -1.7478752634037504;-2.4528731964623618 -0.99766958163642194 -1.1856855825994781 -0.35390687756760997 -0.66885760978808417 1.3020053404119551 1.3191267361720973;0.10373746167402326 1.4118812479606564 -1.9564026739681111 0.72389454477220438 0.28724682831680343 1.4544169829209781 -0.95733660591879;0.81467828242794427 1.6590644694835843 0.25180305006140041 -0.58759301274618947 -0.034370447503189135 0.40593061682628939 -1.1406147725360611;-0.1658779309499113 -3.7835239050870673 -0.87655708034016522 -0.59874867710152535 0.1013069360537296 1.143622353830432 -0.41452345829931292;0.1489406796541986 -1.80405945756221 0.78673067751030024 -0.66354850212658967 0.08670592117260234 0.29035938824783852 -1.2349661260889615;-1.2574517073769815 -3.0529205488701883 -0.93908127123681595 0.52462005754745811 -0.18570020997269507 0.28272412229542421 -0.25916768639601118;1.3527415657258313 0.53925712922485902 0.80220644551304299 -0.68829190444084321 -0.49948001807924353 -1.3022529653605637 0.093878063369761761];

% Layer 2
b2 = [-0.34411080927484422;1.0783667299573731;-0.34221781960013359;1.8360142789023062;0.041936330474210207;-0.097382216678429001;-0.4238004848150308;0.73113022052907295;-0.63467211392970602;-0.074486433888439382;0.89015658790387109;-1.0531459267972711;0.36127479454500311;2.0329093949045891;1.4324410805509145];
LW2_1 = [0.5598544985356938 -0.16661117309676232 2.0377434869131932 -0.36502757265521479 -0.40952701339863451 -0.45430830961794805 0.3169815495665359 -0.83704861555862387 -0.85326338035019567 1.1387202264811944 -0.90774742805934638 0.34095873068009086 1.7060316507013304 -0.46718928877158405 0.14111789717930129;-0.3780221354572223 -0.0036639746218575867 -0.22459469893402423 0.11747944903028704 -0.009856768938565269 -0.015866127169283359 -0.59487335738521308 -0.44706091055936864 -0.30440362082432426 -0.048698625123322827 -0.78934647099332789 0.92926492319312848 0.32110250604916413 -0.14593861725246454 -0.80324105818234726;1.2403655633148318 0.33077818309509882 -0.33115663489042235 0.43757737729882373 -0.74140121260425795 0.50909021604139104 -0.70732800095234472 -1.3291708744757158 -1.1546829339578566 0.35055748645352491 0.29923654269331457 -0.64850394554395541 0.75386901032535947 0.039126737971664313 -0.056611786296187197;-1.0097594268459043 -1.5889031636069977 2.3073284936124825 0.39731856572188318 -0.15291359564245161 -1.2950584794756277 -0.83408142850946854 0.53043637063901949 1.3279070042099173 2.2487084493380332 -0.7994411236312986 2.0141131691345384 -0.67936842355423732 0.36759747191517766 0.88025321563659964;-1.0253234707538799 0.2253902075628646 0.31658427031476499 -0.31999445615684702 0.59480226731965391 0.51989223633885118 0.95814396647648781 0.46839373652487787 -0.50559661603261197 -0.72576225951094031 0.73309763056778499 -0.082467181815190027 0.48760936400271476 0.3514403204735056 -1.0655518020763595;-0.57615376580790545 0.61256317065170585 -0.63919844890154054 0.58782971000193185 -0.47107555676499574 -0.17577748942535687 0.28560582318545907 0.039309100429475857 -1.006868727972813 0.47639546048491477 0.9108830320994955 -1.3749070250495659 -0.61998306344418175 -0.066720317220004099 -0.2904430371232305;2.5049881509255458 -0.26844735761866939 -0.071203820641124682 -1.729325348487321 -0.52687044760759316 0.48065484282453946 0.77809034823811229 1.6636975119625268 -0.23417714498827996 -1.3435082646435357 1.7672802452831236 0.089172813265612869 0.1507766068526071 -0.019963521701188217 -0.95983245337218137;-0.12936285031049827 -1.3334823735923258 -1.2758006019239765 0.081947464402298456 0.26858997546896346 0.73574056197084725 -1.1151333922190021 0.36509171423500747 0.14953780737260033 -0.18619442202704756 0.54712751705084728 0.26017956030462275 -1.3284058406839652 -0.069716392668008206 0.75301436161577129;-0.093990911203063798 -0.014134995396498953 -0.29341229899754978 0.056745883908828482 -0.28109088225209689 -0.13583167590619349 -0.57791985285118974 -0.34243140146608764 -0.420344576125526 -0.10703142076561972 -0.36758557402619119 0.86678587310701627 -0.30098792672867247 -0.13175009012338124 0.47222545861961573;1.6341726559317076 -0.53010397495452244 0.041508189670630108 -0.4257146494356111 -0.97124830919446414 0.16607663603473583 0.97539797414948715 1.5868362793632875 -0.018871309509736769 -1.3035606524351511 1.6534456620265587 -0.60075570654283816 0.22019055003769661 0.018263772435084438 -1.5731499741866637;1.5617446789055509 0.015363756995527885 0.47447917148957375 -1.7037101430692114 0.51453698496051969 0.091772419995245602 -0.97922069068610484 0.032185227604072067 0.43766257137607562 0.8708821191582985 0.27402863570630609 1.7152106787535901 -0.86872826514797086 -0.8476680431571989 0.57507783178109395;0.024909478918124589 -1.4219156541698534 1.8909275817650548 0.74208204874854378 0.17717973469519119 -0.1748821858107083 1.16999405416524 -0.44893804954100408 -0.32487619307814342 1.1206208996091991 1.4850136418898714 0.30033507332971887 0.79516400391993158 0.78003143989848067 -0.38743773159488137;1.348400762272209 -1.0925881588918278 0.84705751163269738 3.6404410789735278 -1.346957645268207 0.93984763128050164 2.1756758844456039 -1.2362617030906256 -0.5135688654800783 0.46933170363426946 0.33753233373719793 -1.1123321074233044 1.9979150925848805 -0.88863489270364582 -0.69380964065721962;-0.6646330986546104 -0.13575970259158163 0.038973309472007389 0.44415921114378198 1.910213028941516 -0.36212436632472517 -0.28861002077782183 -0.5379282981450022 0.68881167083588268 0.35834263947607309 0.45938729031742742 -0.51914130842362516 -1.4463479061753257 -0.31625842450540209 0.30018514513445682;1.1827497013686774 0.51430531867589879 0.37722949938111772 -1.00118165069076 -0.13545781211178179 -0.33250906270028235 -1.4797185413108724 -0.76976440613837338 -0.70012806007549533 -0.56597494474970111 -0.042198485838234545 0.4555421470311703 -1.6006969600472254 -0.9781785535280163 -1.007432785876329];

% Layer 3
b3 = -0.061574694117877082;
LW3_2 = [-0.37965213312879059 -1.1332717230244542 -0.56732348374676533 -0.88055473169660692 0.30847416343121431 -0.09055102100641868 -1.0657225885835961 -0.061408172123046056 1.1414302715559737 0.91313419339657931 0.99937011074533089 0.3769321178484572 0.5032445103321832 -0.40826093057950352 -0.50889977394409536];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
