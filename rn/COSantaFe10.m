function [Y,Xf,Af] = COSantaFe10(X,~,~)
%COSANTAFE10 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:07.
% 
% [Y] = COSantaFe10(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;0.448430493273543;166.666666666667;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.4457543144151792;3.4010199098672795;-2.9605449936781443;-0.74747779053891539;1.4010327466647969;-0.37496989947258069;1.1501711987496144;0.69733666832610919;-0.28402150745638055;-1.7452912565408962;-2.8270898517726013;3.7371305163338002];
IW1_1 = [-3.77214199586688 0.57359506575484298 -0.25801297847301363 0.62862096826241631 -1.1708294009094371 0.59450945936471478 -1.9581610983719986 0.18700260215420925 0.19978888473904499 -0.17008900916982847 -0.38770214087850113 0.1027906046152551;-1.7421339835773602 -0.64741367618274681 -0.19183916608511759 -0.92923091561849702 -0.31287629030178704 -0.81844019977548055 0.34873897825825284 0.056074995596665483 3.3487967933678995 -0.34925331642293495 -0.39072481103662687 0.080096865039050585;-0.41789290056359196 -0.27607423385819968 0.28214036566500783 0.15529204985414857 0.058081489207531922 -0.43435374582098474 0.75070472324135928 -0.14889317657073262 0.33912240000624372 -3.6847592986383617 -0.016332626880108579 0.17142577448001878;0.044393221498432313 -1.0422069405170373 0.19852438402872052 0.21524055474754555 -0.37141035492384639 -0.097688281220375817 -1.1205503416295555 -0.09169202414718973 0.26954847460476039 0.082072410503010007 0.36466186543876511 0.23159154412891575;3.9641716435195029 0.14316918748599525 0.19121160117718314 -0.035349606746922439 -0.49789272791801059 -0.84848033868893957 -1.1067295894617082 -0.14507368622523537 -0.017231834986609462 -0.00090044597113116132 0.064057398755296494 -0.32006838520060693;0.052024644401002663 1.5117632268943111 0.26724998550938922 0.11896426410210301 -0.36859966306995728 0.45204074057003441 -0.14836769522492116 -0.45135309686126041 0.48307488405335181 0.21898129845251907 -0.46637178338543733 0.19589350981317219;-1.8082952649660746 0.35454036740889006 -0.44421764493505245 0.3783756640369742 -0.67331965820565154 0.024120400447653574 0.68255929528914827 -0.30284967083373387 0.64611171355763397 -0.21107314447770145 0.032072275152267522 0.22377331877458498;-2.9864688767282708 -1.0235141608617391 0.52023249474878253 -2.0816303236537217 0.13573237354738402 -1.2883804708953148 0.37141645060855194 -0.54937872395686638 1.0940752822996787 -0.30719102172965579 -0.34445586941233414 -0.83094890340893746;-1.1765357378585315 0.21929303202291009 -0.57045922425323836 0.52004903373128497 -0.23038861856370974 -0.14075808669876363 -0.36736958228113237 -0.09482354552705255 0.37052831567140432 -0.29261371498071542 0.36300665728696468 0.28604763383093623;-0.11859523538953165 0.72346712834873483 0.31527844171261749 -0.18416399504225733 0.39353738981813202 0.30215458017578922 0.018468485181546007 0.31701060909993706 -1.3913868245805596 -0.9073112472176833 -0.099405093459372276 0.037172528591363121;0.17515836867417772 4.2994659580455057 -0.13849338509721776 0.29215732385753979 -0.46598790865508366 0.25691973624880338 -0.12752659183582249 -0.2459242890651146 0.39926142427137218 0.34277724750598421 0.42428910021767691 -0.13725074175688473;-0.12854226846727682 2.4644812665324483 0.36015543175341586 0.055431898207691947 0.26789370779861149 0.0055785496783622599 0.19998113241680088 0.015116146278695185 0.40089029489430572 0.25941760561369787 0.13758606195339126 -0.22722920912336311];

% Layer 2
b2 = [2.1648850168530553;-0.24955073891586199;-0.29080733505561213;-0.68102549528561718;0.20851651761612078;-0.49606201719815707;0.62170000012693072;0.0046884383540026914;-0.26350157260556101;-1.5537582925401014;0.2622847422429907;-1.8171880209658422];
LW2_1 = [-1.2264627045268173 -0.24754072535138033 -0.86035863531467638 1.9174196745420873 -0.4542874688146058 0.10324703092220007 0.034982547866778339 0.22853440007588741 -0.16129553417497686 -0.58336701038701899 -1.4461232299558169 0.95109421901242208;0.028626691388353845 0.47149305336699698 -0.40350305500821559 1.0035604851933013 -0.70942154881490904 -1.170396481838154 0.93276442634595935 -0.67322238316702998 -1.6630360353833531 -0.40375262139046025 1.1272318511998869 -0.15386457510046475;1.0360741035113934 -0.32680255298376365 2.6363365619245864 0.32122536670134649 1.1834687999612448 0.58168396246580645 -0.73834999676856772 0.63250155822404019 -0.19849215528543079 1.0866954443239867 0.87423633049192573 -0.6617901902085932;-0.58820151741390647 0.1595566013341447 0.11491529078218768 -0.82707619101981567 0.31350993762433216 -0.82822265299114561 0.59756322714313637 0.85467911233964755 -1.4426552475674896 -0.80400410930122812 -0.68403391920362122 2.0778820414265633;-0.46956336372724888 -1.4237798875254175 -0.19524419698768747 0.35065582619489449 1.3487449902189255 0.8981573336354024 0.0036492946078492301 1.391360729738041 0.16924157671361523 1.6185774988527259 -0.96387307222390051 0.61451543785084728;1.13682226504159 -1.5522311190490896 -0.45251126827717308 0.58863045604446518 1.7480646190978817 0.69479455145612745 -0.036125187512149118 1.3081962447979802 0.080673324928073525 1.7551606365432484 -1.1094422471717744 -0.63049252566805347;0.1764703557170923 0.60119840542015168 -0.41657256497360168 0.23404271212787464 -0.59046826202017755 0.24981377688755102 -1.2689429922830595 -0.29800801421779072 0.10942193306733651 0.029397186228427588 0.33499680885306643 -0.09703752748762938;-0.36858162328515398 0.22601462907717659 -0.54209439889974664 1.418294866661598 -0.59555365074754962 -0.53315178186594481 1.1804334100818361 -0.41092191952761753 -2.4217898066952475 -0.067939641885366983 0.58264786661355894 -0.084197179471172334;-0.61145296567610474 1.0835975338100245 -0.33541120810044883 0.64021540712066483 -0.70927114387600143 0.77488846622764096 -0.82759170453861797 -0.28791831834967363 -1.1050349083955342 -0.0012875134298320524 -0.41330468043769092 0.37388758068693612;0.44208867765714621 -0.32462744846653502 -1.0439317210993104 0.62235987546357319 -0.25961930269536682 0.18685294502601488 0.77550405471097417 -0.24819088640496173 -0.55530160153650876 0.51081778029444669 0.21001813684490464 -0.10820854252260874;-1.7765474157146328 -1.0496765063806854 -0.36883563302583366 0.37628300137863918 0.16945682690182634 0.18250104325861 1.7680936544766199 0.46408155939449391 -0.48433803299536188 0.021746658877156974 -0.83582700863563619 0.58388358262289553;-0.50439573920302638 -0.022127668583539484 1.0767254380065849 0.69512666177298843 -1.3695990836869285 1.7877609494455391 0.82015605805824676 1.883944450049128 -0.28885399871676765 -0.31598168736950016 0.40498855598722072 -0.36763396200137283];

% Layer 3
b3 = -2.4165667263821353;
LW3_2 = [-0.76905139211091866 -1.5102787293940707 -0.91961903341123541 -1.1736194105827711 -1.0080158073630301 0.66109022607465284 1.2493097867126115 1.2410469464962754 -0.79855042275017318 -1.7118247045068207 0.55080582526560706 -0.92453373094262536];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
