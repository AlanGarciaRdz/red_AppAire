function [Y,Xf,Af] = PM10Atemajac18(X,~,~)
%PM10ATEMAJAC18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:59.
% 
% [Y] = PM10Atemajac18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00968992248062015;166.666666666667;0.0561797752808989;0.00614628149969269];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.12442027732766654;-1.8651993001426947;-2.9726785444962553;-0.041155583779823826;1.5309310297523477;1.870785529273495;0.053732344059865614;-1.3950132037847789;1.0479081839684621;1.5177762802941521;2.319030036788686;0.80822819323469708;2.3183028425895698;-3.2697367021877959];
IW1_1 = [0.50477350637410701 2.3517728522768802 0.64079218988563591 -0.0014544008441175239 -0.85491925531884816 0.0037933876579682819;-0.63551608309767249 -0.3061952892441932 1.4489229809304693 -0.73911018316469157 -0.85067039624979879 -0.48224815180112174;0.1658980332226874 0.10919141557736939 -2.4021761926329153 -0.19931162890738346 1.2935218325176832 -0.17730075927465608;-1.0112581291435963 -0.98711247250167899 -0.62955569884108098 -0.51516849854673996 -0.83561317130041612 -0.35217060852356424;-1.0603471316492981 -1.6697524556950143 0.28458614102899843 -0.38354198014460206 2.0864677030955585 0.027904811242927326;-2.9915668114529153 1.3193878558168373 -1.4828351133184738 0.35017933854411482 -1.5353240283736256 0.29590696574965841;2.2895175771295158 0.11455798282398183 -1.5434107087462812 -0.54537906011522552 0.899543403527856 -0.061823798767278497;0.42574441683913411 -3.1888292816996096 1.1005498486502014 1.0280858654719776 1.7716968463914207 -0.072531417219447003;0.016644566328588271 0.069493911027290065 1.5566232709998304 -0.1704338069784429 1.2980286225545137 -0.17559560593783877;0.22964352494015294 1.9915055140572189 -0.099482212979631182 -0.10134777929331884 -0.38787985645235135 0.060662589447825335;0.88377593869255133 -3.62167645889153 0.97401538470169258 0.35899738707350304 -0.048811729778288335 0.1667460048874293;1.6148534906901528 -0.45914003244819129 -1.1934050049186775 -0.16712061713385296 -0.26769380672886373 0.76654846478242866;-0.84407087703478234 -1.3756821337643435 -0.84908562516321906 1.5466214570160801 0.70990566702777391 0.79949824001476599;-4.1669885085095819 0.2960292743112638 0.88986766780523574 0.15222769936934141 0.83001940677632313 0.44374000103615668];

% Layer 2
b2 = [2.1150678431412384;-2.3952032670795913;-1.4068706897693877;1.32557141988137;-0.23978800014866408;-0.71508459552282533;0.18937761812838022;-0.91264462121607282;-0.33825009726347566;0.50195153180216989;-0.91100476221653892;-1.4685779493546827;1.7308969831241383;1.4454898468957087];
LW2_1 = [-0.85734161903709127 0.19593444231097976 -3.0356961454139157 -0.28519769067301448 -0.56958761390184642 0.28160274824446252 0.6244840905677892 0.35066948241826401 2.6567302440626199 0.73528686789747955 -0.54553902160201917 -0.12440985560240113 -0.07615546829539975 1.0687082954215594;1.0254743995438209 0.45783688297215236 -0.38441615910364318 -0.85676164366191676 -0.12935761573983179 -0.86533720118636104 1.909584535217504 -1.5543612101619366 1.5409872497845625 0.36813469986476949 1.4004220290064193 1.2984147251248679 1.8119201155432769 -0.56575844929327757;0.43834380068329737 -0.3893014383797071 -1.0315068956878348 -0.18875617867765598 0.87265710689187381 0.58874462687328788 1.3860044415231949 0.56717365617436721 0.2274542443036863 -1.00507972201059 0.23627649771110287 0.050807505416975034 0.095435233331920166 0.98554745856853854;0.89824423677849285 0.38025836636812144 0.65357964888970532 0.15960683032401848 -0.53195856229329785 -0.27084406963289803 -0.63388022048855308 0.94893628896787285 -0.31819741749014852 1.7245537261883328 0.97364017505100564 -0.58475951229570577 0.020519618695040646 -1.244508398466857;1.6077089837453098 -0.45970286037465574 0.44822130724679543 1.9492414320873626 -0.25952664985471169 -1.2533909645640575 -2.3208132190386328 -0.37021455800130948 0.52747885185582355 0.27908699668272041 1.0100906854019023 0.92888821481031136 -0.44348665371110724 -1.075593883891161;-0.81984858977098329 -0.76424961400356395 0.2995986353623854 -1.4211583589431003 -0.86773291509371009 1.1201694035063758 -0.21068389302099993 -1.4874920661425395 1.0945644208033982 -2.6161173359441365 -0.74932691877201374 2.320794795751973 0.52927196910376373 1.4028671580692713;-0.69607179623790005 0.2720857320861601 0.43832297378135199 0.090762209538341992 -0.53252299960430838 -0.12204909671086278 -0.3980468674916095 -0.27580624734480153 -0.11150242794946544 1.5635129358499982 -0.38970016575269001 -0.20378518503647688 -0.1363955786881981 -0.32295920938059935;0.34952525055733447 -0.85922535448259907 0.81880123840632435 0.46971768808736353 0.078235376740249871 -0.47215755435436874 -0.12030636770741887 0.17892874476021947 -0.1628870215287076 0.2065840848743784 0.78935500271434544 -0.28095996505125342 -0.46741317001844751 0.32424136043597646;0.87351289760997064 1.0448262028078028 -0.40984542640813759 0.068395695807458176 -0.42570712989558623 0.24846446914221046 -0.88127873259520928 0.22031826035462351 1.2780860263770755 1.9049416512266231 1.166124055491403 0.88623994617031754 -0.19598414321424915 -1.0966985888746354;2.5917159385403319 0.62820417890931468 1.5730494291835913 -0.082165889577568402 0.81145629158795751 0.032179002879896751 0.40361179684031817 0.29378277105823564 0.20918541807996083 0.62978059374244377 -0.4303327895864924 -0.23417645329575904 -0.08180178000636211 -0.047453128786823978;1.3824889793794737 0.55123139224252704 0.17600495871694646 -0.46447502975231741 0.54246814770138307 0.91305032658608554 -0.62978088183557313 -0.66271361967548326 0.85284501570686178 0.2954139295762262 -0.39521975550913113 0.84337007121728924 -0.26844505586376033 -0.065839065099481106;0.064405328262362907 -0.24379538001650422 0.31114715493301576 0.36688182564883365 2.1209401651578914 -1.1262737335290158 -0.33605750508083754 1.5306009354605152 1.2796717084975002 1.4150963750104955 1.332592221942466 0.3141002002249097 0.34402306735135224 2.0956962099015217;0.83903393844404961 -0.2074849580222424 1.0079815079893499 0.51940699443108684 0.39331086645756319 -0.77950798414915312 0.66804617431970159 0.72029049084876795 0.011195783045517374 0.23378522268319607 -0.098915724974009286 0.086672732870547622 1.1424613776870149 -0.22014233757968923;1.3534209213249091 -0.73154450610534016 1.1416255044046146 0.059636320114163727 0.38259074303492746 0.18147567725947225 0.28452758118051125 0.30886236796638228 -0.11477075771771356 -0.60936591347898295 0.42276802549595871 -0.17559951265113311 0.5028975395141142 0.32301187156306299];

% Layer 3
b3 = -1.007544328147669;
LW3_2 = [1.6666558023341023 -0.22078812138844633 -0.84486082149063213 -0.47916014444618993 -0.37122237512644701 -0.25115412249816926 -1.2596359074875054 1.5495646354529284 0.46679556838696201 -0.18010892805747253 0.50317197799707147 -0.15354245675816799 0.70199471387798584 -0.82071405052946933];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00968992248062015;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
