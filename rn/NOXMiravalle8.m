function [Y,Xf,Af] = NOXMiravalle8(X,~,~)
%NOXMIRAVALLE8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:27.
% 
% [Y] = NOXMiravalle8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;2.48447204968944;15.3846153846154;0.0208986415882968;0.056980056980057;0.0063552589768033;0.141843971631206;5.12820512820513;4.16666666666667];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.667446121048795;-1.9663237261530264;0.41258620670837559;-0.88655425853743475;-0.84531377086928539;0.18718951446582216;0.3173967546821001;-3.9891424783495451;0.51435339878716413;-1.419434594362085;0.22011467385305289;-1.0298569329244407;-2.4654715372124749];
IW1_1 = [-0.00098858865173242095 -0.86344418331096162 -0.29845251333393341 -1.4725066779931515 1.0578063638859148 0.55202509953924284 0.11333096846740071 0.18854814807579842 0.062268765034650946 -0.10608208816106628;0.71350765585991216 -1.6775194612364019 0.38394026751703303 0.75275189537460985 -2.7029379544075778 -0.17604908366185154 0.32078425410255812 -0.72466093156399114 -1.0253149674855409 0.13797382298497554;-1.4346162290377678 -0.15201285038689397 0.36880836853121607 0.21930636818798693 -1.3317311184145146 0.99294162816614928 -0.42772191272068827 -0.20319022548929139 0.076417802867090906 0.28244198223108785;-0.20285546477565952 1.6206908685772674 0.21864140941810994 -0.1793437808017895 -0.01316259829101708 0.65909110208479194 -0.038584463425398605 0.026134700711439786 -0.08880607913352126 -0.11075213718226647;0.10809044342019618 -0.89712858257131345 0.22271601012918119 -0.10042785798212067 -0.6963778219053488 -1.3138490673561434 0.038374476746753795 -0.0095209718563811652 -0.25257876694932158 0.2042794097585684;-1.7052966137965249 -0.31479870351721595 1.1445104495910625 -0.68341030415758319 -2.1369482759858403 0.41405071373643243 -0.91702387630839532 0.15989024612319566 -1.0373266288627931 0.65655906969940048;-0.63176071641617348 1.03357372670255 0.016685028726017154 1.4346407246721153 -0.4322052496886849 -0.33779477671829611 0.25072813192084681 -0.33743788999321661 -0.2441969577859249 -0.19423340834572123;-1.7233089620374304 -3.1241542232411139 0.97433330235088123 0.36667579356882962 -1.3686817284624777 0.69951657900010589 -0.48704858176075472 -0.49163363145187045 -0.13838961918257592 -0.25483233448671588;0.8463372690775437 -0.92158061243424205 0.064419020890516307 0.84793619650150431 0.014121989897965731 0.55039201228513313 0.20569489165930657 -0.12890000287135175 0.012817094347846256 -0.0027962468873212395;0.055232061592744033 0.23093118276158991 0.57819117082490989 0.58561233796772483 0.25289878683141953 -0.70677734304748097 -0.69860579634270115 0.9395478184497339 0.66904699375482235 -0.72521865578711653;0.55680137321845535 -1.3473479686048322 0.098895761968626289 0.98215035275226104 -0.035574214146712392 0.27416788565190414 0.097168053450952419 -0.014108913301815237 0.23658926633720356 -0.074358320484376295;-0.62026095312012064 -0.052385631523732705 -0.4142941966448766 1.6385266106192402 0.48300071221125651 -0.029518502984519562 0.33334170066390351 -0.10073931194731481 -0.18798953757996487 -0.48659406137830447;-0.56828518477301104 0.97831695156596532 0.19870785827223897 -0.30993205454292899 -1.2778624998097079 -0.25375560977413048 -1.1358559697089834 0.66793353489015606 -0.34956661189235105 -0.43119359467897028];

% Layer 2
b2 = [2.3420480781837574;0.58625517057064436;-0.44234026913605762;1.894459417326543;-0.16914238851134711;-0.43699269709140182;-0.065844900140579796;0.57605333800819591;-1.8975718383585534;0.92424893363790261;1.4715063483669575;0.034420611537923848;-2.1158607403068723];
LW2_1 = [0.4951607433039526 -1.036853903839603 -0.2507649315636386 0.40692285623619578 2.2332554997096752 0.21046089569851642 -0.76734051671270986 0.067284346208859439 2.9943592919160089 -0.9417699012415699 -0.8328142814006011 -0.3482092596767995 -0.41401126724317827;-2.2158747128238039 -2.0686932218102685 -0.64731181749811362 0.20587317489557905 -1.089081356199507 -0.1427136599192696 -0.82533440400337932 0.40776855941759149 1.7038500787440993 0.92078376726788735 0.84940133769254023 0.58745044713543215 1.1589922700928013;4.2493114393244422 1.1860125297681048 1.048896333420686 -1.421086270115498 0.88272896090097619 1.4353291613059918 1.4787722028599395 1.3960540714492702 -1.4000506832084283 -0.2359611747566033 1.8535600896059032 2.7036933523834654 0.85511124816347772;-0.13786637435149582 1.3359734532916081 0.18462460883001816 2.0170060721905463 0.39876456703866436 -0.23886033116977679 0.29717813842732471 0.66127721054694311 0.011779217576612974 -0.75505714674736746 0.96700914738253962 0.052455291050517938 0.79611954878087399;-0.047420348598332301 1.1159194651738076 -1.2334271425519028 -2.2475423186628412 -2.0976422601047697 1.1322483474546521 1.6406924686651347 0.51481307943183441 -1.7227747777745632 1.1795233823932803 -0.20512556797744097 -1.302696820707584 -1.0885155093492489;0.45635779965414602 -1.0896525808241708 0.69587226818412018 -1.0341773473292917 0.9519920940174853 -0.50311643709647136 -0.69110009639149539 -2.0961209743860914 -0.56636027992391291 0.39870309868668136 -0.11811802438167122 0.88649075579625158 -0.53212982056217173;-1.2580830760271691 2.0063061574916246 -1.4515936481003422 0.12469416147298003 -0.30911053545194461 0.17958691066462865 -2.1071355415677613 -0.2686471112281073 2.8164760955476544 -0.666891872335729 -0.073661235050878515 -0.49924703411733046 2.869403796265193;0.2350359989710864 0.20013017943961844 -0.32049431925512606 0.89385058833173747 0.91578817399064194 0.053416991295583152 1.226553181870677 0.43778778920512762 -0.85218564414518294 0.7100394288867713 2.3192871827317845 -1.1458725399099261 -0.044241919920929212;-0.446144794549996 1.1693414769575048 -0.6049907441580078 0.88975272076665723 -0.77108476744976273 0.11016438656568184 0.89409149360681028 1.0750989635361032 -2.5210582426548722 0.78832453805379099 -0.71782022267478662 0.051430011299399878 0.12550906285865404;0.75865075303045404 1.2175993219088732 0.91926267843179654 -2.6159413177308055 0.013020235614985783 -0.15873955186839295 1.7572073557183872 0.25296758001908315 -0.67430067124263116 0.65514634891853429 -1.3487074602070972 -1.762476078627246 -0.28352943347140114;-0.48347007910289164 -0.29324322049326618 0.55279268648866564 1.7494121184236426 0.81507085775538779 -0.73216802832652306 -1.6926471284498128 0.77558231491405272 2.1766875963180419 -0.76186069015549263 -0.25940391610591151 1.1161343036204148 1.4889349127496383;-0.81099004360742299 -0.057212799654827659 -0.13575325193672816 1.2845124544057454 -0.32475616108248428 -0.24634840982886907 -1.4684592309306246 0.89813906493296747 1.7429577203944964 -1.2099725623627691 -0.26458823815516502 1.0334307836842789 1.1582336504072979;-0.59885047499944544 0.4953642674705464 -0.99125593255420419 2.0410895903039976 -0.00056655060278420349 0.21397778297065584 0.16292664152408856 0.039409634175169454 -2.1822411313627308 0.28680725753490333 0.75528909218836404 0.55781199336923215 -0.24395776100404862];

% Layer 3
b3 = 2.2414060997359235;
LW3_2 = [-1.1414838259002238 -0.1509214813448902 0.35723491388031298 -0.42771445045105749 -1.5248945043999413 -0.45064470095265979 0.22652927843530102 1.5349849769194999 -1.6949360080211575 0.53238365036025792 -3.0791474444911899 2.6096445619456916 1.2498321557700161];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
