function [Y,Xf,Af] = COAguilas13(X,~,~)
%COAGUILAS13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:19.
% 
% [Y] = COAguilas13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;0.281968137600451;0.304971027752364];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.7186995850910329;-1.2729733998938213;-1.4406425354763119;0.77386427961968773;0.90895626964295484;-1.1550146565506005;0.32517187890713528;1.2385578820005994;-0.22546050276043339;-0.91820255487251778;0.83757536010187572;-1.0047443004460108;-1.4166131039055561;-2.4384051128774389;2.116263887796427];
IW1_1 = [-0.77175769298394981 0.10047417368011949 -0.27635583979874939 0.54381696672158542 0.47129942596276475 -0.21394132847047423 -0.91790875243792491 -0.53694370307431205 0.50770780068727606 -0.33157010180498309 -0.87528174354866151 -0.92040459114372597;-0.0014904754392461098 -1.6401624948571389 -0.4161625344956455 -1.4254988305166307 -0.28854076624220376 -0.29267503250562088 -0.58344122836207812 -0.28050685529242864 0.023202562634566392 0.39534018314859148 0.0067570472220703816 0.15174902503449647;0.87235358472380975 -0.27137033622316453 0.85540910740024445 -0.20173145959092578 -0.38159957655524845 -0.044517435849928372 0.5501956130405331 -1.6535133718116988 -0.45117405853524295 -0.42343627586948712 -0.00079294229727718685 -0.080063028626949778;0.08496909641675339 -0.090431765299172073 -0.37224913159450762 0.85832951476352259 0.37482260377377052 -0.90186762465946901 -1.1056560527113752 0.36210812888285793 -0.17402576115815452 0.011664575744436616 -0.20629527511099038 -0.26354551472738913;0.43424923275374006 -1.4930573697447138 0.096976466318681509 -0.093155873685394117 0.72357136841341874 0.27602728182231867 0.44152858942009998 1.7812974229300422 0.45770475138937577 -0.28071088129114913 0.62384851723136858 -0.0194040725200742;0.55100099652740686 0.11764428665046853 -0.81903614348795217 -0.53794028452353604 0.17632418264730468 0.3785603634057163 -0.70640380907069489 0.064804268303060658 -0.023601808921511619 0.081260375334569243 0.33753283554706665 -0.44117507653128241;1.3494993839855507 0.0078081844974478756 0.85479772840517332 -0.086929046801288157 0.413746788655458 0.13419533177379311 -1.2306474308040936 0.12870293339111033 -0.050793084433719271 -0.035913141242686082 0.14416795464312887 -0.63991737609339383;1.2010790832885272 1.100879663227309 -0.11082918443021787 -0.19055048777515848 -0.74958536845135981 -0.085032794586846316 -1.0255818606539966 1.4167192769997616 -0.11078380873189628 0.7605314464488796 0.4809543300588186 0.56479992243856425;0.29644090838984483 0.69793372036534318 -0.49668018070175962 0.089471041296521947 -0.4714154362874442 0.5316540002427188 0.74718704446292616 0.28729992510288366 0.050581964217080951 -0.37217624086047718 -0.25660428175283534 0.81664563753830721;-0.85345418712287868 0.12242937800329948 -0.914406040971395 0.59160211065734902 -1.1770162473977046 0.25823079616187061 -0.88733047905400653 0.0641598632744141 -0.54763250941664599 0.35787872454774816 -0.35862102429864412 -0.47087606401708298;1.8425550963090116 1.6382129311221971 -0.75297718668664149 0.97267545674007716 0.074244478143416268 -0.20679225006667809 0.38325378773866758 -0.0022170512131797528 0.8175352047712906 0.068227300145210751 0.29280956719628942 0.37855900184684455;-0.7583026649096315 -0.88844157593003925 -0.52154423231200919 -0.75252276933738882 -0.68592450736055111 -0.32672333409101367 0.12834603779320872 -0.023252218836292957 0.19035315581129697 0.060516614471021878 -0.37090371133726963 0.60586131378631491;0.30254976286610263 0.69004954629688209 0.64684424540360486 -0.22797240112876976 0.92117883689324442 0.066173461944740872 -0.26383743420964562 1.2140177347599883 0.65154899240508657 -0.33182749723597743 0.18452810351888996 0.36502914350663412;0.085239869083792635 4.0196579137552702 -0.34594171137054153 0.11182974017657676 -0.26916328137875628 0.23833764671002752 0.15845804087118445 -0.016330536501520377 -0.16916222304302103 0.095843130173166813 -0.093662702368970757 0.34508163554643356;1.1878664068858782 0.42610144825168406 0.31591639288084061 0.50796883491246037 0.21225141865564623 0.41273537336998695 -0.31887802469180582 -0.30335202593290267 0.022306427541924238 0.29316439896420515 0.36870330672274865 -0.0033720628894330501];

% Layer 2
b2 = [-1.8590450616194232;-1.5358981043320816;-1.2214063926625793;-1.5403706359644844;0.56667851132950764;-0.42146259454390328;0.41086331247264124;0.038427673964036735;0.68499627999199941;-0.96690093199021199;-1.2166257880584339;1.0023229565459371;0.77743662852231521;-0.89528949799365365;-1.8547432170968814];
LW2_1 = [-0.033132721084462469 -0.20221229231462709 0.39614826466799846 0.22866405774663628 -0.16885489889863556 -1.3677314892783581 0.94595532406533578 0.25216005457073631 0.62318568858959011 -0.064321555410510656 -0.34722596963561619 0.65482025158102042 -0.2281532574098481 0.72972105421492184 -0.71870096080480517;-0.23237503483357169 -0.58526790131985451 -1.0982655369944891 -0.19969121491461969 -0.63479956538672488 0.86416062720973552 0.089036146137935465 -0.66666534510304465 0.0089558038902216516 -0.5482274317056709 0.5526695812937199 0.38467354375316926 -0.72690027644973243 -0.18052825993603097 1.0603947586674043;0.063907051938185577 -0.32295301084584027 -0.31064336347519311 -0.50433679838196976 0.089603079906097421 -0.1937120194001371 0.003500292699699814 0.19353647715377234 -0.90169642400605532 0.60278616768736704 0.0058282700158447005 1.0662443097162824 1.1028564984673941 0.37376807348364355 -0.79541815435916274;0.064706023147348232 1.7468151800657694 -0.050912859683402673 0.11022073168183963 0.033066087287529383 1.2138333015078346 -0.045122275095401149 0.63749436528875447 0.38293316083519624 -0.25772018845252859 0.0031043281853051653 0.062914059428726424 0.37610504771799846 1.3418357943473314 -1.4312623358412391;-0.5047970304793209 0.14626121297416839 -0.053221414060878977 -0.090814839280096801 0.035961449810771422 -0.23753542401340488 0.61448117058097285 0.099781134479077951 0.27720790011349605 0.25632399928707145 0.82112619607397741 -0.35406229910523473 0.3742459427700674 0.91736959099630599 -0.80842738079870369;0.25293099772136635 -0.73771277529314883 -0.40234658726851846 0.23179127555399842 -0.11756733692670884 -0.02331626983873461 0.027571083849298419 -0.6370795877020996 -0.65219927855666882 0.082964692983250876 0.54529169976352554 0.66251182272261555 0.52543493990114953 1.1158393984504054 0.35172977701842656;0.2219741796923636 -0.25913605383895183 -0.52054060505678779 -0.33021243048289362 -0.13146891612787567 -0.85540226295887511 0.17390376779191352 0.14078713254328334 0.70359566480452751 0.60253780784949018 -0.049588552497882535 0.84025648701776789 -0.2421955259932603 -0.63775755781840548 -0.19971587708525648;-0.14743812213149748 -0.27300601648960438 -0.64867690854023408 0.053929488364671964 -0.0044642603216042201 -0.37030953953152956 0.3010767334448437 -0.26796403576641581 -1.1886725375578449 0.57662021563057431 0.65481420806984059 0.37350169573455694 0.69688139474749011 0.82513402226637667 -0.84620186552927301;0.68222202289299516 0.13470219188933419 -1.0292314789936565 -0.44648944253886641 0.42804836583284495 -0.3495173958919835 0.86372581595668896 -0.092402316152282407 1.0876136823346592 0.62958002353280729 0.76406027278414901 1.1738912606211456 0.098676381051498036 -0.7270563316719405 -0.92262981831140656;-1.099674542809469 0.5992833056800182 0.57686562199713809 0.2404040234783214 -0.54235697168482477 -0.50848498077557536 -0.14338001030912384 0.28305980785207074 -0.12101553397378133 -0.22768343119847684 -0.43199098327094781 -1.1466078359973426 0.045661245402168295 0.32426465811461364 0.83348388341085933;-0.434050859925462 0.93205010608405259 1.0230311052141638 0.085117700074085104 0.99719083668041053 -0.064267205422920137 0.70088674998559652 0.31328543170003703 -0.28432143452093889 -0.017665639496851408 0.60783993570183148 -0.64363476148930132 0.43709842525651382 1.1939540162462052 0.43377589723202004;0.18896874387015744 0.062627930786376157 1.2880102764002053 1.0057241270837753 1.0001249598276032 -0.40180530309697571 -0.0098261910721831932 0.42705372838521971 0.037475081306135541 0.26628112026168327 -0.6491941446262175 -0.055440623729998896 0.48369957602184177 0.16646104363148134 -0.88799467420718137;-0.43152425699688918 0.097341155881147029 0.54671632000020443 -0.84553442971627635 0.36866745367929632 1.1462176060599085 -0.15177369827587708 0.091297344258308558 0.28551379360209123 0.62442365529993604 -0.76870583518253122 0.77914097520172754 -0.1181052356565389 -0.025575326285358579 0.39328160509885879;-0.7362263260143771 -0.26623504997743719 -0.18262958929345249 -0.17266024085598045 0.013679993549589375 0.39202440242150233 1.0241406056273594 -0.050321720190618466 0.061862182160863734 -0.19396852184193156 0.27733160098871618 0.36516774796293089 -0.32817757508279621 -0.13924529893505189 -0.26830883973954517;-0.26242663905936592 -0.1639733251829785 0.31521990727864924 0.14518877980050918 -0.46667469329671485 0.89375214774784195 0.67040576575382893 -0.67788905315810144 0.79447380135918899 0.073362721717372167 0.012011886496583317 -1.1498550885551022 1.0995255018482748 0.59891713452601492 0.25176592182943741];

% Layer 3
b3 = -0.84717736919259568;
LW3_2 = [-1.0201675289437895 -1.3521385368335672 1.5237676538513096 -1.5069806230054748 -0.46864800674839119 1.150281182135177 -0.668088573388808 -0.53340473993975179 0.83654185293792593 1.2051411659600646 -0.79911472719818544 -0.86239325695646596 -0.16404224962122116 1.7961270391818105 -0.59849045762078057];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
