function [Y,Xf,Af] = SOXSantaFe3(X,~,~)
%SOXSANTAFE3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:49.
% 
% [Y] = SOXSantaFe3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.4635150626880633;1.3326392360745196;1.2522462029468051;1.1732991394292409;-0.89235204126570744;0.62906446338472111;-0.20367784585586832;0.16731824050376851;-0.15803169390103811;0.50644436302378737;0.60304143150241318;0.98711385158555298;1.1922039432323299;-1.3940369304808304;1.65739828661591];
IW1_1 = [0.342320484792208 1.409455909674064 -0.56395312239612749 -0.068738578274823714 0.040715738532582743 -0.67078771429269346 0.3986031260080613 0.27478647298519354 -0.035190294219648546 0.89807783985337486 0.37761615386780745 0.78297419514168065 0.68264116626584792 0.094223963237460462 0.61309995612707868;-0.80173575107747364 -0.2763242473595986 -0.0530425344528365 0.48621713008491668 -0.16189588388918769 -0.45640004138281548 0.35395372930904684 -0.074110155175722059 0.036526471802974594 1.1515648997750085 -0.24425922516296017 0.59568511138216595 0.44576425560181515 -0.0080330364336238975 0.29251693552997254;0.095391738586975097 -0.19559346575435457 0.34190941242495254 -0.057178388727313512 0.44083639226979404 0.26152034189341627 0.61568433611901174 -0.23670791861088256 0.28851775679012542 1.8427955173078159 0.5542556857170603 -0.3927914462358929 0.10640293860736005 -0.3015131331981879 0.0022569844839496981;-0.22361949781167947 0.10619817280896329 -0.25464055483318787 0.24294908177319235 0.16476814108158128 -0.13850312905592241 0.01487192620528317 0.10062016440745977 0.016430199984559565 1.251887924480253 0.030609691958496905 0.27665434362068797 -0.074107926125386595 0.16452012906852559 -0.79495591619738659;0.0079078403755500834 -0.18366913041705918 -0.24865186426242955 -0.43400126272303113 -0.43044747423211688 0.50424894138850962 -0.12391806793366342 -0.061312422608186423 0.48069902571680695 1.1119251121296878 -0.40559309032113317 -0.39876722403716791 0.082967198024004929 -0.62735562211366835 0.47882122244756814;-0.34385977790491684 0.7094451511444847 0.18429782436072045 -0.36578683255963063 0.60590841965530295 -0.19605454268576411 -0.89358935372674697 -0.2350864993173209 -0.77382010203848262 -0.42978790818202928 -0.076043477234186488 -0.23247183637771901 -0.040164019257906594 0.67764038259844306 -0.60565792442754263;0.66971082531376758 -0.078892117953296412 -0.2509400235110984 0.10839072112511769 -0.39918221745979987 -0.099123116770586314 0.49836993654351991 0.37217821762134262 -0.49684425459630022 0.12898580618364988 -0.52648252658628292 -0.11918913314912193 0.7622392010375264 0.6670282960724363 -0.34149864237579791;-0.58637190185328925 -0.19923914337824117 -0.49543890422920517 0.17081490197185908 0.063108724578684341 0.21539101149320636 0.26187679752829329 0.23141498443667555 0.70075528234759588 -1.2609627673646349 -0.34880260238549399 0.1467255618336602 -0.030710406031529879 0.046682345805360272 -0.061527446808312167;-0.084908738418078972 1.4202074315946029 -0.62660144974006671 0.20422398227136712 -0.043822051467471181 1.3561335832219799 1.1701408857807374 0.63303223966693034 0.23059577084689881 0.25700005977616514 -0.82528851513062873 1.119244403311771 -0.11711415838722192 -0.11074264384537462 0.94633133889424037;0.86405831990849968 -0.43953340973354998 -0.29802660868579312 0.27608473748945983 -0.2654026025984077 -0.28762081741282697 -0.31488741097071182 0.48249120868322665 -0.43486924046802433 -0.078474576059806608 -0.57003745788131632 -0.09718593307468551 -0.5527953160196265 0.49314242279186954 -0.27619934688621095;0.071382111523529787 0.29626747079623544 -0.51316981359951808 0.35640402890196604 0.66027156425413347 0.50601890239692537 0.5232073300704162 0.36479069028648414 -0.40170239337302782 0.8688949045136648 0.11865800250003354 -0.039943066676249604 -0.25290049971850026 0.49759870576481957 0.72220414633691787;0.12469798776405858 -0.25971226028743621 -0.76700507531986473 0.3523289827565198 -0.49837606393187345 -0.34633443801713987 -0.10201869523019978 0.29306369301319241 -0.67464294966473082 0.17563084410042054 -0.10437637894309132 0.21240137730514333 -0.79441338918563098 -0.56763903350714917 0.25911816978280711;0.195564537009388 0.31223829955381227 0.25112755965914496 0.27198095121732829 -0.22810937975015438 -0.53723280626445746 0.78758988363899984 0.28727103431365486 0.083488601911349825 0.20307673200025431 0.42118933545979853 -0.32424373833631764 0.63005509489145806 0.71455076093485947 -0.084787195487914177;-0.15861308444617947 -1.0490318227212945 0.88536781353650307 -0.084421382194886915 -0.48426992771425265 0.16443621677613965 -0.49788134861892525 -0.50328517766333214 0.24474929450112293 0.66264832147717867 0.16049709372315119 0.047873993930742945 0.15212702704707928 -0.2857586774791086 -0.25301862605818398;0.35637017190180986 -0.43125890976530656 0.29044830793529686 -0.25413478862981159 0.30378877881953337 -0.8273594215610417 -0.34992594574947522 -0.53345701475254736 -0.58473471555652157 -0.4176776813862963 0.10961998099173653 0.07696192880697085 0.34046717654262237 -0.051467682947251223 0.63433036935783538];

% Layer 2
b2 = [1.7027698653871233;1.6373124898580529;1.1545877959663602;1.1727746112000759;0.72765655794857009;0.58201360642047317;-0.22424453672434458;0.1093728489978697;-0.2164710371400245;0.52330614866609615;-0.6970929381312776;-0.94233277335746246;1.1648975062224132;-1.4153510075640243;-1.9690632212847174];
LW2_1 = [-0.49102467060119342 0.51299452932055611 -0.38606577544141757 -0.25958264263974745 -0.77387939683872231 -0.52020147096785363 0.027134352221049214 -0.78725084417162206 0.36223337879762335 -0.32740960589700557 0.35902380501222236 -0.13294938115102986 0.1644541881363204 -0.31668679490752871 0.47490278182383805;-0.59130001355677542 -0.26204675843209169 -0.83102991861367292 -0.39327813610877477 -0.2534770544884139 -0.5084614610623277 -0.064757615863961365 -0.10316852669751866 -0.67967021421229601 -0.50243690495682858 -0.24828026127849651 -0.19252883326295764 0.082675071397867339 0.55751031472654455 0.139303665088123;-0.93921153389331025 0.016889009354268885 0.55305336129879823 -0.012190266165964338 0.30204354418421719 -0.20484757369089773 0.019057305510464417 0.56345902995493746 -0.82077156989616251 0.13507393588827887 -0.029436558651244889 -0.65843047224729467 0.42741144413250681 0.29376892421010958 -0.20999776488782787;-0.48019028112727913 0.99198290920379906 0.1221921546371359 -0.50195423359417013 0.27037178857510297 0.068598294353983985 0.047889522932048768 -0.44013638367588792 -0.86295663407527434 -0.20599994912012423 -0.31859423203034648 0.24406186801512939 0.16466027816630793 -0.81352417392546639 -0.3346155377833645;-0.65812199220481182 0.089059283962897903 -0.53288083263028097 0.10936672883402673 0.44499339796405168 0.49132652994752607 -0.56960113198089413 0.5977966299968257 0.248735638429953 0.33626149360882662 0.48128323019570357 0.46573356490645634 -0.48913158386172051 -0.3533335684636339 0.28804422788685469;-0.056263305044690418 0.53713629276438357 0.26273839674001093 0.081168421130018181 0.011292114318784154 0.62690379422221021 0.17967557881749674 0.49977107983873953 -0.50329201514314525 0.51185156089585793 -0.1014183348812423 0.78627504367256129 0.62756250933422097 -0.54077942869280404 0.37310079636487009;0.21713611353091489 -0.11135693302114699 0.31577430502369863 0.04580700941052572 -0.56342965534191891 0.085054053802620572 0.34895242581201119 -0.81733215164768946 0.41281817619440453 -0.67053126303787114 0.20567668579807241 0.71409442098570186 0.030706998789759861 0.0568746102588387 -0.55767665959357726;-0.78635866207323191 0.55646980532003687 0.12874527944008649 -0.23790307337228989 -0.39254025652352664 -0.18321714890382942 0.21235507479229582 0.017086046298987301 -0.051212751177895428 0.70871493706573507 -0.70980191729042807 0.31145611818167251 -0.64163455981103079 0.57486111467616485 -0.31187722016545483;-0.40047200857108722 -0.40719464861194571 -0.19383051818094041 -0.53859498923933757 -0.17188271640862551 -0.3140802580582554 -0.32075805527391288 -0.15465949223049247 -0.50997790032015067 0.42313485058544481 0.18786863346063185 0.099233154378214214 -0.35922085951342886 0.53366145378112939 -0.61663578016342047;1.0198621676993413 0.0673679520293166 -0.60595068558696941 0.093322588032110659 0.78730503149598352 0.095066363128622836 -0.02165094042149273 -0.62805011918275955 0.33501129836552968 -0.15572245648737898 -0.015474248668110896 -0.041037110648069419 -0.20172578110713416 -0.54582704807797155 -0.39578204497755609;-0.62078180591929566 0.26681070003112844 -0.63443655202943594 -0.6547451908604569 0.42899927719909459 0.11086685531991429 0.21754076919431445 -0.060801926761057487 -0.49970963643326077 0.6608556093261726 -0.32632122742517111 0.25151542219368767 -0.5301117485045499 -0.12575068276176862 0.50997900802703877;-0.062898458293304926 -0.48201765358866933 -0.65249813374960075 -0.20895088995848052 0.3486515414533311 0.67456529527225118 0.36412687562746454 -0.086661196320046874 -1.5462092724174941 0.14542690910087927 -0.78061897747870046 -0.44609155294109198 0.17575005861437495 -1.0863910574949627 0.40890911072942238;0.2091081339216056 -0.10364633219718705 -1.0035131609345673 0.36805882352927621 0.14208129153791071 -0.73739224507204593 0.1728592734516243 -0.42971376417983165 0.5353845462170711 -0.52189053419242215 0.65157638001897311 0.12834097940780123 0.064115714069596069 0.44837805537094705 -0.217255412247018;-0.084303489697686473 0.081630259970939936 -0.02767284628571837 -0.21782822242688826 -0.85976617688980039 -0.48321680250074467 -0.083195030007870319 0.67321518636603928 0.059293082894065714 -0.30082501293447605 0.15062665542127698 0.75374560838003535 0.73810673410502958 -0.38678785934419729 0.092712840089091877;-0.048449530941574163 0.40520540324101012 -0.062239462025134543 -0.76808008891326351 -0.59276812259946965 0.36713159166424675 -0.015528899654525958 0.64029556273070887 0.00053455624958398135 0.26252404814474112 -0.14581995569825087 -0.24950839279025783 0.39127301089588035 -0.84500239195317606 -0.093245779967793707];

% Layer 3
b3 = -0.51921266583616432;
LW3_2 = [0.74859401111041002 -0.65430830401100271 0.85149436131303347 -1.3016394606038004 -0.52936139538735805 -1.1253382518986557 0.087424198504966716 0.24558250133920562 -0.29005012165008437 0.7838912695281457 -0.34272832992450508 1.6478698864858257 -0.91704221246169704 0.03699058017101578 -0.58862911825746422];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
