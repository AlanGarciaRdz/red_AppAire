function [Y,Xf,Af] = PM10Atemajac23(X,~,~)
%PM10ATEMAJAC23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:00.
% 
% [Y] = PM10Atemajac23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00968992248062015;166.666666666667;0.0561797752808989;0.00614628149969269];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.2007896420458875;-2.7256055242976154;1.0575628790298937;0.20254709183263342;0.29112615489721749;0.26546777386210502;-0.65965509360015928;0.43611346989792288;-0.45861269641336222;1.4246781264436448];
IW1_1 = [-0.2297636521584944 0.03816222843339289 3.6078553932988604 -0.54833538521141545 -0.84872439270475997 -0.20216762632769644;0.99822347158173974 1.0998645288178983 0.21457952286557797 -0.040873188295670548 1.5353415907346537 -0.2520336258546762;1.4987263317431905 0.90785264115678288 -1.3169523840199662 -1.7649480653712313 0.036566378443203915 -1.5507022585330958;-0.73876239714362457 3.044773761026641 0.83912242514636504 -0.16450455634974795 -0.40178511795759875 0.21217030843377677;2.0857110022272773 0.75874666515432787 1.4292513309763737 -0.83518495674597093 -0.69166861783448974 -0.52033030669894531;-3.1349562074857902 -3.5674218556998403 0.67035416444908247 -0.65689617261095223 -5.0173524239726657 0.78863241364560432;-1.0604873225014184 0.10024259904906992 1.5394249339769008 1.0816721604546646 -0.37334347775849847 0.84337301724594538;0.12032595974163202 -0.014645650519765397 0.34045946467504307 0.68347023445717259 1.0308541438183754 0.23542699372104836;-0.71019094616686163 2.8173426620902409 0.07811099338623842 -0.091733369594800579 -0.23978717025614815 0.19300269471028714;0.059627402089008068 2.4676766551550524 -0.67320266775083348 0.13833303682475276 0.59393997253537745 0.074449184682015071];

% Layer 2
b2 = [-0.97379177244456583;-3.8276747033154455;1.4052975992343957;2.6230959185158125;-1.0897898713537411;2.3854864156391407;0.077559973217336958;-0.46428040016627409;1.431325401445168;3.3902429548824484];
LW2_1 = [0.24700864842839412 -0.067989069495351037 -2.7466983312276119 -2.3752433743623418 1.7367217978508762 -0.66649584249107519 -1.6467511495492289 1.3611653429589925 2.0155861716820977 -0.94649296134395322;4.0724885833944597 3.9906019116812055 -0.24176658764408707 -1.6708233948233346 -0.16033009187581973 -0.37078435148342026 1.9842453529249433 -2.6933339767064832 0.55774023703684439 3.6384502869309143;-0.77449538745658497 -0.81314082823246625 0.73984278469456899 0.71474670318493383 0.59381963534330795 0.0036847347249918463 1.1100110706699791 -2.399437306599387 -0.6989959821330185 -0.62280207905434548;0.77303069713072325 4.6260102824963187 0.25687789263994187 1.0938092390520062 -1.3536742793658232 -0.43117743427023514 0.13116588985828814 0.89064143766299153 -0.31582684018074353 -0.77399583734307309;0.48383092591774102 -0.62968885444526113 1.4237800239199265 -0.22967003790018303 0.17457173216805968 -0.4805748604832627 1.2375339991184242 0.068697151244945409 0.9687597829333543 0.0044459448174680762;-1.1019347113549409 -0.94062775940383558 -0.82609081696861775 -1.1470209589606106 0.57201272717980289 0.79273629627925868 -1.2694955117359741 -0.28294543570020292 0.39125139823238209 -3.7975978436035587;0.026052071654107424 -0.32660411978918841 0.39020189839338465 -1.1658773972223908 0.088012773203792485 -0.56177507792105463 1.1387004543822106 -0.44705074424336239 1.7781876224743254 -0.50598388397690552;-0.59407485414774286 -3.5083344349009487 1.5596914038568719 -1.9206802593951822 1.3836034975543621 0.56950209620453573 2.2349402020201175 -0.75409063739185056 0.76274207201048483 0.56705849601410596;1.2792326811963899 -0.62403320076315716 0.16505634453153969 1.5059283822102771 0.15785918095380433 0.091491028445632408 0.55651139135612981 1.4118079799166585 -1.6052302754995798 0.14984383036425158;-0.77165039685530201 0.31324794935361067 1.2237591750386323 -0.052714971000232945 0.44457678548642332 -0.047107306457831642 2.3907967054311703 -2.4963241815319508 0.048866825150934892 -0.79204518481772024];

% Layer 3
b3 = 0.36681703949634559;
LW3_2 = [0.29666259658706251 2.4756128961437804 1.2346977506874823 0.91418575123427015 -0.62666144117611977 -0.20365445163747417 0.53992825909258102 0.67150828910041582 1.9826617891223246 -1.1363896005397058];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00968992248062015;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
