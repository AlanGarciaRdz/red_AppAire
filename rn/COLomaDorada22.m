function [Y,Xf,Af] = COLomaDorada22(X,~,~)
%COLOMADORADA22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:41.
% 
% [Y] = COLomaDorada22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;17.6991150442478;0.00572573718866304;0.0175284837861525;0.0546448087431694];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.5728670227499664;-0.78337340414775281;-3.5959506459711221;-1.6100667299681506;-0.94194760045740966;0.99262010064304951;2.8796148096094458;-0.009537964558083329;0.62533311676360315;0.44966843709817211;3.4534300732687151;0.4208787479688445;0.17301861130924376;-7.8568156978521948;-0.64608460596740125];
IW1_1 = [3.0471223416894642 0.77230599349675977 -0.64170136972467728 -0.42902797068259335 -1.38042854688658 0.096903194585276742 -0.75071572099395734;0.049834881988049147 1.7459579487010481 -0.29820464072732467 0.85240030035422332 0.46504071756489312 -0.11867278152419625 -1.6690050089777686;0.18783258283585352 1.4961880056065475 -0.44339961113183907 -2.9602395342645313 0.0039950252069111264 -0.74034190573763003 -0.014481081031795042;-0.052159563711890088 -2.8486681850032274 -0.096543380421467095 -1.4923169879381892 0.016894474420716614 -0.40574673572644354 -0.085074753003302403;-0.98318767471517898 0.24992512435121716 -0.12060371410337044 -1.1594526323924663 -1.3844500096699719 1.6795647675998142 1.119210054694874;-0.38416761486847051 -2.9765477087415313 0.40752518986848862 0.080552269664753623 0.37428816009624544 0.2127601893466789 -0.20912423150754614;-2.0454604930829432 1.6402170795670568 0.46917561904724053 0.667534050710753 0.096586808925088669 0.044739264007525814 0.89647974426258858;-1.8077223657310053 0.77085016520590499 0.031363786121444186 2.1926246261750921 0.55653597607043481 -0.25173790531522755 0.19208351098185758;1.1177521733788331 0.60280531398362247 0.40306433788005769 -0.5600663035239799 0.033029657504684631 -2.1626065032220239 0.62833704714231786;-1.1744678742253949 -0.88070276004689008 0.13418277673209847 0.042280653116343353 -0.36550931648216101 -0.011508872516205059 0.7402040480684503;3.4633361975592258 -0.49756843000868028 0.92898648811840501 -1.9367444554272 -0.60930563075156108 1.8706296891232912 3.8744223338990209;0.18643901799892712 0.85018108408605064 0.11384247170119204 -0.077785496617886085 -0.030710648567410279 -1.6959785706136601 -0.30669905800063418;0.65526211330473583 -1.6269497776513369 0.54656274660114168 0.72778199842968561 -0.020455315704016392 -1.2840698712645695 -0.50666329939491295;-11.513138621984906 0.30256179554968315 -0.0058857589792492698 0.25135418394662828 0.43303021393514413 -0.8079750651330937 -0.50691137292891086;-0.70754989863285211 0.47316458296379604 0.69789187180684675 0.39166292683023357 0.84783131515178756 2.1932373845609843 1.0263758011588058];

% Layer 2
b2 = [-0.44938363655965352;0.54420536707773981;-0.39722881314699665;-0.44170807129538681;-0.83692376763839993;3.1234266093102216;0.42396469470050707;-0.61783811142763501;1.5947842155124456;1.6154771691953398;2.8425109575015481;-0.26838977398466385;-0.13773565480337069;0.40349904313229773;-1.1299922227799655];
LW2_1 = [0.38570067445507183 -0.48415049346855016 0.17181757397848588 0.38970162723667223 -0.1714278335603176 0.13820111367964386 -0.46763343299217464 -0.23075432669274787 -0.4127732906227678 -0.41355291210361789 -0.2646451975302509 1.1073754489133105 -0.51049211977941522 -0.28220418295307664 0.32673221461771723;1.218326252510592 0.60215186415286859 -1.6679068715334044 -1.0098813861773122 -1.5183398965245729 -1.7124851746400931 1.5092557873646308 -2.04225217872008 -1.8319724429043327 1.5401454701849566 0.21683589817065094 2.0198501011708698 0.089418230542141361 -1.9351382677570765 0.36172666912379808;0.48427120961335995 -0.31098054521976587 0.33220823730254623 0.31794077132844739 0.22289113061278157 -0.022441704605647893 0.42004573049676663 0.62173954003628573 -0.064043192302517593 0.10922003835422313 -0.094487644365791143 1.1886672793797795 0.84547107400217847 -0.011957759577811223 1.0052502453032863;0.31973191545540786 0.13782761780879124 0.508634706373847 -1.0107217140764122 -0.18086507221158685 0.82212539624989145 0.70462873425002071 -0.072035122882219971 -0.2301242063216305 -0.67350234900862782 0.13367864582315855 1.3251881245020301 -1.0489147904660339 -0.064158760452442579 0.6933531387053361;0.73973986826325211 0.38307335907499646 0.27141620580432624 -0.21234293339975652 0.047650539219154901 0.27702723199488866 0.026637168803491575 0.18290284693364167 0.016149676376533303 1.3965936317827092 0.31485475838020466 1.4349244403424877 0.81060006641135185 0.021265167137768139 0.89877423871052697;-0.27726165449038465 0.39764020781246912 0.045145540122803932 -0.29110322488738466 0.80591691866350201 1.4314451493816807 1.8295166414243089 0.079148196321419673 -2.4391239146136168 0.6234997018477505 -0.69392854219670919 0.59098204805440258 0.97712345034738168 -0.61693450370192826 -0.12769432059899219;-0.27005949755987657 -0.056193888559607177 -0.56836799467501731 1.0968510506821316 0.017357354613683727 -0.66142265871804995 -0.94530412981019118 -0.10700794070146744 0.29474623147838008 1.0735579565041127 -0.092274473448512084 -1.233761708734435 0.71966008474540755 0.18141255464533659 -0.8968719713993708;-0.033407565570588438 0.76495423926631578 -0.13003166228510024 -0.50432779223786794 -0.54370835645215676 -0.46894301180718961 -0.74925032192146801 -0.12242838845588465 0.56378121503055523 1.011393692032591 0.40744525110989388 -0.34993765285650358 -0.21626551001752084 0.34739997617558288 0.10535089925691016;-0.71136067742407272 -0.70339055506052317 0.017361236311338138 0.35664800324135892 0.28146276860806924 -0.1095022965928284 0.53645991311261443 0.32871606563466615 -0.28315789181129586 -2.08924475108708 -0.95925310645039064 -1.2691905299971513 -0.22139921632769755 -0.51082013432241902 -0.37234078158976869;-0.52561337509701822 -1.6352333832777826 1.0559835293660667 1.5857045295669034 -0.13478177021321464 -1.270330116603924 -0.1504907410654418 1.0971254105062569 -0.57788493908741712 -2.4391926668686978 -0.4728860612389042 0.51254684181880716 1.1524223203052189 0.65397466647859537 0.70139299498447039;0.21965300318754996 1.6346441473201538 0.64613170744579496 -0.50463949746885173 -0.30792635376070132 0.23693739669991171 -1.2042230114955219 -0.25268759866016971 -0.14214915387669164 0.14799655606100695 0.26946370151017479 1.2127368540009107 -1.0529281828769301 0.066652553674114198 0.59627249380631719;-0.6719455438905495 0.29706197336170898 -0.090475069868599781 -0.3213984235999815 -0.53772313871814792 -0.33083598364470412 -0.81243229227578662 0.11806442276825586 -0.33298804289351086 -0.043277393682688917 -0.14998774330910336 0.059969868701259012 -0.26444371887280543 0.21445597547896655 -0.37665953765140031;-1.2861411495896884 -1.9847927885737213 0.973561957297428 -0.40405124897443501 -0.0036620890479730842 -0.46613125920937265 -1.4431258429401743 0.12166173540139487 -2.3410339157685813 -3.2188913993775969 -1.0303013654000495 0.37028321556419386 0.94694321756816635 0.087432600179777789 -1.8759729636415958;-1.2721274860495893 -1.0069282863295055 -0.028747065832151582 -0.56903777599901917 0.084903865906343218 -0.87080367643415391 -1.5680742642121714 0.7578119352187952 -1.3389559230988777 -2.0960016982449874 -0.31366659526157847 -0.23399171096295465 0.58962368637475293 0.15151017757256907 -1.1620791208489878;-1.0157829335226738 0.039581682506735515 1.1840886180663548 0.64527718479527718 1.375656743459498 2.1007104070860096 -1.3117007454312819 1.4703844601042968 1.9708761045214398 -1.0377779518854084 -0.21559553340868834 -1.6427083378781788 -0.4323965340027715 1.8331373142548686 -0.46206472756337269];

% Layer 3
b3 = -1.1131292777053745;
LW3_2 = [1.4279530272554875 1.9447281355174995 -4.0350815457119538 2.7761927360144587 3.6391603009275393 1.1674136278236531 2.1393292669663961 2.201182612194637 1.5572171570587381 1.2216855703784435 -1.0683998438307887 -2.0119360100377599 -1.0550193924199904 1.3218371353415861 2.1930996684560404];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
