function [Y,Xf,Af] = O3tlaquepaque6(X,~,~)
%O3TLAQUEPAQUE6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:51.
% 
% [Y] = O3tlaquepaque6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.171659085057077;3.03490136570561;14.7058823529412;15.3846153846154;10.752688172043;10.4712041884817;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-0.29387439477513017;-0.79273442732157817;0.89853819302876925;-1.0192669515703503;-0.9821743535717542;0.33641309960113464;1.6415698826368088;-0.38145660123580655;5.4104673931664582;3.8219730543421098;-0.18511260903064863;-2.0580161202408362;-2.3131588498579543;6.1702237464131722];
  IW1_1 = [1.3426057682451227 1.4673773165227353 -1.2000809978189502 0.74506862356290438 -2.2234331253176745 -2.3266220153401007 -0.17129019681798829 2.7512372639263649 1.2094532111451404 0.17400562892552582 1.1514424687706524 -3.4441514077987474 3.522474253842717;0.090839712999862585 -0.8292233752781335 -0.014260981697643487 0.16669387725644974 -0.068942608734942096 -0.14951499281321914 -0.20043805635824136 0.59159602220532226 -0.10664502599797308 0.42609201211841219 -0.53776020238226385 0.10439085431401948 -0.38364285629847683;-0.21712411583807398 0.82350410563882626 -0.27266486732125389 -0.11211929030569641 0.052400243934679569 0.11409608701767579 0.28502265873185989 0.0076704015122510301 0.45902291967110992 -0.052812989057033091 -0.33809852318217459 0.041204082387424554 -0.76471902698592087;-0.94334684718440465 0.44338838702648292 -0.020686924322072919 0.5121172545866135 -0.25944424992667997 -0.56287069117661537 -0.56714891125411193 0.091734322908709059 -0.83211751554313407 -0.022722580234638676 -0.58739440288935318 -0.45340074215943582 1.5830461330543451;0.067015555281286623 6.2171364924887556 4.4524340666280811 -4.5889611119546947 -1.4760125981671977 -0.74476860995446137 0.23809838988644358 0.74918150718626153 -0.40062171551063641 -4.3028326750896699 -0.86145501670939839 -0.33950582559260856 2.7913975439422027;3.6262956371358919 -0.077882800929203175 -1.10679672866776 0.18519695619436333 0.37596269632875501 -0.35394170473447689 0.046674569736017191 -0.2724207811827738 -0.43450617961763993 0.62663180339094326 -0.22013555270631088 -0.094241520506897311 -0.55083595100233196;2.9478331863189493 -0.59894322245643727 0.84108494602027373 -0.057449544382359788 -0.09310489399874293 -0.22578064042775314 -0.6838226510052402 0.043446206266922915 -0.72467705135571148 0.99611676375974545 0.10615479108533535 0.047663291520410954 0.056781104028509805;1.3988690809181805 0.34710487629192172 -0.41882364495520363 -0.37869373392884709 0.12217629486794504 0.27772593154444308 0.58210829239869533 -0.012843162699315456 0.92623499706365442 -0.51658668748132297 -0.052861542883346352 0.18024574367855423 -1.0404567130604687;0.8768857989282306 0.15503012084564408 0.86276536894002576 2.7449459653502815 -0.12498182582052819 -0.3676677789675063 -0.064928823311825229 0.38735172832045811 -0.11453662098492304 0.71977888230240405 0.32863128665969182 -0.23980482082617358 0.99929924399770897;-0.1916632451506759 1.162789168606186 -0.83434597968798041 1.0213212165154519 0.079495802218826642 -0.12834013640048061 0.24453993238162999 0.42984906563082287 -0.85908443964990433 2.9450022464458665 -1.8309464472737136 -0.38834427991097448 -0.33077656759498125;2.4378732677729995 -0.033609216713377355 -0.24668174383399336 0.30812124940631791 0.086468802339335266 -0.16537115436075428 -0.32163973597932738 -0.10793002263980769 -0.35183075700255573 -0.15259297553169399 -0.081391835852981431 -0.082198664293697377 -0.08655340588202802;-1.0800904481840641 -0.41986235646948455 0.31938370170762898 -0.25974514939462778 -0.055574516710103931 0.053124674455953882 -0.10366440799573132 0.057803988707595927 0.4359367715916877 -0.67459927439214085 0.77314591726320014 0.13213479337056208 0.38566290850189527;0.33948173257783348 -1.8093529311782168 2.6276442464386229 -2.2264770618920813 0.30296906885607799 0.10844871367439556 -0.19881661082368285 -0.41424097006739452 -0.85243998353138939 -0.35577762158814896 0.13314301817320578 -0.25390325797456631 1.1197277000556376;-0.08507718644790499 0.69191262695130151 0.72523603942575443 -0.6418981723190178 -0.41758137405395035 1.178882979061729 0.60850677310399004 -0.034060398196058557 0.10073736096359484 0.24586824485602732 0.39054846474284677 0.054563236486325883 2.9380813160572217];
  
  % Layer 2
  b2 = [-3.4907388364526133;1.1760364623378101;2.2450432492864096;-2.5220343043251017;-0.075041675261963064;0.35327225784171973;-1.4382375928750777;-0.98502134086144311;-0.69334511239341889;1.0852264639810016;0.0912187566945388;0.0034963517054567156;0.81627072375478993;-1.1254078411763326];
  LW2_1 = [-0.043869346631135529 -0.5947968779077375 2.0094162990838198 0.92003382871807116 0.12430242751853157 0.87274799429627092 -1.8913015341397281 1.5742185091931606 0.050262318545534597 0.46023544182869042 1.3373382966102063 1.0178521690349345 1.1172215446890224 2.073972889243084;-0.23277999999260285 2.4646313326247005 0.092480205137913898 -0.26958708406587251 1.0254782636882454 -2.2423479865806173 2.6227397235040684 -0.75740440518704177 -1.1298015135189536 -0.55181133047382425 0.3120764721380101 -1.52466304504362 -0.60467376812378382 -0.50790665995715623;-1.3275489142399972 -0.0028917238058748032 -0.47078935736762761 -1.4087843011942158 1.7961010181648545 -0.71077006529734388 -1.501611426913791 1.7922390320380956 0.0088741886733461339 -1.3099749507618383 0.30815850819905649 -0.31565713817929392 0.46389876789574402 0.89979898774925249;-0.042724792508854761 -0.59015494331724205 -0.87606028000973268 0.13783258326952713 0.17759711953682883 2.0947277368147059 0.24109838980748111 1.6141795280773439 0.019014917335254074 0.2560390743693523 1.4864522353363245 1.5006171833242352 0.85669898455448501 -0.41520714023877353;0.0059056991911439673 0.94570059524390249 -1.0950675690135656 0.3068338203225951 -0.15049422239973573 0.1451840066833025 1.4955792174514764 -0.27058397878286011 -0.31027604174078782 -0.25906037054973391 -0.95402020419385014 -0.52938284955485615 -0.69170030542816052 -0.3214642910853952;0.023720166497238484 0.02012014736603333 0.5808360533279332 0.074055099030563523 -0.031039313576148267 0.012172169506420805 0.17027428659042404 -0.038328899647542998 -0.020137394123286443 0.15678391855836699 -0.87680271671876109 0.54255485281989446 -0.083130719454326332 -0.46224100719053995;-0.14943655378194512 -0.74765475127538839 0.3358353027281904 0.28058861217975894 -0.3002655277054998 -0.60688410821884986 0.53621188821692845 0.55430174390886988 0.29078165882874396 0.35597851923373131 0.63393395514156359 -0.034398431962495903 0.67800601776633673 0.14465237534301378;-0.00030291237521005727 1.1724928746455494 0.55301870492527516 -0.86370102717586161 -0.087130943726842131 -1.2697020007370965 -0.22097384555161531 -1.0441124459723172 0.013253716303510681 -0.31998721056760066 1.267602756465027 -1.1285030396463023 -0.28759669851937414 0.92461836260675978;-0.23300840121670585 1.3585065198806583 0.35876347265458763 -0.26975126989278519 -0.49218878607981198 -1.7113047756936015 0.36033204101166461 1.0546309509765421 1.6221168680552469 -0.1690426956515258 0.75266733808316122 -0.86953161596231721 -0.27682476987110627 1.1903103817818788;0.067128279429511051 -2.9528614299742442 -2.3063099608508755 -0.31135017288369465 -0.088045475277710367 0.63080372634100912 0.6430630939156704 0.0024778013634751406 -1.3090082030618524 0.58880412966067242 -3.8202805851898849 -0.75247454685594339 -1.6726233169178593 -1.4299339284852821;-0.12027999020722704 1.6245835594167417 0.004997513976095172 -0.054360140922365054 -0.52017338727236884 0.46477802877161639 0.69732423110755126 -1.0231838334422292 -0.63321179224745017 -0.067478560823834993 0.20821277262050544 -0.14253747140163819 -0.27019245024338695 -0.47649734994749937;-0.25594427237272194 0.76579760339104741 0.76388649440382372 0.01184424701216593 -0.5216476521858886 -1.0816133244125146 -0.32887631315007476 0.99291711267563598 1.6229875088865047 0.26779245082501679 -0.054639824137053858 0.44811977008256287 0.60946246703364948 0.49038539025290512;-0.039682615160847604 -0.15146709442232803 0.3779979207699638 0.54280242206054985 0.033647880018028292 -0.142021235900473 1.9167056496799191 0.46090712057710348 -0.027847545185558188 0.27145431129704228 -1.7739645759067233 0.96358051410400591 0.68373503838530547 -0.77798634980201486;0.078350735403650548 0.30025107383416266 -0.0045620954200180207 -0.80831917160896993 0.62836819257535337 -0.31900709784909403 -0.73667502468154689 1.3578418223457025 -0.10026082948078019 -0.07089244925970925 2.081019289489467 0.42098925008996818 1.4203892852847206 0.1200326975330062];
  
  % Layer 3
  b3 = -0.96355717939978969;
  LW3_2 = [0.96557555523967276 -0.26255849622338945 -0.31897310059872053 3.1890106242616931 -3.3921953555402382 -4.5990168828939453 -3.9274760525747734 2.2200756430036215 -0.88526752295715827 0.69983477949077111 1.158507274345606 0.86414863731630309 3.5827473089159665 -2.0066898316378814];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
