function [Y,Xf,Af] = PM10Centro21(X,~,~)
%PM10CENTRO21 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:06.
% 
% [Y] = PM10Centro21(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.281968137600451;3.74531835205992;0.00773694390715667;45.4545454545455;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [11.729794183560196;-0.41993160617784442;0.14377478590361245;8.1999735232123552;-0.19388283094989478;-2.1751187428002186;-6.6645971803047299;1.4720654836083473;1.6977301207633582;-0.4069896961634345;0.42341185039266549;-4.4189623196788679;-0.44950526807492547;0.16063406708182307;-1.5314152927936913];
IW1_1 = [-3.7476042538312329 3.3481975330159739 3.0365525114355156 5.2603627906394328 2.2490373525517744 -3.1046110764610675 -4.2412831615796129;1.2357662411476009 -0.21793498773405004 1.1157300051986581 -5.1710600734555001 3.6851364413602972 -0.65794408771073298 -0.70994023445323828;0.092944173042196723 0.79348887753471331 -0.091722161875188751 0.92764385877806699 -0.33866590493601967 0.19627776573086791 -0.13820014941120204;1.9953162491378955 -0.68170877949762543 0.98010193806150725 2.2299376007434293 0.51594439126192504 9.8671224256100398 -1.445165132822956;-0.90366102095941891 -0.3257197045544189 0.50183773155051148 0.1176534646592733 -1.2283345168138442 -2.6912582505061282 1.470878780403241;0.36278771647480024 -1.1263097159504896 -0.70572476274109297 0.05109365931863042 -1.4073920624569733 0.058537462012406567 -0.090102023366144632;-1.5516149987035086 -1.0463628219880894 -0.6598037974703882 1.9155630916754247 1.4191464507198099 -8.0326714703893014 1.4504572277911862;-0.020558989410336074 0.050329562076738908 0.15061037257550453 -1.7893003583437612 2.0176167138484282 0.67520932065409001 0.20813759858951683;0.10364908730457287 2.3425709360760707 0.24644811643787354 0.31737983984341994 0.031608113772395752 0.24148794293922893 -0.90571595699574903;0.98266303114089126 0.35850816008540654 -0.12452031878655902 0.93169766915783525 0.31671251733716133 -0.69116869694343352 -0.62487096566760936;0.035205081387743073 -0.73144570854209701 -0.5017910796321281 -0.22648367613753953 -0.27095536737877712 1.4765731953016499 0.19573265052193831;-1.2181695585410577 1.2754738698851091 -0.31414836938388507 -1.913529299675073 -1.1266181965896698 -4.3193452080885502 -3.2246709079008813;-0.22553817834005618 -1.0929443966205981 0.10701128289535095 -0.10873994312448748 -0.07705773238600018 0.049961950707875756 0.48378554412570896;1.1013797377868491 0.65001188851146907 -0.31958760186612267 0.19189067672960031 -0.22742827423405351 0.70050347900270982 -0.072027579723364155;8.3757800828605493 -0.82615863600680517 2.1760580811131249 2.5235740581715183 -3.7338371976635969 -2.1096652784528427 -2.888270329656772];

% Layer 2
b2 = [-6.5003561295366907;-4.5947565819091087;-9.9126196950213252;-6.4546990064784699;4.4154844696498889;3.0562714647575229;6.0816447431622693;3.1395803991878481;2.2899698852579213;6.0225278519406498;-0.71413369014104799;5.0348938108111856;-0.96167201611618169;-8.181893766655568;-5.9074993506781022];
LW2_1 = [-0.34899167118362795 -6.2891989694464634 -11.588936105228465 0.58756115781596685 6.362211636719258 1.2023926890300338 -0.11054886734157907 4.913097191552982 -9.0597587952138401 8.718003335822365 -5.8713553902020665 -8.6233865401800678 -12.73797407541119 0.8169590336678404 -9.008549546641957;-0.60080855541378486 -10.737257939558026 2.7095774110165025 2.2556894390083686 7.9185190789552156 9.3112408756352281 -2.9239441763555978 8.4208481197606044 3.0089956372738245 10.702773729932918 -5.173311312570986 -13.933110083004923 1.6663082182646001 16.516245864232573 4.3880238125017437;10.622022532061486 -3.4042894447819267 -9.2110817589997769 3.3860422044355052 2.285342010641616 0.86263762529585208 -0.81465943439188726 5.0742928794069204 -8.6442414543501016 0.98962986447505052 -6.0603969487535885 -4.0953296605407878 -5.1034274209092816 9.9118296726755926 -3.668223184838471;9.6671934052706625 -1.579353012058502 0.36646945564361127 0.73631810142441834 -1.0741383642135622 -9.5827565677163591 -9.3849761782760091 -9.4369605022477554 2.0059452777629381 0.55116534752992219 0.38519970608197074 -1.8923199016856831 13.022127819833138 -5.1997392087362089 5.2886681455983657;-2.8815939647559117 -0.022755115701769434 5.3558492638621775 4.1358534451937956 0.88005694347340602 -1.4674910691337806 -3.2772151230124025 -0.68565454537057335 -4.6446029091507857 -4.2599040326080777 -2.6372293244047196 2.3450950409194937 -3.6287103062014046 -3.0556037757052041 3.8993905546980305;-3.7772329466402872 4.9158909738391454 -2.7528524214756263 -14.343944462996053 -0.6201808276686972 -5.0342115354023251 -4.7511018927616497 3.8006424372678058 1.3010942021092118 -10.069752995529068 4.3210479415529148 0.35355121549159141 -12.652637716782912 -4.9193766901623315 2.3947946798891753;4.5903199964524148 -3.249039551585323 -3.3532456073651877 -1.850314901461706 9.3510182320145994 2.0810787104032786 3.8810456767482298 3.3788582434217891 1.2605413094598032 -0.12196779400049126 -9.0041803918774992 -5.3229473636531068 -4.8138282816518423 -9.4317549650868102 8.0801196784987415;6.8989945973483353 -0.30377720880010639 9.5264986833316811 -0.48673255234583318 -4.6876891304663575 4.4438996164628248 -4.6401209364226119 3.01431471700502 6.1299213530329961 -3.9540264210988609 -7.2407377182861774 -3.0164185956313774 17.343860538870466 1.8372510895749532 0.3616822143586344;9.6647172011646827 -5.9222660520856421 4.5766041725972118 -1.7004608247842827 -4.2119102726238502 -13.242676736372717 2.4471696003583423 1.6929344753847213 -14.868917089264661 1.0549373704079901 9.4046018372474762 0.91852188341143937 -3.8406746325454604 -9.220357197031829 6.5308216760948063;-10.5764248502517 5.1036016365338801 0.55214924614297511 -0.07324463118556189 -2.3142838687040839 -3.9871718973146684 2.0303849686477187 -2.5276855707530546 2.8427420544359268 12.994747983519925 15.976592330550657 -0.50103866921601281 -9.4258435801121543 -13.953715641689515 2.0190594875606673;-8.516699543559838 1.9177226173248867 -9.4026705996625068 13.742832097730952 10.936575590567786 -9.5036166484034883 -4.5937736232649584 5.3323737402654308 -11.484321922720898 -2.3226371374768022 5.2816621813758919 0.079454205611398945 4.3078621134709563 -5.6631806070115438 -5.8801359706251857;-0.43055448587769241 8.9872622114400613 4.3824250774920781 -6.2199211631037494 -4.5884850844990375 -6.1059399502156406 -5.1074446004972121 4.0138900080118818 -2.3150039003417446 1.9209388829872691 -9.2494138047843961 -6.0669560520203332 4.8676949955416182 -19.122823886406689 5.9537894833152247;-8.9803846048594611 1.5077387074087087 3.0342166161365087 -4.7838940620492352 12.872287705147462 0.39439517958815218 -7.5753888750690495 9.9764105990503538 -0.035811587193713218 12.23727349488489 6.0398603363951251 -2.7585768340457748 -1.2409909676191471 -2.3658694432327798 5.7909543793525176;6.0372308860487172 -4.7140917126429107 -12.854166852805934 0.7636048170136186 1.5269431022696494 4.1896008842293258 9.9188205435562899 1.1075556235657944 -1.4125790879680038 -5.1221857623262457 -4.5023738880076811 1.0453646909439418 -0.83478737674276404 8.3990580193399591 4.7261571618432727;4.9535131299423956 2.2651197446827345 -0.3094750487465614 -4.7074449153905533 -1.2006602773123729 17.157827968888217 -2.2905494699799087 -4.9706171644746702 9.4361682887013973 -8.3996994346316693 -1.1217518706104037 -8.4002254053316943 10.67061738686213 -1.6038525894504401 -1.7980679341620036];

% Layer 3
b3 = -0.66787028155316697;
LW3_2 = [0.045866246902551991 0.039206499705957909 0.033514581668780491 -0.05591920071050608 0.093025828003489783 -0.025130881317185837 -0.082799881324663357 -0.11366970259643713 0.0202693088514053 -0.039871968779745977 0.025762859298046063 -0.026027805876862417 0.086426926705528706 -0.044985590288204071 0.022277073938439793];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
