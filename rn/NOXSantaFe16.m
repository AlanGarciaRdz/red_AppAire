function [Y,Xf,Af] = NOXSantaFe16(X,~,~)
%NOXSANTAFE16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:51.
% 
% [Y] = NOXSantaFe16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.9361084094566809;-2.5864744577378733;6.4255848223743515;3.7898647881461334;-0.8680446366675294;9.2661173285254748;7.8940776293768904;-0.31032893681997331;-1.8475070972181034;3.9735276318293304];
IW1_1 = [4.6268231891851821 -1.4098371825867966 -0.54298087339500112 1.2509010541616974 0.48658910359243235 -0.24936234232599286 -0.10572961155205743 -0.24449087851211743 0.34163310039908495 -0.14608103940403958 -0.14971479989572772 -0.39921294230787774;0.38584498046731447 5.6021029786557959 0.5671782072918069 -0.23323206031948496 0.18666290923574735 -0.074074474196078724 -0.22146167864743735 -0.32618540952901182 0.020174106246053911 0.37288088565085609 -0.43134259650447726 -0.46299690581251718;-0.31174015249257725 0.47980076182577541 4.6450569082536735 -2.3899880173784576 -1.1560890718321277 -0.43550479611545889 0.31898631130804517 0.59642897918634519 -0.56087455070407743 4.570410290875774 0.092656352204692885 0.74800335476164748;-4.5722657351606539 0.02689513928304739 1.4530929115127953 -2.2044350342381214 -0.21043769415381189 0.055357794485876265 -0.021036126049919356 0.32228752176766451 -0.20692482016072022 0.35099006914732217 -0.030345043721886258 0.58324806790704908;0.46344466191768396 5.8173514196642495 -0.58086651995618954 1.8170440846957276 0.35242614534204308 0.19671777270144949 -0.011453718311522476 -0.26718160286372183 -0.23683117232961221 0.58451178905751522 -0.34595388898102925 -0.057126870783732492;0.65134542425444186 2.5684688117019632 0.44473373307836428 0.026839589312116802 0.062526529300564015 -0.18868770931592818 -0.19140949079642972 -0.20962578255974074 -0.39249540140374328 9.7488770084377503 -0.77498450251125595 -0.06358089408722449;1.01980871383455 -0.64274358729932635 -0.29606146121631804 0.63923944920100406 0.31117109854556013 -0.23806692569542565 -0.36945191177134612 -0.10246251286656262 0.46030715482647727 6.0311241744654591 -0.22888318581142042 0.34336371212214195;0.43836837888383007 -5.418678691308032 -0.094725523326738087 -0.28802852596875117 0.7172333267943829 0.83029098067024143 -0.23228133664409598 0.84284963338351859 0.067056012877100155 0.65000122329811683 -0.39486906383599879 0.14913306661623169;-1.8161663742081433 0.41997791508422616 -1.1722343413813707 0.26282397820647108 0.11214210960373319 0.42946388052045847 0.14200414007650669 0.41970578227921823 -0.29684315392336441 0.19993220057895342 0.32679384230387243 -0.22072924535416497;3.2942143040528991 -2.4672765023982204 2.5777742777975758 -0.46064682030991061 -0.80112021078024809 -0.7206368804420642 -0.28114542613477145 0.19020235966309146 0.31403068674321011 -0.91437641655264335 -1.1285476535218522 1.3524721003635214];

% Layer 2
b2 = [-2.3665402481046804;-2.7361789419195741;0.9242129052161151;0.96284330135643237;-0.81878387596261981;-1.930076137371276;0.53503549046110921;-0.083331503628642667;-0.74823017488043508;2.4907683135064014];
LW2_1 = [-0.41961815152216897 0.42668232323122479 -0.41550201210680471 -2.0633333044099471 -0.85014383211883948 -0.40857091005971885 -0.18833151290529748 -0.22920666782244972 -0.93395397584352036 -0.49584558837039816;-0.059350408796437937 1.0373304020013041 -0.079755930042183176 -0.033409438805042629 0.58060719802097183 2.9957949194789233 -0.81407468853358944 0.12855791805088471 0.093354730324325841 0.010322016943860597;-0.31995301601432369 1.7579201973250373 -0.01195253897553109 0.013329983934290204 -0.57163616020633501 -0.081328639075363113 -0.80793473507126967 0.42135706643472909 1.6070675661031297 0.74152378835887722;1.7947519039049173 -1.5403298117974209 0.07772988572134204 0.018858423531196489 -0.29450892802120887 0.56260977597867901 1.2126036997157807 -0.24628509924213604 -0.66257981521776632 -0.27552525235627923;-0.074249272981053202 -1.2913880507962152 0.0090572845250088945 -0.037316778006637824 -0.5650147998206112 0.0411476165151414 0.24885906152424125 -0.65065705048871059 -1.0653535266746346 -0.52167150120974393;-0.32027784473463039 -0.01538990398180734 0.64908517264228283 -0.37246445712898285 -1.1200285765781224 0.2296650667657365 2.2571889678410164 1.1012455875245319 1.3955522895170525 -0.13034842649759001;0.37353855019849991 -1.8972786109187678 0.67638287627305638 -1.2702731208203819 1.1504657165488332 1.0511945428827207 0.47664936319530021 0.78392396463437697 2.0445221176639361 0.045280856848541481;-0.53943898440251081 1.7269396933518957 -0.54251537438935049 -2.2800489458701994 -1.652281535038441 -0.59375160286232742 -2.3721315056990586 -0.36914748247593038 -1.0469824225894244 -0.059791937443902737;-0.337251125087484 2.2059523554306137 -0.59843252259166424 1.4057634581763108 -1.5022987513656048 -1.1078143389439052 -0.43147653270748754 -0.83721025085053702 -2.1756998923466986 -0.1281799729473771;4.6032934752844081 -2.8964161545797475 1.3023465110207808 3.457963774208817 0.95133574788813036 -0.97073781767003575 4.1417797087377375 -3.6671124581603087 2.0522397868676765 -0.063346727180932982];

% Layer 3
b3 = 1.4103126336792233;
LW3_2 = [3.8699808202319779 3.2493641742439774 1.4135772451326867 1.8975614832202097 2.6895033743503216 0.20799386835919004 -2.7492827472452772 -2.7900247331266064 -2.6475799453378639 -1.1588269489047525];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
