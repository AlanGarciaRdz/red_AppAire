function [Y,Xf,Af] = PM10Atemajac5(X,~,~)
%PM10ATEMAJAC5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:55.
% 
% [Y] = PM10Atemajac5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00968992248062015;166.666666666667;0.0561797752808989;0.00614628149969269];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.848023273463032;3.5209371588602405;1.3079864751602412;-0.027122642375957077;-3.0008635937866512;0.72683131409427382;-0.61245241206559931;-1.3410250885221999;0.036938059437543219;-1.8168685336227985;-1.597985033444123;-4.3020208790457115;7.4641498340571761];
IW1_1 = [1.195353556640153 0.2459529069080946 2.1319602493447816 -0.20407788111595462 -3.7944173327991577 0.38217884009438607;-0.74854475596500569 3.8589836036372214 0.2877289186551068 0.23456016482162459 -0.078714866582797999 -0.13519512660963892;-1.1620286179083139 -0.35931766099087159 1.3404067665362351 1.4679269578616412 -0.93811077725088898 -0.28892824685101798;1.0548867768759758 0.89697412956499423 -0.86792750925083295 -0.9277653944286155 -1.3415667657648862 0.29123978643585702;3.2938058694156198 -1.7803061685258721 -0.10379709305624793 0.67584370397096416 2.9456957316542787 0.54761089895898152;0.53756187740420569 0.95859922332943903 -0.0084144314194281762 -0.86455592999469055 -1.2403581563060955 0.36770503163665946;0.70061506181571276 0.18959348861258521 -1.2277141356455843 -0.86909666293112164 1.8412678617796947 0.13741071507359731;-0.18689888250434558 5.2322200549909033 -0.34676576138258758 0.28033720503733767 0.49875133929239979 -0.13833321254453973;-0.093848104360995749 1.1699682693403959 0.38785272826552214 0.058397318767232774 -0.010763548489945506 0.054672944638816875;-1.6046812709435296 1.3670582291288116 -0.61928695379585808 -1.5604275862959311 1.1823140461704627 0.77408023605545295;-1.1636992921837757 -0.34712181693584948 0.45634214944937906 -0.58655946619813781 0.66890903986876882 0.22759675138100693;2.6918293524882055 -2.0162789493549025 0.82504780925751808 1.7398513759481662 0.66693381356224735 -2.2429380397549878;-0.19637418380241142 -0.3857383388836943 7.34342082728985 0.067343971464679256 0.41139736411334193 -0.050068673130862537];

% Layer 2
b2 = [2.4946553633374942;-1.5610635686788381;-1.4974150147998533;0.98576203291534814;1.9082496458260669;0.310403268885527;-0.047830594234212827;0.33283624691619834;2.8893229674153305;-1.4630316507815144;0.94342048702433512;1.2310163806331764;3.6683710390783331];
LW2_1 = [-1.2097792356458812 -0.023047004524333715 0.71712708992868268 -0.45852699351856163 -1.3616955360846139 0.68694851705753679 0.65100531665867922 -0.75600692301057426 1.0934295692630989 -1.3586225114992625 -1.0419998931317551 -0.23072339233828099 -0.8148276875823478;-1.4330693676582145 -1.472244695403542 -2.291470994994754 -2.4187909409314452 -0.8332735630481749 -0.30156956825024733 -0.83898810896925535 1.5351357693439605 -2.6814541371762757 -1.6873109759383762 4.1444652644326192 -1.0848259696761329 2.01148692700106;0.44390818690452755 -1.4235596534361867 -0.29358660337116227 1.703632711833613 0.25787562781819795 0.95181790472360905 -0.85076205160577789 -0.13554527053713925 1.381684346028393 -0.59215410132854518 -0.20999882228619121 0.70518251023795298 -2.5989940388622936;0.80716890032476285 -0.57042849116768268 -2.2229896494513968 -0.91007861409364299 1.0980617128961787 -2.1323964473355654 -3.8340231782713969 -0.13515264082311704 -2.0255531500568984 1.0625637529439511 -2.8804408529183392 -3.0320729369477126 -0.085775134892246349;-0.54019784060525122 -0.5021671480391483 -0.48295683932235361 2.216239770190076 -0.6694481362702116 -3.3371809369290899 -0.47080943442618045 -2.0492637341348847 3.9707962288849727 0.39251210409526738 -1.4970562907296088 -0.25836098783984768 -1.4726386483097709;0.53473101691189939 0.73766350430212524 0.60545366304489456 -0.20555543755243638 1.3126329127580112 -0.00086876884801031368 -1.2410220294780978 -0.2409177944079077 -2.8999274725005786 -2.0184069992574365 -1.6681509981491491 0.25669246903210563 -1.7424566991335302;-1.5130431235301711 -1.7802281853976054 1.6960585259978924 2.8568620908578772 -1.1142676989340403 -1.2379101255789484 1.1240205675629809 0.19112886463419163 0.96964408983344164 -0.59306466606129449 3.220056550537588 -1.2009799331097619 -0.67846706537021995;1.8022070989527477 -0.95522255129555567 0.91122317569209677 3.369337037089287 -1.4721523709374402 -1.7863653784046349 -0.42793744762520158 0.96963588977041448 -1.1597548553991688 -0.65900625632592147 0.65802349684672634 -0.47600033484822579 0.83762647838405524;-0.099285856540547598 -2.5382765441378043 -1.0652894958679253 -0.20067964202263031 -2.0474691401057123 0.23594622775681681 -1.2037760431854101 -0.62917593936054894 0.90177942147060086 1.0602244007124098 -0.36582098912620886 0.69622863065933327 -0.31298391249499841;1.3070155377650958 0.79981738010977121 -0.78847521683555755 0.36478108547610266 1.0529417266250913 0.46049575893012112 -0.48459229872432169 0.96052769868107979 0.095439726936839331 -1.0997440819828346 -2.3663450663037695 1.3497795307461367 1.5043778726051349;0.091204977305184856 3.3160633513896016 -1.1409512447280905 -0.76543481132380098 2.7346442025864226 0.032361972568946303 1.4276471580132131 1.5341506544047327 -3.6765380743976852 0.48665526202275006 0.54758333098906986 -0.032421895683701116 -3.5635668719540519;-0.72498286518728872 -2.3394266024879755 0.89471565816429477 -0.88933946781221263 -0.62983373143819377 2.6816169446742477 -0.46096535121872867 -0.87904117916643743 1.6118532848223039 -0.44997182271328195 1.6087696980139665 0.21703290955650884 1.3007614932683216;-1.2768146560905904 1.9757100399807574 -0.48878101310316152 2.1740694681369224 -0.83470266615251931 2.0171229012046199 1.0453339479296346 0.64973712458228206 0.74062322279735981 1.0700197652378853 -2.4062846884917191 -0.81378718402712091 0.40032043978517839];

% Layer 3
b3 = -0.048509687528031718;
LW3_2 = [0.45231575306779548 0.12763031303490585 0.13459007529470729 -0.28517776192374872 -0.26051980973374983 -0.053809237130453325 -0.39710136273037311 0.21568333114709495 -0.21440214673348132 -0.18402561005948675 0.14454311089725097 0.23934653430557493 -0.64749798102692346];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00968992248062015;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
