function [Y,Xf,Af] = O3tlaquepaque18(X,~,~)
%O3TLAQUEPAQUE18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:52.
% 
% [Y] = O3tlaquepaque18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.171659085057077;3.03490136570561;14.7058823529412;15.3846153846154;10.752688172043;10.4712041884817;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [0.79073817058476592;2.8580346095075351;-1.9092829034377146;0.35823867668597131;1.0465960252503916;-0.33766173506601571;-0.60388798648865583;-1.7742258840153615;0.38761995314676972;-0.54601276417316791;6.5992488958326045e-05;1.7369771296500844;-3.6426851667201574];
  IW1_1 = [-3.2973075497726931 -0.52001649980862541 -0.099543484695027856 -0.31147067575489051 0.043557998703760238 0.16852485852348753 -0.02678209039413363 0.26636897748365818 0.64250922482672768 -0.44346564033772717 -0.21993912258329473 0.49215640123560878 -0.23720674553635496;-0.88694912471760012 -3.7479643340081452 1.5291529535043076 -1.1407673138831171 0.41028742719360889 -0.72176484320273482 0.039893782104839917 1.074488972823137 0.70373457371896087 0.33756141978904675 -0.51277469577823087 -0.017948176792425261 -0.071940986213635927;0.40210038454369262 -1.1004180552307414 -0.27243236150342465 0.98293618267401217 0.13693434365375884 0.31486422149471333 -0.73493954136401118 -0.77881627052929081 0.3534205490133171 -0.083590440905037061 -0.56281639345669943 0.12872551899897056 -0.63749234872198612;0.099497983312020477 -3.732249703464662 0.18550870793813534 1.4349054217541399 -2.3943800709431882 0.29467267635909844 0.070210531105612012 -0.30996873407346515 -0.67412261068752521 -1.2561427329613308 -1.1386138130828332 -0.14708079707833566 2.1172259113038217;0.7532949408600268 -3.4053385870686594 0.7651660382205816 0.29043614374300464 -1.3029947263055726 0.83453739040391761 0.15979578174406406 0.67458057310057828 0.10521684281073954 -0.58083579505156502 -1.2452261486174407 0.12835003438423276 0.78444181570530691;-0.1191473317857219 0.253437862727043 -2.2704980052798875 0.47254355263681658 0.033448654281292158 0.22540335908751544 1.80208720237488 -0.96607980302013452 -3.6080187833875743 -1.6606767047948843 -3.5084267930028208 -0.2755324185059968 -0.71011255078431745;-0.52327020595232121 0.9706929472490573 -0.60833819317267113 -0.14112709283229746 -0.92457792653150661 0.38030468314009036 0.1835557162639746 -0.11889792357664421 0.34132003648756831 0.92693105277643761 -0.5203604187768941 0.011019325020389228 -0.53456635002729258;-3.3527875490286543 0.25946051952457139 -0.1057438733191651 0.040772111172061962 0.72104278506699448 -0.33167447263662753 0.4817018103221925 0.34088636759219448 -0.3909114423044569 0.24219011881074801 0.48371735252984693 0.0042025772541806807 0.065796839823673611;-0.20156554580661837 -0.52951837612823738 0.15859928986173757 -1.1731207924950173 0.36921969570892499 0.22004865072393354 -0.10393199979798606 -0.08096033586962556 0.44887444745928295 1.1585169988664237 -0.46012635093598392 0.58226732559521011 -0.82300080098029804;-2.4392073617996268 -0.26960420592717582 -1.1419664336913626 -0.084930470296772059 -1.1023667531611223 0.047789560252943772 -0.070399022491614699 -0.22827411128633235 -0.24788689840024475 0.43753623063781172 -0.20306512211283051 0.002600344090894954 -0.10398850915917213;-1.1208600489895364 1.623399063379463 0.55972212357044471 0.18498602342053436 -0.061635627005057744 0.25113715262943259 -0.14915964569508414 -0.16520699555591306 -0.26062588071012438 -0.25236517677903925 0.35858290274285332 -0.054567658988531179 0.15545674159543235;-1.1966817398272365 0.14334372199117218 -0.042570834231111097 -0.19806601473238744 0.47150434598416635 -0.25849854553361262 -0.26944248096419898 -0.068451339919258183 0.024441992336609611 0.89526587772820609 0.11427193349741874 -0.34086053634089941 -0.25888983645105368;0.1659653827904469 -0.87056934875678249 -0.74623470782017542 1.0304976070238878 -0.09506751890629761 0.30071666088376869 -0.93499966237188703 -1.0489048872493028 0.29582518346542819 -0.57654219617602376 -0.6197322976624563 -0.23791661399392711 -0.90385772906362527];
  
  % Layer 2
  b2 = [-2.2611402554102238;1.8963754362593908;-0.71917318622735527;-1.8975499996348022;0.44862355536759368;0.45761868497028119;-1.3835596618157613;1.1566706176789281;-1.4873903653722151;-2.2138677488769947;0.40543971862334299;-1.6210565254942637;2.0055028663965495];
  LW2_1 = [1.0455865284419479 -0.36782961643871714 -0.40649690480122608 0.50685918597463175 -1.1116547051378676 -0.48233566221845853 -0.001362751584448707 -1.061922594285444 -0.62574140558734614 -0.10165821160091254 -0.16329522259788062 -0.32366290936034581 -0.39322824607036116;0.16882277927785694 -0.36867278356534994 -0.81673273789856571 0.40851339218612115 0.20799875962441816 -1.1091581554613525 -0.39955646221691343 -1.0245916374056878 -0.76649946792383505 0.12141057460829802 0.97507736441185777 0.19243664895806506 0.54155236137086438;-0.096030022179480062 0.3935940687296392 -0.71400198740144194 0.2954570475410393 -0.22578521490035353 -0.31103586005704925 -0.40694058182625975 0.3549067817578177 0.22419450479257033 -0.3774284252114134 0.38075647933427892 -0.6543983319911969 -1.26274583404052;-0.056860132202263318 -0.11796447373638087 0.31813103129788067 0.20528750435519053 -0.38024663453602142 -0.15567300312391677 0.49001999219635828 -2.9327443453659243 -0.21769187372346102 -0.5066377903536865 -0.30784006269511699 -1.4366386403233458 -0.0089432181203960293;-0.82114478018440618 -0.59220068824380701 1.1489037877792507 -0.066326757802904146 -0.21916904786399455 1.3015958106938252 -0.53932181939246981 1.4637958710098267 0.43804162024801485 1.3015799758202475 -2.2170792097416587 -0.10928404778386439 1.3432320736381496;-0.26390096638919935 0.29384222616699279 0.06619090160241875 -0.41937470567634361 0.82899891425976713 0.36722831248712512 -0.29838728121838731 0.70523040650067237 0.28236036073885595 0.12901696775688734 0.17951422867570835 0.59272615549379537 -0.02212015342761357;-0.088791736493660789 0.33308310147295717 -0.54982674280117327 0.28611034326400819 -0.33469006776613608 -0.41700757051348253 -0.70634945524389969 0.069479946753506813 0.43174722826654655 -0.24367622551366055 0.4752667810091355 -0.42312126510497766 -1.4220979604353214;-0.47959122341298721 0.79381579744880371 -0.37977905785060473 0.47336423001713007 0.77294753175737996 -0.2248752241223389 1.2740003840074405 1.0081758381489831 0.56890093352551807 -0.49515113262897481 1.0590228754251461 -0.77914327564268959 0.65570257974356205;-1.4985678603641852 -1.1592389756800805 0.25050745760567417 0.43811936494111853 0.68788027134128416 -0.50172358171734843 -0.63950332558953638 1.4113152933576054 1.2664909000044144 0.37078998507662903 -0.44383592128256549 0.087709347495057433 -1.4788996922931532;-1.1813391257498287 0.39472972448709942 0.81553714116567855 0.68780600937143832 -2.2094027882717597 0.54412748659103383 -0.098692886196036222 0.76960875041295274 -0.21928943504137091 -0.055428006215573089 0.49710393196025709 -1.011534294794497 -1.0453117164809087;0.4400921356880928 -0.46727728193969531 -0.091296284328155716 -0.51177773465490661 -0.062182796619987928 0.24271528082788543 -0.55959320769128884 -1.0594100330716745 -0.17602760024216504 -0.5187896340299577 -0.57758111890231134 -0.17459281970224844 -0.07942590337552638;-1.2447413850591518 0.12871777564591724 -1.4779416267189371 0.40492054616630285 0.018573387164380038 0.052995500202278972 1.3025747615232046 -1.5044512466341013 0.21489464765975649 0.38179809899265127 -0.16586253363785861 0.53889667587348589 0.69350746736798996;1.9433346770248048 0.35572437701387871 0.97814671651954743 0.34340525058014493 -0.71865535745479192 0.17669783548941448 1.257051849984461 -1.209939124861596 -2.0241573799532127 -0.70045817058228343 -0.41742346126410679 0.16347541157133916 -0.33785487670728576];
  
  % Layer 3
  b3 = 0.3701547256135998;
  LW3_2 = [0.75601716684468667 0.23133013975658717 -1.4214532721457758 1.1073482786207549 -0.23245764011123984 1.5827274631449471 1.2307005977876424 -0.6068805179283544 1.0049691967124161 0.66351169935230125 -1.3052758599403687 0.22474547383765733 1.2204087544630497];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
