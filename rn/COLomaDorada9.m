function [Y,Xf,Af] = COLomaDorada9(X,~,~)
%COLOMADORADA9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:37.
% 
% [Y] = COLomaDorada9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;17.6991150442478;0.00572573718866304;0.0175284837861525;0.0546448087431694];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.5577835379918326;1.8038888382812908;-1.8897310074644871;0.43942916008733202;-0.59136265134057497;0.1661904689135757;0.14314802813189259;-0.84743946667493253;-0.8959683514613721;0.52434936188869774;-1.9244516382767054;1.2189822953211973;2.8660906975168627;-2.2736556931763463];
IW1_1 = [-0.3686223484338802 -2.6067806725418321 0.30445004611657894 0.37387854541378057 0.060634398205120101 -0.24423787241381126 -0.56531264152580118;-0.60298647495255142 0.54478273113200193 -0.39840105946708815 1.5812576375128733 0.79396001564933205 0.28310779761934796 0.19468916439117781;2.0257698075321202 -0.80452109519588699 -0.17165145069329851 0.57911078418989737 -0.32669054033453138 -1.0181486631035512 0.2236436759239015;-1.1974859614848916 0.015499076946371041 -1.109047024341876 1.2700375152530048 -0.24839067999053327 -0.93393361516098172 -0.21359672071522737;-3.6203128046454762 -0.0069993333237920122 0.14585465519251722 0.91643937939803477 1.8012744281004167 -0.16227872308652652 0.53150253024325667;-1.4816769218420991 0.45551178274729009 0.26265072188226379 0.6704161327764302 -0.54267617498362752 1.0753943959278329 0.077538695844298719;-0.5862733773328529 -0.38020251204304861 -0.63797447513600802 0.23624218787722828 1.1349034748166211 -0.82543709020456002 -0.11309832028798492;0.040163743250742304 0.84601489039660682 0.78907654125292803 0.55396469119041347 1.3297177479757176 0.54005865219523874 -0.010071058771924098;-0.53036600402737299 -0.3757983252749017 -0.26887074002755279 -1.1970047701673971 -0.88930460250909715 0.12955700483721644 -1.8908040616132769;0.95990574700579079 -1.3739996332997064 -0.2278700839506706 0.69777284243449922 0.74713672706570244 0.52646956759638441 -0.033072694458584809;-1.8935031034978669 -0.38186785816670954 -0.73894830436279335 -0.39339969591909185 0.3622742221789963 1.178754669465331 1.4673588169978933;1.7327226259778172 1.0109013842114376 0.21792360763844018 -1.6553972517540463 -0.45467664936844399 -1.1191664604376836 -0.82816303904257982;0.94537107066363157 1.673820505920999 -0.20089663362070831 1.6025287548655043 -0.49343292846467174 -0.035450135780008739 0.31563334387670283;-0.39532721413079736 -1.5907599131663295 0.79740188690801994 -0.97679123416704261 -0.967316513981332 0.55669323237866042 0.61755003868262726];

% Layer 2
b2 = [1.9545959541804656;1.5547531645429531;1.4977962773709488;-0.6441578515965003;0.17221658398381295;-1.2872349745202225;0.76263410085666616;0.63692870440462734;-1.0024163879574262;0.35355487601152613;-0.82271876386984766;-1.8689806435728147;1.2582833582286643;-2.6848997115000133];
LW2_1 = [-0.82242940382321827 0.15977112359758386 -0.062576383607435254 -0.81483935375940475 -0.59043265962347025 -1.4641838064449268 -0.92361568192787913 -0.56288868094749622 -0.42411629931245187 1.3077989615676244 -0.10872527172498632 0.5351675641216741 1.4202154026914773 -0.11833781588959932;-0.49185480391032999 -0.23004621278549026 0.75322633464749444 -0.65215533554970118 -0.13280938251421853 -0.10365992402698238 0.078050754829314895 0.049998338363272408 -0.0236689904663199 0.43947898393798246 -0.063859740260730546 0.16165507163428314 1.3798681857704074 0.31262947456596363;-0.24388409910619854 0.16737859937392774 0.61749526940047783 0.028102368144438304 0.56342578827212508 -0.40383773794563876 1.0857869470626607 -0.5468795192339363 -0.02939238619782248 0.19451104873444522 -0.05147530255981099 0.22592399891330464 0.34136173734227104 0.13921861944149216;0.64605057456866277 -0.60771939200351355 -0.72010758622779159 0.68093321171547794 0.45333020430105742 0.11507778750726963 -0.18198524571847779 -0.19928489874275723 -0.34066470288758799 -0.079452033522751112 0.035868514378886988 -0.25567130507568325 -1.3524830845907421 -1.1841150530102702;-0.56731774365604248 0.81684479671780985 -1.2637932948287143 0.99854999477288031 0.57866520569958757 -0.16707459087456361 0.33397552213496479 -0.56843862011507929 0.57937943516733559 0.076283134422410304 -0.28413847778488455 0.026801862954682173 1.2323324349067444 1.0173709579900863;1.253747097922133 0.27426012761966956 -0.68547124898618561 -0.32326954972772343 1.179498979047916 0.19582573742574455 -0.060825372201517187 0.2993781153471447 -0.25503474152974043 -0.94496422231950816 -1.0570410499055385 0.80246424067215982 0.3931881365701117 0.8094650449791384;-0.53949973836611209 0.98708461743282661 -1.2068252200605611 0.78971958665412012 -0.92127536645401031 0.62798928618454164 0.86645707081641776 -0.6571505720802544 1.0047767312864353 -0.35840159605361654 0.90313521022718457 1.3169079357935041 -0.32664770338937349 0.54609701275714051;1.0313353477158933 0.54568241698501596 0.77867651006766525 0.74261914247175664 0.76677801587215799 -1.1667110166695633 -1.2616200351028319 0.81691549343153635 0.44834126689272896 0.36830960960730813 0.13405048935974434 -1.1205369770768185 -0.20525054815690888 0.49934323322239921;-0.097394127073610462 -0.54242372213867396 0.64027705292516535 0.98996551925822562 -0.50706546514289896 -0.012413702977374735 -0.14804972418128468 0.5172333889944517 -0.001754002851131739 1.0130640127568931 -0.74924883665008057 -0.041071625165730152 -0.34752905292691427 -0.81641703208664473;0.18361323023247603 -0.078935036001972436 0.89197079547859526 -0.36946570189775035 -0.64199560846731696 0.71575844765358376 -0.84091516098766717 -0.19814931573902339 0.066672952589001883 0.30357332321880515 -0.16240051387323198 -0.047996976930302096 0.78604382201031042 -0.68743162142161274;0.037360778262614476 0.19105012788737266 0.49380678242465248 0.38539923017099686 0.14860018830546212 -0.15408459288779747 1.3930424082051658 0.14603362966506189 0.027547583000034487 -0.41103686170620346 0.14619700059970048 0.84614798995369966 -0.81015386020601721 0.6758830876455888;-1.6347648738270244 0.015188951292901768 -0.50915131386661738 -0.21483674152302099 -0.11909912351515012 -0.78700159809947257 0.90709814408865497 0.29161728331251924 0.43428477347678773 -1.4691209346310574 0.13358024287502801 0.62001343334755654 -1.2749413495287514 0.50652270053808635;0.78187169552705094 0.89175243256443648 0.15138509815770088 -0.22405824312677211 1.1593166300999802 -0.076249694008373364 0.092978650949764124 0.84189057790614485 0.080698322860882896 -0.54726658656909133 -1.1161470424189059 0.95462015252310761 0.16022447602063267 1.0731596458759478;-2.0866972832155071 -0.20511517047552116 0.38393496091962459 0.50564460817816814 1.242291004496098 0.8367081378597051 -0.66499292381754149 0.0043086388699906586 -0.093272615774197529 -0.53381815937048616 -1.1597780584878408 -0.045242186104618116 -0.81212822038300125 -0.43175641491536937];

% Layer 3
b3 = 0.80195944601836999;
LW3_2 = [-0.57111231155461051 1.6852651972840933 -0.4272180148312742 0.99087753553997193 -1.5779510128538736 -0.74386847198045236 1.5090839833147398 0.51277827009482735 -0.57113186746415967 0.62788748878174527 0.90792639151608678 1.5120426046875686 1.8833575271445009 1.3073478205053259];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
