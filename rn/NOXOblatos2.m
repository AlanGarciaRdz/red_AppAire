function [Y,Xf,Af] = NOXOblatos2(X,~,~)
%NOXOBLATOS2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:30.
% 
% [Y] = NOXOblatos2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;-10;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;4.05679513184584;0.195790504160548;0.00618238021638331;117.647058823529;0.141843971631206];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.67477203685428511;-3.6805195468778495;1.1134673347956778;-0.099154301561289168;-0.93105988350637114;-1.5139094301827929;-0.3940849618864356;-0.20186355576352091;-0.37231087333129587;1.5976719508100203;1.4878088720316758;0.69303218085770302;-1.1153221399568265;-0.88129045909100101];
IW1_1 = [-0.82259964803599006 -3.2880510731152097 0.46771703478021837 0.22845189509695552 -0.34078997831124247 1.2225264253760617 0.11770170720312981 0.031022222063898364;4.7964595666353569 0.062732554526507361 -0.63497294941263183 0.29165238459044429 0.12785768398362182 0.39882522847089047 0.54421322816428719 0.17333019749970863;-1.9559382338236644 1.0197800891495521 -1.297591987668647 0.5923084084078386 1.4893846622201636 -0.40530149779480323 0.81790880988463255 0.23183516507180971;1.7640291878040817 -0.16392756676493747 -1.7561497084524675 -0.024400556785471053 2.0428164607230546 1.4365857140807867 2.9436166563892634 0.38803546089069191;-0.084989212207230574 2.3023261630031349 0.39981612527733884 -3.5385127386268298 2.4643008337213952 -0.73010127329717911 -0.0099330426969388777 -0.73784064584857079;-0.57763943716598432 2.8404439425841592 0.33995725826003653 -0.6038326949088334 -2.3522306580689785 -1.0519763021986659 -0.36093810107965379 0.19975301837677262;0.46480808069077023 -0.046745647047883691 0.22912424261142275 -1.4112403214854916 -0.10719348544852862 -0.80068351368863377 -0.033861031193334355 0.14078288444813189;-1.539873904802471 -2.1539588898492936 -1.9797011573463341 -2.2196712910085008 0.54807425881181981 -0.12613490056456642 -0.51260897453377141 -1.6716012862957532;-2.5288421632562472 1.421563676434503 0.65484867225802912 -2.6951881589799518 1.4642245748699558 -0.52668489498732052 1.3306083499746251 0.31861899322176446;1.7270467956930753 -4.1836331410110894 1.7647773210555018 -0.066077954657976959 -0.77595062727074082 0.28819659577779538 -0.92771357897165174 -0.33934472408759186;0.063711839759436936 -1.2436728969544919 -0.64807248485098556 -0.16497008495122029 -1.4558197397375392 -0.48685412960151553 0.19833003099129767 0.09867186925722804;0.1540236764646678 -0.94652780154146443 -1.0030256439470999 0.64444848106618191 1.0022728799671694 -1.1000009280220711 -1.4211520711980041 0.92103917935126145;-0.15443155964563876 -4.4193640028974777 2.560286532524287 -0.28197589770723597 0.11978681854965634 -0.18003736317445254 -0.21733347497704644 -0.022268550492975735;0.19473994250439899 -0.98207643183690396 -2.960376489394017 1.0640514822292699 -0.30150157819980583 0.51667753610020173 0.30390157617051028 -0.033119142423857127];

% Layer 2
b2 = [-2.3314187663492558;-2.177053357640772;0.0075991464925642214;-1.1453994977741104;-0.14374812639270082;-0.70492568481379758;0.78945349302147161;-0.5682670026658565;1.8916320731455478;0.61410116361998868;1.0382392209219524;-1.258767432115496;-1.6099910937496467;2.383645665691958];
LW2_1 = [0.68605017314690664 0.62574310257608512 -0.46955449350186829 0.25131514891739259 -0.54881095976850613 -0.57951267913223503 1.1149889490595555 1.0779593556804241 1.0930644876219169 0.076319373075372746 -1.2321372639483603 0.23049809424549259 -0.91582200536255065 -0.4833559910068268;1.5017617786548008 1.4454137242422147 -0.16422572350812206 -0.29156504036413622 -0.01593867257038583 -0.57753113473270434 -0.15881650077788642 -0.46414902518738566 -0.32191431703828877 0.84951751047033452 1.3047567764804406 -0.28069026531272467 -1.2216964995228634 0.14227323402410696;0.033161955385948641 0.70087073535950573 -0.29616654195676012 -0.023809721785702263 0.55847840005218752 -0.13112477550029769 0.85619884275945646 0.16867776985351271 -0.99178105792518223 -1.2420906015065112 -0.9911274382403501 -0.43019257431721825 -0.7912214976619707 1.5824483111239342;1.5358574499838142 -0.36002018461914054 -0.40365123191283453 -1.2903255493817507 -2.8102743241977222 -0.2370603520270069 -0.92577266502027822 0.42905154691687786 3.7082666555569244 -0.15626175067639669 -0.28331336425663139 -1.6339844108025381 -1.3653472619628708 -0.97291875487589607;0.45298600648008897 1.734829232027036 -0.94075131180783733 1.4778711502040958 -1.0364975178551685 0.12819415193169317 0.77351149906270378 0.37354570611101379 -1.1165083615905909 -0.69402692526300924 -0.1210356986747549 -1.3225037040985388 -0.78017953798354078 -0.17638794725610735;-2.6373462973393322 1.091243762223987 0.66717751210482612 0.30420465886459735 -0.34617323930164756 0.922961499038911 0.63290438110840797 -0.36818476753123069 0.57672848259327392 -0.45491059190578104 -2.7899373663680751 0.2735480996671682 0.90659301405068093 -0.4490356184968976;0.70433910369377395 0.27072128771458354 0.78779338932742837 -0.63811377729194585 1.0344200050223824 0.51530175744454909 -0.55840657175137132 -0.055796258028502167 -0.69196864622577614 -0.42988886214094635 1.0220178399924567 0.21307802220339495 2.3643478413396117 0.26850528427288856;0.17405244334078815 0.69382957307687454 0.94652714531197413 -0.14013844965595537 0.71038713141989973 -0.46321674138666386 2.3350303244061048 -0.60800439195547529 -1.2498170478358293 -1.5541498629510349 0.27705752347542201 -0.59491127443269598 -0.61736167894735439 2.7142419539372531;0.46907112719338945 0.20130485612328947 0.056024241830475004 -0.47185100160411736 0.60741621385033606 0.37174867645427828 -0.10021227965227035 -1.0608076301983766 -0.28696790753153756 -0.4624908954972699 0.10444428416449052 0.99185343116429781 2.200730981517304 0.40867487471112041;-0.12640487679526108 -0.31743076000899312 0.23702616266245621 -0.0017686260205841244 -0.7567338116786807 0.31273970663239581 -0.19092997471472042 0.15631453767591175 0.56763990942810305 0.73160137329961039 0.58316429031981454 0.24035191391069052 0.72074908018454031 -1.0161895791607671;0.97128952406056102 0.87066812598194532 -1.130627915891802 0.1439838982513876 0.13036749776167844 0.062937349112848914 0.3215956983075911 -1.2742633662079847 1.4376428287106542 0.1203126746536821 -1.1031147582312057 0.47157069156675968 -1.0203783610654751 -0.90977212459853241;1.4269309887754911 -0.18810137032701174 1.5998702729157499 -1.3010020559702034 -1.640259315129329 -0.18295880855090185 -0.77205069900617584 -0.73867832496314534 0.9215929326633463 -0.24591093637427477 -0.53405569557144283 -0.26365760197112798 -1.1569895011347342 -0.807342597944954;0.090017274974096395 0.052750027853394395 2.132437556262905 0.39473673653526953 0.23334100330414656 0.5850696060257965 -0.95464932013383041 -0.85086367635967475 -0.8308162378852344 0.95318251424861167 1.616108179805666 -0.52360244029667247 -2.6235929386630326 -2.1484647572162965;0.66665571778831756 -1.472827430855759 0.75213223703025622 -2.0066285401375135 0.53787415892034141 0.52851759903553863 0.067954669076252652 -1.2055473923146787 0.69160761138908433 0.072582307606789936 -0.0077492552788492155 1.021197675508879 -0.63195464202711227 1.4489886220408084];

% Layer 3
b3 = 1.2590107113659388;
LW3_2 = [1.5387941062186636 1.2867993024780104 -0.90781611214773539 2.0547486122385425 -2.0221423648535222 0.36383036259762752 -1.7352372187289371 -0.32603156602151168 2.7113084960844116 -1.7902888109180017 -1.5310596844377322 -1.8779334106166927 0.75393778033819803 -1.6337562131616381];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
