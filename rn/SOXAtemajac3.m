function [Y,Xf,Af] = SOXAtemajac3(X,~,~)
%SOXATEMAJAC3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:22.
% 
% [Y] = SOXAtemajac3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;16;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.0770748338753569;-1.5126656402577436;0.73800336786098908;-3.8769551496264643;0.90806803035192263;-3.888479583192948;-0.46916382093258646;1.0333986926291474;-1.9421173870845059;1.7069559678718993;0.88984356269528719;0.80149309500945576;-1.1113030470176688;1.1584120545636574];
IW1_1 = [0.32245279077145628 3.4131608315806927 -0.54562672127774736 -1.5969578725807645 0.10881744448574869 0.52006879083674162 -0.3843118064470834 -0.061344400826450013 -0.8149397404668387 -0.94063856477618302 -0.45275159942601156 1.1821739415297803;0.091546580369536418 -0.16008561479472902 0.20661279311959174 0.050180325400300943 0.82289099386508646 -1.1557280846920008 1.2631109051324989 0.28747952855545617 -1.9304343572423948 0.19095698722532242 0.96010410720984818 1.1442810216601123;-1.1032396944191436 -0.27092318185384306 -0.54964052246443273 -0.72571904624455197 -0.73772689539478487 -0.016176810827432997 0.35707859251564189 -0.2326335113865701 1.3191603701240899 -0.17090349898795112 -0.36280319940664807 0.78745188331950167;3.3083780933207483 -1.1306161445507534 0.41479251306760379 0.84697078407431925 0.1945213586241249 0.0420836893639654 -0.5705035578365002 0.97124975028557636 -0.64270219559531772 0.44863418766711516 -0.84730250489160808 -1.7287178896901241;-0.4471773938141046 -1.2647777743791551 0.28488225705568065 0.75911961178449505 -1.037050432789909 -0.77054068173810841 0.38909944206848296 0.53791177369004717 1.3249108016688034 0.75167631602515605 -0.65645129905688437 1.5523266641277698;2.2885955145787111 2.644792925065397 -0.069860122953496417 0.6561716185516665 -0.25262335550029524 -0.28456431976002877 -1.9311103706408022 1.2269555700000883 0.32915491109148615 -0.74574929908886212 -1.2915832407044767 1.6082858182224982;0.47874027067919683 0.82334025492112872 0.015214652757834842 0.25289381701895336 0.18303044720485262 0.60493958666186465 0.16487857664675504 -0.0033184644665857944 0.20458561683499918 0.24267481056459722 1.2414032694837942 -1.6271930327926301;0.84224591171997432 -2.6996543412351293 -0.37799220276094014 -0.15939613805528222 0.90548095590784805 -0.50171714327605577 1.615838547556375 2.2545986767385666 1.1064137717983547 -0.28449943191545668 1.1140122267592498 -0.5489324102918699;-0.17334965696864596 0.082457460019000395 0.23447317811099416 -0.61930788906911627 -0.47039135925776554 -0.24568172356013973 -0.076182754437719186 0.49617844607624473 0.35297324035864575 -0.35220534061313136 -0.92321677587135154 -1.0634528024880074;1.4861815524304078 -0.59492962309562669 0.36769151136921846 -0.14797240328341493 -0.76466952868282323 -0.35332822707787115 1.0838405905411554 -0.3352226078274772 0.34655444042678207 0.07131865107988633 -0.53466763281556462 0.8058364093041106;0.18224495015480688 2.9660879445391819 0.92235936845191147 0.44079661876138176 -0.79870253690734117 -0.094462374673886684 -0.070527722601635839 -0.0090332518059832306 0.12813268087515531 0.31834213331086131 -0.17866662034324557 0.57431850152544039;-0.094088954362048283 0.25844907144699403 1.3691060601986313 0.46706743278681873 -0.87685076549825602 -0.45174654927935964 -0.2059948014747475 -1.154774015593576 -1.039086793961955 -0.1105121445979991 -1.1519419648819482 0.65270975138486764;-0.23036566288829649 -5.5216852544898725 0.86247082181983969 0.10626657965787389 0.29187414807604717 -0.22440426058514523 0.24446140727369187 0.18516549960730291 0.143031045807408 0.47679370943339688 0.051892240574222065 1.3965621950220444;0.016060265852018675 0.20411945128563577 -0.11209558259059951 -0.27811222728907969 -0.053379290893065784 0.051155067995286962 -0.056072597598573658 1.4269773195050015 -0.16961198363620472 -0.19380725768007298 -0.015115226923651576 -0.47031834519948218];

% Layer 2
b2 = [-1.6260745785927611;2.2549104384540275;-1.5351277136445096;0.59116507277720287;0.10381970327321698;0.27166678859855931;-0.58476858941295295;0.61318288609852567;-0.23932949875591009;-0.61489970331188981;0.31505592665802062;0.78854365255648662;4.2139508300729203;-2.5751798317573678];
LW2_1 = [0.88479794310351134 0.43160502985732024 -0.75963887511624439 -0.66028894882499523 -0.1314131624466065 -0.012222167942986195 -0.58030772896334415 0.66842547047255374 -0.12068236704232684 -0.66132002684469404 0.63100096102803516 0.89935717437430218 -0.14229567150934286 1.1930276082667768;-1.3879128785823105 -0.023484819009543075 1.6279734179043721 -0.21132496528093428 -0.31468876514864291 1.1753566775947983 0.78000754043670173 0.43534296414109419 -1.9772218663365555 -0.88555150298853569 0.87592273111752927 3.4177288469416207 0.14019841552325124 -0.90778235905291027;0.64516235695120905 0.96226563279881316 -0.14809853959343172 -0.48933213409411708 -0.040613646255332328 0.17037712062401608 -0.33727173377228126 0.44693115415346829 0.299947609020773 -0.3956031125343652 0.30385385018604616 0.46892879232384405 -1.0213888327150085 0.09017082520753518;0.22546480906434846 0.22597254986260526 -0.12106805565588008 -0.090705368031090541 0.47845989044514775 1.158764838186731 0.75836031699687301 -0.032514120593168265 0.40820441872190294 0.10221391572819744 -0.0047684152346127995 0.23856953292074332 -0.84235031124317472 0.093902198517141267;0.69488476485082651 -0.18858177801532042 -0.66239997552188368 -0.087018020453187114 0.73095372812389126 0.67105716758646305 0.81859864087627321 -0.14655788407773673 0.059664444621235359 0.1305419020086106 -0.72029004877320024 0.48059923899990942 -0.97915415595321964 0.58167916945547549;-0.25412771279282265 0.91716986677095758 0.53402550271678451 -0.50130313003101212 0.46102394072196273 1.8559045577017355 1.2657252846954523 0.37013060325839203 0.97653318138017897 0.091168341963462823 0.56826871895724451 0.28051678713384831 -1.7997318376708391 -0.79148525650564872;-0.46891400264931699 0.36040822243838339 0.62179546904519611 1.0903807722343313 -0.76765439133407321 -1.1479752177584606 -1.4484371998103649 0.31336868989929423 -0.60609504465325004 0.21890717531526202 0.55540065853574028 -0.58793863753743469 0.10017677003502846 -0.16951026096878241;0.11657533337052695 -0.60778405165028337 -0.44984075660288964 -0.60440815641553092 0.90681189555981678 -0.6048728777546265 -0.75297329428037862 -0.24151511623405264 0.041162945229403752 -1.3691081749112088 0.28465568107285399 -0.12778863737000257 -0.17582771444065781 -0.77541015712238492;0.71982569044441447 0.64643433723181498 -2.7868764240261994 0.90462904562296498 1.337258191515577 0.63568866862562168 -0.6172035173307111 -2.4976628434900849 2.0624616268131075 -2.6385326780328504 -1.2540647236651119 0.45560228800521696 0.24493979552559447 0.23003211402358359;-0.27761836522258343 0.42532680617988217 1.4481380961949097 1.7789192957056839 -1.2185202476792596 -0.39442074590949161 -0.024132384517132587 0.41908099085593198 -0.30666674523499959 1.9876608214239535 0.90794742400235484 0.53765053152227082 0.16130393019484376 -0.45793195084849292;-0.023334225604804276 0.11823675369540669 0.19043253541106689 0.058790943975376805 -0.53648738219818948 0.10149671747004831 0.39683056454453258 -0.062926484988659187 0.33029636947715041 0.22793791710641051 -0.57291537930513003 0.032289780797304414 0.39872076178542742 -0.31129346822429182;0.88459612457838399 0.81778416239109375 -0.9956233785287717 -0.19067877146541196 0.93592384376865045 -0.22365841822830557 0.98075265217055052 -0.10805676343902729 0.01383141990200934 0.081253047448516982 -0.92648397806387062 0.66175737059642759 -0.91502724440220973 0.41278771053924807;0.51258877381977197 -2.3044093982166221 0.62606718214221124 -0.51489755869738107 0.016474149427988641 1.0234662093426354 0.80077106097950357 0.28750976028490527 -0.21969165412717423 1.1563664844470385 -2.8671872319644502 -0.41074338907491592 0.77817701224006153 -1.0348636255374983;-0.22531291898198452 0.52672990062718594 0.19600442995630857 -1.1732972198021376 0.58900202496621468 0.065374625316192897 -0.30638816325630946 0.25642909022548976 -1.3500658365685876 0.089967100825063789 0.83861892518371783 0.64383978666807107 -1.4272568286323637 0.063476540328265219];

% Layer 3
b3 = -0.5039695060785907;
LW3_2 = [0.74934459784047058 -0.5739210133352749 -1.6280252416617524 -3.2138611304817557 2.9726348495230064 0.8235067074283916 -0.65792926795043294 -0.34690875907751034 -1.7710199497232684 0.22374724483396982 -1.5207413491011654 -1.7197534997789508 -2.5314380047541065 -0.44059259695793201];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 166.666666666667;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
