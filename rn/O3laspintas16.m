function [Y,Xf,Af] = O3laspintas16(X,~,~)
%O3LASPINTAS16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:48.
% 
% [Y] = O3laspintas16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.241545893719807;4.5045045045045;0.00280033604032484;95.2380952380952;0.212765957446809;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.9312511946359203;1.1234655729636656;1.65163743924303;1.6383963367805989;1.7508952772109585;0.92157349419447288;0.65491796676904201;-0.85370720376172682;1.4791997170952138;1.4493206412316157;2.0973160244685438;-1.0706330297463649;2.3846015287066722;2.4333625617789694];
  IW1_1 = [-0.082551319819457042 0.29572719460321312 -0.23045730621539204 -1.037785018692768 -0.34762093040130493 0.18770260611912101 1.0335757676409933 1.4547215025460503;0.15162386218941015 2.5985255951219344 -1.1828231364246244 -0.39613728691439615 0.99241466278877621 0.37012071580280348 -0.86498824254367745 0.11550733182796785;-2.0227369672985045 0.61064182238926468 0.33032554321988306 0.16314190025173492 -0.48976980425827138 0.021307396196841868 0.035818730457776629 -0.46697452335613071;-1.2639371841364595 -1.0578262021938596 -0.6157807475207856 -1.4281165291034479 0.023366566342310768 0.79941702056823272 0.32359422358304496 1.733324706751479;-0.22953219409843112 1.9223956737194294 -0.48622038491365804 0.43099105944654953 0.91952456953308237 0.046406630807734051 -0.99400262508410031 1.1227037294187314;-0.81708859158518909 0.018254869535922411 -0.47763853074148238 -0.97162061334417427 0.24897507786515813 -2.4479588073805596 -0.93317162703953249 0.48075470785701191;-0.94958842223050599 -1.1967792422725696 -0.046850973200975803 0.60061391023448985 -0.016193808686245724 0.0080683799285937562 -0.16938004044584318 0.72287340579411263;0.7198395665005024 -1.0894582458814652 0.42810231236416613 -0.56300751203309651 0.5764808807880456 -0.2372273076546445 1.224534516966681 -0.86311528799767301;2.2007745264887255 -0.0083230423887503749 0.38611508645767884 0.16483463455048009 0.59926934400813947 -0.2930493350106278 0.071816819324337117 -0.8834660021351679;2.9959302795412506 0.29177402346375009 -0.38167788405912417 -0.30179751272669803 -0.3208533504220461 -0.12090804618383827 -0.049442502937001039 -0.5367320859300222;2.0062205599465504 -0.23475556516795704 -0.98714582443810772 0.59476780416669239 -1.2893500234646713 -0.33614467838929019 2.2179987066952007 -1.3496317405530651;-0.46938741174154819 0.55803798383817893 -0.11910396329808526 -0.59663204927197133 -0.35549572140607577 -0.10230936606636899 0.27854523363114225 -0.87008242091539012;0.39959149152964935 0.78612598234272457 1.3058347545563154 2.2217851736662109 -2.178961180703304 0.25578560484273449 -0.075696020955023105 0.045359792181172143;1.828165268410892 -0.26705604475397771 -0.13864311258148215 -0.46517073342541959 -0.1385660673195685 0.097083642907552406 -0.97795269218483039 1.6490363178807113];
  
  % Layer 2
  b2 = [2.4749754360732874;-0.48369743118887626;-1.896542754785858;0.79441606543313725;-2.3304237188875745;1.1234550903412144;-0.81879036516602866;-0.065299443027081377;0.075621705166231595;0.26962978153775946;-1.1746354250729054;1.6851001039428;1.7725460034438829;-2.6619958818760883];
  LW2_1 = [0.39993513512743101 0.6829169984240282 0.33606782178521893 1.308612070162444 -0.80212549895025509 -0.69583467947958511 0.62015898760873223 0.39208327119760927 1.0099789391776455 -0.43842490299231995 0.34154076148113649 0.64210346680870489 0.16886184517340028 -0.17372641707195413;-0.068424614846910092 1.9381599865030392 -0.10320963031122174 -0.25523423044558946 -0.091207885011681894 0.47845315534213168 -0.37520424282781867 1.5855045616060575 -0.63623728200487717 0.88296914403310711 0.033096101423913699 0.32430027582058085 1.2092199116300639 -0.3543462199049397;0.038915827748668697 0.87941359767007532 -0.61050618137184021 -0.29722557419925655 -0.047189097051874941 -0.90419946831763132 -0.34246170765048123 -2.476347205432472 -1.1177342498968375 1.5086329733047372 -0.9061352906018737 1.0033566979706985 -0.79659749480559028 0.3472999389609237;1.0928832143624898 0.14512361629143644 1.6449949863970021 -0.61659920706082627 1.0308311314992689 0.12099110860212306 -0.32157398739723753 -0.23141560785944912 1.464666873519733 -0.15330387284872055 1.332438752977132 -0.93804101595276901 -0.30335105991012357 -1.357553687299033;0.93715300990217143 0.53352529164867857 -0.78602827960617272 -0.30480257496974955 -0.063955790076935304 0.14468378887584149 -0.51298343183874306 0.48512960518134485 0.75917775758145023 0.45266943347790256 -0.33657237008225321 -0.78614976151289973 0.8047929218665576 0.6208323979876279;0.56590240181041374 -2.2448859007763198 -0.22418610987760737 -1.0577135467262384 0.95939564937969046 -0.056407010234664531 0.75074008755158272 -1.0874155559809664 0.40896645534105114 1.8160230422347603 -1.9496365767457158 -0.013870526462321564 -0.87568556713336254 0.082507243458496651;-0.73314104069641139 2.3930332735921334 -0.027255733007189975 0.55818295862104395 -2.4283698190214578 -1.1257054460714095 -1.7180684283095389 -1.1079253125417758 -2.1796234983571217 1.1088763395499963 -0.65905302819595857 -1.3664413488811165 -0.71395693433528196 -0.43537859279115898;-0.87163348502099725 -0.36960848504567367 1.0887137446044979 0.34173124484103368 0.60193035672481532 1.2423241540135093 0.97000339285556614 -0.060836356337328944 0.10628472642874232 -0.56972248679271553 -0.017963598371739289 0.62927409699960146 -0.52159256153123212 0.29638249213099649;1.7264568289125264 -0.42421235248671657 -0.34513460117811928 -0.25851074883850289 -0.8017986547700251 -0.5840404330661837 0.64998376494562526 -0.11746055802981129 -0.48135857735444521 1.9625712810308156 0.30273588830350884 0.077565399649435138 -0.5421614155140515 0.24696798645039625;0.90973329138251402 -0.29274044475877836 1.6861612405909332 0.54075229303177952 -1.3111588626891877 1.4949907034778016 0.054375559565541423 1.0386855759430229 -0.69755616074185567 0.10810921575467591 0.41654670335199057 0.4170384429589869 0.15021966029991066 -0.10292773051713569;-0.028334936700040364 -0.53113570299494006 1.8937633279683908 0.048869512009917793 -0.35804910968101744 0.3268853461578255 -1.0482064908932631 -0.12478547837828552 0.54307290090936589 1.8147533264955789 -0.94175610377483543 -1.2583699967736517 -0.27307405776667759 0.2469914772480494;0.40372513603503285 0.58062092610238203 0.074861508114252601 -0.53595213793813057 -1.6170254618928768 0.30112859057040164 -0.10812372596436336 -0.030473560669571617 -0.53346740337079979 2.1619151361051441 -0.25654050500790687 -0.35833309300762062 -0.81696379220022608 -1.4050221079645595;-0.46905945556838813 1.0649310086210471 -0.41531090239659152 1.3584374838868971 1.1876953883270909 0.081210775155652837 1.9568694154081867 0.092120669392991239 -0.2968957039991249 -0.093909174034987677 -0.64226910109157798 0.017562641961064579 -0.076467214048612203 0.076755791507400598;0.68078033778987268 3.2166278701956403 -1.6639134021252369 -0.86725568317744961 -0.53753825996153282 -1.2571501860042227 2.4907517522106262 0.00057660136995786593 -0.203784270068123 -0.18949415095409444 -0.061361264158108345 1.564045958636499 2.8118013093107361 -0.49426302645741582];
  
  % Layer 3
  b3 = -2.4958678860810193;
  LW3_2 = [-3.02879408067309 0.73555661288310792 -0.5075966483394645 2.1425046561207717 -0.79123516626041168 0.6358024550516006 -1.7979070417017597 -1.0728251448723463 0.38249996638387812 0.76643966428001098 -0.83456649042116282 -0.56747793353623122 0.23687592973260718 -0.62563905676149656];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
