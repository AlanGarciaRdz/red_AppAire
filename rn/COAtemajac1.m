function [Y,Xf,Af] = COAtemajac1(X,~,~)
%COATEMAJAC1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:21.
% 
% [Y] = COAtemajac1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.1723861230302228;-1.0966657805465654;2.9302963620676099;-1.2584949683524604;1.1222453408695932;0.53104689737093536;-1.4447625143767764;2.9656629821146896;2.9670365830166934;-0.65100214449483529;1.5279971178639995;-1.9458987192475274;-4.4650213148635283;2.3857142818938195;-1.6367401695840516];
IW1_1 = [0.2789675144012117 5.6836748148531679 -0.61110636360280279 -0.57082970796812238 0.21712744409163587 -0.22503424578039227 0.29212920923389168 -0.13671846892189443 -0.055388336015648618 0.073466717587760078;1.6192477214031267 0.70028211933041296 2.3140672784245404 1.0840505372793685 0.39521552719625269 -0.35083696127227493 -0.32446521231597641 -0.9902098739313534 0.3599997740590053 -1.7230440814619492;-1.2591655309389835 0.16387820572912007 -2.2159616723784765 0.12488621403043815 -0.13691074647036985 1.201443416066442 0.25914952912893602 -0.72009656526652355 -0.48193166154766365 -0.72741348276461326;0.66184934671024631 1.770223283474152 -1.6254553066297608 -0.43829841039310069 0.25082874649223752 0.30188511650571259 -0.34458425200998194 0.16312402424148378 0.14697846809140877 0.7290955989548068;0.31371826673697595 -0.31550397511642198 0.69218001148170594 0.36499116797979436 0.95307010014157334 0.83713565116321376 -0.99968570107028398 -0.35409948862514162 0.70291777112456821 0.26490685900684985;-0.60840867679356458 -0.33398215899315609 -1.7054831897061018 1.1561665242641277 -0.46367388016019034 -0.25004592286699673 -0.958360476219418 -0.18207377651079545 -0.48014222754693303 -0.44023712584464136;-0.028597398146501155 0.074469990462133678 -1.1763677001015442 -0.063035031555298757 -0.026582910229454713 -0.07318700248747137 0.083336765823774139 0.021395665753924851 -0.055103948226804228 -0.02577591366942104;0.33272788450521801 -2.8443725781641054 -0.070345380831084908 1.668764499107005 -0.30451784145351912 0.34851231526381926 -0.81149425647476026 1.0014083194920025 -0.92847739175127797 0.039200802207370322;0.30231201538451963 7.5362358559103937 -0.2128295454904009 0.31996542456833815 0.12687081587424726 -0.25065283929312188 -0.050268671386532647 -0.16676163111551082 -0.24883153038917358 -0.069359922171000579;0.49283465334575949 2.4250833007497672 1.8598724746191138 0.10298833409136518 -0.17381578463379316 -0.7735114190403577 -1.350740540360289 0.22752957751064676 -0.51827976204006332 0.55588462067493816;0.33757308416261583 0.6415168584026113 1.3382407150712048 0.087919900693750608 -1.3620563162791579 -0.90655373969024766 -1.0555387957714348 0.028852395110581363 0.31278297934317839 -0.6170990546939541;0.64076218087178471 -0.81748236906762917 -2.2616836682471964 -0.109449044587762 -0.73951117348461048 -0.48344053119647951 -0.11827536490229583 0.41216352747927931 -0.3453785227231273 0.010728187982827393;0.059272449589578169 3.9662696542856679 -1.7069326650897199 -0.41759430261415059 -0.33470417261867424 0.43867970059704831 -0.037354413072623674 -0.16664139294793121 0.34120882805306085 0.13953039154875771;0.70616798129366676 0.0077755226480045094 -1.210952271306651 -0.85165797474280258 -0.26044508910567954 -1.2950389515700507 0.40710327184906692 -0.6449600287512075 -0.95881255671175036 -0.2344398937923188;0.022489770750667264 2.3801828725265444 -0.030178301534661688 -0.93211905797659256 0.15620874387820816 0.11604106398818027 1.4413386132503379 0.019618223076894873 0.39661370835052423 -0.65740098906329036];

% Layer 2
b2 = [-1.9328423900998668;-1.3405292887928486;1.3435751683238175;-1.0618375675137701;1.1705119589459905;0.78765198643318501;-0.14717567761367503;-0.13187864794789694;-1.4074141544143761;0.54472411828422906;0.74518626260446763;-0.4988596280763492;-0.85359081764401223;1.3609023739611483;-0.5317007753459424];
LW2_1 = [0.52752934863521528 -0.43646209637080674 0.55047122822289141 0.092707183278749022 0.0096967204382356256 0.19038925868402384 0.30684213490133383 -0.18362331877870566 -0.058558651342652826 -0.15508154037778699 0.37700901945660908 -0.036504083802168172 -0.22519529239238645 0.60030977583600631 0.10637855599529304;0.58697545317883582 -0.70137188422029939 0.26842753640854555 -0.14921525685812548 0.10185396069717682 0.65530000916143871 0.38501500907811054 -0.48450025971636723 -1.1773163515222143 -0.25401912432705098 0.12081272197263439 -0.24466848635410449 -0.098988171418367493 -0.11537641312038258 0.54088971813851539;-0.11515857094877649 0.37469038380172581 -1.0744289629352253 -0.037404935952639343 -0.049463743340351148 0.77357843139591986 -0.68162638159511657 -0.050957904946401303 -0.46810442499689209 -0.77709433039448772 0.17902706781905958 0.37820056370002042 -0.95023041601071079 -0.25037817595993661 -0.30439687738840554;0.26409254565603135 -0.01991853354828204 1.4367217887416959 0.41938190743928455 -0.092997604099462103 -0.38498025900671934 0.46186003296441208 0.28288197540943039 -0.38176236087194931 0.21640180037876153 0.3048574453548924 -0.0030842629087649977 0.48932023840418104 -0.24467175148583742 -0.42858706866166696;-0.52880045683357735 -0.20765578546937272 -0.69651674696824573 0.71994608051791409 -0.4219768527201288 -0.18707468795408841 0.33875699385598029 0.33607333205589607 0.00041572572867850949 0.35648214970136088 0.96273370236542377 -0.26613425504444038 1.3742370137286297 -0.13558447746827049 -0.6097456431881848;0.13102688227139545 -0.10037418995203409 -1.4101749545831697 0.3611330066319714 1.0501670911763927 1.3137060734925932 -0.68726843203057153 -0.54066234498268484 -0.96119273344954004 -0.26291809246037517 -0.23038062096409812 0.69181569199608273 -0.16144240672446655 0.85880370596560951 -0.65643303940403552;-0.44815212319852399 -1.4799393980993656 0.11419214042820749 -0.54809910292276331 -0.15689696181733609 1.2120867542486771 -0.7168199056243586 -0.50839179037172 -1.4124491732735813 -0.73392290793862158 -0.51962204326460082 0.1427398678303673 -0.26300597408846421 -0.5322717904209131 0.16721706567794076;1.5252464692854755 0.97507104234187636 -0.8664115670013991 -0.7238834346401265 0.14192299914962861 0.89728465212573338 -1.3189929702171879 -2.720048292601335 -2.561567313886226 -0.032883881734725388 -0.10170225948090841 -0.054458828833339898 -1.2280869868128337 -0.3790570279607347 -0.51768517410368386;-0.82254219973948028 -0.2232681755396847 2.1583934152470508 0.22061142050353588 -0.19771661209293728 -0.51048817376054711 -0.37503971904223371 0.10707686369057279 1.3930597011158476 -0.041389379589829106 -0.019368027843577388 0.22526026140980079 -0.72163777751785307 -1.4059081388339543 0.23710334621304086;0.72843069298261809 0.20385136099016693 -2.0617389007664482 -0.33401994485967795 0.076090780502169469 0.74768762975863678 -0.19474477869839224 -0.18627048128162862 0.26999736113567707 -0.44295599783351941 0.55708464246532408 0.098936310603219835 -1.0876285544586373 -0.00028578805928587518 0.23624361951450978;0.48728391751546457 -0.63082071160388464 -2.2902167960268707 -0.19281272537598423 0.19614795271132521 0.48541105119047362 1.2571234299450518 -0.5638701796338994 0.54190033484155187 -0.36174154440190393 0.9011000983563392 -0.14393476928451357 -0.16887903012999048 -0.014656047648627209 0.48854134806149313;-0.26028442245185357 0.24437938930494285 0.61857299234109575 0.25018878474776274 0.025521739330402572 -0.0079472115425387353 0.066466598836726176 0.063825022799800721 0.55977668819363535 -0.99993175428697112 -1.1641454465534058 0.64424764524379541 -0.30167528006596334 0.62392824434161498 -1.130470679947456;0.7648429513009195 2.379166053814338 -0.77545424176103839 -0.85095899303722788 0.18049286075040366 -1.5437057080562862 -1.6837665196838296 0.52240722767788006 0.6922390060666801 1.4781338076391233 0.033487182677395699 1.4058737708371327 0.23294968733746599 0.74065916690396671 -0.15693083662012455;-0.24769399587402083 -0.3363412981069217 0.67300156038583603 1.3255661417800426 -0.74295691191483648 -0.17243599517098265 -0.69596134012238942 -1.0112285335031039 0.091229079637357657 -0.56364896450285218 -0.59600160956536608 0.61283284355984891 -0.65740621673691046 0.30794658636705569 -0.81532691051296624;-1.4516779754500089 0.33641442084588113 1.1844882173553484 0.30529092835157401 0.065500548712746257 -1.3279618798366493 0.172312369328362 0.31284476362715707 1.2096238689114795 -0.16358659190150043 -0.37718542777837855 0.75624409890161759 -0.43645066843650754 0.52703288724051511 -0.3085622655065679];

% Layer 3
b3 = -0.46588015089644136;
LW3_2 = [3.362922848460506 -1.1927750548340257 1.0957465808095077 -2.1001151630628558 0.56585054560483572 -0.1720453343755689 -0.23427232415123309 0.69706380699014037 -0.92181211628125659 -1.3087664799229441 -0.88307169051492207 -0.51126947228255459 0.27155627862335086 -1.1278473301604941 0.34851210379587511];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.201288244766506;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
