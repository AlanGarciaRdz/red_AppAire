function [Y,Xf,Af] = PM10Tlaquepaque18(X,~,~)
%PM10TLAQUEPAQUE18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:41.
% 
% [Y] = PM10Tlaquepaque18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.00773694390715667;0.00572573718866304;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.858801843948346;-2.2742577247516964;5.2772368239587015;2.2158793651084627;-1.1353726446444885;3.8917398974965423;-1.0331748765457878;1.1539532232648702;0.32993029197089252;0.82563304119478265;1.0374124395875861;2.758648599656639;-2.1858370253267076;-1.6265127064920977];
IW1_1 = [0.12679901555456435 -0.32773164328143456 -0.48979692132811459 2.3773699102654842 -0.28636796866550268 -0.50118472233918265 0.30794443986921732 -0.31522749607807166 0.45563691860284183 0.50283464451804583 -0.31566340630481154;0.97108265746880851 -2.157285399439389 -1.55069830351377 2.3621182485732297 0.60353599715350204 3.5472383851254716 -0.41185244036856916 -0.27899812498545679 1.1739358206536969 -0.31544557038183857 0.4372681744994133;-1.4219579013260042 -4.4613663978959766 -0.044730559587114957 0.79702585066239306 1.0704785458047792 -1.0415603244775333 -0.72749078781743637 -0.37958572882282626 0.10562740313841192 0.92267341600273189 0.48119929881909285;-0.41990682360774206 -1.8932526816219646 0.85152287484933387 0.86721306028414569 0.69676419834488768 -0.51996246671825497 -0.10416454622148195 -0.055293635567388075 0.19067121736785062 0.072595426991363565 -0.70952193967811061;1.7336758744317982 1.0824174841963476 -1.116913854664745 0.17364057212338485 -0.28591751287484163 1.5781588403284439 -0.19758140974347008 -0.3549685680508613 -0.1312783367708186 0.1359645619087195 -0.066692140856012605;-0.9918874134328628 0.70805979000364316 -0.50341264195340452 -0.77696915823189205 1.9097725347107544 -0.11132662633213009 0.057536337688101152 -0.13530827471962445 4.0848868572933128 0.71995166254390497 -0.93490292886292636;1.7387589445053822 1.8835120804149268 0.52150406307544717 0.82345869490127055 1.1870951468712403 1.2148604805412211 -0.9528194645056477 -1.3878496706197936 1.3490389344727802 -0.91053612043663534 -1.6391591866659458;-1.7736066637908943 0.0032939390778086875 -0.79985759028026127 1.580759743158626 -8.0691036576707731e-05 0.47759965409918681 -1.4245852621476511 -0.94027336347132073 -0.93462302725859492 1.0395738055349071 0.26698119895842831;-1.1654404054298746 0.45308423729130354 0.59490774620168352 1.7336693786219222 0.77782284380242595 -0.17193322227681127 -0.62865573818987075 0.53499654765600724 -0.99861911733198461 -0.77420139788308318 0.69012625929936733;1.1639768160990474 0.88852776563719926 0.18135788263059086 -0.50936568719251096 0.26135684725230746 -0.91748555459430925 0.35205158962383648 0.41232777969148032 -0.27535597936033246 -0.91691363171631823 0.50757799127920478;0.40963269098796845 1.9934960595288831 0.35507198176375243 -0.43817076233593011 0.31041666189841027 -0.74156204499619638 0.21949879276812947 0.12128382670082445 -0.2598085925209872 -0.47625514884551112 0.25951954044174225;1.4258284875632146 0.90358759733552485 0.35048264693787951 0.11305391331612001 1.0841081601487901 -2.1280535629329029 0.12561005730225369 0.76710532705654921 -1.005627834505942 0.14141962997965773 0.67030433872972484;-0.37918953677567796 1.2978635621477779 -2.0783404653025297 -0.25331224957901305 0.46742048378554535 -0.080533533203009253 -0.51444411656201749 0.19054998655836228 -0.13124082638036347 0.072166903521104761 1.0462170551096677;-0.22920105225230755 0.15521832083110221 -0.57502442795436437 -0.99996401777787092 0.80997617573627589 -1.162321115493681 1.1046691501307535 0.99035081443864947 0.0041124327089215318 0.14763280525333655 0.14479703740249023];

% Layer 2
b2 = [1.4844775606269875;0.68637424021255311;2.4872009051815964;-0.91564074805628337;-0.38576748832878449;1.8660343347519723;-1.0319726677713428;-0.89976596282151133;0.93710108541379622;-0.42399029261353854;3.4257044964381058;-1.1297159633383873;1.989806520488278;2.0606807270825627];
LW2_1 = [0.5380934942920117 0.20755507823963204 -0.013084461689418625 1.1984139730588375 1.0826962301493634 -0.39848998784813616 0.43164520207130641 -0.17659416453569596 0.29699685690474059 2.741673604829983 -2.1672959288116802 -1.1108942528403476 0.50923705705426292 0.51819794163771049;-1.4008305624662274 -0.78806063865107245 0.76905119463108695 -1.9189972288861641 -0.80766546838045894 -0.080095285289042695 0.54933559897772866 -0.5554435458285224 -0.053003924189767342 2.0142723462250043 -2.5029786127711722 -0.52491277008194948 -0.74347102542995269 -0.33552317827510003;0.85032449209244887 -0.29166220823656847 0.048217731979139561 -0.12328760541888545 -0.33123849907715347 -0.27294976489401601 0.13979774911404594 -0.10547069723285615 1.5457323473972013 -0.17898493117650538 0.38615398208620944 -0.63346514552307576 -0.34645292618907575 -0.05077387771232128;-0.4086275171831798 0.18339029177537064 -0.77773696202116116 0.27020283659045274 1.26932441500115 0.14626527735783859 -0.73638312663284966 0.83812606939916467 -0.05635088686404785 -0.30841174995882481 0.96902820334081818 -0.28612370608700327 -0.97451006524494654 2.6189531135738151;-0.38638153578939349 -0.80249690203330037 -0.40581407196727892 -0.075020455248301712 0.40534197104507841 -0.99660355368964537 0.13116924398758284 0.84692103977528355 1.1113233197979915 0.32495969219862975 -0.060516049039125983 0.5332909636646006 -1.5914911110125127 1.4853970726707595;1.5335578079638397 1.0005362486240215 0.13539862071184161 0.65864301626609301 -0.69615396363040971 -0.43020409667822623 0.20181454176566951 -0.32806593293598463 -0.053220130166603374 0.89630324656537552 -2.4037653481274832 0.36245828082959186 1.0307091909355865 -1.7132098489331737;-1.4581803519300871 1.1888605539493162 -2.46953135980463 3.0297452982237929 -0.076998197989738254 0.423990219154111 -0.79023945061071932 0.14475129660438207 0.5247604647914943 0.85138682350782691 0.22417752060133947 -0.16144853273858448 0.87265325394511939 0.31408155301711238;2.0434275249141423 -0.43930314896881517 -0.60459177258161667 2.0455023922884927 0.29651527563613295 0.21626113653266668 -0.16842825766105862 0.15772404652721317 0.24864839189047447 -0.64825900012640503 0.54194908868640368 0.36731980776330392 0.90647496023781826 0.12908772943733166;0.63415955703325844 0.46231450846606481 0.25142102459017879 -0.2731333064130157 1.10083900140811 0.49976171024206451 -0.38849429509669386 -0.019246152737618497 -0.018944794801451285 -2.5427678305934953 2.4295956558924887 0.77330206160416082 -0.70455368108020422 0.23768364643156356;-0.71947777167173177 -0.28486810700138954 -0.042858415594651388 -1.0854666111515043 -1.4587674131316914 0.54231397837774098 -0.020468244685306277 -0.018127120179027949 -0.28039130123662276 -2.0202582543182839 1.4662274601404075 0.5581652921602378 -0.20393393913355368 -0.49723564265301523;1.5067232256354666 -1.2060424419710951 -0.031334005670809191 1.045798190077762 -1.3897594630803705 1.0079732728242767 1.224377836817234 -1.6002027624409203 1.607115169069127 -0.93648996143450058 -1.1448604843545389 -0.45799553546966953 0.57598120704669709 -0.61359763023748493;-2.0355194001380976 -0.98632021649571344 -0.23822947664292157 -0.65634575906406145 -2.1228684507076556 1.6569128488076346 0.31849742597530428 0.094824343583893259 0.076622892864414704 -2.0674092325704696 1.173265402840632 0.26065376654379424 -0.32316710062773485 -1.3238989645038066;-0.086244057926978701 0.15807446217514415 -0.075676890649728157 -0.55577537351489159 0.50345726897271903 0.63892671954254543 -0.84363108379965845 -2.11557212928005 0.30147419183809693 -0.2347604407940817 0.39811496266266538 -0.016879526433527959 -1.4160961346521272 -0.7392402803778283;0.87322332142944847 0.43158985998146576 0.058544167664340327 -0.78671107065839807 1.0425394359659466 1.2011700602883491 -1.5930470847724125 -2.5357756677324006 0.34695573256954415 -0.23786602212115759 0.54213044217221362 0.28734706039166935 -1.6761985649918527 -0.44923586873136112];

% Layer 3
b3 = -0.2560224685577675;
LW3_2 = [-0.6514635510118143 0.53952287383785547 1.1512753968782021 -0.37804674753844292 -0.10288009173015406 -0.64586079935666119 1.8057733743118674 0.61957132113610536 0.47343818913607255 -0.92538207037826148 -0.16988969065344289 0.21060358617319036 -0.49579642872806667 0.37257764118642778];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
