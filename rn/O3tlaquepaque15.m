function [Y,Xf,Af] = O3tlaquepaque15(X,~,~)
%O3TLAQUEPAQUE15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:52.
% 
% [Y] = O3tlaquepaque15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.171659085057077;3.03490136570561;14.7058823529412;15.3846153846154;10.752688172043;10.4712041884817;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [2.6067350316990661;-1.6085239695000584;0.35261738911411422;1.1464658336668949;1.2120085668566325;0.81521429542439527;-1.1539146266228375;0.20892285831245005;1.9948068408654518;3.1243435760472433;3.1183313593374211;0.51795841383050523;5.7036133526897723];
  IW1_1 = [4.1764062517413896 -0.10963449890922697 -0.041923725961385133 0.10251355182219818 -0.23006767554865845 0.015578844380840685 0.27927722025453927 -0.121580823278124 0.44312610596408519 0.39384459930856119 -0.23153461678352616 0.069624949710869993 0.14405904195345082;1.3545810836343388 0.41918415054650615 1.1353170924981186 0.17325478439308276 -1.2084654967122006 0.002786411968485572 0.81161393238529367 -1.0163660449767478 0.30064831161553535 1.0726224773993416 0.96356206986665105 -0.40091067972320232 -0.1653667879169009;-1.432991353130912 -0.13966329688247101 -0.80567838036678641 0.3549930021040294 0.15803497075518891 -0.45967893375823271 0.11289133528264055 -0.02315517453325136 0.087299404728886559 -0.22781007053036548 -0.033532969616560555 -0.16475137223495753 -0.098587889520616701;0.1367167721186866 -0.13585367945979529 -0.56543297439826912 0.026592746939973683 0.092501762923991135 -0.48851372184502156 0.2544096877073096 0.098134339420448885 0.53800044364491284 0.47187202680772172 -0.24434049442682509 0.17344739493826344 0.56571352702054445;-1.8840041969846282 -0.0025069031745252254 1.0427177081658376 -1.0039469951413225 -0.20794641898884475 0.50720744214118141 -0.55664147962247024 0.26827545656162965 0.0095348836168362427 -0.16372432292729372 -0.014755936620820753 0.25253160741285424 0.95019555273190026;-0.66815589461565184 -3.7534330020879181 0.34283934426681212 -1.4289245864101014 0.94580039247468695 -0.77579504507150643 -0.28121215577991621 0.16551848936173588 0.35572954546161589 1.0287736718784293 -1.4866324093041918 0.066183005306656217 -0.34808023481972816;-0.13280925379863817 -0.31767013986324366 0.4068711282570609 0.42294736084449047 -0.025545007314137724 0.15800179653917162 -0.20834619151532158 -0.14239751675433132 -0.19141960648963138 -1.0540029417238947 0.49563499845788828 -0.19423237496033524 0.015916613038488066;0.705793860208348 -2.1266274109198893 0.098807845909326536 0.45451523833836566 0.30143007262648436 0.110877432835149 -0.25230777439970076 0.02295965801570457 0.75015991344222088 -1.3198069627242175 -0.062219994693059569 0.3274768552171749 0.66244179170688844;0.76667553056401738 -2.6262559290618466 -0.66393210463815633 0.95363945688779705 1.8273547528105405 -0.13490010152946208 0.0050687773679902338 -0.33702231524628107 -1.195220060305316 0.25715820116350985 0.81940883013616972 -0.48239183797709329 -1.241361772539546;0.22628122408004833 1.860044856317971 -0.70235433185760598 -1.4923160565552129 0.34402487707920848 -0.77084052293278615 0.64884640569126995 0.33262617919971438 0.16036347053562877 2.7008140334583826 -1.2861839508857142 0.35133181035867855 -0.13520854001948332;-0.38245151042995468 -1.7990691392779508 -0.13321426661546892 0.36749691035176962 -3.3025479056245821 -0.21513911133397817 -1.0424358602777635 -0.31301131522468989 -0.95300118299139336 -0.40324444788087044 -3.5887575610992428 -0.2730927099639564 5.918978535774543;-0.29416440103236141 -0.42652795406047211 1.8584426234301321 -1.2102594057281764 -0.13966041894920447 0.6830152848379244 -0.52657170277332288 -0.73200421779619218 -0.37985075214480807 -1.151662780334989 -0.48507526726824268 0.14923061266568036 0.34394433613806369;-0.075184447553503592 -0.37482954480915598 1.2201799029372404 2.4369037963050664 0.27338116246518951 -0.131264522946133 0.58155546377508693 -0.93228342525776842 0.017564572286948587 0.72107598722977195 -0.81422780576334919 0.48852028491734784 1.088158435219182];
  
  % Layer 2
  b2 = [-3.3291624443572965;0.89216401691755964;3.0115369219924331;1.7558162818237708;-1.2524545322664256;-1.2651353727668948;-0.025511354882181619;-1.6572244307979036;-1.3673923920593518;2.0021257374501555;-3.1921301963898672;1.1918561575222715;-2.9475940123085924];
  LW2_1 = [-0.46556801541898118 0.56988937673964934 1.954055608700624 -0.13040470931235337 0.6395423331674327 -0.4679027121056446 1.3022695083794742 0.89187510876938481 -0.087973773121451881 0.50018684487669618 1.1050488085041605 -0.84197115602140482 0.37633406776872597;-0.078240693840765374 0.54783485605639315 -0.41025534052728396 -0.23966840120816318 0.3144565836024335 0.89912255112068584 0.64195431857379892 -2.7938357351385483 0.16652931201537352 0.22574979333744652 0.96427777631344858 1.7262204730556168 -0.57940278653979371;0.58989296136860947 -2.6485331980192885 -2.9985794661524783 -0.047929751502145172 -0.062258088114879026 -1.5075753047060469 -1.6291585051709612 -0.075780187198947427 0.74713380990516487 -1.5827012099808873 0.062210725413094525 -0.48111328286552324 0.65117030852636826;-0.77620456575051089 0.94890590257525342 1.5007224150366043 -1.2174145767807947 0.5940951658321767 -0.12980143817488285 -1.1245832874650552 0.34284799190078202 0.24858094606733294 -0.61083507770090428 -0.18092662976710536 0.17338154551917528 0.32146960669515756;1.192183661455092 -1.1865805744243589 -1.6464003908267704 0.86258304577326295 -0.70750048572871105 0.081142294877000976 1.3169350749325932 -0.24106156467876103 -0.096317342632143269 0.27187597310425143 0.21012353182546767 -0.68792524241651087 0.040645962408876128;-2.1364567556515617 1.4514078904499268 -0.39995226668207062 -1.1155409107322671 0.3207732732946722 0.16199309822629535 0.73660373814947244 1.6412576368824525 -2.7313960021618375 -0.81211842719631133 0.054588473379054162 2.0218639262490607 0.76612654234260646;0.44408628712821296 0.11281152727202581 0.60289886560177874 -0.032925937030731697 -0.080592698921015005 -0.32414478777862643 -2.5848494559408164 0.32988881655486274 0.96764557707662879 -0.18447712274560119 0.059840801997766958 0.5559759047963877 -0.16204341424175178;-0.59111509076336521 0.52313778801414024 -0.82450574479383409 -0.22238862445747881 1.4118861568517809 0.9484624052985885 2.1609439327347149 -0.16170268333067786 -0.49936991046747209 2.7132936956289426 -0.2782753673179158 -0.67239122300025767 -0.20737605970572712;-0.55452988061419994 -0.10826799369080978 -0.66278956487580076 -2.1714448059094331 0.33433446634001812 4.174414853476291 0.91499013800856821 -0.31113571703476867 -1.4664424594611549 0.48544746102247283 0.080021192383600781 -0.72897714108716305 -1.4531713255956509;2.5245087976293594 1.2264861780805012 1.8111944671456257 -0.7184811804918928 1.655487544435255 -0.74196781986118621 -0.073283609978647024 -0.34076742910942037 -0.15188388957795745 0.64153858133891606 0.28355728369054001 -0.50058396967539442 0.74309017508882758;-0.875503497468193 1.7706394187142134 1.1669514920370818 -1.0975938189134224 0.53701477653215302 0.050550067217442395 0.1441902857832586 2.7407316522168053 3.2201445475969686 -0.20393371171252567 -0.47741963247938429 -1.3574661309729383 1.0280734765197261;-0.43225944795196619 0.17982209778036129 0.5297903240824432 -0.21876403829287022 0.23423564452882192 -0.064974683489460131 -0.81458562306015647 0.17436630572969528 -0.17400007587759059 0.07692543859337872 -0.066819882822053006 0.41053522232056278 -0.246952712283627;-1.1653351527081794 0.74863916850766243 -0.63269011909902462 0.55427137357868572 0.51513883792230286 -0.14188914510935513 0.61231459093889395 -1.5293483328468291 0.94385040559435074 1.16504404868505 -0.24505428318411704 -0.074127427968985277 0.40556015594093536];
  
  % Layer 3
  b3 = 0.10725858540572311;
  LW3_2 = [3.2559364299735356 -0.096407171571297759 4.0509589872074443 -0.98166963452875566 -1.0226388374320456 0.29377031083260507 2.6572495572830301 3.0253095744189205 1.1623488228102947 1.4748512275476058 -0.49439818304387834 -3.3722304444337867 -1.286329132417567];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
