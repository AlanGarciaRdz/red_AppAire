function [Y,Xf,Af] = PM10Aguilas48(X,~,~)
%PM10AGUILAS48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:54.
% 
% [Y] = PM10Aguilas48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.4687371353933232;1.376981375015037;1.3726695982008486;0.21325077625842645;0.0046880033595742797;-2.3993505037504463;-0.1698137986369451;-2.3481193125706814;1.3942650934687069;0.75559719232613975;-1.3501728084574902;0.61383997264175927;-3.91066062207216;2.4224061413944247];
IW1_1 = [5.8378215619730698 1.4148447090110146 4.8410010064045483 1.5470432484147882 -1.1470302604872089 -3.1565783625224495 0.96881452463118634 -1.5496609322514723 -0.21051241324434186;-0.41979567583651739 0.41453179297723125 -0.22108331239595783 -1.8735839753419998 2.3866994430982129 2.4021880174457295 4.2679601183547389 -1.1583005957345767 0.49202768717808565;-1.1119138492356155 0.47270966161078559 0.16452821818504904 -2.034177885499262 0.5388250422861387 1.8974218653565278 1.8625098714470794 -0.11536454876136924 -0.5170842313688423;2.5730109531520338 -3.5532664696991607 -0.16831648503894581 -0.67576177157051276 1.0407767398958567 0.069638610061546966 2.8798179517929769 -0.37677350056014969 -0.068676756790493759;-1.9353798308528261 -1.6539888597964352 0.18743982868250297 1.1114296363496117 -0.060982874106424723 -1.7626839128235074 -1.4575617802749492 -1.0151097364768096 -0.36241514279876808;0.71665836354227674 0.1368392011808128 -0.44935521436160797 -2.9032875416861703 0.6396828242010385 -1.0350939602101115 1.8046096517113899 -0.66263044963207973 0.12260353749256241;-1.4905997471386685 -1.8324547474264348 0.15163491447161723 -1.8922342238361138 0.16287077545405232 1.0126336133683467 -0.36287630255996761 -1.1176504572138044 0.00414741874479823;-2.2716182884014704 1.8173968097948507 0.85606541656274937 -1.0647382387570565 0.10463696864738835 0.18869148749164794 2.0000238081388204 -0.54395624164383771 0.05142013729470183;0.24360194887870384 0.015208477514859516 -0.37197086165854737 1.7264914817080208 0.4139796096389553 -0.52269067800205671 0.80156846301850926 -0.25779390845148487 0.0055680076933196654;-2.6498071986744405 -0.25054309637639716 -1.844592144989222 -0.29454974615462531 2.8247763752217354 0.57383121286787098 0.5904787396600667 -0.45800924687348232 -0.17732785976147414;-1.3540407002649968 -0.5217912711900291 0.27406430284803845 0.21589651854792077 1.118056354766769 -1.3321629504255834 1.9634159315675872 -1.1258821418661398 -0.13989234870602762;9.1052869360520319 0.51645362282496832 1.9355421666323072 1.4083744199863963 -0.53461465538247122 -6.2185046376489534 1.7277632648760275 4.0907710049709189 0.12914393206819672;-1.4198803872587096 0.13839350204819784 -0.50549644351495382 -1.3967447877650936 0.039057612773163136 -1.4045668181091793 0.43711464952196954 -0.42114795609828115 -0.25970234202929626;-1.2526297648835027 0.28161292591647813 0.62528656787829495 2.6243714886078204 -0.748104753699392 0.64953536406058021 -0.63361605411170052 0.61010070233050118 0.064439484030706609];

% Layer 2
b2 = [-0.05240831557050539;-4.6906417257475175;-1.4266525233057559;3.6117254626287316;-0.29326380334529689;-3.542840185167357;-6.2835571886021384;-4.5029097555371189;-5.3467272555099594;2.0319998624209785;2.4125735886248845;-3.7550696628810347;0.65061327584895623;1.5761274292383394];
LW2_1 = [0.37739354316195722 0.3314792214348225 -0.12791527064235358 -0.261909341951992 0.18880235194969824 -2.2074295730593736 -1.2458044676256308 0.48140831526270622 0.22710122797078233 1.9837222722503332 -0.47910343034859776 -2.9112646823354402 -1.2722205955144528 -4.5771415082173084;1.1649291969901263 -1.5246646018322305 4.9027338838283114 -2.7474232003212866 -2.0695296757852577 4.955986342424846 -3.9986995617231456 -2.1447362969426358 4.1176523256750617 -0.75781678197545999 3.0042747961714675 -1.462602114313502 -7.2038047376044538 -1.2817738933935618;2.0614750048185848 0.36421314663960336 2.7182009935834519 -0.84713874900527564 1.9332581589160742 2.5199159274626006 -0.5511691016625393 0.00099774626066068128 1.297348918735642 2.7026153096515304 0.6926767326656682 -6.2804995592885149 -0.33715093316910544 -2.3941542182746174;-3.4820509303519862 -2.2480275190948227 0.902009617102557 -0.59780538239739789 1.3569884151567859 0.5181673614174851 0.67193066045292749 1.6701169429500242 4.4605381151439722 1.0082944203456787 -1.2059136756804683 -0.31330776818358574 2.5003692366531016 1.8745441736673316;0.18511492501229027 -0.28593954471397087 0.8372532518122503 0.26677304529201806 -0.039405276931043766 -0.082531751093989192 0.18881808695443603 -0.56330343829547658 1.2229679316671422 -1.0335843854202951 -0.48587324301609597 -0.64551024169796145 0.77622293095814343 0.21961177929611217;2.9052095364886186 -0.2513631894602546 -0.85922541961967158 -0.69746056999593631 -2.5821593918717149 4.2197691540692475 1.0157002545356761 -2.2247571474946559 0.20643016202915479 1.3595280171866151 -0.5186550461254017 -0.099734720795513931 1.1487419340091545 0.73281268930802435;3.7711988172266606 -2.1853951202757935 2.4222132624557426 -0.62834596929971687 0.54048416334900107 -2.1544665719302496 0.24921434652537627 -1.2981050218653505 -1.4902575624417249 -1.2106145693399843 -0.066317219159184357 1.4496483361420129 -2.3491592081070594 -1.4039491231821444;2.3537606916169982 1.0865485464406464 -2.0875275666975694 0.73410911893977437 -1.9229310726721964 0.56413851972642071 -0.30474270190018438 -0.74956491861609353 -1.8796524353147297 0.034059233238305835 0.83459189391511779 2.8936601224225789 0.63275601221627442 2.3959815546678014;-2.587207698706147 0.3799537187014429 -0.5626978631451609 -2.3369254897036131 2.95593931176067 0.24697478416332075 1.5644045534952291 0.069061418123118473 1.0978033789423942 -0.6616925489218709 -3.688013265967625 3.829141829833981 -1.5445084699179863 -5.2835049855862506;-3.6441147564313794 -0.43737312897820169 -1.195861740100832 -0.095915779238910898 2.3119301550525768 3.6221958061672495 -1.099560990890706 1.3424363725504123 1.8666386536350825 -0.02287382411891635 -0.11723972418442662 -2.5272862597705816 -0.17127216139782722 -0.92633727367038521;-0.25955829047380458 -0.16736221118043842 -2.6038139227996897 -2.2331829207981224 1.0060564624633406 4.5605675940119736 -2.0493259578722691 2.8409265906144303 -1.7982373794324142 1.2651454442487537 1.5576895963543707 -0.1869982978050013 -4.268990981465981 2.1962753091613707;2.6449063767373162 0.095096259298702579 0.28502967276404989 -1.0143978771449387 -1.5421520834485516 4.953907051568339 -0.4141250248156283 -3.9380938027015224 -8.0459249054811934 1.8193662699803699 1.0812440757944253 -0.3356256967208055 -2.9496392666064986 0.85627858474283591;-3.372451459431494 2.4407470421781752 2.6627881155235791 2.060545576640306 1.9242804050720821 5.3501135843794705 2.3955559742082508 -2.9781261467042941 0.75825118891909327 0.90350794914286181 -0.37263493379851637 2.1724229327671751 2.1482826963738844 -1.603630089666745;0.73510204358861564 0.54772444991207225 -0.16325655663567487 1.220520326896122 2.0084682650555714 -5.2152463083012499 0.15564436349506452 2.3084999687778445 2.654833855098814 2.4307480386710338 0.43782124230495484 0.65822024210210117 -2.3069561055025258 0.43736418155983958];

% Layer 3
b3 = -1.0792893225991944;
LW3_2 = [-0.049610431550453075 0.065764432882969112 -0.029947521948328226 0.071971688431010442 0.21958681430108362 0.090685000391849957 -0.096411628472051231 -0.23582977563404972 0.05084473788631623 -0.079560169560315974 0.091623411225550302 -0.055840217447150432 -0.052046716572198566 0.066926203313311033];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
