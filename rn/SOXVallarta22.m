function [Y,Xf,Af] = SOXVallarta22(X,~,~)
%SOXVALLARTA22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:08.
% 
% [Y] = SOXVallarta22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;10.4712041884817;0.00782778864970646;0.0208333333333333;24.390243902439;0.02710027100271;0.00630517023959647;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-5.7715299133205233;-0.09090882000149185;-1.4191720114572555;2.4435909609381166;-2.195090179912158;-0.65935879709201073;0.53872172911245897;-6.8729999812680482;-3.1761253004876693;-1.5526848453313817;-2.6329968938218213;-2.0955054243507005];
IW1_1 = [1.8021853968296762 0.084852929127329654 1.3669139800921835 -0.81065970460087433 -0.55322019327228711 -1.0317861811598723 -3.8804753141291193 -1.5725392409123489 -0.21877669108597486 -0.57296146541142234;1.6918795658764902 -0.032317052797978182 -0.6385797419221596 0.22439432244978247 0.11710567397344759 0.60496696644695613 0.61280566027062078 -1.3917951691051629 -0.19553278108141528 -1.1642476163244797;2.3925885888745051 0.46085693601465072 -1.5258691851424899 2.3343443050311103 0.71446107217710686 1.6802180827434783 0.31325987816320422 -0.83558919781253904 0.60504887759000603 0.24566608432981807;0.98507908414273948 0.059010629659921869 -0.41636347674308949 0.55759943794318201 1.1202142365560706 0.40869172330262071 -1.5824065903822089 -2.6741493188009562 -0.65233494743309794 3.5903167352727827;1.2850321843894676 -0.21059439649982375 0.55388532903884113 0.17242349938946408 -0.60247058417379851 -0.91828462936061461 -4.2067113000056633 1.0248440293326087 0.3256132895300769 2.3965782081164626;2.8403081504498378 -0.13408671615742068 1.1984188584737443 -0.87677891289111987 -0.75909648977068511 -1.3725346889839667 2.0185267124976827 -1.3693398255204166 -0.39503663818034856 -0.40714597374737732;0.5578778430320811 3.4488138579624299 0.74587066486432885 1.3872624856485607 0.35039146916472091 -1.2210485927769974 -2.1140700404048829 -4.8805714604120451 0.13991802209464721 -3.2079608712965939;-4.6486058258161185 -0.13019518801176785 -3.4245890764679507 -0.51955994389831306 -0.31138581763293427 0.36277864141804389 -4.2538788766531299 3.3934996316655055 0.051424571532364696 0.43652373354422092;6.8633997710365806 -0.056191284687529333 -2.2795653382872376 1.0667132518981635 1.3286991198577689 -0.11443563857716137 -0.47769754219983152 -5.3013768335542588 -0.1688264556478789 -0.77694751830440634;-0.83207538715517881 -0.22084789451208164 0.2506925371236306 0.73587909852805877 0.039647333059670706 0.39713423721052638 0.9541829574817936 0.74382507187508262 -0.73656157281858081 0.54219840832079613;0.96092499531310605 0.1685783760544132 -0.19606305999102747 0.54632715082169148 0.77923772409313519 0.90644210878514697 0.20196734484004975 0.4679571010305878 -0.26688943797971898 -0.090103884558489195;-1.4975862200385086 1.0035080251522306 2.9287485995770495 -0.71111551277347707 1.1006181832996402 -0.28304753846268277 -1.0961969685573336 -1.649765920181399 0.099493869536399354 0.68758076643674015];

% Layer 2
b2 = [2.289493183939503;-2.6343264024090578;0.30842552638393744;-0.42128525540332473;-1.4691235211737108;-0.89865151114759834;-0.048190799274488695;1.1243257544295933;1.4686995715726054;-2.0434320666095371;-2.3003689899856017;-1.3800421388322628];
LW2_1 = [0.28489449928627297 -0.033246880116073255 0.91187562024804381 -0.29276757353426081 0.77284909507045896 -0.079501353367551209 0.30892949062052355 -0.15180098650976609 -0.60732911700690251 -1.2017580996416906 -1.0784555268408833 0.39592075087168421;2.0751390359889745 2.4456135041829072 -0.81226654857500802 -0.11930188978305512 1.7781024168999973 -3.1192748720428209 1.8572986185524185 5.1415072216282907 3.4144579430946562 1.1383084214614583 1.025621692613885 1.915795214226957;1.1035371539494059 0.70085387342516714 0.52662200167808926 -2.6223083657470383 -0.84147811053364707 0.3796383219238082 -0.79715754614007039 -1.6721349512806503 1.7314056424349449 0.62191901134928396 0.46615114563665072 -0.10343464426304244;-1.2305383126581453 0.16581353844824576 -0.52792106094003377 1.7739104920437314 0.70586300098329513 -0.11225932678943237 0.75690847362198099 1.1177083378926438 -1.9680485442717279 -0.44448360091867439 -0.24688777824286143 -0.056251947922527093;4.5135554877210424 -1.2035123859566912 3.0456909062821267 0.40753560428567248 1.4126358269895476 2.8680824482783942 0.54546081995253859 -2.6553677516559855 0.57144534852201123 1.6936770430477448 0.65122189662823937 -2.337882193808841;0.79409779066661512 2.7965319902532224 -0.70927942002728117 -0.051830798925642477 2.0263337857325165 -2.0512687770436711 1.9713606459613304 5.6586100211981281 3.7759310557697763 1.6639977514827837 1.5103969256414767 2.4475985373247142;4.5059727408502468 -0.55562662168658161 3.0598623424667948 0.32199402903747687 1.4327381857352586 2.9273673404740799 0.51661080093612977 0.9228922519844418 5.7801098326810418 0.27594173152800167 1.3311193432644481 2.0006253415029054;-0.93057730883305645 1.1373804198201809 -0.30650812846132108 0.58618865923714769 0.038937694168412251 0.58278202476291641 -0.10991793678501353 0.21822045427959291 -3.5771705357256836 0.3610910444078031 -1.0865191582743119 -0.11588916579467519;-1.293498526446643 -0.95232123860622497 -0.61416651271161715 -1.7897653636356656 -0.46641200808868533 0.074441627736912791 0.04616841541964023 -2.1401513429588861 0.46929968781864895 -0.7789635686398233 -0.41398002702619469 -1.3298333389828734;-0.51167666856505967 -0.33553942854202434 -0.16366454537906122 -1.7971909591201634 -0.19443783949658269 0.19371223585475061 0.20573920636059959 -2.8663938028240987 2.65162548924501 0.73991011959789255 1.67460063424739 -0.67747454933134765;-0.042533634965433526 -0.53763395015973092 0.023702622299500466 -1.4651258054333325 -0.11067210531221881 -0.081498680570467552 0.25214382130387714 -2.0395701755133433 3.0417130755467867 0.51608993204351217 0.79432762324706518 -0.32138412427566382;-0.5037664541133049 0.14937202832164825 0.21784545462789692 -0.038245764343325994 0.13503404149006301 0.1701366352566101 0.30466385640867744 -0.18939713337725955 0.32394564965255102 -1.0036718577506663 0.61648708194925206 0.32031456495764293];

% Layer 3
b3 = 2.5026071930004252;
LW3_2 = [1.7672258940304624 5.8687670823921776 1.2662970516822876 1.6451176117815005 4.8056323000440555 -1.798447128919189 -4.7835685849298173 -1.8974499415722232 -0.83585506570484425 2.5801927666922775 -3.8886501940564955 0.15038447791506376];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
