function [Y,Xf,Af] = PM10SantaFe20(X,~,~)
%PM10SANTAFE20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:36.
% 
% [Y] = PM10SantaFe20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;0.00341273633199099;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.1753435758197788;2.8141738472394033;1.3472750658651031;1.0859807439170526;0.37943934374476229;-1.1477307533832641;0.77684942770840537;-0.77984614739538316;1.6212631927127981;1.5630276678505013;-1.0806540441959578;2.046837849445386;-2.0635607225868084];
IW1_1 = [1.9932003461166099 -0.91241608309514921 -0.70551216009332862 0.69389638819884369 -0.89111872630432021 -0.22192241792001061;0.98140506428163499 -0.89317749419592585 -0.85148043113704008 0.070491174936017212 1.4676228702224527 1.4197286699537965;-0.75449508553703204 -2.922184272478634 -0.17085154505704234 0.31725809063803134 0.47024451565051217 0.11379847147576601;0.2170436474483996 -1.693747259041247 -0.13316057626024458 0.89658703852739952 -1.0423003352109463 -0.87344535941706303;-1.155385207422732 0.15858498715375152 -0.40380911807560416 -0.32849112725128765 1.2547883090219649 0.19660035229192377;-2.8747690584696541 -1.1470341256763972 0.071623421488272276 -0.33343347651536259 1.5973639503765804 0.75401504766785155;-1.4599026183688539 0.99285635999078559 -1.4182339779047395 0.32803910412129034 -0.50751804275292778 0.26816989630713606;-0.34333883917533176 0.15886840756270601 -0.72247548813771822 0.59773810494130741 -1.1432057398379414 0.8808775750660468;0.23767944814456876 1.7833552476923751 0.41986766794338409 0.16425044378498921 0.47834944147940606 0.76166558254006655;-0.29087626605848604 1.0082664706314242 1.8649147959605541 -0.66105219008188443 0.079893907913821741 -0.061868930414032054;0.72760262475341397 0.22412229364218778 1.1160808230317008 0.94082717601197707 -1.8141457259035099 -0.23754800772505297;4.735722523512897 -0.025715634326029121 0.012230863145320577 0.21634771186317386 -0.24486079577537589 -0.58707723831224345;-1.1289549064827129 2.3130477799281874 0.13932873914154492 -1.9097995273498849 0.004003257505651019 0.67541636648522796];

% Layer 2
b2 = [-1.69350772041972;1.3457412438862655;-0.84112135249164655;-0.88620272558193114;0.60643348671927999;0.039101828111697497;-0.18225431579459417;-0.58301367785144531;1.2275475445120776;0.81908271124071597;-0.88721600718353089;1.2491639603590534;-1.3980339701791282];
LW2_1 = [0.50872234524204774 0.29641082872485686 -0.38557079067305333 -0.27789839650280684 0.31765048312459665 0.071084891163656003 -0.3952322092622706 0.23542567608151888 -0.75939890762801998 -0.061325607587178886 0.38101488071120915 -1.0197029473320107 0.58393518724966997;0.13650365728910302 0.72487955145991079 0.29857618758401672 0.57785642505352275 0.39586791485627737 -0.10025928273912403 -0.25212650759331656 0.56377318842374347 -0.83473218984434927 0.40094316057213886 -0.88424229223024176 0.52223930479850977 -0.74764253769751943;-0.20395567710945708 1.4046973543147416 0.029618700970536593 0.41079924132174639 -0.35520218064761877 0.80889036653978463 0.44048653478873429 0.44536888534250613 -0.93943701418521686 0.75483649419282484 -0.43186838161437863 -0.72501925414017432 -0.40552935388741485;0.021577067975489014 -0.73680479475125049 -0.19758988256473961 0.49089225600704689 -0.6381455382342226 1.3917842457328728 0.45529033295874433 0.50936531472056368 0.24185044800761513 0.066372144842597153 0.31813321310474596 0.042878076626124167 -0.28724167467261907;-1.855649921219138 -0.88854727998490024 1.2875751601635159 0.091645611902209254 0.90641525863510852 -0.95474269638281117 0.52912499132451718 -0.22079612735271192 -0.27042524353251102 0.63126637513728678 0.11220508708258761 -0.41413824022753221 0.41274678904555279;1.1571512024923649 0.62958804616754616 -1.0495487702397812 0.22592311148965782 0.49249532498284548 0.077696687181854407 0.19468055451688102 0.36150642490120349 0.34161767842302732 -0.164270381979434 0.23332580315032031 -0.83823359002159459 0.32850620229702848;-1.1930520424024949 0.28905457145456676 -0.16521489594877312 0.68653365847235381 -0.36925774209317902 0.65139062594411079 -0.1634707885790746 0.10032222375458885 -0.74411052372067599 0.15139577001742469 -0.44785775125548677 0.19591184576476237 -0.27812506824679956;-0.34150152808820394 0.83663188342565553 0.506769013039709 -0.38977673032336413 0.16094572981103508 -0.68499879870585945 0.62150175592635448 -0.072852474736307599 -0.34234293709420816 -0.65170277852415759 -0.28368663877038258 -0.43406407898001442 -0.20016091476159126;-0.56436650525917198 -1.3140562395157203 -0.26599062846056953 -0.68821234239909146 -1.5406738850374619 0.063388752692636413 0.091587297506771581 -0.48896004283528205 0.39307327025546052 -1.0811731407072394 -0.71742528694323038 0.38920823773800156 -0.14920076348480971;-0.48219210780121746 0.26774847331969504 -0.76604744553511162 1.0947914288452048 0.24156217610755712 0.61371517411347587 0.64135430026340368 -0.3806091565347377 -0.62164112506336355 -1.0346590571174554 0.41958243086977887 0.056993752094594938 -0.096891207435208307;-0.11890986406500634 -0.73489297760677352 1.414553322595457 -0.38197236489190256 -0.084373132157725267 0.025186349445148165 1.0735682892256466 -0.17462067724631539 0.60200366921010329 0.53492806011159044 0.46610950544486629 0.95827281079282278 -0.60628091313925703;0.10813641710864184 -0.63222380394558875 -0.80597239483872785 0.3190360805562622 -1.0879089863069478 1.2182579410841521 0.32422113935674296 -0.007288749073173886 -0.18434149611593592 -0.63237104030801272 0.040121417871512133 0.90410836670466455 -0.34284406464530764;0.51667699276437962 0.9442631862244697 -0.56094494837170783 1.6267531375239876 -1.2725007867605245 1.6276893202870792 0.13599458109858037 0.98865620017740319 0.34860627398779653 1.6017908647036472 -1.1366998514375384 0.56387965014281172 -1.0640935462679864];

% Layer 3
b3 = -0.2374600970068271;
LW3_2 = [0.15179482637266378 -0.77019471971127851 -0.74003136370074996 -0.52825607692128962 -0.28872315550193961 0.50511868028901286 1.1116221479142661 0.52907235359913873 -0.73290606333872965 -0.32325432880438726 0.34375818564313743 0.62445943028350848 -0.33451101322974641];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
