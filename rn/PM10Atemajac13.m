function [Y,Xf,Af] = PM10Atemajac13(X,~,~)
%PM10ATEMAJAC13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:57.
% 
% [Y] = PM10Atemajac13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00968992248062015;166.666666666667;0.0561797752808989;0.00614628149969269];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.7462055547866497;2.4463075045318492;-1.6421252964081909;0.4863140339137908;3.0467210243091749;0.61361368053112386;-0.90866190080728493;-0.58595886599994895;0.014064637668888734;1.3204750195452806;1.9465146536352778;-1.7223872094283508;-2.3707915374544863;1.8475757781592483];
IW1_1 = [2.1623355872320689 0.83714431571846637 1.3020922738955625 -0.40443606385019387 -0.77506081927745596 0.52484161399461315;1.1461879765207119 -3.1240644677293283 -0.15521901681037495 -0.4822228573706 0.13790756744443938 -0.12753419321876258;0.19784427553066691 -3.8024946777275255 0.20576158352287416 -0.023148225054926308 -0.18674904519102076 -0.22932370495379226;-0.66869411618484342 0.29107888257109787 1.0558250114443368 0.35415912653508025 -0.76990620241231011 -0.37899686053180498;-0.43605148405904692 0.048691707830949935 2.8889278740538669 0.19736864083267075 0.75876032030066765 -0.1621956699155658;0.65618688467316832 0.72550819758524077 0.11735356341406053 -0.0033334607896309673 -0.96358600548030238 0.15643255818581564;0.020707746392499966 -2.8213991711601438 0.28432856822920927 -0.20176909390148276 -0.37420823292132066 -0.074184579803680956;0.82621879134896203 1.3941352916641254 1.3392762024456388 -0.71146885545910066 -2.9235375036395301 0.23603772721657343;-0.89567134828879813 -1.2820572760249904 -0.51323242841356931 -0.6373927741441745 -0.95997375494948101 0.3900832061238948;0.67424717348741625 1.2503529985123369 1.3106289092387948 0.90245990179042879 0.63450954688847727 -0.74430063689181458;0.07428273694942189 -2.4934857566040964 -1.4253591361281706 -0.27576048386846602 -1.7320008221434959 0.18596735921937044;-0.23201156080911553 -0.63640281618593941 1.2148509291783491 1.0357904243884841 -0.68756811938421558 0.11432259752169706;-2.9163819365254482 0.36493815846672267 0.96744718753860504 -0.057765914011714367 0.46783390159998112 -0.22734290682160038;-0.000814653893885681 -1.9787947961270369 0.70111792846526966 -0.46832111545156069 -2.4609453241814365 0.23833326268712615];

% Layer 2
b2 = [1.4352566538897773;-1.4306600125691205;-1.4255118698513409;1.0081260416639686;0.50612198066281033;-0.60188450761773793;0.71540754881485158;0.39267659943173305;-0.41793881816576567;0.17087571404323293;-1.0858451903393262;1.5228984110160135;1.3184883796925111;-1.8712400407283361];
LW2_1 = [0.055421722494712146 0.92372760508263463 0.32255892959246518 -0.74066096526659175 -0.54837195066764899 0.89938854962852233 -0.40999145431341855 2.5026098241028585 -0.14286104826940796 0.55051832875074702 0.96444762686477992 -0.42897442940540875 0.55135796649302293 0.23114575614680344;0.55881406495742525 -0.14965965263836337 0.7594856840703067 -0.25316240256838562 0.025007931118077011 -1.0247262985556214 -0.19147846981186903 -0.22820231245767852 -0.3532584548812755 0.24187103903866861 0.74198425271077695 0.26176319619196609 -1.6998973354135505 -0.21150757432976011;0.4278481366079836 -1.0523477737825955 1.0619690931081975 -0.45100906105912203 0.7675061597648023 0.87123234393669413 1.0761165462093605 0.40006495219710758 -0.28186728702673786 -0.4024897846084165 0.48932296160674443 0.62328476442721348 0.3257998394939583 -0.58578662637167689;-0.59642216245463886 0.0062320131181132204 -0.078613782066977667 1.0062014672357225 -0.72245705577402497 -1.2726908027921251 -0.7288312885428303 0.044475636719669684 1.026895667192786 -0.10146310650008102 -0.3365625547514583 0.21428053762212612 -0.38969532471389701 -0.489225343895412;-1.1617470873988316 -0.04862718300135839 -0.9106957607771855 0.088010295594768639 -0.44220228663243033 0.31800061506696681 0.91488679291707486 0.41773360964991524 0.21332669585858879 0.26228728908783794 -0.88478381061181388 0.40659576994891117 -0.36031568476121256 -0.18619045644395263;0.6628753838285778 0.4819710271070376 0.18610917774058822 -0.73172846423162075 -0.38615865720438181 -1.6517196588196643 -1.0669970848911798 -0.36353485821330267 0.589695061433956 0.12659269378160881 0.37931663187285958 0.83988754923238518 0.47054387015590282 0.016457484329417404;-0.26713499186645084 -0.20866876015424912 -0.4389472331917455 0.39741033784173141 -0.86520930520552963 -0.22971532923699428 0.4004098794751923 0.33348084285086788 -0.69809965242569649 -0.70959915492780745 1.251567170675929 -0.46312789871030074 -0.048882103109699322 0.68202316786405048;-0.51262497751810854 0.0084246695849078367 -0.19768197561607304 1.2746323977137821 -0.090186206487009479 -0.93137478569996268 -0.71958967477997327 0.20797374990645229 0.64473186934508975 -0.43588506555007578 0.97871350061587303 -0.91308779684172292 0.47074893644271565 -0.72467205718844507;-0.89138585685767424 -1.0350213062233338 1.5354619118371455 0.62074367129984642 -0.75478453171703086 0.049025992309223429 -0.48364029777864948 -0.42395674769498026 -0.68378030065986029 -0.39409287911363255 -1.310365948000505 -0.034871433382028499 -0.47431664828878739 -0.40208151023246258;-1.3169594446621775 -0.061976909422976977 0.67414223269673046 0.22965632772474959 -1.208744188280263 0.95383098541872768 -0.39123427712009567 0.72807187580519395 0.92546520391176412 0.86559738370805184 -1.0036059205234336 0.3811230610179141 0.023140776816051103 -0.14451084282429999;0.34312913610588514 -1.0400906859886616 -0.18726271026339439 0.85385457975086354 -0.0092165506427400422 -0.11932525463925706 0.2597876474805294 -1.0899883448253935 -1.0406403743372448 -0.72469615157720801 -0.85365153593003307 0.48289951649775692 -0.52770018762175974 -0.92411039411016593;0.34762929823468236 -0.077696960654181788 -0.77169966315976191 0.6010775588637548 -0.074978469344396337 -0.32092924634992481 -1.4032661147098164 -0.60540281042843014 0.40540242114726527 -0.61046503053674284 -0.053421934672779475 -0.63694376152778964 0.56599172392459518 0.35872365003173062;0.42228512688396441 0.14554360550803822 0.8220078590909633 -0.11512789586951644 1.0363007298178202 1.2331745340671747 -0.48017016435785859 0.62327860377216193 -0.28370435631385255 -0.13171373431034528 0.23171154384778572 -0.073661927752161044 0.92683508298461559 0.31982833967207436;0.18817149343303255 -0.84731669764823592 -0.021143392393877285 0.023329721503342615 -0.00072467755783625284 -0.0059263883197445619 -0.66778062747623235 -0.018592815981864092 0.50349832857586163 -0.32627282392561019 0.32636778449020515 0.66865391829931276 -0.16591729170812441 -1.219302725691789];

% Layer 3
b3 = -0.96628380030624517;
LW3_2 = [-0.58977723445653263 0.52086439397542061 1.586717047428059 0.69030547257427932 1.9863139252235862 0.74039092140034835 0.57140915909117906 -1.1004666021454947 0.86956059173535016 -0.84528218817220213 -1.030393997778303 0.49446278571101221 1.4762493109097494 -0.58010949696146663];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00968992248062015;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
