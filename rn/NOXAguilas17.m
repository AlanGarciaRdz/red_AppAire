function [Y,Xf,Af] = NOXAguilas17(X,~,~)
%NOXAGUILAS17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:13.
% 
% [Y] = NOXAguilas17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.91563859559306848;2.8222818766453988;-4.9645735355779825;0.94361864848605337;-0.50096677887608398;0.16782912409703135;1.2819103530022855;-0.96143924576991502;0.62189720587796726;-0.00074054767275608113;0.97123941111895995];
IW1_1 = [0.094268631409894929 0.48735837062653647 -0.19976896876127428 0.44337256526845958 0.50070594264497725 0.071194744775153973 -0.14237743434206485 -1.2035541048936285 -0.22310431080833737 -0.2035878820988106 0.022238275515233379 -0.30270595671009659;-0.69714237067101625 0.25664966659959482 0.23023512081881153 3.0775340003884448 1.0576083745016218 -0.63119306618203519 -0.18727146087085131 0.23384203373780613 -0.0068209637784974672 -0.091241966926536064 0.083530436662919372 0.13602242605826187;4.1933674844440549 1.5730561806159558 1.2235709530128196 -2.2875288979191213 0.64089494439060979 0.037270660801999728 0.039101355038186875 -2.7659371313951162 0.46281828483219145 -0.44681416361717291 0.93661286488202078 -1.0286041434751303;-0.3121820648152176 -0.81192545100560254 -0.22735678946155821 0.56550149318421106 0.10466250435613368 0.43931988290778357 0.19877344536404759 0.023098486824291352 0.013513741811447067 0.11437769353588506 -0.23205431812435193 0.015164154658088954;-0.15703872528508139 3.0110238680982766 -0.058142998628217119 -0.053717083393464669 0.19001385426245387 0.010098978563912842 0.21110396460961353 0.041051675215077549 -0.25349239416843095 -0.011316956541880818 0.11387972625659906 0.60767209762004903;0.75292226581668797 -0.90375413653314585 0.73100562455672768 1.8726751821913643 0.19722120562351594 -2.0873635305325839 -0.036544975236290939 -0.052295283300940618 -0.72357750693434142 -0.3453572187493551 -0.66301031961591916 0.46626611715635313;-2.1635312239438025 1.7314819100809156 -0.80161350806595977 0.72966990242283425 0.20890056587359779 1.323455191413256 0.34169410000283101 1.1248471714863575 0.78597287291392526 -0.10937069088519866 0.87235470787126612 -0.074164096165812432;-1.0830004012736605 1.3451345860328279 -0.7810841434654342 0.12939542924587541 -0.16323416928184314 -0.22084925328197413 0.020324897479587403 -2.2329203665228312 -0.67640891873681541 -0.46163702715215715 -0.21998263611982113 -0.65555418609306682;1.1337304138359425 0.6098648371672647 0.23726690701797043 0.18040665612995901 0.1617362884426547 -0.20566699362147731 -0.24921506266473609 -0.14909247492863156 0.11962081638783148 0.017552304047390346 0.1803694339551303 -0.21022375086337231;-0.34328038384629578 -0.56939826995972398 0.65496306231253498 -0.32635098388885464 0.33201205114853144 0.76018852878638732 -0.65797063162176206 2.0944573813824716 0.31735877977403237 0.2280969712389897 0.62553120292754838 1.488903848807186;-0.0050112156834837126 -5.7976278359279121 0.35377224528762768 -0.25310264328233462 -0.3539339657171286 -0.098227807264047645 -0.077415299686210651 -0.0097383250778355097 0.13841669920275093 -0.012902399607792457 -0.25267817651294489 0.15428123117538872];

% Layer 2
b2 = [3.7203336714271695;1.8552354064405177;-1.8281808676382882;-0.036647023994025467;-2.7385074203721151;1.212202002968352;0.77173069726942189;2.348240894021933;-0.051732567481359397;1.665864330813833;-1.8913404437556138];
LW2_1 = [-1.9211583278569559 0.15068124958257087 -1.2017759999125839 0.2482433431389488 -1.0869424840206099 -1.0230308898540263 0.76997151218553384 0.25402755066974514 -1.1573551719535897 -2.2615175794302083 -2.1559676799326781;-1.9910136891673453 -0.80800751912371482 2.3904843586587159 3.9472220880321927 -2.3025779812226763 -0.71952821013697943 -0.64160758685643171 1.8679215935756279 1.4183113825799618 1.2558369804263894 -1.2753291863339524;0.65491393430681344 0.90366048271894994 0.91879150718744029 0.31152686184653289 0.24947905108393326 -1.1137681091822871 0.91614371558504204 1.5541399966869611 -2.0075953113561837 2.6293628077183198 -0.41135295753323764;1.545818165984872 0.35148371338491602 -1.7338488435492316 -2.152935119121036 0.76773040769192802 -0.25165184685949449 0.077628408049145392 -0.4208290105609741 -1.9289127189247104 -0.4771004194246054 0.93126611737173248;-1.7466929361267758 -3.741663577097782 -0.17396976670027717 -6.4527153457539663 -2.1999769521660237 -0.43767333075736004 -0.51914366704954606 0.90066091634951906 -4.0229770208947482 1.7875828761445325 -1.1994514179878915;-0.60335914069355034 -0.75135067194718408 -0.15572047754275303 -0.35317647443289274 -0.015173454659333577 0.93566840598047829 0.08711953782047982 -1.1822331065787999 1.7020298553330591 -2.3798601425657018 0.56655186204407082;4.6578708976485759 0.78369412547525463 -1.5186157040350596 -2.4837967191816959 1.6160517364438103 -1.356341212107868 -2.5930477027098053 -3.6925846292065314 -3.4951354477125629 -3.6724459201634718 0.61937320971277199;-0.052100892432860119 -0.18008951968078599 -0.41553884819440096 0.20767540660250239 -1.3241636551985918 0.77603331358794658 -0.22431957342877551 -0.23197399941892749 3.0767618443949725 0.92447595642604519 1.3524570205366928;1.8215940894560929 0.345802698177542 -1.79920930067455 -2.1674157835573316 0.47099977572649365 -0.27183285913607408 0.093054309837701327 -0.39201528861105917 -2.1165881664116126 -0.508608564087496 0.72973736520969745;1.4661268340603233 -1.3994110015339152 0.06092489027735698 2.1362042353410131 2.6823981052789669 1.3560660980395687 1.7656945310575733 -1.1643552479451049 0.76294070458768071 -1.0609847143597331 1.7046584158102014;-0.97344745670504362 0.089503329703204251 1.3961367022482796 -1.1454642338169079 -0.48322126688775147 1.2244879961662785 1.0602104724490773 0.5829540161390554 1.4122656411461827 1.1861378116383885 1.5277202110438772];

% Layer 3
b3 = 0.91735627021128052;
LW3_2 = [-2.3833729617646831 -0.10516761708766741 -1.7469034716237399 -1.778389056881732 -4.2622948121835105 -2.2244896966348855 -3.5478673433313461 0.11624895374835906 1.6441541044837853 -1.7202378493524519 -2.0306942145516595];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
