function [Y,Xf,Af] = O3centro2(X,~,~)
%O3CENTRO2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:37.
% 
% [Y] = O3centro2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.281968137600451;3.74531835205992;45.4545454545455;15.748031496063];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-3.1692268920375843;-3.0172246534493574;0.10911160794911264;-0.19837609941842599;-0.98945620812460078;-0.33967452599257264;0.32965320955696781;-2.154610512451534;-2.3191192665992477;-2.051513914325175;0.25010314454530586;0.42431574125253885];
  IW1_1 = [0.069631077692780818 0.20036255971879874 -0.12172420004636963 1.1214109848866189 0.26573977444945784 1.15580442711988;0.012265989999463572 0.40707016958023995 -0.60371613033444538 -0.35547603826516239 0.46329496578549195 -0.6540044866854583;-0.33082898715544545 1.6913058511442318 -0.01872703741098871 -0.56303831635170509 -0.40012868852490852 -0.52175206398050966;0.25783090994593577 0.39994637627527496 -0.12449349998306039 0.0040516133236874821 0.1270240368076645 1.6214372047912589;3.4962960540032046 -0.37572815404045873 0.13240507929575526 -0.91124449250590989 0.23222737074075045 -0.3982749948932307;-1.300088819486505 -0.5987803546086462 0.50541801354952398 1.0059560193456552 0.16177666447078062 -1.8497726602716955;-0.38383348830521158 1.3162493086580564 0.48171085604324088 0.67443468923130578 -0.7875896909474549 -0.016777060634003072;-1.6129496145623561 1.1275097679932811 0.15221840576100035 0.430842556162224 -0.35101761402627729 -1.1380742394477996;-0.84346529789751845 -0.28311569680268694 -0.39484714277651328 -1.6920143563289711 0.11278557338801073 1.4892672123213255;0.6607866054469691 0.75413280642795311 0.1971543971160355 0.3216997353813883 -0.27502568997296722 -1.4570649018849195;0.82486850199243678 -0.40621380073890706 0.16113082071240373 0.79606222682109695 0.042119686705481732 -1.8465150380642201;1.0778771930975379 -0.037260416277125924 0.15500100528614216 0.17312008644869431 0.0092395375951729117 0.15070808583500248];
  
  % Layer 2
  b2 = [2.1729463790095447;-0.95691685780853752;-1.3109883554180899;1.2478551708590997;0.78235886979220026;-2.1058758608104799;-0.61667806902433209;-0.42541569623692249;-1.1527508140142828;-1.2833064473297657;0.084243546561014349;-1.6729552872667766];
  LW2_1 = [-0.83199811596307671 -0.35483309243297223 -2.7927636907569617 1.2258391715111105 -0.17220618987087802 -0.46684890733706108 1.865678738586507 -0.32975858871898428 0.16684592862517605 1.047138901314518 1.0212674009159457 -1.0649000843638952;0.030505825263571131 -0.7232523813156565 0.55927279784443484 1.6984794962988643 -0.40073129208972857 0.24899781385334913 0.095592368715801346 -0.67100010335285665 0.080356984998385367 1.4316509235465522 -0.53194526599148606 -1.4660791699477718;0.9030603354545369 0.22870918621937075 -0.42839924282630981 0.81953041917808245 -0.9636250188580463 -0.87573297963336127 -1.6020260923708485 0.040175791894842841 -0.45840902264845779 0.89616989581192685 0.015386653064256838 1.4838405428756476;-1.3555453826439012 -0.46362088249985112 -1.364497428171352 -1.4910783793977127 0.24908245932299797 -0.5263092998286919 0.28974701758990667 0.7379898333540067 -0.45717545566128109 0.17607586863081137 1.4279186273034148 0.78295796487790692;-0.67635692605463893 -0.18758989986778965 -1.9612350037083528 0.7234829502441783 -2.5964407751249818 0.31290513941312686 -1.7008004011780506 0.90768921820057746 0.74615424331017122 1.1566286300398274 -0.18330949797644211 1.5063226065426687;2.5872901280022562 1.147664472247319 0.40251281036469216 0.64501892012962059 -0.7809495575589861 -1.9060384459890236 -2.0988148202871355 2.107061968367105 -1.9328809142503203 -1.8744333793747201 -0.58996099436296245 1.9680549916829104;-0.41552950168681957 1.2627614797228666 -0.66160691126311466 0.5197414362406122 0.49277012395482001 -0.20703452142530901 0.15119617906158425 -1.4682465788578365 -1.532177590961852 1.7630248881372057 0.038722502865943871 -0.4239969404776614;-0.14078947584591062 -0.67875377270381509 -0.46815213054281318 0.043840998542945681 0.8636474345416012 0.39043078634046902 0.27815349945547774 -0.57064222340247028 -1.6231524409465015 1.1639078412360562 -0.72757387446010502 -1.7723199735319553;0.23918008811423852 0.32614905454340742 -0.51766618913107831 2.0678158966115259 0.19203453093846837 -0.76501761549481018 -0.17249901596063782 0.39213682124141369 -2.4522150267808582 1.0611902361142422 1.3419052968979595 1.6764758495627277;-0.082558260788020629 0.81945040837741745 2.4350852321201502 -0.90021754481395411 -0.14911619769752232 0.014872357825686341 -1.6703111020611463 0.51823331591204624 1.0603212796927106 -0.89421573774281782 -0.26656182487716273 0.96931677237537861;-1.8379289750662133 -0.82325304925429699 0.65477669486412182 0.20101731935507142 0.97268297580803142 -1.7595451921239547 -0.71053214744780724 0.39904512150152771 1.3795618788212367 -0.40421873489866861 2.3159509259603372 2.7950722434131747;0.054532446201881621 -0.6552449841596063 -0.94844980655649769 1.7960754799724168 -1.41190185583983 2.0524942504605068 0.77981234218134909 -0.27655957704664219 -1.6996276971555251 0.065966915778948643 -2.4965264781527003 -2.3218239301869934];
  
  % Layer 3
  b3 = -0.51943182271067134;
  LW3_2 = [-1.7245290822361292 2.0511530650748528 -3.3736812859260854 2.1015107090749132 0.15660619167516399 2.374454668736484 1.4466110306187598 -2.2774499179263938 -1.0511073650400122 -2.1946015964229497 -1.0004830603139208 -0.80392349102026051];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 15.748031496063;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
