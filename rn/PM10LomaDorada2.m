function [Y,Xf,Af] = PM10LomaDorada2(X,~,~)
%PM10LOMADORADA2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:08.
% 
% [Y] = PM10LomaDorada2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [5.1511142724317418;-1.7463700102250443;1.671786667021298;-1.5358769365852973;2.008359703079821;3.7168316312467318;2.1670036635239485;-0.64023997986069892;-0.069378870508132004;-0.70418888390009859;-3.0789620189723479;-2.1163440446050799;0.61555368139421895;0.63340052362553056;-1.4735768333625685];
IW1_1 = [-5.6024623337296164 0.76886813853083447 -0.94322485059883143 2.3345826459693662 -0.55655556056677224 -1.9582423925308456 -0.81184784080398742;0.17616032172552659 0.19106875648597449 0.57354995225953231 2.2324037747902552 -1.2470547822469928 2.2005251361205511 -3.8666493456304738;0.3073130615406317 -0.41980711054307496 0.024394941052515967 1.241678637631906 -0.18902525287071523 -0.61984249428786198 1.3060453433995205;0.057397657126297325 4.1591191309804803 0.14884247187163452 1.1031557055644494 -0.30498219818724831 0.86744999490002317 -0.73539038228660247;1.194682180100278 -0.35721270217063317 -0.32395314166650324 -1.8489700291212714 -0.2744756691104992 1.4173928272687504 2.3925229349940222;0.25151058573303831 6.5197894575465192 -0.84234557941414701 -0.16389900017843684 0.87500449758264631 2.5634659156615185 -1.8286884383082604;0.36846933288429862 0.1905117429685915 0.80616635120270685 -0.1639013770170667 0.95667221481847675 0.44925921807319447 -0.19545022987431307;0.42084974015939669 1.2504370835475915 0.74019231086258463 0.78734276197139852 -0.24716125891396667 -1.2367545625524934 0.018255489468649976;0.74721330571279665 -0.81808305184517505 0.55168812087126806 1.1883637900562241 0.51345243325272627 -0.15705210702710165 -0.34380217164710519;0.64861678326527039 0.21381045870991575 -0.084427899199255807 -0.23912040536069532 1.6728065818257247 0.52802958411534806 -3.3995482514635937;0.37777945582071226 1.5051086294545755 -4.1001769981162184 1.6887733252512125 -0.93656816268900223 -1.6656986413072137 0.92436025895928497;-0.5203822127334552 -2.1897799741120423 -1.2342580165881885 0.45730342222232195 0.55063859726002118 -1.7922291683930238 -0.024978323338612128;0.82796425992177147 -1.134622241827097 0.17503539010393987 -1.0940647198620252 0.128360696245815 0.73404011961876359 -0.48725487240369664;1.4238307176024732 0.23410429917239836 2.576898932389323 -0.27749142204315314 -1.5335469655405645 -1.2573621395634482 2.6950615538640523;-2.386872836350864 0.72202674056503413 0.98835260333354402 -2.8739376149523164 2.0815180423617323 -0.60620649563103124 0.92649351498426813];

% Layer 2
b2 = [1.4270514385422117;-2.2816124545792915;-0.55377294809412092;0.55580190638217264;0.0043432222059293646;-1.7880822410301187;0.036810304255298631;-0.41031827503477664;-0.15601398130186542;-1.14300933714122;-1.2186238586741422;-0.74437019282931505;-1.4365645279918051;-3.2795584433375922;1.2376351105476004];
LW2_1 = [0.92473517284589779 1.7985492241649332 1.3442722218652772 -1.5766750402741856 -1.2070360055805054 -0.53782883549530547 -1.3218371077065205 1.6424236077258796 -0.62142646926594924 -0.022372693592606643 1.3955094834740673 1.6567351679007252 -0.78244489240229453 0.24497986433277802 1.7155989145297246;0.92402976320974395 0.3416519580193661 0.34703631539417218 0.53845702793356232 0.27879061945925904 -0.60012200222505652 -1.5139919840989757 0.65912895126826043 1.0887384233770412 -0.91484032824922301 1.1244621862186508 -0.61255748442391489 1.2017511959325686 -0.68372900678190995 -0.42593068646841598;-0.48009013235062281 -0.095396154748051784 0.19344874631840292 0.6559655727743825 -0.79743791854186208 0.39357895693259182 1.6820806623601672 -0.68595286794949351 -1.2168911185862676 -1.0774936357648421 0.2761523308579627 -0.21088937601186136 0.32823449755845902 0.21434544833752245 0.1073343136891481;1.3943225222111084 1.5805842330789512 -3.1831909508920551 -0.50298193875578967 -0.95461772614062368 0.78610268795696803 2.3949938283454428 1.6979230762408661 0.055022353630019304 -0.39311089031646929 -1.2871476710294658 0.96537296918688309 2.0820112676157261 0.58533294721536322 1.2618678300965442;-1.9492695522321668 0.12876529339561341 0.83957689444743633 -1.4187899030320259 -0.58481450662712453 -0.31690668280808187 1.7839703992817586 1.1907962820940028 -0.44274981866405871 -0.70023943300675229 -1.110538148341595 -0.64746034423160126 -0.5786314663121721 -0.39994153192171344 -0.97739930020403343;1.4524774554978772 -1.8551914020272495 0.70519100777423183 0.86696872575261907 0.93911941657798315 0.88413721089349828 -0.26446989405234195 2.5464177539123485 1.1908942868806096 1.2185697145313577 0.6002397869212418 0.94657259041424047 0.66551484421435347 0.79491545964599097 -1.6793443427332297;2.4953272682599459 2.2790421999763715 0.90896215022690419 2.0432180760858882 -0.62607572826389202 -0.40748306044650751 -0.99022044192797887 0.30269883310269591 4.5081790581427521 0.35072711230217501 -0.14533138982876881 -1.6535823992560754 -0.38155594189848607 -1.9862047355206431 0.69498445601782766;-0.48268908048372261 -1.7678035226681947 -0.11826904049064751 -1.1897768155694741 0.72196201712843711 -1.8757940814770375 -0.13946284249174606 0.53251782207971754 -3.6783951593787587 0.11949920437989139 0.015714580884397575 0.43337835330209545 1.016948468827195 0.59577176556724998 -0.069499979300629677;-0.26074742541210572 -1.4123415588437398 0.61310199320820125 0.74958725529162562 0.85871449445038539 0.8566613994731519 0.040097600950344647 2.6994028214865189 0.91844096097276817 0.93184641781846211 0.5694695329441789 0.97325134848679862 1.0994568145433623 0.54435026287201649 -1.3961574879952823;-0.74089133420848574 4.0629850168337454 -0.7239650155604398 0.45152104709627666 0.22512189383218045 0.039779922991167588 0.72727595632383202 0.71003487599759973 -2.6459245091976382 -1.079580585655203 -4.0217485855271775 -0.89470849100331495 1.2493810454080216 -1.4189071249247871 -1.4153588931663321;-1.5958489220423921 -0.0025338829098092291 1.106138996589703 0.54001021004240024 3.2305032292903872 -0.60439817434810206 1.1069564064561279 1.0057972012876146 0.20497229667923877 1.4852614201231373 -0.1390485188175431 -0.056131607925290816 0.62490648504844237 0.78128060585135561 2.2033442749161134;0.90613409519250121 -0.71057635184936652 2.2886324239967402 -0.86977925684850776 -0.91500954073013119 -0.50905326715261834 -1.3045199314755662 0.48552477603924532 1.536764371943999 -0.037096714980788911 -0.5963558289159222 -1.8890795798380973 2.0076289975436117 -0.96808741069446003 0.31428123762720489;2.857974106573884 -0.33302043081130772 1.0972260737350579 1.0724575483815677 -1.1163945110518427 -0.85463275105712866 1.0976780331511546 -2.2426317823497 2.0239592108560234 -0.77436759721243087 0.90934920995336066 -0.33422028805021931 0.65051420845422692 -0.39572783610165113 0.72337287687106511;-0.17305337888878089 0.92054617078939416 1.2090378137866904 -0.021120193363484821 -0.7025948903847663 -0.68837132608035434 -0.49302950556232106 -0.34236110639238498 3.1244053962009128 -2.0946533786713353 0.060969682313465348 -2.7767901270051429 1.2927710436375519 -2.7760022693513799 1.5382757553374868;0.54948095836190214 1.374076908222116 -2.8454373577627874 0.46712324633251712 4.1880769345610203 -2.5394741187103831 -1.2192614435899967 -0.53338373191269572 2.3557252719724868 1.0260042067391457 0.46387752240693453 -2.1858143930692542 -0.4068062453709414 1.8769164584657128 1.6589829370887941];

% Layer 3
b3 = 0.79698025224045754;
LW3_2 = [-0.15261981550158082 1.1796002188460573 0.19993650251374537 0.068739198250150291 -0.14272057157943185 -1.1663232295736177 -0.21081221780900616 -0.24127340397213151 1.3569038306705976 0.068057198578514888 0.13930408312441175 0.16826324037650164 0.24408733956472509 0.75570043266036402 -0.14932520805601085];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
