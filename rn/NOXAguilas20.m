function [Y,Xf,Af] = NOXAguilas20(X,~,~)
%NOXAGUILAS20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:14.
% 
% [Y] = NOXAguilas20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.8005952392032452;-1.0640938633003918;-0.87141499084569507;-1.1106586770114164;1.8632695657714011;-1.8761953817592505;-0.22797338022144295;-1.4571182483193093;-0.78392026600029774;-0.67071454309705103;-1.744579472722479;-2.0662227381754863;0.92821375882425528;4.1881754498345156];
IW1_1 = [-0.73487125781482499 -1.1270030113512755 -2.0457644086525386 0.25805251642889898 1.4820163339999253 0.18907521466931768 0.34862963317096907 -0.72419333064767277 -0.61014386145077792 0.6863181209804301 0.34872332958577001 -1.0083542859020436;-0.0043356379667391903 -0.46467501115641402 0.76104751978902818 -0.36145480840023114 0.71180793975463585 0.57867763110262704 -1.7259534581867115 -0.60644619575826719 0.52941519730899045 0.35472516789223307 -1.3895779538002944 0.72674456760935802;-0.94953956056102662 -2.383007567143558 0.58581239505334493 -0.09782845702315951 -0.36369177988986162 -0.41599812844307477 -0.15015603998421403 -0.036301361098856101 0.019791084324433661 -0.50968235578035948 0.6742290539449054 -0.62402888794924838;1.494065531708471 -1.0037223899919256 0.73265761452306888 -0.81276082544975325 -0.46382167081410963 -0.057324183170120148 0.16565722256182569 0.97989607821213343 0.21740609547172085 -0.095119531453239453 0.035627627856535178 -0.19667761745441342;-0.81928608321346552 0.60912334722363703 -0.91994147593327136 1.1835676848453864 0.52195861612108119 -0.24197833663853177 0.1249488947063165 -1.6700813433837276 -0.43212743653171437 -0.26328350345079388 0.55263502890635996 0.17794789741951175;-0.34980259296202276 -1.441067054320623 1.0805738344121663 -0.12683938663960814 -1.1936193116480203 0.18640834778983753 -0.36278672248016902 -0.06381928740963029 -0.037302482155744568 0.74843261590267274 -0.79508014777890812 -0.17218089915124801;0.49425616149074253 -1.5926737340052652 -0.25303496194336339 0.13683766233885838 0.21265795414867081 0.82351391635692017 -1.2409522874262418 -1.001111570164583 0.54730029936210045 -0.040552368178587511 -0.09181507164930551 -0.30328289048325929;-1.3547616475065141 -0.62793802237204177 0.13071655999621018 -1.6631104237140277 0.33208559842239882 0.21915752809481212 0.27004067399182941 0.27276626540350818 -0.54441477608481048 -0.28506999220817603 0.64748936571380677 0.4147648256590391;0.93198641799969573 1.1169674926407773 -0.85499580701046052 0.059575577217699752 1.0357245764670144 0.48011170447534174 0.49091295128878704 -2.4561814881312629 0.11124290517602539 0.32029420999584529 -0.36579247623182715 0.41628720371158112;-0.089674731430306229 2.797039470027574 0.60481998010788462 -0.55879787578321305 -0.37296892155225647 0.2655457763618983 -0.44891209386482051 0.0080829779272981826 0.22629481260444539 0.10043296223471955 -0.51619666496911565 0.14471781714184179;-1.8128265550525575 -0.44388548571413616 -0.30962443856509014 -1.6950918291250201 0.50980128562013449 0.17138543235422454 0.38617848347202793 -0.007368261228951763 -0.62047083397524194 -0.034654584180879654 0.62341036919464599 0.16197204775491716;-0.1347157487691793 -1.9466171113231352 1.0911483931015062 -0.15189700359525207 0.15814611810588497 -0.47689116698003425 -0.62140383821119971 1.1823911457426681 0.76219302475421491 0.10769210971611776 0.091037002088894758 -1.0450262302049538;1.3824907490555698 -0.33740760884876292 0.51935616579369059 -0.11852486001569154 -0.051970250163630896 0.25435123290418271 -0.073150905427597349 0.32617729538258045 0.27305895224584692 -0.096196716355024581 -0.16634504068761166 -0.018359532316956962;0.98437111384004039 0.45781718711484576 0.0220344569164104 2.8810080452378148 0.67751487440603697 0.6093105894363493 -0.38566870369119383 -0.21976380186389893 0.8806081014382986 0.17893746828380033 -0.48262360644804164 -0.68329020159828768];

% Layer 2
b2 = [1.1671227692863766;0.82476485038862923;-1.0994002630956192;1.8566822995809524;0.83430038990369793;-0.41644205199539563;-0.16979690823725641;-0.14161893335197123;-1.520421906261032;-0.34553129743827077;1.8306959912094911;1.9718589016346419;-0.37312151157535023;1.504770206057682];
LW2_1 = [-0.073990534766204291 -0.33415284564794712 -0.5653168911359554 -0.22180440973505969 0.040249009262161323 0.38553180559050643 0.40540265038559714 -0.02933113834484237 0.26199760147899842 -0.60095488019578791 -0.056189385920102114 -0.6966394592026488 -0.57042596548258573 -0.43229076347279111;-0.35235438550706472 0.62444038522825418 0.81295739589495264 -0.36467527095317653 -0.6843247632120234 1.4343992958561005 0.72826494156034316 -0.54464158170053423 -0.79646470821713833 -1.6310964778306472 1.7823235247896787 -0.75647703201648275 1.2507897169245359 0.57906552200662265;0.17257960543722831 -0.077102892261215902 0.85221736924842262 0.39887620311229149 0.14669124149667029 -0.39856649986274589 -0.40431440994208351 -0.54731093614124893 -0.30601374792968239 0.89061577540952885 0.16163264745528927 0.53191511209652531 1.2728805565572689 -0.76088201043547343;0.059503384644369439 -0.88884020862249025 -1.4368557932517891 -1.5383003464517742 -0.93918252017376425 0.065400608363434892 0.20718425829478665 -0.71531112415457243 0.92922875576631991 -1.4906184207028446 0.084626467913839959 -0.16057206973039498 1.2275989848679281 -1.1648739830014796;0.0088414180440228585 -0.42019679893071421 -0.64365372033628543 -0.42467159951619887 0.44030499688471797 0.10796772819925014 -0.38527441113029071 0.58236126083574724 0.65372043672416147 -0.40571166538203124 -0.75274141505205316 0.47099929576306793 0.073420380669865143 0.76198431197305738;-0.38682342267100034 -0.38666369916492205 -0.2482227738533522 -0.060549748826627697 -0.085792675475315439 -0.62776891708347671 0.20593698634782653 -0.83642623913759018 -0.085911473560246018 0.49709903772542896 -0.30615015454454886 -0.40890307383824115 0.12293617300586233 -0.72281341246373099;0.098933908784483632 0.50358829133955496 0.78842034253966853 1.1349372985211772 0.11951141853823041 0.085329402089917183 0.16396633167241648 -0.19316735333330992 -0.31053986806910838 0.35780913064922337 0.80566550536783754 -0.17668370435628289 -0.51518885762809385 0.001991616230589922;-0.22104406216702568 0.58030401934203002 -0.15972904221432557 -0.30959608892518126 -0.81791999640957402 0.41792465415690339 0.57853336643387565 -1.1735385232735338 -1.633210020236185 -2.1837843343404222 -0.22714758348933708 -0.50164690999649786 -0.39651684155884503 -1.4399494903991812;0.23614779090339616 0.58910782312148846 -0.44481908855892077 0.29403144881464038 0.89655415188936516 -0.44666032115405119 1.1968345449320203 0.91413271833453957 0.94562194080220818 -0.043592367443541301 0.32994421153101955 1.2816961583141571 -0.36791279031085272 -0.068801565317016963;-0.24379792853305957 0.11747011680006839 -0.0062444874826164658 -0.27097337247027548 0.65526768269879077 -1.2897208981816219 -0.65996930539413878 0.60299526718064311 0.88659472753183954 0.95894696316271355 -0.52754132694159761 1.6748678134142632 -1.6225656876301731 0.96895193784110234;-0.067876024381266803 0.1522103473435131 -0.49615608292588032 -0.03978949081198873 -0.51462527381497714 0.081241216994146201 0.36403437918397658 0.14052732161777204 -0.013290909709956987 -0.58417356046734659 1.7982080726807397 -0.43735492679294541 -1.1321838000677402 2.3449626254225664;0.44536987319501131 -1.2775523966292162 -1.8079821007446957 -0.1972263896251486 -0.66100333486897012 0.2505276749446696 0.38868525557814615 -0.9602054274046804 0.51651863383928664 -1.2604772461455813 0.20203274917785677 -0.94183433249442539 2.2950926988142841 -1.7074197133122893;-0.07731605534865417 0.82597978668996408 1.6324340895458622 0.50544011441082748 -0.22052994650451535 -0.018046162866011638 -0.14377190680353838 0.050385542018561338 0.89805152137675515 0.75673957925149937 1.1523948044233543 0.39214874388974075 -0.54138592198070445 0.79278017038766635;0.13959368934026467 0.16638546719509328 0.31040831375558148 0.31962884760215327 -0.35070892027975298 1.2745346326684073 1.0267386323895256 1.5339501189733222 -1.4875295956100896 -1.623575077532843 -0.72321615150579099 -0.17516760858107319 -0.45967441336037268 0.50480970420946536];

% Layer 3
b3 = -0.59829584557279525;
LW3_2 = [-1.0240687453919928 -1.8207936275515406 -1.0590563169239684 1.4266468334569724 0.97069071421496167 0.34152963076147586 1.3948038253410551 -0.91433397281203299 0.5302631405198851 -0.31393273022199125 -1.8988646947105106 -0.60778843264118587 -1.3035106876211839 2.5084834672657506];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
