function [Y,Xf,Af] = SOXTlaquepaque3(X,~,~)
%SOXTLAQUEPAQUE3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:53.
% 
% [Y] = SOXTlaquepaque3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;3.03490136570561;14.7058823529412;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;35.0877192982456;117.647058823529;27.7777777777778;5.12820512820513];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.8699180714901293;1.5399647667358767;0.0095625332463278728;1.1703418977519646;1.5680813115679741;-0.40921001648842192;0.13818992875107317;0.093931896964189687;0.57531568831587676;1.4550791891236874;-0.95752693102122766;-1.2905270182141697;1.4940881209626486;3.265792912470733];
IW1_1 = [1.6115037608920599 -0.28304424977550835 -0.58417519377597571 -1.0296118115790869 -0.037770851606628325 0.82198534929939737 1.2138042631201944 -0.68328497492689977 -0.41697446189660248 0.31890120165548641 0.72328620708220104 0.44058539108688016 0.15978125508325464 -0.15000875025883503 0.45058116840053675;-0.64474418278286449 0.21319325672919409 -0.021301946931014337 0.3534292478994292 -0.32224892527683213 1.0435224138296597 -0.27275474428315022 -1.1295286190075549 0.53413993404813331 0.024359800921859503 -0.33770259716812706 0.27782824340652612 -0.49441813330532974 -0.10322886233806371 0.2734428101199583;-0.65017819270376753 -1.12648305740671 0.19039535174308209 -0.048481484233354501 -0.78454168391557932 0.11407118126694508 1.0275426013993429 -1.0433491939008011 1.5415864992751633 -0.03016974404371239 0.21499361206886475 -0.64373141097706155 -0.40556845321017776 1.2501743019557883 0.22885666142826572;0.027686160328391787 -1.7188438695233259 -0.70727434359947405 0.088745543572146535 -0.13466304110648286 2.0047106746649352 -0.56466318477402544 0.25474857312028154 -1.1091577642430894 -0.5100471446161331 -0.62222304494734526 1.0791013674311023 -0.29241094395710937 0.4902735508679017 -1.12180392359318;-1.4850945699587965 0.58241361678709103 -0.26685268183519301 0.36427423131712583 -0.35683730965680599 1.0182010460799686 -0.18079650784937937 0.87118308766055907 -0.67498974608002138 0.31525344125539961 0.023036067593333424 -1.0392043347997266 -0.16058118479688319 -0.77481952952925859 0.67780617190365022;-0.76950615367956743 1.6663510424446071 -0.78175862322377221 0.12253477888642247 -0.42358599045223155 0.0056651785010515474 -0.30640687596948768 0.81676943924282119 0.33865837990724057 0.054698885791680391 -0.53650996862747591 1.017665868721888 -0.38555043360552194 0.23091719275860595 -0.14165251233286594;0.90526043127566225 0.80694479831247701 0.47286108153041784 -0.66963496688449986 1.5291059513482681 0.17070840848883551 0.81405696430806307 0.45951120596924466 0.94542941506407208 -0.18331517695847016 0.63649726855553956 0.61093103019611406 1.318500948174508 -0.62765753297639293 -0.7750999388153974;-0.2525434761922204 0.39873944000020617 -0.49232829313713627 -0.47930743256646124 -0.78066530281604429 -0.030391589732680836 0.29252048870011277 -0.21040277769105903 -0.49157366600682123 0.40688948524750362 -0.36613925091418442 -0.64027737180023769 -0.7123740222206224 -0.51019223181204809 -0.55709602579085371;-0.49074291707108758 -1.0367666557340742 1.2054259306047346 0.79442587705418555 0.12203182618023398 0.20338184438095752 0.093107205187556524 -1.13004484842116 1.7573660355890641 -0.62015956567354769 0.0041960208244054848 0.4002046880018974 0.74224763637703028 -0.40782331231318092 0.56977351402357079;0.14151732774788486 -0.13535524475265678 -0.26509920814885174 0.20457866027664234 -0.33414450442257992 0.048637528249457739 -0.45134305044585882 -0.14179563657444266 -0.46808963937447406 0.30321131469163592 -0.059169438301978267 3.1072279125548405 0.20600097284513907 -0.53603977548664716 -0.23648613746414984;-0.33403298946257765 -0.44460966672339636 0.23790615338601481 -0.61971615832168547 0.34665712917564051 0.79680882964620037 0.0012044986405817387 -0.26190689639071968 -0.12337252243781308 0.12405329099709057 -0.22281423241566206 -0.11927792770250699 0.24626907831097589 -0.69272064135501865 0.52815272650277423;-0.60703184597302495 0.71450415045956683 0.17376563359822822 -0.19463148116549561 0.64903987433642196 0.18872856343019742 -0.30041052402037893 0.41780791513596222 0.4582908828653891 -0.64227511569748741 0.0167685618185274 -0.14540678008154584 -0.24309231997683681 0.32830923792702454 -0.59437370940542311;-0.63880349013204529 -0.077110956598624394 0.17026245805839213 -0.21013521904168139 -0.024810051096339991 0.46977417099260405 -0.31983783806293148 0.19521361113487679 0.26763101178616322 -0.69008460540677119 1.0431476937301092 -0.50381815029891275 -1.1710559608529514 0.25138214567790224 -0.64769849414911773;-0.14055107410770623 0.0052628956265953764 0.21295564346871523 -0.2354790374782498 0.25742018155915491 -0.0045355687415895816 0.47967276785582824 0.041705409423659683 0.51245699856811577 -0.24964979869082887 0.054356504610738481 1.7453051911496806 -0.10743076003814372 0.43781946429732377 0.29670138476404129];

% Layer 2
b2 = [1.9263505797954437;1.6928674452733854;1.1518565030414545;-0.9645352667430056;0.93791442968415117;-0.86025537253112005;-0.065162889630932516;0.3670738222803282;-0.51397684036876323;-0.54823004506286077;-1.3340293384542838;1.4381571391760535;-2.3199115626453466;2.0188295752915879];
LW2_1 = [-0.054730447729468432 0.75713803883935149 0.70681277611779314 0.26160612276826234 -0.34280339017907857 0.38796297437271898 0.15781908532570271 -0.0080027202482688738 -0.14974770915822799 0.81354280404648827 -0.61048624751371638 0.3752845891100986 -0.22147824550909709 0.32738491188012692;-0.3369949994243282 -0.5983357072352421 0.1769479997299887 0.1627239640477264 1.8632845844173733 -0.75053353622811325 0.19515401800277576 -0.54146175281948539 -0.23013303192198081 -0.33531980521640609 0.2291086722756224 -0.74382498256190699 0.049360439596907599 0.25347974371174398;-0.22016754262494759 -0.44726730905528872 0.031473666368585708 0.098141828961980565 0.33559194235624656 0.49360394681899417 0.47891864246180671 0.83018012482603032 0.032767390863985273 2.1488954170445274 -0.0041212005851657893 -0.36392158684421771 0.34451251051578563 2.2027424746577671;-0.083018685509369555 0.70481339873090387 0.38811523662060865 0.2638955011306478 -0.022770614363750153 -0.050659792800138825 -0.035018096560522703 -0.21455087253248598 -0.3744935604091244 0.044294171542879623 -0.95234928669792684 0.72314734540882231 -0.78787451750704263 0.19867575815607535;-0.17140046194143402 1.086126111175884 -2.1863704226515024 -0.57437261609187618 1.348400702206711 -1.9906131022318645 -0.77671937617891074 0.064562044855358464 1.0592670802274411 -1.2237339641605616 -0.38340178567353539 -0.60778300826000009 0.10996727467026332 0.52158470468148921;-0.25051818452870028 -0.035299174029546854 0.83050121799304655 -0.94012218258651392 -1.1932541716593967 -1.2974576691485316 -0.3236383111891461 0.14491876845979676 -0.23522254511648336 1.3894350719417892 0.59761692895763685 0.75526536374458586 -0.37831735845029207 0.067709411315118498;-0.53694085844121608 0.065262923814951496 0.59476290048163627 0.16365066092494474 -0.18790704215744394 -0.068965724723109328 0.18652791692362733 -0.65373589022469258 -0.39446255853213652 -1.2088748196020924 -0.49531424603495683 0.57517353846668029 -0.79965115551068433 -1.4975015368236255;-0.44028217262605696 0.53476674248653178 -0.96029312030651848 0.027893348827346912 -0.058546369270774327 -0.35619412085209012 -0.027800745444035962 1.1841521272514595 0.40031129068757637 0.76342807847217242 0.19414057454507988 -0.18810329226668765 0.3656006688264406 0.86788300403129515;-0.19898046500143945 -0.26602499523036188 0.70048416885809239 1.0928871176159447 -1.018593855923873 1.1413896531422689 1.078743731777128 -0.16901252927795407 -0.76897396266338547 0.62894083052292793 0.6350062779537734 0.48594611133507915 0.78915152218615658 -0.25983717463407574;-0.41311751861388835 0.65661089101369663 -0.68942575278131801 0.70412452709615225 0.82613675150260601 0.086572017154554537 0.017085828636088894 0.12658239554229175 -0.14238464374415422 -0.086704697251787963 0.11956273611221128 -0.034804027039652477 0.32267427498142282 0.19892612440375218;-0.97873997382642808 -1.1897045286764674 0.23531160927080788 -0.24474571721683427 -0.87465157242038305 -0.52791309142809473 0.067227078831421386 -0.52022460057306963 -0.78440098290546323 0.98008227109712398 0.37405532359523763 0.92127009607346644 0.5155256178262132 0.79643161989721689;-0.19563730484634931 0.40941926613402752 0.12940113015070262 1.1412644099563443 0.37811542358168876 0.36312434729525922 -0.078862735184412336 -0.22774290110062764 -0.048881508388753173 0.37453603642578431 -0.54268917781820791 -0.47423496999455317 0.40242785759352379 0.21255114797345936;-0.76183049334401076 -0.62279784614106526 0.79314545347730314 -1.845663960724361 -2.7822507156868657 -2.1397657417333544 -1.7202391359583911 -1.4811175664636929 -0.82199451219048769 0.12547468674899029 1.1068004106885003 0.43820529843437483 -1.5124409424418606 0.16978126264538887;0.29030410908695303 0.93934830278060877 1.2401754018627771 -0.51016226802724152 0.093079149476602868 0.23090314570185794 -0.68095589996072048 0.19306162427880871 0.057550230924023567 -2.1016766713069792 -0.11625727393940889 -0.018731605973684881 0.73459043963153592 1.2558198741010831];

% Layer 3
b3 = 0.90757964124981627;
LW3_2 = [-0.33727261801954994 1.3846370397646235 1.1422183918167799 0.1994128590729681 -1.8458208313158999 -0.24160453325874434 -0.35789404349080206 0.55208540258207872 0.1805295707666949 -0.13198999920097232 1.2659760717677531 0.71973446644324179 1.6867302557218669 -0.64270237015898624];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
