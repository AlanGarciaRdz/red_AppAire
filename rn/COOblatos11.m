function [Y,Xf,Af] = COOblatos11(X,~,~)
%COOBLATOS11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:53.
% 
% [Y] = COOblatos11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.3694284033226063;-2.047290277804739;-0.59047664854254245;-1.3004491549743176;-9.4795939100514985;3.0751632863483063;2.9984596595886917;-0.23794702754862709;1.3078779036844401;-1.5157947196496679;-1.6913661414304393];
IW1_1 = [-1.6803309117610712 0.11821328668038646 -2.1285465605726785 -0.58281838658098484 0.19155865612244288 0.19550177563722254 0.095132715846987251 1.0914375985560858 -0.27372889192572869 0.43049571740077408;1.2061484518930654 -0.82833473753269637 0.2030689756305411 0.052514601257931615 -0.59193758301681776 0.06274680811192121 0.12756369702444798 -0.31081152242221627 0.019601425106297376 -1.01451717268051;0.55945443808441098 -1.5511495229755159 -0.68627860343509384 0.36716091191422606 -0.074867686257849023 -0.055947496554527916 -0.14836736398601053 0.15541757505171325 -0.2371508537291146 0.38794515065333623;1.8337321490851626 0.77171169221095182 -0.7242631605277412 0.50860988556135323 0.68717599060861179 -0.20154714895807577 0.82800048912456303 1.0539865052728812 -0.069186461489389811 0.6666230593431125;-12.534778187163585 -0.33416347830203874 0.080295149080220868 -0.045610398653159315 1.3403134701773953 0.019090828216843821 -1.6345302865408382 0.74764260789274417 0.20198211857498166 -0.23691093519620735;0.40652607000639052 -2.6763743285039716 0.28042185388851476 0.20717281728570608 0.17540365594061522 -0.06512934535024513 0.13186297416397222 -0.0031880665972998496 0.045160898670054961 0.21714273393372585;-2.2915242229479786 0.55406201096231911 -1.3182609740996709 -0.55706144431213567 0.060716000949781343 7.3348251535795246 -1.9298543987015555 0.62369366652298386 -0.14501493055326947 -0.45451454419260817;-0.36088830812988137 -1.1336133309993415 0.44285382933778356 -0.021294425530442185 -0.14503579157901955 0.14757004344428287 -0.22219583911424584 0.18523786177543874 0.051969901796841751 -0.19123419784086762;2.8447178385687963 0.043093981255428057 -0.79864321560787432 -0.33142737768964103 0.0020560265257430956 0.14498801201477324 -0.40018952673174907 -1.9527279079119408 -0.53128003078485087 0.26784421862883201;-0.31799494936482881 1.2790667230327786 -0.066510994430825102 -0.093978981533233488 -0.48946780137160684 0.17782538591187955 -0.21329607384517804 -0.25887581445159935 -0.12036173518423401 -0.05396470740452454;-1.1106212126039674 -0.6191718077841516 -0.80513189724288436 -0.15244988934494177 -0.49641742893191609 0.072604329737207735 -0.55894393953709198 0.4354506761284947 -0.059219208038672422 -0.13777861956016205];

% Layer 2
b2 = [-0.43310589680544498;0.02271990611014723;-3.5546531847331724;0.36955324560235214;-0.84815253374256316;2.3502297109961985;0.13159649631372333;0.52017509642391169;-0.77326341654991448;-2.9633490597174705;-0.75064031156241695];
LW2_1 = [1.5745964537795056 0.80780389168585587 -0.78797855589889698 0.6512384938407253 1.2603232949753507 -1.6121303569102703 -0.32119168792917391 -1.3021616316476212 0.45700469795927884 -2.5801609833149137 2.1626882192474719;0.050955858607044102 -0.27589115300912714 0.43839300108526302 -0.63590217238116231 -0.33441655995979191 -0.86604142641052961 -0.38603122593871658 2.4910526810342861 0.23672480699365361 0.073327064745932535 -0.98659942385883426;1.5907175794742003 0.02241874606374936 0.95226318924399878 -2.082425537087925 0.32946790793753961 -0.30860221603378568 -0.042125380695411774 1.881591734484116 -0.48992653848698092 2.017068230048757 -1.3409129073602262;-0.68759501613855367 2.2949647069683654 -2.5930350695782889 -2.7247756659555917 0.65966009481513777 0.29715898320557932 -0.42102792435224551 -0.27428584819693524 -0.14524881938298712 -3.6477551976740563 0.2923373766804403;-0.40708976540617481 0.01112580184802465 -0.53506747021427803 1.2519041098212669 -0.55657945741267389 -0.077993537323284054 0.026414133004537516 -0.63761140170313058 -0.18590962198453323 -1.7649074144216679 1.1238668952182977;-0.062490556087730027 0.28413161818208654 -0.40402821075194578 2.2522013109851891 0.47277933896260843 -0.065474665231983295 0.31723019815842796 -2.7575157529741579 -0.21811629202215671 -0.25097205591424043 1.3881118941880404;0.80034514544074897 0.80380773030187724 -0.81311807706602601 0.99500555738450558 1.0465644046905815 -1.1187526285124791 -0.24359651948376487 -1.1641230330586929 0.33918983482564946 -2.4554589266446571 1.8912407774047972;-1.0120517760703702 -2.4450932587968741 0.12277283159419425 -1.2412530006775047 -1.0195068375926946 0.81453838333122286 -0.026268113305353783 1.4070611984965036 0.087512076932199326 0.38888590340411233 -0.48207430262528816;-1.0436145345671231 -0.21431604222595821 -0.14279779486570948 -0.35896212212850431 -0.90045137473531289 -1.2540796028480097 -0.1620674247973044 -0.64333606768166252 -0.089725176589761035 -1.7378222326155277 1.4278162948646864;-1.3917403686291865 1.426564619504809 -0.94844926300352217 1.3509029981315259 -2.1171506215536158 -0.69224374405995504 1.6531268932083731 1.7105667127353463 1.8317291351411238 3.230636196423577 3.8094964717936786;0.041402587214189691 -0.69099178380608428 2.2895867373595311 0.28199170769131604 -0.057340201926986835 -2.7213805155919677 0.44526095615905831 -3.0954247693855517 -0.27014145663282341 -0.27227542671913457 -0.89389889775598486];

% Layer 3
b3 = -0.58029631775307422;
LW3_2 = [-3.3241511226794813 -1.3357329400701743 2.1289961614790909 0.26333919589604071 -1.4235762894438524 -1.1240251878130909 3.6107368716397534 2.3460030920747594 1.0471190764994414 0.39678953018402136 0.59789131726874756];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
