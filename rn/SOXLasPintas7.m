function [Y,Xf,Af] = SOXLasPintas7(X,~,~)
%SOXLASPINTAS7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:44.
% 
% [Y] = SOXLasPintas7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.0179856115107914;95.2380952380952;0.0558659217877095;0.00576368876080692;0.212765957446809;166.666666666667;45.4545454545455;29.8507462686567;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.5185850698594174;3.6998943952396512;2.0102363387066879;-1.7010533993154091;1.0981500722588864;-0.031050204952219697;-1.309467095154826;-1.8411792855543025;-0.85062375266563672;-2.455488597122915];
IW1_1 = [-6.1969957999551113 -5.3914905124353822 -0.82466366815422032 -5.9556717617158297 -4.6673705983181959 -0.84180649672973495 2.4393430504798905 0.63615069272438118 -0.32784987007931737 2.1718861996899124 -0.80029061894292008 1.4072254186404678 0.43106383131458237;-0.69932110590068319 -0.053173748342945922 -0.066303777621490048 -0.32767394723306087 0.43913505907321426 0.40314695860093042 0.65772159150340259 0.075873631247566936 -0.023897817927245664 -0.29157784334940867 0.054744165759907468 0.55489395046232481 2.4851673982565146;-5.0895843074514788 0.84803412576116843 1.8364384050121156 -0.71547404561984318 -1.3648469996439763 -1.9922369847532615 -0.44314985205871898 -0.96595843486627364 -0.85267900160180288 -0.87781212663207819 -1.0538981245314427 0.24593550358337463 0.62565448724523831;2.0636271601849994 -0.097993529945598984 -0.07673006601041793 0.29785943700593404 -0.058350064827141335 0.25668967187442115 -0.6288557009688277 0.20435232469182021 -0.14647168415800943 -0.52211068568207453 -2.8106019870536727 -1.1814496781579056 2.4143069454403605;0.71808446157596384 0.013668355076236644 -0.6568951890597855 -0.56084026477040827 0.67136060948153198 -0.43871037023648296 0.49323922210920462 0.44611153414630994 -0.28441871798421858 -0.022274434378851463 -0.15108565297416751 1.3751168117600263 -1.1455578130850386;2.1078855953675575 0.34361037085428381 0.60004855002353374 -0.62451882442101048 -3.9471484645167045 1.9730605121919029 -0.0084472032764079732 0.24639767121642378 -0.78383331398002354 1.2796122888383576 -0.18812955231437439 0.79114566654398355 -0.87066833821818701;-0.94434208973904699 -0.11018518212078103 -0.58038457027823753 -0.14852381478511847 0.47071677063753214 0.92243052310065587 0.47742051856818668 0.18138964070185801 -0.054965384417834155 -0.03740741379889416 -0.45778946775510854 0.40028219229472134 -1.6889706310961545;2.5080512740816823 5.0713983669179736 -5.1727512933686048 3.3734148748948667 3.9088461273575588 6.1694104587961744 -1.7048461344935453 -0.048237765569140459 -3.0484068468034935 -4.1071816676754338 5.0483362644075314 -1.6685293812435322 3.4786875030394029;-4.2728318422961609 0.79173904477721591 3.0561361268128575 0.02591487720356625 -1.4714753173680817 -3.5297180581393723 0.58017642220717947 -1.0109503753440954 -1.6387205854761746 -0.4570577365634842 -0.11875089817543136 -1.1878520046235324 -1.5330433111588611;-2.7791026063988098 -0.092182856792665357 -1.0157853078113142 0.022494995426344096 0.43038628343853752 1.9139109274720441 0.26845411994653107 0.08777254524205666 0.13099672937432169 0.083768930302890982 -0.97990302277349284 0.21912151550049255 -1.5529884648417638];

% Layer 2
b2 = [1.9566537711498242;0.84392584640604251;-0.47154225057651156;-2.5007237605129617;-1.2103664556070819;1.1955652935788417;1.3899091625120663;0.62950157298366349;-1.6527584085626303;2.0997530230966448];
LW2_1 = [-0.034856586736683938 0.96165159516193088 -0.7633138950539704 -1.1607992312013562 0.5577791753607807 -0.3192349447477254 -0.052789519185881331 0.14200302659897812 0.91679945173740818 1.5928513201241632;0.011151182377687844 -0.19795036466080118 -1.1364998023898008 -0.10729744205300119 -1.4022769229976915 -0.19523301829329223 -0.073490666764969931 0.14300079450846026 -0.30283739618277861 2.6013274740866401;0.12008536685531755 0.89186271841103615 0.78536097730673593 -0.0070328556383338764 0.986988061538012 0.35622555129176481 1.2219043930089719 -0.48634137930759408 -0.96542792072174577 -0.36761389197759575;6.5839902028162047 -2.9517916728642448 3.3585059548376317 -2.5505116851333982 -2.6641336794520276 -0.17411978981463835 2.7415738812688648 5.0420376532474451 -2.8517012076276438 -0.076504308894668721;0.78160548206925062 -0.50635507633156396 -1.2436950549865116 0.80592457581808197 -1.164822110365294 -1.360496074318966 -2.4801195782071113 -0.043704357841914551 2.560291131948615 3.0391472802917798;-0.21236614306972842 0.17529286246914005 -0.26002235047959604 -0.62724548808199743 0.91428619640968878 -0.11521629140790131 -0.63589083612514141 0.40087241851615985 -1.3417845511306932 -0.091827987706115222;-2.4187126976617881 0.62727305076125006 0.13280124596117393 -0.72449376633398521 0.97845253481942296 1.3812303533546146 2.600102140354918 -1.3439829764676259 -1.2955334607248667 -3.0605296447740362;-0.040508868189913019 1.0650249315309761 -0.98944691743633362 -1.2524616242710016 -0.58386218016256874 -0.42852477286904422 0.26153171113110668 0.16416204026288839 1.1449776767457862 -0.83634086177476563;0.310925950762587 -0.93878799563767279 1.0575475401686745 1.3572696313114303 -0.86992571343513847 0.2087203104600035 1.0247384565555653 -0.60632015471375389 1.3707328710153115 0.13427104199046566;-0.15074982713504081 -0.38998587806715612 -2.6946556864198294 -0.23298306467966751 0.70337922751229676 0.10465311739304985 0.72524072591685906 0.024119033071175439 2.0912646131140629 -2.9229353329895105];

% Layer 3
b3 = 0.10828215056428508;
LW3_2 = [-0.57757803954715636 -2.0643624285702828 0.051414144159165238 1.2152197877500277 2.7887878535140316 0.31123863522136652 2.6567398556413786 0.5134338386700984 0.22734484017578588 -1.7786268095554867];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
