function [Y,Xf,Af] = O3tlaquepaque13(X,~,~)
%O3TLAQUEPAQUE13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:52.
% 
% [Y] = O3tlaquepaque13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.171659085057077;3.03490136570561;14.7058823529412;15.3846153846154;10.752688172043;10.4712041884817;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [2.3477420889851008;-0.60964081681062332;0.51266312349253518;-1.7017838480252614;0.17846750190308702;1.0461987015389029;-0.28562661835004644;-0.54979217680284631;-0.94240130153611457;-0.72486218954775794;1.2737271400667074;3.0757628239812944;2.7422913070204653;-1.345372423424618;8.0660646788167494];
  IW1_1 = [-1.3466271756878221 3.2513190559474427 -0.38753547499862584 -0.39690194711400389 -0.19408762065190641 -0.45259227018519166 0.30391646694521673 0.16803433587555031 0.14545516182886498 1.2568591588946532 -0.62266496059880228 -0.23111897961904163 -0.71818669607016727;1.4866999974926092 0.41513925244453886 -0.0022432828641774354 0.070511134405766188 -0.12272210567133918 -0.094013063308373584 -0.148093146709282 -0.10182739735114402 0.069825787137292761 0.58275499610817993 -0.21500727158658092 0.016552735421445575 0.21190457630464155;1.4370834175857592 0.49275590934311309 -0.19215129835065567 -0.42688022085905952 -0.051529574728236452 -0.4022933078856295 0.021855211340496804 -0.41028452852712749 0.23834343259290205 0.27978151808455387 -0.63964315201405941 -0.13670862444395299 0.68969794775632187;-1.1080491736345963 0.14890535147495867 -0.21265543136834864 0.26210233936652549 1.1232468073972761 0.215937648601423 -0.37990982644946991 0.20643567653594286 0.61922588019106817 -0.76594170951334295 -0.12452164739535186 -0.56438107246824043 0.4625368063469768;-1.4023584416333621 -0.15832639577015725 0.55843639853101512 1.3631829637143269 -0.27536544235993721 -0.077228937775176892 -0.24808230614989632 -0.37066051871391098 0.11473037403907842 -0.80022273562392088 -0.34102248726837847 -0.12114713395141473 -0.2769569843896913;-0.37141430669786507 -1.4266748727719165 -0.12707014605297073 1.1412713129439422 0.56519399847318785 0.63788811989984173 -0.83777189675740704 0.47770885623262072 -0.26540713928282528 0.086289228891731226 0.51941644113532115 0.17532204085340022 -1.2826882127482053;-0.60140071362709568 1.9455472428108176 -0.15911385065666211 -2.2180538765809654 -0.32921615944942706 -0.24261098835570014 0.74687716204124877 -0.09534547446988606 0.14149440765892191 0.83012963282788088 -0.200895922174291 -0.076877116722142466 0.63082292597944623;-2.3533172953437194 -2.6534603159443275 0.12504552259331708 -0.45063218788117126 0.37469659729321964 -0.3218563523504227 1.4150075025537618 -1.3720461073773818 1.2508370259403112 2.3115374448094244 -0.15403198845734034 0.1656311802377656 1.4511678245041195;-0.85287415071383921 -0.046135306860324951 -0.0049800502682643202 2.026194915660668 0.87463072173312051 -1.4532477113826401 -0.12732765325027848 -0.75246104983819329 -1.1159391361212678 -1.9748959450954457 -3.1607120205542021 -0.11185191760113615 1.3068620157888784;-0.56355731237765005 0.055848782676913233 0.021607311093947396 -0.0070780064454102022 0.24249935202344391 -0.32000915319920131 0.40052101870181389 -0.25443106411240168 0.13569629265753633 -0.10212668017808534 -0.38505398975671151 -0.014278197695399801 -0.113428410452473;3.461029096161905 -1.5747238274270328 -1.6129332655855191 1.7517416517715299 -0.64605508396717271 0.45683709986201221 0.43481965117599469 -0.93856845869869054 -0.1356045845892245 -0.57169286179039125 0.63846676581413053 0.26957502135375128 -0.71457037134261547;1.7225679946297583 1.7374844543407637 0.76379836850812499 -0.1503353468849134 -0.49600099959478006 0.38367209379587675 -0.48017439540362233 1.0111871471029115 -1.7441069085397811 0.75995860444007357 -0.55344306400198084 -0.30533710959944277 -1.6238124323284207;1.039269398646238 0.36199666785140122 0.88173834302360676 0.014297924612876788 0.69704658085848958 0.070037805884790805 1.0191731895927476 0.36789105583985049 -0.097045175223700195 -0.37067837150320193 -0.2538886390926639 0.080837549196492609 -0.34539388765804663;0.16474131894278687 0.62595647240937269 -0.31005492761596848 -1.536689049104115 -0.46845649769353132 -0.54401347128613753 1.4335814445911996 -0.45666678163833219 1.003211967791046 0.96530101566328264 1.6500831889503291 0.18518727273554728 1.6982236292517827;0.3287577926007908 1.5066965953988603 1.337892092797178 4.5440253129445312 -0.09464697493784735 -0.26595863490000138 1.2980382495471521 -0.18258193052997193 0.63769746702487806 -0.66406889771166799 0.53211026143417761 -0.040137307682329301 0.69178344651396229];
  
  % Layer 2
  b2 = [-2.0777148528633571;-2.6064847058500606;-1.3831091599448817;0.58848517885246299;-0.97429766904254089;-0.34741964708374262;-0.7478256371066142;2.2710730164574038;0.63507428539885713;1.7501532286373418;-0.7664207159489379;-2.4287392424748457;-0.21681959722656208;-2.0725322950183234;-2.7710571544204043];
  LW2_1 = [0.29807200215866397 -0.21338290720785325 0.44188292989952932 0.68481727777522594 -0.18287841564741331 -0.064770991671324205 -0.45400628726956932 0.75024995010358886 -0.39533086089720554 -0.28820609434298439 0.1458722332653192 -1.1182066538019566 0.36165406160371949 0.41882491916892567 2.1129460550301453;1.0060914882179945 -1.7574237052210993 -0.39887277276263938 0.3663047045459632 1.0853758600155372 0.85028862502046232 0.52522570179559758 0.81466235371121987 0.096551451666014379 -0.41594059334427103 -0.65258549777216146 0.69453244008852921 -0.41426581332398649 1.1463437630896662 -0.08555145603804952;0.29311963497817656 -0.12568143647885094 -0.39690015813941337 2.3180895862360811 1.2359208148688943 1.6721704523770478 -0.2276066849479032 -0.29677940866080038 -0.35280236746197402 0.44533342128792086 1.1922199227058685 -0.80223954756198501 0.76976704810386265 0.88401954333218691 1.7972453837954159;-0.73035392172531044 -0.81118846517802001 -0.22102828275159311 0.02383324772448896 -0.32003714242404024 -0.4334464275329144 0.014002810789537103 0.94644256174809605 0.16291325230655102 -1.8042169197590034 -0.07598572460844856 1.0098167511807539 -1.1417089206317077 -0.32771314903436499 -0.5026920971322284;0.60225718942495476 0.88851775202780869 -0.37069197496165918 0.59899530868726636 0.46163979752099377 0.47846817528266844 0.40965566001726089 -1.3207335566719753 -0.038624242546940489 1.6274596815757272 0.57683524210554793 -0.66676371474831764 1.2118856601870802 -0.16176276408881785 0.089654972320862863;0.25416978134155149 2.2279045903070744 1.1990394858744668 -0.23651358626727526 0.80796183801817434 1.3271460720834709 1.6753291387164111 1.0742961823634865 -0.74689204458724123 0.54352349447857651 -0.59186789883887536 1.0356507244622055 0.0458824689488673 0.90193662279008613 0.88882783184811409;0.35033297994095658 0.7949422459216593 1.115512825597748 -0.22697012583642545 0.23538061651562511 0.12915440872011985 0.065161600051503926 0.38052425894135755 -0.34369344080573533 0.67065744774970704 -0.47228413582137607 0.30375504382409718 -0.073797487047603763 0.34914801107187182 0.60979085578913772;0.48160135212335137 -2.4976297160703633 -0.40861031311161999 -1.303757310695127 0.42339035372623485 -0.4107011294788247 0.11265998702397008 -0.027422635809772375 0.0030517990029283841 1.6871287671424202 2.0942371732039446 -0.38692791539731353 -1.7383775226031388 -0.20790785326364261 -0.61475085297273768;0.34848345627425625 0.12057951970803991 -1.0387735423933537 0.65105892478413829 -0.77892028475513486 0.31205184181030021 0.64514896012597667 0.67234439831266224 -0.046489846659453313 0.59662450911112408 -0.63701951280712721 0.70979942033852261 -0.8982297426229241 -0.1678097721625128 -0.14338912522363559;0.044144020417242136 1.1497376871100085 0.52083474419184073 -0.56461703953140185 0.92956277446470104 -0.28313593819731891 -0.87305264943862149 0.52869873975572201 -0.088597168685663696 0.069620043708199644 0.36009382203990614 -0.59734303453643856 0.9436282138984381 -0.024978805347225887 -1.0415489138272047;0.42555537198201143 1.5242596281754441 0.2649440116361747 0.5400557013477163 0.44795446519327342 0.79211678433009614 -0.022632263937511339 0.017521402046554193 -0.37119346483058363 1.6258600987239846 0.35261146754425249 0.92763321716935532 -0.42817531833265721 -0.030055381259222764 -0.096471417015005348;0.17077748927270672 1.706356544550897 0.46191565013684865 -0.12477800347124786 0.70425980696318324 1.0001828921386888 1.4047734888735548 0.32124375678078548 -0.23567295657715623 -0.35857930273253125 0.49500027830712601 -0.18507148676140223 -0.1420411772865493 0.94258405035949722 2.9121068290887577;0.12913727094092411 -1.3064032797706353 0.65874371610183191 -0.7501788706722724 -0.35962179328106536 -0.89015819424411535 -1.1206137369199638 0.98483142270628721 -0.1377019912987755 -0.76591007748981277 0.002511423410303212 -0.35455981396366598 -0.087687690128408699 -0.90533408566174867 -1.2646065180914203;0.078268479931549367 -0.01144655940891345 0.78474873899890873 0.0088007816403829174 0.054707758284116677 -0.36607588537140773 0.27224575689323971 1.1556739060397667 -0.19115681459339931 -0.74703260766199897 0.23985691654206617 0.028968335229431433 -0.52737425069851906 -0.1169311419365171 1.8255215538414094;-0.050611943289781781 -0.40312333204345024 -0.76671269226820438 1.3029342940901645 -0.41133320778933513 -0.19282899408467455 -0.17355858978798244 -1.4404985064970921 -1.5709522329645851 0.40576012173751719 0.37005119807939285 -1.0996178924215201 0.083016158300351181 0.017884796180294767 0.95233597371345624];
  
  % Layer 3
  b3 = -0.17889159451490227;
  LW3_2 = [0.84083590165112421 2.3072127857563474 0.29665484861493596 1.4374279093809166 1.4342130393697832 -1.1406557752798245 2.5197663815647617 -0.73401028458210471 -1.8326162300890554 -1.084046233000785 -1.723147800983809 1.4764131972882224 1.1036726348589596 -1.5014852279649165 -1.1341792571613283];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
