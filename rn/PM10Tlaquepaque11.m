function [Y,Xf,Af] = PM10Tlaquepaque11(X,~,~)
%PM10TLAQUEPAQUE11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:39.
% 
% [Y] = PM10Tlaquepaque11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.00773694390715667;0.00572573718866304;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.64472423156698799;4.2762062293890724;0.7611446584210807;-0.91531504955352916;0.31261811949721263;-1.4790757714022833;3.7364853900838044;-1.0279177264356916;-2.9084721567915524;1.7273544958912492;-1.6173023223203113;8.2669128285543678];
IW1_1 = [-0.016605258406111521 1.4658446432173589 -2.3415185922581965 2.5141976663830015 -2.4344895145616521 0.62164286330997509 -1.5569260488017642 1.810919976769944 -0.8240545163266636 0.39069619237877568 1.0770665946118927;-1.3129748587022281 0.97953038701270001 0.12925206766274908 -0.32149306265643784 -1.948105555281352 -0.77296996065351176 0.29051637967885241 0.23232832970747605 0.28243901313431485 2.8921798359666382 3.3707111445365388;0.19137290712408644 0.28571959935233882 1.2443979776029532 2.6195237774754965 -1.5140585602065824 -1.0095319848904292 1.4757496478475614 -1.7087555081619277 -1.0519773382359638 1.0162112071322038 -0.47096551830666006;-0.30589711311952966 -0.41674569235605896 -0.23519805438986119 0.29278694961479523 -0.78898542882392086 -0.58835772892955485 -0.05380144450877742 -0.071551463979500976 0.056579303804967278 -0.58199169851102062 0.24208412621819622;-0.12228533693072213 -0.11037407492108732 -0.50872294517068106 -0.035034913887944344 0.80672380444518921 -1.6220959773049526 0.026900453418822474 -0.039860605558143962 0.10814893947559732 -0.68691389049492524 -0.15539327351109908;0.25217648850823321 0.021321488624792186 -0.084849617514205181 -0.11538096682791237 -2.5407915087325215 1.3381077163186201 -0.31370878378289985 -0.14743728415174515 0.21375840011602257 -0.6600099331204532 0.2262906364512379;-1.7725092834453646 1.0125897324409154 -0.31958251981843816 0.43014983043372829 -0.14190662686808114 -0.55512856985487746 -0.32981193055254127 -0.052887673452195562 -0.41958775502067985 1.9704550881317184 2.2397264083109913;-0.016500913035041604 0.1469714987893703 -0.6819913480595754 0.67805848194243579 -0.21816327130474938 -0.36805431857670162 0.015659972195533906 -0.13644897856836494 -0.0038215443378372335 -1.0522663395207756 0.29776712914002168;1.6596453817119567 -2.0259734176216853 0.29921052166557721 1.9283636602843193 -0.87930903277020311 2.7873507591219724 -0.5989300349847182 -0.066976396821494324 -1.5134419205444969 1.5773285995712103 -0.7511237954446347;0.0089802960700137921 -1.1398845910823319 -0.068054070478772086 0.32694268837890483 -0.20174391950791168 -0.15993492964342451 -0.042957570807022186 -0.015489111188893238 -0.070164543271649019 -0.041522241055283286 0.15387070309232947;-1.4133821605990997 -0.058601940278283464 0.24772368381102511 -0.92054548489922383 -0.63093860784274403 -1.4780893800140638 -0.1716308940537149 -0.040275100339973925 0.4872676031599274 -0.48155233776635781 -0.50007555271364423;0.95221537531021971 -0.31020051254828618 -0.77956019760014772 -0.15098104132352411 4.3874186391814955 0.61293680798627492 -0.17537663359585065 0.22263157758145419 4.74301797592436 0.66014203187838871 -0.58973595684896074];

% Layer 2
b2 = [-0.88654362459316349;-1.1905980009401493;-1.3515025294791478;1.4905539751191814;-0.42687847840851034;0.014465702771431483;3.687408410643858;0.62325664260992608;-1.364622706709574;2.2453242241385896;-0.59865410651705819;0.51512285657742796];
LW2_1 = [0.63141808940397137 0.26782759507282622 -0.017691714340999323 -0.90376965880682536 0.25185586903374152 -0.42851933971089595 -0.17040330041165938 -0.10570700485973492 0.76518467471070417 0.10086800285405752 0.55373063943700007 -0.13600436957901427;-0.014649974450286124 -0.14665778933091986 -0.76224957033827911 -0.15226266642936265 -2.1147130605469218 0.61887376673228878 1.7574927791620965 1.35370290623598 -0.40731203758728723 2.3908473340102776 -1.0202356178314524 2.160072699388234;0.84079924256933947 0.80324340159589613 0.19327053321473456 -1.5551489305940103 0.59783799257439074 -0.6123810804749743 -0.78056191234598504 0.58356273440242323 0.87162817887832156 0.75763539809423786 0.47097842197113454 -0.23621147558127228;-0.015654256657762201 -0.63823166931984554 0.01090466026124701 -3.0938967541150517 -0.75815588307533066 -1.1387735169478679 1.3281942226346093 3.4337482988588008 1.04497413328977 -0.89636900945249798 0.7027213783505516 0.9335051561211285;2.7439138124520945 0.4782211817299154 0.10375205493106114 -1.9154917472613773 -1.0320670712073072 -1.6042325370783006 -0.18867764278582386 0.914521007881272 -0.78311071477820804 -2.0992616222708627 0.84794901048386084 -0.41570130266652555;0.13219377951425038 -0.066284398353909632 -0.37676784468300945 0.63106291459187736 -0.7991188510579248 -0.44463043314467099 0.53629992109354274 1.068433127047983 0.34820859933091497 0.14913667987921009 0.27390327761412409 0.6708307894931973;0.14619238024681197 -0.063976514519619568 -0.13681947366879679 1.6675107781459655 -1.3851976833618211 -1.377111676305975 -0.26003364345875613 0.45287403726665204 -0.084415655107113588 -3.1669624342070257 0.73676469297429104 0.42351028076687691;0.099608418191001025 -0.55212335078267516 -0.41164456071670424 -0.27649718226668774 0.47921956492874085 0.60290075347997607 1.052192676969731 -0.27721779600482105 0.21049067993769122 -2.0386672731176105 -0.81786779568807422 0.47064430442758121;2.5994633791695581 0.90731031870081624 -0.10158078315493155 -0.31719494149733857 -1.4374356281882694 -2.6361723719120587 -0.62400857188183267 -2.1367612445627029 0.50035457027099972 2.290946281867186 2.1635559020899899 -1.0618753055786829;-1.0239895034278705 0.044794898272981575 0.01154569696090723 1.4932048102422517 -0.3636466880222643 0.38186415835295695 -0.6007707657197715 0.33954529892666763 -0.81222817968786076 -1.1815908395908201 -1.0162733838905735 0.25058934689910461;0.72601804626914979 -1.8298022451250413 -0.30497350774793058 -1.5847588202711467 2.1298368435538264 -0.11394144320667852 1.0589059784995158 -1.9027638122023796 -1.6863237098057857 -1.5582916141804644 -0.55141994137730521 -0.0055130638345435735;-0.55577833174776825 -1.4140927075188507 0.047995664723043764 0.066192564211048355 -0.85921008953766309 0.42490279341739184 2.1053612260051096 -0.52003463495007829 -0.29656950601334098 0.58337080959852095 -0.0081349857709066796 0.17664057916696577];

% Layer 3
b3 = -1.867720287458069;
LW3_2 = [-3.1149545000824692 0.21451115716148847 1.4196832922450475 -0.22798131826269816 -0.2553120632424557 -0.56287303147813217 0.68341690367288577 0.69738653384831806 -0.11715606355529407 -1.1403921575973557 -0.16002464947350767 0.3367514680757262];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
