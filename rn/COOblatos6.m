function [Y,Xf,Af] = COOblatos6(X,~,~)
%COOBLATOS6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:52.
% 
% [Y] = COOblatos6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.0113180755086146;0.91627995026957032;-1.079299424889552;0.19547004195305734;0.44952530702476673;0.4636017751711109;-0.070932338646783305;-1.2314928107218788;0.63227097076020977;-1.5917182461151655;1.8835505735742888;-4.0126269499467213;-1.9651666042490044;-2.5518767457939822;0.10475800384092786];
IW1_1 = [1.3037854083522977 0.7275126806701232 0.31216588146251045 0.029786917703656657 -0.17438768352195302 -1.7159596948116249 0.82001558192917523 -0.44077890057800112 -0.090986824563558971 0.055947139150769369;-1.1986238945544132 -1.882326166597025 -0.27522914936600956 -1.0657661269818186 -1.6028958060580347 -1.860901139434284 -0.092535880824988939 -2.1934076044694217 0.51666595578396979 0.46437879303405066;0.40907779318607079 -0.045033543513400123 1.5495063687037505 0.096205976576407823 0.48384414278413101 2.1119543662537485 -0.57673850846976327 -0.59180829785298739 -0.36831835333568386 0.43137342073933221;0.74372742603618613 -0.2814144701713025 -0.43671341074286762 -0.22616770728048619 2.054908004282185 0.68006394954728744 -0.25666003215193511 -0.3950283043203166 0.042185708859215382 -0.39940212453258511;0.60878573994608698 1.1069474869562486 -4.8927330693928921 -0.31969106501872607 4.2363393241270746 0.14690144724945542 -0.21265063924089017 -0.25559187846306702 -0.105406403336436 -0.092098609640241497;0.78693224235547143 -0.044543996957877002 1.2036189075519379 0.33204193331036369 -0.98866126142577049 0.82716742710591129 -0.27986627141891257 0.42141127917472682 -0.3262534853640271 0.17700297013922381;1.1747875791905447 -1.4138358196499459 0.57492634734536696 0.16830851748058626 -0.56966712519549811 -0.13345902163509746 0.6004984277009654 0.76331140525041885 0.32345799093976751 0.075406884040643801;-0.48692193409771078 1.0356738245376524 -0.50408276686228726 -0.18673058130897505 -1.4500240186523345 1.337860234254489 -0.61054603617627978 0.32485492640928915 0.21045021848270354 0.16813671855296397;-0.12512515259604795 -3.4062320340706838 -0.25051241915341171 -0.0533047231028978 -0.12050702360241741 0.59656580621555999 -0.087252580843762167 0.31447080672075789 -0.034389340818808831 -0.24740628795037362;0.63806624384060173 -0.89791078252930467 -0.90556096319177626 0.49683209730832456 0.14645423238983779 1.8598463927868913 0.53257365158884495 -0.41454598384725011 0.062783238764732754 0.23291943709288462;2.0614231693769756 -0.70182476740430011 -0.28696727245523118 -0.034073210939326443 0.12683411625848548 1.1915013465950419 0.14291653997979092 0.55837078371110205 0.20047832691287232 0.37045832819695468;-5.9274664767495917 -1.2701277149925418 0.083965401738248374 0.43608563972318948 0.22601082889600096 -0.031939969022500007 0.67059398705799644 0.74226628654660531 -0.3165983037863464 -0.88040423039812377;-0.025238053688399098 -2.9935988740272865 0.45135127653306195 -0.17110431663821424 0.18688403146142782 -0.091328103910359615 0.054973479592616031 -0.0032042845566206749 0.14004794192005121 -0.082289539836896727;-1.7602833438022281 0.33897166280213881 -0.12913045409059298 -0.58988336814333275 -0.90421539070327883 0.44488199308550275 1.0519789183292445 -0.85053778004250613 0.012342207442860475 0.19781667355342672;-0.54106142154487058 0.20457605780932586 0.65032835445753301 -0.075764183510016112 1.6327508843626986 -0.83851294813200561 -0.19690563500500752 0.36439627761850235 0.92825731969058789 -0.1377464314744612];

% Layer 2
b2 = [-1.5304549272214716;-0.86791608273754528;-1.2674500511349573;-0.6429487037771523;0.83454776287109667;-0.068717465264414745;0.075955492314000755;0.80100303751176671;0.31781713704708292;0.026722955832080831;1.9059128194478221;0.017669376342901132;-2.1284512124589496;2.0289603226914403;0.84271337848662953];
LW2_1 = [-0.010574787635193636 -0.23561787782293178 0.10219712911362228 0.32520898190452419 0.62444487930041548 0.50899460542946307 1.2219540099364754 0.18200871147698305 0.18472701603705985 -0.9127606176088876 -0.73643460825360207 -0.070487582974216118 0.22728710979293654 -0.048906758541871057 0.55078663635274117;-0.34006653169425133 -0.63541952136359703 1.4219565283110462 -0.40632286083205849 0.56854565476926655 -1.5546262292508641 0.40006345863844073 0.8468584015197288 -0.8110312577690254 -0.56009041595961317 0.38194447787126817 0.32476804757149619 0.75191494004314419 -0.76523354947081446 -1.2666885051072967;0.095910498607273451 -0.82818872191653681 0.44617281442941503 0.54745086934868092 -0.88557374695321289 1.4116925837717951 0.031805358098421943 -1.8064522918895061 0.13166134033873036 0.17694415652676232 0.14281841794852987 0.97387407804299375 1.2354981142337231 0.035800502204839865 -0.080737950953462354;-0.32411221099601939 -0.036370487163186624 0.41247355800029312 1.0905379700168143 -2.8922372044223699 0.43797600974244599 0.47207252189351712 3.177600280001565 0.57010844694308638 -0.56223017813452369 -1.765001777516424 -1.5533197791055016 0.050826568795182075 -0.082187852753431961 -1.2533758888396753;-0.93474993500193415 -0.86077575675871509 1.0127462911937208 -0.14579355439270239 0.29576403228622322 -0.76947136501463631 -0.1652836855111233 0.97200798270215483 0.14916950768259057 -0.75112547845160116 0.58022303228053485 -0.29774981934821498 -1.0282650884614677 0.98550830657559996 0.22543499769472727;0.29889656689829541 -0.49948890640308502 -0.57723267522435029 -0.4179730088470382 -1.6576777385316155 -1.3652583628856079 -0.82893359992805771 -1.188978842333644 1.3819978549005763 0.77296231886085498 0.30439620251583188 0.43110334366272096 -1.4971364619701499 -0.61670120220661817 0.11641170189471507;-0.05762454956466679 0.093613851515259666 -0.15164495050213869 -0.80773738472523549 -1.2000651542900547 -1.5488757391994394 -1.27602214636566 -1.5016899740721563 0.86915429836223468 0.58079202165784449 0.42849406574166382 0.51260324285092007 1.652120350766269 -0.56787890468009927 0.051231527181967808;-0.85181762354290247 -0.018286173015418201 -1.0760626529122919 -0.82310765925652207 -0.43352207854993441 -0.69454259857082312 1.6078220372474905 -1.2187817640136795 -0.60786148111614546 0.4185931487436414 -0.52458556807213308 0.10800436517961361 -0.63379510701225938 -0.44611126371269855 -0.91738360498209659;-0.74607044322572624 -0.86307453709081161 0.098937842044639526 0.3437822545616373 -0.38739487787521509 -0.42217575346071901 0.72421735816005228 -0.35503351776464404 -0.29251517298746144 -0.49180176416783317 -1.2361046041796426 -0.80563768678632064 -1.3083103392645894 -0.60809854637282545 -0.06346132449911232;-0.85371231656163327 0.43153572325555717 -0.49740441484263465 0.16676892449686417 -1.1103522087526181 0.63392389197481813 -0.78398553872739429 -0.86768721352793676 0.31178876474337353 0.43025395923471804 0.32405882865095387 -0.71238868171682668 -1.4441974680919636 0.52204399066056817 0.42541778021275434;0.36980325813148407 -0.63782662552802671 -0.22940105848022047 0.52196289240987204 -0.035134423786798687 -0.79021243085692228 0.97968153119397494 0.60421200419160115 -0.71952677692384182 -0.7137278417305114 -0.73009739043854416 0.40676010812958779 -0.93374332472201349 -0.39746388090322032 -0.57501725594233066;-0.38336875223740691 -0.02354544827223223 -0.017062034678162738 0.12882104278934625 0.45689111653295594 0.083174405512610183 0.53042998315198364 0.73881262560562311 -0.80424833625892456 -0.30934385691402899 0.08852634032452375 -0.0018751740735974045 0.72520049894792038 0.26358889053713863 -0.49833228834031151;1.0740902002390846 -0.21656352546855462 0.16822776065253686 0.13184918524877021 0.51348553155639076 0.30779491572216588 2.022500779822678 0.20080063171780019 0.058355671422308533 1.2200948701067049 -1.8827254769301491 0.082414540686036791 -1.5165738745669843 -0.71157829829730335 2.1692737983233514;-1.2702147205446219 0.18693839271417453 1.3662915023648874 0.085784671916067159 -1.3806063206160739 0.037261151381132097 -1.1747760180919291 -0.81615177152570506 0.31025901797093547 -0.34771330315837812 0.68449120749601222 -0.79600246662083174 0.13030906933180236 0.14381678495695138 0.047140917030856808;-0.61460716529548409 0.34253627676017717 -0.59662788143826417 0.52841743354572768 -0.30937069685650653 -0.15903091720297524 0.29678716038991815 0.31700822808656903 -1.2577403513897885 -0.433993549176513 -0.57468591568883909 -0.31680877030027743 -2.0253690438699525 0.17048577236998913 0.15094834655361486];

% Layer 3
b3 = -0.063183192225920698;
LW3_2 = [-1.2061729135954571 -0.79534311621255505 0.84022387391817532 -0.15688190062012636 -0.51895198997047398 0.56621429618065511 0.32646602409072117 -0.26112515696025573 0.54744849834939047 -1.5753770494979429 -1.1552704323264174 1.7623595506963763 1.7452640604670275 1.5027877076527643 1.7541534558057421];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
