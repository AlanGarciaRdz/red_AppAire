function [Y,Xf,Af] = PM10Centro11(X,~,~)
%PM10CENTRO11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:04.
% 
% [Y] = PM10Centro11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.281968137600451;3.74531835205992;0.00773694390715667;45.4545454545455;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.41113835480231581;0.83733479412852352;0.49955352417872989;0.42626895092056594;1.5272581375323213;1.5668106399482415;-1.7127346408683404;0.70355752405084249;3.2483575017823063;1.4420881943562556;-2.3930744014534948;-1.0333001015417691;-6.2855373264937064;0.513202903612753;0.47308880740010661];
IW1_1 = [0.34259077020270556 -0.57532344112780032 -0.29397485353258412 -1.0028937161964349 1.7255393932105219 -1.4014424537666361 1.2674930114492047;-3.1344551045669742 -0.39882389220632908 -1.7376411291006353 1.0504057940978835 1.2752642614459233 -1.9285058788804923 -0.61739571920529224;-1.0676908994611449 -0.37788408797100675 -0.71216358907125377 0.3092108974575315 1.4671491616434407 0.073017116034630833 -0.034263453205850114;-0.015736110090464141 1.8709582351476004 0.65224166170340714 0.49364065599896934 0.091140726440332789 0.31648714682930484 0.83538234681069223;-1.1197402390768814 -0.36914018855641395 -1.7037537167877794 -1.3283869359023899 0.049419583156434466 3.5116966007615478 0.24308034878870055;7.2029327599800261 0.23120953523705268 0.81598204799153584 -1.1656997667749811 -0.45991855647240509 0.7128484944981881 -0.86441584438480945;1.0285093319963967 0.10520238015980833 -1.1051413924016054 -3.2128758571560332 3.384270043088581 -1.6746267288212608 0.9592765737468284;0.6984661533363361 -0.19251911041784509 1.437623584309075 -0.68262831263379919 -3.0489910444482136 -0.7880947686828913 1.5417076553241165;-1.4886442472579673 -1.3755967701325875 -0.86702282153938659 -1.9477935864687486 1.0002449819540333 5.0293299563561815 -0.036552594215677421;-1.1352303111616846 1.715179578226484 1.3062432318349886 -0.50210391437517188 -1.6418570059439506 0.6911807673565864 1.6792630845031302;-1.5537898498016034 0.16316080871819941 -1.058091531782108 1.9373578105301112 -3.5424378809099304 2.802042297029832 -3.2504367191461427;0.2936013066367123 -0.6563098851087934 -1.2584391662116801 0.59337228671788833 1.6093298083757936 -1.2204179478573125 -1.3767088646603514;-1.3563291101238972 -0.23403879763625324 -0.78232063457141487 0.49399753088865189 0.96614245073403227 -6.7195388251908623 0.64220752362929867;0.26613879532905566 2.2121465705251704 0.4307339149929344 -0.31542172722828865 0.50803033378535578 -0.1962668049690901 0.90095220294375722;-0.7673367561765595 0.33226437209618037 -1.5232065641338051 1.0126677440137661 0.92957144579234197 -0.68748757049164311 -0.35705311279024854];

% Layer 2
b2 = [-0.51592741978668344;5.2286422836245423;-1.902902706685603;-6.1203909458474932;6.5819690738160821;0.25487233265602349;-1.8600686865039373;-2.8768817251573608;1.1664093968742826;5.0261489771354171;1.490410469085472;-1.062381128027295;-3.3050498390765526;-1.1875834373847149;6.2630177455994565];
LW2_1 = [1.0409648797615121 -1.7165341201615474 2.4412361466378276 4.2394584849967361 1.0109938091904471 0.29722758690008116 0.014745233962767099 1.7372119528551722 -0.85637267175350518 1.2842207437033524 -0.21319007791413025 2.7294680340507025 -0.98768907988297638 -4.7608317609043134 -1.3807731836400177;-2.163836330595434 -1.5354376584070539 0.8733862534409127 1.5296941678326903 -1.1641685927067229 0.81257362278271872 0.38418392115883665 -0.2084787967109778 1.5609182204720367 -1.206876436329156 -0.91004784053622234 -2.7192234222154066 -0.11984160065794208 0.77183078758843349 1.8910027134857526;3.3183220193022356 -5.4944141223055141 3.9599094835139583 -2.4924095649157003 2.7873108092906991 2.2430578866368842 0.12848687404097012 -1.923545678551039 -0.6687556216838294 -2.0433904914541334 -0.84841988214886233 0.20562424695386045 1.4068715867807107 4.3667514709145552 -2.7383580874445759;1.5333996188053272 3.486294896343733 -0.7272148742045369 1.5020276353103439 -0.58916232044044414 -1.5106009787724324 0.43856676399356564 0.37948003765669375 -0.73242460946658949 0.59141932280367604 1.3411299499816449 0.60012810861515453 -0.95159090007441904 2.4414161002032335 -0.8180597823486786;-3.7183110728943527 2.8377986388663898 -0.1572134613113183 0.38137940066712728 -0.62891471217846517 -7.1249851797961368 0.52732621745769126 -4.3433470702815624 0.15044776304837296 -5.1517785268547414 -0.9470410508300926 -6.3471039290307631 -6.6889090304902981 1.6931932177348943 0.53082287890707003;0.21844364506302752 3.1204483990148377 -1.5343539865271925 1.1956974675275918 -1.040196206450074 -2.0264420995743531 1.3787524078029711 -1.0638879421689869 0.32503541333162639 0.51649103164472598 1.7912116864374767 -0.25304367182133763 2.6472129143238492 -0.65751288314817857 -2.1189185970792028;-1.1741461619963993 -0.49956803562696467 1.4837261581352013 3.2752762783849962 -1.0908370868396218 2.7992008171209903 0.84683693502463708 0.73076975401141608 1.3550896692583956 -0.60449677091671572 -0.59243160448042398 -0.21184213501363591 1.2782449266372773 -2.6056892426148539 -0.75138313748894492;1.2772645610875506 -1.3611519188351309 1.3947375444550858 -0.10679945074780095 0.73750670035202037 1.1056634975241242 -1.1622162476311793 -3.5905970062778381 -1.4325620279649083 -0.63400947094359628 -5.596680510892118 -2.2498022009422427 -1.7225093941189988 -0.94313252837857553 3.1638843254567695;-2.6462849646528772 0.19615751710182353 -0.68106463722732746 0.95909853088921215 -3.6860203250120147 -4.2173351121528206 3.5940637060777876 2.5094493773747191 0.37016065870122028 -4.5883589953117605 1.1812135733956544 -2.403370041995486 1.1610700429691119 0.2148663424935105 0.44404738359437379;0.31442982581423651 -0.25804338320143144 -2.1383461096933796 1.4556477758538893 1.5502232290003655 -8.1204917676310142 -1.0818113629126778 4.8539662590553716 -0.22260448876309541 1.1951470859182669 0.58694154875880777 2.6489175385753754 1.2035971168631128 -0.0058935039573665485 -1.0599904236050102;2.8722093118444598 -2.3035258545216992 -7.7941278927926332 1.2209940737185425 -0.12299701508817744 -1.7398992936826176 -0.20351023435867654 -0.53098019973457611 -0.1289579343611604 2.8184592290481731 2.2593990420621259 0.19599615808135293 1.7369954336168127 -2.5542280282182368 4.3575148853526775;1.9862787569631202 -3.3324202637094125 2.7223461648794873 0.89409379252817223 2.3757175926860739 1.194878982458103 -0.33205137097930204 1.5041153165782062 -1.8217656836703409 1.423655239196959 -0.20816517156941081 0.99848681714579657 -0.48160315814689009 -2.6585565057118803 1.2041938882973431;-3.6736559312888954 -0.6797601538636534 0.36623202374030622 1.3335968238825902 -0.032046878437268146 -0.47177131773217651 3.2414620579359736 -3.115493022479221 -0.12423008124296468 4.0065101535676417 0.78834322571595805 -1.6488774057645006 2.0152132984376316 -1.2525979275268841 0.7546938589251031;-0.69980386394726235 -0.82940119578161875 1.7098923056769566 -0.70334102393176767 -1.2609425736916429 -0.0059549194525214226 0.35666081360770607 -0.62649441057762378 0.99966407397521162 -0.23709490980918541 -0.86660829375686765 -1.2880030504132716 -0.32943117626637908 1.0381287055802924 1.0170118821713237;-4.6940404278000116 4.3839619864661152 3.731197866796828 -4.0494267753020194 -0.62465294121415438 8.3509923282354475 1.6180750056362228 -3.8245330269185165 -0.010510638266604918 -1.2617100169346371 -1.833749736358671 -2.9422284844575666 0.095994758387298817 1.1339386430006189 -0.20878289200289196];

% Layer 3
b3 = 2.2321997585053395;
LW3_2 = [-0.24727493810396681 -3.0215106782372527 0.16609582827664784 0.21786042478919274 0.096963926837153228 -0.14482400777573562 0.26173167617232207 0.08386031420799446 0.076422745141918866 0.18065716922095301 -0.083032171493208046 0.15323522414384494 0.11447006970744826 -0.18077785244881231 0.23947254055519879];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
