function [Y,Xf,Af] = SOXVallarta8(X,~,~)
%SOXVALLARTA8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:05.
% 
% [Y] = SOXVallarta8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;10.4712041884817;0.00782778864970646;0.0208333333333333;24.390243902439;0.02710027100271;0.00630517023959647;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.675401428562731;-2.7346285114043436;0.4026376413205992;2.1027432121003806;0.29059585042218455;0.38094757720970268;-0.20304258203908107;-0.30592988423361722;0.06599957550074384;-2.318381634767773;2.2079019879398141;-2.1662525280505154;2.0665619533624211];
IW1_1 = [-0.089702834561952938 -0.1100514766042841 0.41631743247362019 -1.1218460650060398 0.824753934466119 -0.63466266516747705 0.65975719017064516 -0.36779526454557487 0.74059807088489926 -0.35333237543352047;0.0043656157905902632 -0.85845433109528135 2.8893198414766847 -1.2335873163786641 -2.0485775905116936 0.42456716621653473 0.33295262259791969 -2.2418614753475969 0.67639044945164961 -0.60492196712877222;-6.6578761425292559 0.49358116960527432 -0.70335137139904536 -2.9282754763357093 -1.3667801639687902 -0.64676809822142789 -0.33501948261724096 1.1224982994806985 -0.34660005606692207 1.9230496401136612;-2.7545741671551593 -0.059334994387610113 3.8728814988979559 -1.5267691568921455 -0.58730126122083526 0.55281571487407943 -0.026434307275664523 1.9156279037883348 -0.083840137575250412 0.66351057116309331;-2.012239822199053 0.3633952293899988 -2.7004856061636198 -0.051221142037426684 0.56935142564033536 -0.68690604636429342 -0.37722644617495116 -1.6638839242766912 0.42041267977002944 -0.62042794443215787;-2.9201627896214637 -0.59828409934878179 0.88812768784892937 -0.69669605056700235 -0.27571068890481204 0.70765499265099541 -1.8422773709251121 3.3912601715960227 -1.2159447805371166 0.22744556282825812;0.89972734848918678 -1.9068363930060375 -0.047800759149708702 0.36985668968591323 -0.34246447571352051 -0.63031507330835557 -0.34114074448238568 -1.272591229412358 0.78995504766013536 1.2500964197546793;1.9315191675173715 -0.49442259826827267 -0.93635158989816381 0.12552975680030926 0.83453814325513886 -0.94540314072872367 2.8668210348577086 -1.5117352745363943 0.71530867899408446 -1.7797018940426623;-0.2023277947456581 -0.65753533252820451 -1.0916592036393922 0.15930567972859866 0.64570661806318019 0.9278372385500856 -0.73774697857878957 -0.47461115093951212 -0.04780604376541648 0.4252743993198449;0.29057462136096424 -0.038160340685058095 0.64017994630260933 -0.37788316589914633 -0.46937224840550001 -0.33029749994794078 -1.9395545655428541 -0.42287869212552309 -0.16572043392832225 0.49459765819340595;1.1000432670535258 0.082410619515092931 1.8229056992970791 -0.37035731242047187 -0.47519603515319253 -0.69136457484928804 1.283764444572657 -1.6501226148756682 -0.031131247663440102 0.51802437406564616;-1.6626629679781879 -0.28085092121029515 -4.0531037650869388 -0.039417203381347909 1.128188167444268 -0.83646958173376595 -0.46190932402320506 -2.1366558899075034 -0.68916794184271279 1.0004150440884896;0.70501741536649898 -0.11234181706144994 -0.39594179186814288 -0.95010319687112765 -0.038703257138686685 0.46540139192661384 -1.1945234335985075 -0.28591951784810132 -0.21595875464046221 -0.79167915590911697];

% Layer 2
b2 = [-2.3110711500014247;-2.2660868986731142;0.98107058244496936;-0.77218562868245411;-3.6892183341434963;0.10818395421746557;0.21724259599410628;-0.22731669719505859;-1.0378074122846723;-0.17284422069392491;1.4654768125705049;-1.6969406061795369;-0.44434966392106057];
LW2_1 = [0.0061604850607431677 0.44606676598040812 -0.31935820606656384 -0.65426171393466392 -0.64094460940154441 1.1899619852119863 0.30860613041531049 -1.2114929879650629 -1.0201300528623856 0.51995905393158803 1.3341531618285312 0.47595272592133198 -0.0094263238280685377;1.5605288485530502 0.49756989165540227 2.2936331206498406 -2.3098769810001296 -0.48544323347882312 1.1274113075465544 -0.30327752604506852 0.36796324982678597 -0.60229238051063572 -0.53066420710194961 -1.5155323628492701 -3.7880673434729322 -1.5400743371797989;-0.40505435616606639 1.062367739734956 -0.35903609924035795 -0.47946883633643667 -0.29361951801639186 0.21487518888805351 -0.51707822239460766 0.1499057229812763 -0.28730850528758001 -1.1968876551833911 0.18340289599225762 0.86594895753298007 0.3523689447681691;0.30844257037892264 -0.19420374687282912 -0.28734198839941305 0.45273908724349166 -0.87608015243916837 0.85089974309252292 -0.23571169388735966 0.54032047436429143 -0.18257578332434904 0.50399765661665263 -0.53396337885139467 0.064942754110999854 0.21039559731051274;3.1611682136051016 2.9473717018220271 6.4964593301252078 -6.6293031763025541 -1.7409945540643776 3.7849862770599767 -3.6304614612218691 4.9659374406425858 1.8006553311741849 -0.81873164672796117 -0.45346308259483625 -6.5420636488039161 -3.3900191178006875;0.18704260788598873 -0.24258856082009231 -1.6982453011746308 -1.3183751483938417 -1.9834791227331592 1.3294342890888551 0.0058435124536045518 -1.4589978178491945 0.45717451111479179 -1.5159202682769022 1.2853629712887609 -0.68505038551634756 0.34073262708844992;0.72310645415645125 -1.7271483118202948 1.5938551673660535 1.3431496061092261 0.20946478588776429 0.38279295172925787 0.57111312224493893 0.7539528395438897 -0.48487744414402117 -0.0453295041989909 -0.83995981771565431 -2.2420174595593978 0.4274190064420415;-0.46693691148327504 -0.36979916646686484 -0.58668280386693561 0.58424216917169003 -0.31140026115472874 0.40912535758606794 -1.1077448506573138 0.55484208216530462 -0.62456227563327193 0.34132808340500953 0.60697201213036378 -0.17859555001451199 0.5100770152279841;0.69132845239634821 -0.83779168902694323 -0.35811265093396905 -1.7216964923692089 -2.3459516531240707 -1.1750780567689274 0.36116423224193694 -0.20443176907591892 0.025487711261438076 1.0628089234984885 -0.1371791439131046 -0.78575214759853718 -0.093446927083672707;0.19945048731019344 -0.8459208013080044 0.18147868117372506 0.21026268369353457 0.11722981908124225 -0.060282375760197043 0.50285715202233494 -0.19663508175759933 0.22502079419416007 1.0323048249056834 -0.16302410958437302 -0.81690175493349093 -0.97485633904317037;0.51352610614223704 0.36372900127032498 -1.0775633960644277 0.27988009645241457 1.2750207463737913 0.34481310933755766 -0.1563072709984264 -0.63269364278667906 0.32733199482355158 0.6916049416752964 0.092082671897071866 1.167285091251606 0.36897284312900558;-0.91307552918395651 0.3892092021009565 1.0910341993455284 0.40515646401683858 0.16026344785551183 -0.94148178407277161 0.15843600622871065 0.54542711357153906 -0.39150694488734517 -1.1268116473703058 0.18869143146294159 0.48253044294788344 -0.095750634942712062;-1.666522160051759 -1.4588787146409075 1.0480656824012182 -1.4745406441561408 1.357108021765258 -1.2440250026778497 -0.04367064245559292 0.92253265045289001 0.97591571921953035 -0.6771561304931073 1.1933868891019088 -1.055228132383069 1.8076837535020718];

% Layer 3
b3 = 1.0238043542994701;
LW3_2 = [-0.23794341697081256 -2.7948872513366476 0.9252685753150196 -0.44827554842254957 4.8095182920244639 -0.14326719300262725 -0.082766840528445004 0.02831135267327313 -0.32528614381637222 1.1584267135485404 -0.52603827077659948 -0.1760801537779757 -0.32412861450050207];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
