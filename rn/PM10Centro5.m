function [Y,Xf,Af] = PM10Centro5(X,~,~)
%PM10CENTRO5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:02.
% 
% [Y] = PM10Centro5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.281968137600451;3.74531835205992;0.00773694390715667;45.4545454545455;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.3816710988975749;2.1875899234228737;1.3219693657704137;-0.36270084766343302;-1.5770350971967952;-1.5222259747096676;-0.37823488048292547;0.49174953564031054;1.3513854786398154;0.303494220366677;0.61716956013051538;-0.5489406087656582;-0.94487825735181741;0.96908998814804193;2.3654862011780713];
IW1_1 = [0.25089614401023491 -0.82783032829619763 0.23254952876356635 -0.38129686201465018 0.66104573699672942 1.9229592146336889 -0.52488341820881201;-0.30900740712185581 0.95451054945598235 1.4776920734045471 -0.2021155108741037 1.8198097665739166 -0.61418973187220072 0.039944955891497574;-0.95274161263661339 -0.38908599338177119 -1.1556421917090001 0.31634277092165147 0.5133729030861508 -0.9423491281911609 -0.53897989677042268;-0.34473269725790012 -0.71332581088905356 -0.467767144549879 -0.21468690256764322 1.1395341760726643 -0.77386213963920214 0.47993162105684195;0.92857381883441692 1.6332130154298523 0.16527663471420975 0.67626559189593416 1.3644514976530735 0.30521307563224803 0.40682235250255988;0.72498113836222322 -1.5957251802803716 0.36611090795006768 0.71797024979239865 -1.2370625964331174 -1.3402541553885987 -0.30180424073518153;1.6643731216730084 1.5461405127141414 -1.183632146109477 -1.1142751494212519 -0.24773622654014688 0.53958194374807333 -1.0651501645251289;-1.4373519555665693 1.1485349051531006 -0.82840447610679169 -1.5371418851799328 -0.35827194201549822 1.2256604145684791 -0.45442878350668525;-1.668952126495886 -1.2709471146380451 0.0040338737027679761 -1.3085852310464299 0.62190875714872007 1.3930037577377627 0.015700361613305985;-1.519995375340025 0.14214260417061292 -0.12267728913778511 -0.93350006547753983 1.5438742353589487 2.3187404073249169 0.11668954676394411;0.53296288604799569 2.3754375172283444 -0.91794850538260253 0.73741639009912274 1.0659654809888912 0.12140989583823902 -0.0041285179589979001;-2.3513349431674881 -1.2326447879482161 -1.3195383156731584 -0.63963197874824607 0.56015858389081208 -0.48929891080427323 0.37254762381388778;-1.8207250688578771 1.8182399954762083 0.20060053973086614 -0.68175483378846069 -0.47262019103835046 -0.47325764170463358 0.45295135758601857;2.9469307687637216 -0.48700408112264681 0.60596964286843791 -0.15961487037126196 0.66887148866638191 -1.4903539627482556 -0.1897797800836305;0.42291082647987555 -0.033954957532351698 0.78647525267615548 -1.5269692057196065 -0.68589805779246382 -0.3107030789489823 -0.61181863827540117];

% Layer 2
b2 = [1.3060662470147666;-1.6595551572255962;-1.5073623619723209;0.70972566608533127;-0.8476966140241311;0.61651387277332159;-0.41291385510240713;0.16572414607506616;-0.29067548242733282;0.71030594574112882;1.2033160863211569;1.2046124692846185;-1.3091237108202058;-1.3132820140470602;2.0018645115681393];
LW2_1 = [0.29316875301483791 -0.58192600112411452 -0.42625920759178576 1.4711839415467967 -0.14875158762422408 0.048188341678927632 0.23503939770479751 -0.56288519370538148 0.41942402234360621 -0.12880669136101175 0.71921053750688491 -1.2309260502031334 0.65578897910250122 -0.08999362349896764 -0.12240537972906247;0.96660427048235653 -0.34835807254573609 0.14124582404771685 -0.47245317015259086 -0.17163519417981921 -0.11741691658702537 0.64392164215043668 -0.54627733695668534 0.75386854086458654 0.60000311543968565 -0.44599423328600141 -0.24912300440663335 0.18231535607381286 0.37856093866020102 -0.57057389627619526;0.56489008087085335 0.059564524651410135 0.16295178737393357 0.53338546340197912 0.7693942396989244 1.3449186331474656 1.8311695738277864 -0.68968714354891747 -0.085960391502373112 0.50046138656765482 0.44722706282478758 0.47381424351109958 -1.2879145584224234 0.29183593990436824 -0.46140202335893782;-0.28241930350769678 0.47809066475665984 -0.84450833630015132 -0.72575465588664634 -0.56539104140447705 -1.4508018576361514 0.12996506402432317 0.8484114627927658 0.20075120409109859 -1.3077501238511737 0.5159830317074976 -0.88432408203911506 0.14984629017571396 0.63495365504219881 0.50674419701572249;0.3165710756800138 0.81769858919371274 0.083722628222921924 0.1228361429973942 0.83489602325262791 -1.624772392137829 -0.63165042905924818 -0.41047623190480592 1.7198595869590152 0.55462376133882751 -0.6719283812194019 1.2389464835062995 1.1135504652181998 0.20076952584851274 -0.42891179201930696;-0.55993643713076324 0.34125311398109165 0.42445618674438462 0.73052456559415868 -0.35824111744268117 -0.4071265155979934 0.30677087957658966 0.77604441627036058 -0.19186970391359243 -1.0191535888521284 0.20008577073292994 -0.70331227167422583 0.5865194914711106 0.39548603806352756 -0.23140122037357663;-0.61417120658074764 0.33552379099912971 0.045171598647622394 -0.32368696117159135 -0.94127661573252219 1.2798841155256067 1.1534720045026816 -0.70210146629391712 -0.48476861550341394 0.36961113157217534 -0.091720649034552432 0.91300859761967068 0.74924128198236284 1.2990789874413191 -1.0166782815661304;-1.3318167610869616 0.76834695193111502 0.5847914647718867 0.46131687026187573 -0.28199694171858491 1.7768373457395259 -0.11256839448971492 0.024327929838923058 -0.048679378480690608 0.2997981983537259 0.30513781122224098 -0.56198444852097029 0.66514769455950007 -0.87154217152065405 0.65211868128393879;0.46871721326770971 1.1016608606299534 -0.23007838566936878 0.063152524862075121 -0.55788077700629213 -0.42624114413649483 -0.24069883845792095 0.22879708892631773 -0.71752513542525542 0.23481729552193678 -0.67293856141049968 0.070540037827218044 -0.91255720089757009 -0.66293103557723976 0.10975190631850885;0.21113790486063491 -0.062142206625449656 0.10797038485580417 0.048598901275011569 0.40324218244882237 -0.67997401330666118 -0.011821488564850949 0.062399641430731789 0.40403569464898559 -0.73322746834001273 0.67500248345482994 0.31053373774163345 0.55417110205142428 -0.38802849144538587 1.0847594806815548;0.99708095618636849 -0.36671328033109263 0.081556218451406037 0.69971545820885106 -0.68691022543858538 1.1870900713116244 -0.24538098505302963 0.26260749245835796 -0.19374560651845504 0.067349423340286096 -0.70868383374122057 -0.31185739508122257 -1.2988588652532713 0.75598042106319518 0.63845834686409675;-0.095935443764564782 0.39386114981668086 0.20694088866617466 0.52932303084097321 0.2661700361934537 -0.49389149316620934 -0.13018985416615778 0.11864247251943981 -0.7662292790123677 1.2739826499585241 -0.76645096903564425 -0.27650538669640645 -0.044283597118291815 0.62569111833738555 0.17839440452924307;-0.89596037490742153 0.34571589519211188 0.17286168010744171 -0.21483465593375112 -0.057922685682276022 0.93909276954901599 0.5231049371100811 -0.44026096505834533 -1.1667453533755376 0.85809673882555049 -0.21867071816199909 1.4013761260842961 -1.0352320898457403 -0.13926774677262296 0.10752344490546753;0.30559348435919387 0.34731469800970732 0.080767134125714249 -1.0287062377334033 -1.643957618356068 0.111413441482606 0.50610890408797038 -0.51087620731943995 0.41770245192682676 -0.36865700634198362 1.2085252785861744 0.59297406140845299 0.59206519759682319 0.097722874428115059 -0.42932600156597311;0.16175064426045904 1.6150172977163491 0.61962214282140449 -1.0692028409552639 -0.12079904558549673 0.97733798323202481 -0.71193474854393057 -1.1401517960221454 1.1750685147388418 0.095076460142706432 -0.52366397533665476 -0.09727520837718498 0.42726106955676135 0.56062380184599403 0.35437243799497237];

% Layer 3
b3 = 0.40048094907147475;
LW3_2 = [0.35799959241279544 0.15776287429201569 -0.32685727121600727 0.44428090996901815 0.052783933333798848 -0.10413781942853471 0.33748958988628142 -0.14770016186457324 0.38556832262010754 0.49968785900418722 -0.084031807880747073 -0.32075714619770473 0.57224387466348725 -0.42607670941969134 -1.1972278286110341];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
