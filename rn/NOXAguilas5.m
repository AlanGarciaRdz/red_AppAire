function [Y,Xf,Af] = NOXAguilas5(X,~,~)
%NOXAGUILAS5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:11.
% 
% [Y] = NOXAguilas5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.2963006188229289;1.0190888854351676;-1.8517658985502443;-2.6055971296209584;-0.25084083348424302;-0.58126436564134987;2.503451689404887;-1.6492941237827787;-0.25521041110397075;-0.41669900141526589;0.97364904903074811;2.8858919528044744;1.9132621678111938;-1.8032957328049317;-7.572772938524273];
IW1_1 = [-1.2087955242517585 -1.2538604577287995 0.18058601034518326 0.59390431993826553 -0.59843263540242575 0.44517464217479824 1.3845137644326195 0.60765658622046714 -0.52959084390053812 -0.16197596203095863 1.5180021345795263 -1.2787451225935049;-0.55318048384767771 -0.3767820702854951 0.45623935548473832 -0.7193487544868078 0.47165619127690328 -0.34247516412131834 0.84107212792153896 -1.0500683310608927 0.074246869855834327 0.19598447184299289 0.30108869687325618 -0.55947426808610445;0.35890468332150949 0.95347035789546308 -0.058787299325438351 -0.39337017084183745 -0.61419156657431162 -0.56701335358352634 0.72665045607928613 -0.14324634215038401 0.0077159731346011463 0.22504568227513735 -0.080447765624934484 -0.039867373011026497;0.64222414554943452 -0.95168358720329793 -1.3814650315858299 1.3266918706804083 -0.052644585571133259 -0.31458382003832958 0.87919100307371723 -0.91841601761138858 -0.059104001084047043 -0.27699266892587476 -0.21384239305220504 -1.0827542629278888;-1.5626340104546903 -0.76772540787295118 -0.43609294219186945 0.45715333510792533 0.81696248303823538 0.66754662594826553 0.52889852765871359 0.14186952357596505 -0.062433916194570872 0.021775974144548953 0.49865649202523998 0.021973112479721963;-0.35463543930037561 1.9183269336165814 -0.90206273450079477 0.5430226751652788 0.32523210982071271 0.35739404123263413 -0.80505439970949189 -0.8802759768440277 -0.48593201708754385 0.31850693832943511 -0.17984713277646575 0.26199033988125425;-0.86745084362682379 1.0760940252252242 0.72728031683634498 -0.078972413249758622 0.42373315641667869 -0.57707580729760188 0.93216736118134846 0.41749754641030457 -0.078906593555402679 -0.18553436219254857 0.37164070359222168 1.7797566165756125;-0.02783054360793636 -3.3822151082997629 -0.33905058441608454 0.42059547399844138 0.089507380975695022 0.25121124850472731 0.18848034382684589 -0.39161687425524511 -0.011951581480353789 -0.13667837754436352 -0.044197350285692404 0.027759180042835275;-0.047297853268707654 -1.3934022710869973 -0.56003104838389817 0.72524732718414608 0.47817063650716252 -0.019753120345336307 -0.77509774271718701 2.2306048287948514 -0.23708905288851537 -0.3526164283027623 0.37874645208979696 -0.025391994018498273;-0.319637768698041 1.8381904288742976 -0.64232883314675004 -0.021828541873234058 0.25986805645975203 -0.42364915379841972 -0.35879201235227459 -0.47529220187550908 -0.16922550076153078 0.28878648002760238 -0.34655037708939229 0.33113324404458383;-0.26357067640074233 -0.58129185847987874 0.28962611720923459 -0.26939767782048918 -0.26027000253858529 -0.25360888373281926 0.4040718313345818 0.58527600757076503 -0.0097645959047225252 -0.15229859307175037 0.77650290117019771 0.56025986792186677;1.0540207777743622 0.31054831877148059 0.84854598809559378 -0.50046780078451081 0.68556813417076778 0.70577012757316426 1.2148848165951569 -0.26341255670533575 0.30535829050891133 0.10382391011997182 0.50863857086652897 0.0012052642145535183;0.66990448663318891 -0.32259052239754227 0.35676006736696958 0.69256838654956066 -0.58573438072672879 0.31198298425019977 1.8587003875863737 0.3889528080010593 0.24031337257501564 -0.43697706001036452 -0.45216440068662189 0.0056233658131860402;-0.61726406111691923 0.12470001955274314 0.50764120990369854 0.77971953101069136 -0.32238194204621223 -0.070418306751530046 -0.22181628898028041 -1.0755820591401011 -0.15943946156938493 0.44084369401219725 0.58041530288491461 0.37542173037174514;-0.21540470145782306 0.2454832567848029 -1.0391389887062827 -6.0291099305391231 -0.16529323072886171 -0.33744242742912373 0.036443666788251346 0.27699868474959743 -0.37625775026035579 -0.41002505671715012 0.30899627749963809 0.33384475307780248];

% Layer 2
b2 = [2.5740051662167454;-1.8368079752523276;-1.0283321304891684;-0.95521289476460702;0.5441595829537047;0.18010078870594826;0.526911406566267;-0.77593016740115217;0.59430008731630168;-0.88334051325950025;0.36597652415616178;0.89750474263624147;0.89068155531869198;1.5534046422200567;-1.9287588132279234];
LW2_1 = [-0.09525704072211913 1.7032387287591926 -1.939263242842197 -0.19645486524115724 1.0913010334443951 0.36357428512989132 0.75392374004505347 -0.39853799604448303 1.1795914773980321 0.075865914951756111 -1.7098239453705077 -1.7472450348320063 1.2735891329125864 -0.85731335398561337 0.26546278954543101;0.78299803014733704 0.27477536651643003 -0.2574790782271334 -0.3024962564560027 -0.27689983223112125 0.53638042150871901 0.11130464663936339 1.4031028030627017 0.23265735733712414 -0.1779019124267785 -1.0380610657458815 0.18017291571245297 -0.73608752151298951 -0.10827375970521813 0.34649076683897395;0.081147305202321121 0.18930031891344451 -0.79739442026027951 0.35889645830479078 -0.23445047677323022 -0.35104291208961858 0.10844574088255142 -1.4096865419088185 -0.37073746845593442 -0.16006132456474981 -0.25282244175673774 -0.15333269080329037 0.21607124435815686 0.80758905554882454 0.9724426274567799;-0.030824729617305036 0.64351888386560385 -0.6425283774742403 0.6632239098413546 0.84411814629335302 0.95957660505883491 0.21796066586276852 -0.69101762851010629 0.0046805994688152597 0.90390628370849635 0.55198041749933202 -0.40979050185051219 0.91344388341381322 0.0096613751137240734 -0.24119102455631852;-0.77813813072377946 -1.5838781307091052 0.13567858788376297 -0.085849024874512639 -0.3936167699841161 -0.77958042987591114 -0.33593098271212335 2.0743273949815531 -0.28579006482187774 -0.56821613430298523 1.4899069002670227 -0.44176825418682336 -0.90288667610317008 -0.048327742086415687 0.78657864302711367;-0.097471935392867762 0.45549216395865405 -0.2746742044187892 -0.22991363478446394 1.8516398299117667 -0.64327323523790858 0.046070362198891233 -0.21576587765264441 0.044097674883786762 0.83746907129769199 0.011568000926953061 -0.78584042681975819 0.38934592479800317 0.71747274420971885 -0.21981695728428252;-0.7489851048814653 0.33058767615172713 -0.2627038666665833 -0.14925207069963592 -0.49869885176800693 0.23314426859124762 -0.20361282558612095 -1.346707509214776 1.0151308275431321 -0.31685911027673908 1.2815974894362845 1.3231788983430237 -0.29291375982591972 -0.31256973703805618 -0.37791403743309271;-0.10688809526858084 0.2064784424823862 -0.49397548119322771 0.081862235190217916 -0.045717412914477354 -0.34028592326094004 -0.28993402737544938 -0.97088319907787368 -0.16798185606521998 0.058003708980023737 0.30571380623998606 -0.014262486801540009 0.15455144596905246 0.33351212752016651 0.75667819388901458;-0.18455115376903122 0.052724029225771039 0.56383869849812118 0.35303676124706695 0.37646160879846735 0.013275295390062596 -0.47566131218046853 0.71405616078521572 0.40082134159736821 0.61249233748950793 0.049460095989809452 -0.032649584574990578 -0.045170569751755534 0.38188321489569915 -0.48098808502316243;0.27273894263882364 0.37606429538464464 -0.4261879005394405 -0.57394544113286183 0.2415494273375971 -0.035442078450719144 -0.35890549868206423 -1.0414587903664441 0.11345321064521278 -1.3280637506213122 0.24400255119718042 -0.21710876132876866 0.43896146276036713 0.49826669936951745 -0.12150533751427967;0.80848667378413008 -1.1360196273943151 -1.0629793234706539 0.08689942816550128 0.78565503530595049 -0.84464798300420973 -0.32535366381876435 -0.10803123143841223 -0.21456632430897626 -0.71371502617753346 -0.62632132771579463 0.52409518074776607 -0.43095016566973754 0.50211808703934868 0.73183291162951225;-0.50732270560845361 1.0875988081403785 -0.1020938134237333 1.1442321519266907 -0.17960865665466619 1.0096759797006483 -0.6473936351130104 -1.3119378788494109 0.38338823814973089 -1.0709781211288116 1.3878329858946012 -0.3688354349519945 0.8936864408989712 0.22368385100294866 -0.27565125103208826;-0.074945871639536837 0.49018075958802959 -0.43737032940119408 0.4793599306962093 0.58749330487496088 0.0010390174366113961 0.09606330255990235 -2.0201488184835741 0.1987682156713268 1.5101496027069667 -0.53711888743481417 0.16497323532506117 1.0353984893510311 0.24203233047372197 -0.9599836516898882;-0.0036829655325481166 0.047030851849743198 0.74113803185661609 0.12559159879317369 -0.032189305526296792 -0.18106775023964389 1.0370916453661763 0.53049560546849228 -0.035912522753226032 -0.15203076221380155 -1.0890613757123924 -0.60042353904115031 -0.41033092344688249 0.34939925287450613 -0.54262707378764763;-0.37076587597047583 -0.80669787091877931 1.6941741403434836 0.18419528728990409 -0.051832183317106817 0.25620012169739431 -1.1119496586579543 0.23320143328787932 -1.4540367876865554 -0.39722190786647693 1.3040722762839732 -2.1731303968799383 1.1208286205562927 -0.26765525173188282 -0.86443456264689311];

% Layer 3
b3 = -1.3413646149896368;
LW3_2 = [1.0611737398398917 2.0539422014665649 1.4930890050963903 -0.75885353820641666 2.0403604188007249 0.77342192348469641 1.1342370149527552 -2.5705563296085758 -1.3878761196098355 -0.71797579065193629 -0.45305114559046222 0.80568404824606588 2.5493261692996123 -1.0629352642100329 1.4120615875455464];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
