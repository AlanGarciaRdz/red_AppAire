function [Y,Xf,Af] = PM10LasPintas23(X,~,~)
%PM10LASPINTAS23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:31.
% 
% [Y] = PM10LasPintas23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.0251256281407;14.7058823529412;0.0179856115107914;0.00280033604032484;0.0558659217877095;0.00576368876080692;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.3892176478780611;-0.75367602529782751;-1.7290579817038478;-1.323495773891598;-1.0175025749710076;-1.4640863006143559;1.4987622895054669;0.26877925352161691;-0.48768159352725582;0.082731847191242894;1.0740447805757738;1.7091645130658846;3.0521590620959773;-2.678688400381358;6.5262526169609316];
IW1_1 = [0.74321123716329385 -0.31526029825470075 0.2299443825166792 -0.767446456973647 0.56400397265779212 -0.12261230140330955 0.82700135714953338 0.15809938488969202 -0.93973620409083181;1.9462638069978193 0.0022788301289923848 1.1687803586977377 0.13513307543739314 -0.3646275141310959 -0.42501867835455065 -1.6445641571060718 -0.072903187843471731 -0.047208369700370983;-0.34222139384733846 1.9251983887750959 0.30544490724600287 0.37101483638829469 0.94063883963119654 0.15343996467804508 2.3297548746706713 -0.95666295850868732 -1.4463565324396244;-0.11429984906233062 -1.9340031114045118 -0.36252033791282456 0.1095515840665203 -0.18736185329086469 -0.4693717710229251 -0.31450353207146137 0.016412753978015979 -1.0996419227648535;0.65589755602710076 0.057424552095800212 -2.5697920839398174 0.78113904122379541 -0.91625688757235446 0.19897741552303438 -0.082285204050029204 -0.095323257758383656 -0.1171493735212107;1.0185072890796127 2.183104295213246 -0.64980425300803979 -0.28178445049554335 -0.024844610048487193 0.029051710634556922 -1.143646005855895 0.50711003054579229 -0.25690580551832271;-1.7266655194260745 -0.017827602955566509 0.48695985321772733 0.24529609048904039 -0.1526999787895571 -0.89515301849367457 -1.183310813328821 0.062545948263064158 -1.0289703006740587;-0.46687606355510447 0.72711504175637487 0.10931634786873763 0.075099660851015812 -0.13708729886187498 1.0221642262884278 1.2543100852929272 0.089645197208426647 -0.12433238856537067;0.6423993031908708 -0.3732763735880163 0.53849101741226457 -0.48513701029242667 0.885788130024036 -0.0041062413196632092 0.31467974651156361 0.070341402378824358 -0.18442007149292572;-0.73088418293657798 0.94475345258168508 0.038490856826991021 -0.23391183474507996 0.55336450421057537 -0.076067901135435143 0.49026756573560576 0.094113682216029393 -0.95178546100198613;4.2423258004733899 -0.025886665035895689 -1.2230123510585873 -0.6423472325752918 0.089868262388814082 -0.32447516621911604 0.10498230746959207 -0.075117366981591341 -0.26885557902759488;1.0604981598255925 -0.086901222954969284 0.62649030019631335 0.13340036301714661 0.29820348951163583 0.0031730385640538518 1.050528520199328 -0.029168011300579045 0.65990218974468062;1.5699723850492018 -0.014206827798936745 -0.071575663737469847 1.9409193899621733 0.6290498637322427 0.20766473150216577 0.47014990319445937 0.077069558983818426 -0.52795739405161124;-1.393465469927005 1.5284761051967968 -1.9967828208276859 -0.31375578122114395 -0.37834090644711493 0.47471164750126582 0.0027058640253590826 0.099814858850942295 0.85286380532366002;3.7466090758849995 0.240426167574608 4.3082524240332507 -0.74904682413021406 0.4989956541529198 -0.377850918625525 0.3987361303878032 -0.069929246500155848 -0.35857045267061455];

% Layer 2
b2 = [-1.802841239159942;-2.0021680292795652;-2.0857957782640115;4.2049729862537903;-3.563096620675736;-1.6513082275356956;1.982257179723947;0.41214289671424154;0.43479737510604005;1.2830482330273523;-0.41151434103890516;2.4221928498940595;-1.4814228322939671;2.2855395380713928;-2.4201743392449022];
LW2_1 = [0.84147060464876999 0.061186384980214704 -0.23148318855110542 -0.049257490278295672 0.065486718464569993 0.016628812888846701 1.3496631602855023 -0.55682361960006943 -0.81952027874534161 -0.055977766022206749 0.46198670251960378 1.420998494032832 -0.73919362457736315 0.45254004360531735 -0.48876286071211839;-0.53200504205979315 1.6457226261621123 -0.3115720580491208 -0.025473284696956595 1.4542075848176998 -0.60096623596513743 -0.63854659344670517 0.37329929467924577 0.62528070271818226 1.0358101197581755 -2.1516411008166925 -1.6024520198000785 0.73684495879601986 -1.1406407344527003 2.3242203043536245;0.80071999193650878 -0.57112119291248298 -0.60173098667262914 -0.089885172389980311 -0.36898090388270677 -0.83947478768754147 -1.1687741660877431 0.84595110427329978 0.018701694761033776 -0.2440501170352736 -0.79209814538572287 -1.6846439083117488 0.84662121227108411 0.95219538135923409 0.32818826232400217;0.15377646574338558 -1.919564992094885 -0.39507966649514359 -0.25409045492097071 -1.0733957721680714 -2.7821304345353446 1.0772168267638982 -0.44147312343992867 1.7839470530474495 -1.8803680742664259 -1.5373439792360357 -1.4196530565460794 1.8681795289838978 -0.89851318961313065 1.0640525599473334;-0.66511788402772931 -0.66724754619592408 0.0084157528870304824 -1.714039287105326 0.31697687796257457 0.1654540586724893 0.95500554880187627 -3.2103230833930771 -1.3308335967474541 1.7679111903178408 -0.03704975581691404 2.3688897474390993 0.93438747672776212 0.016022840053424636 -1.2357291307939631;-1.3149990685616115 -0.21265270664785474 0.3925163317925095 -0.43810637836646893 0.24847593988197159 0.93975605798684914 1.3634644239171294 0.3334223609323404 -0.54779783673234261 0.59295253406633164 -0.42551592758024026 0.84935318688876893 0.70197667444122414 -1.7546582307098204 0.44992316810108274;0.86514154132135157 -1.1884062351813671 0.24967349710257974 0.57763110147874719 -0.15987540357719848 -0.44467565284420052 -1.1436983273385632 0.38439595958673722 1.1914153562625251 -1.0449022589043262 -0.38919924733410366 0.58317992663527374 -1.4322480571060774 0.70628223198398066 0.53770268370130536;0.30705952247530754 -0.49784260135230307 0.1634313018146295 0.15121460338048326 0.46818320366429089 0.2854883705049725 0.4100790594785072 -0.56012379690499003 -0.55873355544556536 -0.14528426187892818 -1.0510892010559385 0.62216834526907716 -0.48098761013432745 0.33258434545068699 -0.19388367956220606;-0.28119611653012927 2.0057015067105763 0.37999146303995918 0.46892222230202835 1.6576641533085177 0.58769336777855119 -1.7230263272675841 1.71122769178114 0.53872903353707569 -0.96874894270746326 1.553117324989342 -0.24749102337357415 0.0065452975518140791 -0.53673905942740963 0.067785679576577704;3.3952001424273304 -2.4714313121623821 0.5300138272893371 1.4935752933675421 -0.61962926178339373 0.18320630680219588 -0.87014818796185944 0.28379561474642073 1.6766899177626526 -3.9373039868719752 -0.54111329781163497 -0.45275791929097597 0.78141477959547123 0.94166038716538436 -1.0930195847951731;0.078661879002939264 -0.0069635049768431989 -0.1674238119869019 -0.12552811368706659 -0.27202933240802152 0.085140419501636366 -0.3759200809198755 0.28962067877839059 -0.18569830671644741 0.37564184924151056 0.18138603857014385 -0.38275820488805501 0.44769842760511919 -0.1372333714655479 0.078908226242054263;2.8606078213652637 2.1689560343444629 0.27449912803789778 1.3551130962102438 -0.31047700440658316 -0.49805496892954099 -1.8229090975220186 -0.84581132420948257 -0.19350428114048854 1.1062977020944873 -0.038928453907257007 0.91060992055937862 -1.6040080331766728 0.91184177878466732 0.087883385970311756;-0.63968877893432263 1.1647479094526896 0.35806121050500772 0.73147168062074908 -0.13171469796998944 0.1738267612326109 0.023042921087596653 -0.82046213209082097 -0.55481410214178284 0.06889046054857674 -0.064636118877840321 0.29498017262722498 0.89196471731633675 -1.0932569195479298 -0.25465243055918735;1.5222588892511362 -1.2618926818970055 0.33580107018513611 0.07520920761914629 -1.5200641686472178 0.65503687149910483 0.11464394101570763 -0.15959596390479663 -0.46436022917447423 -1.0115162103789195 2.1809780262228831 1.4307605619119093 -1.1533995665606174 1.3716639204181562 -2.2400198617647917;1.0117244887164214 0.56150336526306599 -0.30298211219477467 -0.077195971696866456 -0.32497805355746234 0.23726846994098194 0.71997488863114356 -0.51159269905260873 -1.1776806929209582 0.41745685289842943 0.39446660783118986 0.30389090328419016 0.55604540695151872 0.189926320050647 -0.26213208722202563];

% Layer 3
b3 = 0.082443280958648391;
LW3_2 = [-0.97700596457697764 -1.7526273348463401 0.58398653680380652 -0.44706314851572565 -0.20369496363238998 0.43726793940128578 0.77862800171182844 -0.67087872602269694 0.29134444755349709 -0.37486630473835203 -2.7437909066120407 -0.41974752880972055 -0.93150402111721931 -1.696492907512656 1.7720832721427611];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
