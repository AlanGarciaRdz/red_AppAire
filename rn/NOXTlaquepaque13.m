function [Y,Xf,Af] = NOXTlaquepaque13(X,~,~)
%NOXTLAQUEPAQUE13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:16:19.
% 
% [Y] = NOXTlaquepaque13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.03490136570561;19.6078431372549;0.0212539851222104;0.0523560209424084;0.00632111251580278;0.294117647058824];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.8673634241638011;-0.56717066182556375;-2.1054280225966009;1.0184126557356215;2.3132508601479493;-0.43193433379700247;-1.7476677598574173;1.8613639778592954;3.2714472940438832;-0.10253308138411851;-0.24032835588793872];
IW1_1 = [0.60585429995108975 -1.3699707139887303 4.0345563996999347 2.2396517294201037 -5.0507526576638622 -2.778882079389084 -0.046115783068841863 -0.17996216866964407;0.66159595174842345 2.4142852993536406 -0.09851767264841832 -0.71526986639916246 0.14517572174089191 -2.6416841212277991 0.13704531309011445 -0.85135845560451018;0.5927463951540608 -0.043459252709913028 1.4019091851799494 1.0288991944641157 -1.2829569178878681 -1.258813595205017 0.029243341406778676 -0.76541743710861998;-0.4078202583930064 1.9553181693440269 0.42785718190857608 -0.096536189274830667 0.082911373286769424 -0.11327730324042674 -0.20014800047671144 -0.075396117403561003;7.748668110098424 1.2496382803648396 0.28769106603770417 -0.94059849158905806 0.019582236547139611 4.4243170214918974 0.16564650880908055 3.4394017603289928;0.71184931234170867 -1.0171841904138634 -0.2567396498257884 1.0259370961393566 -0.44028557009473862 0.78120759781646909 1.2558994619529258 -0.62551164640395995;-1.9464981082415478 3.2492068251404982 0.38815830189402595 0.29630962602918276 -0.044313168969736097 -1.1471932570820491 0.011172782761576693 -0.3912601182656596;-0.63173745011693472 1.7687734793847063 0.87269921458019073 -1.0035823114656799 -0.7529531212887326 -2.6856740105393979 -1.6506701504004941 1.2614955821022069;-0.067006210713430797 -5.0564296840277398 -0.20254307695246779 -0.17333894793674665 0.019699522949940557 -0.93737356176914766 0.068118570578237739 -0.056412901938752862;0.49093179522267844 2.8859451315565638 0.41664692354358973 0.051077142522098939 0.4679961734077468 -0.21504363902829149 -0.007075439183672645 -0.3613346906282312;2.6153930649827428 3.8926661483033738 0.097950333270873713 1.2326702082132841 0.24072827285903253 -1.821202465702505 -0.049321278643042102 -0.16713354817957421];

% Layer 2
b2 = [-3.4025823085476987;-2.0872513720348507;0.90128539952267617;-4.493452174766599;-0.00073261304539193328;0.47310424181257549;-2.164774384754335;0.19133618269822175;1.5518967768016063;-0.6973060951987019;-3.7237630017313852];
LW2_1 = [-0.22768623925529308 0.70004781327293619 2.2839628334753663 1.5842942609046087 1.3146262582971029 -0.093391297690558289 -1.8191803151575006 -0.21523245066743699 -0.95221687926771159 -2.7043572636426099 1.2729719534567054;1.7464560270613629 -0.086520014957581604 1.4058323331759635 0.61804095941499571 -0.82753802426661938 1.7957371407864986 -1.0215929005504079 0.83722994444420806 -2.3919422872744218 2.6265120977690768 -1.6690620169517145;-1.7442087275862344 -0.7671822684680536 1.9299556445353547 -2.7364828853758247 -0.67473615035270385 0.13897111352645763 -1.4959659728122814 0.44286217036081343 0.91162308980589879 2.5167399480013435 -1.1961188505919669;-1.4079376502563019 1.9268957485491078 3.9935438347458008 3.334791226031359 0.97732154026325668 0.29435872593243673 -2.7192946317194724 0.12041517229355177 -1.1789872001808499 -3.7942399615528561 0.83638621433737959;-1.4202651514234523 -1.2907263734517482 0.71711526615285071 -3.3692848715742221 -1.032414080499449 -0.26957646854820388 -1.8136957878911786 0.21046099010240776 0.87303108985615396 3.5216343942390229 -1.3674568069321353;-0.57056567293423377 1.1776280969208432 -1.0435954471066864 -1.6387614196014568 1.1190450732293225 -1.2650712781802622 -1.2604977608918255 -0.83904211095562276 -1.5486632752271796 0.027734373384734889 -0.10099270122655861;-0.94043829789363242 -0.0073623984156483899 1.7743781013502493 0.76185319617781533 -0.52548846092844326 1.2564685143777508 -0.3118725665140209 1.2254477433445052 -1.2752374843977525 0.050614826357750498 -1.0938762102678672;-1.4180267059503713 -0.99712528822937074 1.1075899749932268 -2.8292808212716021 -0.82048083870075017 -0.067092053001496108 -1.6471586693494873 0.30825246893017955 0.93594591868465082 2.9544721525485271 -1.2595695478784534;-0.96588546839598655 -0.19063954854697604 -3.5166901905036321 -2.2879701292517818 1.2499824166539806 -2.1710814164912988 1.823242945727753 -0.66547294351983244 3.450522773797287 -0.42888471892211932 1.5589798183241792;0.24612668878391319 -0.83260834427197128 0.97295161963889576 1.5828542612041578 -1.1037251586699675 1.2606321879393461 0.54499512892083335 0.80322445428575762 0.74658686619181602 0.051642266871731388 -0.17175575526193612;0.25577358548455009 1.1581284364855038 1.3102959198035302 -2.4014190065776004 3.2396810736591757 -0.084226686278077612 -0.80797874010619464 -0.14417379080344517 0.48132381303295935 1.3430408596042136 2.3044984510184499];

% Layer 3
b3 = 0.067449046416594272;
LW3_2 = [-5.2743111526786448 -3.0331737081784995 2.8748316734800508 2.5113214704285829 2.1415658573922309 -0.30477380043695906 2.0572892788954529 -5.0041392809073955 -4.7065459784448356 -0.37845086908311137 0.10917040085155852];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
