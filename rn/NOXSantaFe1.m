function [Y,Xf,Af] = NOXSantaFe1(X,~,~)
%NOXSANTAFE1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:49.
% 
% [Y] = NOXSantaFe1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.820628264330588;-1.6232946594450661;1.7171763117031289;0.69573308308788828;0.9197243237318552;0.19702883409821195;0.36951725159279558;0.10738455892170289;-0.45039598879679216;-0.59495450986214615;0.88907626731571188;0.74531008034706292;1.4950809072528173;1.0384165789811146];
IW1_1 = [0.15404086623270716 2.9239208110652708 -0.58434140656377065 0.94561941376089376 -0.18635114466911279 -0.28332245747571017 0.093323913656667146 -0.35517220515285491 -0.53683779949481614 1.2348043857453632 -0.23025179958865383 0.1818988603990763;0.15640898271272291 1.6876731176618243 -0.17600428740627017 0.39553548364008323 -0.0053539403783780812 -0.11623453646567176 0.10638795760307998 0.022800999430543228 -0.083955491243831337 -0.98051848132118113 0.35411914018869989 -0.29089704974798936;-0.33327944940161774 0.15097272720820071 -0.23885745345851553 0.48600596788242245 -0.58941789138070833 -0.13536641468565361 -0.24684714393970983 -1.1356308287869676 -0.10600461575336141 -0.69652055926054246 -0.64032757309697419 0.43786490715045689;0.050333189269667185 1.1908393186200403 0.090013779791414075 -0.27641207511126581 -0.010102392397460492 0.025869977304273352 0.23156120976466354 0.46796829227636921 -0.13855358567043963 1.1109172796224922 0.32925118920477536 -0.65142761623394196;-1.1059855000384269 -0.78430488675359866 -0.23581702878528757 -0.62462547189668838 0.17088528047362883 -0.29419080409540188 0.4475475258741009 -0.41210630607767657 0.49821387235476905 0.10470537924034738 -1.1485833541751693 -0.29498979996654912;0.16028679046756117 0.09972484073027077 0.23990679616893526 -0.61431208598497566 -0.033741212668885676 0.19424182906247917 0.11214092755443614 0.17540908413963369 -0.23704025074381499 -0.85943429846308428 0.55386095170839567 0.31989433576133586;-0.00021774180905121017 -0.075887605186723439 -0.37517033337324168 0.067149688350661263 -0.070903805848650803 -0.18031058113128731 0.63633738676230689 0.81793672756415137 -0.75469584668269385 0.42225277584545673 0.66555020810674581 -0.57053994722772461;-0.081828300990857389 3.5403342734466823 -0.12498284272135449 0.085210941322035189 -0.0055684377642417834 -0.021815060638436988 -0.007972788237579161 -0.6089697584989644 -0.026608710029488926 -0.2583206099705021 -0.5184374363137122 0.35119150433444679;-0.15170738147753646 0.63358548073422627 0.16082476214708066 0.079463268204993345 -0.98639967190278144 0.1542187330502017 -0.21310129282297191 -0.42838778039180514 0.052072607442063379 1.2440101920353985 0.30997821978234602 0.19209786406648577;-0.57656848356777546 0.01969873026024424 0.41995787077656055 1.2152356331560938 -0.0097912856655598922 0.83132995128100584 -0.041691904594191254 0.14469383885724388 0.016525366177787323 0.26694022338528256 0.76417565381964381 0.29491815545067784;0.6574304190952428 -0.47847223890239649 0.90889812285528737 -0.42449277553614129 -0.19201276001077131 0.11634430046108513 -0.013868927247540344 0.41398096142753882 0.25254083486012985 -0.71247201108321301 -0.8832305117584266 -0.17337773859364172;0.88400644824910912 -0.78600510255494538 0.14093230975141222 0.41708926240993804 0.27080234555991045 -0.84688631631281264 0.41071059998196269 0.3329399007924187 0.28016154109009755 -1.3893342366686579 1.3773174838686215 -0.34639038546704076;0.26017529411165941 -0.46112569790184266 0.28731415334082494 -0.55220466038241223 0.0644406200824411 0.21028719837024717 -0.12954496180651692 -0.060197503503124417 0.1238324845193282 0.17502351756529183 0.79201483291077279 0.83725659297039068;-0.34393303988276264 -2.2917323353636534 0.8474438331906502 0.47327393348156671 -0.18309524493665119 -0.23290600739231246 -0.55509135827879619 0.4292282422396278 1.0523539122192276 0.39953105818104878 -0.29907712600093478 0.49817471396435314];

% Layer 2
b2 = [1.6933533392958264;1.4840420203471345;1.5202464398311886;0.83590715838726337;-0.49524987589782515;0.38139528218337077;0.36657187537778058;0.03731738220980392;-0.37928740591795873;0.48550314857697807;0.9994561294700206;-1.1852033454395798;1.7252737698022467;-1.9679781636545677];
LW2_1 = [-0.72232646086406227 0.10808566576692194 -0.31908269619102009 -0.55662235456042086 0.24242486301108723 1.1229007815046721 -0.3663212417313978 0.8180750990831015 -0.34043114504163119 0.39267444150623471 -0.49524944840947988 0.35395116092576095 0.19029757652323648 1.0331488795571153;0.37101544249030849 0.23624626642204588 -0.015893845708974758 -0.71782475244805566 0.17341063740579793 0.33513679767556576 0.40048204282434713 -0.32316588798491286 -1.6808296451219868 0.36098079185514748 -0.36035023894752261 -0.62804379986220882 0.63133059887757714 -0.56411176980428634;-0.7836345784249622 0.0099251290113477227 -0.42057438776494893 -0.8032803573941073 1.0252756447925002 0.6945856525364682 0.38846457294240561 1.0891558045460625 -0.15763183062617717 0.62674046652722393 0.1579035869376941 0.12904680415347103 0.89409146634551917 -0.51050797375041568;-0.29943700576456272 0.87737761598985164 0.53737616413795031 -0.48262662862327282 0.56212083827853165 -1.1084753992970091 0.25607305554319998 0.039471406795414665 0.34750745182357001 -0.32909622074693778 0.50602479420160096 0.68716109214134824 0.091017916052975434 -0.092253036736027388;0.54826877727012735 0.5052447036083243 0.02226791859234141 -1.4912739111892848 -0.37938174154367188 0.16757124973001569 0.32914448101169935 0.31780196025260171 -0.41777767222890766 0.39716069611271804 0.15869021402620112 -0.12897084447325902 -0.011633670663204514 0.3226148091204491;-0.59540258364573617 0.41863468554237321 -0.5612918455137802 -0.36098674782698453 0.46946255713908369 0.87211504409445384 -0.2961314751551008 0.46033192517172833 -0.36460698347955994 0.32953293999899497 -0.21241966222732014 0.3451260370415784 0.28156597749676948 -0.25789784697366658;0.28821697550392095 -0.76047661307427417 0.58605467689341295 0.95623302490426276 0.14974381244296042 -0.11933055435340222 -0.6682250609351037 1.6301275489897351 0.49718507811048662 -0.23789204166766972 0.083698511951375648 0.47398343588069297 -0.14019790788210867 -0.44686348643520452;-0.17337186731349308 0.12932766904160151 -0.0076808527725537312 0.63747442156380629 -0.56208239494845291 0.88230155457060722 -0.75716785319677393 0.55726153913879861 -1.0469197246392195 -0.25625984939588309 0.59211556533231557 0.19550429411872899 1.1927694419494479 -0.094521424422269448;-1.1950869134176092 0.67793519961765514 0.097141890094035371 0.69369058567742192 1.0142410753409306 0.89336831032180253 -0.28193919652002869 -0.19426304378318277 0.61307649720528989 -0.48720437188212468 0.070113924775615274 -0.070415801041302906 -0.70415105706205705 -0.12493193206449926;0.60541752082831291 -0.52472308659041156 -0.79775362740948319 0.65427313489174177 -0.80984043061267064 -0.85310971143282022 -0.35399920547731611 0.2816473800927925 0.55326872019312345 0.24544299128950339 -0.00033200510962614824 0.56272863995355105 0.32023944419165989 1.0034932268868477;0.53207651269802214 0.66948952761166491 -0.24023483819073957 -0.20247949235347817 -0.11315671872945286 0.25729227378435365 0.12418541304985922 -0.1149576767493846 -0.39790490980000248 -0.66359161156747881 -0.55271204266420859 0.087302002394943706 -0.66785853700110087 -0.45404125967533998;-0.084911852619952516 -0.93487578128383853 0.51891278148233511 0.17928870548030507 -0.28807362005901627 0.20836989374275205 -0.37089879654042507 0.27903542209763854 0.70888490555541128 -0.13804481588213033 -0.023273951362370465 0.39069201399569092 1.2721709512828601 0.66728589650041992;0.77462605589286604 -0.49924599209003506 -0.28536495240193516 0.86908804312879429 0.033508257134000671 0.46348972068624988 -0.99417400483894414 1.6677923046185772 0.29143196072717803 -0.104370295832454 -0.11900502621838832 0.63644054819345453 -0.68687022996536162 -0.57999717166480691;-0.18894009394271044 -0.66890642571517311 -0.53699673854480279 -0.32769972380085627 0.15243348597872863 0.19197332221430868 0.33532734147699989 -0.99966087457211406 0.65664444092430874 -0.17941245319363075 0.36419204779521031 -0.41096565324710982 -0.13497788973173935 0.40934170876166609];

% Layer 3
b3 = -0.45960132311557284;
LW3_2 = [-0.48400584776141864 -1.1087425856567568 1.5668088280649926 -0.78288947700866995 -0.82085519898935333 0.45365829589529449 1.2808242119245961 -0.19940539561300144 -1.2403612549842964 -0.98789173097668681 -0.20946518376851375 -0.1728501283225124 -0.9829420052623461 0.78679847432541161];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
