function [Y,Xf,Af] = PM10SantaFe11(X,~,~)
%PM10SANTAFE11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:34.
% 
% [Y] = PM10SantaFe11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;0.00341273633199099;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.8717040623912657;6.6138871215435433;2.1220236008781619;-1.4408043498086056;4.0360562021687372;-0.38845025219035423;-1.0207634700014343;-0.61207469738253306;3.7296018212520563;-0.92420433167755667;-0.071876121106673158;3.4752490442787067;9.3017384474925038;-8.0101866126429311;0.24971987383976485];
IW1_1 = [-0.89568390386515717 1.6352475266191897 -1.3797118239415611 -1.1470742212903575 -0.71492281259136625 1.123832418691588;-6.9117805169364512 0.15601392054467289 0.75012749388009847 -0.53450745141762179 -0.1220249141778104 0.092185694297181237;-3.4007249054086723 0.18820454513980184 2.4415076049830624 -2.6534059499354932 -0.93895727370096849 -0.025798276980084547;5.3840755937304472 -4.1530244040683124 -1.0647429479221759 3.9309072929762578 -1.1791433497254702 -0.23113938144941557;-2.396250937417217 2.2672034207730274 0.65791221132802413 -1.2748551623630906 4.4631614164365336 -0.82763002895978144;-1.5874119587595035 -1.5162127110582564 -0.9391532692540171 0.44449902798586272 -0.079160936759475498 -0.3191111086605582;-0.20173036581044915 0.95294627697811218 -3.3444303201711687 -0.025747498691928009 3.2199581674003475 -1.5344880236376013;-0.0015954282959909777 -0.29691091361428207 0.70087011441268943 -0.080227124605534189 -1.7131705088273446 -0.25834679594583543;3.3725288623415444 1.4458063398691083 -0.14979585468126744 -0.25543283607846085 -0.10660452966105921 0.15199745677228488;0.14260902322346827 -2.6169874219976852 -2.1032572411858226 -1.7709518339161383 -1.7622584080707375 0.31638612774623343;0.50916510575253104 1.8404546988696349 0.5258762695841297 -0.0086554647798940988 -1.2559419620733361 0.12637564343184382;1.7101863836961388 -2.4150693941871486 0.89305460034466599 1.8928348340256289 0.067048982152745462 -0.9695007668819251;6.4369360528452821 0.059593917130063984 1.5438952265205248 2.8980636213760351 -3.0255860969389583 4.0311792266536273;-4.2430237800934494 -0.14444351605652356 -2.7516462895839613 -1.8509737037061462 1.8904199006085076 -3.8043514655346931;0.85374258164276384 -2.8374950977001463 1.824421867326866 -0.62490259050865948 0.62098110752519475 -0.42557967494388649];

% Layer 2
b2 = [-3.5412464033790481;2.4320834571854064;-0.90055537486339143;1.6960189232579985;0.45109722004340552;-1.5505326226897977;-0.76787032661330978;-1.7681624050510794;-1.5458359029771669;0.38693301866395757;-0.97171601281989139;-1.9278898098408261;0.53833037745987622;-0.6569577429322242;-0.19194858010154386];
LW2_1 = [0.24374123584618856 -0.36460873102406255 -0.17444450142210019 0.92941597351028105 0.8046654235667986 -1.4515085237750092 -0.47550620356392642 -1.1973553212767165 -0.54064695969883192 0.063556080081024577 3.3144137634411641 -0.067510908211553061 -0.91111980597592679 0.095562010049808993 0.31792978098543589;0.50110926586668436 -1.5785834340024771 0.49655252495852009 -3.4296462448590912 1.0147135588365059 2.7575083376533942 -0.39915899239394842 -1.4848600275023824 0.99123214881290433 1.3745716631837515 2.8064500562801666 0.35560056059839401 1.1185433413009069 -0.76451734770489554 0.30642043371705319;-1.2974643015422971 0.50862187078600052 -0.54631812964043491 -3.1011557843102051 -0.21048428410349926 3.1717746481986793 -0.63579289665454974 -0.74816215440374678 1.3912423861154244 -0.042150878577318904 -2.8386068226064491 -4.2742013072537972 -7.6745440158432494 -2.912732013127568 -1.4412487811672614;0.89189438048882574 -2.1018120835199534 -0.10035833945958317 -0.46460319090093327 -0.93261932983784768 0.1456989789897255 0.5810631432634763 0.68515005888568137 -1.1591794181583044 -1.2111873841793823 -0.21198819874845978 1.1722538674852556 2.116382728711486 -0.79415516140718301 0.17962752295514803;1.0643292208656399 -2.4765475641150827 2.6175452520354159 0.081912461726864699 -0.86655592754144017 0.67892331101183234 0.79401518576479024 0.85856419094414216 0.11615961670907594 -1.1861588686329434 -0.33634043075145392 1.0517255860902852 -3.9042654926473781 -4.2523733944051223 -0.67233107346850263;1.345447828759089 -1.6021706465942906 0.63428266164926395 -1.0254917278685567 -1.1265064664287345 -0.93183391718180497 0.42410892342079365 -0.16527678919320168 -0.41055806695578267 0.36749724569445569 0.31880894369439566 -1.2022664124640214 1.6215662014527603 1.1191229775967242 2.5210483754503308;-1.9039995284689675 -0.35900875219172146 -0.21488698266608305 0.14301963786682076 0.58953045823486905 -0.51468556734189153 -0.49969202426950304 0.4634452160281099 -0.61366674780787467 -1.4040730388311111 -2.4098904637998264 -2.7736884822497569 2.622519441943878 1.1283305800833552 -0.41036736885880049;-0.36295770489051743 0.71343104972601634 -2.304667031487373 -2.8952029845118821 0.15912811310876943 1.8931223029656821 -0.23059991529748208 -2.1927351504147228 0.50039154200666336 -0.32013953609073997 -1.4204364173334643 -1.8927964806337392 -0.87991571715965444 -1.0499447709049186 -0.1477397800156916;0.1702869669402152 -2.7551986036316483 1.4747194799602874 -0.12389844656984478 -1.1844576530688249 1.4813080378519397 -0.99085996383982322 6.3914363304875774 -1.7405994793786603 -0.45659711655626301 3.1081334955137274 -0.82288218202735885 -2.4035532855700334 -1.0378366379056483 -1.4223032969054961;-1.9590360763554768 -5.5480170808882967 0.23865262468290316 -0.44794884280963881 0.18862099757086906 -1.577816779075198 -0.24003119782342006 -1.2139611005145077 -2.3995344594619312 0.90251271881554196 -0.55694696699076818 -2.7178086441973761 2.1145757378638086 -0.86495810019611596 -1.3051762131286864;-0.59236904727807327 2.0747575038467163 -0.63609832659997145 0.85444217569734859 0.91760426355738678 1.6905061575986031 -0.20556275495639825 -2.2338494387361543 -0.32533056055891862 1.0518991060486023 3.4046299747514421 -0.82544713907802147 -0.91940503319379507 0.82484653148296061 0.18686205190380339;-1.0598139004750415 -0.50395633739217982 1.9072104872377829 0.41801063826226281 -0.85751550718821645 1.211636126768306 -0.73524018849194417 2.183137910412706 4.1932971078053791 -1.2613327466340478 -0.90617620744136018 -0.33076325860950934 -0.64000687619769048 -0.83767132335057715 0.74925262008914262;-0.063850103755850193 0.092815620725122464 0.29388150058907597 -0.71218061767273666 -0.46316774153190238 1.8540940953039784 0.50756071459949759 1.2332360638542825 3.0425575974586514 0.045981538231563562 -1.4217774009146136 0.17078093555265023 -0.41710602022247767 -1.5189020718197319 0.67233176242823445;0.99096733126743941 -0.18228259975123384 0.57564650079211666 -0.15792591454382623 -0.075618075940071819 0.71146929085285948 0.40434538541135034 -0.41243856220897063 0.26604817620578725 1.3911951444888087 2.1377277157377681 1.3334914347538949 -0.75092072246825292 -1.0008986987607529 0.7111463907595631;0.23116789088926487 2.8008781408793171 -2.0586575689574529 -0.052198788638857241 0.86677962816780563 -0.26935668910719535 0.15934690117210382 -0.79671799424603718 -3.8401557196598106 0.46349222667210543 1.5959501934696134 -0.10192450933197481 0.10140626650858375 0.19343885330564883 -1.1943546321257319];

% Layer 3
b3 = -0.30544629980273841;
LW3_2 = [2.2116840311793298 0.23796645870825564 -0.147747944915704 0.23429485771146777 -0.13477393501697213 1.0944791023175013 -0.33458958181809084 0.20601188486413699 0.10545297668815735 -0.2009673893234154 0.16085777319495734 -0.11423913477785234 2.4258153429928742 -0.35831852741032855 -0.22365231355934112];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
