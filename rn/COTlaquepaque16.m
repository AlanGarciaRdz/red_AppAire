function [Y,Xf,Af] = COTlaquepaque16(X,~,~)
%COTLAQUEPAQUE16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:15.
% 
% [Y] = COTlaquepaque16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;14.7058823529412;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.448430493273543];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.96732157414688014;-2.0509929843023329;-1.5486694569621269;-1.4033514545573091;1.9512930726944511;1.6155074293756226;0.7282273943207116;0.36246911796326775;1.0657394307876802;1.3613628504360622;-1.1912317647688491;0.74539408253334716;1.7738266591464888;1.1702091187479344;1.3853197905906061];
IW1_1 = [1.5778006037353238 0.36980101066864063 -0.60140715424008251 0.35379701099739291 0.33208377548640444 -1.0122701209246128 1.048911873206694 -0.36196098601910065 -0.10549801219410662 0.64335521680714403;1.7626243077313495 0.6569277301770966 -0.36003433637198801 0.63839024860006433 1.1219587506167881 -0.080139763866623068 -0.25478262495002962 0.027537104510553835 0.3445188054838067 -0.4415857609085071;1.3792480999009469 -0.45888025482781369 -0.31282898350541632 -0.45356571002352919 -0.27228066141559532 0.23986083205912387 0.13554587699409049 0.061272404338233104 0.016464993253808669 0.94547429519751169;-0.95216040317376971 1.448382276329035 -0.51905266757326329 1.3847482367709674 0.82128759260723727 -0.14730031749980088 0.11124936835261433 -0.57207959008816045 -0.43511565142791719 1.4367526023363433;0.2837101474475906 2.1906557437601974 0.76916684467877428 0.073276850697488627 0.37302291885729544 0.38065056488202104 -0.35140038352443365 -0.15040796541808715 0.056578786592054946 1.2857116085721834;-0.26784763856518401 -0.47380150749818789 -0.030599200332290334 -0.161118288017675 0.58535245772692956 -0.31903094192969395 -0.52340835163690136 -0.015161603006486765 0.44046961755114888 1.3757249144243475;-1.2816554418661685 -0.0048678643704704993 -0.030810907778061947 -0.19816507627480845 -0.4093102450979903 -0.33271939084760416 0.29164219023836863 -0.11749713478763088 -0.19831855803001008 0.42104902988586274;-1.6601644164856655 -0.25579772870514639 0.061154116576281073 0.17165846002905122 -0.8334566333530824 -0.42188472721579484 -0.59116601116515044 1.3046387763613001 0.36842320207268592 -0.52933591474708253;0.028394146380562722 -3.110678457963731 -0.21698301958176597 -0.1505963156112084 -0.41545796157396048 0.00097992771240300314 0.22072261089351236 0.08327534536414892 -0.22853239371118952 0.6802068332984742;0.51177440859422962 -2.6516868628610655 -1.7473231729961356 -0.5530691956951248 1.1582022798987561 -0.60457043235117336 -0.6648466192675927 -0.57701229908739149 0.10495762397624465 1.0700444112333052;0.099307480377672827 0.2910001475114638 -0.28472098089319536 0.1463925783089679 0.19080740309433375 -0.30310856850878781 -1.1199504360891495 -0.16436916628430645 0.019246237922842295 -1.1536057881055397;2.0311876314426716 -0.52901898422253213 -0.18335742650969394 -0.23346485715817156 0.065511311738977784 0.10813086622491223 0.62095924349098974 0.23881125407105203 -0.033225196365603678 -0.80197818377033148;0.95001066190290284 0.090796429086457228 -0.25137175169529991 0.17402823683069882 -0.32591487151681531 0.62419661793995707 0.34922413770325911 -0.014709745314111296 -0.36219897440175713 1.5638879812896873;-0.24429299595718426 0.0031839233658477357 0.48477409162559976 -0.23300548850612071 -1.750860604075722 -0.50296706303946392 -1.3291728434793457 0.021986986086283522 0.43050786185676704 0.96714453679744949;0.66247458133143899 -1.218726178026841 1.0071442898416305 0.11311780406174518 0.2120058664246503 0.017886489927502913 0.50336801473682424 -0.39718526954213712 0.1148204896554654 -0.16845953388875529];

% Layer 2
b2 = [1.3646113006753757;-1.3450271272086374;-2.0794755719547444;-0.98855723681175678;0.087038275755966898;-0.2363851816521943;0.73661989023783436;0.032673094923750853;-0.063146206748173367;0.7789946691778582;-0.13294609647198399;1.930858252788896;-0.66309679743154404;0.74153988270262006;-1.1859876861774146];
LW2_1 = [-0.13388083550055979 -0.23620436824440807 -1.276819079464093 0.16418652764556299 0.59620254179849974 0.56808634902348998 0.65191922047486683 -0.45628018423901118 0.053196985563230194 -1.0135252044029943 0.48566392840110595 -0.097569653148076266 0.64306786293413998 -0.022330212830241343 -0.5847029268910332;0.61286396272204335 0.23013905387646472 0.73195701584544237 0.65879299142532688 -0.71353484828573521 0.69311549128026362 -0.048642015769283627 0.47716053604936209 0.78255429338012983 0.2856837151778639 0.23058694234417906 0.07754154982032635 0.30620377443504726 0.010317966945075779 -0.77379489352202369;-0.12934927342182859 0.84675828811350151 -0.80789312837618354 0.88417267079582396 -0.74069770132140389 1.4106908791688983 -0.46486135922283894 0.20753416716648812 -0.021550580272433673 -0.014111525327931168 0.08835815735364444 0.20433087663305338 -0.58107276847303835 -0.33152765377889071 -0.5368892019002719;0.66837073232887911 -1.0224270665877864 0.30953836616950103 0.096559518589287421 -0.61213842631316984 -1.0942002781488591 -0.32992199738083106 0.97446073891511276 0.77010306162048292 0.65766312196889709 -0.18734380474675674 -0.94794867179362852 0.12199210615901002 0.31124278628693336 -0.99516826490113131;-0.17693048986816179 -0.0923703021088573 -0.92024122654196183 -1.2238440514426145 0.77122428886279859 0.52490567012379119 -0.71041743783622779 -0.11255931116394335 -0.44016427459447627 -0.64504703828110466 0.7062203302072122 -0.452141620357147 -0.49536200329437396 -0.12338518324216036 -0.85350203316981532;0.073239118353918886 0.81769142886657187 0.22422703217198114 -0.16935011608366649 -0.58397383225543564 -0.81747398279234174 0.42836700867206245 0.68259118657086004 0.80422814595950021 0.22088098492972699 0.30490631585642058 -0.4955181960295208 0.95556598820746519 0.036167558830091262 -0.36909631098516571;-0.82102542920524757 -0.1946947539398671 -0.069126286092819678 0.81376404094465316 1.5278861893563405 -0.029560756414876391 -1.2075291571027824 0.26697379257067633 0.092747736103346357 0.32140260527732378 0.039633123046572107 -0.19315317514454217 0.22950331123646797 0.39814674214019735 -0.62952071887800409;0.70397342396232887 0.048048232147883924 -0.28009815608795546 0.4998501099730811 -0.39263977839714981 0.50349065787985159 0.2692615768207377 -0.12125537787599323 0.87607974328094007 -0.13024636398728462 0.62302351075230089 -0.60540672820084895 -0.21900693925477299 0.21062747791535347 -0.36947876786146322;1.215271415307932 2.1575039415840824 0.50635825432345249 -0.24995958840091184 -0.40997073657023658 -0.58276846183684428 -1.1360137923571163 0.77116804846202069 1.1562079998158932 -1.4416068419785637 -0.75513847755920604 -1.0928751097098859 -1.0097662010489761 2.0756358909338353 -0.40174504007663336;0.16927403697137258 0.23938227515397725 0.049114159655906965 0.044375215336767096 -0.37016119790841806 0.55717884278815966 0.23169911767027052 0.26902695077313143 1.9369145494723643 -0.070124415445923599 0.65132002007461276 -0.30920768135080284 -0.35799481798942095 -0.0165754346129997 1.0038093132399206;-0.61277851272504791 0.76266032814122653 1.6356189407099513 -0.66505743903003267 0.52152058679647706 -0.19734860367004509 -0.12015667940084485 -0.087444277550582608 -1.2345552619058742 -0.14330152958776093 -0.23204938330479552 0.10247574185930039 -1.0555918939941467 0.28880656153011253 1.1529926689827319;-0.82266883551432413 0.066218972620998004 -0.76305494755499925 0.16888483249322439 3.0615592907812874 2.1967948467606386 0.19141413925120049 -0.050190041756470502 2.1129983097069074 -0.0049918866523096586 -1.5523413433948834 -0.97335934185369932 2.4920246033609095 0.28230532011450093 0.2152332735133618;-0.059812746433455535 0.5459422530839243 1.2328292647142056 0.24377763877834319 -1.1008041921386793 1.0396326399907787 0.81266494023004321 -0.15228688770632667 -0.098664569941128072 0.16083004246052424 -0.041686209859917167 0.058950041671821829 0.50163911375172177 -0.0026483618981649956 0.86449974897971449;-0.90190215116021433 0.06535066854797239 0.90779849421041259 -0.70825331603157327 -0.079180936547037326 0.86162167832041847 -0.28750339968765126 -0.2122257620229735 -1.3506112839644477 -0.50908015079990354 -0.64989952702375864 0.4238422486366345 0.052478360026318643 -0.26243356077334401 0.1456699301894015;-0.4564816600203831 0.46504279152915495 0.53657700762747451 -0.12704444898670406 0.47999051978122664 -0.64035585763170899 0.95421148085185137 0.083510466837113551 -1.6828375619438971 0.25934474826333215 -0.35380707061439975 0.39054639536492186 0.76132766027053966 -0.063628239263651909 -0.44718613915730254];

% Layer 3
b3 = -0.58472493234095935;
LW3_2 = [0.71853100793837643 0.95246474225543776 0.72130825593780046 0.38895503473280396 0.35379934477127783 -0.4965157561021098 0.13399405528071912 -0.84609330483106482 2.3246185688554344 -1.2599410187799334 -0.48599229649033548 2.7847992285636827 0.72684812424801326 -0.73856936314936805 -1.3035861544626235];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
