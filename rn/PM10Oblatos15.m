function [Y,Xf,Af] = PM10Oblatos15(X,~,~)
%PM10OBLATOS15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:24.
% 
% [Y] = PM10Oblatos15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.069576992883726;2.2336850045184722;-1.4087234555921091;-3.5229155606943392;1.0220510082216532;0.095469366556714147;0.82129806047414278;-1.1809371718882193;-1.7015612489425889;-1.3023652606902492;-0.59358317160860574;-0.49455107570603873;0.33271226634227208;-1.4173452726970952];
IW1_1 = [1.7195804832798398 1.4986547911008405 -0.14050514028045794 -2.6156986146068548 -0.050555976148807837 -2.2248264629081476 0.42173928179566028 -1.024039598063478;-4.8070636549490962 -0.82949541364317025 0.68678236285276706 -2.8363167089456813 -0.57057413108728872 1.0532778134937943 0.11444742297833077 -1.1737739541977854;-0.10658729341669258 -0.31563475316190631 1.1102198220972979 2.4819657549921215 -0.84144040136618758 -2.9184619252572683 -0.093725593340003618 -1.4762879790660606;3.4265582746856453 -0.94982951454649356 0.133073962181358 0.36709581021162163 0.44923779775842909 2.2179422490511622 -0.39334222712261502 0.18093437879555282;-0.015606549333390545 1.8930121470734098 -1.0732324872922716 1.1880316490536069 0.26419953629869652 -0.32703710940258063 0.15670478206758051 -0.32171265012656514;3.5742924809542349 -0.79416038879671902 -1.9936689016126448 0.33337492018037507 0.86497040040863604 0.47200825849914768 -0.38017596484534982 -0.59677829266576465;-0.10573379510523701 -0.20091895627117223 -0.66998951847577659 -0.99210740947335219 0.96482763035508112 1.8400687301056551 -0.12122091786042494 2.3623197581726729;-0.41269670567961758 -1.3045923434763873 1.368580068469482 -4.0996946464632913 0.82715888973813501 0.66541152575208196 -0.087476085493428002 0.38617528746675034;0.017305832045382483 -0.27563971003635729 1.9904659256879069 1.2060965109243289 -4.0221724134675529 -0.13457504565815773 0.095366571874059211 -0.56358717670834779;-1.6484937471670031 1.4366051017733601 0.014186415988713619 0.76427029735267538 -0.59320528461687905 0.55643634072032955 -0.50084793228141722 1.8004292199574934;1.7852103400711603 2.0065505877903642 0.492186473154337 -2.3139387999227359 -1.867179458058063 2.6284732814422078 -0.16688691143292259 0.27418330681596431;-1.5155018685700581 -0.14394205034788754 -0.60062052617844897 -2.2719286231224918 1.7207115894460574 -1.0343298798606373 0.48586715867090358 0.32432967211647962;0.71625688898757711 -2.7301826056895391 -1.8175202736544109 -0.57777973892679491 0.90377306303502458 -0.077627022588875411 0.27219863446474901 -0.3681871755410282;-0.079661764732138374 0.55943932126963469 0.35707320044734536 -0.24997622155250027 0.15337774806261251 2.3479153968253992 0.12659571008627529 -0.30670511836373537];

% Layer 2
b2 = [1.7024847504397764;1.750023673709024;-2.9732751794354702;3.080425166849448;1.5844260168978639;-2.3478394789076038;-2.367539837338775;-1.8103720931117284;1.5018915701976308;-1.0221489858309041;1.7205775317217646;1.4726228435991318;0.3397572423618152;2.529707774682338];
LW2_1 = [-0.56145385353640165 0.42284450266230567 0.93233500427205218 0.36131897198313812 1.0112980290555775 0.49777967998573025 0.35193428999818299 0.39988957529045904 0.14751233028399066 -0.36059200759350213 -0.53201519028397248 -0.084619938941378148 -0.97122823693075089 -0.95202816866617102;0.054213767066397793 -0.37073532825439087 0.28529296159676321 -0.46020938879223977 -1.2862685413764288 -0.54211086819588949 -0.030414955254325193 -0.50601893162536904 -0.018476032961024492 0.2581608413680907 -0.40701028572628023 0.31072923631586657 0.48250866586349311 0.31657172359843178;-0.34920527163445192 2.968779128778074 -1.8758931908376184 0.97785167932396311 -0.96233588675884496 0.02461843675363605 2.0386441958744554 -0.38858958663589732 1.3504500138055662 -1.8249826569614873 0.27982974098856461 -0.814146102669146 -0.61191295942794 -3.2720751544098658;0.53066631250261087 1.2374507041338236 -1.1317173843337744 -0.59721363156412954 0.59587884931962376 -0.55747119876009665 -1.5286155599744067 1.7163988704648159 -0.71291770606736105 -2.4660524638221868 -0.87118047412365895 1.407892152368623 -1.3704345503112847 -2.1360467485446608;0.46370138174127573 0.80743731351188064 0.46165954329259173 0.41695216823646808 0.52030959724100434 0.75525536717771924 0.10735303304366502 -0.3123862771194667 -2.1138377651320903 3.5326467734786529 -2.3551196079875982 0.80451026649184187 1.743226213739077 0.097442834418731777;-0.97223057559647963 -1.8017331794920632 2.7155206272134906 1.9898009329629036 -0.27373177983838337 -2.3400076223943005 -0.12422767900660674 -1.96521046274141 -3.5007722152309246 0.13739391157596154 2.6419196126983473 2.6344190139666006 2.1728588480365612 1.3500237392705645;-1.0852390904226625 -0.55878703033739607 2.3974416182880685 0.99230346287204729 0.69122917485340318 -1.1792538650044579 1.1376323905913637 1.1187627773048505 -2.728913776113755 0.27577196731128523 0.34255341369364634 -1.6548764951667494 -0.49375914546269728 1.0129017980694079;-0.65822128860341722 -0.6910403874448966 0.35862875957584445 -1.1894640671274135 -2.0079610858594563 1.1483106889853041 -1.7538798651047787 0.25175614890962583 -1.9002535792178097 2.4746488542616043 -0.72279620055363936 -1.9912424628578274 -1.0910425380077018 -1.1055367125093356;1.9249408722002332 0.47471608216392575 0.43488496934457649 -1.1883631318441001 -0.21184721915368757 -1.0636281871408804 -0.77851396732785083 -0.24334148416038875 -1.8414186573434033 0.70763474125059489 1.502715804921323 -1.0452808740878377 -0.22819810138476992 -0.41475182977259673;0.37610209385267113 -0.025896967739010346 -1.3524577241819928 0.34122386000304245 1.0848483909080882 1.0652383609411398 0.240815500749263 0.44310540789185388 0.59486255134408983 -0.036341919365744046 0.33619099846243422 -0.34698938394411971 -0.23185872492251675 0.094587508987224359;1.0951456309123531 0.51303481539012619 0.15071405711840774 1.2060751740746611 0.21355979524837623 1.1188398547669232 0.035018072479812187 0.16412705819817425 -0.58071944073928639 -1.1305871940828527 -0.5807217883946546 0.77827464829870374 -2.0990632635561464 -0.26984870543321171;0.19647330959006795 0.64066300771658591 0.47218582831448708 -0.85456315099949232 1.1108061980859467 -1.1146635925129404 0.12302585300101074 -0.35984786927846762 -0.11761921194372095 -0.37747346822127653 0.11862126497299544 -0.21282172768198349 -0.0045662986986779903 1.7737880851240297;0.055556737344891853 -1.460593771411939 -0.54921709177325395 -0.53577178704916983 -1.5888139712172324 0.74720364741272682 0.099146078246263189 -0.34122995514640514 0.79799439436511732 1.573597126054046 -0.51418625906991489 1.6547917945024566 1.497488101480712 1.4571705693165815;-0.53685498662015807 1.2363250788963502 4.3792531818301059 -1.7281474078848187 2.6607421982351553 -1.9785510920469471 0.51612502757955436 -0.37935833915773992 0.48668929041631476 -0.19489735702672056 0.22579722806949229 1.0234547012210577 -2.5252527868124921 -1.1218994364854205];

% Layer 3
b3 = -0.87822327884921347;
LW3_2 = [1.6037100732392027 1.0452058710445158 0.19000465370403413 -1.3017687059406171 -0.12459480147792676 0.16940852938902376 0.48317908375656426 0.13343400819819046 0.1287215775348817 0.61132419904401192 0.25521978511273136 0.51699703331396951 0.35772165870162592 -0.094692289225110512];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
