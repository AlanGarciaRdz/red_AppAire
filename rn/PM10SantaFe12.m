function [Y,Xf,Af] = PM10SantaFe12(X,~,~)
%PM10SANTAFE12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:34.
% 
% [Y] = PM10SantaFe12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;0.00341273633199099;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.907378248647448;2.6890410147343657;1.8494839312705327;-1.0966797356772202;-1.0588537638134048;1.7841503286568217;-0.29779649918380241;-0.61340196234402888;-0.72939212124910169;0.74884025724042558;-1.0017909669570424;2.3585916526890283;2.3924147890401746;-3.3802068254066837;-3.5684593717151927];
IW1_1 = [0.17501471883840586 -0.4261893963333564 1.1476059161242254 -1.588456847580044 1.8285303410013258 -1.0455914431323921;-1.8370348973463948 2.0780094872741501 1.5245560055421152 0.36844400455921539 0.1589647449594119 -0.37111106465845489;-0.5740469039297903 0.37994650342786329 2.6217853116461232 0.42465535784624164 -1.3758023960056176 -0.14271795780681007;-0.86081353769609437 -0.69562855750032104 -0.75104827344054448 0.018896237250920673 -2.1436998288650488 0.65698928238614374;0.21580187033653683 -1.7425273098627074 1.3502257473583743 0.14865375337767281 0.16607841812001289 0.29383303574541281;-2.9186111047387442 0.046919836631579538 -2.8439179080205297 1.562178743816407 -0.15129930093192867 -0.25525528933658981;-0.88358714364830215 1.8622835217113856 0.97930938541698176 -1.7976561385050602 0.92577977040596615 -0.85326927938256725;-3.7766050166266871 -1.0550828383227773 -0.26517630500442702 -0.33034372875517087 0.31117525647146282 0.262321021127639;-1.5617856558644303 0.55620001856590195 0.66358257952183353 -0.19450489308041802 -0.13101196227616088 0.55891330921272198;1.7494663589912485 -0.14963741179689261 0.29065975850328052 0.59635917335296051 2.1347091686776269 0.96430430271373646;-1.85788853370028 -1.1147422026102864 -0.12448439432973402 -0.48546965509872403 0.096624638885566966 0.10063892050637573;0.66568542901433603 -0.45172015464964765 -1.4120250614826839 -1.4965259462311893 0.25356743181794877 0.3543352998006834;3.8434356546774766 1.1862376333289681 -0.11604025127231296 0.55818673018139275 -0.45592936441215759 -0.2345220026540594;-0.83699951262948069 -1.3326845719137077 0.12531154331095923 2.0865588029230171 -1.8779869935633811 -3.4765707202192462;-3.7403277815549929 0.37892852027573748 0.031589893629522081 -0.70261078320616621 0.83923878462468848 -1.6508459979186889];

% Layer 2
b2 = [-2.1835476652053645;-1.176871875951389;-0.94899728523878168;-1.0013271157034358;-0.82544843613484753;0.0094204760100939991;-0.36047663274128122;0.39834581396040347;-0.01881118064364749;-0.64095651908873841;-1.267693776808303;-1.5892625085642476;0.55239411091705037;2.0422459127477484;2.3364768890458256];
LW2_1 = [0.33413850973027304 0.26849756914479522 -0.53166630030642614 0.40614647216125815 -0.79547744625008154 0.68162593194811238 0.20275109307137745 -0.44837816238795464 0.16197666099595134 0.84741816408164605 -0.83012305652426555 0.179835501383319 -0.87390137536159929 -0.18713597530237278 0.60597656045372195;0.26565340141802024 -1.3680715017007001 -0.98228339530400566 -0.20252078339626089 1.2796343124613654 0.93742799506474239 -0.8468201069000767 1.934739976527335 -0.47050772354136233 -0.44813838631212871 -0.48051991325921678 -0.09337904480383534 0.63893411262577804 -0.95229751338514779 1.4915155918744543;0.20287323111585068 0.12026593134409823 0.72986698543337936 -0.44433428756022364 1.0625618924314291 0.49106142658024837 -1.3901034393622012 2.0493524264673897 -0.35746792209057032 -0.37731198646212727 0.49039192722001118 -0.17800784295539826 0.49983510699814515 1.4716078316653181 1.4423464948941194;0.27320101835816812 -2.0913074186603366 -0.28831293626017757 0.9552622637283863 0.26069156625346168 0.77946542488663118 0.53944255813674857 1.8618529584601256 0.93430549545566399 0.36723318254662368 -1.0572141360501255 -0.20773207835605026 1.0141808301808568 0.50192947362416818 1.3877835997996488;0.63456898137417705 -0.49163862429840671 -0.9442783247416815 1.8187896892511581 0.48999772512968853 -1.0683947161690663 1.1814724110142032 -0.47021598461334324 -0.77126887765493646 0.28860448539634842 2.0769473382518813 -0.52702014224100768 1.4479120790842042 1.1398349567882746 -2.2521696950017644;0.16471446560383662 0.8175371981558881 0.42394538711260488 0.89089350812169643 0.94473352760663243 0.34132931321026316 -0.068760034947926874 0.57054758226969393 -1.6759480728045586 0.45072264818201874 0.10360468902114742 0.079988435972131205 0.56767211331999334 0.52588822766204057 0.35719055355426554;0.18592138505525843 1.2549853844518859 1.7850065604180607 -0.91582406825738238 0.54892308519064925 2.5413464254404583 -0.04014314538395776 0.2163942810815741 0.46538567613314691 0.89999041861313378 1.7016529116148404 0.76364046264704966 0.32948111304282179 0.91903580092879977 1.6376289569121121;-0.59743593405073314 -0.85486444121010863 0.68977715615164448 -0.67591595337164589 -0.54036025606894955 0.032409230045660251 -1.2607011342503236 0.37951671149408511 -1.6212316795871482 0.1502574188479896 0.90436488896647016 0.49092327386178841 -1.0422794893910639 -0.79041419280392977 -0.97175096773577085;-0.75511241325177703 0.35937904739596915 -0.51377249331308128 -0.49275545555231759 0.41992952270336131 -0.060474580877703056 -0.037928927660492766 0.84943430502117989 1.0289428017474427 -1.0623777990421479 -0.25166305061841698 0.051631931834292905 -0.82308126308924967 1.5494615003105139 0.42787865043073237;0.71388042493374315 -1.5901065518510018 0.27636204135224107 -0.19885073956503427 0.054134030410857528 -0.19637769961095186 0.10425744298685703 1.2606907855176677 -0.37948463550653394 0.086566758139970848 0.052293759150781841 -0.033768671016792137 0.56320815307848504 -1.0076659550214062 -0.96356210309167012;0.24958054341928337 -0.022000906528966344 1.5235253314426309 0.55190737926029187 -0.79448306271644042 0.43094876972037832 -0.28985374808032222 -2.0137621269237176 -0.34352601844509606 -0.2514958755932572 2.2948639572330438 -1.177963728400466 1.4209569847311141 0.55488072776473918 -0.60672674594803777;0.71879351708961892 0.18076417429077998 -1.4216678332190784 0.77506195244459619 0.028262705570567405 -0.84951138236110135 -0.98895978478274382 0.19479105906694266 -1.8044287683261335 0.13529246867395467 0.18117483302420276 -0.25160461988052868 0.8117673262112175 0.17317496586377781 0.53789129009776304;1.1501349796227707 0.81828989670584995 -0.59757255441632906 0.19790217848666922 -0.37921346501874825 -0.19627804773637778 -0.37647849864507094 -0.41152591772863073 -0.33807784731016133 -0.13884574191754476 -1.1442673663449727 -0.92116040199757054 -0.24092698643199487 0.081728329621463036 -0.44924945943785705;-0.43277616191761692 0.20257669796531419 -2.0700701713478278 1.642653585535282 0.81040574452458525 -2.0878039050526596 1.389449100900443 0.47493485985112605 0.12419807068087388 -0.58282647820262345 -0.070711249332921611 0.64216196183368524 -1.1340232083248467 0.2459191602884514 0.40116547836441169;0.015304613661725188 1.3692835989772576 0.98543333721225568 -1.0658391819720656 0.24997691543678063 -0.45863030243070002 -0.5331416504930212 -0.2537581945385658 -0.4015301627053236 -0.12611827156655633 -1.2798188195128031 1.2204892313557736 -1.2518930153809644 -0.23430217191356204 -0.27456368202455467];

% Layer 3
b3 = -0.40570314174685956;
LW3_2 = [-0.55055726976417541 0.25392999966815039 -0.23047814507421407 -0.63827816800743464 0.27870641599397622 0.31288380025285883 0.29646437593434416 -0.47193344085277522 0.57441128796370011 0.42529754314784002 -0.29471385720331666 -0.49063552285430595 0.82676439665257229 -0.20203208634436221 -0.88301397425183714];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
