function [Y,Xf,Af] = COOblatos8(X,~,~)
%COOBLATOS8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:52.
% 
% [Y] = COOblatos8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.0168391392227958;1.8098392013535392;1.1225416603208669;1.7850466237814915;0.049398207088027175;-0.65205874758383586;-1.9096382254255369;-2.1956192843659195;4.41054872095006;-1.2814055556046642;-1.709257706871675;1.5497923943327678;5.1254933132264799];
IW1_1 = [-0.65117317812888442 -1.2719447768022809 1.5461793781137405 -1.233941916254176 -0.53010713007124677 -1.0854344619348961 0.0010661928969451871 1.2094958641073601 0.19618193089248936 -0.61600801719374787;-0.38404940241348301 2.9570837088536539 1.2450419980330127 -0.24746419217131499 -0.4131206589328279 -1.0253836663218885 -0.017574488988934767 -3.603708397797095 0.24194536728649957 0.42591346715013934;-0.70195405135459765 -0.095178588311371715 -1.3728077236965606 1.4884121559438301 -0.42871164503394077 -1.6509610871736025 -0.097015830503966033 1.1233583927880986 0.5598337193028009 0.76559672970835146;0.14511299588366175 -2.6779322561928303 1.7033273717990041 -0.016067517592509076 -0.36880569796533963 0.1140970801736312 0.13650162995991119 -0.40778616161556913 0.46817142161277081 -0.24040228270479538;-0.51983285855582984 -0.94178434992397919 0.011081277231985799 0.0047121016455496482 0.98672767398541794 -1.8202506763358623 0.41030828730437957 -1.014808857639502 0.38838065576350234 -0.027791069287106444;-0.14387025029762007 0.61244964012533243 -0.80763917921339579 0.048150407268944484 1.1146961989538176 -0.35992603970822729 -0.31495940427580205 0.54062913872196883 0.038192138591294972 0.50121735517108512;-0.78823433596713133 0.73762873947698171 -1.4822592463939541 -0.59675355657234619 -0.63819741696757182 -0.69237516842955027 0.03517717238789253 0.04714872331078801 -0.45992741615133859 -0.21411614425998229;-1.6916612736889962 0.80406890397010966 -2.9007147847984367 -1.0251028834581419 2.3598967957299335 1.0900391141650472 -0.39145313260755032 1.7077598680636876 -0.55486501686597478 -0.62184820017457298;3.3552897179954395 0.16906442063932989 0.61934854968002817 0.56365361103374256 -1.5942621114472066 2.0177705841710587 0.0031684945723986779 -0.015681089623447081 -0.11935523509158241 0.15309358861604674;0.33256217598609233 1.0270902212014108 0.31416158980341075 -0.28268768360552965 -0.45495689225807351 -0.20229701038770509 0.19330799662257017 -0.0013969207721758873 -0.14699899609276548 -0.73218114956124469;0.40638101519447578 -0.18426694232845253 -1.8406937206143967 -0.86328591081803874 1.1713008341289628 -0.40199999162340555 -0.21344194189301399 -0.34350866722368723 -1.0075441112430643 -0.97939287927414065;-0.61607004787658992 -1.4653762306909952 -1.1498437695404231 0.19654367029930817 0.39491621067087002 1.0643529769987734 -0.088970007166569498 0.21975101474566766 -0.026799267470916165 1.15286396221378;4.9554704374737648 -0.40066534681801286 2.4626935129792815 -0.0074629722353445806 0.14680676946323845 -0.020982898736095511 -0.33734989214128874 -0.14526809984812708 -0.39315775238957951 -0.410176801347437];

% Layer 2
b2 = [-2.7183886527050136;1.7699379772311423;-2.6383301947272915;-1.5452653709924102;-2.0354909974258173;-6.0949764368908772;-2.0467170823259844;-3.6894557317254271;0.4358357270002769;0.92382788308016228;-2.6881600877330407;1.5041328343094011;2.5486448775190609];
LW2_1 = [-0.63489964059772175 -0.67113331173580437 -1.4327377273526947 1.1162897598155999 0.67789204154802274 0.29425158867675777 0.90025206610881559 -0.76069765389855148 -1.1162400983255973 -1.8409842323628054 0.50797375321045479 0.3080357896984629 -0.24750312147074827;0.079140190670303701 0.13759980877647879 0.67664360075161201 0.0086683423661069962 0.1918214117090711 -0.38887043491668433 0.23077418951557149 1.3350434080793803 -0.88640500695494862 -1.5198406341598669 -0.52609861658057988 -1.3014104282020083 -0.68784678683826095;-0.10422979758370784 0.054627777821853081 -0.11159362458079344 -0.068008336534423161 -0.15447447101366032 -0.18319646478153362 -0.41909879263191585 -0.55308547430885413 -0.088238029298549264 0.58327987371945889 0.53754506076505337 0.66172122806304678 1.2402441235213646;0.63611426413220729 0.68566651986157368 0.46685132625882747 -0.95248902758480214 0.082948808771259583 -1.6418517939688619 -0.27040930942764951 0.34908460645262512 0.35628125301845431 -2.1218272331110519 0.65992783938131205 -0.18583647808263296 0.43250711923914692;-1.3156432611794748 -0.21233046702618313 0.83441401168085838 -1.3679543935765397 1.8868922397869219 -1.2254810850719045 -1.5528092155322866 0.45817426685837481 1.656143611574612 1.237146919896198 2.7678166525914354 2.9587450355365075 -4.4513399988160405;-0.80538598448150933 -0.82135241697050299 0.40650478260956058 0.22335015492694144 1.4123483641548373 -0.029539493269269024 -0.57227448101870804 0.053833122473300687 6.053637918350077 2.4311260886519661 0.59797836294266393 0.68332606504623927 -0.73676410356361266;-1.4507197687141933 -0.11228545450661116 0.71537069865396541 -1.2153860906949456 1.8460141017497957 -1.1390983725267281 -1.3179827990148807 0.53739265351226739 1.5949294423246179 0.96496921309190031 2.6856659226907103 2.6641043966316587 -4.3773287389334348;0.053444869719412695 -0.84681155606048553 2.2376529479781624 -1.2960422464335017 0.46421630831949584 -0.42653678551371577 1.4350396335338771 -0.86656980243227988 0.23744185281969096 -2.7850723153593284 -0.095433971727573161 -2.2239782995913671 -0.90679961472569781;-0.47008003681015237 0.82555880999513298 0.83786868729852604 1.0766683451084516 -0.56563335713376472 -0.015178619681230021 0.67922572320660268 0.46776443335431411 0.041288395056696146 0.50758541845881144 0.27626949460237399 0.76936319076584858 0.95426562222880629;0.23940644905187311 0.032466251259921752 0.32230892231068992 -0.92607952837736129 0.4531337132582427 -0.9369851392299845 0.29456834723105541 0.8796766251491287 0.7811091598173372 -0.64079083118991897 -0.70465544853785145 -0.9635025769785287 0.41902430914753319;-0.27688840526767039 -0.69345070878811654 -0.72047960346180817 -1.623826005473213 -2.1697336277024908 -1.0929904971939537 0.22474699781439333 -0.91385439789115996 -2.3184412212779559 -1.9729658022079677 0.7561668598694834 -0.36496914584451368 -1.0590243179254351;-0.86945641627864889 0.31735503512753943 0.38529611844186035 1.6467246882735742 -0.40236733089830823 1.1234141846384809 0.28286678564885187 0.57263579233819895 -0.12811913782603943 2.3596635976667604 -0.25301741776308506 1.1942896837902783 0.66649902023720409;0.49404524993551691 0.28670087886381435 -0.10973454484114256 0.26617052661042623 -0.80230676654570254 0.37878788524586726 0.81493577883689505 0.6686762140153838 -0.062731193102539176 -1.9319279454511191 -0.57089542957041939 -0.96177068516431152 -1.3614730268676016];

% Layer 3
b3 = -0.72181018520968809;
LW3_2 = [1.0135643069406668 0.46910489733915123 3.1668504718625621 -0.97945190013689565 -2.8985450329846842 2.6604208041882469 2.9294151909169006 -0.50142417164645481 1.0801689661396092 1.6853612423177236 -2.5835176410886014 -0.99840166687028198 2.2404378256449315];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
