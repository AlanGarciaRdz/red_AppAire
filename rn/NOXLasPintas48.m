function [Y,Xf,Af] = NOXLasPintas48(X,~,~)
%NOXLASPINTAS48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:49.
% 
% [Y] = NOXLasPintas48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.96825396825397;18.6915887850467;0.0175284837861525;0.0546448087431694;0.00640204865556978;0.138888888888889];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.6346246273479532;-2.5017510860839263;2.337489772212046;-0.3202310662290328;-0.72227441802352743;-0.13490656824296982;0.5442542221738903;1.3204864342691396;0.9658549841966757;2.5890410060275064;2.905147101436552;1.5186732762817177];
IW1_1 = [-1.1272071123573846 -0.77002224471826852 1.1776920825472659 -0.11306457979398978 0.20611574356835397 0.6668088957594358 -0.22121047737918773 -0.61154244865055774;3.5746706541897293 -1.2445344212168761 0.8508064685171145 -0.30595947908101923 0.24112198207389465 -2.4361724229180757 -0.39016111576984669 2.1380824393872047;-0.60647561866989974 -0.61553987165060653 -0.74062374794884378 0.29305412133685438 0.66189958930739035 2.7458361321129545 -0.597463262091946 0.69454150817892757;-0.3669124415212548 2.3220219404470166 0.42851402679649797 -0.26314104326009807 0.82047200293991895 -2.587704101588058 0.12056152676742563 -0.026829862386087019;1.6126078734649176 -0.1491592590271609 -1.1161346677694575 0.35975563896057866 0.51586087808445602 0.90453201702350594 0.028654236129663321 -0.015456661503425465;1.3708325336411866 -0.33438236794416176 -0.74588573012466153 -0.61435497134726025 0.16291103628026404 0.85325945241953938 -0.37539899767927704 0.047025159446374087;-0.99088171055166452 0.090308653327914545 0.55651739939395151 -0.11973584051935847 -1.0630815489401435 -1.2189094580666973 0.22949233072030881 0.012070801817141517;0.7986832245347163 0.43226605079743691 0.75025335068636856 -0.71678301604184513 1.3845269252365706 1.1684582816982396 0.79053787783927643 -0.63223324551416915;-0.71694002198136009 0.5542781526910936 -1.3690909273557021 0.017724754689619746 1.8769796624247905 1.0060937589055614 -0.87063368391102847 1.3197611765748376;0.37907384891896995 3.2824489622712818 -0.25218210214615022 0.71617453776703055 0.19435718795099516 0.59993788842672613 -0.11910823182347588 0.5613965667515054;1.7224176684572639 -0.0059125575110584305 -0.44448292365246034 0.7818346554562845 0.77492000359762625 1.0827356958648338 -0.24534360994689022 -0.038805723085748617;0.020663938030473668 -1.0139765004598651 -1.4547545168266989 -0.7760652364504691 1.6195769443864916 1.1158875621273736 1.0238302112448212 -0.95565971528392746];

% Layer 2
b2 = [1.4516504894395625;0.63685093134031667;-0.82490965558094531;-1.3687093242843504;0.80429084766355274;-1.1768098353257332;-0.82558488407356778;-1.2328171963183838;-0.27369507542822336;0.54556066083552057;1.7074778368320085;-2.7560440630630296];
LW2_1 = [0.16292637846735292 -0.88684795150329676 -1.3689118271340408 0.24534851410154518 -0.89694324488838695 1.6535497023712851 -1.1143804004686557 -0.18508729635288163 -1.0694737799060936 -1.2906846782532164 1.2769460485092734 -0.071605130403719505;-1.5063344958526257 -0.5422520060045708 0.98756958655153848 1.1231221221969911 1.1195768675100053 1.0023795410468548 1.7695054461870787 0.25008320375437704 -0.5502572458513767 2.6755784726840113 -1.5405320403056855 0.19965548373605357;1.3432437289494987 -1.0334516473949722 2.3028497049250647 0.59708460742031477 0.49855316257768278 0.96519257238259404 0.12533437556840682 0.74840977703988765 -0.1974082450162471 2.122953612250718 -0.60439565983780741 -0.15676555365970002;0.23624906756006425 -0.97542985618418765 -0.6396417690248748 0.80190563746848209 -0.82448989470561129 1.6211173737086075 1.6089889465002569 0.42323761023003337 0.52719945388872957 -0.92830461262066855 -2.435651977995168 -1.1653586193550989;0.27218263749951899 -0.18358862858193714 -0.85250415549743164 0.50611209448856853 0.40489847559692349 0.71195391697996002 0.72495296217972782 0.4821872966485472 0.056662890146240985 -0.76786334645829246 -1.4789781734904108 -0.39518238746308876;-0.67721108475120939 -0.35068278817499032 -2.317654362927156 0.72366486839677757 -1.0728363894699673 -0.043063791285223585 -1.3228441024794333 -0.085633318176800172 1.0842106905724616 1.1310650608253006 0.36174862989964818 1.3770667154686991;0.33420630852643618 -1.565316695545119 -1.8334716007270657 -0.38231371453336799 -0.028973675034730525 0.33944136461840724 0.3876893228655871 0.6006317597637989 -0.84938048074121586 0.9357487091130402 -0.4605192134346639 -0.75140063855378414;-0.77038764382390046 -0.84764715100552979 -0.75454584194300733 0.89651756610289701 -1.6087927300145339 2.7512446475370247 -2.0638215934975839 -0.067748700511896201 0.94498977214655711 0.21093007940544978 -0.70527987725043062 0.71108981116969117;-0.45264350425672228 -0.11716459912959057 -0.21824039124243377 0.17561818909305954 -0.039015418645125158 0.13501273202063882 0.15341830445811416 0.45858282694440139 -0.20888083204329644 -1.0120395083408045 -0.4273726983470984 0.5172929233427277;0.073122713279455187 -0.91906911600419428 0.54958380918968708 0.82878673401633229 -0.32248576487811326 -1.1987180881577928 -0.54545145440837828 0.38413932939934564 -0.50845104719894574 -0.2820390886741142 0.78717660654697019 -0.64016719310403469;0.31602115791668167 -1.0146127267533547 -0.47277292301660639 0.78963098241615592 0.25528244180833487 -1.5758765187190293 0.068404555459444905 0.30941997319714543 -0.61843822583186114 -0.099724760701238729 1.0058150155080254 -0.94326813518893038;-1.1117899962127296 1.5807620253792294 -0.41302071140720908 1.2938433988543223 -1.8400088505838088 -0.2828162672085468 -0.51750056523841559 -0.5876727525679547 1.5818826810430291 0.27703197719302142 -0.75125946414510048 1.514187583629683];

% Layer 3
b3 = -0.69830291970183989;
LW3_2 = [0.56500149608127115 0.42143577151390271 -0.71606254139279824 -1.6988275725619792 2.2791482852157396 -0.5457669346765055 -0.71509063738042433 -0.4759477523978452 -1.4861072908237769 1.6186386021884467 -1.4505831947989662 1.6201852215205017];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
