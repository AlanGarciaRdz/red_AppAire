function [Y,Xf,Af] = SOXMiravalle14(X,~,~)
%SOXMIRAVALLE14 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:36.
% 
% [Y] = SOXMiravalle14(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.0208986415882968;90.9090909090909;0.056980056980057;0.0063552589768033;166.666666666667;45.4545454545455;117.647058823529;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [-5.6201071777293725;-0.81667999261668545;3.0141468348441887;4.4197347197823609;1.81302663792716;-2.8923747783728109;-3.8114626488351484;1.8998870472489036;-1.3379942488882886;-1.5985345350324649;1.6822579554735031;-0.053535328446884987;1.2388170965622933];
IW1_1 = [10.229978098005692 0.85022598543467265 -2.1595145927313637 -0.23491842477481911 -1.7510900928371493 -0.014350204966051078 4.4898373575815347 -4.5942323377637182 -0.49816290417424575 0.46208692088881481;-0.16699598008011057 -0.050897087313939701 -0.60322282943487016 0.30452530649209897 -0.42971170862162794 0.20691502343192492 -0.053445148153276119 -0.12836691249113866 0.039301332875205951 0.49869921730883487;-0.61015121132032424 0.017989342519819745 0.81630174261341104 0.71761367555296773 0.86294400506706581 0.21028412187956616 -2.2781828661519699 -0.32589484515755118 -0.24390536775261629 3.1312007857605209;-2.9354438435777106 0.18417832642095441 2.2247836274631276 -2.2653263090664879 0.37226021881877064 -0.24272806752328899 0.022788008370130633 2.5966918032202342 2.0036358673785699 1.1886267821086858;-2.81602129107387 -0.62833816425863431 -0.03671043191872269 -1.3739537268105608 1.0786896072573406 0.22875471249551044 1.6220339426435146 0.23502897268098541 -0.25084165376232598 -0.388533276031647;14.639160864113098 0.11500581159548141 -2.9835125875360249 -2.5746872838378381 -2.4468592002472436 0.32243375657359952 0.48057159251076337 2.5096438746310934 0.55362357638309923 0.96206531823979757;5.7138851858109785 -0.95745073462215813 -1.9754056994835534 -0.64657449882959073 0.8182150094156192 0.96968183557968246 1.086939953884255 -0.7412749574666383 -0.41601816118157553 0.50336682479559491;-4.7873119053083268 2.6605487866979587 -2.3989710481360289 -2.8813163867752483 2.9984677745191468 -1.0253086673074621 1.7730905355323172 -0.8368342413186044 -1.7986417408897313 -2.5840768969161294;0.74561961080850858 0.21494847549155113 0.80944644658828369 -0.25595528935706696 -2.7288031279491589 0.30385052904208742 -0.53689610840055912 0.68385113660659747 -0.292412102287951 0.79166934536859701;0.5170852873696552 0.2980994612450123 0.78345330886775666 0.77444330148660556 -2.0250329980160817 -0.5409196620415303 -1.2692593021784837 0.3762509960294817 0.68018630261995205 -1.4980277585124455;2.0526994826559877 0.076483126374349286 0.16849652106595342 2.8434615448478588 -0.62490943770423579 0.05204372445220283 -1.1398758873668084 -0.17945119893765324 0.88119232733998687 -1.1624893044267832;1.7089036784401948 -0.035614242767419438 3.1132658625899672 0.18674166297476935 3.8768202784038603 -0.4790828112374142 0.021563639337775914 0.12067721987501714 -0.2584128520054953 -1.4385047791828856;1.1152817586823527 -0.0081550175918434237 -1.2245946607663249 -1.3593029212939465 -1.0748299145086586 0.25977579899363168 0.50821573884265758 0.52288283780969524 -0.41975983002059403 0.74492266848035693];

% Layer 2
b2 = [2.3680589431206989;-0.48520647110781706;-1.9626443463306222;-0.047113892836662577;-1.4188635424766198;-1.0059018769094836;0.7934324853255087;-0.14074945065863209;-0.67480232667954465;-0.24034080985914943;-2.4576719671684799;3.2038383504115426;3.4106574614774008];
LW2_1 = [-2.7691671603311785 -1.098557989838578 0.56747497854597517 0.49751112584868323 0.46035117436452178 1.4736201410339673 0.40503552087274192 -0.83202426134729268 -0.01611130012305665 -0.16980629957197077 -0.47927947231524803 2.0766373709056141 -1.4457640486987968;-0.28097074145273604 0.95642368358663765 1.5398330396268451 -0.18756027577169018 2.4800102043200472 0.62959350432177497 -2.3765964619604802 -0.27500607660257864 0.96143072730239243 -1.7964819019463143 1.3546632353122923 0.065963556571322884 -1.6264202516732651;-0.63208408976080832 0.81108028780499952 0.7848983097032971 -0.53855086752499526 -0.021862841408230149 -3.2767219403359427 2.5674414031737078 0.81691749760937138 -0.45276219703390214 0.46012539777989142 0.090707929433632734 -1.1644203027755098 1.0467344247214017;-0.58612072741522847 1.0436040501771275 -0.36884580258969857 0.16721459895095966 -0.58196042060281561 -0.27585539260412018 0.21068274500227466 0.42352338544635543 -0.10981840863461656 -0.095389612205441107 -0.21641436705801997 0.22429799374842072 -0.34458335565962622;-0.4644651824087575 1.8175764921311639 0.38243070857256373 -0.79817681395369355 1.5172854470052801 -0.69355370053116194 -0.51306478295125313 -0.41594492760904278 -0.99599219437103581 0.72379162476912451 1.2397087222114478 0.58267014184892207 0.91873215805188058;-0.48229845823305861 1.5385472854995095 0.21929928192713902 -0.56085542342025996 1.0651327642840591 -0.62002595621571965 -0.31652939976885924 -0.26477690019359967 -0.76423111731159299 0.52186245262652486 0.89481830103894444 0.45514093544580098 0.63944488725149951;1.5246288252295883 -2.3741834235708219 0.46899295258935381 -0.014114141917900058 0.81158791852179379 0.2548204076822711 -0.31508232947698078 -0.71072974883028084 0.73870480427616114 -0.14981550060013851 -0.056630951147274435 -0.46932053408518737 0.60045169738944137;-0.57863458244505106 1.4140710362244586 -0.078138134455931207 -0.25575380199158898 0.43206229439453003 -0.57741623060213831 -0.074588378783260259 0.010839253262524261 -0.40733985744877843 0.20593921083330613 0.42378773709458983 0.38484445811611573 0.16992499401813427;-2.0953757430011906 -0.78745512900309433 0.62647596092839175 0.64003971775019541 0.23936922026209592 2.0268866459285282 0.30200928484956707 1.7277692724696134 -0.39904342795878645 -0.064110084604968559 -0.80627736698588337 0.53379741537954517 -1.256013797304562;2.1244603370495518 2.0599266861679424 -0.56075718298706012 -0.57153849474062923 -0.23882685192418179 -1.7304416810908518 -0.066574885036358583 -1.8145573727486946 0.51605578160458609 0.13374203694552644 0.69917990527185103 1.7072172576177667 0.769902181374582;-0.83475937185835791 1.0845520568623412 0.71590189904015111 -0.48547659804536991 -0.1222798383458655 -3.1451156396499935 2.6579425660150742 1.5922316944356536 -0.54138532707466103 0.48607213164946267 0.055686685660097282 -1.1125228971964831 1.0471360030607784;5.6943364310188089 -2.3259851552791941 0.18060542246279276 2.5458829075864169 1.2386002089808337 -3.6566639598058863 -0.65200869281805662 -0.54895804515751667 -3.3311910203897135 1.3267003566992868 2.6064395781347356 1.8489667738616902 -0.32677793152911394;4.7176064239625735 -1.7818117605805681 0.41720483121825402 1.6277961816271671 1.6747241892938318 -6.7330582616426602 2.3534173757732826 -0.99368157484207331 -0.63818434063344298 -1.3470887832651781 6.7133815342282075 5.1129789525433891 7.032493834739328];

% Layer 3
b3 = -0.18640204316265249;
LW3_2 = [0.82022705431808485 0.080830025625808696 1.9137302410828829 1.7819003913764053 -1.7486634341545531 3.7217693336351796 0.51696579645759932 -2.4458901708423562 -0.88819640607154438 -0.86979471896485949 -1.9289150044866394 2.0508801500813312 -2.8857932790812164];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
