function [Y,Xf,Af] = COAguilas6(X,~,~)
%COAGUILAS6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:18.
% 
% [Y] = COAguilas6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;0.281968137600451;0.304971027752364];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.7091732663151364;-1.2236668361920853;0.63794558559380388;1.1953001311577123;-1.3742087131455967;-2.3417334049757441;-2.2723853259980138;1.0702197009650607;-1.8084146128919063;0.35409382917160487;-1.496114048004167;-1.0978681721580497;-2.061802315704671;-2.2984229574826762;-3.3174150274753282];
IW1_1 = [0.062680342318163995 2.1274389737888577 -1.2473043683152591 -0.04300465581041836 -0.35253729354049512 0.19364836135957211 -0.19161712576616369 0.71467000322391228 -0.088617103601134839 0.15686441325474237 0.30676133325453042 -0.12319652691884719;0.58621939486200425 -0.029004575943602461 -1.1494627005543794 1.6430905666856466 0.46814001468628608 0.082537434904445553 -0.92757216809943954 -1.7326848291152157 0.97029701996157969 -0.06024632882999563 0.24974560789077202 0.6025163600150043;-1.711581170557863 0.19643397906234672 -1.5720669387078967 0.45579777623537837 0.67788732274804109 0.0419012078236254 -0.38150661795389534 0.42856908572167907 -0.033258857071921999 -0.13797943210640295 -0.5598673194370386 0.32444044187316257;-2.6784435668178963 0.041909042293368615 -1.1391386665979588 -0.11052572749853691 0.95837349783715187 0.64041093216932254 -1.3405232868599055 2.7561646298178277 0.085416384591620667 -0.76994910637317893 -0.72756604427198657 -1.0505089549001472;0.53687597795004527 0.4368474031266989 -0.10943877300146353 -0.058442911725320054 0.79925194122893628 -0.28499325215481358 -0.59234050279303463 -1.6168365964829505 1.0170896558661853 -0.07614345205149009 0.12872797305805284 0.69007593418127544;1.4715342020576192 -0.72508933256358821 -0.12129417563455479 0.33574618619012159 -0.067696548567558953 0.076783957929189697 -0.58942817422177085 0.029643177669166389 0.30947201643744793 -0.44753048925000094 0.028332562539608662 -0.10586057425893045;-0.38758784458591794 1.3218784577566893 -0.11823564132058095 -1.9267621797769656 0.15476760512345367 -1.3349761606293602 1.3782005594415376 -0.78625998890180171 -1.5771555407069744 0.26835249500478325 -0.10450985955163349 -0.36542447432294101;-0.11389298153628281 0.88928399304329897 -0.37464559144752319 0.47985431488281849 0.012081711845189512 -0.058619484620158091 0.12440101043637633 -0.33031336439856518 -0.084701090412534277 -0.033093144122336063 0.049464760549341513 0.13593098898090095;-0.0083990456998854959 0.21945362135586674 -2.6012222749931588 0.026973690528201106 -0.52887039242846923 0.083050000673314653 0.3503390865575669 0.67277710701412152 -0.53571509456187616 0.14640457150087632 0.56379579214015418 -0.24919342047622589;0.41293099121979865 0.28551166904371456 2.7207932206436731 -0.14151391606239844 0.28660560878519803 -0.34672872843208946 -0.50851538275240205 -0.6002025822822098 1.0729462233546758 -0.29086707981517607 -0.89717629402950605 -0.047271413132322429;0.62771615968555683 -0.070587610877488105 1.0989176443475679 -1.2525428783632122 -1.0461551149570989 0.033991117153757758 1.580185962276687 -0.93787502828140001 0.031248461576919344 -0.059646320064223247 0.48283957155273477 -0.40718117649005114;-0.29588339609537706 -2.2007744232290332 0.68995017884948373 0.098366921602375965 0.02331316189200551 -0.33611816478772333 0.13920400259299406 -0.58006547557938037 -0.2688159589211454 -0.14759257290473726 0.22400197619717924 0.18785042915424702;0.37390175494461397 -0.00037240076745249581 -1.482128492984004 1.2966321617882755 0.754919755238734 0.54013297071220268 -0.2319038309200433 0.47980162253777198 0.38051269393364751 -0.5055158485304615 -0.50944877093274787 0.30361666604309395;-0.18212892617657986 -1.110059441171791 -1.3787674642994256 -0.29637422594233614 0.041139634900973492 0.24999155878114515 0.53984457086721549 -0.027606418096514602 -0.090389918380905723 -0.17239263496765403 -0.20334112676124974 0.10560841852430265;-1.2622909171489591 0.55764075330755736 -1.3905444070833211 -0.74556955729768548 -0.69256711622785416 -0.35569835522898635 0.57249981837011421 0.81759323905260484 0.47223184617747493 -0.30152105321828931 -0.41628580094574558 -0.19370012113807217];

% Layer 2
b2 = [0.69569198871156057;0.066743047344230047;3.432173059709132;-0.48159293345454507;3.082739778866638;-0.16809510008174353;0.27384648782612958;1.298686191984344;-0.086719850654566555;0.26297484266943838;-1.6137638809062265;-1.3426168944085988;1.4007928905090019;-2.2975562333086383;-1.986174878969075];
LW2_1 = [-0.19803536096237317 1.1692927839357827 -0.52263459386097744 2.0321606181340242 -0.30187057361750086 -0.20096095992175322 0.59634852201184718 -2.6080028030435383 -0.29152736279075014 -0.16636524475551986 -0.51846085422006749 2.628941108405682 -0.060835452486274484 -1.9766065082542201 -0.071831097762688798;0.01501528808635132 -0.26534117892956527 -1.4639705098645992 -0.73265986019377027 1.1963141757573701 -2.7363934874727573 1.7532738470550702 0.39163123363310215 -0.25282357612261047 0.078174940311837304 -1.5553062430712947 -2.0864351367234284 0.68668207110804647 -0.25502476443742605 -1.586180992713591;-0.30507716705320476 1.2274585304923147 0.8827569071059882 0.98636916936991981 -0.7201373873464344 0.32685965062349842 1.4475730992426918 -0.82841542293971759 0.69937604085082627 1.02382467019587 1.0239167687695048 0.049205145663640169 -1.6573651689030666 -0.53651059357134723 1.4601718814885212;0.92627882146743379 0.60072938635235429 -0.14172496126627385 1.9285772360756559 -0.48766762208918052 0.3621478649183783 0.60154647439146258 -0.7250696762156299 0.89161112595916925 1.109702429353348 0.0052126141225565248 0.0045125107793797369 -2.0748050642159495 1.3747661153991522 -1.1030440598203239;-0.027736928470765202 0.22137274627108111 -0.36508866614148749 -0.33108747616700535 -0.86363332112708702 -1.9411384557301967 2.8822238364353807 2.9362083375440644 0.20941408753429713 -0.1494669007481903 0.53262762590906121 0.64606311551518247 1.8484159087056116 -0.13150337037613913 -2.2820262645027269;0.37153153695967217 0.46917583363832294 0.18231874748206178 -1.0296302155067472 -0.79672457422763998 -1.30457152845541 -0.70611729024336223 -1.5532005330582961 0.60236954344189753 0.28667381327286978 -0.46062963538719642 -0.032843602341910319 1.6914939036854795 -1.5916805358432924 -0.2049525302444466;1.0269392126831176 0.042981324728854103 0.08234307758647047 -1.7375478415064005 -0.01605502753339548 0.18245188099262497 0.254379445343411 0.43471621695716012 -0.38605301123346369 0.3033197733862697 -0.60661719044250562 -1.1484490109580698 -0.21590915752301235 1.2930091848113627 0.023709522560975024;0.40181012704618257 0.45296863737681836 0.47498678256071131 -0.86128668161794164 -0.56850268289790284 -0.63557952534894635 0.89683507830292331 -1.3939072217983914 -0.7230379475949128 0.061256338122385318 -0.49519450739849263 0.47324179232540942 -0.34679459924892597 -0.94813324965248313 -0.73984680351470178;0.23683921405405542 0.058709121683899371 1.0255073521153211 -1.8267564621600851 -0.23906138227513546 0.32514755844530574 0.047973267391780483 0.53263005715041878 0.32053596562852915 0.65041982061022718 1.1800099317689536 -1.9646424648979459 -0.53774976162802934 0.73587062706401807 0.024531208521978924;-0.28883140927581297 -0.51841485134016829 -1.7410886830057599 0.58943863607552338 0.98128549083790373 -1.2831174459078629 0.68168121572860618 1.4508844572028972 -2.4790106441746267 -2.0773896851335554 -1.1698680005069235 0.52196253680956439 1.075959594580812 0.70739757631191691 1.4343535982054989;-0.24113246239794681 0.58143188344406904 -0.25685047227822722 -1.0401391961402542 -1.0301116338079497 -1.5893221602436389 0.35751882281011088 -2.071099675901058 -0.37826767242582482 0.20828629565723306 -1.5280762222692357 -0.0525897604429372 1.613175459243759 -1.1271558712771039 -0.4839597852093544;0.47200630874258981 -0.14672455116822164 0.35171410395283131 -1.4122841919270706 -0.22165037920493236 -0.53083627976553305 0.024644761798985174 1.7114435014664979 0.18992389641728455 0.22471879911055975 0.81148683907921593 -3.3392481124564286 -0.47608841845140748 1.8859165040788317 -0.21440928643031321;1.448211138239196 -0.88633905311418881 -0.20695708675475449 0.5204051423417535 2.0977918958771378 -0.90216170307163024 1.7576963571605939 2.5977738469610947 -0.3656690574321948 -0.021765447813901002 0.23969858113147649 -2.5614536399512007 -1.0456104597734128 -1.4386546849248527 -0.50866386941614594;-0.49991937675646281 0.68220533512023418 0.56381377165296431 -1.1534758024784286 -0.53332550105717313 -0.79689354180071514 0.45855129557223268 0.50577478516546492 0.21732275119338518 0.37384538887397661 1.1901599508340404 -3.2889768163573336 -0.80407811106830451 0.97673612557121636 -0.14760719076408171;-1.5982479949584427 0.76084064467179746 -0.13096626451110058 -0.20920348007329004 -0.15352004097659971 -1.2842116360997686 -1.2989801033242678 -1.3566678174099156 1.1544786379680845 0.17417836990551308 0.40371209558042509 -0.61160025813946628 0.39011174385305902 -0.44959911416015147 0.46880091578637018];

% Layer 3
b3 = -0.0026208537475344608;
LW3_2 = [1.9206568110936679 -0.84255457062293893 -2.3995543568957842 -0.76527749379222931 0.31067172541158605 -1.3003751268264572 -1.3419375286665229 1.6737676789165845 1.7620413841352605 -0.42127373636146404 0.89296254233634786 3.040486782671866 0.70905725517154483 -2.490823096413211 0.74737528372627082];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
