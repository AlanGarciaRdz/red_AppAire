function [Y,Xf,Af] = NOXAguilas48(X,~,~)
%NOXAGUILAS48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:14.
% 
% [Y] = NOXAguilas48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.6230467477266766;-1.4438505731000428;0.048709808094454042;-0.70212941599138368;-0.81694031173997483;0.074895936596028528;0.2414501014783747;-1.5660153212570569;0.89224437722248928;-1.4493157745689538;-0.6649577338807322;-1.3386392425094606;-1.7204915803977099];
IW1_1 = [-1.8601832306372899 -0.10965775691245724 0.76143939681499362 0.54400281898871405 0.25410402906782759 -0.5786773412726961 0.35843410268083625 1.2687744468180524 0.066077250718384634 0.091374595914153867 -0.14915007891008658 0.33464699765114042;1.3909051363420264 -0.3087152366986135 0.60427758243702379 -0.99889554451754503 0.46036686301194918 0.14209273315322571 0.21767923988009721 0.55851388157584847 -0.61441377985519674 0.068727353718166323 -0.49604767667664762 0.5265238424592189;-0.37941890470668038 -0.10521992993636574 -0.82296616514335741 0.70851651481421796 0.60699168338085585 0.11721985468345709 0.32179415638726994 0.50061348603415379 0.208098660238516 -0.039821394291455536 0.079540237238712327 -0.48175430176144429;0.48437948755959387 -0.95192463945507588 -0.2499908144336227 1.1084652291162822 0.066575913230484826 0.78812866229862355 -1.275617827595992 -0.83753963993146607 -0.66780272098200177 -0.43701564589093023 0.74107491035338935 -0.11534175758137399;0.12935380111964517 -0.056025406536777789 0.45937394213362159 -1.4446605138727999 -0.30619074847600164 -0.21203508614223393 0.30438151338754266 0.21623128365162658 -0.16348275373021243 0.042766558662880504 -0.80391043289416309 1.0687230745289373;0.020332208970825674 0.25355279324639934 -0.81310950447146724 2.1400567187538524 -0.029331247156617071 -0.42455795912644412 -0.019250377179675052 -0.49513973312732473 0.41608173853657621 -0.18412493350047768 -0.1320445289740261 0.094725848233532126;-0.088904629892511536 4.3366342245687148 0.29409831783499102 0.047650978849022869 -0.17562893782184311 -0.20141693502127744 0.10243755521821445 0.11954816495667718 -0.079286760579265592 0.51473778886845878 -0.047900228092162475 -0.22244821078460369;-0.029834479397170953 0.42954648273275881 0.95969305673629268 -0.67200866990754027 -0.60827474865987119 -1.0154403459566657 -0.61628810116863653 -0.94547864461755615 -0.096409669199398557 -0.030095237993538578 -0.41517008793498361 1.022661048344115;-0.069261921499741516 2.5473829188807464 -0.22637331988111589 0.77115897998962113 -0.34525458792526825 0.35180787954411441 0.15731923968420836 0.48358590867710483 0.067775314458401514 0.11600083374516088 -0.11390028779972626 -0.12151735008880216;-2.1590166755367162 0.23010040844013377 0.30994080718502875 -0.41602866580968501 -0.38237127260373127 -1.3532393293215947 -0.98410710840563587 -1.3504951487517498 0.15602555599485723 0.59550827136978401 -1.0376641100489592 2.2571371264971236;-0.90229961872899 -0.027511766226290604 0.40603221335663398 -0.97241445784320013 -1.2582827068883427 0.71626149570880204 -0.48012470759507103 0.46941125653143473 0.31521375974800769 -0.29881583686762775 1.0324758601493196 -1.2328693894465732;-0.37818243522529049 1.3666937300683193 -0.35580998857073459 -0.13360558211080439 -0.38515644166507956 -0.4077932427145351 -0.041877208406484456 -0.18833286136309785 0.66424989077243402 -0.26120457624582272 0.050162489782753825 -0.62386252120780328;0.28913069602622959 1.1207707506786913 0.82385110915932924 0.95808720534718583 -0.13635306834796942 -0.049122086377661307 0.20874408650567208 -0.32123852189398916 -0.25243405162779847 -0.059091326777919173 0.27949576121770769 -0.88931468670730363];

% Layer 2
b2 = [-2.0451892278134594;1.4144454617361926;0.62863240041410962;-1.1723893759834634;-0.13510667300805032;-0.11269236779030749;0.017711190247201677;-1.0743223877283925;0.87897626003384055;1.1631036087370639;-0.76525067943628799;1.706812051172915;2.1302068389678661];
LW2_1 = [0.65207976251617206 0.04290069138528909 0.0087736653367942313 -0.76519021897513517 -0.65544972296385129 -0.74867381904673425 -0.81058608436117363 0.18570834007468778 0.86750089490878979 0.88479249096151769 -0.80756642746386631 0.45104520467645987 0.8689229335876133;-0.84505359561417503 1.1741625221289365 0.29004563620224799 -0.44807017991080061 0.30640257989945696 -1.4632707432245131 -0.061311343076833107 -0.89058925986810489 -1.3431493273508397 -0.4472893183724963 0.29150890864179857 1.423894124103338 0.20114035324520191;-0.08992853723909261 0.69747163054258909 0.74018993445151893 0.62111010006852185 0.19290670228208912 0.46108067759105842 1.2399768553755053 0.44257083485675475 -1.2383055037222945 -0.28129272849436032 0.91623505249176618 -0.24242412712708764 -0.50304778602149469;-0.13969995759271836 -0.66815250219879896 -0.22208380046981985 0.13828662829795607 0.410478716684404 -0.80744161277620508 -0.15298426095214132 -0.51962226427985192 -0.2733983529647237 0.088215564522311385 -0.58868423946057002 0.68285830974289685 -0.80557804814269263;0.26847019883286249 -0.17228072755708043 0.10304349523186836 1.1126802501063726 0.57951007918583064 0.053033779372662508 0.19416278743622789 -0.6516116392517628 -0.546058263895292 -0.10494838974954579 -0.38778298696955593 0.36489055401505582 -0.84007513604659367;-1.2789168387563734 -0.07542445099295754 -0.12686992295931629 -0.14443376267143415 0.22684029846213838 -0.48726833554286059 0.5461080377767068 -0.98414224779702986 -0.082711677096834343 -0.08975948069151482 0.19294223141146 0.94049985114927059 1.2211826712731897;-0.22058819598400994 0.32788226318216218 0.5317649062268478 -0.0013942606332856128 0.096861027740816188 -0.19314273071147606 0.68164746346244831 0.71497711600864866 -0.83367882909252855 -0.12122361043077 0.5832371635921858 0.11061205812334543 -0.43729468839342378;-0.15228254624069598 1.3309127340400755 -0.79061241470503951 -0.62210909445322982 -1.7356792523496856 -0.4531901164337202 -1.4016875875273851 1.8920076199253204 0.8664634730102283 -0.72504410064665259 -0.12493389022730332 0.38743286600523341 0.085098831706394956;0.54717206579463384 -0.55634613102783814 -0.85338025068364731 0.28454772763684821 0.68012876712097381 -0.02227262895567067 0.11911379477509949 -0.43310829830093567 -0.031950700523603007 0.55156213136665355 -0.54190625990675345 0.3858151419684796 0.14008822480908983;0.61983354784661215 -0.29716285945413917 0.078185652606909226 -0.74251364665544584 0.014431587342084395 -0.69879029164152262 -0.11975355560752537 -0.67195062874517897 0.57714365280761559 0.74654729483140103 -0.021469036472083515 0.25844537279840418 -0.53987674130037522;-0.20176138097211771 0.12957574430565511 -0.06657954949893416 0.19959955458371892 0.16928433312325669 0.93819886797628949 0.22267383011233483 -0.94202477446575883 0.37662775954122513 -0.27887258030353096 0.016898648101904279 -1.7104190028293313 -1.2078753349480664;-0.49715270350896562 0.93930119692197978 0.26100358650062383 -0.01846198794095652 0.68586650455454523 0.6568814980451001 -0.044380652277006126 0.093980847380432497 -0.57625372130477492 -0.80115176917488784 0.81568718655420258 -0.23088280918238546 -0.97177417688520829;2.3243498579365389 0.25237345469941874 -1.4538818773241724 -0.13294330457638201 0.10129167876018007 -0.9081310190945171 0.60354280578574993 0.74603370220777643 1.4748925843889402 -0.87283494634053693 0.042433121268521425 0.68363662321618934 -0.76898105026240449];

% Layer 3
b3 = 0.46224327037655827;
LW3_2 = [1.4094402828530861 -0.2259334406424742 1.5033277318527662 1.2054182813923955 -1.0103296779409281 -0.15107106697544484 -2.0403597694955238 0.74720716145135035 -0.02984945044602156 1.2256138167263964 -0.22215889334620828 0.69695635558224323 -1.0455972512114946];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
