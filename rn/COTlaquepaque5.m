function [Y,Xf,Af] = COTlaquepaque5(X,~,~)
%COTLAQUEPAQUE5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:12.
% 
% [Y] = COTlaquepaque5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;14.7058823529412;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.448430493273543];
x1_step1_ymin = -1;

% Layer 1
b1 = [-10.765851002730853;2.0277854682267091;1.8727647468557127;0.3116105778179733;-1.6787342964325691;-0.043562805455264968;-1.9572517918756838;-0.58650212716625005;2.1921070049199214;-0.32431236980779465;-2.2365788638777602;-1.9264744309229802;-1.9696935273853524;-6.352520615820505];
IW1_1 = [3.7870648620295997 -1.814355205552699 -2.0770151985576755 -3.7083845315863622 3.0663119796019442 0.96842735660720547 -5.0850165340725502 0.78953459399018644 1.5829617332991897 2.4750609087894526;-0.14991619305966283 -1.1690221925195179 -0.36743669466033835 -0.15750987775291925 0.18309422299970426 1.6650029583958141 0.97900862785689335 0.40753789620004516 -0.32974716505269519 -0.83959248557638522;-0.92922479301360639 0.76799569365956444 0.11463060552979137 -0.36826444733204466 -0.082677283619419534 1.8119585062287564 0.36578392650458902 0.27610801120227174 -0.04648903669863514 0.082684935151492764;-0.0098800578563806377 -1.8876382623238424 -0.69632176682480684 0.3097048433761373 0.6028016580488651 -0.20819891422046569 0.1401380441739129 0.06307770903582384 0.28376173102576319 0.95278420511307504;0.17657377652262291 -3.7615297594038286 0.14675153322424239 -0.21468906993869447 0.068066966558821648 0.043900255587269857 0.40264275751332262 0.035077392189380933 -0.22232796268171351 1.1467702473902435;0.15836353751694648 -0.3393392549028445 -0.055649130907611394 0.073334446773570233 -0.0094024951801269831 -0.34580827015270288 0.11936900640266478 0.030484787154367934 -0.013237146568455914 0.063378239937990424;0.87276821592269593 -0.76104930802939341 -0.50491858931542921 0.54485026892829547 0.38470759859687204 -1.2524167953208978 -0.40088545036452111 -0.35269315880200042 0.049540710589522551 -0.81069144992616771;1.9103213446542424 -2.2868791547277234 -0.35415845857003414 0.20970077292734812 -0.49246747977140243 0.69586308995971113 -1.0686662908284084 0.0011089829020054791 -0.024488479505556514 0.40649334884951072;-0.10559895572813115 1.3857237773850257 -0.63069643078009585 0.19588888189641093 0.062284618241820036 0.85178096513612933 0.052686714862942421 0.16137245464658945 -0.11730836846100036 1.066960840082076;-0.57643849361407939 4.2583716724743006 -0.31161185988632928 0.82175373848596067 0.92637700469369344 0.36333307916037871 -0.59953485213350377 0.38786993831567945 0.99870098893273351 -0.67159847200877409;0.23777589777195191 -2.9767175850994332 -0.051525453160109119 -0.026421095919721041 -0.045286360223851761 0.23669879144276187 0.25524131585796106 0.14633416140252267 -0.25245269992063107 -0.42498024081096974;-3.2585687882669045 1.050180257780194 -1.0577354911900527 -1.1670198827517528 -0.27469229595770989 3.5299480218478259 0.34610471595498449 0.099102132081810429 -0.13723304743395043 -1.5496719321538848;-1.0100319251699261 -0.662915081687525 -0.48898099431823649 0.47105843357410082 0.17620170365623267 -0.40546384327689439 -0.22306051862908005 -0.29417157015108908 0.24401880812651333 -0.00059293287667876518;-7.790771582950339 -0.085915638992334592 1.173073929585337 2.0658008773056298 1.7887511961197951 -1.5219837399223768 1.5767900330215143 0.24518088479742806 1.2932467301283594 -0.087985984173024223];

% Layer 2
b2 = [-3.489009634092533;0.39479253851423224;-2.099937956546218;-0.83031330858536601;-2.6362022151541229;-3.5395586802036716;-1.0620147781512235;0.90512045206614877;-1.5579972271538511;0.49967234106915404;-0.79954537887324817;-2.3868014996570945;4.1951823944975315;0.37616546450163124];
LW2_1 = [0.10018193282236176 -0.30570116542579095 -1.0675736365587341 0.70357316493958499 0.32742126965164292 -0.36742937480592652 -0.56934495309824218 -0.32245389786951006 -0.072316864739422115 -3.1794873022109824 0.92748599402470056 0.34357413718781649 0.20760127099661974 -0.11556743847894252;0.25961103729532581 -0.0046112282203221028 -0.36145242252473303 0.58766021085652154 2.1213943277455183 -1.2570391951372577 0.84960949746455161 -1.4327696043318165 -0.056877715701716416 -0.28110664116924267 -0.25611864196148576 0.27868062494408241 -2.0796727805249988 -0.64079554764246882;0.093858160738870614 -1.6885394684984258 1.0960476894398326 0.47214812058591016 -2.8082898174305773 1.4079366410807785 1.1823731022173929 -0.44280575160379015 -0.29463720175899594 -0.20999621714806299 0.84188691140181615 0.87238886047792652 -0.46366877584665173 -0.24152165736135855;-0.023908594920286221 -0.9876194059666914 0.27803035083359035 0.45467992685899827 0.34847354109890116 -0.75632027503183163 0.53158357516662635 -0.22518037477741432 -0.38637689479631943 -0.20238876660353677 0.084331443980078247 0.28829953472130759 -0.78063781838527346 -0.015840170102090403;1.2080249624545749 0.66478957446855891 0.35572209328493309 -0.79120271150289434 0.83445564075184242 1.7744531721071883 -0.65717780521309277 1.2380466083442356 -0.84963416855636842 1.4943078091269786 0.77456961348695141 -0.70410590565184406 2.3475849694190916 -3.440995198400711;0.36462998300685456 1.2502369540538285 -2.6284623164420196 0.495384331764465 -0.39822883730137776 2.5012765145263449 -2.2180783784245968 -1.7661912666414028 -0.29760697950758891 -0.2048673144222134 1.1861842765211954 -0.94591215065613177 0.14511145872191333 0.58883812774561684;-0.056440729872865095 -0.0059494295707590381 2.8187660268852839 0.41027684121468166 -1.1992028611957861 2.1514386995941179 2.664854729827618 0.44900911020451428 0.32387604330239977 -0.014868687973694752 0.92636911366545049 -0.28322564487799562 -0.014449543340781308 -0.46505742903809705;-0.24528329009414024 0.48655745642007692 -0.67139695682993672 -0.92313622913778326 -1.5166356251889803 0.57313838187643118 -1.3777509867341422 1.3396887445306072 0.55672289472994763 0.3392697578115656 0.9588870653253817 -0.16784978467406322 2.7766453955846062 0.28373257912262961;0.010651873557013067 -0.98624636328408033 3.0559983388300149 0.68266119760235788 0.035315777296992791 2.0480973252896475 2.1851022881626805 -0.0037325022193432093 -0.74569910706947673 -0.18911027457670976 -1.9353827700324453 -0.22197973240824539 -1.8556990513428175 0.60187725599245334;0.0035944067186131018 0.4861560754097386 -3.1863088408637066 -0.64333377872193498 1.7062220922505886 -3.7744483784426102 -2.9195339528800508 -0.2661796369902415 1.7332783310805011 0.59331791636599818 0.46752340750047766 -0.48680021733240153 -0.33414883974928933 0.5282531910697148;-0.1351195835048595 0.76657969897655009 0.56154488490813981 0.64522199450677065 -0.59411623720550166 -2.8469078389803624 2.1821113607974358 1.1862974040644723 1.8690257214530119 0.32132551748765631 1.2941387871492154 -1.3402595021591255 -2.564817946344994 -0.073655553568868284;-0.21981104285151851 0.5247330337523346 0.56494369766670349 -0.94175413029706878 -4.0514993703611379 -0.63029367608492981 1.5366392734122316 -0.67685265634931246 -2.5398235043715838 1.2010776243304837 4.4309078638232204 0.56542826275257674 -0.98828343711018574 -0.073467230675192452;2.0858184935430648 -2.5005960093185418 3.0554749067672753 -1.546180331488886 0.63572969878001151 2.5590937124497386 -0.19796983882881886 1.2907354009720278 -1.3191921822564068 -0.09016515974555854 -3.6633287619908743 -2.8352346002741258 0.48112072891120961 0.40734911246143374;-0.18180358696423812 0.86925775729402643 3.5310857839342877 -1.7047119462647564 0.37110419767306002 1.3480760134971896 3.2286230773131441 -1.1154819564895413 -0.48849400907581242 1.1572514015659447 -1.9818749058431375 -1.2667588173335995 -3.4584528185452514 -0.13739766606292739];

% Layer 3
b3 = -2.6754095512899054;
LW3_2 = [-3.5281820039025709 -1.7113486112966325 -0.96180378143454182 3.3772466656291429 0.56084688825014628 0.56386293666240661 0.66546319599762793 -1.8566398256602703 -1.4534910952295004 0.40999050553164385 -0.35428656005351944 -4.4298582733976577 -0.29985191565511665 -0.88537349853757463];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
