function [Y,Xf,Af] = SOXLasPintas18(X,~,~)
%SOXLASPINTAS18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:47.
% 
% [Y] = SOXLasPintas18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.0179856115107914;95.2380952380952;0.0558659217877095;0.00576368876080692;0.212765957446809;166.666666666667;45.4545454545455;29.8507462686567;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.1050961212627195;-1.3893584514994566;-1.2335906656437106;-0.9496955629705085;0.6299374804930209;0.86415797545708217;0.22355827902034056;-0.47215862111453566;-1.6872578628166681;1.4355011006131611;-0.85004834922179129;-1.3757273100487586;0.53303074181753285];
IW1_1 = [0.44554784498056582 0.13647501757655772 -0.026114190990155578 0.43395193161034129 0.13704103202823165 0.90589456296504933 0.83467563373648113 -0.070132322088246435 -0.32003001621764327 -0.11576614888792822 -1.3564555397334548 0.08053345983732485 0.45392118092722972;1.4153753832418245 -0.2800870867668942 -0.2295694859500344 0.37056229215860154 -0.048026723137740895 -1.3711969371405666 0.39234700160844088 -0.10099902072576779 -0.037423286165242424 0.32423448261984134 0.55054819231352992 1.0597967006244249 -2.1512283903238658;3.9906840159892152 -0.39075942327476537 -0.99678238766566529 1.3150492620493435 -1.0310592098003368 2.7675071000418234 -2.3676847836542856 0.35846279091300948 -0.61722206335037955 0.6238741421318964 -0.7218332487967386 1.2955400135062094 -1.8327968105693371;-0.2771798791487301 0.040687034862376556 0.17336301603267859 0.22014870722353153 1.1621392822803205 0.15254317880083657 2.3190627985260823 -0.098930467387528032 -0.094690959265084598 0.017888902403980878 0.17426501691562246 0.53183540402160079 -1.6118981297970321;-0.46368547544433036 3.4774800821930754 -0.38000030836352616 -0.89489786810390792 1.0222541561253016 -0.27065244633703855 1.9404047144486856 -0.43659662278985906 -0.19369129796819637 -0.10823500613051318 0.56700130623129519 0.1953342192652123 -1.1630295615185617;-0.27947279139700015 0.66436511169678103 1.4197738844077548 -0.85815288889840535 -1.8079400528867788 -2.2143089713132067 -2.2634406339733579 0.23671622493151639 0.090235814057561675 0.47585749669228095 -0.75390879686679679 -0.046937757417093474 -0.50444910938419352;1.0022665219225724 -0.39431121165776573 -0.17188411152963806 0.21335769187180159 -0.16187163386736672 -0.64979920799373392 0.5763527348880102 -0.10331415855355855 0.07383225769259727 0.0015370544180455525 0.52020264447766362 0.27852776748181146 0.47482731908693587;1.0324043294237768 1.8711295670055901 -0.76140801919937573 0.37631074811497378 -1.185939675990634 0.12453210345883711 -0.35401047638270033 -0.87167897053479593 -0.81375527049686436 0.15900097175517885 -0.12088914966695344 0.94724825866651896 0.50435087321521699;-2.1018727226112874 -1.5357642501357622 0.37375993967896193 0.35605910871309143 -0.6717273686666192 -0.043231588102037484 0.27806336940847276 -0.23985011001368126 0.54579737917425319 -0.38141016203174227 0.32543491248462825 1.6868205377746339 -0.9199224677632184;0.82473346726341878 -0.12233554877538337 0.68322767529150719 -0.76406231607082697 -1.3394685872104257 1.2907005439877781 1.6894123880115222 -1.2408485969714536 1.2720045803892801 -0.28101843785631586 1.182513796080191 -0.068275588617503741 0.12393408215770578;0.99752961694349362 0.017929732644814532 0.14895068132985531 -0.12483407507442927 -1.6884558405012593 0.058605502323542037 -1.3496072512245951 0.30971796618373199 0.40674222709304275 -0.22396081034442958 -1.3875376001955886 0.17614482429614842 0.7127697072805208;-3.3910762305292774 0.49573550002872391 0.95475092274497231 0.41983117025421118 0.035387140747876369 -1.9908511931177024 -1.0283239801166246 -0.091688215554095009 -0.60069847388706599 -0.50940368364056643 -1.2021092652385073 -0.26746656087959941 -0.24518986743500643;0.33793239388052182 -0.46948301284581967 0.25454777117448918 0.29336727729762874 -1.6840183127899184 2.1288326667624515 -0.35032767334916665 -0.078352500017217691 0.45054817884012438 -0.41464352110995978 -0.52047216289670972 0.025451894463347429 -1.3290882158537956];

% Layer 2
b2 = [-1.6379604186206134;-0.61141927955224407;1.3040420495530816;-2.309175431338252;-0.21676948935463256;0.11612079900639806;-0.526012446067745;-0.72594220217500627;0.015958925179319634;-0.93453060065811189;0.90676117866238692;0.72556042961729406;2.2248901803504437];
LW2_1 = [0.61573201245891918 -0.35100775369029902 0.70660291970563249 -0.0062796121138363817 -0.10603198365018632 0.56385508208181345 0.74354241041903657 0.3355065025400647 0.0268325568286732 -0.23842166164487916 -0.15126396299304895 0.59214640151181785 0.2624265694862456;-0.41691756301611987 -0.099589096840503474 1.2414151623929031 0.40675698231560337 0.45306123590467495 1.2768599738720461 -0.22913049353504852 -0.24539638140646552 -0.12089968249073768 -0.10954865311278465 -0.28528263072426024 -0.31370591021307836 -0.11126223343555407;-0.78372743448980553 0.57900077927376725 -0.017618809983678308 -0.36621561921622242 0.31765549287866413 0.6027153982692951 -0.55725851368983947 0.50629104598036012 0.30334221915177184 -0.5357541106501772 -0.20521522014699448 0.38012817079420175 0.47218836139361986;2.018815453237266 -1.8951030513972202 -3.0359071446730428 -1.4015039203433226 2.621939989801215 -3.3285948242442664 -0.884989216900256 1.7086161975472067 4.3273773961492514 -2.4496760685791155 -2.0169519989709053 -4.1497082162882846 2.9907767716342644;-0.12900602632069191 -0.80926303654941167 0.6420716468548221 0.31177664011388095 0.38532871017095671 0.8784137041338872 0.5084092045023888 -0.35714374989133374 -0.031238145360518034 -0.1418758449077101 -0.24300600166394726 -0.42486491303399077 -0.2240310949371514;-0.63692343559049813 -0.11716069587194501 -0.61959155730412196 2.024523777962655 -0.4809966616278597 0.048803871253555176 -0.60500021529305292 0.17839179770270977 -0.24768125115011697 -0.53088305345987052 0.091821807047533149 0.41587355708204893 0.49020643430629135;0.87750474803327605 0.1898447057457765 0.59038515135968872 1.1322325131024875 -0.42111626104895972 0.20749575544674775 -0.90246835814613757 0.78993039854613278 0.30866125137685663 -0.037329303430767694 0.49738608643563303 -0.90946435266966763 0.023976905475255373;0.56940645302588067 0.35600098249788203 0.27795497987056972 1.0337076352805714 -0.47606404691352677 -0.37539730168556051 -1.1916116845492128 0.74914222841099265 -0.33702401043817848 -0.038535757923223959 0.4008550152208385 -0.96228967857933267 0.057973722180539387;-0.80961751167396945 -0.36382344879381162 -0.93115993413835019 0.67058353243975288 -0.46578507261212515 0.75340245753704504 -0.08285344502898527 -0.56562181497115183 1.4072983430939834 0.15297482656359737 0.042215133247235921 1.1126309058836421 -0.10843998986505726;-0.13836376384796872 -0.79059541174592396 -0.83774947667520439 -0.2287612642996267 -0.24521220359967588 -0.68994463777277282 0.10699767530677035 0.68339500607189307 0.32580465318970753 -0.49383687395090259 0.33668761791316465 -0.99754036390856515 -0.75196844950027897;0.51538391239754566 -0.0046443733814675887 1.6071300052157671 -0.36811152406242764 0.79296477762827811 -0.44868883427265754 0.25050965364422034 0.25914570969143769 -0.055846644733984936 -0.26779108554130771 -0.19992387466780662 -0.80288473132021265 0.56862945281988708;1.1914650645657232 0.10039494911376365 -1.0292833007297153 0.71136961580019242 -0.76257457555208863 0.92577727408112764 -0.40414499068264537 -0.90192056224909367 0.50654087136363091 0.30276810719235436 0.25169204283336399 1.7051226383745237 -0.056818142152391775;0.22884351726495269 0.008062197236897356 0.17624548255548764 -0.14332641730915752 -0.019546114918451561 -0.34245184098384363 -0.46477664649781508 -0.19726797380681932 0.22424527422578538 -0.084843392677097576 -0.52344210818656367 -0.3959753049833224 0.38268493176030222];

% Layer 3
b3 = 0.42790721024903966;
LW3_2 = [-0.85560313428148926 0.40038990173336414 0.35075395899895118 3.9427446101384169 -0.43373964392765524 0.14529566234833269 0.86231560883833658 -0.94955486148486601 -1.0404181079670431 0.25191597343312344 -0.45823943019057867 0.47129759209920402 1.6151162369948606];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
