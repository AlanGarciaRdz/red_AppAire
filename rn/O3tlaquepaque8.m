function [Y,Xf,Af] = O3tlaquepaque8(X,~,~)
%O3TLAQUEPAQUE8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:52.
% 
% [Y] = O3tlaquepaque8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.171659085057077;3.03490136570561;14.7058823529412;15.3846153846154;10.752688172043;10.4712041884817;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-1.3547571678659038;-0.41580019836493698;-2.5819725223991297;-2.7775699813158257;1.7177874654459175;0.37852589153413557;1.1809726079879224;-0.93657723879745625;0.62993081129719752;1.3468501819257537;2.4755881898988426;0.7266300767367293;-0.45100817324873826];
  IW1_1 = [-0.98682863353533867 0.58241088217821146 1.2886426822952179 -0.11613778829077569 1.5049114330950313 0.61550206316022171 -0.25778338505317866 -1.2823329724187045 0.93780745508559071 2.1071753754425258 0.16053396588872212 -0.80953439648793357 -2.0310253441334152;0.47031616015855365 1.2508214961434192 -0.49467884364339737 -1.376180983641933 0.4447332536855832 -0.22260130026120326 -0.016453280725954131 -0.033727634420390507 0.12700483879941027 0.23601760917165893 0.35303653786619443 0.062293379989562601 0.05648750878133027;0.29842347146093107 6.605497773211102 -0.74148305284396165 0.87760938973907965 0.21200232512452258 0.023761131687377299 -0.63189587564259919 -1.2123155014136446 -0.59667971754171734 1.9331220989981106 -0.59051478354951192 -0.18609662207734809 0.006788194698138815;-3.4415408815848463 1.3447530371105088 -0.27142455526927511 1.1295855822372203 -0.38264694778925573 0.49146687832586045 -0.1653721164396186 -0.12650562595437598 0.29984411801875166 -2.4231084803277474 0.68063015308968167 0.14282933926600067 0.04760611170252807;-1.3269981018054735 0.47403903835260203 0.0436390061487167 1.0275625320796413 -0.035120818810606191 0.028243211878111841 0.084087233489247473 -0.27733917392842367 0.51610253848184684 0.88288228574821181 0.24261572170162354 -0.35873817852739232 -0.066761598090275293;0.26735125466437426 -0.41864987381326163 -0.046697302358259495 0.87255616170093242 -0.11286059106409665 0.092874531120343898 0.031142958672136605 -0.17047763543640487 0.12307752542844116 0.25061099263193753 0.14144484530977477 -0.14755363555209852 -0.24355070270044532;0.20760252115177771 0.93059050454539727 0.52486129968195305 -0.32987488541519427 -0.1823663105485544 0.20557239993119047 -0.084866260008482644 0.45002554290536262 -0.37708597635008728 1.2353726033629098 -0.042274123061980889 -0.35861134923106941 1.0620612882704956;0.14865885943632826 2.688061379252487 -0.16468086371873891 0.27682884524111201 0.28192993927150972 -0.24842663118510472 -0.23139378789090762 -0.78981179749281016 -0.03186098620696215 1.6891808935585053 -0.29302289103944162 -0.16673738369948046 -0.12028612956223561;-0.750732650397824 1.1506705558535557 -1.2198400365522202 1.0656238518298375 -0.17975389101137776 0.032489228285876248 -0.011693294037756922 0.078367738489084432 -0.87384725669836449 1.1726971321199062 -0.29914661294521033 -0.36427169181340818 0.94271300554786952;1.1047329116705928 -8.4473037765710348 -4.470175116207753 4.9425390749408882 3.413668448502285 0.14258320380808789 -1.36020543894003 1.282708645985561 -0.7661180136951441 1.8975668861047368 -1.9588644254578071 0.42014671190162911 -3.2147034581639917;2.4329260108821229 -0.10290100451187094 0.58910160485735763 0.58455454284877995 0.042404440958689914 -0.13037250633796987 0.053330934210799014 0.05236521761951158 -0.26241972719166345 -0.1343078274284655 -0.20236099385884787 0.051262858764101145 0.49036413888312763;0.67230897900762487 3.4762327118397933 -0.36295330280529564 -0.51123932251531679 0.132317019681741 -0.27737637858885245 0.22630745661821441 -0.35370098309736775 0.71137280734440733 -0.93847776949222861 0.88326826969207739 0.19011781902159361 -0.60347531128419352;0.35080019378533611 -4.3936350553752437 2.1500342732711304 -0.64038065332826977 -1.2718324079944778 1.1364777509914894 -0.72170933521998459 0.6440923239917552 -0.38924569666398212 -1.9530225121050802 0.13395100772805757 0.32167297784353521 1.0742365563078307];
  
  % Layer 2
  b2 = [-1.747548308797694;1.4647397153737061;-1.0809394269960755;-1.3872522753209542;0.56976912249255118;0.6801613261581485;-0.42337197404134214;0.35485509621633687;-0.48040807626722692;1.311881803817466;0.14337011943339278;0.60839611690466511;-0.99108142853523995];
  LW2_1 = [-0.27014436408030029 -0.12758919617914533 0.0099090396598100847 0.56906649474362592 -0.20150665278991048 -0.19796462037806328 -0.39834380046969498 0.57650682953980403 0.87408637342043649 -0.39320399083200136 0.91447206522572766 -0.84442159015341189 1.1147356340883601;-0.51522652128307045 0.72852310493388506 0.31347869292568609 0.63084688725786464 1.0990219625058348 0.70877660562933253 0.58383116766251086 -0.48379213968064688 -0.56422986798266661 -0.10486405118448322 0.96234808835575514 -0.38819959523152608 0.20134447556971341;-0.17929230566961551 -0.63363935832921892 0.29992383016325236 -0.3947587818182966 -0.87914691695169245 -0.46207597278919327 0.2592267506052392 -0.068055976342417057 0.24283146730105112 -1.2416295399573687 -0.054614821105672728 0.17022652824415563 -0.12283920562490336;-0.88075652272512162 0.95566479202310006 -1.5727048563802206 2.171520353759536 1.1419392191043987 -0.18117400085018365 -3.1061769321108894 0.083983796289854487 2.4221474838587933 -0.2655856992946693 0.20567330984731347 -0.81041936744947229 0.91546434755318817;-0.24342372021174019 -1.1084957029203792 0.35037918205744045 -0.19447381233259126 1.9328055256379362 -2.580862858312174 0.48982254647970613 -0.64012190532421032 -0.24136661607470092 -0.67138558786290181 2.537662353000798 -0.81311667143379995 0.30636425393172828;1.0855291248929293 0.7627946936147243 -0.32868159966500854 0.74670969568169199 0.031096506418349615 -1.2951205167928439 -0.65959169136437734 -0.70582856562308305 0.87264116140515291 0.27192773509792112 -0.2411843052886129 0.65361172598739925 0.14369977877988638;1.0501339975787791 0.74436825569242715 -4.6385711192525969 0.013857811998693152 -0.5447159800029765 -0.4534608059515074 -0.63757460595345739 2.1284149209716015 1.3544757847499873 0.46417535242707875 0.21924962303858125 -2.0201980827343449 -0.016911995009368741;0.15571788811506387 0.79170011060209688 -0.34649646667822809 0.24713635495466899 0.35680095056680677 0.40988861494690026 -0.22628360586336013 0.275598281871821 0.03131568563401696 0.45623530706058635 -0.10495543718383143 -0.33113270992639282 0.25454173675403058;-0.93829453659986262 0.41863748033780201 1.3590693393232318 -0.069373377489061236 -0.14541595561612181 1.3636279321147522 0.67262591838986996 -0.94236622776648027 -0.49900302325757584 0.78814232662972017 0.72379788129395028 1.2109028316976844 0.047967609897035857;0.14101489134860851 0.081555062133529282 3.5901775867323447 -0.43832920493621236 -0.47769398254692574 0.28282960998369033 -0.13230795636840822 -3.9941972785508009 -0.041348709620002734 -0.82837831588494981 -0.72388920228639075 0.34786049610748693 0.16119039529126483;0.42463502266288383 0.34146369492253442 0.22544246627275544 -0.789411630464251 0.29225295805988299 -0.63741273975095858 -0.44909789836327235 -1.2855790129920563 0.016893957676201977 1.0728120447256204 -1.259844590290182 -1.7639621499313625 -0.045173861483972483;-0.2400481833953764 2.0911424067833044 -0.41763971806411809 0.14995980292070171 -0.37505046778858114 0.98814783940294726 -0.59881403002345412 1.0411287917423491 0.55500115624005464 -0.35008438226192051 -0.52178760897079779 -1.1147268190023012 1.0905354214584631;2.5970781883509875 -0.5016517791468309 -0.81392887693454796 1.0545967141165347 2.3263376482999938 -4.058748115457246 -3.3947136981423012 -1.0331206808715561 2.4049417221656002 -0.2915373484694434 1.5015855279676691 -0.60084174383549127 0.93968415178389642];
  
  % Layer 3
  b3 = -0.17937753348720584;
  LW3_2 = [1.1127887225768121 -1.5347266077664097 0.92533317034144957 -0.46643314631337029 0.38483728122819999 -0.18801744262068654 0.46896799692506208 2.3339982897381013 0.61259305479813608 1.8888866271529441 -0.80405543640438815 -0.46088936252334284 0.92455961520989882];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
