function [Y,Xf,Af] = PM10Atemajac12(X,~,~)
%PM10ATEMAJAC12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:57.
% 
% [Y] = PM10Atemajac12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00968992248062015;166.666666666667;0.0561797752808989;0.00614628149969269];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.0706877607783072;0.88655738990427746;3.3774869171801769;-3.1831398171950953;0.81632025784191264;1.2833780437300504;0.26649413319248516;0.52662818068669415;0.15236878433387618;1.1315008218801128;-2.5650993755510827;0.026820418159999707;1.1120882310005584;0.65647458434657602];
IW1_1 = [0.38261683707180405 -0.096872447575490711 1.4297191551461743 -1.9112473796581402 -1.3376332632453078 -0.42078945972436166;-1.2845322083359896 -0.048645683255705056 -0.86532803177002326 0.0090720882191460753 0.96171208924012741 -0.073558072471995001;0.93431572748520009 0.98731519490142428 -0.55323340981574021 1.842335339470428 2.2739132516827243 -0.21040784867994386;1.000322557256782 0.025920030213203285 -3.57982612644222 0.32159472588842791 -0.87032461458487942 0.05923663363740439;0.010241802437451208 0.28886451581655176 1.6164129059280152 -0.11548620930079349 0.23920066931387293 0.069733595406357887;1.5530664932625076 0.056617513709512235 -0.15086704622766481 0.90961464796220626 -0.7414175064686217 0.083175770415983702;0.19692577633805386 -2.038047094714853 -0.18814745160924198 -1.379488439147829 2.9829922988606632 -0.36366030224302132;0.63900612427322101 -0.0020021600266290004 0.16233570272687547 -1.7922418978997525 -0.52328407524351639 -0.50313512443397901;1.2241579781542908 -0.12979689176608575 -0.75898206964917669 2.4772297750549601 3.4360865239285738 -0.40356237995588501;-0.89290101528535415 -1.2604364753763302 0.29489278238537786 0.89731176327214579 -2.6466747778714939 0.66100658804566292;-0.017951141230995546 2.8152119828113999 2.6454737981524779 3.675406672750591 -1.4632033399327027 0.31696071496965733;-0.37002165894879979 -3.119075997706934 -0.42523653913641324 0.52780395662181145 -0.71386461385420974 0.22876422661362442;2.5093825065912214 0.92575772272664747 -2.2681694856406476 -0.072932581285894582 -1.8222987923174709 -0.086003612877684321;-0.53684563216082892 0.10489424007391981 -1.3497283326164611 1.2331164817739138 1.2222442493814816 0.45749356226762938];

% Layer 2
b2 = [-1.0266513413176497;-2.5609717416538045;-4.0144077871911996;-1.4450803370111935;-0.42627162793465034;0.9647168745282001;-3.6793110973181027;3.6841281621710911;1.6361762518646763;-2.1872161748652994;2.8574653721517964;0.91164624170803144;2.8297209673728716;-3.7375910453607206];
LW2_1 = [-0.0051272952644193029 -2.5508786944979054 -0.05884876481963329 -0.35943417708467201 -0.83720032854087134 1.1195709078457547 0.50026852161371371 0.0089780184149964685 2.4864913602711827 -1.370322499274671 0.5969067694839143 1.8497679806455798 -1.3770863197327794 -1.563240411383668;1.3898270664595016 0.54152270150673154 -0.31640493323530894 -3.5734987848848965 2.1476350059701059 -1.1444009892012053 0.80986700100971232 -1.4976651931092104 1.0440826075594984 2.5157322461378002 2.7491463942897298 -2.1554156883303066 3.6649643062064778 -1.2989293332587297;-0.067760800383675185 -1.023462260122592 0.417459983471685 -1.3077317992622455 0.79365271779097091 1.5199567662528031 -1.505359911585586 2.0530392117101472 0.64429217423944807 0.063522676570605063 -3.2479250588389976 0.6585363570918682 1.6895608622356271 -0.63189671388532664;-0.66877032323875507 2.452908412472611 1.8079245607148993 3.0178674621992898 -0.76961305466665542 -2.3459280830270286 -1.0408927930710425 -1.8531464437155025 -0.099077382226890762 -1.0609910761954595 -0.6759222237927015 0.98060383345087276 -0.80076121269290712 -1.0075728848734167;-0.15576238599813713 -1.9313843024280919 -1.264836237857194 -1.1486563380945847 -2.964027404221385 -0.30080275821986979 0.8163764559550758 1.1530691606602139 -0.10437808088837822 1.0761780818857698 -0.9489830169304253 -1.3729567082366285 -0.2956208283590554 0.49177542597308549;-2.3011376978377291 2.329958036874892 -1.4025555882148713 -1.108204465818337 0.40748572608758599 1.4986114242686059 -2.2088676105668816 2.6218954079874921 0.55787057102060789 -0.10611784519702738 -0.98971209101638125 1.4717024443843334 -4.8509308987302644 -1.8748482801347139;-0.11954967454123046 2.1507697828113304 -2.118655270419787 -0.44111050871836377 1.3934259244680092 0.23035411724649857 1.4644072173660119 0.052558235643813733 -0.024531552643207097 1.0346389377565639 -1.8654011891772013 -1.0156640913543975 1.2582393636782665 0.32342344747816881;-3.6388874536469547 1.3216945306875787 -3.7588402424742133 0.21509839659994698 0.15330118478189325 -1.3684695295002891 1.1576278113432024 -1.8092288089855446 -0.72260261186752972 -0.35608604271501665 1.2126501312437288 -0.2238761733789284 0.63526369977208563 -3.966305583365505;0.30153997352262457 4.0895272186821972 0.097761706910037258 0.62000790254087501 0.23877499640775679 1.5854492689216737 -2.1464320877544862 1.4278469175926571 0.91354272072178988 -1.2653588666925484 -0.59753540938223426 -1.0845369593470122 -0.0073670860451082358 -0.13287716738665231;1.5148881171112525 -3.1623303699684109 1.5284266745026318 0.22910280661622051 -0.61832941745525971 1.3097410319887808 0.72205379594958752 -0.53121968120824437 3.3611556832843696 -1.5779295527110357 0.62455160643571173 1.5112794391239781 -0.92475935335268455 -0.63313784476994717;1.127843715262395 -0.94718571646659888 0.77180134634077513 1.1100595450947079 -0.53525537204929319 -0.83252996866143913 -2.1216233122475701 0.84763166360025999 0.33447323278696478 -1.1911585631081423 1.1072682565898546 1.4358592497857372 -0.29661333099865672 0.46233579336560987;2.1093738445593875 2.4176094285227978 0.3636439299299784 0.54147844958983049 -1.3089044132926591 1.7446099274937663 0.25820779896065621 -0.074383463536255939 -0.48304966954814449 -1.8997088134256608 0.52918451548831147 0.60890248789538726 0.99502473766092858 -1.499620370761849;-0.48838962916229356 -0.24203902857266155 -0.2291333664564898 3.1181202747902947 1.7455303753942271 0.63732378999993178 2.0856525305934084 1.1624366139386706 4.0327697545708361 1.2062301994992637 0.86796985194419596 -1.1943063708675219 0.85404650330891041 2.129125238463994;1.8728909182608007 -2.6302293724697945 -0.98286054960871072 -0.21535710248132722 0.91676833306029026 -0.24312251641264115 1.1310137457269438 -2.102902889401844 1.5524625924431674 2.6573337132774637 -0.10769228234688037 1.8360065702431683 0.9242642028942698 0.022391117330453673];

% Layer 3
b3 = -1.3431172026164671;
LW3_2 = [-0.68325264206080849 -0.14393948469426021 0.3154910333249607 -0.23896246514807995 -0.14963093450474471 0.046590130944845348 -0.56216522827901694 0.3532905503936955 0.46873463743059141 0.58031057727834945 -0.48838604855546364 -0.1081328037388312 -0.14383241806507763 0.10324602116893215];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00968992248062015;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
