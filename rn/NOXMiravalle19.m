function [Y,Xf,Af] = NOXMiravalle19(X,~,~)
%NOXMIRAVALLE19 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:29.
% 
% [Y] = NOXMiravalle19(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;2.48447204968944;15.3846153846154;0.0208986415882968;0.056980056980057;0.0063552589768033;0.141843971631206;5.12820512820513;4.16666666666667];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.7656713368411387;1.5252474417919328;1.1831558922917229;1.8879265866618355;2.4601464885922102;-0.12073912083729799;0.17396220362471984;0.63970878925749874;-0.95335844151713345;-0.20173754529996127;1.5725839244309612;1.8846165810975719;-1.0301670741003164;1.8286906596878372;1.7478988155654551];
IW1_1 = [-0.41745968331223537 1.5146710907030234 1.2976108945346003 -1.1214415379741249 0.19010503315332902 0.58423654728721841 -0.016477049695596071 1.1959530614604226 -0.061865353176526368 -0.38485021733851144;-1.2988378420628188 0.42677770326595127 0.55872667919557151 -0.9464987922507464 0.41308639402056024 1.164151657510391 0.95173567476426335 -0.36516179624198436 -0.39378715316959656 -0.097670666653874111;-0.88393295351377388 0.36456466237770518 0.17915007663428262 1.4302116833698524 0.88362671726200293 0.39872040402033038 -0.20374152479946206 -0.097563798234588939 0.044620788632127248 -0.09644502636912694;-2.477438322815027 0.26908806838729155 1.0727816746387335 -0.55119863669511937 0.35151324696412889 0.45033738344609237 0.085222395955341715 -0.15988096663790802 0.43128453165468361 -0.93609075387368901;-3.0971335252863157 0.56017286863785043 -0.83305906735584578 -0.55431519863020207 0.33423508234090199 0.15863566096410811 0.20120550574194554 -0.085626490410478429 0.0097714618299390987 0.11810896135296486;-0.48005320474931878 -1.5629031498454153 0.059868637364618317 -0.46657477232599986 -0.55180164941207532 -0.15585631826702467 0.028298088412598683 -0.24233486540525359 0.36449945232481595 -0.51695187292946931;0.12662101803024478 0.2041974014737194 0.12557632361705226 -1.1434980042067677 1.0201851528678738 0.838107333126906 -0.75059413579559064 -0.58632985076421951 -0.49942208057239945 0.25423475213767427;-0.31592868887909437 0.3981295076432701 -0.78629738888533274 -0.91285583175870166 0.3987833017239143 -0.76996178979560748 0.2773906475381388 -1.3348508931565508 -0.71543875773539556 -0.88784568113756723;0.035229809998137747 0.24216227913315955 -0.0064523575715529254 -0.46949021566858001 -0.97961969913983404 -1.6072644725192584 -0.7296980094913067 -0.12937280564745635 -0.23680108930905777 0.42054053862209245;-0.16255160486677922 -1.9252206588371146 -1.0767325879641905 0.89053559167121044 1.4496468917902594 0.85177473701095396 0.5526848617929554 -0.066950640057169858 -0.35013045069377341 0.013707003024235553;0.92583203600459874 0.62478808170116196 0.34420704452243245 -0.66467588902407426 0.22012249137395085 1.1693069212795664 -0.032794294978578734 0.25331159790594188 -0.014625301184507319 0.035816553942939873;0.18820096432089731 -3.8459289728991286 -0.35053739732007733 -0.1920909258860691 -0.020230068359773007 -0.025743384529154173 0.059213742121867606 0.13051094715756498 0.58816085038120358 0.75179159030742471;-0.32697669267078583 -0.98638176540347167 0.38881020930228488 1.3300161144776448 0.27049146752327169 -0.13004880837939914 -0.20111520096675062 0.61870273857346259 -0.51043225348947685 0.018401545115799795;-0.29095773539714648 0.043765521039086076 -0.86424808802414743 0.32801495508960382 -1.1812477943112627 -0.61167030596056071 0.054240104723284617 -0.52628812361395716 -0.47125361706740243 -0.17720880748234943;0.8475822104257269 -0.068955625309566282 0.76442483180219734 0.62946114073497428 -0.3449865304717521 -0.63885529599649094 0.15010947091172167 0.3747678183178843 0.27348546697037895 -0.2332275818329943];

% Layer 2
b2 = [-1.7754442890413584;-1.2323422649872897;1.2167482496519941;0.54450531036189453;0.83328492329714399;0.4623117935152784;-0.52608282339292289;-0.34907897631772961;0.50242612980059032;-0.22121841369776246;0.78736616365753487;-1.0756222525851533;1.3255224102386252;-1.5062996153749779;-1.6644770102283386];
LW2_1 = [0.69462697340753832 0.46064494941069156 -0.46944741882211738 0.69678987536516768 -1.2648724577017252 -0.47819513716689876 0.80281110861129157 0.0065460309255171937 0.10868108743509758 0.7359423835224207 0.6412415837360913 0.46775288516468538 -0.33195694141513837 -0.39835565043575832 0.21673820137989058;0.30926892247906829 -0.11009960576386753 -0.77657502216877017 0.11169943832868739 -0.53865602394749235 -0.84081589134350498 0.84168264487091948 0.89234048212271344 0.23215833962752555 0.51384924607545346 -0.026080093129921988 0.2477419288565037 0.66366751678298597 -0.13534613831715761 -0.29098439464476472;-0.037940300707643211 -0.40463647313153911 -0.76090236372316422 0.42069169141192336 0.76972096024346381 0.33552921992589751 0.087497183773474305 0.1886576152322913 -0.39967880104714765 -0.19366044037079155 0.50373491121264613 0.17521155457692111 -0.7541515866741002 0.35023276286077637 -0.16608628671891698;-1.0941666894870736 0.17719072018911325 -0.60328105841224999 0.40280197509445842 -0.87125663431198275 -0.90870263467736256 1.0466845344735971 -0.34099416624615414 0.30364658833724012 0.54313244705946673 1.2364559301867919 0.54873669497143107 0.64632494593259482 -0.40189307635905536 0.0039523306009703694;-1.3243095178168403 0.051213875951284175 0.10001799256078839 -0.056601891832202489 -0.32637496364537621 -0.3029419260101302 -0.04799627267657762 -0.39725960058757931 -0.5171193606493204 0.73267056155273069 -0.30369176335719927 0.14347239996746203 0.72800334781702525 0.34723917487645067 -0.20166559652279026;-0.48323385803560137 0.63104743751690728 -0.3212885907625751 -0.083029524507432423 -0.56115357081522599 -0.12351354848939389 0.35466119072797575 -0.13509902118270664 0.015844426948840588 0.219735447819362 -0.00039021190192494414 0.88508241475787341 -0.44842794846481121 -0.63136575278087592 -0.6301013590513368;0.6684767480126802 0.88432858711193185 -0.42233911398528096 0.4580224714329349 -0.66687346709276585 -0.15906925602002747 0.51534559106369116 -0.96565460504307465 -0.36654001143895981 0.885286936435565 -0.70637605326733632 -0.074047429590145597 -0.2426560738614604 -0.60845516134450472 0.24993668719643575;0.3433918507758707 -0.051580546820180304 0.72097456088906386 0.52793703997372499 -1.3617517926125966 0.078210307784607233 -0.17718468646369515 -0.3753101769402194 1.6135764527253948 0.96111896585835965 0.46636648819648291 0.16450318583528342 0.87594675485288143 0.19576821476856349 1.050438854170668;0.087368397051412569 0.26884060884809152 -0.10617864171743328 0.83551316511834683 0.48630291012964294 -0.27676298189192211 0.21356846397633708 0.15229033337194248 -0.29015977531006742 -1.682728922730728 0.83001903282902145 0.28924786833240168 0.54080949459920846 0.14361678699470529 0.52379724094849911;0.48216593601097785 -0.95648981214923434 -0.57331508903347528 0.65999082143274845 -0.18615630479257864 -1.7871815324075826 0.27042247450192997 0.82245331260503651 -0.29407014177038149 0.0084024880632903587 -0.015530955065777102 -1.7872107264321766 -0.70785348885072263 0.29811848591515966 -0.20626902677261552;0.036425132438926616 -0.049842915365499431 0.0053714765229238813 1.0360389510734105 1.0482568678755497 -0.65599172455758226 0.23812485401219291 -0.20573060536619756 -0.68062403481172207 0.12439341555350061 0.2767904067975917 -0.42267562028368566 0.60086782204544442 0.52415949641025739 1.3414418216680835;0.11407798154504363 0.79692559260806739 0.77933947133303838 -1.2997875513856665 0.78722645291802607 1.5711850222302575 -0.93425576899933571 -0.1235523435455582 -0.1631619544870383 -0.59694832732561909 -0.50929057999809046 1.8679171042917211 -0.39156127455135131 -0.19967941004105183 -0.148514584338379;0.3535845726926094 0.73855548310054564 0.090446246672018782 0.54469077488523465 -0.61401726241133936 0.12096773215397587 0.43577887149574984 0.34071296048804045 -0.71987681343655341 0.51829117101926991 -0.41250872426322499 0.26760038479849807 -0.59058020460901006 -0.33470672247216371 0.19458127722839574;-0.5853192101418615 -0.48841240882998438 0.044666956043676154 0.44138447661055075 -0.33633662447344742 -0.26134376427668782 0.36798528224017313 -0.23555852695233523 -0.63137137471272287 -0.070575521000065977 -0.64909154317912665 0.34452703738664808 0.65681981393847144 -0.18498006516955365 -0.48864670960682427;-0.27765183047470265 -0.74792288345646263 -0.32120460815635982 -0.22229713584592192 -0.15445645389661311 -0.065483560281525785 0.14187138525078069 -0.46915623905347076 0.63976882434584725 -0.98129410166408693 -0.00032670890320517232 0.50419804613970831 0.1429739948617515 0.2883245076657896 0.7548329044546781];

% Layer 3
b3 = 0.45997705492308677;
LW3_2 = [-1.1559588136871974 -1.0612696317361952 -0.75529177306838724 1.2550825313365275 -1.200940837458164 0.29358735115154155 0.89928303322786474 1.5066764878025665 -0.95615619189261836 1.3739474132686178 1.3840085740238199 1.3618367534699769 -0.53108287326686687 0.37201670906176049 -0.323919128525678];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
