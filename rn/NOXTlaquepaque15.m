function [Y,Xf,Af] = NOXTlaquepaque15(X,~,~)
%NOXTLAQUEPAQUE15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:16:23.
% 
% [Y] = NOXTlaquepaque15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.03490136570561;19.6078431372549;0.0212539851222104;0.0523560209424084;0.00632111251580278;0.294117647058824];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.7594947894431561;-1.0326867234203432;2.4855168118009643;-2.6473431523354511;0.90280712840023403;-1.0082612725458606;1.2637219297791744;-0.80409966670672128;1.1554731492514989;-1.7326843265715506;1.5788485828527521;-0.6318659742853715;1.4341583499606232;2.7757450496601881;3.7307085261284874];
IW1_1 = [-1.0613882085601924 0.3991279083239308 -1.3209528538255304 0.77602768094690822 0.4591257288315912 -0.8167272982576057 0.46745507411148296 -0.54521834389729051;0.75420281314843274 -1.763772839230255 -0.54079023644760238 -0.17338216638987694 0.16236210748611457 0.80222065691490574 0.22580787108587752 -0.026161296288861765;-0.93229037366550194 -5.5312736114827601 -0.84235050983288828 0.032282962888327084 0.28311872381523723 0.071911719888997944 0.32418464560751326 0.41272481912288456;1.8169893853965042 -0.054480896601403574 -0.87852420163594724 2.015386756830138 -3.0919430814721474 0.16038358923794127 0.10975214258793091 -0.062214282075944718;-0.0092583318402235815 -3.4080621801284785 -1.8453124175916462 0.94254791980659158 -0.24470679404965659 -0.990940945555011 -0.25426109142854941 0.18992146844426119;-0.22636791123167288 -0.76439468645014252 2.2795104171482641 0.24550500465287176 -2.2877816112037994 -2.8666115332882565 0.02344827761866055 0.19920899859488525;-0.66558813087746427 0.29969632961293924 -0.60485468026901779 0.2503103895623045 0.62539062490978381 0.82586730564102828 0.15843350050086222 -0.080241874299108645;-0.82349273444123616 -3.1880012322033759 0.059612564665706774 -1.0549876311482103 -0.71353086484070705 0.16915283286328933 -1.2442547766264678 0.22892506118829845;2.7020619593879052 -0.56503643025257155 0.85613580843523762 1.5207594328659029 -1.597632968565432 2.4127431051312471 -0.88589012457140637 0.76730629519466731;-1.0459727056539239 -0.38282830205531831 0.41621527803411712 -1.0567593163348803 -1.9575001636621481 -2.2395567187201286 -1.0720718453832361 1.225400253902444;0.70932584872365279 2.0777756788179063 -0.27831855531662858 -0.58829071535306787 0.35818272503539228 -1.8191127776466371 0.027054491659885077 0.7461251759166424;1.4204534226994658 -1.3059132097898687 -0.24513218256314528 -0.5969150534856239 0.89326206394516761 1.5096185270154556 -0.33174368908214152 -0.82198318747159926;0.72851592694289091 2.553341310594107 0.11079319307563693 -0.64358498915874907 -0.48664963907931436 -0.3881050080992563 -0.47787224893702335 0.76268099678546319;0.018609565322405725 -1.4883901898241112 0.2950319152466212 -0.78744359983188994 -0.0074296582338324712 -0.79209328371688226 -1.5924287318619739 -0.055729717169215827;1.4035717336109146 -1.7260339234407389 0.70466016009875643 -0.91779240949188023 1.6429515733358837 -0.86014528332090257 0.1838811117796674 0.27752146281406193];

% Layer 2
b2 = [1.9280616820542928;1.8755956384031427;1.2632191070214731;-0.15593504695166571;-0.78267744577266196;0.42065400593935087;0.99042809108391239;-0.063627818534702882;1.2613352933052995;1.2819485402934248;0.36852883238342282;1.7983635179151143;-2.1828854951561647;-1.3358387743425724;2.0991359775343983];
LW2_1 = [0.095941558122400628 -0.25087139081560383 -0.01954422219115939 -0.63204304930449995 0.5866295785318465 -0.48008859299165418 0.41808285886155694 -0.48554122153250406 -0.14425977871822748 0.13437586489384962 0.3186986804839298 0.23066676426712918 -0.5179442262826307 0.75325307823678744 -0.5023859296245119;-0.057960033070380841 -0.54724837082254907 -0.72438107272623498 0.43670776275678175 0.22729275856569267 0.3750297076318434 2.1161732747771573 -0.17215899902109205 0.36809975939231898 -0.28413568340157463 -1.1548721006493794 -0.13914621154251586 0.3941098148877577 -0.065771274803720275 -0.59145766808078892;-0.61265580372276895 -0.58329386863392219 0.063199230129695305 0.74147142897936225 0.53169594382498497 -0.49065586021211616 -0.2217072357398516 -0.53229270857448296 -0.38550621031697052 -0.58405751501324477 -0.84264367215876324 -0.84171385254599285 -0.068896235069400388 -0.34716464550718457 -0.26580809980555908;0.40134903506223379 0.39625955067181667 1.1106350737186514 -0.25094567020833652 -0.63835219189544345 -0.35313915753141617 -1.6302016338475611 0.21039127160335636 -0.21698935834533317 0.30461517381764447 0.92929935996960178 -0.22185156515039084 -0.4236401545098335 -0.6521144577535104 -0.79152062469224116;0.53631078435806878 1.2529588904720683 -0.23677962151918225 0.021361718735454595 0.31448570680133864 0.45560732904534895 -0.097674353688060683 0.6551624958314114 0.72756919208482318 -0.78633830662661486 0.39801362684944935 -0.77901470237033443 0.17850709767522144 -0.34527683135627152 0.47219817509637313;-0.72483538164371319 -0.65425079297604383 -1.2106838917639824 -0.32769915389613258 -0.83773621204846815 -0.2148338700565364 -0.099290376557855789 -0.61904824393140545 -0.24518823456208624 0.70649955052721958 -1.3399385588908053 -0.20672092341028969 0.57091165323225102 -0.60110210632948047 -0.1618477200296588;0.57893168621928148 -0.008323079149947574 1.1882627717694578 -1.2288677376529573 -0.19911188264177609 -0.85910053873957626 1.2335377606138067 0.018271465058542512 -1.4435073215849299 -0.10398766332875037 -1.5496629966738593 -1.0515987405547988 -0.20511909267303902 0.10654019415057911 1.5016377966200243;-1.4402583253173085 -0.75580409044172825 0.91937752984179821 0.34800845961018845 0.95072747292462467 -0.21929644688805022 2.2248560764344987 -0.61814786125383647 0.41659904985477453 0.18376257922954611 -0.76485710560358811 0.29898392152100878 -0.72681063643382182 0.39637338561432872 0.39626478934527859;0.64509748111890697 -0.48489241484745671 -2.4092452578301922 -0.19911998469447986 1.5150378882611526 0.78359597200071784 1.0767440575530141 -0.10107864215556653 -0.45885408357493923 -0.1194252889888006 -2.1919559555436496 0.30426195483855195 1.1431529877384063 0.31565949132001486 2.2477404425041767;1.3177443494685017 0.71717393050374423 -0.28981724373552659 -0.2624430438998348 0.94376263670710991 0.4772718966231469 -0.39470648536388181 -1.5476030375519318 0.22275264117264101 -1.1284435046610073 -2.1077169573666845 -0.22011226055063218 1.5535654860704347 1.1834697911897032 0.6730906890844579;0.72250699160685405 0.062382593489697588 0.12143889107908169 -1.160527537353802 -0.63709703252667471 0.31264484305084528 0.36160604032382276 -0.30885177001562036 0.041870356729019821 0.70838722560152845 -0.29580493214662451 -0.38332414686961852 -0.0018012599030441719 0.34088365375654578 -0.090205144475602628;1.0122397176479627 0.37095390695586544 0.7326145509149411 -1.7345637948083068 0.39365502478240688 -0.36260060193627663 1.4267816147378283 0.092029001543163264 -1.005553520012715 1.3668104479608523 -0.48603029898393468 -0.19560340648324326 -0.087909383344737357 -0.57498720438635609 1.0989699073955479;-1.1926186215465575 0.053872411468171025 1.4112025427198698 -0.2743321361637448 -0.96434522613876228 -0.27692772912555963 1.9493508017626509 0.34729390869749083 -0.26694794608795985 0.11221848422340415 0.90574444214801708 -0.77030182576872197 -0.52636759223303076 -0.45179470437127772 -0.97062647630880083;-1.1931734824978577 1.4008389546537101 -0.053544241446074073 -0.72470371588423477 0.24499981347990857 0.69869127022442612 1.9099565156031031 0.54852310772533741 0.74595539692982527 -0.65141007961753838 0.24509035113037728 -0.84846794135054115 0.28926687348229541 -0.26064781490873218 0.37321512730920287;0.5620475216115306 1.5608126866892771 1.6787082287575674 0.22017326111644708 -0.68336550755599479 -0.46503860886789145 0.30535929824074398 0.25610331692797905 -0.45283964750937605 0.62606559874052647 1.5383369318900864 0.51761911459446774 0.23876092879720431 0.4798450722492506 0.0031705834163244483];

% Layer 3
b3 = 0.73767241517746185;
LW3_2 = [0.23363302962729221 -0.86785253141375085 -0.02764346977255433 -2.3351569719144458 1.0925842905019816 -0.40800032895030658 0.77412294993469222 -0.36386835864065947 -2.4373131735702023 -1.152968724156755 0.63001011877517843 -1.7490565053328457 0.79046187915052168 -0.99201487824267387 1.5503960988353596];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
