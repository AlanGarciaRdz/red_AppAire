function [Y,Xf,Af] = SOXAguilas12(X,~,~)
%SOXAGUILAS12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:19.
% 
% [Y] = SOXAguilas12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.68287908809355891;-2.039099488251205;1.2875754872882537;0.55883489599717673;3.1308810567315737;2.0158526339861891;-1.1813922389473246;0.22930388380038169;-5.1288648258886722;-1.3856338251259914;-2.661354660449792;-2.6059145285487499;3.1654438361960779];
IW1_1 = [0.45822633613193553 -0.087777656859540212 0.07278101269743012 -0.043412826862137092 0.21457040443197903 -0.13491730086954837 0.056705150678242208 -0.11896163116635231 -0.022073629238928361 -0.0037272913892820872 0.052469769601151864 0.026183705491017683 0.11352320603546381;1.2070806788290691 0.83603710309306689 -2.0680345881980844 -0.34915371728131017 0.86971474272171823 4.1661964055616858 1.7595457465898925 0.48752979044386791 1.8259492912329318 0.75271817717547818 0.065054184660307948 0.64943531309029157 -4.2574454961579233;5.9777723341087414 0.29966998704021869 0.67754591427836797 0.43065436486996367 1.7433122462377619 -0.17981507608801514 -0.48230478436160157 -0.18664197374430416 -2.2422263322104965 -0.11709858231258111 -0.23438406980115939 0.97301301064374857 0.13535409317038971;-0.25712046078142436 -0.219204174540857 -0.20717961754046124 1.5160692726353677 2.1947498123732743 -3.2230618922909429 -2.328256922462443 3.6026573216459079 -4.1506157954642218 -2.6331536482954121 0.59332264411244895 -1.8381922854333368 1.0459280626224494;0.77818499190749224 0.73886985122789883 -2.3292489787278496 -0.0021649142704991409 0.50260387579325194 3.5100972428055455 0.027493439618835009 0.33634489772037646 -0.98222758748776762 0.49165045677125441 0.51584415070345202 -2.2275125322546709 2.3555820142547623;2.3905735256952707 1.2980070655204368 0.76395700859900539 -3.8892316481729226 -0.69311306971350628 1.1497018292298933 -0.3888256421694864 -1.5818480428182446 3.2164305595399365 0.14883845391576445 1.6347601752536813 -1.3863729024963765 -0.15306961427987806;0.25429130405766859 0.17858054821350472 -0.30088437922033678 0.15772325418225203 0.36759619865545812 -0.41968020104275683 0.38178563463039789 -1.0795074652662526 0.37104419552240042 -0.017718349624480573 0.045738544334785788 -0.25786275821487575 0.38342567883704354;-0.68597446653476701 3.0550301779189506 -0.30323149551626355 0.82474548494738276 -0.48915795429957826 -1.1605373139865847 1.8108645202088405 -0.90348875294778908 4.3749197859125761 0.022722164126855716 -0.39183992475695251 -0.83553200595425225 0.0041015434334883832;-0.22367249103879694 -0.10564870664489112 0.17246713216129572 -0.092880549352404959 -0.29481727844835964 0.33915717629993936 -0.29090153311610262 -5.5401358293157426 -0.2749492619012191 0.012963557747311534 -0.038620809305104191 0.18043549086469521 -0.27669660150449005;-0.22052385223620605 1.5923571978299669 -0.11314054144435651 0.95370142154857074 1.3806442192060719 -2.3587381985658751 0.52541746204223116 1.3591472878587632 0.46676773840656227 -0.38139694922205331 0.31946246852185245 1.629070401064947 -1.4483444866000339;-1.773777600967217 -0.50352813167875188 -0.087044555665863318 2.5210391781350143 -0.048284911784349446 -0.72008765530845875 0.22473910739142966 1.509324835570512 -2.262528883739269 0.36260225619243386 -0.73859480473374794 0.25131239880824774 -0.22080118513896768;-1.5551847513447494 -0.060213755399663844 -0.60493077412467178 0.26837339461765003 0.43366586665296453 -0.46140213776713374 -0.11566638825602557 1.2634524783350112 -0.18047011976621502 0.70788996325944753 0.22721379592749821 -1.0872285456060999 0.004340644242733907;1.8481059970460476 4.6156682589849334 -0.15920654992404407 2.0572071165226919 2.9084022023098806 -0.058690895198734806 0.42409587359202111 -0.44533587954927389 -3.4149353083818124 -0.053954133616725061 -0.4807902594987517 0.58283066947380924 -0.34218285940138543];

% Layer 2
b2 = [1.7012237249901816;-2.5717299994290328;-2.0302140633615751;1.030382080214876;-2.7570800965512401;-0.66195946916147863;-0.7040308515206215;-0.08456285221783344;-0.20956962974091969;1.1651836298472664;1.5621126082532988;1.7063802536607642;-2.0594141304285261];
LW2_1 = [-0.25448371804243347 -0.019158366083779625 0.064312270578586281 -0.040138007590202918 -0.070039557733487884 -1.1820231786579574 1.0839541376800002 -0.21097870944097413 0.063225220860275405 0.57879506622912635 -0.27446813222206501 -0.089352439129635489 0.19774577575156976;-0.13082653825523299 -1.3482154629690117 0.29482930800309426 0.42479078134263082 -0.56472725002613222 -0.20714705225645991 0.9228180460827875 1.045648913297432 -0.71714765567775085 -0.083727662922523066 0.18450597086125145 0.88625413630901329 0.18915651785002358;0.58212467216611208 0.86900613260390591 -0.0764875605586601 0.41890999418243269 -0.16185306633912655 -2.1324023268231915 -0.94402040477057825 1.1538798977521936 -0.89081893974288251 1.2551983048587678 -0.3923192715754536 0.86144201989345315 -2.6278518851577912;-1.4667083714374252 -0.063412561530154621 0.51981803898727452 -0.96885973763348388 0.4278684318069651 0.12483933998928118 -1.16448336590475 -1.7507328183488999 1.17637130038284 1.021598628994276 -0.41503063693900499 -0.18802446227630951 -0.1063236888070546;-0.56264629553519863 -0.036360229756391825 2.140384803581644 1.2224009766187611 3.2660548915318861 0.13240184518406883 -1.7885655839195069 3.4409314995824367 -0.45372424388335625 2.1411841975705976 2.1793712341861222 3.7445918079375469 -2.9010672862093725;0.75982889646107588 -0.028694524861426221 -0.024255154630722892 -0.19033165510861566 0.0006928907123544218 -1.2796335755886472 3.9890637472033408 -0.18698142564025555 5.7364223627183391 0.26720679162457123 0.87277204279587406 -0.056324391536880715 0.072042268429169415;0.71929702831009767 7.4976761162994396 -0.38703574392909995 1.2726208043357043 -6.6692484202720062 0.73069615362219043 2.755824718997439 -0.54132862314357222 0.74361355055203215 4.4778997187302894 0.15832672924432861 1.0598557241035824 -1.9469221824363345;0.69589762343719563 -0.10506640727974757 0.11587583206287581 0.29828622853473979 -0.25680604061470774 1.0906814950816965 -0.078600157042664279 -0.045242608170212292 -1.6008759876287255 1.0983722654951709 -0.79105643494595812 1.1794674816335609 -0.01925711721149425;0.079853582853073549 -0.19396067016573787 0.22805616721222208 0.082886769538499105 -0.21626963980566288 -0.43249673736322369 0.10097050746999556 -0.1237971424383589 -1.4879699622133984 1.1098175547941633 -1.8416278079374175 1.1198193325990451 0.027816155197253084;-1.7515423905318761 -0.33926630886335168 0.45838893639913797 -0.21060062611942004 -0.071031827333219166 -1.5557413732262424 0.45566548955023678 -0.3704046849647239 -1.3660898672953852 0.99025581694718789 0.28628039670243272 0.54085299184862168 0.094301845522199904;0.30080947660204693 0.021652801219883208 -0.1477842915517936 -0.58313176240354525 0.030390809382602545 -0.60551894399485651 -0.6503103567414219 0.20943618271007913 0.45115847095175954 -0.29790022108581349 -0.082556982291920822 -0.058003320901667946 -0.26125027848635007;0.21098460171892419 -1.0103832579178642 0.18091344775579923 0.76295828743039407 0.54214105555477943 2.6287213431075518 -0.99376400900485751 0.59904526407496028 1.3374567987602435 -2.0047996029571498 1.1550091487945855 -0.24773870070556875 2.4902842031327821;0.78372008990088282 0.42181753838854907 0.50258650317612752 1.2295458579302918 1.3434170078662038 0.25352748527783159 0.098278503778907927 0.10562727156617122 -1.9784981713822021 2.4186598029181963 -0.16605208184079889 0.55509213884219633 -2.089048303129962];

% Layer 3
b3 = 0.011546974486414199;
LW3_2 = [0.10322590555987665 0.45896535788701515 1.6955561567294801 0.10662676593367885 1.3205414739547809 -0.84648186955229521 1.0144726829742876 1.8303847067121815 -2.6133453785350302 0.779387513932983 0.31812103334375069 1.1751866661849986 -1.1005854260714072];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
