function [Y,Xf,Af] = NOXOblatos7(X,~,~)
%NOXOBLATOS7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:31.
% 
% [Y] = NOXOblatos7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;-10;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;4.05679513184584;0.195790504160548;0.00618238021638331;117.647058823529;0.141843971631206];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.7751131314954827;-2.5039502981810036;2.4392990673173731;-1.0553523276616152;0.96156954929441785;2.4139458966086678;-0.91249950724156714;0.94728138694085096;-2.743375450409296;-0.39053385349175718;0.42755839019196429;-1.1026410574508194;-2.1797766529682665;3.8804970495059101;-2.2352806138224999];
IW1_1 = [0.16904735779517047 -3.1489021456537389 -0.57331036669035706 -0.93854561625176613 0.58402639152521341 -0.39093659857107305 -0.23221096536431826 0.097668719704325446;1.3814753390438634 1.226721853906426 0.83661282508905399 1.9023619450533102 -0.78142337895565395 -0.7178609457326296 0.1588341195264239 -2.060161059222438;-2.9341287796662883 -0.01225571197538268 0.53784654102271523 -0.2468138585159701 -1.2618805252072813 -1.2888314479278284 -0.16081713536279163 -0.71278147934582725;1.7357940386073574 0.013352714575843801 0.015113765086014305 0.31565526938428501 -2.029509834575467 -2.0023949690947527 -0.014883034250802351 -0.93866807010737086;-0.25396327169578409 1.3413446689792823 -0.036448225163155587 0.37377164976983113 -0.79600228700550035 -0.87488310104704559 0.30029330340630778 0.40227464947541791;-0.58440125401218745 1.4020458247795193 0.78563442457003974 -1.8246344130073742 0.78999102162645385 -0.86816734240725491 3.285783186201543 -0.1394353519687036;-0.30037950318404244 1.8367030694080448 0.064395687340715768 1.0522738406019305 1.9435487633913022 0.5320561716455563 -0.18455129193709854 -0.80105076288333077;0.40974407434227966 -1.2403024714733701 -0.40099373468771621 2.5633821566987036 -1.8446292548820835 -0.27442310435537071 -0.83729681904101916 -1.9107707414273754;-0.19269150232963234 -2.7810622751429688 -0.97540662226675412 0.15687141799289753 -0.071503326281173979 -0.44404178453957016 0.78303365091510213 0.034022988930925556;-1.056296565867485 -1.4909347159592179 1.0127139815539508 0.71899611998311153 0.56112297244611453 0.78892606828990264 0.3366264343476667 0.19225788271826905;-0.29737210504766226 -0.93339281639858385 0.063052644900991703 -0.8695916340496388 1.6351108736870457 -0.89936052707095804 -0.077523378946106863 1.040341354625764;-1.2177119858507781 -0.80583689053064167 0.38589400989098505 1.0866429798541637 -0.37307886562810549 0.48373639799089718 -0.89890481132003053 -0.21874795916899792;-1.1339675424993589 -1.5361825177892361 1.12267599221193 -1.1656813106926849 0.11722577761115249 -0.27551628695526986 0.18643632453488579 -0.41738148426186161;2.3135781345017743 1.1573451426819572 -0.37009424634740928 2.1847237385460705 2.7797464020093252 1.5530071474147642 0.27648874842356719 0.10908963688123621;1.5423129649334484 0.51426940789175601 4.3156301399494934 -3.0907245597482045 0.69107097686634467 -0.99462077704904317 0.85005494513395297 -1.2567361716682872];

% Layer 2
b2 = [-2.20007430234838;1.7569515282002486;1.7802295303385594;-0.50579192001038764;1.2374250571491709;0.72503372179974424;0.37627115607830031;-0.34175278766168316;0.0083655302266109899;-1.0490504166691497;0.9229757974744639;-1.6860219500176867;0.63347645123861429;1.4169318369211674;2.0809415410531975];
LW2_1 = [0.60540030715277893 0.63359867679526638 0.99884262069894392 0.56567754303055395 0.81980487056778628 -0.18547734376719088 -0.069524138127561003 0.019664628764649243 -0.18545469372423634 0.11073970133419832 -0.17737924612581241 1.0203306887856456 -0.53070652496476667 0.4695448623706841 -0.20174972121477869;-0.41837848683577805 0.34651761203523662 1.8993930996113118 -0.98788221013530664 0.11481600025239189 0.66070323560116417 0.13638357756583172 -0.45106928457600048 -1.1314138236867941 1.0663561267471535 0.56686642817304311 -0.083696847517704037 3.0396775940530696 1.8950244578960533 -0.4395775880940665;-0.063555310636909557 -1.0934434002126796 -3.6736439138727062 2.7223185959796528 0.12391708633188844 0.12625550930558052 0.049102030216795066 -0.36347603676039564 0.42431143177282787 -1.2000991608165044 -0.70222010632540344 0.069407920514859944 3.0442027027505079 -1.3734865891796368 -0.45388937027417597;1.1262989274422779 -0.1533051431574774 -0.81976040124530336 0.75341308738429935 1.6982883696796431 1.1691547143499637 2.2593517096797036 -0.28683531574784132 -0.65571733561894119 -1.514673108189579 0.68119465301753135 0.16691810416832975 0.16426865591475387 0.59346966595227657 -1.0092011504396408;1.2138309802026974 -0.025162422805437873 0.96196342522276201 -0.01110066299979863 -1.4740322194702082 0.0091668476795203416 -0.94355417254199148 0.26546787360356766 0.66851680502601718 -0.74672470767707466 -0.40232144066103148 0.22093342243462799 1.5499602919648625 0.53911313957510054 0.0066155132693986995;-0.38998380833414942 -0.70031285289039302 0.81986413089298416 -0.77087444450580822 0.1150877588700822 -0.25822821517170574 0.936276597713803 0.75887304379113696 -1.1936993634566537 0.16499164936571381 -1.0364994958554565 -2.1576650399633723 -1.5310992849773675 -0.53913652252284106 0.38003262168119362;0.029939511333403002 -0.34415900334688487 -0.21120960270397726 0.18909151607130512 -1.3690560821765045 0.76709156661773781 -0.81897346618216671 0.34360928340606089 -0.21236126422117851 1.1388199762349813 0.63244682185064283 -0.44467762958332724 -0.4571486586211928 -0.80981162426930209 -0.14095922431597196;0.70169468471154406 -0.78681616729172199 0.58381389639109416 -0.10925266117371751 -1.2559248475935942 -0.12570534444682685 -0.68353817656600224 0.27883027655586273 -0.35306209397726929 0.89238214297897378 -0.10523778876215409 -1.2053803591473669 0.25446145274817078 -0.48510774923054123 0.063858679115621125;0.19621319056340716 -0.33263381322464747 -1.9095824570300379 0.66295946357832913 0.64656363109301529 0.31363467013189561 -0.173603524670847 -0.076992990082647678 0.36681640718285818 -0.73216655438953826 0.03584031297445292 0.0036177316224529008 0.5908058138883765 -0.16774725163110998 0.070625044119559388;-0.24833817439473804 -0.65942571601696165 -0.80436706729095642 0.091362487051381086 0.29039631545029326 -0.13123276108565576 0.27974607731027734 -0.58229976790769911 0.51502881826679259 -1.1751634056925411 -0.10047530610535893 -0.15767733334768533 1.136208025252627 0.29770186083691785 0.23098369818308095;0.62863535419811478 -0.32453488127840091 -1.5207966738049232 0.70600535303210832 -0.68326495522227915 0.22667670570407511 -0.41478057279391645 0.55800512254691725 0.22157840894117045 0.6313666945617824 0.42839107921291569 -0.028745597597325957 0.5206907086223781 0.24130671926799668 0.53604644015775038;-0.92107634010967865 0.84856883900382418 1.2514458749312523 -1.3081905350752392 -0.52124047076335911 -1.8811910278117585 -1.4533593378844756 0.53626718215201608 0.86029095215425255 0.26723987224961776 -0.21499015906540306 -1.5749401307660813 -0.10330576109160484 0.48419717065575518 1.0062494327175113;1.2199982434400518 0.52729612717657581 1.4478011807774185 -1.6111819837616541 1.7730353111118762 1.3002862526205305 -1.0049538279617893 -0.14905171547708951 0.093204590337684218 0.18160487510877804 -0.27754614357752305 1.0903434302378292 0.059116016029988588 1.1350819494224924 0.054837270445336192;0.37549759290853352 0.61842464451412227 0.61186093738232661 0.08719815090456258 -0.49801595173936525 -0.023025630559399123 0.42855987180693406 0.30944064132244747 -0.51928510665938543 -0.20971409138906583 0.11569497705556336 -1.259716427524799 -0.71852559221790013 1.8657649690286302 -0.08374846452255634;1.1379346461227993 0.39205968569163008 2.34495414349366 -2.7728690422460649 1.3764106461240495 -0.44830303908046976 -0.90240762480080805 1.0381807045937894 0.10594549535283861 0.44286649994130134 0.034345299801717258 0.35333543986384608 0.85781874975756711 1.0543253873590814 1.1843206521876932];

% Layer 3
b3 = -0.44661956304628797;
LW3_2 = [-0.99604526636948643 -2.1680206220359075 -1.5608886819706425 -1.0467143796999063 2.0023613466847161 0.93720977294311159 0.96364565907055388 -3.2006872467028793 -0.61597069491408685 0.62833657792284536 0.082546670659109631 -1.0391103995279423 0.90442575417877169 -1.1288787715921718 -1.2975628470027825];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
