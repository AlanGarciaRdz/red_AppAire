function [Y,Xf,Af] = NOXCentro3(X,~,~)
%NOXCENTRO3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:19.
% 
% [Y] = NOXCentro3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.74531835205992;15.748031496063;0.00773694390715667;0.0203458799593082;0.00627943485086342;0.132450331125828];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.2109574789085862;1.7104785177660078;1.5203055745354255;-1.5133009981541834;-1.2336095953586574;1.275380170166216;-0.95931066425704259;-0.44392343648267613;-3.6722917962662995;-2.4883893764291396;1.2905694038748474;1.7798688627780357;-1.5438063288439912;1.7425305701160556;-2.2942056578538077];
IW1_1 = [-0.064840739535281772 -4.4026922245417754 -0.80662611475793033 -0.018476207863570383 0.28233208981514157 0.11605961311282505 0.028596193509407241 -0.1522290262255544;-1.3136928681378124 -2.1674108978328661 -0.93451042035450183 -2.0735196742703228 0.80541463194188712 1.560172480163118 0.82222421878960472 -0.1364862027745227;-0.18648303083909842 -0.63815425523108604 -0.090289367879419422 -0.14596080283180113 1.7948906974660883 1.3503785960961026 -0.10872388196141135 0.91139022401066971;0.11576362553905829 0.1331022993873171 0.59469147380112664 0.69122211057221428 0.17258835102730635 0.89767845934850976 0.17295391172860217 0.22588905025976544;0.63461509626586365 0.65071613501499703 0.66276572357034969 0.63058728806057884 -0.39859907170054815 -0.041803611834301993 -0.10044194258269565 -0.34345243701446171;0.17224042151020652 3.919967733222339 0.02868834741876268 0.41020499702418423 -0.39626633153951968 -0.13643064518166539 -0.022979507874638882 0.11607797508739776;1.1382398964586058 1.0004315414409319 -0.70271151932818066 0.45076191382397607 -0.87844392407784888 -2.3986519687871666 0.49491430237753831 -0.24702223186701094;0.21990755558861302 -0.52684749630719507 -0.13464651925120327 -0.42845181265996557 1.3421589915645726 -1.6081330235609628 0.52595263714050222 -0.69959331380053602;-0.20572316413361877 -5.6690348253864471 0.1992524878336451 -0.52163494414041578 -0.29778038173658583 0.0094798019556129372 0.038241736632284175 -0.12152833876109091;-4.2347748325107073 0.076061695439925761 1.1465980290808426 -0.11338337522737132 -0.88453711564316817 -0.67894174316920819 -0.61283876459558662 0.56204710295067994;2.0881822209297582 -0.019537111823937307 -0.92322063061432669 -0.52715016183499952 0.3816335669935173 -0.3901292471027793 -0.05751870318171283 0.65130082020853697;1.6515209384091558 1.5300473923800466 0.50011705355340375 -0.70949332558598732 -0.87309770180764179 -0.11920044141165402 0.36312030459868955 0.35325197710700107;0.012430134373956587 1.6001613371250449 0.4621523115494422 0.94981512383897038 -0.47369796956843779 -0.3322515934919073 0.18635331279858686 -0.15468984438644431;0.74228431264380479 0.78376497907853038 -0.78447503696622967 -0.87618737757900511 -0.50742335247233861 0.12295298090309451 -0.22384700985152581 -0.63615994328263459;-0.96576248072703852 -0.10071887226892177 0.47660229893637024 -1.1651668724653002 -1.0838821370753102 -1.3330836863039119 0.39372623173556964 -0.895521564482745];

% Layer 2
b2 = [1.955975338334532;-1.1146157881327385;1.1716097890710255;-0.34071521706329061;-0.93307150972646902;0.77037197367316934;0.21472342925010005;-0.18363696506312793;-0.22427518117712439;0.52066709042799186;-1.0649503463621046;-1.0042379319489159;1.0167863969543482;1.4886502755000111;-1.6661363349681109];
LW2_1 = [0.95710721812249533 -0.057539054381375701 0.51911427185163916 -0.84889631431395585 -1.5413895463713443 -1.7777186529894577 -0.47044109764715158 -0.48418107656509574 -0.35832222833205174 -0.48521638768963143 1.049068644836485 -0.11810742185647916 1.1699434049901851 -0.27779242057049425 0.42228978642907056;0.48665995507619569 0.42830855927588579 1.2740710892647322 -0.19719253581837798 0.95644511018479328 0.91186938479639856 0.81440405596091459 -0.65473411731469766 0.27666266852543914 -0.84581380824485264 -0.4986571231775167 -0.44115134260824007 -0.64432190123284661 0.60820600725094776 0.59367118034877653;0.10944221366952797 0.15499500570835442 -1.1489024177248495 0.0019331029157386402 0.25711653035792692 -0.16228599113695286 -0.83555530120865862 0.43243426299046628 -0.18580405219494789 0.19838607643044837 1.3228041700062545 0.23765006280041731 0.21034494863085404 0.30944344858563794 -0.66687763903380803;0.63904156984977789 0.25721819985165195 0.0018325916911445146 -0.44818068418398721 -0.92300388050014315 0.92647046716475123 0.34205759591373586 -0.18265366919650833 1.267066084748073 0.49596338207403429 -0.35453113399220482 -0.19369010972162301 -0.81835758992430363 0.87760049466288392 0.79723228885100661;-0.21987002763185129 -0.79570382886640012 -1.2976084034584334 0.14903376619681902 -0.60395420433653102 -0.26604454091182739 -0.41205692450870984 0.54616460756876251 -0.30000606064815938 0.24378684208512991 0.1116055979144924 0.30958971173050021 0.17263521328353432 -0.6114128779257364 -0.12598533351936775;-0.8217512995049927 0.17866704808822997 0.39613939217344835 -0.66528935775389852 -0.69201538833977094 0.19378595189069703 -0.66964338460426565 0.32322520493429752 -0.42358389108621591 0.43505928835987046 0.72635853374551473 -0.15519830867036702 -0.065218423485076282 0.72361429755931161 -1.1731056269722318;0.68159506230760714 0.51100317770390469 0.49808379317562318 -0.47435857028390915 -0.38801297129497497 0.90450945787070258 0.46064910064082343 -0.31521929579967833 0.80983481832943649 -0.30958072774959572 -1.0559618240970476 -0.10239119497184911 -0.15476213552061174 0.073167397356298569 0.83530125439530256;-0.44032943108782785 -1.1127378659166496 -0.030805567348713207 0.79643127415150372 0.21256258387816424 0.0019556770182758594 0.70557898029153188 1.1909559294746317 -0.43945999890126314 0.30925230635562917 -0.29052619702262372 0.0084937843264807685 0.29123490903683386 -0.63880112423517021 0.25168693004663462;-0.40245275575606243 -0.5206413237642824 -0.70499528040174075 -0.52280305125752657 0.39303057158750548 0.52963828225165099 0.43205241973837111 -0.039433482036542039 2.0458369813781423 0.083232183902825579 -0.57188289156248129 0.63176817051972545 0.32604013031137469 0.26100699204313027 0.42279458081167354;-0.78055895989860391 0.29175003307750874 0.82036248933313705 -0.93340718991581706 -0.14596438746350399 3.8613138307885988 0.046179555551337945 -0.26797363000258601 0.18722202465540694 -0.39025917550528844 0.054694996954657238 -0.367919774117408 -1.6112093398983018 0.8492449941196466 0.16670645268435064;-0.88803814997749497 0.4399650838005344 0.42259282402171805 0.71242865620728169 -0.48098320778088416 -0.42963620641521544 0.098929978885389749 -0.97173805188694096 0.49964673074828775 0.1004728047559707 -0.64313659488715369 0.58267694740972786 0.70343543071467451 0.25505559025474445 0.97754414987757621;0.80494419557109342 0.80995850699472505 0.58332130130952531 0.30724251200306474 -0.036687588781303133 0.79529439892485121 0.49938490450681317 -0.23637913085265322 -0.80443283621829831 -0.46339293672912479 -1.4864248152036872 0.93168785634368856 0.43857260826114436 0.34527216911831138 1.1569189501771024;-0.32437879811496967 0.79290330192725911 -0.81319607836736152 -0.48198032294742643 0.18494934353845832 -0.78410283761146637 -0.64097320258065082 0.47086013504932178 0.29657594811647975 0.92688468064186857 0.29704936337810123 0.075015507847520979 0.90922697604844771 -0.19843874681290641 -0.098420263054091697;0.31387606906970505 -0.57268177384698637 -0.49951334465877656 0.12233812749059314 0.42755084106241892 1.0108149601813547 -0.099486262839457107 -0.28856428905182063 0.38337886552631278 -0.48565946962030315 0.94642887469106396 0.80275842576661915 -0.85729378821850966 0.57428512522314878 -0.092345948600859595;-1.9263918150817545 -0.05000936977693541 -0.55904062754568706 -0.48691493254756246 0.32071227757912446 -1.225166169229027 -0.076182438499447433 0.2056130780598108 0.82320784456992069 0.60350244692494348 -0.19424024642850343 0.41591992256304272 -0.45161859059823689 0.43385910397309801 -0.53767697796040159];

% Layer 3
b3 = 0.48188532809804863;
LW3_2 = [-1.5113057063597084 0.73756858268083969 0.93038475388510522 0.86002744821120503 1.6225856167148713 0.97673706933019577 -1.7657534792587746 -1.0985422932682811 -0.61322868353390514 -1.8185826955816389 0.53660768490280042 0.38978522966342688 0.51648390627977447 -0.61358408675414844 -1.3657097213895777];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
