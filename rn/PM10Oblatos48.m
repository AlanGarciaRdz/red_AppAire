function [Y,Xf,Af] = PM10Oblatos48(X,~,~)
%PM10OBLATOS48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:26.
% 
% [Y] = PM10Oblatos48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.1780068203757952;2.004739077995533;1.4600605300567087;0.33940055811490122;-2.1112319304837208;-4.3589598909922156;-2.5032712354018916;0.51949333727380309;-0.12698972235410128;-2.3995544210600732;0.61065861080538564;-0.085385809655026429;1.5666209165115734;5.049070908214178];
IW1_1 = [-2.4505672411350936 -0.24084614206969798 0.33240429825696144 -0.71449667446607179 -0.2502354471057599 0.715369584242732 0.57517089453395942 0.16334601282146494;0.12806805000444407 1.1549392158452252 -0.43511949484390289 0.046884582277720958 0.64471199148789593 0.37548445576689654 -0.11115062820611735 -0.34173653152619027;-2.8705799476709064 -0.12974027081273345 0.15695321571845475 0.15281197300988331 1.3264076377928264 0.49807012385250604 0.68798387749322443 0.36197913583539965;1.1441127490937066 -0.91628742816035191 -0.035932775416818573 -0.22723826267353361 2.6450780525260162 1.2337360912488951 -1.3504784835472092 0.55118365762774568;-0.54925734963014394 0.11522380936119089 0.23662326190652688 1.5891146728399852 -2.4783803022633264 -0.14734613253801748 -0.0913595496745091 -1.007787331728434;6.06728592302 0.19174407736249999 -3.1459602583920274 -0.89566905948074005 -0.30393697513019463 -0.34869689560461392 0.83765105802138828 5.9358752888671509;-1.5914129591952157 -0.1734245162255442 0.37122950074965544 1.7999649498019878 -4.2466695701782022 0.48004311540096001 -0.2281027108572018 -0.43100247429579464;0.037213082546436703 3.3701645940238159 -0.18115442862781195 0.69045693534849384 -0.12257073625816128 -0.0637910360150961 0.19169788283069528 0.4111096224777997;-0.049508984190195816 -3.0206155052892125 1.2360356998695661 -1.3195444587446936 0.38965708289409362 0.13654856006313965 -0.13657379751411244 -0.54378489222170689;-3.0791349706486222 -0.32169301608233014 0.21070486989844481 -2.4328344653920424 0.13425023193857324 -0.11706805113424711 -0.49879380071069934 0.31138945757159159;0.48366595646400512 0.32497270702983505 0.011544871203619467 -1.3839147094142228 1.252377016274683 0.75512144247274782 0.76544373924972819 -0.377375746156909;1.3834273137889062 0.41498992643543831 0.31941858029672782 -0.092324839687233956 -0.19451340798197655 0.43022599436918207 0.37414432998872421 -0.041186865219079556;3.9209206384378525 0.20328170547573809 0.73664548382362693 0.077888645179126317 -2.3560143570220591 -0.46433664017505638 -0.55521081132270678 0.22847015621144059;-3.9977856894677046 0.19663745900258975 -1.8722849337877743 -2.0586248399328819 2.3071815687265551 -0.27669866617333971 -0.60341329979337632 3.1059885986808458];

% Layer 2
b2 = [3.2098486101635455;4.2786853844589707;4.7225881349272525;-2.327674341353251;-0.93494512345319236;1.3134728964657831;3.0635060760008508;-1.7710520509101784;-1.7665318914570167;-3.8969618385911593;6.3198568174927168;-3.9727727727712008;0.6840141116126387;2.9421545805245652];
LW2_1 = [0.8163421582115421 2.6971879760575765 1.4116727112264302 0.24548424963372464 2.0526972568213306 0.080292103542291771 -1.0540875521074018 -2.1773474743036298 0.047216860345335017 0.42222301126313577 1.1401170927837929 -0.16772017422095867 2.113042157841571 -1.533113867797077;0.81306410466837409 0.025979491950470827 -0.63360640224638554 -0.28277466913891097 -0.27455741059439581 -0.74712517888770491 -0.1493672919789481 0.91335413647963992 0.83223814469206137 -0.86790962601174937 -0.031957461654548616 -0.97398921074657907 -2.375611291261031 -1.6429353578651766;0.42781427685951567 -1.598026608152382 2.1304402547113188 0.79539347961897244 2.2209362320471575 0.6300786682525773 -0.67445198145612417 -0.79862844149072887 -0.62040158527375355 -1.0382361035733534 -0.76873471508869695 1.6197915238214233 -0.80031370473021557 0.074122746608191944;0.43705008331937156 -0.38840592255054573 3.4195711537017819 -0.66504274794463947 -1.2477101955867023 4.1943203855684947 0.82022983616012957 0.14650038639913129 1.3725107525765161 1.1161752080722984 0.69553778313028369 1.1119101115137011 0.41745856658318647 -1.2270963666418402;-3.8924982564201285 -1.6136059693709506 2.9096454235725444 0.31338804471757248 -1.2634756911584824 -0.39640721408855972 2.2566727592441231 0.251181674817752 0.47105173211498169 0.26470558196055732 0.55036829015277466 1.3402267023438217 -1.8285041297630023 2.3970095012131409;-1.6496327222240144 -0.11363221318384778 -0.063927473143254629 1.2713319750889498 0.61040641882742519 0.88260507785511533 1.6635270486291811 1.4609968948341536 0.91794520241443178 -5.1438346415483212 -0.91616056667887347 -5.7322509259628358 -0.90256396343520295 0.4814877138979784;0.33489033520236688 -0.72859082320368618 -0.33970340584171638 -0.41164917196271228 0.64293072620748348 -1.0478703990056879 -0.31001057618991101 0.71018485355898198 0.90693240744513226 -0.022106941694610388 -0.068039097029827411 0.12594999246576111 -0.49857680206434773 -0.64655360313597887;-1.3755604537499344 -0.55164910826710134 -1.1332473972942394 0.33580770415382971 -0.89675922191495849 -0.47309117364939623 0.9570167357434809 1.3622711339434428 2.5789584934574181 2.6703876575715833 4.0538932855370149 0.65928489771199672 -1.4760130623480285 -0.17828273259537691;-1.1467433206357847 -0.59208891823414023 -0.51336972164853756 -0.79113311537338404 -0.46191612315673747 1.2974096980625218 0.29270766472386978 -4.8962466642257221 -5.0169317281360311 2.5272720797177484 1.7456685581709357 1.814862420863333 2.8086406589184865 -1.2437397368585301;0.25092229201479449 -0.13469392003072744 -3.6015054040771868 0.023691358920211587 -0.94920570883874411 0.67641068096592194 2.7018119832406526 -0.88473416593261578 -0.12012094775727525 -0.73591094618406605 -0.3659302940327025 3.5204318804968278 -3.1753222814353763 2.0697078663949413;1.7883974593621859 0.005385838138565302 1.1010410798979284 1.236275972082971 -3.3292681947163589 0.35323055027705152 3.3359642111596859 1.6334745096235863 0.11863641992268191 -1.5010729954367639 -1.7860205536355609 0.10344179524033228 -0.099071154369148193 0.093411822016531532;-1.2342775201209026 1.0983818450237528 -1.0758550498834871 0.23436511908697566 -0.51359240280810936 0.012804716720214484 0.16705056250831501 -3.5494259759498346 -1.7453333284991914 0.78258321873303238 0.52301014781307942 -4.4006825087035342 -0.81896616016475776 -4.1007152616874416;3.7260751188739989 -1.8934522914587957 -0.71203945349753583 -0.031215645763110089 0.6584605988046548 -1.1495240333255357 0.56522503579253014 3.6947510603492804 2.1765407086784845 -2.2290815496066951 3.4300295548588369 -3.8847777129207302 -2.8861437651356421 2.1814843258199477;3.9984993018909303 3.1547763926642309 -1.2784642728326749 -0.11122003179719119 2.1253753041063761 2.4482512394372753 -2.3729868291640699 2.1127104630257341 1.7794659033681823 -0.5439306801153857 -2.3383415725781398 -0.011716899125392539 1.4987854290633076 -0.81482473794943311];

% Layer 3
b3 = -0.49995584181300651;
LW3_2 = [-1.3688756279271044 -3.064650671446814 0.23130402341769882 -2.5445028743279945 -0.32122359391233718 -0.15752659720967682 2.2041467824380367 -0.11546978473798084 -0.14898984661942144 -0.69282267506437889 -1.6443158328820577 -0.33076526732602723 0.079120783331375677 -0.33461931561005065];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
