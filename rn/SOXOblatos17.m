function [Y,Xf,Af] = SOXOblatos17(X,~,~)
%SOXOBLATOS17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:42.
% 
% [Y] = SOXOblatos17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.2813762279973568;2.3072117174965343;3.3424975748503143;4.5970826705357233;-0.56997599006386623;1.7704767443202776;-2.0339323937357729;-1.0209357324462904;0.022389673444221013;4.1575067841088149];
IW1_1 = [-0.95670780155574719 -1.6114541985689617 -1.5578968341818045 -0.3944692352939218 0.56586901481378959 -0.60025819013693216 -0.19474162902928097 0.93225026881195139 0.81313930616360997 0.030276862652253978 1.5763606006415651;-0.15747067517740143 2.0615207905022093 -2.3383818869230009 -0.96177199863590124 2.6765103386593663 -0.64142368001071215 0.55464100071382394 0.073596185482925 0.10365660919482092 0.39448475226109464 -0.2247778883401024;-5.3551697559412386 -0.12353566967331048 -1.9831755428274436 0.84353164105528156 5.0514958363521334 1.7606271347246094 -1.2899219803944741 0.6235140066954904 0.88794236777979785 2.0611730689639036 -2.319951917625271;0.35458684008353814 0.14693508645909853 1.7734003942616456 -0.22563787284248404 2.8212927361510856 -2.101742062330934 2.2100683670476422 -3.1265368705531453 -1.1755938981095921 1.0552958319911181 -7.5447500075485525;0.25170738291292416 -0.36846332998426595 1.0721065390871036 0.070768066762963405 0.82256952215004697 0.10590296138568743 1.0213117084176302 0.41578566496680469 -0.51525778194794192 0.5481911430504931 0.99215342703538023;3.384576456400302 -0.0016399162487786348 -2.1375383356417506 2.4475980730963669 3.7686801045804157 -0.95366778695457599 -1.3289676033483764 -1.7871188203802253 -0.15783127844010902 -1.6009964575156836 1.7854112588639868;-1.5135445793107933 0.15314496768409461 0.48982938955223954 -2.4590696363498989 -0.42479459132578645 0.7589099318520689 1.8176482472839353 0.38619147441190904 -0.76310994513531516 -0.28050879914229282 -1.1633303481423167;-0.86219623130673906 0.8521062643434788 3.4008763130678323 -0.079781351836762299 -1.9458048227710016 1.4797376953334969 -0.9030722194958607 -0.10192473611179784 0.56216658224100902 -1.5058424373105661 0.56121738241239849;-2.734678748866624 -0.54939732003867736 0.57354734170670807 1.3153495478418822 -0.39756657743165646 -0.3609678980119434 -1.3895873837516688 -0.057507655865788633 0.99904535215574775 0.62149521940671548 0.72945015044565864;-0.29686731306230485 0.16489390663697626 1.3115418640253658 0.34777019284226041 -0.06645492495591282 3.3905044940800115 -0.33812840538847211 -0.56865634249834651 0.081990694971455697 0.038774980753332036 0.17162654031089716];

% Layer 2
b2 = [-2.3128813029520243;0.38280519673043623;-2.7187406069082418;1.1531562367427046;-0.48711914156897573;-0.55186001477304703;0.60707407980273898;-5.3434664554494935;1.7018498523177352;-2.2176291129455064];
LW2_1 = [-0.35371665803714264 -0.21662747333154792 -1.3134201570715154 0.29022029868282051 0.73225866820218732 0.67437832182895752 1.6375075300116395 -0.43411638944197167 2.1725378724784989 0.51771305062793838;-1.0495996094376681 0.27240222102774564 0.52728919547138053 -0.35098433246046168 1.1051870767067153 1.4975547268843024 0.86466385065111628 0.9692337871949952 0.52382463916289324 -0.62199075782359481;-1.2378903325605228 -0.64050741179372805 -1.4675993989558618 0.48364816079894596 2.2588335108974986 2.0406832872009573 -1.254497223610147 -0.18449868406001244 -0.52579201420131394 -0.98438498160692101;0.45720346956705432 -0.51646798376187864 1.1210356872844154 0.70691974001565994 -1.1766047994989239 1.0490669687535306 0.88622006882139404 0.050447978659777085 -0.4841370435610971 0.54055022229535621;-0.88852105759830979 -0.105697198672896 0.10263654399710093 -0.93778563234917145 -0.0079741453866622181 0.77663255042089119 1.1686247891767929 -0.13729945954481204 -0.21475441883661353 -0.31403428180761589;-0.74988612369400398 -0.22134680699393222 1.3440790112560048 -0.088652161465488932 0.86353738931112112 0.66050242545436622 0.76794660651066493 -0.27125779016863605 0.85184081293927139 0.073294477769956665;2.2165867554377168 0.87736790648335972 0.69369111359733626 -1.0022536061863212 -0.50136976640511832 1.2036516465562657 1.7967736982493649 -0.5843714128337798 0.84028819642748975 1.3716908800391241;-3.1184883691329901 3.1310403691702215 -5.1571029457957298 -9.156544065152028 3.5745473203603528 -7.0023889162185098 -1.4346702514595955 -5.1412579608453788 -2.1395995196813575 -2.8937060599185469;0.70272902195299325 0.19074301590751261 -0.24787070265792377 -0.54708361488964474 -0.55568734583329926 0.28899385700072056 0.42066848820081071 -0.30702657780499942 0.060451109786041256 -0.03684777740899952;-2.3210251152238977 0.37901538918031796 -1.3092612087522999 -0.14977659024922038 0.88289969493427645 1.8589521077459741 -0.9038476991520934 0.55433186654355593 0.85625345187679958 -0.63181767583797643];

% Layer 3
b3 = 0.13781514475854409;
LW3_2 = [1.4431786311158781 0.81712485842648175 -0.7347369401327507 0.96165730794352555 -0.58200598580292062 -0.18258124075572063 -2.0606533339972901 2.7232821972897807 1.7528161081904325 -1.7963195651504384];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
