function [Y,Xf,Af] = SOXVallarta9(X,~,~)
%SOXVALLARTA9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:05.
% 
% [Y] = SOXVallarta9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;10.4712041884817;0.00782778864970646;0.0208333333333333;24.390243902439;0.02710027100271;0.00630517023959647;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.1764593929458416;0.99102872003662379;-2.9307808652181464;0.57999689609029492;-0.67689288924751279;-1.7030691224065631;-1.1185804350055619;-2.6735644104384728;2.0483683730967295;2.221282417597688];
IW1_1 = [-0.058365234798367624 0.22158721025038752 0.85854778660097908 0.066839992282832578 -0.8126861203593837 -0.04410858584114645 0.44332784179091189 0.78510381835921805 -0.051020594423778251 0.66851392156694811;-5.2168260655444243 0.20230459488455088 0.69575166402361865 -1.3153611137248087 -1.2116994928922828 -0.097173828903396972 0.46865906970333238 -1.2908721415618301 0.12096192892443024 1.154128584694974;0.83421895440989979 0.15290075484689605 -0.39704882247491752 -0.26121697595238019 0.016059512394196507 -0.71494975177657538 -1.475878447686273 -3.2165634131548639 0.24830238683366618 0.22281607990777264;-0.79264234977978154 -0.16088634909779012 -3.9550626801449114 -0.26936081580708071 2.6876778071522702 -0.50189328737116856 0.72646466434301571 1.2689600447507896 0.41400651753500928 -0.45177294153699865;1.5606232890686347 -0.1420464878646242 -1.1721541177620243 -0.10216205280963878 -0.020665631345176294 -0.057056409751994858 0.047304770951682673 0.00063852629290020446 0.70389029321476704 -0.5051335840138429;-3.2686813467201898 -0.46224931957463983 -3.8846839229919268 -1.2586927663636422 0.42982088832798232 -2.2379125931682879 1.2069377357706133 -1.0700292179812636 -1.3763558219211964 0.334395712367756;7.1434541106177152 0.19696948421443289 1.6227109399680815 0.10317453257326958 -0.60057020239436854 -1.1668073228444016 1.6995871531969715 -3.1014610394771274 0.0011245517108461334 -3.1974637688750436;-1.7012737179163164 0.2404148128704286 1.7947972026437227 0.16486107467718927 -1.7819162909578448 1.4324533725500228 0.4396651833942794 2.2035645145789888 -1.8449282930076034 -3.3151205442922875;-0.38913702233193598 0.60048609658335317 -0.41761641298838781 0.19212360843644677 0.51256968564088912 0.21765172778594011 -0.7191066437448409 0.69950075956440838 0.072707640517494482 -0.17741219408389669;3.1816738763628605 0.47027912959263563 0.23218916559240577 0.78769004617991123 -0.83049968908632954 0.37954563511507111 -1.0007306259275812 -1.1463705403157813 -0.90684787430593405 2.1053551652623823];

% Layer 2
b2 = [-4.473825876981838;-1.6214410032459567;0.72161561702000909;0.33965763764234491;-0.86771188051316017;-0.37754156218251955;1.440347571261192;-1.2464455623938009;0.86399842594254561;-1.6323047759809888];
LW2_1 = [2.7684503049205365 5.5246552464559997 -4.7436566342691018 5.4275701382259305 2.2702593503302038 -3.4160360845753157 5.7454812235532584 3.9999385749701766 -3.3538588988552833 -3.8993724025149614;0.24144804076629697 0.75225354301860758 -0.41095564704705168 0.0066300427742368023 0.46120985930677916 0.05477503316931992 0.15508032676410144 0.042099091068077146 -0.044475267935936605 0.71734954176493582;1.3936054443529835 -0.15742422419058399 0.48069289176407232 0.58834361558985449 -0.11775018752101901 -0.43609092373928937 1.1108243047782367 0.16609925046795398 -0.61981286527810375 -0.062937082520401061;0.1182564229050703 -0.31504219140308237 0.072522681897751032 0.64288508711651993 -0.31145497018310653 0.23990677237434238 -1.3280933156444561 0.0862015113120774 0.383517906861577 -1.1556289302221716;1.6288474051206676 -3.322591991629011 0.52482723331972558 -0.90296557990587545 -0.23822245667448883 -0.26959674695696534 -0.86885327368352605 -0.46402157714204451 -1.088665175431236 -0.17539769609044076;-0.34280278980548223 -0.090990311880203401 0.63043317877708482 0.50391034167532167 -0.19893231804788181 -0.41037100867305248 1.2857858268573354 0.17370711659288299 -1.0169899812310368 -0.18614519904028037;0.10216364677390195 -1.1306877136552265 0.68967106532237032 -0.36650217800339224 -0.79829161409346838 -0.10094941088051279 0.29793290432273611 0.050939956996721707 1.4440755862694372 -1.1330017296608426;-0.3695524048231621 -0.18086916165192277 0.15332238835927076 -0.089270394410652376 0.63552139564701171 0.97080729832930057 -0.27911922720690685 0.71557372932184593 -0.49442594591533739 0.23735207828772573;0.79684953237457923 -0.41329416594958812 0.76739033369168852 -0.52261930419860125 -0.068198615097542395 0.89777330922492682 0.76441320845162264 0.3502513012446774 -1.0929646454121498 -0.38013555994528686;-0.40036477457946862 -1.8767495881184844 0.92588730700872668 -0.33776144513226569 -1.0628117350813151 1.0850273078018524 -0.21635610811087955 0.28778192222629823 -0.10336934630237007 -0.87351386312702939];

% Layer 3
b3 = 2.0686231638527062;
LW3_2 = [3.6912273209991437 -0.76391152523078143 -1.2157111288709268 -0.17547560746396507 -0.21987959684119529 1.0433853318007511 -0.27861535761102746 0.14836411480862113 -0.3108695610691824 0.24474846222630753];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
