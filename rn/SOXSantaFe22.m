function [Y,Xf,Af] = SOXSantaFe22(X,~,~)
%SOXSANTAFE22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:52.
% 
% [Y] = SOXSantaFe22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.9069985529493267;-0.76881283947851797;1.997774497858497;0.82109880843627692;-0.22553538046855581;0.096512886740165671;-2.8105862281461915;-1.0879757449597267;-0.31788181991176095;-0.86519706960799059;-0.13583579144792457;1.8803590770491609;2.0797755910391578];
IW1_1 = [-0.016767482118638911 -0.12675683087619796 0.617245332297919 0.32129484291819077 -0.31440469449620878 -0.065953994651374873 0.85049594914480475 -0.43206163234699752 -0.057373190764312437 0.025057984860757651 -0.19441026099882747 0.70952133594219136 0.56436216564926311 -0.21014502220051406 0.55944170555799277;3.24203889816624 -0.08695833247911583 -0.2322510430619264 -0.54468457903342471 0.26702437806048362 1.0076612755601901 0.40961327860477525 0.076354890804625083 0.49595038257782476 -0.47280041398661488 1.1681852063080944 1.3704411872781324 -0.72296894892736652 -0.71191494287014434 -0.033825612623851115;0.54542139998964401 -0.19786983285864937 0.06757536026571595 -0.73461284985552489 -0.50793863935150185 -0.11920401557073582 1.1459226694344189 -0.20207583017907788 0.10996240798109416 2.6081061119853217 0.31853238555388064 -0.17155958700458843 2.0580067672803892 -0.43176721458946965 -2.4393901868593573;0.90682410762268073 0.080414047427393665 -0.25047823645379086 -0.047028890897199409 -0.42582285998132929 -0.26593524259319018 -0.10820169418450784 -0.77714501981458151 0.99802041653797668 2.1500934272563148 -0.12202025093939413 1.8853947982054151 0.43903058655373856 -1.4892141479114911 1.1309902047632816;-2.506857188520617 -1.2664561458518384 0.9848041395760776 0.87663572572528936 -0.085403503226981398 -0.57168936702941497 -0.23595697795553963 0.37832533442577049 -1.5359984881662658 -2.7029145780547088 0.55066087680670672 -0.29068524664354511 -1.0841876358890723 -0.55323848099041817 -0.71055563265635813;0.50849231060095534 0.85544331092035353 0.19377732581010804 0.41596324025367937 0.54785892868740993 0.12902244109006231 -1.4427115720632244 0.21985738095078267 -3.8950205864630494 2.0521809945550715 2.0360290148858362 -3.0758832075401754 1.6723188759329222 -0.74194887492238104 1.6967209989624297;4.700878420071259 0.09675180422197549 -1.7611977388590823 0.56770461305449804 -0.081871001621862338 1.052281904733545 1.6513424566633672 0.02292848226641591 1.3327265624771016 -2.4870174058273724 2.0273666380785578 4.1380702691126512 -1.680681855774627 -1.1493347171756365 -2.5557558039144523;0.84566462260398745 -1.5523256283740861 -0.79674987657623064 0.38553178449411712 -0.95366287893352686 -0.15804635347634094 -0.083817503256057052 -0.063566214934800816 -0.87634760819507518 0.14262124418973721 0.91345076206411702 0.84995120587777151 -2.5118939644086495 -1.127973089245436 1.6980741921297138;3.818616976209809 -0.27087761666789045 0.84467739357906879 -1.1838336506611051 0.23256861675792984 1.2613389449514534 -1.2356961383438354 0.12734058862178743 -0.33613258099296239 1.1092975751266057 1.5840790508546672 -0.081797594822245523 -0.50914715078753403 -0.75980638448712412 1.4063002194325649;2.9020452738683211 -4.7731040381537131 -0.96586619690465358 -0.73686136947402903 -1.2304053841046902 1.0794141475524455 0.38463181369009741 0.60106723639027271 0.41455495700064282 -2.1186615666570687 1.1858248965452303 0.78438212151497344 -0.32394608128827845 -0.38574888260730905 1.3194164489072719;0.34108845486762762 -0.13766426222091691 0.054233976344938165 -0.36859417762661556 -0.21806285028317127 -0.1101837023603681 0.56479132871618387 -0.085461115602209869 0.051525274874078875 -1.1076376658247977 0.26661412269071516 -0.26201605212708629 1.1678363345441534 -0.32913762181603434 -0.075347099535285067;1.3495097536507579 -0.18005988128001296 -0.72005709521870476 0.17932831783746025 0.72007295334183286 0.27947327924694892 -1.9989475510349581 0.63512675825805109 -0.40788239750952066 0.47812381783352287 -0.12921410384859605 0.084312902357201513 -0.86406423624937057 1.1122433491776453 1.4813868692035386;-0.23259360710075727 -0.56589515399187351 0.60463200908026593 0.20150011488992656 -0.24945337886832883 -0.49839129070905819 0.27390112918822729 -0.20124182305986754 3.2343663958590643 -2.6771482865706893 0.4274550435504148 -1.501044541899637 0.26755957363574073 -0.63016192518027236 1.7067687594047305];

% Layer 2
b2 = [-2.3597622426408464;-1.9354570489872238;-2.2313537887520809;1.3027706947821596;-0.43243887157575356;0.31243583296807254;-0.97245306723934299;0.38161463396786527;-1.1355151619398718;0.28171747168381711;0.72088518486636144;-2.50847728531458;1.3501824803081754];
LW2_1 = [0.75997887758819738 -0.039852372278620193 0.1654061237654762 0.51561114576617784 -1.1833014654862015 -0.56897517733620795 -1.2953462127736284 0.10758412931459418 -0.83315847287942169 -0.87400165554029741 -0.29136243667101014 -2.2082184282331347 -1.1250124041606855;1.1446273977342079 -1.0856170743630482 0.66619984394633869 -0.61948879047293703 -1.5806903506192655 -0.38489173264937249 -0.48632130683674879 0.69846420355536842 1.6788563342122775 -1.1702552257333916 0.34014530464278481 0.51262699898072273 0.67815794670209462;1.6848992017442832 -0.83280660575846432 1.30589549449595 -0.23306495458991391 -3.6904777360796586 -1.3819136700629184 2.4157232908088555 2.0273832077306926 -2.5043382903816918 -0.29768528164886388 0.89199856374875763 1.8770090210759247 -2.5779467969280554;-0.45377341809333854 1.0613676944309436 -1.8728814289348326 -0.17725219718243948 0.37673402595389316 2.5284730822145329 2.6747812352234623 2.29744038258846 0.74149933942293322 0.51623057155863861 -1.1841199285136608 1.5127160050681059 -2.4520517150865766;0.50965925991326055 0.65979979225496332 1.8509282934693532 1.0157923099141701 -0.10082122722915884 -2.5324641739529339 -3.6588560881474042 -2.3258506525087594 -1.2525370465788046 -0.49552624576316395 1.1897042970161777 -1.5447166086240234 2.4512956616778951;-0.26007369455468854 -0.93798408449388637 0.70108291777524057 -0.54574573866475284 -0.88727549031258368 0.57229086223487835 1.133724256171101 0.32003506746205002 0.78944856118665718 -0.93258048534621685 0.98652568079044967 1.8574825565654238 0.89617484157477234;0.80461298475581144 -0.28080428902644183 -0.38974887299057914 1.8186626414009464 0.50680975566111797 1.3514675172376522 0.62904021952166844 -0.72186368735512896 -0.073455439118777999 0.73021449622357215 -0.46186541109047707 -0.30208719288024799 -0.40991260150472125;0.41195851613674861 0.74060861691117563 0.66674531520899571 -0.03535748115488236 0.27648073661540157 0.58495983078531277 -0.28238881317620634 0.33630536862787586 0.63469181272360098 -0.912493776792765 0.97985449435448313 1.8456146781126925 0.87907053568065852;0.061482396724525192 -0.31388660284333952 0.21761357373732818 0.47046802370873558 -0.95793974581438812 0.75123023946497058 0.35592789934447611 -0.6086235211623634 -0.25523357602451496 0.62672230230198644 -0.95343882546939751 -1.169380628231963 -0.65605639244753922;1.1096893274878252 -0.26181540990606261 -0.12014215108134693 0.1539610449739553 -0.70139582290807867 -0.20196366324617507 -0.51775033935908765 -0.16028125875350013 -0.28434398501437602 0.13251416348383502 -0.61363052197772416 -1.0986023227530102 0.7196250013820884;1.298865834131198 -1.0591269146812865 -0.15302318120478539 0.63910217857061935 -1.4041936987372414 -0.16032549440478761 -1.2318438448074052 -0.10860283390282351 0.22976538502831742 0.011048231425421794 -0.3154452688693048 -0.88440043792451128 0.7732215046164399;0.70703245253040836 -0.21847475453773926 1.109971592378634 1.2584291904298468 -0.53377110384749704 -0.48365433315951017 1.2132478448508366 1.2986847471867664 -1.3810492849229477 -1.3720400580205139 -0.2697210840031779 0.15724257515806919 -0.6062740434520445;0.38665903508136823 -0.14505843364799542 0.70332809321344936 -0.25827563393157638 0.55228111717686867 -0.0081418376086731872 0.026513612721682865 -0.035196230407514975 -0.010630571452444559 0.036905630978702184 -1.1282656735349033 -0.02623760718418007 -0.013651562620790092];

% Layer 3
b3 = 0.50719874778866725;
LW3_2 = [1.7109099617070118 0.35867827047245643 1.6675237313481868 -2.5669797645159069 -2.5617751553182337 -2.0225991661000089 1.2968027335122729 2.0268720016975119 -1.2971904832612706 0.67024488727143683 -0.49645078698355 -1.4979235470525014 1.0440182237019846];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
