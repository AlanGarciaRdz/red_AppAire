function [Y,Xf,Af] = O3tlaquepaque7(X,~,~)
%O3TLAQUEPAQUE7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:51.
% 
% [Y] = O3tlaquepaque7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.171659085057077;3.03490136570561;14.7058823529412;15.3846153846154;10.752688172043;10.4712041884817;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-1.5010738171744324;1.5783729230036987;0.82902023338745379;0.58444231336851316;1.7857470926482721;0.94687691345713754;-0.48678426492427507;-0.7432279848811546;-0.28505614757147824;1.6286485095678982;-1.1716252443704838;1.6816699334197895;-2.9182575304762719;0.057414620884588541];
  IW1_1 = [-1.0130065948842488 1.3072437380973105 2.3024433187226085 -3.2050317607244603 -1.5153693243349047 0.4099560645970281 0.1186647247619091 0.69327876555929535 0.15674433961652728 -2.9443851709540025 0.30837430723075088 0.12065550238246082 2.1691439254078131;-1.0901541790245304 1.7603328627962083 0.83791357040918535 0.17334360431610935 -0.70409003843327855 0.0043809406052256403 0.3020446846431713 0.24157603599989982 -0.058803284605984135 -1.1955802937531486 -0.063420254040826823 -0.45611592959788044 1.1163414356008365;-2.4284744369438576 2.4542963285720649 -0.16572926569283938 1.0232076478810881 -0.89410519444042125 -0.057380655509564026 -0.2107662827081086 -0.026173161563295654 0.24069016980934282 -1.4107025644369151 0.47400328001875719 0.25346872424825023 1.021807885464056;0.038368019430355449 0.39734341745457885 0.017023838673313058 0.64569836690789439 0.69368466855517885 -0.14349040936630414 0.25675293463804016 0.028159685304167938 -0.65621029935733288 1.1084615785074512 -0.28301706052665393 -0.71423669182611005 0.2617161348969862;0.46964502374544731 -0.03452118248962123 -0.095199377780189109 2.8543933028430946 1.1141296121903721 -0.50047200975178507 -0.15686374992029473 -0.49104088988838218 0.33081256818593918 0.20448341125318181 -0.30083058696278969 -0.018760239448490861 -1.6131990438082997;0.56367117318749838 -1.1020842414783885 -1.1969537562088712 2.1052090998287216 0.021599665476905814 -0.32190678224241059 -0.12893777112534133 0.27708893454617445 -0.28400541987536393 1.0006619029013613 0.22056563739360016 -0.43104979092838991 0.11096586237410783;-0.16636900997185003 -0.31286040445451258 1.520169291206219 0.53552938917847692 -0.13772304455762044 -0.31084563114795877 -0.7494689430609065 -0.47883417093567771 0.58523931382217753 -1.8225863228058363 0.43462924976854411 0.32409810174183468 -0.080806084819656607;0.0013083964474935733 1.6633830017571483 0.88708095267360743 -2.9665349843334159 0.40325072906014375 0.031856526847805808 0.39386018291359609 -0.14958050689162555 0.14130058571911455 0.31965330220696747 -0.4928367295280236 0.030255498876980282 -0.61924485196725532;1.9370445985020048 0.043477221370409845 0.38944476170310066 -0.7604458359668399 0.16409899202749584 0.041918863820428025 0.072674569742901748 -0.12592335966316584 0.08861900224919092 0.29734690749042963 -0.079747744824482727 0.009089277062460795 -0.43649539063043169;0.71655501812213374 -0.078634063323653816 -0.50334245478493289 0.94939419377603562 0.61730873684728105 -0.61412004938299991 -0.34810590136290109 0.17233565092106848 -0.76570319059883396 2.3427402322454385 -0.15458420065491421 -1.094674140966361 0.30354609735229943;1.882496663655407 -0.49035880128843923 0.85832840162972113 -1.8664534198424749 0.39557235730882201 0.060137833818607926 0.15308311174440695 -0.67656643619021573 -0.0027632046733208258 -0.3710264133181107 -0.2904763022267004 0.08068394599805094 -0.70463174206040857;-0.2196760269602237 0.04247537726771522 0.26365529232187401 0.54226192857228261 -0.12491825549698377 -0.065991298171309762 -0.31928286062098821 0.21740937472954766 -1.0643534665118437 -0.6835996420526762 -1.2975252360808185 -0.28660793036421378 -0.23617305065095059;-2.0819820114092638 -0.079752963632968896 -0.59908154205049235 0.029085811967323547 0.41274581293027957 -0.17041276287269425 -0.012431735311442139 -0.3057693578424302 0.21957184785883402 -0.28176179349516478 -0.17666355892225549 0.042865524339404368 -1.0670935080862802;0.879064297358774 0.0006654985771674081 -2.8653350577976116 2.5397976625214795 1.1414318474870178 0.10356130746168843 0.66284375684618602 1.3769311438257752 0.63985830827484802 0.81132445220671257 -0.53165787204821269 -0.088844521400139501 -2.3125677025684039];
  
  % Layer 2
  b2 = [1.8164683043109229;-0.40919021685921469;0.77237700479853932;-1.9419408630423902;-0.95184035919713472;0.50489352026888212;-0.64230751441631317;-0.12017847703030429;0.83993632999251078;-1.1262108575787;-0.92919807676163269;-0.99893038257290157;-1.4305887024990305;0.27770521390920566];
  LW2_1 = [-0.46302602650229252 -0.56453947057653164 0.50663119459833728 -0.036288025214822495 -0.12067617107441139 0.43265305802053805 -0.51842614059509762 -0.32853840775271631 3.5469576426008969 -0.4114270418934563 -1.4756175484349414 1.2458907511011543 1.3315237474583284 -0.73446858553140182;-1.0603514338977842 0.084746962774181922 -0.19769128044075582 0.0096091280937513311 0.1777701978436772 -1.1747970681187467 -2.0699258755062182 -1.0719062768136722 -0.2981956234808808 -1.8324447436975952 -0.63644968981019745 0.83188242758783415 -0.12323002905515446 -0.60752107482657225;-0.3907183229867181 0.6316777941606575 -1.1408490539124283 0.33214931530447384 0.44653156225883195 -0.49309723463409921 0.38763746715851499 -0.32644814601269967 0.5490126264849694 -0.13719850771082079 0.11790414294059778 0.51908051853667925 -0.46486249861185941 0.39485749974168749;0.62533428530214885 -0.25304305551868667 0.32323957702755191 1.0701219211103499 0.057422799612071654 0.95996099315918038 0.43390023214681234 1.3069792764575607 -4.7572012848420897 0.013002546482749594 1.9849675945985406 -1.1681011631497431 -1.5214677990557191 0.5914096397056986;-0.65175659574804312 0.24877788542801074 0.37976036111871098 -0.5749002864059618 -0.51802854212902616 -0.96032095094846937 0.46026600669082163 -0.59619318009381805 1.1379116522632291 0.28950505589745534 0.0020058613268707955 -0.22309830292446065 0.015285738766931607 0.45841876203733217;-0.8289892516517442 0.34698367973702859 0.34747865860222477 -1.019640457312236 0.00086333492631059106 -0.71211545296295709 0.10959989685009586 -0.070096982889166715 -0.36671112844013065 0.16288546121634601 -0.7994130279551418 0.84438953777239445 0.29189589462847843 0.20106401804415602;-0.65530355373538041 0.49147736593944419 0.64700869696841989 0.31085533511649677 -0.26374801733715164 -0.25249820268073436 0.63869723713615711 0.20364983735628175 0.22998532252851084 -0.066614223147591689 0.90619700827928606 0.71630168869404309 -0.74593690713557748 0.76453148014840944;-0.94379411386749501 0.40014838811453485 0.5294776957986278 -0.35917415667644303 -0.93987527275374083 -1.8037255707067139 0.60514437995760628 -1.0680611314741577 1.5661679940212692 0.28915757018198568 0.066252799149072172 -0.45829535342021949 1.1384273184932148 0.67421863964194395;0.10514643367311027 0.42354562501812759 0.80640222452524046 0.9655655497992951 0.14597282200731021 0.21456105325627739 0.025488337255299479 0.99004140133457641 1.9322782097894007 -0.45374407881519252 -0.60301452800323718 0.35482084663670083 0.7257815740629634 0.046655408706893553;0.2902924169465767 -0.50768587263262765 -0.73469924617048521 -1.5716934785677281 0.36379829732078789 -0.20225803680495147 -0.45463043497823097 -1.1233069940192493 -2.2689539699397603 0.61851222053629928 0.86620610737444037 -0.69461649644875745 -0.92539307995468034 -0.22036560772951017;-1.0014811375668009 0.48928612477089584 -1.0264513330436067 0.49255330655618279 -1.0656872533909372 -1.2013015872974773 0.80417229631931209 -0.96837851839766254 0.54539390581723057 -0.334378610082671 -0.76816956472229359 -0.20419637395796805 1.3279471190176688 0.37394725280178986;0.91487985386417536 1.1729665405503873 3.4547020389019019 -0.40625539461285498 1.1044974740045879 0.30106822174273662 -1.0341463740410206 1.1136939847320801 2.4290499338070579 -0.04593098311576721 1.5992588761750937 0.021659646553350165 -2.5564417575353144 -0.87674815434866238;0.45586314139452239 -2.8583651294155326 -0.80099236453069833 1.4467723502931062 0.50358503995609027 0.39994829586079184 -0.62010508585750068 -1.3331870094646006 -1.2259389605670488 0.60712003315641005 1.1970646853320959 -0.088956965656719914 0.71961132774011216 -0.37247249887482375;0.61465389153104033 -1.1190586351848062 -0.37993828061599305 -0.47295830656300197 0.60324205070023351 0.38752020184119107 -0.96988414241190302 -0.12510900468144232 -0.94183107897934437 0.33822712109653452 -0.80131590873560543 -0.22197408376338235 0.59706839470461659 -1.0149122253902876];
  
  % Layer 3
  b3 = 0.96280925831821074;
  LW3_2 = [-3.1355946532792074 0.14710584396717324 -0.5904620986635003 -2.7553229580085494 1.3759073240622071 -1.0171215408689755 1.5319929783903892 -0.83415541720300745 1.8935017141796946 1.7391487033667155 0.88561681874314224 -0.20546796604036427 -0.47216928734490921 1.3663458334468492];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
