function [Y,Xf,Af] = SOXAtemajac1(X,~,~)
%SOXATEMAJAC1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:21.
% 
% [Y] = SOXAtemajac1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;16;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.2012718997092136;-1.6253585661317607;1.3731725603056577;1.3916862265303094;-0.67644833488035461;0.53940762162120059;0.48515153480710871;-0.4406718894258228;-0.19854061077717067;0.58890317065699382;0.80764836816880758;0.65950310827631176;1.686030765053973;1.7908754773391835;-1.6180574924786231];
IW1_1 = [0.40153855848863734 -0.50827893491186293 -0.53513075915334829 0.27362481221900564 0.062149277865599636 -0.0087644969294194477 0.30494206299896265 -1.0730888517394959 -0.77167224464829209 0.28137046847967973 -0.004320328521144807 0.66384308282482674;0.79545364749556813 -0.0083415046210735411 -0.46370721398569487 0.33683330236159792 -0.64446859816859325 0.29543043719594325 -0.67923317953650475 0.74313981861279077 0.44471934549569925 -0.15933410947299192 -0.45461121593106174 0.26711264123000544;-0.32450437090300949 0.59560948410794512 0.32079167631636663 -0.79445218663384087 -0.6567480443384055 -0.3380741588393823 -0.66711828866556666 -0.45140080749848199 -0.43209489866438966 -0.61556077017878175 0.10302100231454915 -0.29980509442003722;0.27684782164876198 -0.30164502172821311 -1.1430148617247402 0.10161812338742499 -0.50349006837963939 -0.26950494464359037 -0.19384609677690495 0.8231747399034105 0.74404655966889999 -0.13545268231167529 0.81282208107351051 0.35890069367953298;-0.30589644130774668 0.67008168815367286 -0.66266073863645114 0.62108348169594541 0.47055101725985943 0.2637296712295813 0.58920552910438906 0.68193979136746286 0.17163982374136813 0.074366911052558368 0.50245120841959812 -0.25241197793799919;-0.19673649409024022 -0.15348939678046278 0.16272369383711185 -0.29996748238734167 -0.15709418797590249 -0.84397720874868376 0.25504913912181681 -0.27435526915621511 0.1429319058109331 -0.90574026475111979 -0.24559733195922731 -1.0706782857527857;0.257674865550029 3.3948529524816342 0.16468428274164856 0.24162716881535584 0.23311231816062772 -0.031065518778553392 -0.26869898414524568 -0.039916658390968779 0.39658681040224264 -0.16566460005410055 -0.19746241015151622 -0.97823217088013958;0.09105342316569022 -0.14172695540870056 0.11615704660864144 0.414448229755636 -0.35122327520543067 -0.35519594405082699 -0.30013494128386942 -0.78264515296310955 0.33488857269615407 0.074828520183125205 -0.41245851004656314 0.37496292858392305;0.014980818987741866 0.70298584660914554 0.19795624643666351 -0.31220522645116672 0.33989925971266677 0.34152347695579699 0.040682013426627514 -1.0221180916634758 -0.55846756697156774 -0.12012061559924549 0.13926278259378289 0.12384655415157797;1.2732494875423144 -0.49811873049798833 -0.5607819795949075 -0.75900654954682434 0.037472709350322236 0.20665405499095482 -0.1446175024446853 -1.2347516703371293 -0.10668457116397886 -0.12042590609058478 -0.34303457132658532 0.10142745597811516;0.057627253223723411 0.62135593578747639 0.25307189789001372 0.24099034360186672 0.11748853646197996 0.11641697196503593 -0.17898913680859768 0.78110005692749485 -0.37170653372229751 0.024971200401020043 -0.1224047285082298 0.38752047113467825;0.67492788369885459 -0.056280342210359914 -1.0793074547475963 -0.20571024839042379 0.84558090854736223 -0.045231396534016699 0.29566588430124358 -0.69069513146062889 -0.42379898309059638 -0.16458544979582804 0.044812340359389941 -0.014061774262031417;0.59445491827682995 -0.31598856668670389 0.017765395302625858 -1.1598791877174659 -0.54893761839093724 -1.0474502536791146 0.43062340124829207 -0.17110843642765036 -0.50063558971093935 -0.57774855113705115 0.8595511641834267 -0.10942972259475629;0.4127006560775956 0.42653768792748209 0.72702751050773939 -0.09393147520201954 -0.3927139822154731 -0.24965972005945475 1.0339321539151209 0.025785036813803341 -0.14883452721071311 -0.33599515607743075 0.55185925645347456 -0.65567666233542254;-0.16770845363160547 -1.2346310704968539 1.0585577242498583 0.20640236505257264 -1.297772491848677 0.12224475100952112 -0.37942183227273624 0.5687021544366202 -0.69751813547414643 -0.050492174703948442 -0.94290165402144621 -0.0076148395316751275];

% Layer 2
b2 = [-1.7307101303363832;1.3992144861913742;1.1887176145026821;1.0669730766322025;0.69707633187380269;0.21334284320654312;0.076441285113028903;0.07769195895543396;-0.56462640631984762;-0.37554908720644398;-0.56809517757369687;-0.81018851027867578;0.86440721399118159;-1.4500901999989182;1.7024061628956653];
LW2_1 = [-0.022599719517640036 0.43605766845273258 0.18230686216448888 -0.047963863499825898 -0.83407725721746584 0.39429607799690192 -1.67135483343299 0.71371542529199139 -0.50952373502065218 -0.15186983092370698 0.32355471007794834 -0.34161558804159287 -0.50731335764599828 0.50311445430825719 -0.20652323186695298;-0.3579675206653144 0.37078852456593842 0.63410808659265239 0.70125404551707615 -0.27083888395724459 -0.59888801183373352 -0.50652341838960613 -0.46476982090564006 0.35900428197827206 -0.30112754518825852 0.76372334169386003 0.012993156064083414 -0.17750968534663519 -0.049451428113302109 -0.17796970264054421;-0.11246569552305731 0.52390408607527605 -0.21794012165348192 -0.61499868128014212 0.14357207411242376 -0.55252227201910165 -0.2729783642696062 -0.20423741237855975 -0.19409596421121961 0.39423143387408816 0.7879295394641771 -0.23618794767915188 0.52619669320711782 -0.23127157966310258 -0.70570866803337817;-0.17490035776941334 0.022999675296792706 -0.28428181678775277 0.16246343791619761 -0.56428635805581984 -0.50068769037472516 -0.61322927371653824 0.69062136277942532 0.15570135693694417 0.56349419122668787 0.56360847185386187 0.015154025469710038 0.16889249283798016 -0.029326272098298196 0.27104772432064533;-0.43274348161792253 -1.2526294813884653 -0.085451175586365835 0.61455484244746583 -0.45569357264022686 0.04378469537817644 0.40042129604870214 -0.29567225876422915 0.57614672278557311 -0.21092068018307697 0.039219014097694044 0.83777016045921027 -0.37854957902875058 -0.2727695287532918 0.25992126098022045;-0.71772525724583924 1.3761550225458032 -0.51835588363972795 -0.44805649905517531 0.26530633497848632 0.28183004333194667 -0.15585981688187289 -0.593196803037919 -0.053082624740573438 0.79360767033198343 0.061228520658981843 0.45466856287602436 0.38940470781915754 0.62206956570789118 -0.14725924059867054;-0.60865635716736477 0.53600051032339435 -0.41584686058842146 -0.062329235938693175 0.87428286217351669 -0.034448637429937874 -1.9624328590193565 0.53853945150573623 -0.82085614956962161 -0.10509972267965957 -0.39975629096769583 0.43142260851988185 0.096741876330616802 -0.052436520112182756 0.045610668751592795;-0.00062452957289901466 0.3832070770919459 0.57161160522709364 0.15403427097834566 -0.48687099535260353 0.56441563531705419 -0.62508362105974546 -0.4795930840527981 -0.39410520870299681 0.25857302461795717 0.43961180114217796 0.33985709386405194 -0.10475941853443088 0.13122445873460847 -0.81587380897374251;-0.93350122467717467 0.80004834024923532 -1.0843832324632519 -0.38532362951513532 -0.36034966735716845 0.17694947900461763 -0.48907877479834927 0.86649958710910824 -0.95089435897137597 0.31943233345662503 0.99321848461880369 -0.45056315182830503 0.13091436136159665 -0.02650500709040024 -0.67594151167276029;0.10978227270741807 0.30732680413433622 0.35793930559821252 0.9082069725091495 0.28603545841456901 0.84093751587900667 0.5173960310497544 1.1432094597757141 0.52606791354620752 -1.2406750155180655 -1.0172924034704911 -0.039269364883462853 1.1361492282058101 0.58533604420306284 0.37528176408068842;-0.5371763338218839 -0.90195480187466925 0.40101575192625349 0.19987428576210634 -0.45928849171071806 -0.25255498485948735 -0.15159378535380566 1.0524589875257551 -0.088238552715052626 0.067562721345152052 0.34157710836301336 -0.17977645989829816 0.051357374406660661 0.21035487630845009 0.094079945555848393;-0.48297828224144101 0.13054009372309916 0.11516762677235332 0.32138550891864892 0.24120002574324004 -0.33006168570750005 -0.45280096056886926 0.55188878268136188 0.77815492425937094 0.16317994326333118 -0.44712862851588664 0.01186308444057107 -0.43813914973928519 0.67221891322582039 -0.28813342793163299;-0.17549609061729562 0.73594439132047151 -0.487571911366672 0.16078047535133938 0.46633249376169955 -0.62232213903974876 -0.21860420572647346 -0.53083796086793045 0.6139518887779728 -0.3332623853519352 0.48745520894607619 0.20594221132872811 0.33208551895862815 -0.90818685010543221 0.35351461320799754;-0.22158657609409335 -0.64599848306162855 0.17284420704863004 0.007922816220396714 -0.043331950508486192 -0.77807562807912012 0.55785662379316325 -0.32284426567262392 0.19897138261341793 0.52685871277257867 0.60855472418866841 -0.32300535496912114 -0.42394611493330597 -0.37841335786948677 0.4057495576431393;0.59687607827157962 -0.50457833725499213 -0.44571539608038457 0.5299067807529535 0.11433801823859509 0.59930595162174227 -0.54271099604137107 0.11887235994113456 -0.053105741470679278 0.28939609369708025 0.52592179198047384 0.17062311202880964 0.014154944895919383 0.48306121587700035 0.61532898879523812];

% Layer 3
b3 = 0.80938564723948303;
LW3_2 = [0.93737658537882174 0.4776228453526053 -0.20029180841754313 -0.63007630553531568 0.52915979425442405 0.60170449581476504 -0.81880744051925114 0.24553208709397523 1.5435846254546397 -1.4527743444465664 0.78612841330769967 -1.025986194280633 -0.49313736783430784 -0.043092456465251658 -0.46660218565168204];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 166.666666666667;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
