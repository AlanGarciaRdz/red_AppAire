function [Y,Xf,Af] = NOXAtemajac16(X,~,~)
%NOXATEMAJAC16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:16.
% 
% [Y] = NOXAtemajac16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.04040404040404;16.1290322580645;0.0210748155953635;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.88012108428808289;5.623424383798203;0.28865149669518053;3.4149263377295913;-0.57148930689545729;-0.15101562073895056;0.2377084063902597;-1.731738432518984;0.27433429830143935;-1.1534236651598251;9.6374055230234639;1.0014868261085164;3.1840944120960524;-3.7916926380461851;-1.9099108068200257];
IW1_1 = [-0.040133426364828036 1.0836953631379664 0.2228091590693303 0.4473044816048975 -0.75890875669095592 -0.44093463507468716 0.0092707441794630963 -0.43097616882197104;-6.1888571276831943 -0.7444136554351487 -0.40566091269799137 -0.57312735978625973 1.171498064678385 0.99579864371849658 -0.066475627437144094 -0.24099901814394756;-0.92550499322857116 0.026225837227236266 -1.0307627076983548 1.436635071532977 -1.86081898810934 -0.91176428233449436 0.26261614582123288 1.2027078966480138;-3.3748968885203965 -2.8965206109568542 -1.5131057497334504 0.18323769429219622 0.55278607283486481 1.627344271910464 -0.2775540476649232 1.4694777593052892;-0.032542347787358289 5.1018875689507581 0.20398897383754067 -0.64528644662970636 -0.78321388005004522 -0.024732649904291658 -0.14908103681500201 2.652972427210857;-0.45197804787838941 -2.2678499717486558 -0.1893026689910752 0.23233681532763095 -0.47577750491820292 -0.31643241947119322 0.13133918560652583 0.023847623147338251;-1.1575779057817188 0.70618522041813359 -0.8169405178445277 0.98499213067156077 -1.498145084112025 -0.8911343932778385 -0.0045655091378577163 1.7932461806225046;0.71902294192394889 -1.5763779373189091 -0.52399240121934199 0.042345554814921943 -0.054024845304014524 0.27584303485822664 -0.14942691935723373 1.0523654980040082;-1.3023881889925202 -1.652582770976756 0.093520836722113865 -0.29086129064201971 0.88237879113849915 1.5628408615060598 0.3607240149975009 0.21092098609081278;-0.010969806354982427 -1.4797407368947992 -0.54264413570210512 0.0025789023465678977 0.19501809250339799 0.38017770890694563 0.17534691080131509 -0.68844007052978518;0.48705718102947337 2.4572454164128756 9.1909015342705871 -0.21857945457632463 0.35601007180306976 1.0903722294454443 -0.096758297935198259 0.75462063819182468;0.7024322392075586 2.2205252336325989 -0.26453668088821913 -0.26726390847252401 0.49465104798514042 1.101868825543836 -0.17445947034183629 0.98122442341671379;2.9552056075430535 -1.0247582335019321 -0.15418132066966178 0.54876269826421953 0.64619933957638565 1.3567126213362082 0.13745308148642857 0.45347416375894156;-2.0077276873012395 1.1395938174582232 0.35369119662103998 -1.6340414882012653 -0.72454539525412442 -3.3902808761892302 -0.306382820266758 -0.56059455434178818;-0.84276628328158698 -0.33839161680774132 1.0681169047623029 -0.41505290910663351 -1.6010882473742025 -2.250593320769426 -0.54796642040866805 0.041331352670420027];

% Layer 2
b2 = [-3.1250701701916821;-1.6719338927672405;-1.0547188746267295;-1.1561421931656346;-0.5288921676418803;3.0967060345846291;0.66281519059711624;-1.4708960913049376;1.0202332347375636;-0.3750478717183619;-1.2107975331375322;1.0075093619872086;0.12426898208768744;-1.528366686591105;-2.3677291468131352];
LW2_1 = [-1.11881154123106 -1.683042508073324 -0.63082767987698141 0.036588354762730556 0.14070939246774603 -0.44582306419440804 -0.15793546610177656 1.1898600743261705 -0.80220484727707031 2.0687046854593061 0.28364284955406449 2.027319513874537 1.330967919972414 0.14402654909492349 -0.65847874037013354;-0.18899297561852249 0.71943775506003627 -0.93716616342795955 0.85147102654654649 -0.73746880216907051 0.37780773160449693 0.77201835290775767 -0.47407711244549761 -0.29776943215087542 0.13621785910934961 -0.16139612112898075 1.8149072850230585 -0.05103135517289914 0.28687028583754776 0.37503305628649614;1.392393854464643 -1.8155734624159459 -2.281186915661948 -0.42841091627008765 -1.5628654376609072 -0.10881495468549761 0.20651626145189395 -1.1645548074193453 -0.54287920272473811 0.62959161890050774 -1.5911301982998802 0.90834514574408165 -2.9641677279340195 -0.47722186865714877 0.26553656431832606;-0.87615979670832711 -0.43616111820381653 0.31856894399957153 -0.78519608341282576 -0.64099927665391143 1.5019638901997667 -0.90370976753864385 -1.2852179877342549 -0.78524246033072542 -0.43024148732903028 0.059296601234992259 1.2171222042567664 -0.84890645055113556 -0.58452535398039884 0.13236703714686066;-0.44706058082223871 -1.2427037128758602 -0.80220568656530189 -0.59843616903730679 -0.14531512790407969 -0.87065910946235281 -0.015935965033432413 1.3825494736970521 -0.50030067782171073 2.0212570418358462 0.34816610725575942 1.2235696075035976 -1.0340810036193839 -0.85616007111227299 -0.030542141521431622;-0.34497168970256065 0.44979188130143616 0.68125810777074869 0.68275078589585836 0.516308523313879 -1.5529135494100272 -2.1382068262455305 -0.57577622228630798 0.25901509592532002 0.89153923608472707 0.048748170608729151 0.43607803271938228 2.1678981137466198 1.68374651608759 0.16690953345698112;-1.326287907782707 -0.86901056463591242 -0.36459223728672568 -0.92823133163755023 -0.36574660794165736 3.8664738054565042 0.35328862258931121 -0.85335346915559251 -0.50231690043766486 0.48599943146568569 0.43996801669275526 2.9950621794546466 0.63883349464122174 1.2367615553505511 -0.42895545332880569;0.45130921258345424 -0.57733819634680272 0.50525331867350332 0.29819061992564005 0.46490469088175379 0.22822739150417665 -0.55404687720599322 -1.205891103679378 -0.33803794831301498 0.94835898665588259 -0.94858430535412885 0.6958407096951722 -0.26263891607574591 -0.23254500768786829 -0.14622236107238129;-0.55379326683734886 -1.3249861371635854 -0.26756124959037575 1.2455405542079379 -0.11569388759042505 -0.57007723941158817 -0.25944347904282467 1.3536340061360748 -0.53664312987434037 1.0443539741991832 0.20211020106794669 -0.61737946670269161 -1.3667428960891332 -0.69098374258280471 0.42855003289325921;-1.0068740913056764 -0.49298394657222205 1.6765186047702223 1.5669788776343818 -0.12206690671305041 0.63323294604746294 -1.7097013017140792 0.56339307209727818 -0.11457895240489997 0.27614745630323856 -0.28769587643218475 1.0680629642412625 -0.74197252192084917 -0.22988533954236764 0.062490231064611962;-0.0029454548787159474 0.27794791881197667 0.2196251795597102 0.75428930627504298 0.66088956880808047 0.93091484035851768 0.17023275257775572 -1.423550652472966 -0.012994614221758139 -0.44793746580836769 -0.2946329112269801 1.2564098188487602 1.350999176089601 1.3193703666016172 -0.53112545828418822;0.2832814228545899 0.86734035904690998 0.43011928710570585 0.3314121474993913 0.88764052730033938 -2.8875854505393646 1.0111887874720731 2.3722444009053545 0.97662693427209502 1.3710666788778814 -0.23150554864802345 -1.3895551306624827 1.2107105364403088 -0.47416301164939773 0.41681487156497576;2.0068902544552834 -1.1901983673848342 0.12317091465308258 -1.3199688867194677 -1.1604118265599828 -0.8153038133981988 0.98606325158684571 0.79351565005665226 3.0230513957458132 -0.74420569662522584 1.2199168418557207 0.061931023908062557 -0.93695426721813746 -1.8899922540695293 0.21666176481551105;1.3866248113264388 0.66213639724713269 -0.7146343646830009 -0.56576573313623402 0.50675637159698106 -3.4036355515771786 0.7621739745899202 0.6030685235591261 0.57223766580332402 -0.73171482427370071 -3.5338598111662649 1.1496986997820717 0.0068700401908876737 -0.08902885139875899 -1.2822161817588862;0.020732377056549588 -0.96918681675600427 0.11030714882739723 0.68866070395781176 0.42261273074199662 0.039051596948849625 -0.4623476528566417 -2.0938273744390901 -0.32004434451885627 0.3457701513994369 -1.3111460859386903 0.88110203401847198 -0.26473372912677229 0.73992881200597249 -0.90328512517312221];

% Layer 3
b3 = -0.31971297377831415;
LW3_2 = [-1.377087635374143 -0.43301821160445952 -0.995260359287643 0.90028316626610294 1.4460175031410483 -1.4200398557261591 -0.71177575448414898 -1.0908201146164311 1.058431411863898 -0.54033022944870934 1.2815133807447134 0.50619353587641869 0.11398951877053767 -1.0687018749814452 0.96607873703889313];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
