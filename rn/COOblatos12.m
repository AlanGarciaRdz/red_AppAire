function [Y,Xf,Af] = COOblatos12(X,~,~)
%COOBLATOS12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:54.
% 
% [Y] = COOblatos12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [-5.1708951266411516;-2.2711987023315334;3.451505684246138;1.5032198175599307;-0.89813352396851986;-0.58648473814408131;0.25990371195455064;-4.6275208977556979;1.5313361959189045;-1.1866664260536155;0.68867627730697745;2.6742614852388549;-0.18476221840329626];
IW1_1 = [1.2973700325489019 -0.75951381015383068 0.92293007412201045 -0.8926259842968548 -2.3050194768962413 0.19636845235262862 -2.5499372396836986 -3.6813857736925804 -0.25013493483679444 1.556901641316367;0.41793321550640594 2.9484672318371414 0.12577953445142812 0.021972609071470018 -0.069355049587918327 0.042255928964526582 0.12622420131062195 -0.42666829420757912 -0.075152803495627613 0.33726189785725452;3.1779698222761299 1.0763511392589697 0.28696314835026276 0.4414506429955804 -0.91715751373225296 -0.2072285415985215 -0.33834641167566043 -2.8151013309448576 -0.12048066356336307 -0.11855070784895674;-0.87736482737527477 1.5361073509415406 0.12935904329040618 0.51298750325045184 -0.10232506660618002 0.57820821943324852 -0.28811555990590171 0.63571173285466342 0.047510637236706128 0.49775979878018273;-0.3416422951584186 2.7795548254697136 0.5645883625881355 0.16590478623386279 0.01101229807894049 0.57261410004335889 -0.076711847733776414 -0.29327214753184039 0.03009423763273052 0.11614936496984267;3.052950693065335 -0.11369130774472765 0.027270155343121282 0.15651403261543476 -0.39447198165554859 -0.23346335854525246 1.0628314007069692 -1.2372535993523979 0.012037284909510153 0.94461582724566073;0.38350621303095794 -0.097900847509631836 -0.18572376654487194 -0.056031166859924278 0.52171942573851426 -0.10658895402803095 0.37920394367744426 0.065749691602276533 0.063556806555769813 0.28691358662536426;-3.2517390453487387 0.5869949357332459 -2.6516412123761128 -0.1171660408312855 0.43904349814464894 -0.70330711263393353 -0.14196206089049335 -4.5960645695199531 -0.2340604145881171 -0.034254183856492815;1.1166888001351223 0.66550065525313817 0.48199335471072668 0.2167542255422136 -0.57838426174415103 -1.0129871879445176 -0.094603881179233004 -1.0785064509052364 0.13597347850035743 -0.065762230179276002;-0.48378776272417634 -1.2051333221833698 -0.46295004377059584 -0.22060714896940323 -0.65604275621506636 -0.58928924747947442 -0.02538810259112087 1.4484971295744358 0.095431739252358982 0.14754248055586297;0.17561570235847651 0.68558346882838594 -0.01565915727698701 -0.18378100206972733 1.6172364456061163 0.30022379966915019 0.23691970105640975 2.6971626018807844 0.12363841192463068 -0.35862180505751878;0.18596101759803746 2.6889077873598377 0.30586438076197342 -0.23257693161925339 0.63741534889076257 -0.19518653613050471 0.2309064256235393 0.32331391212435734 0.14971023672319375 0.4880865824101972;-0.59773087357364918 -0.81459291922020294 -0.10996308177179998 0.15429652483736817 -0.67766418311225862 0.6678581804189262 -0.4038026276716809 0.13240922621050522 -0.08672458096724428 -0.16001092385921395];

% Layer 2
b2 = [2.6664920169786681;2.1909889159764706;0.84765987329820491;1.4951046443720848;-2.2746819510237222;3.0998148826242944;0.68554251842930036;0.768534271001168;0.38093172988220209;0.1853666307964093;0.83474811738644872;1.0122639023383118;0.80876922080327207];
LW2_1 = [-0.14520721807413764 1.7852629925848691 0.18472820717933622 -0.081437970736114376 -0.96102404368189165 1.3797849839569798 2.0346618599222994 -0.51462412892535936 1.6349614239727455 -0.99097412636807047 -0.18790234409031975 -1.0963850000162501 1.2271697577716569;-0.10603255599046123 1.7574292349618104 0.49329627018683664 -0.34414365460771051 -0.87860400486438495 0.53226244453446026 1.3874221532807944 -0.80397221158191134 1.0526130894594286 -0.83383912308196284 -0.30683097655515923 -0.98633743626462189 0.64510655496922431;2.0179938207023458 -1.4180085473964084 -1.2482813693380099 -0.6310564462075281 1.4950635202651021 -1.0448647190334941 0.16530321369272907 -1.0329818719019823 -0.15939490565849393 -0.16771863125709061 -0.82535245745395869 1.2461468819518065 1.8391160460854099;-0.080501291214653117 -0.17182580705576014 0.11622376391476727 0.79496033340657757 0.68961464602962852 -0.19436178286203401 0.29411576876191203 -0.067886692636301163 1.0158334678297629 -0.14990613741345593 0.3486717645113997 -0.026755043234815257 -1.5378712388810023;0.51427639443867146 -2.1515723484314515 0.39278431995419893 0.12584275981092849 1.0123223011658136 -1.6711506239930591 0.65353446088304257 -1.0517877009093899 0.64614219119746341 -0.30057776718979434 -0.12699726074617496 -0.80699641118020915 -1.5639504946039435;-0.95892095151921442 2.6927590010847537 1.0305622311107394 -1.7183689087371734 -1.4453222464036382 0.63517809623757726 2.1977046920860412 0.066665219583350921 -1.5910547959524435 0.40618424512330142 1.3375777786658491 1.6069784694397793 2.6572970609107318;0.3464112503432899 1.7403673436674176 -0.91503745512600954 -0.21426933224705416 -0.92235033455269988 -0.49267735394816159 -1.0252257525308779 1.0842249349213469 -0.7734319916120117 0.040051537242103918 -0.47974340976839891 -0.052038709887724778 -0.36887737495338524;-0.45431642432846608 0.7537015875109303 -0.32708400680793381 -1.040631997901887 -1.6051675881907101 -0.72300222524004876 0.98341853080457509 -0.5164464759620081 -0.19597274700984813 -0.73091193092487872 -0.015074308881907845 0.97421288565686104 1.343973876329986;0.14773586214488355 0.99112753890421923 -0.54972400514895881 0.22824934338832048 -0.089009744139146516 0.29007985042392564 -0.015102866510111996 0.49496471003352094 0.088049737832136571 0.22498559377512675 0.13260626139635973 0.50161233534735961 0.4370765935992762;-1.1383634624717305 -1.1538446669757283 -1.0460960105803052 -0.69477667748416494 0.94319598854436237 -0.60192664816734309 -0.1136466809529534 0.078568271405840981 0.060793783504995189 -0.53191734888781139 -0.26181146444522357 -0.9144933793728256 2.1124494615979135;0.58405709717717957 -0.82337087108905405 0.20999574317416619 0.093294378808048167 -0.81883316669382555 -0.11982155789407327 -0.68535555978491702 0.11912023849671943 -0.10434433450292915 -0.12582050444254253 -0.049734388102780427 1.0696342781995904 -1.2072742377668442;1.1911315525045663 -1.4155204966022743 1.5170260695791558 -0.88032235417855131 2.057765139196849 0.76586017494195702 -1.6551503094118278 0.22081610647423022 -2.5671277488828914 0.93923173514826375 0.26233245972503783 0.90969777235859084 -2.1073408662241455;1.5253156083190254 1.1625959773636731 2.1709916615631455 -0.36461669195244245 0.69378215201514193 -0.90614984884946814 -1.260111798843067 -0.37649294127757271 -1.1337223533493677 -0.18016062998842933 0.23154106568482188 -0.59750084795212055 -1.8275527064540125];

% Layer 3
b3 = -0.23226214827552166;
LW3_2 = [1.6193860024273119 -2.559331304489195 0.43771529345192323 1.0096325883809327 -0.48897669190181881 0.93784087315385101 0.71225430234495313 -1.7912536548735296 -2.5191095398013923 -0.52036016323831236 -1.0508522467832329 -0.82562504306620976 0.63272373114354996];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
