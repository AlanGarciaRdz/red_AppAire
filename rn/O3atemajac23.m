function [Y,Xf,Af] = O3atemajac23(X,~,~)
%O3ATEMAJAC23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:37.
% 
% [Y] = O3atemajac23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.201288244766506;4.04040404040404;166.666666666667;0.0561797752808989;0.00614628149969269;9.52380952380952];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [2.4218835125818003;-0.32032975763842397;-3.150875674006965;-1.2498024266622874;-0.83329556350035716;-0.047687503703223694;-1.6251008105104134;-0.97897204231974455;-2.5270688980630398;-1.0115550267434616;0.51776158622653679;-0.18289035623446351;1.6214367886536698];
  IW1_1 = [-1.2691080961319088 0.53797758394111361 1.1592860644912535 -0.4695420040793466 -0.31941695146170734 -0.67086898785142535 -0.10488542405618367 1.3113601140757785;1.1146746259582134 -2.3003780088929 1.313902988863803 0.077312073224689096 -0.19373779723328569 0.68647015398251099 0.83624911096123267 1.765166584862095;-0.021967784004217582 0.5607746642610294 -3.3139702623459137 0.7080857757019654 0.30905212277214922 -1.0035640973686593 -0.29768762669364596 1.1768035299661759;1.3774166126244263 1.0516268970021936 -0.064761402495066123 -0.13335209557526886 0.32413606319391725 0.30160909824065296 0.11661838534139674 -0.38517745916306428;0.41779624194112952 -2.1116624632570327 -0.073493592960998791 0.81100317815593015 -0.42418527784346383 -0.25746650067345223 0.28822703785423492 0.057894572795312703;0.22276705343967163 -0.98597163585153857 0.38962499234094194 0.1947142731540546 -0.46225074525239634 -1.1155410335128988 -0.12595521508928187 0.1457296475451651;1.456435548173 -1.5592691161490853 -0.11921417218383579 0.26851797108587233 -0.13610326798189959 -0.73101741798091469 -0.029912250676428057 -1.6090755757690607;-0.78918202574943663 -2.4647800787221685 -0.17208406506865542 0.36053026411598726 0.76415460607218133 0.94805951104591868 -0.12496729958292584 2.7622793274361874;1.5775787247319228 -1.2270805141123446 -0.453162593067024 -2.2124044967090879 1.1454641578528051 -1.957573831324867 -1.363155333758064 2.4744699203583038;-2.7078766866368498 -0.20161340065294558 0.35659822918883033 -0.28722594873938301 -0.082280180440576473 -0.47957162119424651 0.013042515868021442 -0.62207593416261853;0.99952994075962986 3.4037381458938301 -0.8198191985571881 -0.51987679153682742 -0.039308625511448272 -1.5670220728188442 -0.11259742640103626 0.42248386165128882;-0.80326556548567507 0.090201727207327151 0.93680164019971968 0.61059711582421194 -0.70786437295845228 -0.64815220207302571 0.012037927344842821 0.015192565551228512;0.83240794352049441 -0.29936462208924197 0.19534582590388094 0.022539496094828668 0.10538595638585034 0.023667986297251163 0.039094209456845358 0.23169455604137329];
  
  % Layer 2
  b2 = [1.8730469776381213;2.5389046798508805;2.4372225338765121;-0.55893046967101645;0.52660578981681305;0.65647730515616687;0.11658266823871974;0.28541954164636002;1.5943738889334238;-0.75875238402344669;-1.2925056418254801;0.67982675043613483;-1.0433247340962606];
  LW2_1 = [0.46002183255980605 -1.2104499666167501 -1.2748866783821025 -1.5348474739390896 0.2312896914293413 1.9039013855222235 2.680227273661695 0.28812568450919063 -0.019204987480385505 -0.0019947383745493805 1.274393243793343 -0.6254337820000988 -0.35647387645221368;-1.1842613941136146 -1.3642340166170466 -0.20878683238009738 0.20209104966148153 1.8652852210758326 0.099554857391163751 1.1909696115615853 -0.26929801799420372 -1.0512046624669242 -0.096562494326908624 0.80336361224249608 0.26685038895847768 0.90284894261030813;-0.49091748204830149 -0.28055407789797143 0.60900210402595478 -0.82885475147873655 0.1105195980655749 -0.51910873095420151 0.65367386586693987 3.101106545714611 -0.61964815135537421 -0.63919736489410983 -0.94290619445331192 0.63020787717434423 1.7907965119911433;-1.3517932031270841 0.24625810401863957 0.92252390111620564 0.12878030847396871 1.3879168876838355 -1.1428059624527409 -1.3304569036158718 0.51489829541684107 -0.012380115234107456 -2.936378833824774 -0.46065523329797659 0.010139135706351735 -0.69369863175439017;-0.51215338819620659 -1.1712454683739175 -0.22680394187088476 -0.76433218575700212 -1.6193798694314681 -0.30556897366038693 1.2403324674892782 1.8280321603413197 -1.3908782141797191 0.94435173804895189 -0.73007496473342059 0.66038035625529989 0.24594875067050076;-0.2418037439869184 1.0518706417600778 1.2319792902214395 1.5278145043292091 -0.91145129743771602 -1.5088692697986472 -1.5471674074784409 0.4336741919517173 0.82256829006921184 -0.23067751273957501 -1.3359193529563076 0.2863684166665158 -0.92802829334238057;-1.2222191669272213 0.26838736236571886 1.3248955502088753 -0.36051900368173845 -0.84679852119774135 -0.048230866183438956 0.22796335818538088 -0.25800951468202538 -1.0424867792867989 0.29727199719735808 0.6810969008047707 0.93281400575916273 -0.026092106210803469;1.3288775419367425 -1.2963648845621492 0.29698095395385654 1.2146368252713817 -0.43184779066974988 0.41180971262631227 1.2035778284015948 -0.15087122096088532 -1.0224357401432751 1.2235891762571582 -0.89033658557614437 -0.48894210048321268 -0.76802205231073617;0.85588754212156737 -0.5963205415003584 -0.46457707713593854 0.50789587129293234 0.45144806720752856 -0.77809420186616618 0.78986223355018825 1.9266966190345476 -0.0097474904648264041 -0.75737323309224602 -0.82074973919393401 0.043097183294525769 0.3047116067688293;-0.85990581383869713 0.7260586182970078 0.44078658428274636 -1.0695800356330452 -0.37950727535523782 1.0412596995224557 -0.3717605473857572 -1.9198726917993694 -0.45184790535683794 1.407816118793126 -0.56582886682620848 -0.34107387973815162 0.23572560196910414;-0.38040236946521805 -0.047752491284131199 0.8175206398802678 0.45882582978078096 0.58773974503687876 0.11868687152595492 0.41248526930091767 0.42945221099005199 0.3591769580778621 0.60970379102199113 0.65760785136666633 0.81044619269607676 0.085702792195402611;-0.45501949220009386 -1.5810964614905634 1.0624636551659417 -0.65639646947301755 1.835975205169271 -1.9174656864285882 0.50445540252204213 -0.050762651671048764 -0.40337271141155506 -0.21355386559958917 -0.0206826282183897 1.5397607188904172 2.0427701762364214;-1.3097602741335739 0.43988607372646371 -0.1756139612007809 1.3481964937067084 0.92552506708464433 0.93977444096849616 0.95345464469619046 -0.55043239558237012 0.90091082777166454 0.6608242059947862 0.15586265478743161 -0.10801275444519208 -0.261769258926695];
  
  % Layer 3
  b3 = 0.1939938993992435;
  LW3_2 = [-1.9483150372799924 -2.2489472516099704 0.97752435654415082 0.49686846011450192 -0.60441784105484364 -2.4980803113399248 -0.66298378804113201 0.61088543906103954 -1.6809961266470319 -0.64679156304937113 -0.43217430504340343 0.80311749574631941 -0.4527963929485247];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 9.52380952380952;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
