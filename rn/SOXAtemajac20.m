function [Y,Xf,Af] = SOXAtemajac20(X,~,~)
%SOXATEMAJAC20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:25.
% 
% [Y] = SOXAtemajac20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;16;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [4.7656090001323212;-1.093741140786767;0.74075400750281406;-2.5343725200666913;-0.72740364963261284;-0.32585355599122984;0.82281768112254938;-0.50672486384317583;-0.16751741482966614;-0.53908426957035771;1.6008973897847423;0.30001391961605439;-1.9991197147306841;-3.6067139778776935];
IW1_1 = [-1.5734959481846991 0.19343285412457456 -0.93347423236745708 4.3858003241630685 -0.435981195555322 -0.17584108508709151 0.87471984997848862 -1.1922105762894817 0.43456011773705283 0.06877025453483801 -0.50700834914037096 1.3719811565546063;0.25294146117588201 -0.33060572842209146 -0.32591208027696267 1.1394564951461756 0.3616175776578871 0.26915886334239186 -0.81227863865629812 -1.115726369123063 -1.191065767647322 0.19038547323899077 0.43184612399528788 0.71113770910142071;-1.5573689454402009 0.037316220910154435 2.4319504053754804 -0.18988898729804116 -0.74679403774192155 -0.34567144158548069 0.13952285661498023 0.7168624171224347 0.7668881483115122 0.071010220066431096 -1.245292950078283 -1.2024638033584376;0.53184861962599173 -0.98247346169204663 0.65412529762277782 -0.44569809952613565 -1.9806757483115973 0.50529950840301718 -0.77473564738616818 0.24091957149330903 0.33120988868792317 0.41026403854059035 -0.21541651478495599 0.29791624175515941;-0.19731190147992067 -1.405711990436556 -0.64922485749382164 0.53121640699638606 -0.2462764397294257 -0.23152059974820827 -0.12448830633138196 0.0064008578862076448 0.009724831930343087 0.63840072248981761 -0.45355326650693051 -0.16994476080860757;-0.90770247848216601 -0.79347029903319932 0.6066007418169671 -0.24009820865662848 0.18183656723201283 0.047346598150406351 -0.18089560683354786 0.15278393653195071 0.053535040768598309 -0.68626074636511514 -0.38421396333289176 -0.18610359660411979;0.20299662537093985 -0.37656118775499731 0.32484857928215016 0.35152722342585224 0.71011644904548943 -0.22785410917581958 0.50563455628135834 -0.71938906002865521 0.98157870947846226 0.13852231978204199 -0.82309383346751064 -0.16269108898343565;-1.5503035816590764 -0.98762997096231719 -0.045758927004109738 0.96341369783642639 0.30203412666530066 -0.68884882490887223 0.074346486320968089 1.3255244675635387 0.27252308025382488 0.16919105833609749 -0.7773057824809656 -0.7284772244929294;1.5905154807559732 -0.051683331867675077 -0.078265897303702384 -1.1623233356751348 0.067777946596786515 0.63061823523548899 -0.6080299114970148 0.41304933014921352 -0.94089995831883111 -0.0043004036280884991 0.30649454243821012 0.60227741107816368;0.29584592446579427 6.9608771326167957 -0.57396210397129988 -0.043689806395262001 0.10253441037254329 -0.22317855126809943 0.14715570421503751 -0.13346422924769083 0.70207100492859809 0.19078834279478235 0.29199118358082099 -0.52863775230161281;-0.51404851670150087 -0.52665265894837188 -0.81069441476479642 1.1621732523857393 0.021463895456444254 -0.56002893322340352 0.49202411880351998 2.0315249975617196 1.2177277273605103 0.19987362137709128 0.3606328188854121 -0.41309999162417776;1.6601263686676186 -1.4736058309077023 0.54824984242629304 0.67671412930490393 0.52727359094520987 -0.32791675404059062 0.95474850015846191 -0.15561734691422249 0.085135544321783552 -0.72281257301123047 -0.97162769554036854 0.37724308489587288;1.2256680018969199 1.1298846673353695 -0.61523859211251408 -3.0619263138356168 0.71839009416981414 0.74562335805511237 0.48179439417372788 1.4021348690086537 -0.57802845639912226 -0.55725802057419793 -1.299544638400741 1.426969029481439;-0.96955067782563276 -0.36275172945353168 0.63117491086882704 -0.8187971085639052 -1.0248311169336859 -0.17219134540132211 -0.084242281291235468 0.068513028726631259 1.5002957243865038 -0.61998948238550888 -1.376835231825956 -0.67667433844171543];

% Layer 2
b2 = [-1.7126604101297442;-2.3730791405238936;2.4578117352219562;-3.2281670386984187;-1.6911549919183559;-0.30555870750331021;-0.51838268669032594;0.26682989276943631;2.4156143359727431;2.2213020106492625;-0.44279076258237426;0.89042939463703696;2.6609142226489553;2.9147442061793294];
LW2_1 = [-0.076276262088162627 1.3447094338552044 -0.059447106803258765 1.2582374340724045 1.1189327913807123 0.47995613853132735 -0.18015239486048018 0.72929719922215819 -0.045866389070792268 -1.2933973348839762 0.92853714227509487 0.16749069352728252 0.53190239716131571 -0.4703803740775041;0.25072964247565105 1.2781124875894434 0.221314035217755 -0.2801581054960593 1.0238445417050508 0.86709928463121233 0.044123965743116847 1.8285614234237806 3.3183131876107259 0.37084735965236332 -0.059634494575286155 -1.6545698863830147 -1.2511191629605229 0.15220207711599604;0.40935817371558547 -0.84128489717145516 0.20866072022484344 -1.5253911332208607 -0.72596001485626627 -0.43909953710719907 0.050075464409109524 -0.28511587667616639 0.8723521418092719 1.2786836889916862 -1.3173494334230458 -0.045596684303673633 -0.2072133953610262 0.21735937248546353;0.21362182632051832 3.0051029364856463 0.92767920906031842 -1.6221132901434134 0.1732293696259668 1.4189724137618858 -1.204066545621743 -1.5588877175936922 0.77030502980481275 0.68431480738077932 0.76323394074905782 1.4711642045613718 -0.53217869645758376 -1.6942211599442183;-1.9190217473145594 1.132527760556179 -1.2931671980779555 -1.2120301223358787 0.78767535606863004 0.65626270399888353 1.9054773849490421 0.60717956046059518 -2.0414908810490222 0.38974180912597489 -1.5680977105635376 0.074258361623704583 0.25421991747766398 -0.011259777515211386;0.91506884563278801 -0.80776765520795746 -1.5345368206248953 0.72110874718962792 0.62577918418711576 -0.011326138469850353 0.094982795851483462 0.098710371105045949 -1.0006074006256027 -0.49825390880456483 -0.054860820894291118 -0.35495402036711599 0.49277814665888781 0.36023796215475612;-0.66236591321490712 0.29150629098916514 1.4914871900094193 -1.0728787660446086 -0.50873081472307458 0.13256486688169372 -0.24958328695786178 -0.088196368628881347 1.2884096138806784 0.45263163425909753 -0.27514420366039688 0.40422214618194319 -0.7130920455801546 -0.41599078368017833;0.7251395213881352 -0.23359243626234755 0.52385065949428511 -1.2660519031969628 -0.40161610407445264 -0.378957532233901 0.40923593806211417 -0.27776364588553393 1.0442830185852157 -0.68872636092179096 -1.042888207501981 0.36009833746176012 -0.38867769305708533 -0.15334384369098564;-0.086820369113846455 -1.2361599169077926 -0.69135300875492656 1.090834639949797 -1.4523406517074835 0.37034739154048102 1.0666601451197775 0.67083264131774811 -2.3631946546031313 -0.56815356311920084 0.059292253513634208 -0.72447972126345006 1.5037909685502528 -1.6732514400857423;4.2975873940709484 0.35215551309760507 -2.9010967796437894 1.5043571455721985 -2.6163643077783902 -2.6568425620862777 0.010350077133147464 1.0048710312482636 2.2838827028074116 -1.1846353119741075 0.15025727702472075 0.27984128134168967 -2.6308991467401106 0.8514313163626327;1.8052553005238092 -0.92762118052546949 1.4140060947990241 0.39334740680998953 1.261326054648644 0.35232031201875585 -1.9827945800405931 0.19901320847389392 -3.1185577078141566 0.29477258490176156 -0.76926015409424719 2.2808251221137259 0.62556126568189341 -0.35106051647085129;1.7623675279008455 -0.049023125564843187 -1.3204152061008341 0.28121559620905362 -0.77103215760016419 -0.65294216135345584 1.3035806445187716 -0.62503341395521328 0.098590862556464251 -1.7187797369498541 -0.17036477282889906 -0.2374839922797688 -1.242427725357361 -0.42055909623440929;-0.81379894123653096 0.52609797250398715 0.92550966749102337 -1.5195152957629938 -0.91655005534300926 -0.28057116481696481 0.48586997093033685 1.8104902284875957 1.6967954504369258 -0.21257481101422593 1.517704358200574 -0.32053000816276622 0.65197261738714996 0.010142209714838162;-0.19170295643537105 -0.24039926220362623 -0.24390070023161742 0.89339472413374099 -0.10314302331274627 -0.082900962446583959 0.47008946121825729 0.99046723849747642 -1.0716425934483977 -0.060521726693588129 -0.073856311406584413 -0.43689541238534346 1.3894420408705594 -0.10834992691388279];

% Layer 3
b3 = -0.57636224466162544;
LW3_2 = [1.0010729055920935 -0.67450208111863086 1.3448642148868641 1.3176304520211035 -2.8221129851064797 0.74087049627440815 0.78188907736362601 -0.80225877995658723 -2.3271042531830046 -0.79788957776891611 -0.12175076190612519 0.58005309302194141 0.51171990781520571 0.31442252598931358];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 166.666666666667;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
