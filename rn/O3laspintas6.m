function [Y,Xf,Af] = O3laspintas6(X,~,~)
%O3LASPINTAS6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:47.
% 
% [Y] = O3laspintas6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.241545893719807;4.5045045045045;0.00280033604032484;95.2380952380952;0.212765957446809;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [7.3153154317053071;5.5553847713029381;4.7915781514479772;3.4404197590450551;-0.58104876093524216;2.0567053782679019;-0.98332761316287132;-0.99130296773245019;-0.868380396893628;0.42795100965267974;-0.48919678838569164;-1.6291548954165429;-1.0127771640157579;-2.0673196728432859];
  IW1_1 = [0.34201182820295423 -1.7690606785331309 3.8900030007382393 -5.9148105447651682 -3.0582136541778029 4.173087912555828 6.8291566144365827 -1.9656600293823983;0.34524895420709123 0.82020070977289983 0.21214827793164043 -0.63597738559526351 -0.33084105673215519 -0.056033799474174105 0.17706988242485233 4.330830719114231;2.5517657135459051 -2.0828756302874947 -1.8978126283825729 3.137416918436176 -0.95032800442144172 3.2114842253149076 0.4039847531314385 -0.7928068823157709;-0.77514863948619639 0.51080022995776331 0.41435006778898947 -1.511999760911475 0.56966796764971173 1.2486551633073892 -0.14636077895572464 3.0633048704984795;3.3617528797206337 0.38019971079853571 0.027302808035738937 -0.27953659719637824 -0.43650050493213316 0.20748703025446891 -0.18328721958637595 -0.40751903649224847;0.90238959975450261 2.3404595603821323 -0.52696537601053905 1.8956755299533394 0.58740458347686253 1.3670641620134856 -0.59913232724270427 0.73049007161874258;0.30033652572900504 -1.6510453578190183 0.87204842637178737 -0.43102997647627928 -0.48537624570975135 -0.45582393930774534 -0.58242478730438396 -0.73857851610518754;1.4537395824164492 -1.2977332599857763 -0.17583897110335137 0.18427301556056944 -0.011147570032458236 0.010104998948558382 -0.29237061143478188 -0.18679296032825116;0.41776320643432158 -0.36200731766609323 0.99845792676297385 -0.81628885791981109 -0.86024094585997657 -2.6188234146681788 0.3604570981146305 -0.78044717001593322;-1.3029917095469583 1.7695451849448811 -0.93030625334774697 0.86110180776122314 0.53304612012472896 4.8940856341692394 -0.49637407975912651 -0.99878136803373574;-2.5965957732323814 -0.14708819345016494 0.070525896094521021 -0.072877195222579114 -0.025749188192566261 -0.10027084622733572 0.12990561039737433 -0.028193797816260906;-0.58095739740438923 -1.9021505540720802 0.0062466436986846063 -0.041975299763491278 0.24579249345974374 0.19425044854153589 -0.1152356449383832 0.26600664974070232;-1.4368810022374821 -0.32767973192031569 0.19245064402239209 0.186468036254924 -0.015864341864402373 0.046124931260436181 0.088426124271728967 -0.047051178313570099;1.0647097747231915 -1.3334431526407164 -2.0717592996216827 -0.28314759611463314 -0.45289655925083983 1.0115068540099954 -0.26307074701663047 1.556085111499212];
  
  % Layer 2
  b2 = [-0.13283500938047804;-0.31178410270669854;1.4097528318077261;-3.7233476783829511;1.0262493437872522;0.39614282771344528;1.9735018508150561;-5.4588067506580442;1.057589441892713;-1.0964340840678439;-2.7567743003728227;-0.024559612756794025;3.2612833828674024;0.84215941858274512];
  LW2_1 = [-0.89042514847217979 1.4401567311635448 0.72314227143918497 0.12903196955083601 -0.51352494510764313 -0.20437286764327361 -0.37011027366295468 -0.12930871651545306 -0.7406969784352605 -0.67195507307755742 1.1112186812156473 0.94400235585024661 0.72694382464896945 -0.26104761128179566;0.10888738185796958 -0.35789438102891274 0.51756657576265208 -0.42425353404974786 8.0841406813320464 0.83249734731674119 0.48655380450063429 -0.45593371658009063 -0.65913097370598495 0.16631607053984998 9.5882995685889529 -0.55327447992360257 -0.13701535363486386 -0.43542507310817014;0.33687099992743774 -2.3605217259697056 0.31791079974708214 0.33956798293145612 0.81805832651807331 -0.66427774372178339 -0.7321109250365635 0.81460505280535744 -0.35519356449135525 -0.32505582588977633 0.35576440933993458 -1.2413195472628491 0.43096822061641854 0.19966019076134875;-0.36856471693657777 -3.7513059927880392 -0.68651579297794818 -0.1329407006384081 1.4642822250804448 0.97534325635420327 1.0377621675843058 -2.1944566799826304 -3.6523613132197545 -1.3223578000667389 -4.2528814026994946 -1.5825905649524508 -4.410806366700128 0.96219682908759985;-0.43114612493411153 2.1440475007613586 -0.64131335381678645 -0.70701079262378974 0.47817079209704899 -0.29369110767413331 -0.39273440520816616 1.7140891666578542 -2.7450401244932148 -1.4279722988064238 2.3602176603818839 3.0708661398232167 -1.2415830285385014 0.033185852085251273;-0.54232852120795683 -2.4032984037187042 0.25644623755510004 -0.33713344395845568 -0.038792279703631097 -2.1030728985744194 -1.2196138589977101 -1.6864055667970008 -0.73009896026365062 -0.014531568527048525 0.097894884607801977 0.31176736966417046 -0.068232270952827023 0.8934606037133106;-1.0271616584650538 -1.8114874182523437 0.60765375139895716 1.0636307416726478 -2.1068320443126374 -0.0044853692233242258 -0.85918710695669798 1.6446237763944256 -0.023765850490913482 -0.9192718060946482 -1.0830954393333334 -1.9552834776220844 0.97322630861967874 -0.087209967522354839;0.33596159955385818 5.3663627640063076 0.29196897064707522 -1.5351696478158563 -5.5695023566679724 -0.25340648723245568 -1.6128657700527846 0.75697000349201604 -0.16899972896161036 0.25602285909397637 -3.6871853286566534 0.2023656484265931 0.21925745342291902 1.4337067833435531;-0.53940575135828617 -2.0137647949144304 0.57731216275038011 0.4981302695602583 -2.3546031991469447 0.1374694109852268 -0.52971718093140585 1.2238140916526841 0.87889146592197886 0.13255217885189591 -2.2066282190984268 -2.4200818524462266 1.3428404107936587 0.089100642539979416;-1.0277893144502377 -6.1749174502690041 1.4219175470674823 -1.133631869137995 5.0215749088625552 0.90329286476561388 2.1633144652052572 -2.0826698568819575 -0.35694204338096014 0.078800072665495116 6.6580353076129253 -0.017068661834417548 -8.9849822867466731 0.53765050110976342;0.93149623214859067 2.7962779216257063 -0.79188834094078853 -1.0902122284475118 -1.3899415484614932 0.27511444005999314 0.73846818350281906 -1.1753610228594047 0.93492470083857626 1.2732020932340642 -2.3771709675958634 2.2258110249933249 -0.70060139653438924 0.096458235713051663;1.0822569511942499 2.0213984743893132 -0.012750918430099584 1.4509424499188854 2.8412097967952059 2.7300203454134699 1.6741112280686059 4.4589900065539734 0.82841087713384853 -0.47752650421511467 1.5676333458249925 -1.7074068222056871 0.71027411911981608 -2.3732030474035337;0.85186584080763361 0.095017205286018258 0.39194836773059188 -0.25532486858592457 1.6766462783999383 -1.3634174406208563 -0.81281621614118271 0.80052701037343255 -1.7147622823817541 -0.83309458684777826 1.1415740908277408 1.915903870007557 0.6075720478146649 -0.0028603067196080207;1.0319352493656579 3.841074443689187 -0.95803352232968997 -1.4738223003641215 -0.57978739450821426 -0.13621038345801614 -0.091001227168937854 0.6004214250047708 -0.65969922966893457 0.63729547423048916 -2.0663137024836473 7.2523479281581231 -3.6289616278549248 -0.94795681768382845];
  
  % Layer 3
  b3 = -0.20049446940156615;
  LW3_2 = [-1.33644923970699 -0.4930728981423399 -2.233724596772797 -0.23185510104927284 0.72176647376826686 2.4426715797752188 -2.0384962292452689 0.44130507166580646 1.5614483959759324 -0.34550275506805472 -1.7919467018594371 1.1837509438274767 0.85131882177503737 -0.32849964450918723];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
