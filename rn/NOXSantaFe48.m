function [Y,Xf,Af] = NOXSantaFe48(X,~,~)
%NOXSANTAFE48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:53.
% 
% [Y] = NOXSantaFe48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.812749840264599;-1.1531116751309884;1.8954019218493241;-1.0721295301694398;0.65363048525313749;-0.070783553271730443;0.92801074825898466;-1.2189495382426085;0.075941135885858324;0.90701023747969178;1.0363805589447044;1.6188627850443296;2.1896661231007597];
IW1_1 = [0.68518350369675018 -0.16312126478603448 0.69109495962171064 -0.66209405899976237 0.31871411220875778 -0.23315972503783938 -0.11106685902142573 0.27718760925010116 -1.0219067339102357 0.43740678839856495 0.18461047142832784 -0.24748246874903213;-0.34535547070570438 -0.1781219275721791 -0.31246950978264909 0.66272274140984033 -0.33552821303596569 0.32721985497667272 -0.55860561273121323 0.5865651083780572 0.78498572448335246 0.94437256822071669 -0.046430216596029625 -0.080738278357174786;0.17192829547489186 1.3698219447099782 0.1302528598884897 -1.003327048275404 0.373697941260694 0.33479187746711664 -0.10782239031911627 -0.024999272564413741 0.27385858693939802 -0.038814503937498121 -0.12072614400329203 0.57637302179150396;0.093774279694523316 1.0427459189846049 -0.078277000487143825 -0.48672700592307416 -0.020696142606727603 0.19255809838047408 0.10841755428292472 0.27985889072575715 0.50131788212569461 0.89709607730414787 0.43085623112742122 -0.55536054047823802;-2.1402669760273492 0.11758319713514725 -0.14629177491105011 -0.56303254311212458 -0.58255905383050421 -1.1762655224117828 0.19780398612606159 0.47990160257624126 -0.023323907797803599 0.44810130471707577 0.85874124459398704 -0.19151312205615634;-1.1352373498429111 0.68934143694733008 -0.030331948587685717 -0.58417787873684812 0.20195355974965654 0.8145259676087937 0.80338156901353674 -0.38977394904555451 -0.59676387393561869 0.55997545787668657 -0.032621448011280404 0.53944353489418262;-0.10428435083640024 0.85265528442699079 -0.15158669911512013 1.167189009028794 -0.084921223800437651 -0.1899594440187615 -0.065947856323132797 0.019017639778711508 -0.38404286983265135 1.0386990620321588 0.08826776877203299 0.71286945336893781;-0.61982442099743751 -0.13780251552252462 0.35557180520172976 -0.20839178204778649 0.83773882084880968 0.3165827215326209 0.20161268235143157 -0.4714483413761924 -0.28438553474702555 -1.9593403551581492 0.42231815783789489 0.060497487527740576;0.9681750103016209 -0.33424048410073348 1.1685306773415021 -0.0040889229274612485 -0.97968520181999685 -0.90942435052899495 0.089075639259449849 0.44395191674054879 -0.025239395177757043 0.4847180811185714 -0.75892133585582822 -0.21057091846333648;0.0090823694373043488 0.72761307880403125 -0.56336107854994866 0.60106080535948359 -0.55332866214849719 0.28396648303358485 -0.017226282099929827 -0.071417336583230004 -0.072378201332492897 -0.58877360683926094 -0.79823904086019126 -0.76278418756331157;0.45615754578280665 0.15576249105582238 -0.088629155210434948 -0.33531087918768016 -0.5210439668503386 0.58208101905350684 -0.29706755965949483 0.025806256720887065 0.84140636769967159 -0.61874352099391139 0.22210999000845666 0.4385250797594003;0.19903062269828059 -0.82539258515140301 0.68381172538824553 0.22071674496310401 -0.011508957174633953 -0.85624046894213834 -0.29537572383473865 0.17254767877555083 0.33437798192189477 0.90135969906919056 0.33498931588194097 -0.7367515702167089;0.17696054438290945 -1.8856740162092944 0.053736499898463512 0.65009120081369798 0.24389255194086223 -0.25267631718252337 -0.12720645227677635 -0.38618542204916162 0.19926240484775939 -0.26463636276570912 0.96931295424291708 1.2374560158025023];

% Layer 2
b2 = [-1.6573901829811715;1.4179383893700852;-1.1028336322454655;0.90437592035149417;0.47034684489291689;-0.46532856463680816;0.14298700107620832;-0.29555900181201583;-0.53724363601949376;0.77475277945557253;-1.2113905357792139;-1.2508701113279768;1.6512373683514101];
LW2_1 = [0.61318980954216362 -0.16277412847404199 0.041976998470757768 0.52086810789827376 -0.58773927311142427 -0.7966622087027585 -0.26720272315209953 0.026803097593733061 0.2390684839597981 -0.66601178541485095 -0.22563780520554186 0.28763614169174212 0.80285952886730383;-0.6817416722529841 -0.084083424512077384 0.67605597551235563 -0.65043667496737234 -0.32654842859688982 -0.18334467117191497 0.34127593725690997 0.42569493904580047 0.65578522312807985 0.31291137117614032 0.63919440010225226 0.40585131826812859 -0.11989334099596007;0.32975986962130532 -0.11210305524239485 -0.94152602908593686 0.73036051750149389 -0.12052711903319172 -0.25485787949396632 -0.7533115320471615 0.42020578942561193 -0.0082602893400497354 0.39202995239274374 0.59240868171796546 0.29421799686104017 -0.40290866268352876;-0.52586343180383877 0.59994466992646212 0.41823164540904095 -0.66292506929289097 -0.48812035114178715 -0.14042948812250602 -1.349488106009989 -0.30542105522387147 -0.65574141973607647 0.48529518412031003 -0.86462015038443218 0.48112311756519993 -0.35519472692311843;-0.0002661304123509952 -0.38581650405268814 -0.70744293723691853 0.72137198081712306 -0.20806569176210893 0.71726876557111474 -0.41807857092406486 -0.15449436128006513 -0.83283396684177369 0.18985177884757992 0.15439816344920301 -0.59549041414073245 0.38509793008792598;0.25501316535536561 -0.0091800667375650999 -0.38438104920298527 -0.023908321202794319 -0.32613012706962563 0.56631555365604236 1.1895876062199311 0.64451473821279892 0.39633734779763891 -0.22894789967666221 -0.48978543570037908 0.31849222093879881 0.55343263119634567;-0.19037792705266998 -0.9325200140776666 1.4033210467574935 -0.073812765092955077 0.9665639181341209 0.013319400387335215 -0.84352721644983453 0.20149306552475527 0.59627166565339385 -0.01933604578098622 0.67132902617786572 -0.64171281640739841 0.28165361524978133;-0.1253523870792469 -0.57462938422098808 0.1730877733640937 0.62528189155224823 0.077378856332086798 -0.97878099347425562 -0.041452682036310799 0.90211443706017858 1.3225558153876253 0.35965982122474183 0.39363751210024284 -0.050850809971562667 -0.66751121561391691;-0.92046840322701029 0.67039876088722006 0.92872604978796591 0.52503051855285499 -0.49007487847558917 -0.049720556034675512 0.29422742276095498 0.19531279884919353 0.24151444312631568 0.27190002711283551 0.17304035739156265 -0.21448524462920271 0.40137767999827584;0.24147580047751885 0.4479092291002485 -0.6634417440284256 -0.30926904230059876 -0.61299411007572957 -1.3398078418484827 0.56701761839049825 -0.24394023178796309 -0.94497562099278931 -0.79302897287488772 -0.36350532110733119 -1.6676973382478844 0.29552806984136676;-0.3144339874747264 -0.32467973559087965 0.40438032897090881 0.021266943026880352 0.38652285354135829 0.34622527678006065 0.38194808553728021 0.87295552295323198 -0.012799845069329151 -0.78474911325492114 -0.17773036709045853 -0.42347456661256105 0.84466039721678587;-0.21791838808935404 0.74254193700454763 0.23587840174567162 -0.61972167421696611 -0.64695767304331553 -0.60530750193207838 -0.099698588823362883 0.8410599846105532 0.52442769454596228 0.37992036995735512 0.8945682888485087 -0.77000927858898327 0.23177121840529991;0.3438637061329618 -0.46230071148687352 -0.75146738249805656 -0.44698671618335639 0.71835926103454328 0.16560691199844504 0.15834343955517455 0.01139378352306313 0.97115032065102913 0.08075335019320222 -0.22261156883645594 -0.4543434517999313 0.037098719273520125];

% Layer 3
b3 = -0.26501788972752766;
LW3_2 = [0.24131921923057584 -0.039779240296585264 1.2256564269867942 1.006757630051242 -0.12542182178081401 0.7369495322091506 1.2027697222207214 -0.29628760721150038 0.80599736515918219 1.5741019932614007 -0.3289840913614136 -0.6049975145618437 0.63132804668536335];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
