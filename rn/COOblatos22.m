function [Y,Xf,Af] = COOblatos22(X,~,~)
%COOBLATOS22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:57.
% 
% [Y] = COOblatos22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.019401957483279074;0.91139933315978205;-0.17092170282138669;-3.545022110719847;0.78272316713265744;-1.271933894130576;-0.61667591537008959;-2.1715944480687828;0.6118447722817838;4.2684814830296096;-1.2309915153910054;-4.2878108846204341;-1.308499726864184];
IW1_1 = [-0.1297206235700247 2.101131549125193 -0.5644029031494181 0.068324126598573162 0.52283357259589514 -0.20887540810241828 0.3254024266545677 -0.91424928701883545 -0.17566392319012772 -0.10193593180157139;-2.1770379317533228 -1.811971593577524 -1.3541562843444912 -0.062192455594165849 0.28262971626728145 0.71309783360919721 -0.025992481484503564 1.5339648467155536 -0.47709351204405692 -0.53052053227537621;0.6626420323509028 -1.0061043904766127 -0.25577578920686522 0.24533151413281493 0.087634591678592388 -0.048028480638219934 -0.15705516548441814 -0.38964024191960922 0.38172871011898418 -0.035146400618864822;-5.3830480729834074 -0.10328879304453496 -1.387248174745874 -0.83231543453918322 1.0612570121502574 0.33326086481398298 -0.16671369558722177 1.3143327977558901 0.11411638360762429 -0.15109213580103667;0.086868182991912415 2.4467758885521036 -0.36072403067080283 0.52618782436709188 0.050998046086097495 -0.16818024312377147 0.058413943570287535 0.51530452728079079 -0.098117377887143545 -0.0073801553903510946;-1.9652924725548278 0.14005904828542343 -1.0784183275540309 0.2805734906354807 0.4232428957135273 1.7415676971343967 -0.13238872453806561 0.28511391436147454 -0.65116980728442719 0.47275862735088031;0.5344816779180751 0.27954588059270286 -0.71132487154093516 -0.39434232404557812 0.44484989780654655 -0.08498666856574634 -0.38359379375346891 1.1135973837574895 0.54066954964638059 0.027872032457272145;-2.68308100332764 0.13699995208942953 -0.70918545722042625 0.46383317046753469 1.2553621146387752 0.27679734814225587 -0.82272643084874009 -0.50436266648721273 -0.32907882076743916 0.60354849468125549;0.47343502901781503 -0.11039287806269382 0.14856750843894989 0.052028595196038412 -0.12590219647792797 -0.94069684873478843 0.10410428957609737 -0.99011493483693225 0.23275376587951005 -0.16327371119388201;-1.3012943402010817 0.42641832543675517 0.27315634408613099 -2.1604391756080985 -3.8765058400509869 1.0231100077386117 4.110087080680132 -0.076477625414604011 -0.33574805949892894 4.1894495136110699;-0.1845688332028993 0.4045578772863222 -1.1630312464903694 0.93013231908677174 0.54701654969041791 -0.35033151178390043 1.2489274272868229 -1.8904759465275933 -0.38639014959923623 -1.3667228757402139;-0.95502949287087402 -1.5775357009799307 0.94439830554041404 -1.3669125411910976 -2.3201796807721422 -1.0158951651242152 -0.58324052971009321 -0.69962111762065449 0.88598651608401102 -0.99966435770339235;-0.76285052276707621 0.24338561721167579 -0.64082279089634164 -0.070799543343309679 0.62196266565338609 0.74879148155573261 -0.33477371731402622 0.32495986356766904 -0.26396121491997893 0.15483618249868414];

% Layer 2
b2 = [3.3315454747994693;2.9453994921229869;-0.71624802458130632;-0.37783473617316754;-1.8983638584897142;0.8587297324822093;1.0789484862635288;-1.3117889456920009;-0.40606857708466543;1.0043872460805239;-1.3694915439111628;-0.33916837893828955;3.401213762364637];
LW2_1 = [1.1933784319155532 2.3114270092669087 -1.1203725033582417 -3.9399280704025399 -2.8797943800197858 -0.24901274336696366 1.2561813690979904 0.35806773976092043 -0.34392593996571985 -0.25812360435947301 0.77839262259629083 -0.64841302625707875 -1.3453388635364023;0.84045129325668499 -0.24104776486388374 -1.0542431234088505 -0.36039488104887396 -1.3954620254506145 0.61122930532503283 0.78925397327476388 1.1342260430586395 -2.3048070886132224 -0.24779700597288407 0.95096708370130034 0.11841269086213818 -3.7194906088384583;-1.8388320319311844 -0.5222438579050831 -1.6001622740408172 0.10246083559166341 0.39207670766482922 -1.9081651551053791 -0.038664851106656656 2.9107226306570597 1.0339482026599169 0.36830230918196682 0.77186256545513776 0.38273728395192597 -0.56817674493022907;4.3231701946102392 0.27825559193088278 0.9218023695123152 0.2955250067038418 -3.3567898593849121 -1.6900884909821348 -1.5656269352215737 -0.095839473938430161 -1.3395749460299704 -0.28251374125804607 -1.3648152915653124 0.30603163184492105 1.682893567897654;1.4887498566145017 0.40580717477910577 2.350149713315016 -0.4310958061527751 0.7249004468983985 0.61383952532666464 -1.4001232980775571 -0.2152106658296096 -0.85679755995566298 0.0053188023146941571 -0.72065604822844642 0.11873878388131638 -2.40531545505837;-2.5365699946640716 0.13647314022253532 -0.86569546815114184 -0.41111637960048764 -1.031719741375595 0.87885562635100245 0.30731925600028959 0.55842888391713974 2.4469272316466237 -0.5948848161239888 0.74890405064034127 -0.21064792204213326 0.26053163639702548;-2.1812512709217176 0.27381148208481748 -1.1436823467956063 -0.14368392715251474 -2.4370048995562139 1.2633120729186156 0.39465885574615733 0.39734002341445057 1.9099758992265914 -0.80413312640903534 0.67786040108829926 -0.34639524078553097 -1.4978798559685607;-0.062242823930393924 0.60290647863543567 -0.87600688715421438 0.39666698337854273 -0.43768603511495868 1.0616049434800654 1.0422371990749442 0.042236417196178391 1.0862977859054923 -0.64431157617415225 -0.23816902710933402 -0.31516910079044558 -0.54908857141093803;-1.466136190710696 -0.94891144618465095 -1.3096712024298995 -0.56624720464955214 0.070284237415608547 -0.20564699004522749 0.86729895057387896 -0.29214090218539335 0.81480712839539815 0.57205108737685961 -0.4181182742207919 0.37896622028746385 1.6468317754344977;1.7662801678121476 0.40570525078945846 0.92852190203700857 -0.27260970724410039 -0.74973785873906873 1.7921168163216012 0.42503653316628137 -2.2113542516623679 -1.9860513609808632 -0.49354699418471176 -0.47537529880985624 -0.19691950415433573 -0.75331084850428542;0.58079517327707841 -0.093164115302223571 2.0842994514131807 -1.5323760708541341 1.2653083329379504 1.4515018250387117 -0.62217109856870267 1.0237447920266294 0.23541429713291234 0.13824325274828389 -0.81403878473291025 0.21869555148086511 -1.9231909650087529;4.4172788969269954 0.19033805204705528 0.75750038390770991 0.10972185689418094 -3.6114580032755388 -1.4444483879494214 -1.3546959231966591 0.1136234069396225 -1.0711470561324921 -0.34223773537553481 -1.4284920958210341 0.2734736394989048 1.3057721824611463;1.2477451730738434 5.1396767619685804 -1.2698964749508372 -7.0510997854330979 -2.7810773220420835 -0.34762801865060883 1.2970374652487711 0.59558040838491122 -1.1056706390955402 -0.28596043216748046 0.7366968085694936 -0.39482393872567145 -1.9457348298400003];

% Layer 3
b3 = 1.9473158320869297;
LW3_2 = [3.101320664359037 -3.2350634374982574 1.4549378774846089 -1.8143485987445069 -0.61452169705164439 -0.8546970886683124 0.79565135492437222 -0.51057638060816035 -0.37057258673474819 1.6291469044992946 0.38372893275362036 1.7691827152596116 -3.2153066942285569];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
