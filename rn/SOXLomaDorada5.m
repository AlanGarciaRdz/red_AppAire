function [Y,Xf,Af] = SOXLomaDorada5(X,~,~)
%SOXLOMADORADA5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:31.
% 
% [Y] = SOXLomaDorada5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;11.9760479041916;17.6991150442478;0.00572573718866304;0.0175284837861525;62.5;0.0546448087431694;0.125;90.9090909090909;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.6897058697641276;1.5720861298478053;0.32444384872367782;-8.1086426994005709;-3.3122000526648336;-1.5257814434613248;2.0533886117391282;-1.2393932857048824;1.3250286907618065;-2.9606131909526314];
IW1_1 = [-2.3284818021514773 -2.0158035028863486 1.3044459404364093 -0.58750661421380124 -0.93237663428490736 0.65101832177213659 -0.46940516436793633 -0.20807972067986477 0.422554891724435 -1.1708214083815622 0.12206923383723656;-0.20280817189541658 -1.0997867668517785 1.6884948494679892 -0.94430096699459509 -0.40527813064925483 0.15426452302185864 -2.1622830394379573 -0.8359813082600569 -0.25599389896809482 -0.81960447437096073 0.5412027606594586;0.7794286169597211 -0.56659476942221554 -0.41315929746711499 0.67622742464200547 1.4658613479009919 -0.069324859568046959 -0.052609770595387934 -3.3498364584667537 -0.082779785523215216 -1.7292639716370861 -0.13069702767022667;-0.74997080867509569 0.30342902305195713 -2.6037250015246789 -1.6594448559318751 -1.607049688224917 -1.2515702808632718 5.5923106714878452 -0.88352830484359268 0.33080527563912948 -10.494197587027433 1.183744314868288;9.8023222622563857 -0.23964806742334133 1.2583612167726419 0.93864743776628612 -0.053908035721105668 -0.14855067267218522 -2.04719863180136 -0.062287388768306806 -0.36722664424189944 -3.0382994075056109 0.3299645243196816;-0.080007496340945741 -0.056622208866538862 0.11623381003523693 -0.20000722898592779 -1.8064410372852995 -1.6316423000473501 1.0673481049786808 -1.0027985515234425 -0.36127375535798717 0.61008349308128718 -0.12132028332464116;0.9265091946546552 -0.21023920103653193 0.040963734076370384 -0.18018871891212973 0.64396650146866685 0.50309102663154759 0.34257307296612549 -0.2855668154975432 -0.45663168777994151 0.79640507663130988 0.2336499783837932;-1.7374442483517645 -0.036838462088689336 -0.079950762833432609 0.032986263499543006 -0.23277891333602566 -0.69637964560680254 0.29877803852568946 -0.87019913239041746 -0.46871927207345387 -0.13991209837151222 0.082652468900629994;-3.5050204724751461 0.24446817609766525 -0.025550627562783184 -0.45602043328460806 -0.33402007641451176 0.0084867834111969978 0.092210718227821648 1.4181091410198365 -0.055023472765881418 0.56798314412917994 0.059030405898681748;2.231982775991014 -2.7061150981223152 -1.0504612296366063 -0.083729820022902884 -0.55628730571299667 2.0731818997847165 0.85544697073126297 -2.8324795004894225 -0.65459279235333745 1.4781148023277795 0.5159584236583773];

% Layer 2
b2 = [2.5508652230596458;-1.3742521592566994;2.2344583050000844;1.3186205466180405;-1.2193809011161516;0.093600174393211055;1.5436166604180437;-1.48953003187977;4.8204812309645391;2.6931695324942684];
LW2_1 = [-0.27965467257801946 0.14624763651802319 -0.61010515367194118 0.55624956306278217 -0.55816372871878073 1.9437952672221621 1.9589938099386668 -5.4305597885667476 1.6608357655855375 -2.3336895022724358;-3.462380019099359 -2.3966247190459584 0.08596196023239544 7.5322195765620075 8.9571838164078077 -0.44984910137171563 1.5099155203728341 -2.1827225061063782 -3.4954749117562391 -0.10454267581187356;0.1913843730354903 1.1833427312598057 -0.45479186764006452 -0.060528276124392835 -3.1188729340027108 -0.3865387125144365 1.3517481608582538 -0.0013685895560607841 0.26182597895643539 -0.47404503856319957;-0.051460348347500587 1.6542777783016485 0.29825137565689414 -0.030819282922792776 0.5188515909847744 -1.2536408963927206 -1.4860194400716353 2.8103223653768663 -0.85367311496700005 0.43418854533774393;-0.26626437364062333 -1.7124804602208459 -0.64419883870027939 -0.81659945092709296 -0.14474229094602092 0.28837236562469593 1.2395278269023491 -1.0941107764198075 -0.15257049715197626 0.16608316210734916;0.038413239290649936 -1.176495393880358 -1.4929258587495506 0.082419133860334379 -0.81777085711751329 1.2414142792739389 1.6009898756712746 -0.19363476994262629 -2.08592326178373 0.58328946157868011;0.042914118696175875 1.6016087866151731 0.2619618040286632 0.00032205230525562435 0.47866502279285394 -1.1983211226307986 -1.4541258881961612 2.8439721097558244 -0.98551033449239278 0.38678345271940884;-0.48920393225387016 -0.51803800108218623 0.13631863486829301 0.16514026360331774 -0.64376471552298753 -0.077704725088791102 -0.65249703747317478 -0.29469162255520831 0.69374601291651539 -0.0023460342343344515;3.517833627696485 0.56596253628241022 -0.18864299988764116 -7.3332960999958416 -9.565349950315488 0.33905826373297904 -1.2734668939358329 3.3954840622983458 3.3335007028999555 0.081081454267252717;0.58499867964746965 0.71031265594176851 -0.15712895325046211 -0.23156783303311482 2.6910502493697748 0.16051467206564962 0.91442519130104982 0.2355090142573992 -0.36315909877460173 -0.048939268064114812];

% Layer 3
b3 = 0.98053352789795067;
LW3_2 = [-1.6136688664445149 4.0681823453578874 -0.7153247495896975 -0.70686162977027078 0.12355021674172684 -0.13556606657451137 0.72216934887530893 -0.62128544736939251 4.0977975328095564 -0.32160074258952914];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
