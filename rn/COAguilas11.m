function [Y,Xf,Af] = COAguilas11(X,~,~)
%COAGUILAS11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:19.
% 
% [Y] = COAguilas11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;0.281968137600451;0.304971027752364];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.8669328131338339;2.0618429315638163;-1.3942812280421983;0.85109754321259201;-1.3767637596940663;-0.42231067497360797;1.0256401575366711;1.1109729627800307;2.5281085717217358;1.6183006542342755;0.63172157179783184;-1.8390700472594015;-2.0793182212225516];
IW1_1 = [0.69129651119474456 -1.3038758974679088 1.1602801841184716 -1.1168285803032312 -0.47476667759287705 0.25497558521512581 -0.2287610235402123 -0.48469144787608126 0.07301264916692983 0.037369908551054334 0.10466114894821903 0.04905024479988742;-0.57343487245320957 -0.25699333433363925 0.47460292112174868 -0.54041765492559912 -0.81612327883190328 0.31520326722977721 1.2767316611283297 0.72529526661557264 0.86626076632057813 -0.09871443859529333 0.30164570732215967 0.0042046937434668244;0.24336866693071382 0.94334203899377755 0.32506513487533639 -0.41902423222797736 0.21633580244951198 0.63407901985342052 0.063847255126307165 -0.03279157921314866 -0.22483740590484252 -0.0023562590053532086 -0.32215757501659692 0.17522873405995659;-0.91389917602269144 0.21067190622331566 -0.29030755989470419 -0.27236724286601877 -0.14918171261118537 0.29914882183172847 0.54444743152111619 -0.36296182173042396 -0.07433188388081291 0.16483066832701426 0.081404315786660394 -0.013900385706382003;0.43295810091958414 0.32003837069224284 -1.11587438295778 -0.14105048526127589 -0.29218329127014347 -0.1131792874310877 -0.5236012628183897 -0.15072263216987145 0.08156609935732563 0.10961798382886849 0.33434294334294673 -0.011740285395991151;0.91358657150102929 -1.0330045367701677 -0.48920228619901479 -0.40432122352112926 -0.19164568603870588 0.86959458779702281 -1.1647800146306395 -0.80540615714725516 -0.24907673917271941 0.3197438088811782 0.091109089803193488 -0.15907568542012851;1.2614109404308469 0.59128794451243893 0.0090597216031580077 0.2549683281255874 0.24033583227770619 0.094642203333785285 0.054893755309308651 0.84198848345303912 0.069126209194126181 -0.27447550585724734 -0.30561975814194925 -0.038503972849212038;-0.5003982213743795 0.74373121574170042 0.9987764395196107 0.36026790179170998 -0.035156430159832684 0.26690056621397418 0.042419891441535275 -0.99364779445354967 0.02897479315066397 -0.028849329249447893 0.1209801258363391 -0.11935818757178954;0.2542364231428943 -4.3305106346103548 -0.2978490490964022 -0.34319135622391089 -0.31054691634897691 -0.10822493125668563 -0.1422257566330907 0.13090145322348834 0.10406258509420635 -0.11165567705846133 0.20835057813683866 0.064147103886509238;-0.023829439020186652 -1.0686991018215348 -0.14194391730705042 0.69824684996249231 -0.90729001006198762 0.054917760045193602 -0.78461766674741329 0.88215674313848969 -0.58122359594480499 0.18692966128378571 0.56882485465985066 -1.0164862566022173;-0.24448712830191277 1.2509440822566358 0.79501585497432792 -1.4079338952126796 -0.1758185528707365 -0.36295342271707964 0.12894955634907507 -0.77145235074587326 0.4307855256951143 0.93848327672653065 0.010411733423880054 0.17869273531308708;-0.84799932743473694 0.40833179925955687 -0.45691362233307581 0.54659854861739043 0.016129603628718937 -0.23517779772756414 -1.4248768706187107 -0.80566964021482468 -1.5439989902751514 0.74603141753071311 1.5852091295005175 -1.024841419453649;1.0301614434363935 0.36261071516189158 0.17534969893984689 0.48384039363089937 0.4897462863320724 -0.5067882145608632 -0.9066029187650303 0.73088810077092647 -0.10432547816106927 0.28475400127273559 0.24307411997997555 -0.21270456577650892];

% Layer 2
b2 = [0.88737541162164602;0.92071287086464038;1.557840703449928;-0.81088057892119947;-1.3608831960335426;0.71870746180702738;0.58148207244717542;1.3305377618789445;-0.18774828217964512;1.1426322709462078;0.95068473096404171;1.8567787240189115;1.6704399790858424];
LW2_1 = [-0.62857341236180575 -1.0996620540400222 -1.1672865656711202 1.6561665117778039 -1.6517062976886068 1.3871732251478792 0.57146880636472941 -0.64799085076812779 0.17140261108089663 -0.49706910574437296 -0.044452863144704702 -0.088033744464836625 0.76435407891788165;0.61494350441582046 0.1802896675816705 -0.74558745149599459 -0.011366836062583935 -0.48895467655708486 0.066882451971113602 0.085284229585134708 -0.58492724557536135 -0.26511690460724113 -1.9545277810230024 -0.38695703358454953 -0.073700540182796606 -0.80657739118424077;-0.7785688349700518 -0.22001471259986133 1.4688207312188608 0.72733179743886212 -0.93708037214714335 -0.57811302178150359 -0.55417252738840539 -0.010439887319221401 -0.031965801960115746 0.22507220932942795 0.45154604849052626 0.13162096614095914 0.67668974051061503;-0.21170443146890364 -0.84394086911874089 0.53291427934405544 -0.11663696337415415 -0.17525262720944951 -0.50420648180252592 0.59259251290845083 0.27500192694003972 -0.099858482832906381 0.72430548755182023 0.510368843303176 0.53271350735446255 0.13075652366169321;0.27357823809130866 0.59576024170690833 0.44865722876440867 1.206411921800989 -0.79381128896410824 0.079566424304529149 -0.078734807468570298 -0.19248181377290347 0.77425899166480949 -1.3472197903842009 0.27683388606290421 0.083750861667030843 0.30455457340421821;0.96226889987156028 -0.098902426371603638 -0.96237165846517214 1.1144335805935919 1.2435281921176666 -0.83053967928011585 -0.59382174231017404 0.47844746871763022 -0.33753497869764432 0.71978325754682693 -0.75040803528451805 -0.62933462903471371 0.33388613696036079;1.2995880470154697 -0.54112719764484385 -1.0900332278012064 1.3093789980851851 0.051943005818454291 -0.51960947247924905 -0.64008448287665798 0.35173719848925733 -0.96884050122730414 0.55212140376323249 -0.039002370718711474 -0.088291202055814935 -1.4335836498717487;0.015141428235788849 0.37594953129978231 1.0820944290423076 -1.3362196043539145 -2.2534680788503545 0.31558413663921109 1.3628315281221139 1.2510452143355255 1.3129997487668359 0.55843793371300843 0.86476619319908188 0.76545985067982392 -0.49162518122589272;-0.49615608922935556 -1.510694913933007 -0.22466101900199392 0.010808633717397292 -1.0368714173311653 0.31631423924914726 -0.68026332578860538 -0.58928186413432049 0.97766814978605177 0.77653346052730376 0.54997598575909035 -0.76777641801049057 -0.098820962826792105;0.33482471580516437 -0.52597914059165352 0.041302595085424242 0.10155878872272529 -0.88358999805766858 -0.84879074999412796 -0.96159073659046279 -1.2352250381026388 -0.32763469029514114 -0.089134644970123994 -0.088745344120414502 -0.41797715049356526 -0.6835122964426823;1.0371876224950531 0.81095469392008079 0.17061802664911846 1.0359403913545535 -0.58628334186389852 0.91723504369839415 -0.21792407878464151 -0.5333448582153737 0.15456098630169271 1.0358908615451274 -0.67609357241271817 -0.15824356364958858 1.0773844992930335;-0.18628491816732698 -0.40095203093334109 2.1443483321642716 1.2084398121858149 -0.62424436594185462 0.80441987374749724 2.0043369724961986 0.92449443293211941 1.8014106199987203 -0.73008756382918893 0.63261294801152268 0.54187994830246855 -0.054370548948119435;0.67429476919478859 -0.18523877617404474 0.18653743807235476 -0.71102316354620343 -0.60414559819954616 -0.16503028173624373 0.15411457188318098 -0.57755242481106206 0.10176470650121898 -0.0092352185720380314 -0.96797384634213468 -0.16276259515781377 0.41782110722792137];

% Layer 3
b3 = -1.1304737594907568;
LW3_2 = [1.938955466544181 -1.3444007176925328 -0.65087420486233705 -1.2937822738237297 1.3353107415236216 -0.69495510518643211 0.87544968830075454 1.711833444204514 -0.675199971273447 0.34793738972610344 -1.1177670551029943 -1.9209566356914711 0.53382367400544761];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
