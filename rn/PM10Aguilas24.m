function [Y,Xf,Af] = PM10Aguilas24(X,~,~)
%PM10AGUILAS24 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:54.
% 
% [Y] = PM10Aguilas24(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.5210034030874158;1.1451334068461385;2.2737224651885772;-0.42757872884345566;3.463506649391042;-0.63285901384917231;0.40712234203635767;1.5058684682513279;3.379294820657202;-0.23814766112747315;2.5169911515139964];
IW1_1 = [-1.3704982954610312 0.75170173862336187 1.0301761936668057 -0.3357319587861195 -0.18991954102095157 -0.32769496395591857 2.8928940320775678 -0.43362050357921555 0.32159067565541383;-0.36026751224841214 1.1195587721198625 -0.40861102305077135 -1.4107338371373783 0.89542601936726562 1.3538593646771593 -1.9201186020552881 -0.3531332395509329 0.32694678323887189;-0.58210556239232336 -0.34661961554573745 0.40204124189982721 -0.20360502234305244 -1.679829119955532 1.4759415399431721 -2.9769680396137668 -0.15139150081141597 0.64189323502109452;0.12539724810573849 -0.7883697460262088 -0.10298365955225255 0.49463828417482297 3.2916348368732056 0.15277197043883434 2.480489936683711 -0.65945130073303415 -0.56472840809986458;1.3729340211753924 -0.56112464157585107 0.27851926721021525 2.3831922277608593 0.23640718863952093 -0.71051793581552558 1.1904766321197888 0.40307448242461569 -0.32599923917548196;-0.24899716276101097 -2.9367602876575107 0.19884489691016044 -0.70501122319753629 1.5214918521191185 1.4993500961635209 2.2703781364986022 -0.10091813885529227 -0.096032401590364441;-0.39693866639035974 -1.4638797890234221 0.20581377325541975 -0.84460431057293539 -0.78561217867481492 0.49781606967269409 -1.5005814164843687 -0.194146341529845 0.13147604430787735;0.0070561438076010789 -0.060581263579375697 -0.75289521344707566 -1.043000425569099 1.7475261939840943 1.2158096999975183 0.042560117729912202 -0.35646794791434794 -0.12198147189700405;-0.25001081786332757 -0.054401800118905635 -0.27286150924007102 2.7647293976975948 0.30180517402038248 0.53495296025699846 0.030224339500450961 -0.15877821547971069 0.065694091129730584;0.40905892250667786 0.18567704517343536 -0.22272114142477809 0.72653474275632057 0.58422170674296381 -0.47357425941730785 1.7250778740338868 0.17013635988392189 -0.44820509298136646;-0.60052383805198717 0.54995303872609647 0.48204907794792401 -1.0806580398865384 -1.40778089905389 0.35402032604141309 0.70832601643367366 -0.33977220840893357 0.059256132323726549];

% Layer 2
b2 = [2.0930076000632045;3.0171264550079284;1.1519564315481647;0.25657097180917532;1.3869393473732941;-0.77063217063064537;1.7347783482887598;0.86359573711369753;-1.0039846491743027;-1.5949074387048903;1.1219417733001178];
LW2_1 = [-0.74647251873028886 0.49912880188913805 -1.3076869977252039 -0.50714502462519129 -0.41740853409912476 0.77542599169631021 1.4496982253016752 -0.85545482599171452 0.42251706330905148 1.4643210293222171 -0.093223134125480375;-3.1721316742655374 -1.2079684303878679 0.71453982769804225 0.26415012180006486 -0.29184704624753677 1.4629294526218652 -1.3363095625656765 1.9423951547545244 -0.33451171243391592 -1.2488398386009576 2.1117258637832244;1.9861060504458037 -1.2007201140135795 -0.39532785424313671 1.4129110980256705 -1.1770393999722979 -0.86650909547821386 0.77345271135655791 1.1471211248387119 -1.1213022870212475 1.690144948523665 -1.174650768156531;0.93784094653842065 -0.50365463021238288 -0.33709334928735185 -0.061965296815181994 0.75958778313673947 1.0565258908354036 1.737999861680946 -0.12494908390816617 0.71380747680261336 1.3092807234633361 -1.5334526912266899;0.078489413031254757 0.47078910335249136 -1.5505413131262922 -0.41403848759613859 -0.38493478325190872 0.49084345848570027 0.93758939695006094 -0.64168405469060097 0.25267932874077648 0.38243747400711414 -0.19367982658163169;0.42358718170554704 -0.88010817534046315 0.52541049749939817 -0.36330968772239747 1.2028467494361568 0.29335833609039691 -0.94058747459867675 -0.72790895902454189 3.4453910840965474 -1.4016663220709806 -0.93125849332822641;3.8916278762418228 1.5456038621085171 0.45464551851314527 3.3378835016403823 0.17513976000539791 1.1467823508288639 -1.0910034491777296 -1.1124137982360993 -1.085146700812089 -2.1140252239065478 1.8836733452554757;0.88837941863555203 0.44055258523568402 -0.063723872189577965 0.34845141460925005 -0.02058292160109898 -1.241130615352124 0.81575612110726659 0.06654779057095811 1.6287342871986772 -0.35232413885802977 -1.4554769023585807;-2.2363624561696156 -0.43364282874035398 1.5789790523811293 0.16265867477046103 -0.17066147354104166 -0.0048666153623276301 -0.36524894838250399 1.3526172061189985 -0.38031511527647804 0.76853349973186069 1.3733231988900603;-1.6038442031864124 -0.50383529264124016 0.17502672562390587 -0.19050533003039302 1.4406565574735879 0.62973294465867824 -0.69964208348511092 0.36037962760652276 -0.84026247816701882 -0.020484717242386642 1.0144645368530703;1.5031322859122638 0.48775361892267632 -1.6638643062684451 -0.35851701504255873 -0.078294557122858557 0.3029437934438925 0.60997596653799713 -0.98776329638234717 0.27901407307299236 -0.39578491888920275 -1.0726607913433404];

% Layer 3
b3 = -0.0064368001357775068;
LW3_2 = [-1.0668494117201102 -0.67708959862456475 -0.13836860118479419 0.2777568181479303 2.8964750067567309 0.080746477265596847 0.32270569728306658 0.74601497138224104 -2.3971910285497557 1.6565461255879825 -3.9995058862207005];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
