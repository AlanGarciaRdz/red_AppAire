function [Y,Xf,Af] = PM10Aguilas9(X,~,~)
%PM10AGUILAS9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:49.
% 
% [Y] = PM10Aguilas9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.4638776592132343;1.9877010399405617;2.8243059648605882;12.74641408359237;-0.74488982615350086;-1.073077141570058;0.55747292210920862;1.639561417347104;1.9939046271004559;-3.066846749981921;-1.608853721679129;2.0113296107218357;0.8949137389410643;1.3912589274125009];
IW1_1 = [0.5750954621387574 -0.19138508025081213 -0.14747923422819426 -3.2397980481315622 -0.064042750073817573 -0.018784863937465021 -0.32308860997228706 -0.18124299561271545 -0.06808408993660707;-1.3666014141759422 1.0169049524399971 0.59864757774556998 -1.1749547283253914 0.27613461132177874 0.71203153995269819 -0.21332034143993087 1.6819839435265753 -0.4824396068413363;-1.5740981278832216 -0.99960549284221556 0.9438843588634781 0.089831232347481763 1.7863759424191012 -0.089043752498713796 -1.8655630063636603 2.0703077614075158 -0.16064372468227964;-1.6197760803692145 0.4044478930219978 -0.59702963883420879 -0.1797280585091611 1.1934181546073248 11.333829903892774 -1.1763834248069749 0.5116623091965905 -0.1043189874594799;-0.084980371777738137 -2.2696698460459475 0.33728168788741486 0.35557163384743601 0.24560782418573171 -0.30406078575999895 0.46458009824996577 0.012195744946138763 -0.018155218973316182;0.21859354728335262 -0.35930306827463593 0.0051231265737642848 0.037049693744610236 0.45975139037403817 0.036868051217933233 0.81407640214977395 -0.13239393727081383 -0.024028464982909965;0.29599946072260491 -0.68639521057152819 1.4727730192348547 1.8864145297635935 -2.5203232439020566 -1.1731229569102199 1.136545230831139 0.43805516259545269 -0.067188344958295732;-0.91416758300566259 0.59404381258811678 0.59028584862547973 -1.08680489941514 1.8099785020961625 -0.85969244420667801 1.6451757970974166 0.88449960510767955 1.6281397811252496;-1.999323955248562 0.7551271481196411 -0.65604377411787518 1.3145442956425701 -0.16681374713141636 1.4937679681602671 0.17976200724309771 0.8195268638751193 0.1296081175318087;3.909789639458662 0.21368482599796601 -0.2701733286588528 1.6921124070498459 -2.3547432631986123 0.95025776626644454 -1.7764400091860051 -1.238002829837864 -0.8719189587750914;-1.2643694863518473 0.21600410893600036 0.25095142437770851 -1.4229155643153426 0.013378748524677983 0.16469776651706478 0.39280864427620266 0.41127289153036589 0.17858486816752239;0.37004107191004332 -0.77763306843250901 0.20327892776851297 1.7355622340095502 0.13061053974944331 0.81307257693440727 -0.17095866140360613 0.23468574530997763 0.22603291837645334;1.4316571625645083 1.1951539603445329 -0.30424082410321041 -0.77794590257507601 -0.34511356291003209 -0.59025587417008429 -0.037445207201676552 -0.20418945860201357 -0.28668047975641142;-0.49423005251187757 -1.5612133943372049 -0.30798726270712024 -0.68628336283869629 0.27256195129332816 0.067448683798281867 -0.72099000937732205 0.20887893042739628 0.059234384583120324];

% Layer 2
b2 = [1.2933082713695447;-4.6125855199018782;4.4999736450427443;7.0044225880980555;5.3893558708978997;-0.11662824438249425;-3.8600864017246055;-0.84958879052626457;-0.24367134554753542;3.3701589973089723;-0.70571213492406493;-2.8322080462079637;-0.22513037830919508;-1.1733349216184938];
LW2_1 = [-1.4436755738091531 0.19780635477420785 0.38008938828466293 -0.18765752263993013 -0.49702769886014742 -0.25147764707840231 -0.17219300530409137 0.23927513633923062 -0.37044109573283635 0.16114873180459413 -0.41234961996850394 -0.65235973009318871 -2.6251504000682919 0.79475755682441462;-0.2015833731967297 -1.1886043299547542 -2.3725011426479394 -1.0127486823306042 0.6149278320212711 -2.4064374197553207 -3.348902452681771 2.2039255768010149 -0.91574649336013858 3.2578094236274664 4.0667797344281409 3.856099026173204 1.9841976591733401 1.4459771809242177;-2.2678324311673124 -4.2149713281836005 1.9035926797065736 -0.91439308075043768 2.2995839376979816 -3.3418097932262332 0.96630507657162956 -3.5989819681977235 -4.7233524763893948 -0.79257351912478557 2.57299043887609 -3.3956746911378626 0.20054702854298487 -2.5250812194457417;-0.077142721351716237 -5.6383161828981505 -1.0754330732023465 3.7015940464818766 -0.097521630474391496 2.4146813522242776 -0.10787200783991863 -1.7344457086896787 -1.3270808353265577 -0.93402558967157434 0.91173969882908756 1.0341205076953495 0.76829276341079433 -0.93610004493878174;0.10891336432327844 -2.8934512368506717 -0.38215464756455125 0.11563678939294859 0.4086945640532863 -3.4886809144918915 -0.90059749465618921 -4.0801184556505978 0.13808455700035119 -4.2225310959320108 0.79417767628970781 0.92757942148115879 0.98437397018781303 -3.2913071714415079;0.089917868129164844 -0.21242774620778099 -0.23927947513392611 -2.6692074896438034 0.9128512768541277 3.6935171197664802 -0.42434919922930681 3.6481459122700954 3.0658806663630283 4.0392563163676325 -1.8613600613110819 0.40854118786756122 5.07128991875107 0.51220326856874454;-3.790844317885623 -2.9306642574227229 -1.7501961274225359 5.7349274270346564 -1.440007927335299 -2.8532096123077446 -0.18723472960421014 0.73497116111517724 -2.0081642808186002 -1.745113313263287 -1.9782005134905618 1.3509266662153441 -1.5122537301378376 2.4124412557041102;0.62613378668458008 0.17834660017499235 -0.40040367238907243 -0.13888844523307362 -0.38072331009442739 0.39292465589154829 0.18812908423779506 0.13722109766942758 0.21623678760001222 0.28900726382608466 0.097403769448698205 0.2064232944821317 0.18878800556095554 0.75652927278892768;-0.44130637993123711 -0.057881126497287619 0.60471658122034977 -3.1032971773532183 0.95603433241126523 -1.3730117162875046 -0.24762002932549559 1.4132650377843654 0.83172877797154687 1.2226251474640404 -0.78022913204345201 -0.82825432593745529 0.54890143138791936 -0.0516123425639195;-1.5792792432430993 1.6267045236208073 1.0404769308934176 -0.22873265525993136 0.31203028140985534 -0.39870956512548805 0.39299094992487149 -0.030938095208882729 0.96023483669978194 -0.16880250387807796 1.2158649527309282 0.058532153035324878 -0.28024409268619338 -0.88535558296580641;1.9386419730309665 0.0099690392535564387 -0.60893339064402807 -0.53348375095145961 0.050731646781335162 0.47551288706183442 0.44965595642462597 0.42979576306429318 0.36732631656379533 0.43154721866034718 0.75889971531901235 1.2252545128622181 2.7688603497809687 -0.11344976671030704;0.58312438197506766 3.2753793003951546 1.4664420296521641 -7.1800871082263198 1.8755516946237361 1.60350911783032 0.31506219451324341 -0.81739083901767484 3.2581864118990529 -2.9488274530689575 0.039408201488995084 -1.9878035708701101 1.3270554747824392 -1.5390577399419094;-0.17954947394691009 -1.5976884599887236 -0.1018474451698286 1.2381451197460802 -0.39538587814686321 -1.2293415367986433 -0.72478864271764643 -0.013663480988813363 0.68599046630054394 -0.55819997692230128 -0.20036722639818827 1.597893752207159 -0.16137872765143441 -0.64660160664972732;0.91329964619131121 -0.79401176165358467 -0.54645160111843516 0.17653268951397241 0.16933878719505135 -0.38000729500434016 -0.25966079519631763 -0.12739008726702458 0.24278674610750015 -0.067855556459745725 0.32638381437300168 0.027583890987703058 0.50246868989964588 0.42647382315568139];

% Layer 3
b3 = 1.6237682973666006;
LW3_2 = [-1.3992481854370535 2.7039485980396076 0.056917338277440159 0.20819483656487156 -3.2484808525919391 -0.14415174848368814 6.4994524868421388 1.6686915352691989 0.47956860298047876 -0.84418237797488926 -0.96799664312636979 2.3099880147724039 0.23181071307562895 -2.010605133898264];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
