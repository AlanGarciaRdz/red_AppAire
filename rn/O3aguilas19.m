function [Y,Xf,Af] = O3aguilas19(X,~,~)
%O3AGUILAS19 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:34.
% 
% [Y] = O3aguilas19(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;5.42005420054201;35.0877192982456;0.0561797752808989;0.00588581518540318;11.7647058823529];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [3.6451012606691875;-2.2417755465038187;-2.1148748215892668;-3.092622052144073;-0.2072183518061004;-0.046129568699944903;0.20544794176872433;0.32113980510271506;-2.9115545833831797;-0.56873618874742848;0.82658892438118126;-0.89796133680854195;-2.3058052879774991;1.3844236871609885;-3.3066317498039171];
  IW1_1 = [-3.0469652875339346 0.36002153736044235 -0.392428400516241 -1.6218638585068719 1.02948784061461 -0.69085588233272277 2.3948859455849285;1.6185292134109757 -0.26913658556307846 0.15961508869156271 -0.42160533133588907 -0.4707684004443311 -0.090844603054316533 0.29951781095996205;0.081489405163222187 -3.5673542492350667 -0.70957178121025055 0.34029276583687557 1.3179584222786027 0.26668876671572833 -1.2329428519571335;2.6531660091487641 0.044201532351749839 1.1228767459439668 -1.7839609649556578 1.042824386370192 0.095244230902173904 0.63002097939203738;-1.4976980016811434 0.14581011420366899 0.0051283591780433291 -0.2128860703516931 -0.19452188408668952 -0.29876505989693886 -0.85930922039786473;-1.1882714080764993 4.9978853530954206 0.47139962223581089 0.57127291172445482 -1.1570810028191869 0.41486258796225284 -0.66595042821274231;1.4184247454891059 1.3539560283992702 -0.40431342733468562 -0.2988908008512548 -0.18925018824209638 -0.4721083295976225 -1.1195290780189098;-0.071600183215231927 -1.6607944266960144 -0.40920158630484282 0.74817214867507476 0.64275163174270533 -0.43338751734463715 0.73902509817500683;0.8196644895077575 0.24125397767536866 -1.7291445796054927 -0.16735506643107587 1.1373142595373913 -0.62047202320029793 -0.80716437064561786;-0.91459614501459963 0.32154299246758045 0.245627651905683 1.9235704798035282 0.32106319118203291 0.10438007964889642 0.76068810104766804;-1.3349590746638571 0.1610396450767288 -0.60896501135793113 0.18786032703640804 -0.15190706847492771 1.0628257012404236 1.4539696575060785;0.36879295191851136 -0.69623936379919227 -0.47277628004343741 -0.2303452608234822 -1.8200476398086485 -0.49096341357730716 0.89856884793190528;-1.0934319618227935 0.1207206884445864 -2.040462498672976 0.86770463484803484 0.70933559809443092 -0.48350339618969096 -0.10948499605280573;0.033206035922115205 -0.29643464641434059 -0.95263040416555678 -1.4155359369017737 0.68715855562562012 -0.45588776301657458 0.86549205023859721;-4.1486151550469028 0.55619587143981852 -0.11145022340525168 0.49450178982172677 0.19898970562791476 0.20480607083089167 0.59544203321617728];
  
  % Layer 2
  b2 = [-2.2065374509253823;-1.3559791030608654;1.07374837832541;0.15621251950353313;0.18246989274522912;0.45752372095181476;-1.4854658672292811;-0.29387012184165684;-0.41587619797659536;0.11808583222250461;-1.036880345876469;-1.123370855798125;0.85173588656253718;-1.1515448429898498;1.692797500175965];
  LW2_1 = [-0.2086517007872932 -0.034796255004486444 0.43391193366801567 0.62501713258601699 1.4457610938835301 1.0753319816144458 -1.1030902560960165 0.06727658161234952 -1.0136849168902731 0.77638102534995412 0.25553500707025906 0.086326459771539993 -0.24695876834990396 0.37743442451467585 0.029592160626572127;1.3249721313527449 1.0158907207593657 2.3048545626184795 2.0007216679968187 -0.13961342493779022 0.53005452031258149 0.16665392845776295 0.37965348312045344 0.64310786177552193 -0.089381663319007737 0.18803415815226426 -0.0817318980604613 1.0891626849908065 0.37015097387639678 0.27531786417397464;-0.4618244021036676 -0.1030616407900716 -0.31069758881467796 -0.15347020344459089 -0.59327510667815597 -0.74082707633836453 0.62908281218015893 0.026726170489995961 0.0081582642006185271 -0.24662096522406263 -0.25193128833805661 0.47480161755203998 0.010053274763975151 -0.0046073144775545249 0.12256880320171304;1.3870030929424975 0.4080612291119603 -0.4036404805419419 0.61556411226283092 -1.8996037463311253 1.7943485303437738 0.39095677323770128 -0.56664478540423457 -0.10520109480452651 -1.8007486468439133 -0.6428602321537199 0.52645675860344376 1.2813793655033292 0.74943352310701761 -0.60616156904135254;-0.70777711891386852 0.97189642103401219 0.38851902695719442 0.094390038513250701 -1.1713965164740126 -0.71613051601871458 0.17101720654180816 0.61631697196320623 -0.9737108492071086 0.9032355433030218 0.37456406854551116 -0.24303261757343331 -0.14387382186558301 -1.4713952258392282 -0.46288679571793206;-0.013500483781914319 -0.10554561002118268 -0.08196142740780904 -0.83552756153110563 -0.4523288485365074 -0.41715762488754748 0.75062939972142462 -0.27906261752841988 -0.32866917567200621 -0.5564667006587769 0.54073585557937254 -0.13993656351235415 -0.53389956426272911 -0.36982667336531988 0.54811963837223809;0.8489899046636058 -1.2254622997214903 1.1070396222207017 -0.49485662761825755 -2.5254106940732832 0.42157206214917409 1.0607017889540697 -0.095051506077902873 -1.1278772446760645 0.49470665475397002 -1.027505452228435 0.73772044188442687 0.22589989509685102 -1.0160306188211579 0.7912922035188954;-0.47378158795231451 0.2962157125390652 -0.29661404150855453 1.1400004023441299 -0.26148431078460144 -1.7345428604474737 -0.29653392056880645 0.21703821243107804 -1.1273796996257213 1.1602953844401571 1.1729156877544888 -0.08354249521601248 -0.74003893957883504 -0.82616112751580117 0.79107088229834821;-1.0294215699183684 -0.14883115485201154 -0.4320279441326384 -0.16333682260922811 0.1120672117699176 -0.38343998316101069 -0.64193237973538064 0.77649572067440409 -0.40685819508409821 0.29482636652961869 0.30844226307716749 -0.19271624939631002 0.32177687147171607 0.14500385398522597 -0.45665318929135218;-0.51539738162557092 -0.27668167960041407 -0.91376622986056599 -0.36912631217231467 0.69628386335965076 -0.23224208519017653 -0.98265402540610536 0.99318182039699687 -0.51097726136371713 0.069506664143223595 0.16459213231551642 -0.18659427180021462 0.45338829129611602 0.89345040058784142 -0.19674291696261267;-0.76482502290445653 2.0573519551480941 -1.7059850432500903 -2.5752907905767248 0.20219613846006385 -2.4823405109773486 1.0328367850775124 -0.134765143402928 -1.0469076392015777 0.69199840885297981 0.10659724191687739 -0.97210778696752553 0.3933438577914134 0.79394094285117855 -0.83940206878090784;0.54411366173628029 -0.25625891643785925 -0.43676634187867797 2.0849507590366909 0.4331339892683459 1.7000556758226248 0.24913366514410273 -0.18660152119589385 0.82797365681504786 0.67465009605576265 0.24555374648502798 -0.082358990820346326 -0.83142231871164551 -0.45956271223650147 0.31471150993419289;0.93405576041001837 1.0895112376846154 0.91656283916518466 0.65526733466236953 -0.28693033415128005 0.53152075199547077 0.13461967234211955 -0.63022506147247614 -0.0065050922548800568 -0.50779286972757554 -0.057354491304648106 -0.02061084246239088 0.35905005675424656 -0.42982829904405206 -0.0597655975547065;-1.181697129143316 -0.99972755481239617 0.56489826176223845 -1.5917281669273537 -0.26605592727034427 -0.19748730234007433 0.82321007552684944 -0.31794769527618166 1.0259663083252595 1.7910002536838947 -0.23872659224604154 0.3999797504123202 -1.1254011766239571 -0.28203768665690687 -0.67821087057638996;-0.16284281534314934 -0.40844955851516795 0.077320745878354052 0.63934077335662542 0.020077763172945916 1.1262518626419784 -0.39804415247583191 -1.5550903029735645 -0.61798149864136354 -0.87329979718371198 -0.78920091637935785 0.36774199143516906 -1.0360188847512446 0.083725587948119184 0.50867430841564021];
  
  % Layer 3
  b3 = -1.0303024722528646;
  LW3_2 = [-1.8283659104645367 -0.9916928206701241 -1.1779036363777389 -0.45957207162644387 0.27574846381682477 -0.95191815383469869 0.44320849532152556 0.49071267561964388 -1.0721952854908605 -1.162474020054276 -0.80941790631449129 -0.93126414794693368 -1.4250958392658617 -0.57717945822327166 -0.3797493822604659];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 11.7647058823529;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
