function [Y,Xf,Af] = COLomaDorada48(X,~,~)
%COLOMADORADA48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:42.
% 
% [Y] = COLomaDorada48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;17.6991150442478;0.00572573718866304;0.0175284837861525;0.0546448087431694];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.4896929007540383;1.8569570126429551;0.48779308325794729;0.90801633024053785;-1.3349073882892102;0.57660067189820075;0.50415584982609685;-0.57764135460735599;-0.1783483087433555;-1.6763481019747726;-0.84889612230000733;-1.0086332213067699;1.1464043840271874;2.535071281550175;1.4183539076918996];
IW1_1 = [-0.46289691411390377 -0.51488145588281575 -0.089295287772863996 -1.3026480707227064 -0.85173609672489192 0.63745230973334033 -1.0621923210004753;-0.47015871643443746 0.044526990754595194 1.3823518606259935 -0.44309413235271666 0.16237512901341816 -1.3078228229278595 -1.013698951514945;-0.27280808368784271 -1.4112879355886816 0.5014906278274075 0.49700496390730309 -0.91903179268528279 -0.51336411689658257 -0.94432210719686316;-0.48031025431296354 0.38158483600120963 1.3464118708118822 -0.20920844336600192 -0.28910967393950349 0.54017970965006867 0.69785747904784945;0.053792106958360689 0.91235683431788439 0.76462898804669299 -0.85077822278017701 -0.69771211764988794 -0.38027204551308297 -1.3899361321826946;-0.95454326369641884 -0.67416570740273163 -0.096373604994022283 -1.0667643592487637 1.116074308275077 -0.7706280205374354 -1.5251197507974916;1.5871589411179432 -0.43594084705923281 0.46200669900293773 -0.061470872328700688 0.66300791773643797 -0.95386506523088432 0.1436163126067419;-0.053319994025037815 0.076879219083913 1.5043023941123239 0.71542595006060072 -1.7566372899042437 -0.13634545949708748 0.045578974031256297;0.26607300238902593 -0.39038712459417102 0.67987536044613106 -1.2912040063835812 1.7573704874971341 0.59060508723150174 1.1486631706895878;-0.26747707854379621 -4.5104690100908211 -0.48040091203592722 -0.29327279070733825 -0.018078971942632714 -0.067319354047519792 0.23314762567059139;-0.71930287068650345 1.7508312329805855 -0.62521568694234575 -0.65284989448841246 0.12139149343140086 -0.056106761411517957 -0.878922127767784;-1.0978786380527927 2.0016607092196499 -1.0388873822626221 -0.39319373543978625 0.49059053856939727 0.26853662463727246 0.2684390385033501;0.52219386395908518 0.84039641302716261 -1.0026243447376952 0.52797347580696075 -0.87826659258625983 1.0810203201428192 1.0925340094261453;2.8499090104820848 0.29139089104733085 -0.29457992724467652 0.08064718501346041 -0.30285453422220915 0.23732622520884605 0.43018462419185866;1.0474520575338668 0.848932114463128 -1.6426246021014452 -0.20676855129773405 0.30719608489491851 -0.75511423074649953 0.97007592464688175];

% Layer 2
b2 = [1.6516521134687454;-0.78597205634876066;1.0952439253651292;-0.73393320525215144;-1.0482195336202249;0.27315403096238167;-0.20014079304110813;-0.065865661086712102;-0.62759888463347391;-1.0760861652697544;0.83293899663644588;1.0770163397421622;-1.5014523298962339;-1.8947362154346608;-1.3013078479875466];
LW2_1 = [-0.46547233818673606 0.87396158435543747 -0.67860435202322555 -0.6714896755565859 0.56619755878366318 -0.39421755822736426 -0.88031884219970447 0.3911326196578086 0.00090900754200776493 1.3718501351604759 -0.22494667916514072 -0.052211457595560347 -1.1167337466290836 0.51118481909105362 -0.22374367259259825;-0.29638284589960601 0.43290126142221663 0.7506625012776087 0.0340221404022783 -0.086547879834046909 -0.10089421085866891 0.044699490066434776 -0.47984728269384663 -0.17269836148338738 1.2865818353878544 -0.36908223836299892 1.5121417757752849 0.78863969776855991 0.32258667062685842 -0.46718250744424367;-0.12147600005394339 -0.047903189442015617 0.14126770178663772 -0.63688079762571015 0.28444134170634172 0.12694837393121639 -0.6261550955250732 0.68610009830195628 0.87303537257912411 0.53917712706562515 0.45841655214631682 -0.7085085530271007 0.98906724635421295 0.62619582528161799 -0.32049340356445594;0.37794957672435947 -0.11124517994367114 -0.64542369529614285 1.1090885367570247 0.41246057306520584 0.2115537656684984 0.33418573249352057 -0.38033128982408437 -0.082799295980392484 0.82321502311147954 -0.36878072902833275 0.27289794270963291 0.52735699183872931 -0.43653890108807131 -0.26264464689632422;0.2848759863452654 -0.13347873627565818 -0.16251211702886967 1.0190395961370315 -0.27053522115740869 0.25783988289493742 0.25382390848094066 -0.86541743682496464 -0.33975832949193041 -0.51611720948802187 0.026324417719374944 -0.44284047313443065 -0.10953001169557028 0.3806938204964101 -0.51984347645188744;-0.2098226935556031 0.10090406231478639 0.90438643069932911 0.14373432232569774 -0.29374752689234107 0.43630193978871096 0.82008963627780929 -0.2138686702797038 -0.41436607795577851 -0.61420586562476664 0.84440884622336987 -0.016490227680995943 0.0033730024832514388 -1.3092100253980088 -0.74561814143437311;0.31233192967511197 -0.65663089654845996 -0.27937953569670243 0.89251098315439514 0.26882805980296853 0.29825455798102246 1.047318916176859 0.046904997335072175 0.075713682127444351 0.92135349659998966 0.23889600787821255 -0.73111725860292653 -0.62808680165290853 -0.74433119114107571 0.085885285777251713;-0.9575540716685107 0.53869479003860932 0.7871902067686497 0.2853692355130385 -0.56150828980159917 0.70080799469595745 0.1884611461540022 0.95606846829658076 -0.0066437348138619692 -0.014247054691424715 0.20321558804025602 0.65699049363905959 -0.42899533189948497 -1.0665724858321801 -0.5818163207810948;-1.010465106993629 -0.14267666612654131 0.2963439464592641 -0.46582826557471585 -0.25685856060895768 0.16686339468831971 -0.0015024653611788487 0.19225411800699616 -0.099144162485522352 -0.078783202734556843 -0.9001234362028161 1.4387236680937958 0.12461402113765319 -0.63364918258698488 -0.4217691707042342;0.1275430233808878 -0.18138357684773354 0.040351163793045763 0.32151147986748169 -1.176931317325675 0.20382390003634843 0.34132051910972216 -0.036152712504569647 0.39636891631484017 0.025199601209047122 -1.0359181126713179 -0.74134532636836326 -0.056358712669141553 0.0971354767578856 0.5042234649973818;0.96633763100684611 -0.48999378998640108 -0.94087260289338293 -0.34411995782860832 0.39146957149055789 -0.20195552027173341 0.70362407735701682 0.7165959074234387 0.15673003321308532 0.47687479451676995 -0.8071722627288781 -0.57498749227131341 0.19567373498397275 0.82935503894861007 0.37602622392471408;0.39726459366272215 -0.3846008449444725 0.02984923590636912 0.0029929324198595068 0.18825433023431865 0.10197113902654176 0.96859534026022553 -0.10293319168827833 -0.061114939895900985 1.1059204077158655 -0.31716349980638847 0.64584505319966745 1.1853290384033131 -0.70940042908945089 -0.014860968501318466;-0.095849654261261422 -0.1580160048625022 0.3699235175697409 0.058767753015869589 -0.36098178512921275 -0.16103163331413978 0.88009326415195765 -0.0034204652656761869 -0.53014499108226731 -0.10623918003401772 -0.1838635462989554 0.73015308208789298 0.21904932136546962 -0.35175307316299215 0.10904956266222302;0.04496260829937046 -0.44871155365997989 1.0475966407486805 1.3424671908444989 -0.29083663654110731 -0.61057097402740867 0.21770619518983061 -0.57314219657594456 0.057331943228773954 -0.95432411122947458 0.98558052461798384 0.25246373291837088 0.70749087380447173 -1.0252640279682685 0.6962776252673073;-0.27270617714439993 0.53256963352519737 0.36815582305259476 0.62208760275975605 0.4729084558879772 -0.7512479275487266 0.64658448343041253 -1.4673738780793013 -0.40563084725131693 0.55598218404758992 0.11427700733255501 -0.33987752405090194 -0.44970616026318005 -0.64707619878305178 -0.69317257982580571];

% Layer 3
b3 = -1.5050747549927892;
LW3_2 = [1.2180427450327997 -0.7115322955055704 1.0822946741994428 -1.0066595166124654 1.099106373146681 0.81247700902297337 0.91049862213956489 -0.56855735047885536 0.82035841040524971 0.36833840989962441 -0.42841671557473682 1.2461921714621216 0.73797606386668479 0.95202668828574899 -1.2891882057701745];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
