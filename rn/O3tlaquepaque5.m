function [Y,Xf,Af] = O3tlaquepaque5(X,~,~)
%O3TLAQUEPAQUE5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:51.
% 
% [Y] = O3tlaquepaque5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.171659085057077;3.03490136570561;14.7058823529412;15.3846153846154;10.752688172043;10.4712041884817;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.6928217988323477;-0.13469626633311627;-0.809353315562793;0.98662588723583466;0.11689994317925764;0.72529841388862781;-0.30251145696534576;0.97962946094753001;-0.028195961743323977;0.13975323454227059;-1.3514775559971446;0.84837365291359679;-2.947453359921778];
  IW1_1 = [1.259133096014881 -2.3347116967701376 -0.12422813387205224 0.61553180883229974 0.073862977803032137 0.7010846923627061 0.9162452487925028 0.32434633594725526 -0.29392991815805802 -0.053064943145757354 -0.15767143536198419 -0.12179359294063932 -0.12496441543058116;0.54696084106979725 0.44475037147182844 0.23105538610199328 1.4717830298316188 0.46427530070351064 -0.14901610364349108 0.30041098099498298 -0.39187937162104525 0.57368893955527089 0.26966038308228679 0.068016288668419203 0.062985469171664019 -1.5918363037107448;-0.047079189960346532 0.99716849083697612 -0.23757709260285323 -0.1627285179849832 0.052946002388650139 0.049457924169605982 0.32913817828250824 0.36447772965360731 -1.0423725691642545 0.24057874070880336 0.78310343376512437 0.39578826270703299 0.42673521679739962;0.20522005404702509 0.08484235050422903 -0.84861242600703779 0.58831638583793233 -0.044207822994565715 -1.3230840470532246 0.32062606755908202 0.13458649338164361 -0.41160076671216805 0.0033053373821422798 0.053606519781720943 -0.20387409693065756 -0.11498798738890333;2.2447798243863613 -0.017735502335638652 -0.49340356380601252 -0.69143729928149944 0.37595725479446723 -0.46771433954571678 -0.15957845659401082 -0.097674325210586471 0.16769113582253259 1.3801997281835765 -0.1066689431882996 -0.052909693252787528 -0.67239055503463063;3.7679983455526784 0.0019525846136542978 0.61546739991512289 2.5740149387300963 -0.41468745089132608 -0.043428233532833899 -0.34531751636500363 0.011831463792864686 -0.38080973847328703 -0.66507026492631072 -0.30158472215551119 -0.20288577245040496 -0.29076668862096616;-0.071958879553352964 -2.0707687041798599 -1.8531995241197252 1.9754598285691158 1.1915155293766271 -0.99546565740978366 -0.17668082401633944 -0.01695246921226197 -0.462850404849314 1.1019985374977157 0.82336653792577819 0.70089522165280227 -0.70810412220749519;0.36539430247669902 1.054715512147308 0.14075789022613361 -0.65506728601892272 -0.71571855088375236 0.35843558203399967 0.36095510418097204 -0.2675241577031362 0.21867459718176382 0.11696534402217307 0.60437258701639318 0.35056616381970929 0.41924892125535473;0.47668138424112333 -2.2489966369462588 0.40176749521880334 1.2116317651743791 -0.55045792975978802 0.19247751603575247 0.0030899015376375863 0.15431474891866742 -0.19379372389912705 -0.97684615217721593 0.80776606338236301 0.48138756665341725 0.52783400734033281;-2.0179984555247601 0.18032722430680451 0.64697178144813916 -0.35444011719323243 -0.23119876106825277 0.3908696064242812 0.50302526286350357 0.080272687151368177 0.54584498851671415 0.053479794285608062 0.37459960100468925 0.18552479620839712 1.6698549262746427;-0.79519777080968757 0.039280996316385229 -0.058459411451941855 -0.70806509831670916 -0.29601020239893683 0.12911710472705842 0.031386277582232509 -0.073116109543527846 -0.013880519185230568 -0.24826172468317456 -0.025308314978962056 -0.0077338703869821359 -0.48379692717618544;-0.48348011238801486 2.8695427763387031 -0.18013666270367287 -0.64164944104475019 0.099459164960958871 0.0073973739650489076 0.29199912904835806 -0.31038127473064897 0.11763117518716937 -0.10693398332172659 -0.76952352995994411 -0.33523819614687228 -0.49991799879595616;-0.74350576928579992 0.65222881260521215 -0.013151376572625426 -0.91811749600184156 -0.43005361398150999 0.10244773477747185 -0.15445374129256925 0.054963807811502924 -1.4184298535119659 -0.78630104998279626 0.38017526383398165 0.011253288121450239 0.67562380060732075];
  
  % Layer 2
  b2 = [-1.8135877757858325;-1.3100430267778218;0.43185457854064024;1.1257079747818941;-0.30230447180767117;-0.41280965057984692;0.39423380437238387;-0.65915182879607193;-0.79174588999445361;-0.50943889816714505;-1.7349947648900492;-2.7065784579922654;-0.11181956077382008];
  LW2_1 = [-0.61772521673955205 -1.2157454222712638 0.38274585146431434 -0.99462065648039677 1.9072920660412178 -0.4301675168530068 -0.24510538909886578 0.060525632035522858 -0.26334681109385571 0.22766926362057988 -1.1075783427710297 0.86855724388379352 0.49958701451821014;0.25709497934881087 0.061578399184043384 1.4498184588884053 0.92481351169609816 2.1857291792025899 0.26501435067936385 0.59121027893830636 -2.5724593888559628 -1.3135508640043305 -0.2841191137594104 -0.3810387737421651 -1.9318612306273304 0.53189071921645636;-0.36018648219424998 -0.19044941057350179 0.26506351603203576 -0.69861380689351338 -0.24158653493318216 -0.14390753235435402 -0.49720841786815595 0.32441477754670156 0.22623853085776582 -0.8411505437178749 -1.6846058523483971 0.92652188823497272 -0.20891900334614197;-0.48194137940799286 0.64712646483345992 0.43841606172052355 0.28117014945012131 0.74903709862500445 0.2556285367133721 -0.06276121226325107 -0.48236209356165899 -0.4344523366497669 0.19565480499358781 -0.072386033864207722 0.89523166540956534 -0.30179639938426422;-0.60531105880187464 0.21533728829132573 0.22535818170289348 -0.64442212310412816 -0.45529323931793675 0.12172898574272131 -1.9216131604656104 -1.076977443100354 -0.47064109546362676 -0.53094202663240164 -1.5201132763010592 -1.170322100990417 0.7059983887007163;-0.87023342649797464 -0.53304272284877185 0.33628775808061484 -0.18575070803930102 0.69840676969717852 0.18362789397420851 -0.4290359430888942 -0.19028619816208853 0.84615887945416435 -0.023976432929351428 -1.1014419132734732 -0.018119385562736401 -0.1809679261750228;-0.15291630006346935 0.77383068933615262 -0.41632528585154033 0.58313145981179548 -2.619824938703919 0.3886770211519841 0.16062241390595955 -0.094363120956515598 1.5475093913925262 -1.5273103334496394 0.54356682193063277 0.77776558034719256 -0.42051426989388213;-1.3281854022678758 -0.46643266833463093 -1.41092146957428 0.00098803117837258786 -0.21180572274213413 -1.2808376416616938 -0.1836958393301393 -1.1840913924004393 1.139827010985379 0.52279577385991294 -1.0041474620262991 0.55841554307056562 0.62087107102463723;-0.78288042632714527 -0.78634299895820836 0.36804368763377726 -0.10362969464143892 1.3523933616665422 0.52095914284053169 -0.47636993458828691 -0.09458769013715182 0.53079724536524997 0.65324125839952951 -0.94187681459465245 -0.37215465224526478 -0.69252203042573435;-0.3546695257783995 0.65886355079674408 0.19038547963537847 0.010917526673008583 1.0793867880955148 -0.29703556898874617 0.35211256445000533 -0.67982853358421458 0.5011387499401847 0.42564442168678618 0.92200661097460967 0.60403230938578978 -0.12491450931389053;-1.1843159363473796 0.72258152121465757 0.18977195657978102 -0.26152615142900448 -0.20202731454725698 0.45227599099290861 0.089280934115277072 -0.37298033962986754 -0.79044273648910401 -0.10599819685993547 0.85810435145850428 -0.66485229255968736 0.60256462168719671;-0.78540107206861232 -1.9429400906305159 -0.24483684565911007 -1.672506008499743 2.2058802257951351 -1.8443866634037294 0.27627114079871146 0.40828449624625085 -0.3455585918248596 0.18672457708747117 1.2278570224543992 -0.80539215702293565 -0.01379585626667716;-0.92075285992116218 -0.21356851826575102 0.6516778783619801 0.6389788806220642 -0.96535920486725191 -0.35320504652945978 0.015618714865112961 -1.1282986192253732 -0.16637194818957438 0.63741324907144248 1.0297711506653844 -0.64893612413871804 -0.39260791489265739];
  
  % Layer 3
  b3 = -0.62097908798251833;
  LW3_2 = [-0.88636631299705337 -0.24265215137046442 -0.73213273270244761 0.56820824630911926 -0.36260014662897971 1.7122686368330435 -0.78266664462545044 0.65982082278403187 -1.4333729052188435 -1.0558473119753928 1.7714297437585147 -0.28398763043943465 -0.79876996007830037];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
