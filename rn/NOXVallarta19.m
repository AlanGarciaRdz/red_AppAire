function [Y,Xf,Af] = NOXVallarta19(X,~,~)
%NOXVALLARTA19 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:16:29.
% 
% [Y] = NOXVallarta19(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;5.12820512820513;16.1290322580645;0.00782778864970646;0.0208333333333333;0.02710027100271;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.2397247081050846;-0.4721423681550645;-2.0413240228046496;1.3855059702617651;0.56196967904069373;0.33131359851577685;0.13288640787915268;-0.14986677278506155;-0.58448310781516832;1.2422873132033341;0.84391626822315524;-1.7205042926071996;-1.6877971119801072;2.7580039385589807];
IW1_1 = [0.7510172055639962 -1.7471717512244287 -0.0037785248496340867 -0.12121864247408806 -0.32655401919836652 -0.2475552705579798 -1.6035248779551332 -0.18105400213313561 -0.024676782408783765;0.11284320336082818 -1.251602560824417 0.37979359915691824 -1.1804589867878019 0.60254578162314387 -0.027730833740745364 -0.5869955737549134 0.043965553741398933 0.86178787163939718;2.7036879763622221 -0.0070009609785761859 0.27367178820468213 -0.43410690350567388 0.16434025674301778 0.073183076991320331 0.1952936830409833 0.95962923503721143 0.10514806298048465;-1.8372031442737433 0.4239753555454594 0.43738339841223967 -0.051693666224653351 -0.34383659368668718 -0.37725258530572536 1.7529421582077882 -0.67635479764860362 -0.40892587058087865;-1.0975639718880896 -0.84927014364451248 0.042060986614933259 -0.16767904396486691 -0.60970406853537307 0.16328880587843986 -0.27388571783399096 0.17667643178485315 -0.11683428516621414;-0.87653015242638599 1.2150895135871851 0.18934171190952037 -0.26664755332913953 0.080719493740602083 -0.38297136836821422 -0.16240047076589759 0.090538712393971751 0.25479930051017308;0.93536554794087101 0.68223131914415402 0.42562020649833365 -0.13330281195044924 0.41387902502673352 -0.59150661790173897 -0.074015757474415467 1.3780711316231633 0.30737867653780854;-1.1397411553636698 0.33065052445352155 -0.11245593319529198 -0.017173189133966177 1.2732886376211843 0.13716304699522366 -0.10940766327722951 -0.33321473611246799 0.066851292501724849;-0.07797825358212028 0.97100151421376824 -0.115137824577911 -0.090096147473821955 -0.35444348574775669 -0.3744158016194199 -1.0337622201845509 -2.3107198405473865 -0.21991090132597294;0.93357896024673204 1.7405740852698044 -0.15330586260489301 -0.013985486883062465 -0.069470471508889034 -0.079454789012071675 0.94417627821556427 0.45479044665531482 -0.084803806339090237;-0.22109584297023441 -3.9654470684325731 0.15881408142288331 0.061395729684775809 -0.31139098027883694 -0.22486099787783459 0.51470213204077886 0.24967845131408561 0.1509314539897687;-1.3554960728328649 0.83781905128546807 0.24094151739804337 -0.48418103980589938 -0.55101133076282749 -0.60769354792420893 0.49945936450577405 0.024308855727885138 0.39706371980103844;0.82568034392781475 -1.1974227122146843 0.13906794982608608 0.10609364716569919 0.65177087836969894 -0.61040906393219485 0.46150748075205761 -0.95154126050061327 -0.36415292551926443;0.036125868033246022 0.25994554936457692 0.20504895738798246 1.0112716339726047 -0.047317550632476772 -0.26023087957132202 0.8833217289184051 0.97126874513476968 -0.12513454993513914];

% Layer 2
b2 = [1.7172509667942322;1.6950377709818696;1.2977855922762169;-0.86520537792827545;1.1842409128584028;-0.64834175063645461;0.33463391191681519;-0.84688718101588623;-0.14286885628665602;-1.0040267092545661;-1.1782794795599159;0.96505960823350667;1.4414415704874022;1.3110285639445418];
LW2_1 = [-0.25970854781718689 -0.40816837008113249 -0.0015889053948963464 0.15683892356228729 -0.88532769608963835 1.1246884176658298 0.28581230259272367 -1.034733716738417 0.0038566311239827053 0.41348622531953577 -0.64616410429549442 -0.17583934522835129 0.19547727370144455 -0.8835778901392658;0.34765626060775462 -0.33846926410153022 -0.57296973705508547 1.3886412305742857 -0.71096365078996948 0.80758813191404621 1.0157014979412857 -1.0241333000752488 -0.46211279189535487 -1.139363702569552 -0.32504785692737304 -0.091847736920467299 -0.371578661317438 -0.067022501591718436;-0.17512904358455322 0.025664458075937341 -0.028571764876976567 0.557644951054029 0.69377028191427859 0.30513090218158012 0.36658477232434189 0.42069932828124312 0.025414698147462503 0.39041057210016916 0.75328410247704247 -0.75941493950913974 -0.26051133439773466 0.49302959226747511;-0.2331968730349292 -0.16943157046585508 0.64202240972129654 -0.6897190336670399 -0.75630298538738949 -0.95860951425947682 1.1971851336402437 -0.63278557723002871 -0.77146151387911044 -0.077014098085001426 0.31353530536488267 0.43872481625043674 0.99428916748570639 0.16744958630442158;-0.88444095643969256 -0.0033650926474222964 -0.28798184465735599 -0.4110135440923699 -1.2119400187461271 -0.44445310310678077 0.36662186095798505 -0.59365527260760886 -0.022711374486816437 -0.5345495049722665 -1.7141595956158788 0.96264260020656744 0.30250251743299211 1.0835455956046944;0.36440880526662656 -0.34663884967306763 1.6443296397771687 -1.2205793607420663 -0.37079016457872382 0.084358225414742735 -0.42921528963549693 -0.29557239144305641 -0.42656208414529295 0.96608838429706168 1.2162062494230979 0.70843021150738172 -0.082594872788726945 -0.30799041206322941;0.29352933087142274 -0.3677873105729591 -0.16111397522227722 -0.13382825016511302 -0.23491864105365617 -0.24241989269307487 -0.31205742640253015 1.106755379445846 0.05056901500986076 0.5171215006696257 -0.71249399168020622 0.03881874713957939 -0.011843229787464639 0.87296231334912344;-0.4355795215616986 -0.088780863263668325 -0.74091256390636573 1.1278560904788306 -0.73283822968987444 -0.10350796280880729 0.89905976658606812 -0.18485510032216354 0.12040421425078981 1.7651404206062038 -1.3073823369451307 0.69779174503477881 0.57698274868317656 -1.0251766277712895;0.21654765031694254 -0.021379308201562211 -0.453015705962029 -0.12655738319273077 0.93073710560574874 0.29414860566414364 0.4329393557218662 -0.52704928289428488 0.6654941690726226 -0.6281510681813961 -0.5198010602282972 0.44638860579525341 0.54289162505106725 0.4778525632793193;-0.36190947736954227 0.057276588728012605 -0.91856432713294089 0.071877212497928666 -0.14986331346784232 0.071870390049006694 -0.003093644559505916 -0.60397846348105733 0.035547242689773453 0.52687784030798734 0.61682602425063893 -0.1168346068409785 -0.52806855829619948 0.13594375211795715;-0.64261376382360968 0.32565614386432179 0.86640386190824148 0.076831809565390569 0.40601789804890454 0.63431976137683299 -0.9563693284675675 0.24865544633441189 -0.27581680067022762 -0.29136241287733666 0.24891907303274849 -0.036217902083313838 0.8635911226970957 0.32999722835574347;-0.16781381487783764 0.066886983991328794 -0.013345188893569808 0.19470428215190463 -0.066487289322747292 1.2260936403539042 -0.48232132097441083 0.29672227062291612 -0.022225051684467687 0.32113277370519561 -0.61836202255018957 -0.41423118500784323 0.34089210040898116 -0.61892048183866355;0.75056333605907999 -0.0030804531170049911 -0.49238926638478137 0.40024052735556814 -0.20619031079199068 -0.42539756574346194 0.22850202906946804 -0.62517624917224768 -0.83449888750639944 1.9402307654314768 1.2485356836326593 -0.11092968547043902 0.21884421804509607 -0.20565413833425061;0.26636266155426547 -0.6966346974037636 0.24270310171049966 0.41895939580719344 -0.0064894002702337063 -0.10491098955954399 0.26791528500450906 0.41546265043888758 0.4472889073669653 -0.03174072722180496 -0.67419582380544008 0.46055115933514229 1.0806471301008247 0.63926117742267619];

% Layer 3
b3 = 0.070870034617775787;
LW3_2 = [-0.73007866173963665 -1.9782480940001577 -0.92839042002717553 1.1142536932358134 0.8681720924801648 -1.7066533402780766 -0.33494852606505904 -0.8802549027894363 -0.22819188442707178 0.87317515640339649 -1.0298321334155907 0.80439182568158296 -0.40825121421441202 0.31452219376644674];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
