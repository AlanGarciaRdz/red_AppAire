function [Y,Xf,Af] = SOXLasPintas23(X,~,~)
%SOXLASPINTAS23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:48.
% 
% [Y] = SOXLasPintas23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.0179856115107914;95.2380952380952;0.0558659217877095;0.00576368876080692;0.212765957446809;166.666666666667;45.4545454545455;29.8507462686567;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.9107443006576188;-2.0097731516157116;-1.4137852039670509;1.2356630171496168;0.79309164826733969;0.35892901251886933;0.21861663979450274;-0.6480376339470777;-0.13536132694403422;-1.868326866861983;-0.44875867149994736;-1.4791959563800703;-2.0637317944965399;1.8505769778506715];
IW1_1 = [0.92358216085684386 -0.43372668828465899 0.29418595571266254 -1.3205945229306639 -0.26618284867306558 0.96448907360100611 0.36752637166491819 0.94626530830356692 -0.3333249808309014 -0.97733678831009407 -1.7438705730848052 -0.92310597239227232 0.74796824039474552;1.2543042189900446 0.094384464115846764 0.65932478269027628 0.66098410813908226 -0.93986567232220231 -3.8729396071997031 0.6823188520838892 0.22081038747961976 -0.027012201088137608 0.85488804592739132 0.53957804055449066 1.4620261631607567 0.25545848317570991;0.3207441816470184 0.054116132700621003 -1.2440892475782808 0.17435545161953325 0.23671693607559383 1.2399680211402673 -0.85057595305143008 0.34456796590336203 0.1897893293820411 -0.12845008649799591 0.083091753762724221 -0.15056470279246006 1.0414049155243086;-0.20606315070438627 -0.25400305183947031 -0.76599734538142783 -0.85805496411429893 -0.8279326682258652 -0.72653611938133855 -0.3150930230846799 -0.41131574584236474 -0.16252097174485775 -0.0070797444391174236 -0.6056635084467038 -0.30248253712684708 -0.57235140405838647;-1.6379996005039212 0.1055787980927762 -0.093874788924870889 0.079801960327222213 -0.76310549747860967 0.29375397551350263 0.46067160665428619 0.069233285510543488 0.67432345293102702 -0.62272299158992706 -0.8530244418489481 -0.17922813890029296 -0.12030781480162729;-0.84601798411100826 -0.31221590988598047 0.65530686621502743 -0.091020878959782239 -2.6010122313064596 0.2188849499893602 -2.2892291919060148 0.43371731972871419 -0.0080478611604924803 -0.1397399682690843 -1.9391742493716304 0.28258537419785529 0.22751252844520387;-0.7473387378580848 0.78597567660217893 -1.2224176400183451 0.18325146391379679 0.64398198130625428 1.6866911785780416 1.1161332909484185 -2.073150011552348 2.3655813162636292 -0.60943750035489841 -0.21983466204659918 -0.36399465360016992 -0.20918088089849146;0.21970967126608684 0.16607815161426415 0.36381258230985125 1.4591159724122937 2.0604256527757361 0.16477704707182442 0.62772902203763437 -0.60987890522012012 -0.67890130065330245 1.2452468657318672 -1.7414394579922652 1.3361837512758663 -1.0681215396979731;-3.2448556854593411 0.061999880791487438 0.10303217487127717 0.77255723833267165 0.075904816328953378 -0.47861404677301628 -1.2239352709537386 0.32471850730721991 0.0027760872712676108 0.42419597069045656 1.7139075349049486 0.54545197584527105 0.28361553767968045;-1.406969890304034 0.082016593818701439 -0.4766340766560771 -0.62972583307536312 -0.53935014184632246 1.8813706626826741 0.13711298628327931 -0.50738021579876824 0.21478337312507947 -0.3833235551819475 -1.4445054444310335 0.34935594749299992 0.47613266662139131;3.1619861035721146 -0.20110202476350433 -1.800268139659515 -0.0013673678669162276 -0.10569138820423096 1.8203679756971085 0.56866486906883329 -0.039486931335264049 0.25139974403153975 1.0159227350826681 0.43000099818183157 0.64667080630455398 -0.60197715648742178;-0.29786228947512483 -0.03872276379094361 -0.2943196182707819 0.52899195325979487 0.41710860953636308 0.40644656839034787 1.2246673800928098 0.048774701907759621 -0.84257549921053299 -0.35800881797422124 -0.081775966760689101 0.52105752936404104 0.52845803882252129;-1.2452369572241193 -0.12668620044364959 -0.60089188888389211 -0.76701099044447774 0.96691133326959233 2.4991156978939766 1.3788528233825554 0.56891812309716971 -0.6814466352134837 -1.2654955915518937 1.7215466898129486 0.54153681419992838 -2.3223078031242395;-1.5866391006073086 -0.56613338824543114 0.27662998830294916 0.362578935183405 -1.7945296388667817 1.8526227560139426 -0.44215187888299956 0.41639429734158234 0.10021092975749649 0.96311783011545526 0.4093779889399064 0.45413844223300737 -2.0693298738115602];

% Layer 2
b2 = [-2.0523299947732365;-2.0815267959781099;0.90300821710351264;0.88328514023197491;0.3243507724920433;-0.016034489468494659;-1.5903290949331299;0.05780935553925684;-0.20668561808962996;0.36728242060639837;0.97672050799151089;-1.3611693868864387;-1.7541896567222648;1.2971943365110816];
LW2_1 = [-0.056276814201068323 0.6566469511005425 0.31782746861359301 -0.24476812519008487 0.10401838336264148 -0.84704696624334963 -0.42313646880380479 -0.40525120247830365 -0.59776188072765823 0.84238703777142054 -0.010635965759802432 0.95505669291125705 -0.90441976568091109 -1.7461394046330736;1.2714677358493365 -0.24473060688204371 0.97307159599810777 -0.40223873733891141 0.59330628913964512 0.35418225551309412 0.04405692650409989 0.32410305505112713 -0.37646881633295526 -1.227265639671353 0.20089234809892481 0.91556297237187201 0.20373626299005118 0.083199399760733261;-0.026885600159033317 -0.52002185908872633 -0.20107144254336945 -0.085543858340739812 0.035670132969116357 -1.7194755373315378 0.1382797260260063 0.068928563723826358 -0.047019934063959573 -0.37201046259712561 1.0265613176664068 0.57132883430513148 -0.033202861311161097 1.451629948452853;0.087806956833329231 0.65973608959159424 0.41338685318860469 0.75709852757935669 -0.10124833206972345 -0.024448592914246389 0.53757048929364237 -0.34816963464925843 -0.67824874910622734 -1.4826940287108068 0.51455950985633792 -0.09317821883914279 0.42572094877747974 -0.85037056401188038;-0.2113291101065764 0.20501646232129023 0.83676147454107641 -0.93730371616449959 0.15617672415194769 0.043525958079295712 -0.17097021108974067 0.95423271990222758 0.88109789330861432 0.23327056519354389 0.15723354556561481 -0.17577390949106678 0.54426367627208305 -0.096975047972617204;0.53620730435526986 2.3356462029864353 0.44881185040305571 -1.4231935199033121 -0.2254097465597773 -1.0329828239597876 -0.032195288857863796 -0.38426383730755637 0.6111415814408 0.057534004583386124 -0.50160896377700637 0.13530592721401336 -1.0942346667591447 -1.5168211715076974;2.7179147519955333 1.3575197702930988 0.73657853548443109 -2.0338028214857857 0.34270892564706096 0.34951266788443636 3.648590025414618 2.7260698917726063 1.0009441748389238 -3.8354662406940756 2.722528409075728 1.9688082669086262 4.8624209696361707 4.3123418634960293;0.0046300411695623881 -0.46399343993764841 -0.33508245583809709 0.88439198707559874 -0.13125514611151787 -0.25577762514812175 -0.30258728328641921 -0.01187487187104927 0.4678244115537003 -0.65093400622720432 -0.71213508272762616 -0.52761857673353407 0.70644031957685072 0.18706742363317355;0.16984864873024752 0.54240629158703413 0.20940604736308077 0.51694141341345645 1.7962423591016705 -0.95741189363632007 0.14274420251518885 -0.48287831244629265 0.87510220381339288 0.6552784772465734 -0.81465824140683951 0.28465455261504513 -0.14215490603249972 0.24203233290568682;0.84079287301543204 0.53354042843898608 0.96330422993768028 -0.81346224324326033 -1.0010968434856313 0.10521557973041731 1.3829337057809745 -0.30504483810878752 0.56067001161147134 -0.56430037847545322 0.20207656540401001 1.1968027884403003 1.3593054857102056 0.60819187704807887;0.99999609274139623 0.84608593543384347 -0.37239622969542102 0.18732169984816738 1.0149144170733406 0.770254074351854 0.12256507112183038 0.53376052534399732 0.15191195077224684 1.0056205006451009 0.29933943760786813 0.35329757659293076 0.30835064416329072 -0.72871982030308202;-0.19365663665060839 0.79032529042632427 0.35017661981959108 0.15586118420307454 -0.78665793390932093 0.2286694149678114 0.23271073108767296 0.33411542871829475 0.75485793990947569 0.048725746993361747 -0.32841321940118412 0.54420133178489927 0.81014336022327016 0.33943942189579002;-0.4847160466497481 -0.2836343337929873 -0.2514811314298529 -0.11102839226290517 0.53764345274259773 0.57408580600887582 0.28629355962246616 0.036228767555344564 -0.48103769444916833 0.47011963159579784 0.56572882102787647 -0.59617946264722388 0.25381984105284844 -0.18594401020672441;-0.07424029239579133 -0.56281772278910647 0.65070484269055062 0.16197061644060926 -1.8883691902725426 0.76294813676683826 -0.10739879982487624 0.5137491884958959 -0.62954160046229346 -0.088290210967946731 0.76912034965912923 -0.033466242801114265 0.049339318305448354 -0.10340850831717596];

% Layer 3
b3 = -0.3741521049835666;
LW3_2 = [-0.6738378832666756 -0.52559952495516082 0.10162259820615313 -0.12643956645399371 -0.088677002412717101 1.1996916680870828 2.8328503029921954 0.71568735954478757 -1.0170828835093721 -1.486884771341511 0.11876933458108183 -0.25718497856077971 0.20583948421821047 -0.95798349600504151];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
