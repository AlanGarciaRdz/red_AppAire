function [Y,Xf,Af] = SOXMiravalle16(X,~,~)
%SOXMIRAVALLE16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:37.
% 
% [Y] = SOXMiravalle16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.0208986415882968;90.9090909090909;0.056980056980057;0.0063552589768033;166.666666666667;45.4545454545455;117.647058823529;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.7618521183611056;-2.8078021573256686;1.9289762411420037;2.4107370257007505;2.0051211503959556;0.97074902038590571;0.54396580139723127;-0.79776790089855776;1.1992903740638485;2.7354801590957898;-4.2181804007217867;-2.7210762020285477;2.9229986435754274;-2.5865490143705108];
IW1_1 = [2.2879651136648853 -1.9771977605679552 0.35616005740754325 -0.089717494140585316 0.87658340088407294 0.3778214416560588 1.0745652594347272 -0.52596801162050111 0.28336142451970803 -0.77297441040780313;3.1578964507464087 1.2190451558481679 0.80757568785200529 0.54789849792360423 1.2233657093370363 -0.39057387067026522 3.2168475937729868 -0.95106039314118151 -1.0275778042855144 -0.97172754458686128;-8.0333868046522916 0.25959711406811126 1.4497955053791498 0.064046587571515406 2.7529811971305294 -0.052512975791739622 -1.0343891030230856 -0.99619435256491939 -1.074970185782842 -0.87928933328554015;-1.83085348125384 -0.037461249361990884 -0.27115003064183252 0.72310888537769036 0.057980777411441239 -0.076767983063349282 -0.91937656436071913 1.2747085941116059 0.5589993632687329 1.7189097861450917;-9.8775422215739273 -0.13873479986198187 1.6097129604916594 -0.23315652962181424 3.0652956803926563 -0.1838499218962176 0.34033861102454993 -1.7460473562532517 -0.84203315821399549 0.605850868626442;0.32037429053914152 0.010841860643126876 -0.24794518222640793 0.33061757560847765 -0.56833760586688475 -0.10777977544236153 -0.26491626338137114 0.0037357493286781073 0.12508073234332254 -0.0082666359239868467;-3.2964970313464086 -0.094456618473882717 -0.98112162018444382 0.011400085806345335 -2.4720729597031261 -0.27581222419091384 -0.18123009229610498 0.49190411740127599 0.61084210955358464 -1.977666830999038;0.90141283565507668 0.070721799647407602 -0.84140100232029491 3.0028675526582727 0.18940402614569654 0.31335041818450077 -1.4032201793126371 -0.17380665941795662 -1.4175435969702102 -0.25404719957388583;3.4391903501977357 -5.0509619996412312 -1.2132047396442807 1.3166033369098034 1.4778743109549504 -0.93046311238472157 0.63029408676584542 -0.026072183144801898 -0.52211710518875665 0.10990534570414132;5.8245859134607514 -2.417532876551197 0.51379027639091934 1.6323451274501288 3.1078210352058502 -0.42479936884852931 -0.23645159005724686 -2.4836803558735108 -0.12955261750667349 0.75458167712566893;-4.8085637819823415 0.021223788000191687 1.1894242023583883 -0.41939476278864324 0.76748088996942332 -3.0130055978329158 0.75729889083486868 -1.0502529945856467 -0.025269234776920217 2.8989966463225962;-1.2513407134229628 0.10529114244627596 2.4756416612852785 0.68859682894766594 4.731525246737597 0.0072294199578302552 -0.30462240717576217 -0.051624171955192477 -0.63895852585998791 0.098755269571202342;1.8111467144657107 0.029939101005769603 -0.19784763037679043 0.76974771359563143 -0.52012891981606024 -0.19038979777299544 -0.50085479118194931 0.54444838085114655 -0.067081825580173574 0.58797325917696253;0.7174975575115865 0.033850865478272686 0.14070751112312224 3.3283085882599486 1.9998483802453326 0.1881498827040983 -1.8118077547625362 -0.11172654806528158 -2.0626298601823172 0.020666265028440697];

% Layer 2
b2 = [-2.9754605603704247;-1.9135391264474875;2.3226712183055387;-3.2896907809048241;-1.1589727400642411;-0.7094847035984666;-0.59804764273869038;0.27591581014715583;1.0115757268366772;-0.35482805880590379;1.9275976033381104;-0.84920750498064679;-2.871468970719377;0.99012082111149513];
LW2_1 = [0.69261282991354212 1.2350741626257895 1.8213457826408344 1.1458014954379812 0.38727845298961855 0.51205392310820264 -1.0130780536215229 2.1972937967604689 0.099352875595119655 0.60782595105172754 1.347568628900883 0.071080284102285493 -0.45427977913635004 0.2148741237228286;0.34832491362441037 0.73561751404692544 1.1074440035342163 0.19102336971449577 -0.0072971060451342915 -0.05219837010289298 -0.04100550628533059 -0.42486705630666316 0.055732977240668377 0.70491717814015975 0.9408261583848746 0.30512588796246254 0.26041833880212684 0.96751268520430911;-1.1921195803090103 -0.8342513776479058 -1.3347953112532198 0.89606908426153553 1.3694249163939454 0.1160407532341851 -0.80019593030489788 1.4788991487634155 1.123872686376169 0.75925993267939695 -1.3677080872886425 -1.6391313333588018 -0.64787630278281205 -0.87098873008670674;2.8477127824960355 1.1601538500999049 3.4993636606534038 2.3453233207542672 -5.9686748510516123 -1.6998054203549353 3.9336564610526596 1.1665528550736115 -1.3999057573990468 2.108266261935531 0.78278254334876951 0.72925440625614246 -0.46461691637338182 -0.95095231674994485;0.15083205819167189 0.30185706376022381 1.0424035289381668 -1.7512981708355153 -0.64449528015586743 -1.2035619500086785 -1.3768170303499569 0.87387121980004989 0.045208454676086501 -0.65267418512749753 1.3637338324622845 -1.1110482688614038 -1.6946158495521211 0.27839898118170731;-0.027153883584414822 -0.10174938239867821 -0.76593936900915693 0.69488940994731296 1.2391249631906947 0.52606327020416965 -0.47430041509771886 0.17109968018147093 -0.030933857663817677 0.099140669598620015 -3.0547869697318308 -0.87315603474672032 -1.1124917384629114 -0.34140020581405323;0.28454916340359376 -0.0042161821333799579 -0.90467599280639988 0.46458265763170425 -1.1843997655236203 -1.4634737454908162 0.18765955956935745 1.0268912422054137 -0.081570493037528113 0.42729972236964497 -0.37274564490996093 0.33425518483169686 1.3672779110258471 -0.47911791307945972;0.0044377407465001793 0.032392497998465677 0.20342122047723121 2.5776129226422566 -2.328529439336172 0.89859955302618189 -1.840105151438477 0.65860356551918187 0.22387688215262935 0.044305813693494484 -0.1002516018624473 0.40690780004595362 -0.58528431491604926 -0.13117575631041123;0.10290923992182205 0.082332311455791465 -0.43396965888631195 -1.1393397605872577 -0.42002643434500181 -1.1597536425818564 1.0255796073114281 -0.30730654163587828 -0.071806767119475867 0.059807578953317495 3.1372356923175082 1.0531701139586425 1.4933639042253453 0.17507880233503312;0.42918659529502917 0.46045719782602901 1.0117582257623776 0.32285455753201525 1.3491088590319069 0.49942979641029656 -1.786955464144061 -0.053386147909659933 0.051772138724709711 -0.18398287154712345 -0.59953484322087747 0.33467077998706479 0.31384040391496798 0.081885979030378406;0.6675970382798041 -1.610180034909102 0.075808874853934241 -0.040518400026052642 -0.099910365313847352 -0.25539613002035855 -1.1815376379122056 0.11342734784574469 -0.33832239707606254 -1.4681832362092393 -1.1739163718590615 -0.97097475137545819 -0.397482662975854 0.32775629044525784;0.69925198071272165 0.41425122345619814 1.8775093875362283 -0.5432366957225756 -3.1687484189807127 -1.0315419632623362 1.8742325924829855 0.44635094710416612 -0.26343242002868772 0.53287074105307097 0.86831735221084216 0.26738377997011253 -2.3490469425072535 -0.39665796183726076;0.1814695298522192 0.37872194472165288 1.2431174266046263 -2.1738027115026068 -0.0060731509898726008 -1.3165384028813223 -1.9986980445413332 1.0282478932082364 0.047609488454984569 -1.3281738058601296 1.070707614612044 -2.295372260347325 -0.98872462236073022 0.33380896625416423;-0.22785507060081647 0.040571910699094028 0.61023902687263576 1.5779584216719913 -0.1683240446176065 -1.2094889154387662 -0.9010559604845958 0.56853736323411952 0.14951479367876527 -0.093133934243721656 -0.91559476725671074 -1.0850236294395244 0.80400705078473023 -0.38323890718082859];

% Layer 3
b3 = 0.40714660628969046;
LW3_2 = [0.81643781324200826 -1.8954187850999225 1.3895495389355319 4.7624554728513262 -2.5898073295155681 -1.6694695143787235 0.3255334423399846 -0.27246035658864681 -1.6409336386092115 0.071318528776522533 -0.1885988826097233 -1.4826527235757012 1.8529569790301859 -1.0727877493390936];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
