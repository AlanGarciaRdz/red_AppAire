function [Y,Xf,Af] = NOXLasPintas23(X,~,~)
%NOXLASPINTAS23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:49.
% 
% [Y] = NOXLasPintas23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.96825396825397;18.6915887850467;0.0175284837861525;0.0546448087431694;0.00640204865556978;0.138888888888889];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.5209097932644333;-0.7537354248451027;-2.8791089122075531;1.4111618259154506;0.89507420720363806;2.4927242206104561;-0.78687040437790579;1.7580868487228438;-0.063108107243608227;2.885481748057773;-0.43697007409789884;-0.016969511034007997];
IW1_1 = [1.8985975760980616 0.93086107417746267 -0.21833163565471411 -1.6833031283337507 1.8585239904583675 1.7505103468410876 -0.0025936192022064219 -0.75073993993706034;0.17836019691328478 1.0530542657721798 0.95476565097012245 0.68287928690640476 -1.0501728503404486 -0.078659238546439678 -0.2806950142888322 0.36338806996884787;0.93026951257880419 0.10692879954489455 0.99271832032254137 0.19187198802533301 -1.8556282325729321 -0.11976790968495368 1.3314678745305009 -1.2584705028350256;-0.088669802401966702 1.1594915331248392 -0.40694967560903966 -0.0054075450943764959 0.42853444195334289 0.66918990921786803 0.075058985259326527 0.13403857797437388;-0.0073178127290824384 -1.0972709624661976 -1.1836818899563357 0.93537618262132349 -0.78806616152305686 -0.47403064730226174 -0.43908664562399391 0.38896210572165024;0.27449771876137125 5.7314838167103312 0.20245738005489497 1.2503439389892692 0.55682407782383159 -0.35379835442127378 -0.11348147034665242 0.30352042535504475;3.048961522022021 -0.25111003712984659 -0.95474609960083989 -2.2221158082091996 0.96869238644425903 1.350888010326895 0.053446824425534785 0.22609439078600399;0.35558843486193659 -0.32484414877155893 1.176937923129681 0.12107243091860033 1.5681175901758542 1.4705557459425074 -1.2256478698026025 0.25504690681135372;-1.1320562153368439 -1.0500867893491981 -1.1590987643711748 0.86996864507275773 0.2756829018523288 0.67582846550911158 1.1588855631273265 0.81774669678902545;-1.3866449808628523 0.33159261536285994 -0.32611328077602841 1.2062979407538663 -2.0381937062572089 -2.1868871035692079 0.49210101314096799 0.69074197133770332;0.74507713019923771 -0.52839885449759361 -1.3650510006483332 -1.589402611778852 -0.010705602202348667 -0.55345887602445198 -0.33167196540846833 0.90349110722419002;0.82798977130487861 -0.088312061687743942 -0.53103908702272884 0.056605973236009161 -1.1418719685883383 -1.3218580328662681 1.506986207809107 -0.56960788472186941];

% Layer 2
b2 = [0.3246834534860879;0.29931381632081544;-1.0978831064002759;2.3860117624679349;4.2170595654069718;0.71421426613298422;-2.0655858429000098;-0.0848991059225013;-4.244552915049546;-3.0877551551606848;2.4517461195571704;-0.051043441993056618];
LW2_1 = [-0.75986705358324313 -0.70985899755125337 0.53676527498678572 0.35781767333049957 0.16847981763812978 0.67969525969450462 0.47200591591663005 -0.5139474861474751 0.19849647510868654 -0.72066519096363968 -0.37020188667769788 -0.57132282532670531;0.30206114689888902 0.21009162989717589 1.2698343062406894 0.43924239316935459 -0.05277126950196178 -0.50375958927533615 0.83912266101612554 -0.36501295810194007 -0.19270351314271802 0.20646837414724073 -0.1488925359261212 0.87578091753659715;-0.26479755558744894 2.5323011824014432 -2.7134020341605991 1.1522079693091944 -0.91160615225136199 1.3530517577714107 0.073719885935378329 -0.53407794600386982 -0.42551237754748417 0.53537319840124553 0.83294023289398156 0.19833247974859197;-0.78259632145624236 1.0627447034132824 0.83900784661093863 0.38435255759004339 2.6929281066603594 0.22538749636035507 3.8981428745287645 2.1131479336566716 -0.67985344369796707 2.0377360837260126 -0.89462647068330547 2.8372475131478674;2.2781201875632999 0.49270278286855157 0.61044035986429923 -2.2756005725922179 1.5859181250823773 0.36731795437367659 0.6192870325860842 -1.7495606691507821 -0.35358905158438292 1.4231710501337627 0.47902166053461515 -1.0211863477016407;-1.7754247054341639 2.3390619115791798 2.4669902414123164 2.8034248994561128 0.24744864614528289 -2.3525856876854085 -1.414022901071061 2.523877668803459 -1.2299912837774154 -2.0916557686825246 1.0488391848640166 0.91649376740232125;0.040323892798870394 2.1692477631730838 -3.5517989580789564 -0.46064597436415627 0.25521293470256856 1.8338950372573926 0.75804483697716452 -2.1298338855913128 -0.042175873898978866 0.40127577413413762 1.2588404159741853 -1.1598103827882664;0.85056071616515228 -0.11401940463266538 -0.77964517757146723 -0.054734666344284429 0.328337882112331 0.33645050717429104 -1.132822969162905 0.70199511746430121 0.12412316236711084 0.67220188424004534 0.32485890675000967 -0.47527322782785963;-0.67859451120860725 -4.7018006296692993 5.536079029307305 -2.5905904534641602 -3.0233922548866015 -2.9175162467983595 2.9258790376425052 0.31910690168958195 -1.2492617725113806 1.7210836784835433 -2.04651679005479 0.35510470088774543;0.51579714638792007 -1.5830791694171877 -0.81004840922188248 0.17076396730930873 0.99805648583975781 -0.81624387338110183 0.2281627172280285 -0.075872102038583522 0.48358584576266928 -0.27635642432636309 -0.22426823867913093 -0.23725082800675001;-2.3543990101074557 2.3405702116707041 -2.4471030541310945 -0.73099382437566163 -0.64749774896275258 1.1012433127618553 0.037290041095735416 -1.6498993075199502 -0.18250168691158561 -1.8899403092716713 0.30432118129670455 -1.0965020633438409;0.43505635780813368 1.1391459183048211 -0.26762871844947855 -0.74761399392034489 1.2150452288340245 -1.2064820368088343 -0.41729889374063045 -0.84363894001085926 -0.14807164547648577 -0.21004664773531581 0.49732895569097235 -0.28692767009218678];

% Layer 3
b3 = 0.13526674422786472;
LW3_2 = [-2.044585518750587 -1.3858174531800733 1.1457490028062103 -0.4414278889462368 0.51288960654654914 -0.14825422183000342 -0.32584461388648195 -1.5102397264081897 0.67168401470969674 1.2373022912328111 0.68395256333865662 -1.028304684317298];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
