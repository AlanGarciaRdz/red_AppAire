function [Y,Xf,Af] = NOXTlaquepaque22(X,~,~)
%NOXTLAQUEPAQUE22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:16:24.
% 
% [Y] = NOXTlaquepaque22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.03490136570561;19.6078431372549;0.0212539851222104;0.0523560209424084;0.00632111251580278;0.294117647058824];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.2439711354257246;-0.23251658872371497;0.34958435137435462;-2.8137002224430008;0.10937307117110268;-0.90198876451362386;2.404461624610859;-1.0286663081855867;1.5345882580618311;3.006536340602358;4.254282565119448;-2.9143592108276306;-1.8186591258788896];
IW1_1 = [-3.6136056326007786 0.23469660984270083 1.1821147354559005 0.75015405650559874 -0.82263738119018093 -2.9641634739094158 -0.27919037203230196 -0.01896294593727664;0.50359512121804273 1.5817457527353149 -0.33735113393965893 -0.13764104370245867 0.51694282897023203 1.0598576290688553 -0.089543637322759967 -0.012885495069136148;-0.51841389888849221 7.2151753597274739 -0.2024603041085318 0.35144360945140618 -0.1747901182216223 -0.6774271650410798 0.063258965779573614 0.17719348147791586;3.1457736388223183 -3.0309024787479366 1.974766482994353 1.2707165911988161 0.15365084304111684 -0.36570126234702566 0.4352068913046665 2.0597925215517763;-5.3059442468593208 0.16573390953863046 -1.0445771031670925 -0.75684157498598637 -0.51625498321938479 -2.0355840565297094 0.38532100540861564 0.11911537708739113;0.96711221234651001 -0.4483431075555761 -0.22604587448298247 -0.31217009544644475 1.1643246752600744 1.1866819052458046 -0.20853192494959749 0.32578415790428245;-0.86660463364843843 -0.03608361163447258 0.34056026888329216 -0.90585008807579315 -2.0677332349189754 2.589555201279091 0.0083023649150022263 0.2370955035324851;-0.22298122667609196 0.82747671011537371 0.46988451340915427 -0.20653790739048591 -0.1635688210834815 -1.7837723050022993 -0.0051445251385788572 -0.088025493259139539;-0.23721882590878285 -0.027622995636604461 -1.7603546358803395 0.03462571517883483 -0.13185923232753385 1.207979668730222 1.1682509631835909 -0.50684044861295585;0.1254231212116988 -1.5668082464989999 0.26639027253116443 0.90819735075466335 0.94674973403620433 1.1965976756489687 0.11841120277527686 0.26521429902530103;0.56157095243567445 2.0059934059990314 0.50797387198615485 1.1810628759176933 -0.71550303019616157 1.4403352329755121 0.22053659630526981 -0.53999903790697135;-0.57731256159298983 3.4403588291853673 -0.72009319287564755 0.48208392047397874 0.38462419065258152 1.5267248792212769 0.11818616791486071 -1.8870867506392048;-4.978105457391413 0.51830939491048611 0.63205804066904947 1.6246616455679324 -1.5203442773735643 0.4645146872090718 0.21369228389485803 -0.068342276250559678];

% Layer 2
b2 = [-2.162776305846525;2.2626739324312575;0.96909219629147947;0.66976821651342133;-0.93974957854713892;0.24494291045680863;-1.7613795780063857;0.83211816461022314;0.78259529691763852;1.3907302533716615;-1.4885903543626622;0.40628850731246385;-2.4460282845937908];
LW2_1 = [0.57861277485460449 -0.58344548920944406 -0.80633857565490719 0.029643317707014845 0.0066714541079650053 -0.62626090211399577 -0.82396315539896414 -0.38254194093493255 -0.43419719990090705 0.37430461490146683 0.47871549808857194 1.1968339005091504 0.49754463666123216;-0.39316550497101566 0.24624306804132826 0.43685341801393374 0.82321497342802508 0.64177006580134577 0.61319643948325742 -0.29191623548312662 0.85062113043068033 0.41493400601741198 0.017352571346150696 0.4795486145097051 0.40739084476801452 -0.29808855110929627;-0.26914223316777186 -2.5293284402404459 2.0318196877881523 -2.2049023793242828 0.45574646038694361 1.5563007703162852 -0.16923654035275093 -1.1996759253134843 -0.75282848799428337 -0.058387293038340934 0.35140003836091099 0.30657425932852722 -0.21754336774545122;-0.33233094164231275 0.28261487363366056 1.8414777510433118 -0.48659125563097944 0.3408655955920567 0.35211663590470688 -0.14173511372002351 0.24979230985399656 0.55259793083480879 -0.57452763763870029 -0.028567460391875396 -1.4906547502414214 -0.2521542731069934;0.28430450095939902 0.21060162692446469 -1.0108353710441873 2.0710846745794504 -1.4961468163272686 -1.419400271060014 1.4865833823770784 -1.10636413098571 0.5049171498237619 -1.1722703557121594 -1.1160975298354285 -0.70333102701997419 0.16979823234694494;-0.57024659035238157 -0.73866089484443676 -1.7833307260684381 -1.8510869299120019 0.14164197986420254 1.1759588511215922 -2.0482521762662302 -0.95906521338372963 1.2397594750187717 -2.0141632602665851 0.4548741881745576 -0.62064606557551905 1.6690747641563166;0.6461868001866139 0.058493015618727856 -0.96124226730544438 1.3200917223467341 -2.7046930921607584 -1.9222580179986435 2.1371538331556064 -1.4173840277306509 -0.56420029852877207 0.057420753158061791 -2.227593953886962 -0.88417740420312707 0.88997400753633227;2.3605288099574038 1.3189800357222732 -0.44876122504820359 -1.4520077698507303 1.2037053574515169 -0.17512485951997808 -0.25115156478834938 -0.45837698430102253 0.49669044306681887 0.81980281729460713 -0.24179968127148294 -0.33912272938598353 -0.65497317713538195;3.3441332103330579 1.2548610939178748 -0.0089663825691086441 1.9563037169884412 1.3248804497761475 0.87921455962066319 -2.042096011925429 -2.9645439174591526 2.292356648985705 -0.10232456288898563 1.4073866164026672 -0.48327952592516549 -0.64537878125704506;-1.3217608547439739 0.66194141745075941 0.094968308786857525 0.97490851711873372 1.0528070310950153 -0.75087839123770495 -0.42022461874318717 1.0938600225522443 0.534412741040318 1.0149263555930252 0.84450275989531443 0.33065034512561303 -0.95753349305988189;0.57670741632618028 0.68495386332314234 1.8237372788430657 0.46981901388532032 -0.11001798105180786 -1.1823730157364458 2.0597400741234901 0.90791625277748889 -1.2738209837946033 2.0674873140503442 -0.5218385733409443 0.60455540757095916 -1.5506455135285933;-3.2530942889546939 -1.1526378613477977 -0.15801440056746513 -1.0740628286378087 -1.2834229853508512 -0.93899664610430322 2.1257285869571092 3.1815769672734371 -2.3301817647264103 0.19472331137346993 -1.5506336428163816 0.52998103257322382 0.58016984650913128;-0.13216476679436823 1.7033782994141251 -1.6548132674145459 -0.29127921064199513 -2.8953110795293573 -2.0258654487457015 -1.5749161839320409 -0.23388752595827061 0.62233053839064278 -1.5106122212415043 -1.8218724478466546 -0.006325721932569861 1.006377055791869];

% Layer 3
b3 = 1.1247253977717659;
LW3_2 = [0.93849411649590742 -2.3140977196839483 -2.4711553291200534 1.454683876838635 -2.3178493413115984 1.6385960531436925 1.805164288276454 -0.84484652632586577 2.165459095065803 2.0135808044257151 1.6032374914082588 2.0795441204032907 -0.4764037134724699];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
