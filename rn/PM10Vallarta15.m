function [Y,Xf,Af] = PM10Vallarta15(X,~,~)
%PM10VALLARTA15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:47.
% 
% [Y] = PM10Vallarta15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.12820512820513;0.00782778864970646;24.390243902439;0.02710027100271;0.00630517023959647;0.141843971631206];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.10209624523467672;3.4628981436648849;-2.8954256487556438;4.7874716189126287;-5.9935777079959509;-1.7163173281703459;-0.70553959806262534;2.1557077016191029;0.74001466088665846;-0.60068533170913418;0.031324829843949617;1.211009756727832;-2.9852830041858711;-1.1478229957800652;-1.7537208721961657];
IW1_1 = [-1.9939012774307427 -1.8433291725652323 0.21833465364082141 1.6735290248914239 -0.29197337184985589 -2.2287260032793066 -0.21057465885582524 -1.0072345845846682;-0.59586424436779784 -0.87429570905576481 1.2005161018300736 1.1805937286031323 1.4203554263801588 -0.053750345385581724 0.05069769198966903 -1.2016467282666514;-0.0064082399221447595 0.43363386335109511 0.46382884636989263 -1.3723422630961619 -0.29251136723762389 -0.67031371132136741 0.59154172088652457 1.856575891686387;-4.4902867053062883 0.88307136524366481 0.19433358528516662 -0.53170930173755704 1.8787503111828456 1.4077725597660473 -0.2294048794759555 -0.59251786929255801;-0.77956159976878148 0.23155934006860279 0.98920926435845058 -1.9076949164451349 -5.609308772202124 4.1990355934679604 -0.0052428670148930382 -0.99387776713438925;1.4736530399543999 -0.60502574444766599 -0.25552332882488943 2.725317297118957 -2.8485070873435645 1.1608918582012788 0.16197777097457325 -1.1769957108693347;1.6074247594960034 0.70360160375975389 -0.22643976845699618 -0.091087332238364738 0.54717308113040286 -3.4123371198236265 -0.024519302054254385 0.22703451547103509;-2.1114437702698785 -1.3499511633843848 -0.7082550768398812 -1.4761526206123536 1.2468842973798377 -1.8604468384778816 -0.68098690057785627 0.48947977457506237;-0.58171588431535459 1.3062645573084153 0.055406884281359273 -0.59101693762587793 0.54183175485764534 -0.86190861810912356 -0.094219513811985123 0.08993112018652788;-3.0340494672468687 0.59985843080836598 0.068018358476585147 0.075002025387093774 -0.36608043575339672 0.20472071273376508 -0.053761956495388778 0.50366640437567534;0.030704928368637377 0.47352270453661399 -0.027960879037330261 0.372146167968811 0.24501132271818188 1.644363685365255 0.12624932590531113 -0.093444654518358289;4.8882135590123754 0.37411996467222991 -0.26018186862497056 0.59702905235725934 0.0068433209753141419 -1.2136061969561058 -0.10963323028957579 0.52337387399104685;-1.2511736894642509 -0.7514078650100442 -0.70515711898830002 0.069516053053613774 1.2330772140725501 0.64293174562926636 -6.8840357659367717 2.5617078556866661;-0.44506262793236617 -3.6318789978660813 0.1089680919110728 -0.8591687920327058 -1.4362919034460322 -0.0022430512252631443 0.096571201761794248 0.42718805901177392;0.41995811808693795 -0.51180194756551867 -0.10013233399727382 0.23659112904101628 -0.42596778759907922 -0.77719915100199866 -0.038145103935427159 -0.14513711101170421];

% Layer 2
b2 = [5.4075031358693932;2.2162728439503154;1.9477156334035455;-0.090843253609656061;2.9202662445858443;-0.67702322295573425;0.0029473639182774486;0.81099130379394957;-2.4274894887797522;5.2625693915510645;-2.6618361156426844;1.3958217234722909;2.1562010126072941;4.6625380897721991;-4.8271035168237271];
LW2_1 = [0.22861349135478978 0.43656193000189764 -1.1777219018056158 -0.079873862736513895 -0.66458366632826316 2.2390945925804813 0.84931005194996578 -1.1337488540729705 -2.8033261524584656 -0.019272131472567205 4.0891056840817352 -0.1091416892682333 0.15822676310184436 0.83835256228936694 -3.9517303383975468;-0.95187826972742129 0.50399462488011637 0.35380765302478068 0.93132778407816985 -1.675433138542102 -0.4546777653347695 -0.3707512537183042 2.8506463374297417 -0.28448633337510409 0.40921290881822681 0.007399991115318777 0.30439717464268989 -0.37218414932314059 -4.5909071885762778 1.4466327942558797;-0.007882735408318034 0.90956281813889472 0.89557509277699376 -1.182850491676666 -0.59966198008512284 -0.54552281946424774 -0.1216034247032252 0.045684808144701869 -0.57791194331785423 0.54146083147580037 0.99178259613129482 1.1004450240928698 -0.51374670622103757 -0.10863682643968531 -0.15078047602253455;-0.013979422563172649 0.17610229493944965 -0.22282297951914123 0.72452697382162012 0.28274325261680217 -0.42498387181592612 -0.64268098526047224 -0.14442068967238261 0.57945495593496632 0.97777313606826743 -1.776847665376643 1.257662878907164 0.12951619655068952 -0.37229539042416754 2.6995676712784493;-0.18445756750470674 -1.6327321369788093 -2.9188546872929519 0.99087176351203288 -1.8151411827574917 0.49187087621265607 -0.12426888937867954 -2.8816130877184287 0.71042520766037631 1.2239363868152875 2.0344608621026024 0.22423191949957416 -0.63894025022207313 0.6397040560691224 0.113758732320575;0.36386357033893851 -0.70083967267899128 0.64709054643200659 -1.0030607851975226 0.19492334038300776 1.21838017669501 -0.32514127739564819 1.7618655389882902 3.1478812577579189 -1.394917158796916 2.4617146694813909 -0.93859046755333553 0.067011081226310373 0.58295479475907597 0.75339028683054132;0.0060957922448881211 0.34277862003923087 0.57529006783105385 0.76447946885658824 0.20059910325493394 -0.47803822289760856 -0.58291656623787214 -0.073672686645809476 0.56000246840652113 0.83594981348985342 -2.013978097060793 1.2715585634802791 0.064787001227830099 -0.31181994468466706 2.6837143614190957;-0.002220567447131257 0.60747639462903436 -0.78064775232366457 0.14586026249635306 -0.90419226215228521 -1.0115052595341176 0.47077645375512961 -0.5085922213540629 -1.2448810166631268 0.12473010793488516 3.5444488621622607 0.82175133846300064 -0.50232816659793567 0.022530439979018498 -1.0943701222737241;-0.27095837684239155 -0.40890985864977758 -1.0629423285856496 -0.63453865783145924 0.35871529844989264 -0.52123760749159698 0.16699582003799818 -2.0933903583228521 -0.11819674637849567 -0.36580067535602256 -1.8528681371930018 -1.1814054952020032 -0.67810976004838297 0.098722850846210297 -2.808433816545068;0.11898155280097925 -0.10314497451143415 0.48274799974505411 0.37931126673960464 0.181153843234968 -0.66633740750087067 -0.28995498871912972 -1.5885764228356187 0.31937421500052876 0.2297640706214544 -2.0146463477969152 0.4100820544888637 0.15512780579244487 -0.2796023525756331 5.2581871403560569;0.90751134046648363 0.34452830068573381 -0.249729599256513 -1.1075485009447954 1.9345233321064998 -0.14123917369791747 0.63094142160795164 -2.5186783194440951 -0.56569431345341536 -0.35416644569067679 0.47137359984908389 -0.11783065778906085 0.37820801514130425 4.3215600617278316 -2.184953365189394;0.042180026872950117 0.67504121870992817 -0.43219704020047406 -0.51098260568543985 -0.89081305254612386 -0.87758637926060867 0.18634461651840645 -0.39214707808619942 -1.0126902650126803 0.18020210539226383 2.928119962056416 1.0395371355083001 -0.50341997772340619 -0.083922385239587907 -0.71800910091656855;0.95144536485802267 -3.3387432417012923 -6.0361360890087337 -0.26952346022191898 -3.2937895155032222 -2.5205054087781962 -5.4801787770918677 -2.9440386723330634 3.3187738213295375 -6.4696813423638426 -0.84314759151338359 8.3533013115740982 0.48624731050010728 -0.19311296753731097 -4.1079992573355995;1.5792221536190518 -2.2919573693172817 -1.2143238264739076 1.8480354482105699 0.57547482154554463 -0.69419469568681325 0.44649242851134607 -1.4553342365448334 -3.6370124131026329 -1.5555432945330538 -1.7966991366177121 0.26666268460604214 -0.67365009160291545 1.1419787538016712 0.40983770805954561;-0.12547614539311475 -1.0764504834796396 0.61245492305941274 1.0829614134927317 0.97281556464687835 -1.3788017298061797 0.076206237593558518 -0.86026465564156218 -0.78217475172031881 -1.1999166448762668 -1.0851046770504609 -0.78225454821941487 -2.6654887310493627 0.66758313086740784 0.0035028847026181142];

% Layer 3
b3 = 0.61179286769478081;
LW3_2 = [-0.30886670168341734 -2.2700337351834317 0.9739007601183336 1.5706686694713687 -1.0564792313333426 0.91136921559931228 -1.7763001807461791 1.8557337337054527 -0.33305478491326662 1.2687986207524509 -2.3596753331495814 -2.384975825975197 0.19084592686369259 -0.40215768001458541 0.67044863618110495];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
