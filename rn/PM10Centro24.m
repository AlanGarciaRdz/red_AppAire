function [Y,Xf,Af] = PM10Centro24(X,~,~)
%PM10CENTRO24 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:08.
% 
% [Y] = PM10Centro24(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.281968137600451;3.74531835205992;0.00773694390715667;45.4545454545455;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.3888625514616368;-0.063867422317044453;2.9539435383237755;-0.27515781552472862;-1.5720307308140018;-0.52100415532658761;2.6987777632992;1.8713529259105905;2.3517874240219956;-2.3043002249796101;-1.9161846096680766;-2.2973386576168777;2.4642243895507985];
IW1_1 = [-1.8670667370443697 -1.0411032617484037 -0.77403040777607224 1.3066523450713401 0.66745430349597146 1.1981982303060783 0.88080174917898801;-1.0685592138930664 1.277289633190164 0.95657753705593096 1.2507074241807528 -0.29155384371936438 -2.0648683624515258 0.55374917022546921;-1.3427442047391791 2.3478404077735928 -1.2410916308747673 1.5616716734774423 -0.34033060247741409 1.3560102012988289 0.04775501560305509;-1.5729739350069372 -0.051961466593555217 -0.76998728526118543 -1.2111689866546262 2.2435331406144119 2.9373582603594532 -0.8005978360629612;2.1143644294555672 -0.5131271956952137 0.24050611937216262 0.55494446322693192 -0.073644680146687042 -1.4044801938601572 -0.71948092985429624;-0.25968894974627016 0.14327508136931347 -1.29603065622464 -0.16551917046772652 -0.2928504546751956 0.98069947895282927 0.18002298045406259;2.0434627304578146 -0.079676107525421161 0.011873953521089133 -0.27895211504538669 1.1270743195123607 0.49008088235676706 -0.17793888752594755;1.4179120009409363 2.5916190430183779 0.1144506076914987 -0.33500493133254172 -0.086092662808667772 0.71461759548347081 -0.29687110173710318;0.62218159981468069 0.6341545945498348 1.955340278952052 1.0892952226895547 -1.9373026301021483 1.3531664919146125 -0.416969853937317;-0.9113789254670821 -0.62317781873826172 -0.93655916166690256 0.29889733912384714 0.59709943597197535 -3.0674855996072887 -0.74870107368954097;1.7808197274984643 -0.61804801438001833 -0.43408880878981565 1.8572699687688754 -0.6393091053416472 1.1354802651911986 0.2980094220220329;-2.6450869173829701 0.3545155694454501 -0.96949687583888799 0.25872779084436409 0.0037464219409297922 0.59544741044975369 0.010409396086165729;1.9910738096423866 -0.35429409202346085 -1.1034137961887742 -0.64885831369262303 2.6032178652606186 1.6422055415363872 -0.32096781357238946];

% Layer 2
b2 = [2.5001909879989928;-0.8221406398494584;-3.5379950891033305;3.2493286589667547;3.4386887719021857;-1.9094224637719859;-0.75319051703112094;-0.28816633738211384;0.21830715922664362;1.9657781642120427;1.0365254744984722;0.83658266894240096;2.4845396223909826];
LW2_1 = [0.23318487032918725 -0.71260199648233913 1.4416775822266441 1.3774256693833937 0.66979987231229277 -0.11510042841444458 -0.67550682077484869 -0.89961018961330608 -0.084782339245078275 -0.48599824497989663 -0.59017118202747543 0.70675861029644349 -0.41940013819684707;-0.98866803357781152 -0.99285488603911165 -0.81050518072577293 2.7477644598373563 -3.571537253567397 -1.8288462565798442 2.1581144125793221 -0.18616700159217012 3.3896113786546032 2.7992474243450092 -0.78739140213880654 1.6488542421113499 0.30461337554050177;-1.4369393567600848 1.6912294204358989 -3.8395384978172449 1.0251893240841059 -1.4386341271886842 1.4211362932540241 -1.8182765274139387 2.5056945721153943 0.46166836228052821 0.91815029795923242 -3.721198424812838 -0.29717204948280079 1.5963822793160869;-0.94175870001861173 1.4627823197947596 -1.5725428439678812 2.1977859195456984 0.041203276522957188 -2.6006703790598453 -3.584137505773449 0.18084913070504632 -1.4674123110988957 -1.6356931934596315 -1.5372290908079118 -1.8904036651518037 -1.182801749036638;-1.2159014536378021 -1.3154984547899184 0.14073083729435598 -1.4618433014413259 -5.109226320457668 -5.667572058593624 -4.7290105754024339 -0.64560160797017874 1.5309753539599713 -0.44450958723164369 1.165098949084924 1.3604428386129435 5.2896121718959357;2.1794362691992619 -1.0287033296489747 -1.1787447812981164 -2.9256178935283055 0.41078001104224082 5.6302713437353704 1.8253444016380884 1.2917583735351179 0.90813484140051604 2.5285181216757411 0.27418897563862138 0.50258502478672806 2.5741232718602487;-0.65575589464288109 1.7008650503587406 1.9243717456165375 -0.43047515766935451 -1.7291711914783741 -0.55451626236762608 -2.6663857766418562 -1.9229547516974672 0.88517814103844383 0.2425994780431035 -3.7594259141084483 -3.7835977321797221 -0.50557145502985024;0.76213775707384868 0.044050753011901492 -2.1857518852054771 -0.61125647305168151 -1.0379761150249223 0.32334389948922326 1.3749689207481948 1.7240194544810432 -0.62778793610081896 -0.38380791892183025 1.9743933497212109 -0.84089865105303285 -1.1064806501339539;-0.23962943634487777 0.42044134503455521 2.4478317522774451 0.92872685895352336 4.3810973330103948 1.1301540561724794 -2.5511603486613308 -1.7919710906925368 0.59257488581078033 0.26736684412802486 -2.937037963710925 -1.9570822581825567 0.6278716512669823;2.4048082085015827 -0.61307816736194132 -0.20060163684260088 -0.26448906501770109 -0.6579953935173285 0.0042254611286254989 -0.78458647420500982 0.78710324025492051 -0.62658818563286012 -0.85894728058686542 0.32170539784244639 -0.15622317670942903 -1.1134164279312742;-2.7281001688325861 0.41894960165623663 -0.54583972832077532 3.2317206773066958 5.0498218596395503 -0.48386519251087323 4.9692647322429524 0.20565450988587317 -0.99446773926795662 -0.39533973066092987 -1.3456971837604272 -0.9187727769794386 -2.6637681296245486;0.7069827762619405 -1.0988580336409004 -2.1538491442926686 0.2998876761412646 -0.25800239031844324 -0.22499134466548509 1.0327296039635978 1.3124192869828462 -0.72230774144592569 -0.46495617971946862 2.9732421714419455 -0.75674067150763868 -1.8986547005222274;1.62029053552319 -0.59144582773918053 2.1246494150402304 -0.61780535475350384 0.11501148398506422 -0.14199145054151588 0.92273375134698932 -1.7221263480488334 0.84255946406326609 1.0801813014994779 -1.4367312148103166 -0.50563142764925462 -4.19093583072301];

% Layer 3
b3 = -0.15274885018259862;
LW3_2 = [-0.4009470404957946 -0.073732458799772541 -0.15863355976798879 -0.14907103140964495 -0.24496376396066924 -0.090268818566506301 0.21343766338833212 -0.7114641816944185 -0.33668522697548248 0.24234964347342924 0.14066155162409469 0.55927915346443979 -0.36453386908930574];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
