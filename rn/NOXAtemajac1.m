function [Y,Xf,Af] = NOXAtemajac1(X,~,~)
%NOXATEMAJAC1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:14.
% 
% [Y] = NOXAtemajac1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.04040404040404;16.1290322580645;0.0210748155953635;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.1911821698752147;-1.8165262590854627;-0.44246279963592017;-0.74113331983951136;0.78021227728373455;-1.0871487489727807;-0.50551373801598098;0.068019334609097856;-0.17096958174915639;0.20914987252703213;-0.56528045109094638;1.0441047680244433;1.7721675256566594;-1.9883072489962081;1.9290470723242896];
IW1_1 = [-0.024419383847142876 0.25205115455137395 -1.6234185849399692 -0.29512666577504465 0.14871933504863233 0.46824166067735651 0.0057182415454852895 -0.21111858929345545;0.44210414957764743 0.20947112851751259 0.53674317416680783 0.59617989993073683 0.37176596986798094 -0.35021564157679086 -0.45991495201364696 -1.3755154587381504;-0.14642368172950154 -3.3790907679813018 -0.15132160435521608 0.70987146850425153 0.13220438962531178 0.18029702139686091 0.090272865855701545 -0.0097963038332765547;0.42042210861489809 -0.94073755907652046 1.5167805873447919 0.27220986309466561 -1.0507628343282285 0.10637142235475922 0.0080803753616198841 -0.82126605510001893;0.009176474326806577 0.55469150261656974 1.0485580493460698 -0.32971214220994793 0.42343603837670302 0.43289559488045293 0.048058410100471946 -0.37348564744281698;0.24284419403078714 0.20837289364749592 0.77142968128591993 -0.68824049183840474 -0.14669025949881648 -0.48767259214792352 0.62995955185092989 0.02761497389026156;0.13425780090410039 2.4868278805432982 1.4844044289423217 0.076777036124841866 0.14457294133813017 -0.07013813476611018 -0.05491887919282145 -0.40466937812388365;0.11294825106680845 -0.72277814085406589 0.50525929733208585 0.073532216354429469 0.088841701908765808 -0.35993867783703615 0.12172269591818832 -0.78810111423078955;0.91542481157151678 0.75597584742923485 1.4941397656248199 0.87354235852752871 0.19263135809738799 0.12231860433615696 -0.71818100885375491 0.66195056464241786;0.2259310577715872 3.0621645490743852 0.44569210828687827 -0.77282841328720553 -0.19043164845526397 0.14037144784098543 -0.12125761138029242 0.029759451959069146;-0.90149990947959513 -0.27612936201053073 1.9620883090201788 0.38139275093658315 -0.64112807083619228 -0.42201359371023578 0.025207722190716444 0.10462688029573261;-0.0060074474623363888 1.8275815689648374 1.2184743283601378 -0.50053581377408274 -0.62065084611147325 0.0017839478238058024 0.054201892299045172 -0.30807504969222399;-0.32721523544608094 2.3430556270634666 0.093234581786525925 -0.76409759300823932 -0.86500728764828605 0.93674533492398004 -0.20077743685903232 1.0491902889294562;-0.17088941798287263 -0.32806350478646407 0.32074591979477102 0.52492317110237774 0.26752374351935271 -1.1005907403055808 0.36579087382361825 -0.66610946263924997;-0.11105393551014532 -0.15591306007915609 -1.0462805549031182 0.47901316797732885 0.31674547196407132 0.61304116102840067 -0.36800300558557109 1.5983146059977693];

% Layer 2
b2 = [1.8423938860839792;1.6355690324285399;-1.3233025632017059;-0.5970406093711792;1.0162579713390432;-0.84749308701021531;0.59977216238540909;-0.0051268776366198698;-0.037434687449770757;-0.24378844349672293;1.3477278560625416;-0.73760487757645976;-0.99536843221093141;-1.2906251152937664;-1.7936594810769964];
LW2_1 = [-0.59632632868671376 0.527111926273506 0.065922650604493857 0.57744508705085928 -0.58990333055091027 0.18619469160380836 0.15967522345832835 -0.60294212100233724 0.33457002169484568 0.18155594275371562 -0.23508994702713371 -0.27318120093118403 0.29314692825510036 0.44828439069500448 0.32662939069112512;0.4543373796875898 -0.1763509468019725 0.95512896603241471 -0.19184895273337876 0.31069434668027895 -0.010219868523481397 0.27859519341727534 -0.58393975072186366 0.1733088598405228 -0.12065926799270467 0.10373796884182396 -0.10413216559467596 -0.0011441467017130752 -0.89591256140176767 -0.27493258266653686;0.34847868457293307 -0.58387124977567706 0.24839177075106564 -0.35937722759819768 0.05264335654421877 -0.55544392959831146 0.025826912268942924 -0.24904502756108091 -0.6582818254459083 0.79153987786933178 -0.69651260162437278 0.090073886236156975 0.1769307570593053 -0.55073264599555238 0.67974245840040581;0.38156138068149675 -0.47472218710885478 -0.30958451199357812 0.11523218964537646 0.067738258729001882 -0.95001711203925454 -0.8521460024602947 -0.40865200477088975 -0.74118360214470624 0.58093831402068874 -0.47218630450973587 -0.21497761026978682 0.91862194198702063 -0.89472553596847948 0.062999403322595321;-0.027998186862434535 0.19800547685368841 0.19968558149595012 -0.9137285208428173 0.15426003931804266 0.029755757229932428 0.16728817763048079 -1.0010132967275185 -0.31215765599643763 0.907461901332688 0.79930149030245912 0.12289515500482813 0.39604164657576829 -0.71398117624136082 -0.54481036689910189;0.46457861129260575 0.014263090742334478 -0.84317750162995131 -0.85118761427834955 -0.39373016424842461 -0.75029038821311711 1.0364520354651583 0.6271373441841146 1.5159364143016878 0.075048169698678335 0.27227298690833279 -0.46539420663085213 -0.47560280461725607 0.042567478496856728 -0.26115216842650091;-0.55196357671752583 -0.74467539956469753 -2.3224766138663182 -0.41172400369845186 -0.22621751705077875 -0.10926578729581604 1.2167492778272835 0.50471522305879091 0.022301907849689398 1.2749125171204105 -0.52180882755315139 -1.4120881580771354 0.91321021141212555 -0.05793177376975632 -0.22358995378159446;0.14584624728126777 0.62572358993664967 -0.071510854522516279 -0.40486911203361692 -0.075449479191713714 0.48527079351216273 -0.30722243076887806 -1.0316609858509203 0.69778945977930296 -0.68795761812971346 0.1869367449371904 0.067968638884672208 0.32088958620388452 -0.41363282829960496 0.41965034091930165;0.89929680620703734 0.59663754113243339 0.88803641799905342 0.5304590248372818 -0.11019519966037 0.18901462083947601 -0.35532989005160714 -0.38515949135141203 0.14188927119092792 -1.8787525623890775 0.099087878405860391 0.85166444816661202 -0.76455419313418993 0.014168488169669858 0.23391822056543143;0.85929256817810928 -0.088384301113264008 -1.2322886774000674 -0.47268262576117409 -0.55900168536501749 0.64224916734963955 1.7961370285311393 -1.0874219719957459 0.23013245432703802 -0.76913869218881148 -1.4472589891870675 -0.021306867713718654 -0.68384627959430344 0.36765769307094354 -0.0054112811197347677;0.59415298254123594 -0.10430616780631345 -0.39426178190360645 0.5360980989135522 -0.47072164937447736 0.15781218520384427 -0.51921842354078962 0.75607218627573702 1.2325006560334004 -0.82987373139631582 -0.89069122900481745 0.065003109817985932 -0.10673208190735714 -0.99169639477133564 -0.039668808133839488;-0.19105407497707205 0.27779852940023536 0.88632242599423772 0.099851870443811663 0.069892894895110136 -0.50648330433178668 -1.7267988892932786 1.2928696892672984 0.047189057395470406 0.099127445069233155 -0.075505631953484698 0.48374753355325179 0.30870239345696215 -0.33145713091162704 0.38488763171831886;-0.50660216077369857 -0.2334458246938928 0.5887051074108911 0.48040230544219942 -0.51793387386815692 -0.22621360057700748 0.52151123806295607 1.2101311224028388 -0.070927005361296425 0.63329067532673422 0.62669423275961389 0.90552247009851961 -0.31848275364710349 0.54120301212200173 -0.51713336203439686;-0.50288257185273666 0.34844948450284174 0.56817350630421148 0.068355971118384873 0.26419945200189215 0.13805016413450658 0.44235812458585022 -0.45156952861948541 -0.1590804247897081 -0.21697951973049884 -0.83524103010706108 0.95123699987718469 0.34528459423133828 0.90605067368155701 -0.26540028864028237;-0.58285108686055398 0.25340567555530091 0.36778414352436301 0.18093397519910898 0.66848906242782291 -0.59871816367332564 0.48485960392803013 -0.21787764986077851 -1.2663068957666208 0.74203392317262307 1.2526618368748794 -0.078367517394875214 -0.067533497803218143 -0.32156035953697792 0.25328672102440186];

% Layer 3
b3 = -1.0778121851052505;
LW3_2 = [-0.21195224831167833 -0.72518286043246927 -1.1006425082929923 1.0766096461752317 -0.46445731833792858 -1.0448584464789874 -0.75686567355112311 0.29743935418809914 -1.1468523918818649 -1.0491974939821107 0.92905139867762254 -1.1851267253313553 -1.0838051347047792 1.1738361216275695 0.80921744163219644];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
