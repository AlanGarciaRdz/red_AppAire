function [Y,Xf,Af] = NOXSantaFe12(X,~,~)
%NOXSANTAFE12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:51.
% 
% [Y] = NOXSantaFe12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.7289901038081315;1.9830644995606581;0.068662051538518509;1.6067548305614703;1.3199149241146517;-1.8610491594042173;0.052558489275147113;1.6719396336130543;-2.2375526871887601;1.8338520388925932;-1.0595796629861143;2.6140459484286054];
IW1_1 = [0.77834834497068195 -1.3622376622452901 0.053208346642208484 -0.77194343328248682 -1.0645713929915885 -0.18083446841982986 -0.6632046514512191 -0.4278539460235567 0.70884607254460508 0.35991514310461475 -0.22892809380348414 -0.2262721725706274;-0.14785907926628161 0.1453508629805263 -0.62281506803234021 0.75494112608183372 1.2049045008160697 0.1151164436266089 -0.37753364830314223 -0.16499081660037979 0.47993640349990668 -0.45042650405443757 -0.2293158682521893 -0.05900957927561315;0.35665985371517617 0.077773448345287918 0.51578035656850929 0.089428315846186393 -0.052742696211196149 -0.13214173855211531 0.18037136713193344 -0.036109094491457265 0.085740292008667368 -0.94334392495182429 0.057877089852908375 0.17826326274715978;-1.1094164264607991 1.1864385462623888 -0.10887462662506181 0.29752567947327724 0.66960296524346796 0.32134717707426302 -0.37846227842320829 -0.09730180664581356 0.64730604193283281 -0.12955219957675757 -0.45317159531753215 -0.033080524375397269;-0.72592505742089042 -2.1692414663868371 -0.14286685289761436 0.50577119705992346 -0.0067777518124704401 0.27184904456633463 0.57935941079263031 0.28997108494140894 -0.68457267293303614 -0.76521156767152709 -0.17500128375097213 0.48523068637747724;-0.10006946104894218 2.0412672554328877 -0.2106911585317236 -0.27635323193026379 -0.13925631342535474 -0.004336319655498154 -0.078874344918248324 0.13587890753986784 -0.23129985048472351 1.266867623482286 0.14651217048085341 -0.10778681972081902;0.57091120810783247 -0.12616375630994348 -0.31555524250068162 -0.42514217816261723 0.5756081775566726 0.29683622234632029 0.54019792836427483 1.1388306833154045 1.2661834496856992 0.50655324082618924 -0.84865844888014086 1.1659577319940277;-2.1331541506250171 1.1903205326050157 0.5035833963956915 -0.51762270840459768 0.39185168036282209 0.29736045287984009 -0.033057892949461577 0.041657033687860903 0.26193081865170664 -0.1750568277729328 -0.059726483242133657 -0.0065420784797564566;0.22160603978848611 3.6765904054774947 0.23795722545021816 -0.31102426570420261 0.20520132091736959 -0.1885546905689354 -0.013196935856198641 0.098037303094509254 -0.43954143241653143 0.7892989642472632 0.28214554554504406 0.01445264914840215;0.65635179746152417 0.23750481413810878 0.8669152320576452 0.11160470384677761 -0.35778651105037307 -0.28221427949822009 0.33792118682053951 0.059230081867670294 0.22334176829808269 0.34621927750748055 0.10323785813013425 0.50615438924361655;-0.27763143890819297 -0.11063613961234978 -0.25763506932447588 0.32342759954007611 0.59599897723636208 0.16289374645779278 0.10194572288055212 -0.0070312434322465089 -0.27035253577319013 1.3122955118135682 -0.86950076184583058 -0.4993167967866815;-0.80177907794043557 0.32279430173385931 0.71497355971551213 1.644221008667214 -0.15335916077119077 -0.087802524474736715 0.69477307903900387 -0.15919767780673807 -1.13614447200945 -0.72447632711758003 0.17855068077722352 0.25308023270576985];

% Layer 2
b2 = [-3.1270186669104962;-2.0186876373142693;1.5650545180022399;0.54746389026285935;-0.1908367954159256;0.87775318843486949;-0.39802015613616315;-0.5524894520458169;0.70747963661196478;-1.772180582458537;-1.0316846122116365;-0.79980906349596437];
LW2_1 = [-0.16030924107616329 -0.43207176993514085 -1.4073175499243609 0.39293879562756773 0.20183369591892963 -0.43133556319284294 0.19306858104384289 -0.46536442847986847 -1.9927586775294666 0.35174797049257195 -0.079195229637503126 0.020271152602852623;-0.20710733672833181 0.38807545360335444 2.0679435640986505 -0.63865124585986321 1.0777359449554813 0.15707445372821055 -0.20644401210482133 0.10323749333404189 0.48820901167005698 -0.94240699542318973 -0.90643190527170026 -0.681764761996976;-0.93571296098435019 0.70541188511311304 -0.59198209952918268 0.43810798782892391 -1.1492307069178627 -0.11378962789750467 -0.27171274973946485 0.17203952766778713 -0.92396500466176401 0.013129649619864358 1.1531198285842887 0.22234129840100403;-0.38902555188318383 1.2258959629462582 0.53940982754075284 0.69082818968361837 1.5846813956873347 -0.53750324169879937 -1.2085726608963008 -1.8330934491982909 -0.43048572132083818 1.1538654198846858 1.2483984831424364 -0.46816231872108921;0.81927162668852949 -0.21777993928261957 -0.39267473430745375 -0.4993266363036048 0.010528514203808452 0.33841912458316803 0.53579351146507581 1.0240317652328343 -0.68933371383362563 0.70898235634413587 0.24576722233059978 0.96265361115479386;1.0989843591500315 -0.27236538645074121 -3.0446697221765389 -0.64950498633938925 0.63418883610743748 -1.3828144431473237 -1.5865624252768762 0.90016104459189827 0.10621841896638516 -0.83344048811998916 0.66789683850914172 0.60823713264032531;0.52460269904034751 -1.4994038940800762 0.20352110766318637 0.15215035523735138 1.9637612680661842 -0.65926584595829407 -0.94153694370447105 -0.63876512037389588 0.42499088193841034 0.31952613881375846 0.80430638389567355 -0.83429051646179575;-0.90675606636996964 0.23549019017376338 0.31776205662960894 0.74180404964717461 -0.94983259390570396 -0.31034532233089535 0.8806532876725216 -0.35652086050844878 -0.74368311501961948 -0.4864358426338124 0.31297919236884975 0.18126303856444201;-0.027547066681530716 -0.079369818297804165 -2.3073014311009903 -1.3627068654428263 -0.26543609506995214 -1.505075428172151 0.47447342523580344 0.68773346635711718 -0.92779069528922087 0.98798733796169436 0.81272625694264689 0.6089765032376101;-0.75897045877731339 -1.0589199667536708 -0.7568065392914427 3.0724138842681703 0.9859010039274485 -1.3037761230863081 0.020676752727975652 -2.2800534588642751 1.9278538251405324 0.076325003169317507 -0.25628885632480652 0.13008828616505999;0.23867433288784229 -0.34493954229830792 0.78107470777673671 -1.1794052563251189 -1.3447261245551156 -0.1852608175247335 0.034730139015824321 0.10427564323766414 -2.0132751463030472 -0.60661924804165701 -0.088566952551710154 0.96051464673330123;0.27486079849987716 0.57372427256834468 1.006594850556054 -0.88169804178099342 -0.98195018549087176 0.73947894123966817 0.4529663588064296 1.1335776436349065 -1.4661275802860196 -0.15898346522000745 0.12031003310530544 0.82107993905420318];

% Layer 3
b3 = 0.6753146593117082;
LW3_2 = [1.2518855040372703 -1.0576374623941804 -0.60350447737558355 -0.62944556604061386 -1.5570189509163588 -0.219483450320755 0.53093295036311938 -1.1432430384076568 1.4975455293432078 1.4049541739400322 -0.54681536868693181 1.8095098423275999];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
