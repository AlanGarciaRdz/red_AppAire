function [Y,Xf,Af] = SOXSantaFe15(X,~,~)
%SOXSANTAFE15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:51.
% 
% [Y] = SOXSantaFe15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.8646869527455223;1.6294903287799201;1.7581017760857336;0.46154903265696723;-0.70880438253637112;0.67381800318600593;1.6963666714027228;-0.3437426129549882;0.82619015594043044;-0.39308058834943305;0.13373938405549915;1.202793009421812;0.91875462124865148;2.4174971873195186;1.359884810827606];
IW1_1 = [3.9718074473796503 0.89212453766512434 -0.76032876761826995 1.4177659217167013 -0.047515782923641878 -0.41936866626243247 0.21440391326166641 -0.10781791432041804 -0.96333599777568635 -0.61839166395465128 1.2591264929961696 2.7633538755734044 -0.89572391108295446 -0.55929854863222905 -0.24459906965809974;-0.04613811227190448 0.33530892911943105 0.75149783691337979 0.60076680897710844 -0.25658277006248159 -0.31365146428616164 -0.45427898734520683 -0.22711173250307604 -0.68636296580774903 -0.69555079906752959 -0.18282409955265316 -0.75670434373321194 0.1388938827559334 -0.65372468036615838 -0.37820384086455872;-4.2948136506768746 0.24652806714146752 -0.40750257038819976 0.50251302165470446 0.32196862601811527 -0.5138624700043759 -0.73920088850152577 -0.10491443213777948 0.20256978600117809 -1.9804905345636645 -0.37426927022820128 0.54751286898106211 0.5102796942105311 0.90303571067362565 0.27289686879658298;-1.1576124414572819 0.24311211884479639 -0.26421653924677291 0.30405805047576484 0.74509483436088964 -0.018055281210178173 0.62829336751033371 -0.033423028107118891 2.1561006242099676 -1.0349843388177247 -0.11353339584265358 -0.15792876679568371 -0.69000067743363114 -0.32196575610075462 -0.12224853172050107;-0.49457124191384516 0.0244173403836421 0.15736442870536996 0.204592723070602 -0.3031802130772816 -0.45440584528341799 0.016543417564092819 -0.11346973601009228 0.51348953669742181 -0.86794185451594186 -0.96875493021378867 -0.40180475577856078 0.25232668102084649 0.45073562791998312 -0.4797240932609767;-0.28427677655871558 -0.19292132875454504 -0.46485914914445359 -0.0084902118408207473 -0.45175756758794788 -0.75091579986436074 -0.45851111050497895 -0.68841791159942456 -0.37628666501858854 -0.17618451891016587 -0.25775029587820114 -0.093995802924180541 -0.36942511553351509 0.21760296365521911 -0.86693538634988976;-0.96406531311459576 0.19814978573096684 0.22893714723609226 0.069577623400346844 0.49392177319719388 -0.19136382227471505 0.74705324387855943 -0.03236359112127165 0.82680130363115556 0.62016208230076642 -0.44197388614193878 0.13427343460182287 -0.18251873702786786 -0.018237180793903972 -0.043296337986867169;0.41731143235190421 -1.0400923200458145 -1.2993229047974324 -1.6333818634621424 -0.66306279967174953 0.45653566838090076 1.2816010271716549 0.73129133806461288 1.1653514897018804 1.5587051262824454 0.33948831790870637 1.4870786074506643 0.64374499586475076 -0.82608277467589586 0.92537897336057873;0.17158715408973246 0.15339679725449812 -0.021217721576345862 -0.55744149554650868 1.4370843098549699 0.75554785767281862 -0.98810189974006346 0.2917901049822641 -0.39317210202398406 -0.58601118293063437 1.416539002947806 -1.4625316588752226 -0.76562409606994508 0.45345934984419173 -0.66975478860451088;-0.48443750044750677 0.39184648838384761 0.053095298403320224 0.057706146766453741 -0.10063456522098491 0.25535687832730236 -0.035145843996056317 -0.61212060182019112 -0.19445454161431083 0.68979941955800261 -0.064550979863726321 1.072452866811288 0.090084937618619132 0.5027673570397666 0.55616431958419532;-3.8881664984028239 0.087218480818430769 0.25279209755076021 0.3013676765119917 -0.24579496632871364 -0.44782655537551935 -1.3629224710343952 0.21189072952251714 -0.92965810016006611 -0.48848815476041879 -1.5601769281080087 -4.2143501085935968 2.2576308425690303 1.3793932699849198 1.3928274459106982;-0.25586150954325393 -0.009342917889707987 0.010428305945077416 0.17504631972760304 -0.32264093533285093 -0.31049381338452142 -0.23485469933914535 -0.091183625756422068 0.35531156706999661 1.7146117098366462 -0.68131522064737571 -0.2540398700650513 0.30633317150696254 0.34778637550680169 -0.73156548179953274;0.47542861418535054 -0.047370551746623378 -0.62515132198422441 0.011894442550968548 0.20886740416763158 0.46227107230972408 -0.48583003493284777 0.12019080590203748 0.33104183430198836 1.7724600231846814 1.0015310046020218 -0.41757189682557244 -0.54512457955060278 -0.42740150914154351 -0.24392106180259437;0.73310159136429476 0.43827169821914713 -0.81120372679998543 0.37195225902730639 1.4631962336323803 0.16957466888841177 -0.11145225374643446 0.2301745473629708 -0.12039213911587307 -1.1821641567657535 0.14006077143176959 -0.41483299853652494 -0.054657468193665598 0.026502568550283195 1.7280317429115746;1.1441268169259875 0.049071963675274964 0.42259766032610557 -0.24662696997549408 -2.1312237698387491 -0.76290647904053011 -1.9739329113668285 -0.64896956648342552 0.31954959731761878 0.67141806835336382 2.3522765056628745 -3.0538550031080827 1.722757919531885 0.63137485032340412 0.54240805836444828];

% Layer 2
b2 = [2.0454025639024804;-1.4282166239753049;-0.94078149029326841;1.0156371167745188;0.81253906000845444;0.35716303627804041;-0.21255571566560386;-0.12589479166526607;0.35794027804041983;-0.39193479677163434;0.70471330997926407;-0.8510963288659843;-0.9550935250494742;-1.7215047643621249;1.8566312923878858];
LW2_1 = [1.0644194734420143 -0.14160841023247528 0.39403743792292789 -0.21204487406440264 0.95529595267790346 0.42758807726708559 -1.3112387580320866 0.64671131214388755 0.91829798721224531 0.14892417072673811 -1.0218926731422842 0.2020363854692212 0.83565749752113716 -1.8617718685763569 -1.4158253616210716;1.3288416591867318 0.64358447894856341 0.48560131904283027 -0.63323289132727667 0.56705394695653577 -0.32562579905881461 -0.88105647238716744 -0.72578539015683807 -0.61353300173963865 0.065652228636945253 -1.7186879577297169 0.096668105050354738 0.55915769099100909 0.39696713104320086 0.29849341404666629;1.8229530238231813 -0.14919803932740844 0.98891312350164184 -0.63447979050064951 0.18413937601425523 0.27279781861711982 -1.1469019105299885 -0.63076208622920216 0.40770413215245493 -0.85608953801664567 -1.9969586624621414 0.12336327463999243 0.54924906851874578 -0.52533165430894724 -0.39336670950311525;0.14921361567036689 0.15529995135974678 0.0061936303305289622 -0.1705725653449309 -0.90854754503330726 0.75977577718876055 0.60788772421491832 -0.24701472091515336 -0.030147450786650039 -0.12493746954384215 -0.19254197051832253 1.7777568870266762 0.81847960052239788 -0.65693542541931338 -0.2779442074587028;-0.46559667776606473 -0.32860798516750739 0.35167166852505671 0.16630148571859471 -0.05009978277256473 -0.7771057575274275 -1.0745946193681719 0.52252018220204444 0.17303353680094608 -0.71852337169029523 0.18533959311790246 0.041720978806246777 -0.22856557054280133 -0.72180237352855059 -0.58692425354214151;-0.17830712908468374 0.35380457671303045 0.71035910569223426 -0.78817596438060655 0.35684370864197712 -0.71500444305463895 -0.63620098598844188 0.08931056475156382 0.30096564924846458 0.3813713630792957 0.11151050521288275 0.15440531197866486 0.2400815345949526 -1.7077832624308207 -1.0022453050520754;-1.3880590864180691 -0.98983436693907112 -1.6231867658184587 -1.1891198681313511 -0.6373831213843999 -0.9803900165096483 -1.684943591659958 0.73453706361851734 -1.7612462654966119 0.97567798490644431 0.61876404489300829 -0.47029277117647622 0.39115585156025645 -0.12506585357456185 -0.22473401912450941;-1.1454639815939922 0.40663186844039412 0.024309181764343428 -0.5177148295390569 -0.66440994931748099 -0.35521768328815001 0.76854712836855499 -0.2544112612160862 0.19481044571587938 0.53716974313233634 1.4493123203321909 -0.1427062596854384 -0.47416869821658247 -0.85766848561618059 0.28167976228737962;0.63343898882145921 0.37943114142768164 0.5401318939639792 0.65128984308300908 -0.030608267146285804 -0.18068018564484403 -0.43096185943842846 0.1202915129006896 -0.36537912683966323 -0.72156235459547391 -0.17536619277561308 0.19790932656387611 0.76109336270552241 -0.55068625008833072 -0.080745916006340596;-1.1102558550225272 0.071066844402746437 -0.39503767489086372 -1.0276253792784633 0.79827441930470278 -0.35164411623202485 -0.48432939962167948 -0.089536159045931943 -0.14037664670758249 -0.70623775151204526 -0.081210607158177503 -0.75829344867685855 -0.73170521277349587 -0.45655941836949687 -0.22068485030196427;0.026804218114937529 0.42993845628305377 0.2566013553801329 -0.68011351871369718 0.42255534416442453 0.65439720155200087 -0.51433085466825867 -0.011900765518120447 -0.17515636710777446 -0.78359616353697603 0.18739962094938245 0.37514128132567653 -0.50573206528875503 0.36026854378542261 -0.078550341218188366;-0.92858164692091638 -0.91272328375221112 -0.46617788648643743 0.43199367914035991 -0.36329421630416436 0.2861336460646392 -1.1036205992954131 0.22630633659792002 0.77965881769566669 -0.41869437843178026 0.59229817170769739 0.39003594338531267 -0.61579588652132689 -0.20324867659582496 -0.59972063707031653;-0.20310752130118487 1.0475964236054347 0.94915455734463627 -1.2115938753579223 -0.32391076338318853 0.25236337333851433 -0.97014437109046714 -0.28937077553613344 1.1002883661857674 -0.017034131877056938 0.11720238336073857 0.21540403122832877 0.99920369956189625 1.5343516034163744 -0.4551449609635761;-1.5622106101525575 -0.8528491138155081 -0.54965919025058274 -0.15384970021676397 -0.88882256441666541 -0.10703415870108164 1.2370194911089336 -0.85131157036958938 -0.58027940756289131 0.40395554532956168 1.6917140295469331 -0.059976962097798805 -0.84671011064750368 1.1901552306775314 1.090640968273928;0.19913343417740204 0.31056101422370685 -0.082397919512993495 0.33982495049185807 0.35173681521489975 -0.24750562057105499 -0.28930157119285022 -0.70244524221668736 -0.20026762218590102 0.48208931514871217 0.051180942643118454 0.70949385841772816 0.47644218166258345 0.096363863881486878 0.69017911212769623];

% Layer 3
b3 = -0.6118191722806241;
LW3_2 = [2.1781865363215469 -2.3806622320054038 1.1127181481984911 1.3227819958437177 1.7902510308609043 -1.253674997570978 2.0129484001513007 -1.6388337781496483 -0.87265200532474396 -0.39979491599085709 -0.016917247373460589 -1.2966036281187099 -0.74408826214556734 2.2818540340765363 0.3866111189840859];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
