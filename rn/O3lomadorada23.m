function [Y,Xf,Af] = O3lomadorada23(X,~,~)
%O3LOMADORADA23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:41.
% 
% [Y] = O3lomadorada23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;17.6991150442478];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-1.7616501550214103;2.2902434095707349;-1.2994767539925207;-2.4215193417152689;-1.7918310951347101;0.012365261933912719;-0.20488371299766944;-0.67798229514730712;-0.75047234464431545;0.22068594665773567;-0.40703637104516355;1.0115629488214384;1.4317457737920019;2.7813778034350012];
  IW1_1 = [0.55795031628501712 -1.8022469482474026 0.51201624388681644 -1.0593597868633631 -0.36947055505236226 -0.23910775624774527 -0.16710378078353716;-2.0632688770109748 0.34211196601193355 -0.16015206824580561 0.5553193056770217 -0.34343389689531745 0.51670607426968673 0.92674452320573175;1.0336025262567463 -0.26245974579095643 1.1205498056718652 0.42538401739757337 0.61785811580344274 -0.74576912810326146 0.54525045171016906;0.89926273290151892 -0.72556259081374097 -0.44325824275398229 0.43455643544840789 -2.6438267249412379 0.63641743371783499 0.80510260703993641;0.26623145930368208 -1.9619378519711272 0.47203423455505333 -0.078225520686288241 -0.2666052624774411 0.12534399211670494 -0.069771544894406345;-1.5632842507104958 -1.4318579172288695 0.83748935865911878 -2.4032900024762429 0.20946507106202569 -0.18650256394180284 -0.38392279144805491;-1.9402126697661741 0.1954981188177779 0.88056254188989902 -0.86360829663072747 -0.76212162577147613 -1.5959704441667137 -0.72417511769216691;0.81235489898349922 -0.87969911623090646 1.4725734309105583 -0.031362955012764607 -1.4831093776906885 -0.92439090877607366 -0.43060555852224941;0.29010344292765672 1.4592227007376468 0.64346554979010895 -0.7231793408850562 0.44098991457299885 0.092247017449984384 1.9274424364648151;-1.4813911411276606 0.13935341381847738 -0.43371944500724313 -0.017553855813145058 0.027757756088475256 0.91110251591683189 -0.58002525459548671;0.19025724726685755 -0.62844255913867186 1.2093798424526374 0.64282550196848653 -0.48184296672354487 -1.5417928403691166 -0.23623837786655411;0.54312233416529809 -0.97586757075871933 -1.3168028562413632 0.13984186767991269 1.1389254948141114 1.0268369782363629 0.42087464452146695;1.5669561164027082 -0.041718645481339321 -0.61662671384541889 0.52529806549637603 1.5502662101373348 0.12253850927238043 -0.10507659388215851;0.3744064861514933 0.032798999195816407 0.0097788435543990915 -1.175142224021855 -0.021138553679679609 -0.078795587503093206 2.7121783572787277];
  
  % Layer 2
  b2 = [2.02873005057593;-1.5297331801329306;1.408064242080266;-0.79116487102549304;0.46074418265510864;-0.58774267795121671;-0.62890664822625442;-0.70770761370379631;0.72332154334067977;0.017109565289957922;-1.3303722310994883;1.1324967336756186;-0.99905719115308589;1.3761155304526629];
  LW2_1 = [-1.034642829808943 0.52425518760046563 0.11043766464413934 -0.2518905895719491 -0.82217749879474955 0.94530665387363888 0.49905453780924502 0.15689490118240934 1.4805398220607477 1.2875751448440946 0.13630744686478088 -0.56694232992716509 0.013578371735634441 0.30144187905969877;0.0084447592052536852 0.82776758116880089 0.070907323446236986 -0.13682938047568829 -0.16728380381837954 0.60879261497479042 0.61420486497718807 0.022954111396482915 -0.45605241509247385 0.91914508341962653 0.13111200346045199 0.14070579851752665 -0.23443149814764727 -0.59488555711106095;-0.91321402615859459 -0.039509922552930732 0.38664538289236233 0.4415587750915182 -0.094414512314134919 0.13730947332985222 -0.82595959983520029 0.18185474226689127 -0.61739500003768488 0.44040598018888716 0.32624094458892083 1.0344432388090512 -0.13477910608760052 0.4208563724513914;-0.20087335220309097 -0.40088505322048512 0.37080343950453698 0.55257219947984126 0.60694438066927359 1.0477342444780724 -0.76927154039057832 0.13842424014852983 -1.1131847351463438 0.3822423201353119 0.53179439136506046 0.16632531892362487 0.57882220483825331 -0.25789270676039622;-1.0445361224403196 0.95462508630473741 0.19552226239872733 0.94436203456350098 0.60715127497925547 0.74670741744666891 1.6553072910567508 -0.97540828192681206 1.0204859834140527 1.0283370457882564 2.0501188292013697 0.77475038723380574 -0.5818339430862054 -0.77645172778717186;-0.11012162797574257 -0.10569147835333598 -0.055395645626765244 0.33365504734350243 0.55880372653824839 0.55375862406797827 0.43067212323977044 0.06155465105079673 -1.0363371918490834 0.45847168785619008 -0.84927541398016237 -0.033153856184328777 0.044116898126130691 -0.71407198073711831;-0.25812569297164789 0.83035420887065059 0.91937086348771035 -0.55543606588673256 0.7422546576574347 0.35803986279616534 0.077652678937064776 -0.53714009985063005 0.25424057982376819 -0.17411252722450543 1.4560234393960254 0.7192937396693766 -0.26349068276091148 0.15791717629449478;-1.3553950314354679 1.4052633732941056 0.68216666205788012 -0.36193252328157594 1.2959058306415803 0.63709653074891215 0.77943612014196573 0.020070267222200677 -0.43136861122048531 0.1261994100293278 0.37253010475197812 0.30982571391694291 0.87512487805054473 0.41112577883265822;-0.42974615502002811 0.53104644752822516 0.0161909107785696 -0.53182094857110829 0.30709219458551745 0.11123096079376793 -0.81495996891840128 -0.46650641815768085 1.687245810862813 0.8501298931808946 0.41306550510695345 0.72784784829747751 -1.2914808342000172 0.15705244893183976;0.79601440836278392 -0.41458362410708538 1.2828644997537766 1.2641253699514687 -0.92099281909291753 -0.81597289837950571 0.18799063311195008 1.2728766350569409 -0.5649015070346205 0.1582624117889013 -0.62958881810128442 0.43304691646755283 -0.30955695913455361 0.24122363257855522;-0.058427943999446542 0.52086300600114743 0.32287234390281727 -0.2987765035908681 -0.62418954808252725 0.19989914897100453 -0.4477195164151756 0.21270595104904289 1.0063719131469462 0.32953246730743813 -0.61048460507009983 -1.1274675384914326 -0.055596647253374119 -0.12725211282125107;0.39012843359598437 -0.57062918435172172 0.82235184865129496 -0.10340743527729856 -0.37074870928449588 0.3145520981396342 0.85013049237886729 0.63009059017870594 0.75470475209470056 1.538339800791241 -0.23438174504511683 -0.58912157617120231 0.43305642249657955 -0.48154791380111223;-0.11609365847198269 2.2735445767370335 0.1337540653928434 -0.54083382084447296 -0.015188990771188064 -0.71647117779943659 1.0329081383403123 -0.017987722856634376 -0.42712332666937386 -1.2510644850737893 0.25251909826767249 0.67976038962058261 -0.75141427261274651 0.0026712396528994799;0.9582385514229631 -0.32819533139601292 0.085811095113898533 -1.274312861974074 -0.23729454139849887 -0.5074616418320026 -0.2929197656174225 -0.63569673544421201 0.057713297552389853 -0.80239138676445387 1.2811826167360871 0.93361629608876673 -0.53835946715667216 0.51035561565778942];
  
  % Layer 3
  b3 = -0.70313809365702007;
  LW3_2 = [1.0463468268875824 0.72374275963899293 -0.83661191844789651 0.95030713142102996 -0.37246466277909102 -0.89163083107286456 -0.57463441068867582 1.0615009886568141 0.66166933822995933 0.35583634661631963 -0.98888343237720189 -0.72142596118971625 -0.56391076784239624 -0.56751155676003195];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 17.6991150442478;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
