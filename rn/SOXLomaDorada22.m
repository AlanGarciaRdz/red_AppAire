function [Y,Xf,Af] = SOXLomaDorada22(X,~,~)
%SOXLOMADORADA22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:34.
% 
% [Y] = SOXLomaDorada22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;11.9760479041916;17.6991150442478;0.00572573718866304;0.0175284837861525;62.5;0.0546448087431694;0.125;90.9090909090909;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.2957280139455767;4.2180786577883538;2.7969650438164955;-2.4177623237457371;1.2752415677200559;-1.2764174162104427;-0.84662759944580812;1.3192913509755886;-0.6130018463292628;3.8663724789894136;1.5891658012996406];
IW1_1 = [2.1770551429007079 -1.2017121566494675 0.50230120906258324 0.7839725191069804 -0.46690112738602485 -1.7117185388216642 0.82567070632326023 1.5195183011146207 1.0552606377475 0.8295714563622878 -0.66401461814913754;-4.7230971805671889 -0.51593319923701786 -0.16618162131595701 0.58150616894392115 -0.78602936540635238 2.4512862152867818 2.5456810936004759 1.4171688729138332 0.10975574478476047 -0.3933524284794081 -0.30406701970416405;0.48126946503605705 -0.0075376380231603531 1.1988952579806551 0.35165571633238335 -1.0911778065782172 1.4771342480417122 1.5989071290185664 0.15878087564390983 0.50354023130147851 0.49725452713729468 -0.20109389146703632;1.1121143245560794 0.832213815978328 -0.45414822991868042 -1.2666920669211297 2.1057682199508263 0.24977932912647743 -1.2430543657743089 4.4739851745755796 -1.9046825452863612 0.98536409890450505 1.0864814097038167;-1.2578437136544416 -0.4150058365568442 0.24366200860400522 -0.81158443649784995 0.84401566238060233 0.8299285307072567 -1.7053750709303079 1.3355765572142009 1.1325479084051735 1.5194047544548763 -1.1099880004227254;-1.7796208270727447 0.20800550745759563 -0.018298687857640886 0.33845185547367107 0.31714659261196865 1.3602566721850256 -0.22435084201929448 0.68370139527133966 -0.20585802586934784 -0.47885249710631245 0.39081308803156678;3.5401174087203287 0.48666220588438663 -0.65812468761508058 0.059735047705385215 -0.36935558225560794 -0.13439400178436384 -0.6988532730735677 -4.1476717393426048 -1.081572301306122 -1.6670406582077746 2.0682249669415969;0.60954528732103275 0.088813471123697307 1.013890587515206 0.19381742747758252 -0.2941054575386251 3.4289599607836898 -0.76791089322822748 1.8828019507227165 0.28676969750484532 0.40663511659033558 -0.12987546099187683;-0.44926247518221984 0.4284625772214174 0.3401855123159121 -0.87249332996336659 -0.36856462464921691 0.79257268611015608 -1.225704700112664 -0.97926574885848772 -0.067627927770431875 -0.064556826937337441 0.058382171939930866;0.53934266245880325 -0.38830531388498335 2.7980637288554426 1.5534093787016519 -0.6765651825215816 -0.84016700934689181 -1.372791473368087 -2.2037813886286002 2.6323375106908999 0.80225034770116366 -1.8267127336636131;1.9995746150885132 2.5077404024935088 -1.4688435755019811 -1.8739815599522902 0.6812867309698869 -0.91397419289338444 -0.42823079698758804 -0.11848450712944848 -0.8599424709021718 -0.1569391079796589 -0.59680249404544028];

% Layer 2
b2 = [-1.4681033136888388;1.6139968587387146;-1.2679030452656734;0.91839311707129845;-0.62418442299348986;0.89741139639795497;-2.0008850249552781;-0.50463451517813573;1.2399832828428214;-1.682875237230703;-3.6397832028582537];
LW2_1 = [0.26677560470300221 0.38982177361599718 -0.81012448908859735 0.43825479217131458 0.042085028943185651 -0.10498743372750184 -0.0034559271501362482 -0.27902709823165955 -0.11337966195931844 0.40300563732948769 0.32752762230782861;-0.83327193334472727 -1.5915053734300708 0.18927693411370089 0.6482482690310567 1.5546166065066416 0.25021690046046685 0.14475888500921869 0.13291497128827365 0.49597868525605937 0.42056553751896003 -0.48861716214365525;1.6044958984757356 -1.1863404192313536 -0.40828492845730346 0.0086182755337032846 0.10234781943339727 -0.51575270474694357 1.2472771695239875 0.64449946079544029 0.42359831919006696 -0.7741698342759693 0.11852114764047406;-1.7082036235184721 1.1589015364759256 0.22801203115699381 0.17083890835196106 -0.20927347468258295 -0.15743893222772631 -1.3404130107866687 -0.46515550336884748 -0.23645609515310498 0.7887213167184709 -0.24724160980090401;-0.36630801317932132 0.00602487917781247 1.3800062529938528 0.80495395499291877 0.74744717488912515 -0.36699482237827397 0.22080060863376677 -0.20334084640072964 -0.26143542865003083 0.66380311529263214 -0.10895969936100564;0.19803444627958608 -0.28578951768911326 1.5253720049323518 0.16983654946709212 3.1277149655287464 2.123370923510608 2.542803296996039 -1.2812860561773698 -0.18061973385903887 1.6867515759327685 0.15728079095784822;0.89816286700356829 -1.045483535861587 0.0398915037228647 -0.055299293325998908 -2.0167657060847235 3.4269992366158406 -2.1949096994010966 -4.0500383232038075 2.1525024720655646 2.4925989849402752 -3.9961404441886281;-0.49057721912503333 0.12272062032082096 1.4753524571939518 0.9212208507882349 0.57650896951464425 -0.679108034586281 0.13335275597793089 -0.15538914180263913 -0.32830608653813631 0.46860124430179428 -0.065816569502594596;1.3937426531174151 0.77751779645077579 0.29901301739124664 -0.5556864346845497 0.47399248018594264 1.3413807349451221 1.1400469631947079 -0.62083130365112982 0.090739364896352245 0.61984905402913792 0.28918234952689909;-0.84717990115599018 1.1852789611386914 0.22593606470809252 0.70043608672522994 0.16383665338756331 2.4226073257786394 -0.67348594633662362 0.3724582823425503 0.2461918109288519 1.9659498489676999 -0.25420212713466583;-1.9763150151358235 0.17354637342501977 0.8280945302052708 1.0902270319069616 -1.316970361401953 -1.201516321547941 -1.3594806285961585 0.46933880705516479 -0.17720413913104194 1.2254498193734986 -0.75157632104200156];

% Layer 3
b3 = 0.98847215848495074;
LW3_2 = [-0.14305637425328616 -0.368976446165584 -1.6535309191842553 -1.5806559882086171 0.88305391106634579 0.27428474798152308 1.9228683938603806 -0.85560439308801961 -0.55167265529929843 -0.052082879599893793 -0.39982444776664672];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
