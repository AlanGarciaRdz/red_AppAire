function [Y,Xf,Af] = O3atemajac17(X,~,~)
%O3ATEMAJAC17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:36.
% 
% [Y] = O3atemajac17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.201288244766506;4.04040404040404;166.666666666667;0.0561797752808989;0.00614628149969269;9.52380952380952];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.610531664582548;-1.9453978424803471;-2.3444721945631173;0.7307315883097415;-0.48493929347936388;1.3594384535927775;0.25269094623088323;1.798141280525287;0.27828365499355878;-2.0198712834863524;-1.0653738998628233;2.1693839121949208;2.4585330933205118;-1.666712927152967];
  IW1_1 = [0.095050361110787726 -0.2693149478706347 1.3639401293955011 -0.17768431899193446 0.12045122579305013 0.11338889431313352 -1.0439928148502011 0.10983205512911295;1.6048436856335182 1.0512145121195016 -0.97299118334341417 2.0703402702204441 0.38616441210796204 2.2175505163349949 0.11768039291413668 0.09626062038671325;0.82921321638448675 0.67119057462967813 0.11476410380190542 0.57674158621696925 0.060527303855985745 -0.027947705868346114 0.050003709531935385 -1.5062276088812097;-0.58169957303450492 -0.69688455580581754 1.9603340553934447 0.40446561937208847 -0.24971961309146942 0.97324351440665779 0.3750234523448141 -1.0370774367760658;1.7552211698502738 -0.49698336303577006 -0.025397964812852603 -0.33341672578255144 0.22954552510113702 -0.35576935926020203 -0.1057948676500427 0.31938514671733514;0.28680071542104757 2.6135989623396907 0.47042247001720672 -0.785656712925206 -0.22331850932619149 -1.0485958420127328 0.18167213184585215 0.81168577318041657;0.19373482952863541 -2.0274710434378669 0.10991686002202937 -0.0084416153869198724 -0.0032744904277701528 -0.017797318397630428 -0.15569482757542608 0.44056856873806799;-0.30782686420603916 -3.5747888390700919 0.20727889911450142 -0.17431784642628997 -0.1715489109570256 0.13464246945536351 -0.14662415109333091 0.17809630748336872;-1.3233213537168731 0.41611331218474351 0.74309921807735779 -2.5556160400908183 -0.35638671822625528 -0.38048112381874 -0.29405503984895981 -0.37745838792285208;-2.8598793376330076 -0.85688589949923888 -0.37076548287731076 0.16707119837467985 0.47656202256551927 -0.66540302936705464 0.095308752613071757 1.4281003432467376;-1.3207531487759128 -2.6090971078143732 0.39128321648111669 0.19211296671584313 0.85956016627403375 -0.42809101606964567 -0.10496141117105215 -0.51204443296541491;-0.22336042932233482 1.1575109150182838 0.32693135736830237 0.79597633265706047 0.021364931875486413 -0.72681729090245684 0.10878743093424618 1.1584678940743471;0.051955845371826737 0.66556935992177391 -0.31784712836908735 -0.31465797312948229 -0.079330196378098808 -0.080734055510646441 -0.082151946817599797 1.8127319365801544;-3.0195686013058167 0.95082808579310341 -0.31735157597377184 0.2911520343703547 -0.55845519584726611 -0.46201765743054951 0.0094121979126384446 1.3102219111613835];
  
  % Layer 2
  b2 = [-1.7815676320672529;-0.25218972035072151;-1.0814116486891396;-1.8812764409176828;0.87343588660863913;0.73470974435425684;0.73084446472026521;0.075880921471641938;0.23015479094653163;-1.0766264888631023;-0.58338865077761859;-1.612978022332223;-1.6861447022419851;1.8272178538816457];
  LW2_1 = [0.45250338113840932 0.12355181772459461 -0.63968192815370195 0.10370409407826307 0.037764155244305028 -0.17741999683883633 0.41268428196799523 1.2642208714649712 -0.35388631982508462 -0.20258690232943488 -0.66519531566810164 0.66619441737120633 0.15905361583199046 -0.21565215909568328;-0.068668066318621421 -0.678695812951427 -1.3914534424440441 0.25003402742416064 0.27632579517241718 -0.48120779722508938 0.53144410646928153 -1.3106945339812848 -0.38083163004275938 0.42408843539233543 -0.012842312255948573 -0.14857698285257759 -0.19830741050507175 0.0094060492193735849;0.099080705847092984 -0.84565636433690505 -0.26291632627143646 0.0094388560848147444 -0.38964408046423898 0.50446711953865386 0.97226591230232173 -0.88476661539233825 -0.22035384178573533 -0.66612800553922225 -0.55618163156987011 0.048799575184214981 -0.47334877471687276 -0.90504132017899785;1.3427227932658614 -0.37538188711519893 -1.1903131034848211 0.3999084223287917 0.074117547530915595 0.028770410669371096 1.0264610377742795 -0.69401922415591055 0.80155866814383536 -1.3523133255231055 0.75331823944502896 0.8065636048974778 0.97607779758421676 -0.2664056327570945;-0.51095485737505009 0.35823416404415814 -0.4477173620247995 -0.11994836853508579 -0.30135928209571572 -0.2266245698067488 -0.65588813293657655 -0.91426960393711243 -0.32370822952745698 -0.039984701206791415 -0.19568384558719831 1.0175991270631584 1.1531775441234127 0.40810642264269337;-0.9014248490889466 0.31050563091407229 -0.75788549786046477 -0.0041188627798240144 -0.68724229990575403 2.0731200343455463 1.4941545337318147 0.30272499335480157 -1.2200495800443742 -0.46635477359316185 -0.14979664862796366 -0.32105719872916783 -0.4291539981883718 -0.34879777630414216;-0.67061181561574024 -0.60600163825506148 0.78802822191657351 -0.41220490281711136 -1.887072856518192 0.60710813373623806 0.87531428561435598 -0.4288442841576266 0.45307764910793918 -0.42973811856919547 1.1809076632069035 -1.1228007001603613 0.23751717617911616 0.37871204628148591;0.086186296485291566 -0.32758674311662656 -0.78908056430128715 0.12643257018561507 0.23894320733277852 0.038393117151885106 -0.30165400990927432 -0.42403537071017539 -0.51858728437542445 1.3554595231280773 0.030261312655947309 0.0073152317293620674 -0.032358861834045773 0.1634717781692557;0.76962441065874065 1.3220379360377648 -0.033224894026098434 1.0419183337448807 -0.03379888044826334 -0.25513487480787944 -0.18614399088503469 -0.022284101840759563 -0.63050992524455329 0.4093717712451253 0.46637718858890326 -0.17723148789167009 -0.11945844763916721 0.63364728869132414;-0.18321843183372363 0.52595135169736951 0.81187855436363798 -0.25752532941656275 0.037266797578429704 -0.23317235409232817 -1.5294555408545407 -0.45329035950702978 0.99340964369344531 0.00082856302967261109 -0.65823322544046237 -0.2905342312342965 -0.23349648343405011 -0.75016275316257042;-0.43899259989132949 -0.35493591455191692 -0.097896250392863704 -0.65252142017822223 1.2356838843221616 0.54281035359546514 0.52198016495439081 0.0045727797420267412 0.77971735968977129 -0.78142278164462109 0.68104556922655202 0.80902551989072613 0.94406883221393356 -0.40182094242484279;-0.030292433269837975 -0.28839921654912082 -0.6499958742875056 0.18250558585091228 -0.54196335354902925 -1.0870232064281824 -0.056177249467854171 0.17436626820037607 1.1688108091274496 0.15500668842922474 0.36227452735937932 1.5318743573835649 1.0390015026070303 0.30384846648956426;0.069179824210989074 -0.17797896847570624 -0.16109960009667079 -0.062230176192306065 -0.59051308360308918 -1.1159115425680446 -0.51213262814769289 0.046526327156346123 0.80377553066139384 -1.1616867605544474 0.29371576588441134 0.81118154282957233 0.65596881193895984 0.2890450882004969;0.11545606636058124 -0.9425391018485022 0.5777801439442336 -0.13877224020751616 -0.66718907422731366 0.83864844608935762 1.0464504362757006 -1.0032284495675257 -0.77286944072932706 -0.55357645118089682 0.48232773138007828 -1.2887096415018791 0.06347036075545695 0.26515875293548485];
  
  % Layer 3
  b3 = 0.07795218814033443;
  LW3_2 = [1.7194482750440385 -1.5581410352567968 -1.1159107407116344 1.3887764001206897 -1.1010810290087967 1.5521935310253028 -0.99639985592027969 2.6128761032550973 -0.49843701453219647 1.1030625047095346 -0.40360656939951783 -1.5563151787381062 2.0814324700314399 1.9999148494761179];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 9.52380952380952;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
