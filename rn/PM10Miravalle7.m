function [Y,Xf,Af] = PM10Miravalle7(X,~,~)
%PM10MIRAVALLE7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:15.
% 
% [Y] = PM10Miravalle7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00382043935052531;0.0208986415882968;0.056980056980057;0.0063552589768033];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.44780671938306771;2.6684844890502486;1.2329103020136818;-0.94208108307334537;-0.77734632834494788;-1.2556413972030924;-0.46515796371280355;0.18485940211279844;-0.78791659089466437;0.51321776341091696;1.4151353273214078;-0.46377600899484994;0.84050451550059646;-1.2211125482884357;2.1879763232631766];
IW1_1 = [0.1348486000852552 -0.050844330968124789 -0.54553103185465268 0.085354190532461488 0.7763216621001966 -0.58957617662052919;-0.67887610915745522 2.2889908282701512 0.93515526671402294 -0.78614651240439326 0.89024100043241161 -0.40462834403827647;0.63149249316545863 -0.3682862811844983 1.1052964075547798 1.0058652968594941 1.1148599948064817 0.50903953659178336;-1.0175613069008318 -0.21944980606758993 -1.2381404840802164 0.98605189149840422 0.4986291247083815 -0.0026435343399167921;-0.45914882765071807 -0.30113932300811586 -1.2479279876239993 0.38612428769836959 -0.16623465606582102 0.18061725133706688;0.19706187497663016 -0.2061038571034603 0.16727467225086315 0.42732755824601243 1.8386979507932912 0.74937866194013614;-0.76300353015360167 0.40101799371377705 -1.2740711754258451 0.54918960715168275 0.092312491084942452 -0.48024635622766665;-0.49869995645703358 -0.024351928375876367 -0.42113227142018211 0.43684649803907666 -0.091135806392209806 -0.017088274371196976;-0.40530645942293331 0.28499936934512926 -1.0511080228711673 0.20803323524587197 -0.28398256509909192 0.37688893734761009;-0.30292591438118255 -0.0023333190561658605 0.43019209402609115 -0.4484369203177187 -0.53388368005204911 -0.046570726503969651;1.3640517651009998 1.564149111942402 -0.99380037559776246 -0.086806149017326237 -1.0800507164633182 -0.37260860747881969;0.40020653981545079 -0.65256718907405165 -1.0784089852635841 -1.4200054637458621 -0.99844142149002157 0.91025916901020554;0.86624390120734096 0.148134722204223 0.98154563089768188 0.57039855573871268 0.48864798932755515 -0.35779399023875624;-1.0529271378086031 0.2949335265294134 -1.0169821654512849 -0.54691087299933927 -1.1451285856163333 -0.14245654942654937;0.72333444138645664 1.5637743825878736 1.2655069421532941 0.4031139648920774 1.7303378876049547 -0.92553206444015967];

% Layer 2
b2 = [-1.1971242352070444;1.2449312981933998;2.941559393668733;-2.906924381151927;-13.582452305433863;8.4934846971380562;-6.8484456319174241;20.009007767372129;-6.6071912853133847;-0.79496310965691241;-5.6104312643794048;0.48631066162570308;-11.181312532517003;-7.4363273167077582;-4.0426196098776179];
LW2_1 = [3.6637146355150683 -5.7717351939331119 -12.774525638497758 -7.9949163227659712 8.411973676240434 4.4903662068029737 -5.8931360819009706 -1.1611264100252547 1.5409166263600496 0.14489700314862033 -4.2261265549570304 -2.6775650156768775 -2.1613049653692578 -8.9319548580711192 14.327541022808505;3.4726157462904066 -1.2451267181910237 -17.026988860742655 -5.8596816352354084 3.7579438107696981 -1.510451734260382 -7.4226950893911674 8.1927535058239744 1.1027444200969325 4.7284713260712428 2.6010862993456936 -0.095717857270589138 -3.6070793957423688 -8.0624298814218491 6.4661595007385015;3.0599532234071067 3.8222138928674489 10.870906397795883 -1.5909380827235364 -1.7237328269869578 7.1784565852967424 2.4565430803692023 1.8909101093745075 0.63976555254651946 2.1932742205633651 -1.8104346786902434 -2.6987584895264041 5.3433077123841315 9.8225422690268367 -2.8959491400255346;4.2905930636483909 -0.20059640797104772 4.3549406654968834 1.4114243424140462 -12.30715558718645 -0.21459372266092888 -5.6515264981646389 10.261070217904299 -2.0055265617055533 -13.184165971522022 2.4968770990263991 3.339505545533358 -7.5940571111214865 9.8816392127976354 -1.6038060977099513;-5.5949280336098433 -1.8497889866015753 -7.0798953629647112 -0.10193281667008897 0.69529279558128365 2.6466516542129903 6.7887691825640788 -5.325039224359335 7.3233244713560763 13.738249312671037 8.5605342008023513 -1.2297770391060785 4.6640854743244198 -7.9483029771316032 7.961121880683879;4.6314884385960502 -4.0765203021601844 1.1301405200806289 -6.8808771923127994 4.2948963368513828 2.438963815807349 -5.7383891475274869 6.2815917443801723 5.6300261215181431 4.6293708348032014 -3.28710168205565 -4.8170275651879493 -7.2805761512484057 -2.847457203413017 -2.5453863002472472;-0.4020074823837575 -4.6334425699151698 6.5289176754352312 3.5481250347035602 -1.9070386058319224 2.5384007375404352 8.2576569560974455 -4.9495961043614685 -3.9496010453130546 -1.4325473188213962 7.8970163183490607 -1.6816782552366991 -6.4409054420522462 3.4335197771432586 -0.30052106553952712;-0.097970030213212086 -0.68461622494532082 0.68419423833604454 -5.1450061998127516 2.0425201376077728 9.9635602126110303 7.3356493118825243 -2.6912458221802389 -5.0482128248900988 -11.264234119194168 -10.076013152764061 -1.1828941711682319 1.8974185520721101 9.008642556737783 1.6812286044685325;-0.83144079513001934 -0.96110111684858013 -3.9031379748848947 2.1314452004312612 3.0187515364041047 0.41794206276335394 1.300839325768145 -2.926439404554332 -5.6103805245646852 5.2680023093401891 5.1587659566694395 -1.4326039940727946 -6.2307017115451933 -10.390716908044109 -0.43665627576528693;-12.293143007597772 4.3522995690845807 0.80953730430225601 -0.87867777136804304 -2.5826565894899458 -1.2625091693240078 9.8006842100604352 -6.5604348122814446 -0.63065180173485358 -8.170389040484233 2.6210800521229323 1.8317501522701045 0.06386163023713895 -4.3541440751729423 0.10822011812334274;-2.2707282651051877 3.8878596622174668 1.4890970415884948 1.7825945369676006 -3.1586675685774295 0.37311149697304197 -0.10800430994966431 2.0577941380772815 2.6459690566893208 -8.5961822047507113 -3.5054147062904537 -1.5672692102644721 -0.39301970227109839 7.6404184866001188 -0.42587357925511554;1.3461759308309729 5.1372537330149948 2.8554090299257919 1.7968120946220802 -3.6188959465173061 -7.5972758019720041 -12.168793969777884 -4.6391112399101004 8.6590911886517663 2.4875622516646625 -0.11499698532149701 -1.803106516074509 -7.3980718028184222 -4.8568032321327061 -2.9823131571992967;11.628994161388185 0.14306814624557512 2.7067344991477027 -5.6484728874101551 8.5008027690320009 -0.19601316473014019 -8.2880342383197156 10.728409103286868 0.41207728725820808 9.9330703666604752 6.540108669484443 -1.5076372639159321 -2.9818384874715105 -7.9390959964852721 -3.2978948443616898;-3.9534289380485097 8.5375929035540103 3.1145667496723082 -4.3563278336789715 9.2145503603322094 -4.424312521239238 -3.5116168405718731 6.3357361715416083 -9.5446277257342871 -10.261261396368978 1.9965119238721054 4.2810239270281771 11.405168945521138 8.7522804628115249 -5.9332123211535333;-10.517217115977363 -0.67459305409932613 -3.5962915478513655 6.4478814280396843 -3.0192158957891895 0.50540954549446648 3.4366762753270419 -2.1937217527781425 -4.9531794534450677 9.2383422487525522 0.33505731949560896 -0.32283454641129916 2.2014551769369932 -12.732269278397307 2.3631930408108763];

% Layer 3
b3 = -1.024597621581012;
LW3_2 = [0.063305446046456007 -0.017886182181331211 0.036334415873841536 -0.11686415897706103 0.048504921760816791 0.071624602892693706 -0.052674692439216117 0.049748313653703538 0.072786702287130037 0.073648781349909292 -0.083730255397427747 0.053509624589460278 0.079119713588814686 0.033203864457864302 -0.050001388580809311];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
