function [Y,Xf,Af] = PM10Aguilas14(X,~,~)
%PM10AGUILAS14 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:50.
% 
% [Y] = PM10Aguilas14(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.554270866892645;2.1335765523814594;1.2251606306667073;6.0259734155319036;0.38195551298786656;3.3289018110722455;-0.43289602914961473;1.2363379007964268;1.1761761493465492;-0.70367793381722932;-3.4779268129811833;0.65436630661553563;3.3974519268673022;2.8587800683039362];
IW1_1 = [-0.34799280508339581 0.83758417361765225 -0.7624474673574031 1.194335091736574 0.46219606928140661 -0.76379193862633921 -1.2882630955229397 -0.31531483484699596 -0.024466692119975222;-1.30176463553123 -0.14364861847143454 -1.5154674351838819 -0.36680971856298045 0.64372588042465972 1.707692146584102 0.79137324551625676 1.2508076471637035 -1.9759006565729;0.57228640397997432 3.65020731421802 0.49311554983776607 -0.01216970103160378 0.45015426963340577 0.82160850003800145 1.7439103982348043 -0.039772600090972346 -0.6197250782270014;4.3445777083258532 1.4770722602309958 0.21164935265780649 0.16406457978552957 0.97946313635110838 3.7032529085886594 0.61402159783373789 0.07521886492841888 0.1057268535955293;1.0435006371418383 -1.0233077226763814 0.15805190009728748 0.67355863066900334 -0.51431777333441542 1.2525716138591905 1.1241193804508407 0.036514688934060513 -0.19553778906706101;0.24842519212667505 -3.2645767283323996 -2.5240498691254167 -2.2617800564231794 0.14299125503301385 0.31074051969456074 -3.0717694470389207 -5.469659022755204 0.8260839728285172;2.3190348026753678 -0.60009792078844082 0.46739720313204458 0.49866061971121589 -1.8761825427186694 -0.83411978513645046 -1.0001633980476436 0.27343372387103976 -0.29803189268728797;-1.373370050634537 0.40189201369688377 -0.43904497857403796 -0.20272746279742893 1.5156000556452875 1.0630523816569293 0.38874402640986971 -0.21244982416704122 0.21392028737559468;0.80737510575685201 -0.26584227546012923 -0.055254155113850345 1.6954589555774571 -0.28377527555185922 0.04567813947402162 0.084227174203116928 0.14493077585574698 0.2331775119172744;2.1247383040307879 0.73707725959296699 -0.52542464051470295 2.4922565178900333 -0.26938799079742998 -2.8294052319772378 -0.46640415660513912 -0.38171866348546174 -0.12526753237746746;-0.56814242166546014 1.2620754579445694 0.66850038142947454 -1.8886694054505075 -1.5560010879735788 0.25616708622535661 0.015592697153271121 2.8542465023225798 0.15311856501037133;-0.070947198105696788 1.3744882222816175 0.10517242119251638 -1.7674524399800107 0.10907238533653464 0.96859210934340545 -2.2684901464387734 0.031597855226637883 -0.20751844804068803;-0.68637926276420846 0.21392542394543693 0.019885485577371395 2.8630922876618152 0.29988958576155889 0.14923124779580524 -0.015612256287286495 -0.12885750416897193 -0.18920920603376601;1.7467667458383778 -5.5343904959091912 -0.44623651181958934 0.6366556963287292 0.63205174256907071 -3.6446494090345642 -2.0232823056732681 -1.0208724109629885 0.34572801514601009];

% Layer 2
b2 = [0.96006436317547772;-0.68241124620605065;0.97158518892540635;-3.0788822022719149;3.5982866209118201;-2.9762781578330202;2.6112687946361723;-0.65559885171748222;0.15524878364705802;2.8234081412474947;1.9442290068506811;1.3810825198264074;-2.9101984824878229;1.979109275535841];
LW2_1 = [0.31973225247806031 -1.8917607987159251 -0.27700892250248793 -0.1179352553867162 -1.4810087900538962 -0.80811099065560588 -0.80058755630444534 -0.66502426627802835 -0.89608394229452226 0.79201154344306224 0.44170097943218933 -1.385615471467301 0.72100964106283516 0.78720772368541503;1.3931864061245427 5.8917849367630435 -1.4814865358651321 -0.51726724792199885 -2.2614579762807345 4.0303380337840595 0.62104354683590912 4.5788587406488181 -1.4863956868093517 -0.14362507155266313 -3.5725042787769836 1.912359729982424 -2.3545517121857884 0.69063659614517581;0.80352885831430199 -1.9586071386363986 -1.6332700562463565 1.4035812573558524 4.7479881448076569 -2.8435956047466791 -2.5302001588205654 -0.33337039899591303 3.481162024029953 0.4010153228211229 -0.46629640351011636 1.5782044730560123 -3.2282301976323811 2.5856276799654352;4.2393755928842003 -2.4516947384043726 0.58306606201723321 -1.0120749178158319 -2.7225441825341585 -0.20207398188651482 -0.050603581013853441 -1.6523571981857286 -1.1171695820970877 -1.0937828135298306 -0.82619662222289447 -0.8126348972807641 -1.0848023235387498 0.91602751504657354;-0.060092719544558873 2.8693649802793657 1.1114577778066022 0.46017974442679233 -0.25467284092383785 -2.2203858358986999 -1.3505834641411378 -2.9483043894572494 0.26529499785998889 -2.6274759825811191 -6.6477092045855013 -6.4564328021450663 -1.7410668698651215 -2.3177700095436982;0.0064432158095960729 1.8580947624586848 1.9771368202808841 2.095445011227234 -1.4761087417734782 0.49677151916908369 -1.9218438745433681 -3.6746911688560879 3.8300163537554797 -0.62843502438668641 1.1870428460702251 2.2695223006331045 0.63641177671987281 -1.7345629729879837;1.0228786700000294 1.5406655078597997 -2.4559264725529522 2.2684366974389185 -1.6690844288381015 -0.30281693644503604 2.5710218931693376 -2.677018712936218 -0.66217012798108388 2.4361261799202936 -0.15613147635511404 -2.0310519155330131 -1.8788696300672716 0.30802596195615389;0.28677719080265329 -1.2320744365104184 -0.1568434294841323 -0.015269784014529159 -3.5570888386504289 -0.49384984714997959 -1.5837846795829011 -3.7702243007398741 -0.40840827182205591 0.099304054362171504 -0.23487951231518614 -0.63627849364250877 0.55902083926679658 0.071456861195483556;-4.2691946347611189 0.25392200034166318 -1.2232798546387564 1.4036250556717991 -0.60135736400399398 0.57486248425485953 0.786295652987135 1.6011211809364434 -0.6818868923297654 0.50290912377124608 -0.23564480301066118 0.46657099149934989 1.1459237528159398 -1.654504862879266;2.9722160644588675 -4.2314013449062191 2.6970521450224405 1.2967992349793875 1.0331072191608648 -1.4899679618482087 1.3390270928053372 -2.8168677275719936 0.83426433472774841 -3.9948123409513463 -1.9913778871228616 0.24170676588003287 0.20402507316160476 3.275628167040558;-1.6449779654071595 -2.2661707327702638 0.37027737335799721 2.5616783664148608 0.50263161639632492 0.668804792393907 -3.8520477211701021 0.39113562505010069 0.52656945347952855 -1.7365467019637439 1.0532269910614522 0.76361503540972242 2.0985688093877797 3.2762537560801688;-5.5524281664228807 1.4125891941526554 1.1291063828413728 2.7477875750902818 -2.5602335497383271 -1.6298690962885864 -1.9233688773260547 -1.4206815246305815 -0.96622951817831881 -0.30337725363318913 1.3751933056194479 -2.4210285816841006 -4.6214430772309969 1.5044177670650092;-0.51456330644900916 -0.13890919237860377 -0.21592975948142987 0.0013893954186832806 0.55819226530762933 0.024903209601496518 -0.60159855354346137 -0.50284355075021048 -10.254487169942285 -0.086191593777198774 0.056929608043943855 0.016118668781360718 -7.5547007374269413 -0.3375996943628401;-2.5839139833183484 -1.1857609076280338 -2.2453974698446069 1.5463794253556606 0.23804170323662743 0.27040192923689849 -0.07569240654200593 -0.688854465369519 -0.90849118055800304 0.35887695070582948 -1.1958835227055118 -1.3517224597275885 2.9630703594768235 -2.6071985943884481];

% Layer 3
b3 = -1.8685741747331166;
LW3_2 = [-0.15375906725539554 -0.054685027961557414 -0.075178579899207301 -0.17898795089081712 -0.038994086476014267 -0.068145574713631279 -0.044301862560481194 0.23887304836462239 -0.23652103638019095 -0.051108887950898574 0.092369089278087776 -0.033132309003084399 -0.93342348156504351 0.1340515346938583];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
