function [Y,Xf,Af] = O3oblatos11(X,~,~)
%O3OBLATOS11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:45.
% 
% [Y] = O3oblatos11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.100381449508131;117.647058823529;0.0560224089635854;13.1578947368421];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.2182440878477803;0.95118396069138977;-2.0476967665463657;2.2723710949414548;-0.06490464009830528;-1.2828206654741721;-1.8544051213189128;-0.034652296478443326;-1.2841346622128624;4.7490011718679472;-0.61622147884602774;0.66929209175927284;3.2417381654892816;1.6204536782962242];
  IW1_1 = [-2.5278615419687136 -0.36080157633742832 -0.30588888563895789 -0.21248683263423598 -0.4096501638370208 -0.89011870981587682;0.39995658078154156 1.0562354692838272 0.21332440905440267 -0.21062441719797262 -0.37178567928892475 -0.66891457949278443;-0.22025492100581553 -1.3779161065514041 1.6949601241923089 -2.5528500686183637 -1.7235292631458259 1.0020327622095699;-1.5122687994444295 -0.0166655244502809 1.1381444484937464 0.81212528636028347 0.66663912020646399 0.78259643820648406;-0.1740818968600327 1.5956032916581533 -3.7079938418761165 1.4381365186399686 3.226166020878861 -1.6026125878543198;-0.90052719281407723 -0.72616370354109494 -0.98417513422065384 -0.13674983277774644 -0.57214343629200193 -0.98052570006945416;2.4300579387507946 -1.3400394405400817 2.5130502349371371 -0.66725569647895366 1.0541822409331627 -3.7734569814736276;-1.2260115250435564 5.7912554113053964 1.67037681196141 0.031514627276839402 -0.60431257540073124 1.5917329198986017;-0.35009792865403994 5.0020833300217094 -5.6068742733846051 1.02054611972619 2.65447948284441 0.16359337197220664;1.4627550341380584 2.3216100839168732 2.5286064151130945 -0.99430298891982183 -0.66095728996737557 1.2372129288740967;0.02772390123239224 -0.50262708450687799 -0.49663587515900731 -0.61846909822201124 -0.58562263500240819 -0.55743464572966384;1.5370383908887004 -0.26803872361009412 -0.41836705226909554 1.0869534497528801 0.090054157888998371 -0.53209934563885652;1.6203440220371856 -0.61675899093970477 2.2373928510924626 -1.0496310256240657 0.33196337677681248 1.3177111095208391;0.26977457000176708 0.4133251591077593 -2.5546265095562406 2.8844220261458182 0.76091778933394516 0.45991122712116872];
  
  % Layer 2
  b2 = [-0.29189128686332522;2.1780297026336788;0.22781750452392274;1.8666417180177717;-1.8793777775167089;2.5279533921118906;1.3200468736203779;0.40643072188636198;-1.4524032922107049;1.6513688061870879;1.254054205442914;0.20582610276220203;2.3368666538936531;0.59998400960212928];
  LW2_1 = [-0.27483544865526266 0.1912650944762366 2.016538275645186 0.38329393985737059 0.86320666134012769 -0.81118046848284775 -0.068940877660877295 -1.2829688596761939 -0.35337819213248639 0.98768268401625836 0.71829130677804143 -0.57578795731968579 -0.91121592033319732 0.53681065141623696;-0.79511727040918256 -0.80940156061260948 -0.19582491273521471 0.90478160967469823 1.3156542521380794 2.2036480304148678 0.19623984439654163 3.8674492499958153 -1.1962461203149124 2.1363884274113256 -2.1992241907774086 2.5860953763119294 -0.63268232918066758 1.6777070637225306;-0.064720509462553449 0.17446458866878561 2.6087425900819263 0.093369946207991106 1.0255201707504746 -0.92450274488647066 -0.057374293397879604 -1.1121676052959859 -0.43761260423942705 0.90479642544542482 0.19099821951030233 -0.9860547525560881 -0.47114059699137883 0.69697273399008874;-0.52458111455752165 -0.049574155604791607 4.6467901308860382 -0.32114109362987692 2.851055109813514 1.8163896639732506 -0.0053258073734648789 2.8010223014862947 -2.0910439673668404 3.6591058790312716 -1.2619747789780666 1.0939914756288585 -1.9189867778656784 3.6665237282520216;0.75123342927671133 0.82737921567352102 0.30243506628802536 -0.58969835432733997 1.453152591922277 -0.97543360571078652 -0.22688284634831879 -2.508231872049004 1.1784019474152003 0.71442307664252624 -0.25353497438712613 -0.64509074418842438 -0.37087893457055815 0.66524472992917616;-1.0047566992036443 -1.4550562808280669 -0.0029522807605001367 -1.1469526635017109 0.81622564255166996 -1.3411009246743926 0.22610018933957529 0.43891864167481848 -0.17635991347736515 0.10692278285548898 0.3404571923399855 0.63992794774611228 0.46980949786804332 0.27667779153807759;-0.51019764995600148 -0.85792621254765544 -0.99314138946615282 0.68107217892380423 -1.5077738728548835 0.39787580441488685 0.17605374211649888 2.271547612319567 -1.1217444972041368 -0.79382030531778991 1.0485554278456179 0.51920622818811291 0.26709028180044148 -0.99161390306130348;0.019039841365602429 -0.69567145529408603 -0.27179835383441225 -1.3388545717476557 0.17697313678841442 1.2437356014416483 -0.11074825051856581 -0.79155033461874058 -0.39059638808695274 -0.96707513289426328 -2.8093662698444124 -0.22218749828250423 1.8067616006724136 -0.24611487643639202;0.52316445396290334 -1.9007914384804396 -1.0086354243980982 -0.71869938733376426 0.39871683630077737 0.21198193634837167 -1.3844620110470487 0.51285920567032384 0.7354115601002329 -0.7896516405868752 -2.0164192872690387 -2.2129594322863562 0.52782400521207817 -1.0509313960241735;-0.077049330368141572 1.4875005819144276 0.59707470290602749 -2.6953721005182292 0.51952460581981175 0.4116863486004757 -0.39997455546895366 -0.63817649148605127 -0.70783390673078816 0.89108277051441709 0.28295255650403334 1.6233618833927903 -0.98198153105167085 0.57956870773730695;0.70191756341884015 0.35226081489957373 -2.3883213396691345 0.33527730689272239 -1.7499308165098351 -1.5172222050633959 0.23136804679270503 0.93465462956613798 1.4308584085355764 -2.1168205823865041 1.0561598672464216 -0.97093816842304204 0.10096755832089888 -1.107327074590829;-1.3725999755185734 -0.63405017729588597 -1.1385514621995954 -1.1378446732983203 -1.2289333922890235 0.87243810288875656 0.77325207025345866 -2.648860675927502 -1.0445462185385181 -0.33732565260863812 -2.4223676934103282 -1.7423443998085961 -0.74959284029577966 -0.78782366689663286;2.3736279394103335 0.16196754707730332 1.6006867691254756 1.178012352767406 1.3928056240826667 -0.40689134013282485 -1.0900623640931908 0.40097319907812773 0.880358402438985 0.84964452680900426 8.1857058057223375e-05 -0.88482118012673006 0.089942928757236501 0.60593693061362441;-0.77331073262160388 1.1403290588435886 1.3662192559320447 0.1097684358332478 -0.3223512527384742 0.65834771195113206 0.18488404703253419 2.0052331838903283 -1.7530945172992936 -0.45122645349495755 -1.0580964489760383 0.3919682663599906 -0.020885774524147187 0.14808519648737181];
  
  % Layer 3
  b3 = -0.01388692307035592;
  LW3_2 = [-2.3885603129246649 0.31135075245096466 2.0905255139472869 -0.50506800426164 3.2307230222853081 -0.74507291417194121 2.7457195678978095 -0.65447650710124339 -1.5622599477888481 -1.4684198354676121 -0.75541807596454469 -1.479906404205249 -0.67310007577052577 1.6834199355935726];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 13.1578947368421;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
