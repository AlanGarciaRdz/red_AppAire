function [Y,Xf,Af] = SOXLomaDorada4(X,~,~)
%SOXLOMADORADA4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:31.
% 
% [Y] = SOXLomaDorada4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;11.9760479041916;17.6991150442478;0.00572573718866304;0.0175284837861525;62.5;0.0546448087431694;0.125;90.9090909090909;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.6888292794594546;1.1956715899242913;2.8759734714298371;-6.0483674934975777;1.5460489157267301;-1.32644473005434;1.8981408753588183;-1.3525743031659616;0.24506145826659489;3.2017142594715793;-1.972723586569272;-3.2640516396374299;2.3822073372380221;-4.6843381228893026;-4.4461451834995191];
IW1_1 = [0.15963070212222166 0.15514577964565907 0.042716637835115229 0.022732801040435156 0.52158843807894062 0.61930217581113245 0.15484733883100119 0.88050538715113091 -1.014091725722984 0.27971958150794468 0.015423665291006403;-0.40020464189264093 -0.10468515670610175 0.10311466596486023 0.082052910218121625 -0.44786765916662946 -0.51137726871083022 -0.13900497197506687 -1.0334910626823532 0.80570150547501229 -0.055318018412523998 0.023285172005183919;-4.0223779856927866 -0.052116095057970699 2.9511710012507044 0.74027963798691865 0.63457001050629036 3.4261588725233776 -0.68598515057259823 3.1850616756561205 -1.2524471616373853 2.5982483242406658 -0.2798271857358699;0.035806266665985312 1.7200104775716309 -2.298848394207313 -1.7408965323074048 0.98509426332415073 -0.35391857981117314 -2.656668872190012 -1.3684549225249636 -1.0188030165926623 -1.7878709826528101 -0.50797695761039119;-0.061737367796735935 0.43606586003825332 -0.043556099720924155 -0.27816023068900592 -0.7211669935341446 0.034228584442097525 -0.64321171298134372 -0.99063672461781271 -1.217602444426356 -0.84865772272848428 -0.65600031975721385;-4.9783347673879357 -0.42335226150168581 -0.90496388574325315 -2.4564456869206119 -2.030153446336878 -0.51444840874800701 -0.887979142133832 -0.4028033054646587 0.42384358162541896 0.36729080191082347 -1.1806669468734088;-2.4422697364535049 2.4442558620471004 2.7918014290444151 1.2025349641494771 -1.6374160678982586 -0.73956721900733569 -1.1264549163420634 -0.27319713049702044 -0.77784846488734527 0.81933607738484537 -0.60799332872066203;2.311913691372693 -0.13377986594028154 1.4111145582399136 -1.6450485166447619 -0.3719193790515426 -1.3889534243817483 0.7389132217618255 0.99289082533265116 0.26899086931193728 2.2704843446019152 -0.81600545231238231;-2.3920419145326322 2.9020145151676093 1.6063654240858898 0.44487120239462424 0.21056413634921606 -0.055328593191890811 -3.4447329163479465 -0.20873421585606206 -1.0705615835675262 0.30540677658570464 -0.42547949195952883;-1.5335809276028169 -0.011901267545484564 1.2836541529343664 0.082892798191409461 -0.79666307217247345 -0.11352279603430032 1.7607224216371278 -1.6019351020845876 0.83552470445393423 0.97916426541056878 -0.94607028543528482;-2.4631027958182266 -3.6533521787200542 0.081472469553874827 2.1795203037599196 -1.3538756560904008 4.1647881733179606 1.0461396876408013 -0.48941916574002653 1.3525043665710768 -1.199496714038579 1.6377452496348643;-6.8848598614688408 0.49575376358722778 -0.52113771928711516 -2.0656949671062699 -2.2350513548864583 -0.14701774011347313 -0.8589520538363038 -0.11210221914392522 1.5119229023805316 0.56279425925769155 -1.810024084167803;2.1027276533823431 0.15321575898897077 -0.23083782714318068 -0.74105839788621541 -0.19523624191389732 0.009311333897264594 -0.228849538967862 0.10765294988161095 0.18554852161251303 0.73368878450516728 0.42257459924044843;-4.7131113334591372 -0.8478894547520377 -2.8356764589291545 -0.87300051210320562 0.74584713279329484 -0.70790008407551963 -0.4228084223112587 1.1927437228026585 -0.74643529168714962 -1.8519153716393977 0.98781889293286351;-1.472312517060727 -1.0031740047840301 -0.52363848608649044 0.94036297794683921 -0.75058066400307555 2.6595298448102991 3.8966798099792284 4.1873957332017504 -1.2929365919893183 -4.2340933599879067 -1.3368959889087875];

% Layer 2
b2 = [-3.1824085173054439;-1.6626001640168473;-2.8496232405066486;1.9123230062022258;4.437297799445016;0.24239254539230465;-0.37984242354712999;-0.43937877022175997;-0.010798777467302085;-0.25553565523588795;0.70122407637864725;0.80652834047593724;-0.69641403075817021;-0.89451469856623111;2.3347322224878901];
LW2_1 = [1.2854036812879721 0.33606703612980293 -0.26994610736849928 0.99561864493902297 -1.9458683624996596 -0.2489190282320688 1.1016825197594862 -0.12951473186956167 0.67787495400039521 0.41713495975462089 -0.080053288101882253 -0.057255492277129276 0.89344376355149047 -0.87377727486106993 0.85099377328542181;-0.12159272626209358 -1.157162177871309 -0.70330020633018386 -0.063529690004457018 0.27655054750454822 -0.25629305259617707 -1.6677903356373422 0.66484245111210516 0.65039304052599511 -0.89387472713504812 -0.81562715900363658 1.6498577318364913 -0.14405558621751038 -2.3597992205677425 0.77212433751534126;1.6785061287258731 -2.2922311835992835 -3.0026217316488695 2.4055038969859805 -1.004103469441501 -2.1538646881548451 -2.2110795511521557 1.9086313544237248 -2.6445720699090942 -2.1525471978700654 -2.457997907842862 4.6076153576578198 -2.2016400423585165 -2.3210677915033973 3.6122521710184761;0.52288866807745338 0.63412178141826936 -0.18590130063623433 0.88261553360856837 0.70739033251403149 0.59532746945120785 -0.31991449839675329 0.73163871158670613 -0.58522559421389586 0.24776533827895131 0.28272781061001889 -1.7951372715574334 -0.37125971600828844 1.5079516077281492 -0.48095915305163278;-4.287828873378186 3.4938529455782845 2.2319874733182044 5.7610083262906864 3.5842617187231536 -2.4237661870182881 3.7780545633673128 1.6360413465035653 -6.2641335311962036 -0.12385663543981767 -0.86955965850778105 7.1023931531445808 3.624463621422279 1.5138575233100866 -0.12149186657489483;0.17182275910447936 0.46674461634386855 0.072083661933992807 0.77156293811982335 -0.0039237528525633072 -0.40314593129896542 0.20517473549363083 0.28305067688761426 -0.36341446258319654 0.28609653213479574 0.68750107476439515 -0.44406609079769321 -3.985499492223568 -0.66144764562669356 -1.0616354335616074;0.41174970847917863 -0.73660165749536544 -0.22419894277455887 -0.65474930831701161 -0.59765207061212566 -0.14748838256220195 0.38648427745758285 -0.76309917252838932 -1.1916381620493397 0.22591358859475463 -0.038436292881815555 0.17866262740761121 0.040451315559269119 -0.47534612859382952 -0.113740592539879;0.95949138406344159 0.12365750812993828 0.25829938338727876 -0.89208347273623345 -1.138743231732892 -0.55422512015033665 0.29858738378481087 -0.64901600462890541 0.61350491558786235 -0.45933194612076189 -0.27349187416371556 1.7580790892052487 0.30447160268862361 -1.5165932288737485 0.48716678637605715;-0.97319210445579318 0.68370802016212129 0.18279815476307967 0.66128890838329468 0.92578543366114663 0.1167137438261604 -0.40248561797528132 0.78709858342908023 1.2785025515648993 -0.37584235748730077 -0.0073296673274175078 -0.054157686874211249 -0.44668991198533758 0.36634757246894362 0.18139425864508193;-0.059421706934825166 -0.22445495535300136 -0.46232872776998352 0.32236349473217474 -0.50824977859432241 -0.54147638944301235 -1.0284561033501127 0.90775533025987221 0.53799910817967078 -0.0033397168771591157 -1.4263300813421136 0.84238848985101655 -0.89535069546315715 -1.2107939895294735 0.76654953267749359;-0.88662087788896227 0.80007449630869054 1.1795712570201575 -1.3928152364894086 0.1872901526165652 3.5878554712208888 0.047191955356417542 -1.711169829280357 0.65842648591737873 1.148857615833913 1.3146937325506938 -0.19130365335397756 0.48413945789936103 0.82453352609280406 -2.8011559316968433;0.55719594615046586 1.0754636421239465 -0.45375320661641982 0.92758442978479172 -0.76560745762567817 0.21067278871644668 0.028076574667773926 0.18898350043147982 -0.36641169789049011 -0.50694594804775861 -0.17835392801410996 -0.063449304430294506 -1.0884247641467786 1.7584179284593402 -0.97453030360719983;-0.97330897696504381 -0.39626820178134747 1.6559474542411277 0.43943004883061088 -0.24514638464536728 0.88752540739387997 -0.13778514092382399 0.5476932664344708 -1.7022311681197879 -0.70499781857886679 1.4176888286541363 -0.17424304339855679 0.7232359675051635 -0.25332746314829124 -0.060842163278753358;1.0793424758003105 -0.73965146019211092 -1.2122633088492558 1.3906032510577913 -2.7407173696599849 -3.5824850555653125 -0.055209641452621319 1.706365887983663 -0.65616784423715635 -1.1343114663116642 -1.6505541915715449 2.970668433695995 -0.91413833767067998 -6.6531450013368385 2.8901087158177514;0.23344617022922923 -0.27717091640563352 0.0058290087170503463 -0.14506718050056738 0.1934988475466449 -0.27139246928363031 -0.43557337175068012 -0.96158185442850219 -0.79640893646586697 -0.14320892606415939 0.90574133679590385 0.67742895127315927 -0.8689954490285039 0.192505985924665 -0.98755406050494465];

% Layer 3
b3 = 2.8051579325442089;
LW3_2 = [-2.643160773511668 0.12245254160735919 3.1832568317132837 -0.97085068618077774 -1.9831825991917371 1.3929859993078062 -0.82252385201370548 -0.99248865000135578 -0.75913678071478585 -0.20797389536098509 3.7005820049344647 -0.058257072800266145 -0.046370222858873496 3.7158568801069056 -0.037749470992026149];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
