function [Y,Xf,Af] = SOXSantaFe48(X,~,~)
%SOXSANTAFE48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:53.
% 
% [Y] = SOXSantaFe48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.0084346905805955663;0.2033026969217509;-1.0935359450953823;0.082452807421758506;0.10463365034272649;-1.7927177966641141;2.4819330408547957;2.6443257320148335;0.38107595796942045;2.19330424112961;1.2441976042418719;-3.4021628526344689;-1.3505752007462706];
IW1_1 = [3.0675914458543865 0.45236186899042957 0.73330982078606877 0.79451132507304933 -1.6640570902234646 -1.1395810585327364 2.8013872191555658 -0.1911780123327686 1.3419764658199591 -0.31541498456110673 0.31073427993314962 0.67813310914212921 -2.5028296982474827 -0.26291599044182579 1.613696272526375;-1.394476509413465 -0.3400023748345728 0.038873884288634884 -0.13718518452368758 -0.013998275537551067 0.3758661630633266 -1.1092994881566118 -0.066567940243898394 0.28834054352908345 -0.83312486854261036 0.1021453812599806 1.0444451127714678 -0.086635859362213838 -0.72984697436633605 0.16002565814590231;1.1948132401557503 0.59141059851845534 0.84481288213498185 -0.67993925801626365 0.29356388131335831 -1.1610994179307899 -0.39473872404835386 -0.017810403169263717 0.18928236237663079 0.72966685018961197 0.39149696838056253 0.75172625148759098 0.64921901786005076 -0.20717379295358121 0.23206993711181231;0.94482988671350665 -0.1017604290399646 0.87697815979296689 0.92382756501771712 -0.098724820681070066 0.51168898993704692 -3.5537600573016501 -0.15853588302480853 -0.3284768322022103 -2.9647730545299362 -0.022494889757970489 -0.66677262639866308 -2.2627035540256131 0.67052027253433755 5.3345180695122112;-0.13982316549260898 -0.10501592862056799 0.15182137155745426 -0.21264592798617496 0.18274324226717387 0.67663950908084869 -0.90057382079124992 -0.0599652093405003 -0.53353593127795584 -0.79593335655485364 -0.15370026476639886 -0.16434274232306911 -0.20005310161478052 0.065843919081209859 -0.43894826909397056;0.89102434227464622 -0.25841515462245868 0.339213253914179 0.2266092993528257 1.083996556188594 1.1767317755829592 -6.5209475922187492 -0.18909680907057294 -0.66176321023185902 -0.61783342422929177 2.2836067117046546 -0.13176496970505419 0.36166142438848892 2.1590236199782429 -2.0492126362823511;2.294068313870171 0.074108391931053952 -0.071334691366958719 1.3923664215770728 0.07384726577475674 1.0416014177498536 -1.0481865892512308 0.31202971087440812 0.021009592096781497 5.8294929906287623 -0.56871425300497225 -3.1851530231984011 -4.0836681093728329 0.87904935922108585 0.60769737165182547;1.6711605077251441 -0.11091941534388279 -0.57060320450973079 0.683845364454435 1.3771791851942572 0.180935957991542 -1.800027097078319 0.62655434198723214 0.14469247396517365 0.53182284081688636 0.37565744023958347 -0.39922283962430682 -0.95117912816509442 0.21455112472421814 0.85344427418722368;7.2399858274243769 0.20166420888020792 -1.1101635675098338 0.69759872700628089 0.21668482162957456 0.43050642513153842 4.2084844144947624 0.41979915357815267 -0.74419432968920385 -2.6157352921454882 -1.6251011658035039 5.1982627679138789 0.052023285028420178 -0.14347241452892762 -1.3287889428594488;-0.15576923331504972 -0.032426262812194039 0.30824559964699699 -0.015056982041706052 -0.1900247139947403 0.13421278050235119 -1.4264247660908334 -0.11014336325140606 -0.15358037569718325 3.2482600884552943 -0.024750464986574818 0.40852365969863474 -0.12800480222137584 0.1017214225303303 -0.68921552354303706;-0.0095974917091820513 0.074749835119245406 0.53864388627805859 0.019122287603604737 -0.36958048296142509 -0.21159386853045131 -0.78319667965665063 0.055543080198621322 -0.40645001148820281 0.12667461876283426 -0.37999747002346296 -0.44158745778005748 -0.46938173755592438 0.5237696075224042 -0.52765845528444633;0.36750007371710264 0.49418747903159949 -0.42800036909112682 0.74673382074349604 -0.82985018386002884 -1.4658628323700456 2.5695572080293254 0.041485236095981412 1.4171859113540293 -1.6780845200912797 -0.6721763482009222 0.97283296490765991 2.1725481613164823 -1.01449708876919 -2.9648992021844451;-0.49228159705155633 -0.10849304303739418 0.22819176908001726 -0.24606424010568026 0.36289405169500188 0.38131158923633479 -0.2074174524680833 -0.086659471214298317 -0.25520013093721416 1.1278143902427022 0.47499337619909887 -0.42252495096172915 0.35206362692745741 -0.20703439027293899 0.17221301173862791];

% Layer 2
b2 = [-1.4734278791568973;1.3311129525246503;0.036594152016046502;1.2576545909697783;0.52971349923161626;-0.058939754768218874;-0.022719282078538568;0.043152401435964292;-0.67385686281000279;-0.88786906455061365;-0.95173413119834249;1.615098472680937;1.819515563123415];
LW2_1 = [-0.18163449658415523 0.28253927455704825 -0.030716709589367026 -0.16328721382202593 1.0197189425114366 0.94641968268745114 0.056232617005726765 -0.66307476850103597 -0.41982351603805912 -0.3213758469750454 -0.21224801950823885 0.12053129550048483 0.64857288049866879;0.50533854900412378 0.41346261553497426 -0.28533564766645447 0.020646800703066962 0.34407367592498672 -0.78157496753523814 0.42238711019653463 0.029160724294900263 -0.0084568249793156493 0.31759423560643435 -0.41583142030154374 -0.2989543332655909 0.66855262410549499;3.9839068785121414 -1.3220713136746103 -1.0602316831846665 -2.7313969042929855 1.6974297980822697 -0.94450601801295075 2.7477518021800944 -1.7533718720623244 -2.8695517916875839 1.621030141623873 1.5625469871135034 -5.0097971939879935 -1.4832822062149738;-0.24873801843165419 -0.38492056466416247 0.067003411287055767 1.2037928157790418 -0.17533831688029358 -2.4463590728956843 0.86713067983452741 -0.44906676630498238 -0.50866554109875284 0.31726103439453701 -0.42114297905997827 -0.73318031806971107 0.27281960534667199;-0.17690719896856688 0.25823277513547493 0.060186695472424431 -1.7114614794464782 -0.49190277734775273 2.194432210630902 -0.76816674809427854 -0.38294384469868498 0.87226506340988097 -0.16396224239936574 0.096777303032745288 0.010315434025428089 -0.086255245421037727;0.23899235140503483 -1.0885114113280978 0.09387561509393369 -0.85541380331864092 -0.054253466183572088 -0.17389470757597383 0.020953624936750265 2.4791486402360166 0.97819651852441158 1.4126682768185714 0.25311709879529132 -0.21886827137531931 -0.043007055629294078;-0.30917416150784049 -0.46839390717637075 0.61449081551952434 -0.25679111901126239 -0.45157598045043584 0.01859032588096704 -0.17402513219352533 0.11639488510819734 -0.78514522796693176 -0.94464832865826587 0.14197993696955458 -0.49807931593821725 0.37524016837794411;-0.19395124107180189 0.0405724614459105 -0.29735169166796094 -1.0259956597788162 0.22240722167897731 2.7568164213309765 -1.5023762186327856 0.78633506566305256 1.1673976575985403 -0.38947467773185135 0.53894894096602408 1.6366198032630748 0.65313508706794177;-0.37795655744636436 -0.21341613535536086 0.75404419185683524 -0.11703268843268308 -0.13573554429037687 0.22243306888593317 0.42504245015447262 -0.19075698507350855 0.41416658276825491 -0.51921735994747453 0.14879901660905509 0.81551342877594113 0.60064783947105371;-0.33049532959502609 0.62623755175332996 0.098798803870345758 -2.3652257461808954 0.25593943293598803 1.9742552692552033 -0.97378757784777559 -0.4577441801362514 0.49293218307811076 -0.55588934122129241 -0.062597013487090222 -0.48169529546169332 0.4694054865353301;-0.071069852036804063 -0.098440933558124624 0.44888859220120025 1.0445515731906969 0.29822211911682772 -2.5766012035673262 1.2637469001909154 -0.73618934984205531 -0.82086367682008166 0.37913156268210552 0.073553237151941731 -1.2516983876204282 -0.8954327804005966;0.097383228320695042 0.43226496906750184 1.0433199671429869 0.38907242705612016 -0.51779382608371816 -0.84178882740676242 0.52908018544685609 0.24413660321982278 -1.0993729440474236 0.16055923922769585 0.61440954317844776 0.21781282327949367 -0.53602931362231687;0.40436374482278542 -0.5748275296945341 -0.011252627242041228 2.4742744027301224 -0.57215337186668658 -2.1855201952424159 1.0827185759969344 0.4362980705341255 -0.012304371060166658 0.627641003244365 0.68110419574560499 0.29328483664057414 0.15257877782589158];

% Layer 3
b3 = -0.7738083437976655;
LW3_2 = [0.74637112848311771 0.74545141258095127 -1.5548803241901712 2.4783300738870522 0.93074756001172554 0.16228992606252826 -0.013254547049725215 -2.0859857364520624 -0.41102361609858074 -2.9847360498264055 -3.9335856967646339 0.94513505661854036 -2.7722526368883411];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
