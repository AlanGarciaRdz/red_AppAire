function [Y,Xf,Af] = O3lomadorada9(X,~,~)
%O3LOMADORADA9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:40.
% 
% [Y] = O3lomadorada9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;17.6991150442478];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [2.0650559831048994;1.7637413600051122;-0.13698577342317564;0.77940039243121073;-0.089607464333693071;0.66625384369167873;0.10542380294667159;-3.8222361304538919;-0.1367805636580775;2.0277419444512068;0.89811793419644259;-0.31695189025994819;-0.87591090972089625;2.5511323637341641];
  IW1_1 = [-0.49630750392268186 3.3568937457608237 0.7256967087694095 0.82875235317218365 -1.1820345367334804 -0.47824622012654694 -0.8198741326209984;-1.8323211366197201 0.14455167247993275 1.5764428180643457 -0.041602875101361042 0.90937904569174877 -0.27008250518436294 1.022935624966643;0.57103549862750114 -0.22506018194981767 0.50984555510442076 -0.27633159304338711 0.50678231982274624 0.32328736592671276 -1.3069531733677602;-2.0160366288971359 1.7759302156419652 -0.7085594051149563 0.42083801674675608 -0.22538339636022225 0.71514651263811846 -1.3999871832086517;-0.08376299585369161 -0.60985999572381455 -0.16089292915152226 1.2133360550807399 0.78465469281812217 -0.83270549468102473 1.7171737292800879;0.41682038074544031 2.4632904186222047 0.64692433803707816 0.63154882658020028 0.10368081928286112 -0.59676541214428236 2.0087019829748103;1.4022547572458952 -0.32046062080771587 -0.54537260821573685 -0.48136730064592831 0.94939771755753044 -0.1231314126966323 -0.087327442502843633;-1.1967690899145935 0.10154108896024266 0.20722411636479693 0.6258888846377999 0.40898380836475545 0.1624626022261533 -4.4586005021445292;0.21354675133763232 -0.25157109361833468 0.45771103004659403 1.5741705710439649 -0.40235493693911145 -0.73140656429264006 -1.9337003269627273;2.1090367003977577 -0.42042769400643992 0.83389056346483192 0.89714944013789122 -0.53149892271890886 -0.85044245155638731 1.4070349375863134;0.66926842945170451 -2.5522068828872335 1.7062157207178705 -2.2165910603192129 1.450566020483415 -0.73522671374725046 0.94362427219916811;-1.09493084668098 2.048847791021732 -0.24033675520309747 -1.3327370764699846 0.849359482206691 -0.73126695318993495 1.1687765423362253;-0.57155570849682868 -0.8831582897539817 -1.5967896036451077 0.30285161403014049 -0.82200158791469491 2.7650192778093436 0.094243086884793784;1.1171871637603537 0.61998795427748965 0.3662846538173391 -0.07272109635670479 1.4920487159294762 0.75737285632424856 1.2836652618531712];
  
  % Layer 2
  b2 = [1.4215808931799943;1.4134422887040057;2.7598948497538101;1.8172638973887314;0.36940900123719234;-0.71297014751157473;-0.86251931506149515;0.5115265681677672;-0.36981132229914809;0.82475514605577516;-0.70979808219892271;1.2520138958389913;1.1194822765269392;1.2769554889600592];
  LW2_1 = [-0.47952195740710529 0.7240103887668119 -0.045938714933726955 0.2217708700530564 0.0030072784505816019 0.89982859499069578 -0.33831702792686624 -0.59427176052492048 -0.58990440479666184 -0.45738520160223484 -0.0012575675540894976 -0.95104381225011847 0.76100320425452217 0.075794318802605926;-0.98209804294733682 0.091111552476597246 -0.33410864799509266 -0.38368389782822032 0.62986307449286416 -0.22630331419954752 -1.1737716181762208 0.54463403938414745 0.93834675568682535 -0.80562919684817547 0.79247517459397721 1.4132877917375004 1.4421440328417789 -0.030004492738501771;-1.3320587982795749 2.0792264971691585 -0.86168661076424058 0.22474429736753376 -0.81557662111105855 -1.1289569323900959 -1.0313726094973694 -3.7753757160570633 -0.5205651100924068 0.3942553234392141 -0.47565613383038752 0.099973139242727022 0.64698410575898757 2.0460550603179128;-0.69923243066534879 0.52808030223106384 -0.13105621064186038 0.46387190837787584 -0.057141004066937139 -0.80737621769086254 -0.18513642098684274 -1.344864604655627 -0.76944021041319399 -0.026891068615761661 -0.67826132087297697 -0.35923442200972067 0.11232497546449499 0.6451514083475175;-0.60888748904276369 1.1670790993500841 -1.5851674394103275 0.17690400649794288 -0.065867408819801548 -0.060115445130625104 -0.83321287792102694 0.17164271697458885 1.3442156597105588 1.6394368882285917 -0.038106898874487871 -0.5095151984073818 0.23791897365496351 0.54590808571750338;0.23056205172684691 0.55139966404332164 1.260910767143016 -0.068385460040199075 -0.5403872766123754 0.21337139016644344 -0.43516921978579293 0.98413569704052384 -0.24864071869864812 0.39880902837207399 -0.020135176899449214 -0.03097871750942555 -0.60548481270256349 0.40501708426330318;-0.9336090287233364 -1.7666616931966423 -0.61238290906698845 1.5732568669228537 0.0084236643283759557 -0.96745424737653463 -1.3380240843415685 0.41538516358909611 0.11595005319028864 -1.2422832361095746 0.49724494688614285 0.26269573665660606 0.58159348879990369 1.7367665984405922;0.29609147081610804 -1.1605790449466615 1.2303039311813382 0.49803214288203751 0.55882746172324127 0.11692020291927077 0.084030527660498316 -0.14076581395102025 -1.296130215345455 -1.8386216158112996 0.44976584028442967 0.14846663482277728 0.0054059130563141669 0.21713848164781935;1.4834782657583947 0.098845289064672451 -0.42875374481137674 0.31837120051617357 -0.74209331018624181 0.17451512583328843 2.0011120161621259 -0.39381221079411272 -0.41877599999626591 0.53268648169969524 -0.64192775832378379 -1.2284152060201565 -0.24400594469761852 0.73421463056016545;0.3520188584654913 -0.85791506786895266 1.2182321659521951 -1.1632990745140686 -0.24768825209033973 0.62615124534233835 0.65178632238439049 0.57744472940629521 -0.52259467899010403 0.520764550298636 -0.49491413901276171 -0.20942761029694898 -0.35434893935823492 0.14535243099166495;-0.33150376367628864 1.2020434045368034 0.013910164269324531 -0.2808378058187106 0.877077513995981 0.28507220963802493 0.79500931814335807 0.72262314550987317 -0.64593185426801392 -0.57281498564898914 -1.0785565707274236 -0.34974824317517228 -0.59531540247483006 0.0044044613100232555;2.0186560194645882 -0.19167643042640198 0.35214488476994588 -1.3442000578326514 -0.5838386767264917 -1.2517298570036128 0.60004624937390894 -0.43592526197502557 -0.072263828398075519 -0.71967315284087685 -0.056798969795881456 1.6384375139909515 0.61575123644715846 1.1007439649647794;0.59777240234191042 0.14026833144976947 0.71245557525776071 -0.87128423482183059 -0.33724872516947835 0.33515973756347911 1.0752434320902857 0.79288330373839555 -0.72650721094186688 0.25299402010136363 -0.86852316723749345 -0.48476549713915373 0.075724422940626479 -0.061547291351325008;0.33154566975835492 -0.71439628272092759 -0.62820319855160256 -0.69127936805482226 -1.0607168634130324 -0.13338493810163826 0.12370520024426777 0.78059971854427312 -0.15162857636720178 -0.1214133934132226 0.30670990132568898 0.26050935240747414 -0.075645198659816448 -0.43340377011055609];
  
  % Layer 3
  b3 = -0.68556622979580428;
  LW3_2 = [-0.42923399803704898 1.1697437761512182 0.81449217559581333 -1.4347864854436354 0.7080294201236379 -0.44613474921681967 -0.64152356790467691 0.74724106642887356 1.3817158607591242 -1.0885812981480403 -0.77872094971638028 -0.38713826037364601 1.0119115524445321 -0.90767351306689115];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 17.6991150442478;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
