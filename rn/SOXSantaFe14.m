function [Y,Xf,Af] = SOXSantaFe14(X,~,~)
%SOXSANTAFE14 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:51.
% 
% [Y] = SOXSantaFe14(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.6531121105147961;-1.5032028709984551;1.4702235903793979;-0.069620229966364799;1.0905228531463083;-0.52406751876652313;-1.051834557220837;-0.6511478115550231;-0.8630023491988309;-0.83893001299120484;-0.76184299474818473;2.4881430125300175;-1.2506383927972298;2.006069752378532];
IW1_1 = [-0.035759453552471371 -1.5090105202967152 0.35593468158745628 1.0547834674318752 -0.063166951058103979 -0.49656153064532221 -0.65831235243289643 -0.23543816817729496 0.34644763697340297 0.51560707493552915 -0.84819039116392692 -0.13684651797192812 -0.31478234004461447 0.030427385241335772 0.51951094777121054;0.33335752412512265 -0.52006119256176497 0.54191177029341553 -0.65700425085764591 -0.14087814903830143 0.35511125362313484 0.66066153399049754 -0.39049830776284311 -0.985931590692675 1.1553732464492135 0.093919286341952221 0.15157718703391176 -0.74949297332846387 0.62820436977355021 -0.32277570801531635;-0.075184624058103888 -0.72081527874528495 -0.53422347945369941 0.65143660588012176 0.477634020816669 -0.2817752140303188 0.65547307828773715 0.17337914459603501 0.092156311340411814 -0.35349874737284015 0.7967743927764539 1.4087758726186257 0.093639170542078626 -0.32009585637252924 -0.28246198620481427;-0.11947245401586627 -0.42191468080580541 -0.26985035018367437 0.41266187512066133 0.15457539049314592 -0.13011924065311112 0.27167086845399108 0.077295953302753809 0.11209392427481724 -3.1415540135631028 0.36304449845272557 0.87316927524145371 0.058745216927468022 -0.22914323391383681 1.7991187113488132;-0.44807720791705452 -0.64368700371751708 -0.23166350767285745 -0.075769962204107338 -0.16771719666206167 0.21875621491536046 0.71963208740561868 0.2458893791526178 -0.96819363999231478 -0.74495683201141283 0.35551599681381685 1.8444408947853783 0.13394474652148394 -0.16728495795443715 0.015681263758433813;0.16671877037160884 0.98170803710964105 -1.0620496524247622 0.33937065452917026 -0.34361393294593423 -0.19551108084871591 -0.27789327290195798 -0.52670158738816708 -1.6051018761179936 -0.97573906909420671 0.64093390330649802 -1.1538433503406369 -0.49560194240547395 0.047945488791694517 -0.47184898819041132;-0.82331381214680199 -0.051376084665792188 -1.4133626719520744 1.1919639381548865 0.60605020299128221 -0.09186867556126227 2.6003144069232706 0.10008920824266564 -0.4470819328338636 0.080819466604905424 -1.8245271230106108 5.1189196386909526 -4.4275738571796772 0.15242199007264007 0.3178848392215447;-3.9041108390885255 -1.5425494160605322 0.24085137543724319 -0.075964620426474463 -1.422701483831972 -0.71132622854203476 -0.45831299381821672 0.039816102100526239 -0.10836868471574716 0.35647853907677701 -0.91506712440551585 -1.5385721859606336 0.94150092753223158 0.6567366382218377 0.1810151957004574;2.711380112608416 -0.69273756727003921 0.077499465746467697 0.46094780288150722 -2.6192925915975094 -0.24599557822114163 1.7353800042390626 0.039931786792400142 0.30579950729269784 0.46140537550834848 0.83110713101765743 1.3227522690834304 -1.0736965427979273 -0.59572522854284549 0.50681057326855816;0.1513910562370743 -0.128874135987847 -0.093192767749895045 -0.16673750973776494 -0.94460839563508525 0.15634632271663063 -0.39604683819655162 -0.46550812999256569 0.45256441045417395 1.1314325260804097 0.25053668940707868 -0.23664651637604886 0.72367336142421057 0.21596654302569274 0.40951378852722337;-1.8230397490005441 0.53552220267852291 -0.82358955327089745 0.17345149490084746 -1.1537364854435914 0.31214527299252559 -0.81724742637061443 0.024181262416645706 -0.33742026181531182 1.650488233111983 -0.93437047047077992 -0.58838839430919376 -0.034313875504668051 0.49905577065980666 -1.1567552825042882;2.0267631401173767 0.099673391917193224 -0.22893869319740376 0.74108325599384195 1.6330930706566265 -0.42004127957366127 -0.48521233040321893 -0.34475754749104437 -0.9878865762042881 0.097100866492788152 0.698822304559512 -1.6927765395246044 0.77972372378759902 -0.18134859772415682 1.086170665953561;0.68127539823680661 0.08095230882818634 -0.3240879582064437 0.33774731215728604 -0.23614194416403814 -0.3703610369385425 1.0393917998380384 -0.80014303594212399 0.6248381244072041 -0.23395199700862285 -0.58039031427785215 0.22339533371958531 0.31370178314788155 0.48843508734317465 -0.10699736173675981;0.63418512701756147 -0.17503718186224823 -0.46388331919270132 0.027908141475483209 0.531500356901908 0.22933456880530839 -0.40341849003033226 0.94924627519696148 -0.046771012029337831 -0.53365385968496981 0.15139623947254824 0.6758476872307585 -0.82486129130840635 -0.2135102409039025 1.7745652105032654];

% Layer 2
b2 = [1.8635906636965371;1.4803915851537328;1.1357179556727586;0.26097962966115662;0.62903052714204599;0.43736600156128286;-0.30765659942724699;-0.26212959589774576;0.15182416328347484;-0.098821584072586705;0.44816363065261705;-1.1239737518989696;-1.4300336616250522;2.691487239687766];
LW2_1 = [-0.5353397894287254 -0.2302634601431604 0.59736301216698595 0.33581542955909949 -0.33346119559085363 -0.11942870008712077 -0.28717242322621978 -0.53870978949984671 0.1958500429932456 -1.022995670692824 -0.073509666532453166 -0.23109130442331721 -0.33583883424409872 -0.46881112531840902;0.62479869859253567 -1.1753167431446516 -0.8386097374475876 -0.73512840971445503 0.3711570264976673 -0.49445123437879762 0.27942885006105317 -0.41778164782115351 -3.9796575373477623 -0.45480717644182467 -0.75302181335783658 3.3663084015412545 0.33360995184488301 1.183480616897034;-0.6014777390014503 -0.21596404705937008 -0.42238516383942121 1.4985584350338264 -0.0064630581356085876 0.25045978033240257 0.17178838393974763 -1.1372014839953091 -0.48147084988209082 -0.19710879565969999 -0.67817009114676419 0.44370997527007588 -0.61187344450805603 -0.38096840472148047;-0.6185278178581024 -0.30399628850986593 -1.024930281256113 -0.97760849227473934 0.17208460001167453 -1.1185145784496457 -0.11428742916498434 -0.060375439473723889 0.15600310316989502 1.2680793488342272 -0.6674853499258051 -0.59659723578725166 0.62575345807993499 -0.68599759693149054;-0.49639337385076826 -0.30505011688809697 -0.060887926328778853 0.52768498738865977 0.27862916668283644 -0.22690362080865703 0.14038346739714774 1.0190550507426714 -0.16946669603814815 -0.44124552604147088 0.55221121552541241 -0.23698187645647539 -0.66848528739894519 -0.3932259954522726;0.14166864164445744 0.12700150309041669 0.31006826678559379 0.34062959080704697 0.17027613197293623 -0.26630506817558502 -0.17188858982102759 -0.61006027373231642 0.05468695005747165 -0.50089591430615088 0.099113588115973039 -0.55957177299129801 0.62617902924263114 -0.92071895040937823;0.16828270671743115 0.5603182988702009 0.86419863480710812 0.58005352191143433 0.45110676447265485 -1.304345532396062 5.0414643648009436 1.5286903378621253 -1.0335845274254856 0.38240649674410465 0.57053394527057089 -1.316524176892969 0.76756071607075882 -0.54489999041369697;0.41079869211185255 0.13430111166976405 -0.48602915641459471 1.4439323451818697 -1.1017064782821531 0.27070543894029647 0.21075335866304859 -0.5667688528668009 1.0797702510697267 0.50879454029101645 -0.043076026315373099 0.98565167519160268 -0.21780922991601107 0.45934113088003137;0.4051472268588221 0.29165160114154942 0.62940312103525053 -0.7675160832815312 -0.55398357826442168 0.60693877761923953 -0.17512555616120581 0.60216778849802421 -0.28711758908346613 0.081177437833663033 -0.90422190163724125 -1.2582459953783038 1.3424940859533148 -1.5387626441092244;0.16961850224539457 1.1437002241985372 0.9906861379652081 0.3215657351323708 0.83330686349519245 -0.87485617549321215 5.0389270284711758 0.21182705173096872 -1.3172006802475242 1.2874061597012436 1.3044505152025767 -1.301787077464212 -0.061407179850347826 -0.49806137039112308;0.051306372797172331 0.43867040377132926 -0.14724532349418659 -0.0029063411627881196 -0.18620026504532058 -0.83166076609339679 0.035508939163824763 -0.13679794745473675 0.26671433937332334 -0.72147646114953246 -0.25279496286963943 0.31885084408972464 0.49751676066169792 0.43244855282358668;-0.60689914809899526 -0.4189856542565894 -0.50569152594540323 0.79980241624102477 -0.32187712377802297 1.3683629621162183 -0.25916502667488095 -0.13403046040164254 -0.02329398139693184 -0.91101444329701153 -0.45432084141313755 0.85592420052029994 -0.40468933616283886 0.90343058595347148;-0.4174947614781182 0.10996691905988824 -0.4144160598555699 1.3085578516678176 0.15167035846337434 0.59981693746528686 0.05405257307518796 0.2191754798416439 -0.52762152408369756 -0.35929775287682242 0.13985834599628705 -0.35761106570290535 -0.45148475615739336 -0.77560697997288752;1.2797705916776623 0.77513807489597564 2.4284306948965804 1.0688889981622189 -1.262738150799277 0.37541561967654491 -0.81768685737980518 -2.0797823645063227 -2.221481554158284 -1.7351080159050911 0.54767830323696853 -0.26368161059020778 -0.70810461427604598 -0.0090827572599815401];

% Layer 3
b3 = 0.97492404103267227;
LW3_2 = [0.030057843116807186 -1.6464048281945614 0.35971590420230881 -1.3530621027290319 -0.3155380930655497 -0.12585064884655739 -1.6545956952812835 0.17435299269075141 1.2952888186914002 1.6713672682175298 -0.8541478909160396 1.4437220916596079 -0.31333157142465479 -2.2385345820095379];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
