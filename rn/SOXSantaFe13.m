function [Y,Xf,Af] = SOXSantaFe13(X,~,~)
%SOXSANTAFE13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:51.
% 
% [Y] = SOXSantaFe13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.1258956856595692;-1.4004809299902048;3.1935581935828274;-1.11955772080196;-0.77090686064524738;1.1483540459714849;0.73008248519488594;-0.56126384343644875;-1.100269271443481;-0.68153500172106873;1.0907739444253131;1.1995383968957456;-1.5864585187351476;-1.7682477984128069];
IW1_1 = [-1.1778871139163385 -1.4016442735310735 0.28920158899121756 0.70451196100362656 0.034576848084345718 -0.19865067764479016 -0.52919143245354705 -0.19394758236776941 -0.20659805632627115 0.27601701504312237 -0.33829309482071712 0.13779374972594283 -0.19923529239231663 -0.35193391947859509 0.90222591037933486;3.3664849908362529 0.44886378269251342 1.4521636673818688 0.29520997433785923 0.30395565452243445 -0.54683280273779422 -1.3777751420050657 -0.17047568683073255 0.76513637081405861 0.012846526620765946 -0.091276644619641328 0.1252115546062689 -0.25220649678510365 -0.26577479069903442 1.0068499535220332;0.46434786389432625 0.89370110197047203 1.179120086481626 0.86535197927614638 1.5352164366558876 0.36218010162046255 -0.86258323123294867 -0.014969489572499904 -0.9349008898763147 -0.61561924270810264 -0.18628914905505328 -0.61417022631526652 0.36006880808418118 1.0829391034612632 -0.39023466716654531;0.34036035909685619 -0.74308454338510221 -0.044699565673901959 0.30343059517756715 -0.23884028522171635 -0.85299172158494529 0.52181202033065677 -0.29635380904139252 -1.0050346093922928 1.840995488974603 0.11620871222569863 0.29764103080373228 0.7192425225697473 -0.07180618175095746 -0.66383738482399124;1.7306459058136767 1.0249837972900713 -0.18579307629176928 -0.082811119917249043 -1.5324974225693633 -1.0266131575067385 0.094626333501594245 -0.42691593504580111 0.20985264959077207 -0.36932301918869098 1.4069971112094894 -2.4414523812711084 1.7749406208786054 -0.079270868560774546 0.58204387981362316;-0.072710794330223913 0.076054925405465698 0.27150716782373935 -0.39449967307012551 2.3736289591988911 -0.010220860066399093 0.087649154103112831 0.025543191137454249 0.38611022288921981 -1.1747666977768918 0.10190802228129908 0.02960564313715244 -1.2934801056790299 -0.11551938812855463 -0.60825879500922186;-1.7709122792585741 -0.57867065421472963 -0.33851313807284855 -0.064768349279023335 -0.35531446451429027 0.137346190952716 -0.44281955959149666 -0.054510735430606645 -0.25443801615323031 0.55100057400689262 0.40653695869652318 0.13661355217912927 1.1930191709644042 0.14702403375267206 -0.4145928356610602;-2.0860045104783667 -0.27811619877480148 -0.53089088154092057 0.14430608546344004 -1.1021670672523713 0.2186393038023251 0.4483052375462741 -0.3652573777777966 -0.52956877069077057 -1.7758474199220693 -0.52688926713072115 1.8117957788795587 0.2065711508124996 -0.49649768353335577 1.3359861711589889;-1.4610043705440396 -0.53230629432418208 -0.25222928197705047 -0.10280899985929846 -0.23388386000776218 0.10793511063760003 -0.34615683786932872 -0.01320136729579989 -0.2693469507423551 -1.9845815361457575 0.29480778310310918 0.090835171024219924 1.0063770268090746 0.15365925137059913 0.23319966982574947;-0.85648390032671129 0.83056167392628 -0.27067496071736713 -0.97321226127016103 -0.36856165042268102 0.26925488044032497 1.0011591813066769 0.099369968308683637 -0.26103178836666618 1.7759964768765504 0.11911205848888215 -0.34351112493445074 0.43988115594905469 0.39120558229306424 -1.0143978148236601;0.356439930795034 1.3385956713498821 -0.17297479727604767 -0.49117250394709966 0.24684386919015125 0.010481331379260037 0.47892924463739889 -0.19250793030686858 -2.3658472257105965 -0.38095275156423292 0.28022868592763328 0.92407537201154322 -0.68475173506618148 0.65724882441618582 -0.16805883030516969;0.37867778070684421 -0.15447056968642553 -0.48635143467376429 -0.66396128246832342 -0.32498998674874552 -0.72435913933793139 -0.12394706149152417 -0.64279245921793882 -0.56331006038872666 0.18573201847610596 0.32113560105250266 -0.096422666284311537 -0.47233459198051353 0.28156318808308911 -0.28003361495530166;-0.59328669777235488 0.60782488807027435 0.16602845774967348 0.25083960302580621 -0.36287515577417784 0.13542514186368498 0.26264571442288731 -0.48148752554397045 0.39603763678797071 -0.50178029481732533 -0.094618841372537135 -0.23620820605323101 0.088440696837837174 -0.16627916611469312 0.280431519403673;-0.281392428823109 0.69455176653406925 0.17463036707306473 0.585349079024995 0.11832976260082398 -0.018015632750747405 0.055654640332901302 -0.30344694056683219 0.42334344637705756 0.21845738798213968 -0.37759651306500497 0.62258647212639251 -0.80189155157328762 -0.23596925065676597 0.35592001499742093];

% Layer 2
b2 = [1.4295397692015706;1.2309408739336112;2.222478811395578;0.92296296971431335;0.57896155324162513;-0.36934292375889688;-0.99325148011543574;0.21316939495301754;0.083912190843001333;-0.77938173967506019;0.88487264636053398;1.3750379492844225;-1.5361516564114455;-1.6797211196624757];
LW2_1 = [-0.56546370038788862 -0.20106049661125272 -0.40980927400756728 0.86334324270882157 -0.06861663406150148 0.51676126085368379 0.24832673224088753 -0.43644222625961082 -0.26509832383553028 -0.75406885775402299 0.11918201280958535 -0.56537972617330212 0.3135876877431315 -0.43135180699275028;-0.45498332381708406 -0.48864920376264109 -1.0380022220844516 -0.50995357116368123 -0.14644729238799914 0.071800222729234739 0.072864684076355574 -0.72555681910869108 -0.020271086235671212 -0.07704919863264062 0.62131482976205532 0.38631314869468614 0.8342744734214963 0.82261042992151434;-2.2840858692119781 2.3089217873570966 1.9383333737021282 0.45165783798290582 -0.8393353972383466 2.9894785652543709 2.0702995878613404 0.58174203623806764 1.1350891195791135 0.7287170217191663 -1.6781939632604403 1.5941069762053983 -0.94518750660303952 -0.51835019923276049;-0.27949923482875549 0.34499825940078821 0.4564058008597085 0.50952599043792224 0.21576888255678564 0.78955224370252108 1.0169316866148213 0.69206086975282421 -0.57788201900229152 0.38324648980364395 0.16489908856542435 0.75007466225317843 0.11731248014879295 0.2047951385524929;-0.24192511804317174 0.6975499136607316 0.68215459930114053 0.45403024872739867 -0.039950071583597049 0.04450161860852396 -0.064752222706216001 -0.084911202770498156 0.59808853256053485 0.070199102434875538 -0.71333819335022308 0.53625787773431488 0.40966588199904103 0.039883075447559195;0.10916367828789647 -0.47249621492547572 -0.95193051270476481 1.1894526494915629 0.10477530216604992 -0.064613415369360883 0.56258129717222727 0.25405277277429911 -0.92169591431374931 -1.3238420913006574 0.3560606864399149 -0.66929723961131204 0.56300190257147931 0.27323092962938295;-1.3155263975930906 -0.82814196954551245 -2.9476756914496418 0.21380492922710748 -4.1423892997390546 -0.76740988109889963 -3.3083747465862592 3.5728448417715963 -2.3767273465712897 0.031177139695446554 0.10669084925551903 -0.77439039332711979 1.1519472214984152 0.44722210925799349;0.48722246195261681 -0.29231871532765397 -0.068317403211070285 -0.74408402614950053 0.29587083560010186 0.65779032780408608 -0.079640053999793528 0.39100678346436968 0.2824757539082437 -0.34826894699960531 0.29100511356069086 0.77759484532337197 0.58103037843509298 -0.50991949771640954;0.22744922679304649 0.58980481343371849 0.64047716701503332 0.32713975846493992 -0.0044408591999496767 0.13673158330340932 -0.26214103229158414 -0.19183407677161046 0.23563951340969913 0.12984030703266744 -0.67009932801634065 0.0057865377663673945 -0.30308628218824829 0.23295934222245604;-0.56888368494131714 0.44624152298823638 -0.14753120083522397 0.56622994620543121 0.013165553149061371 0.44902938383866681 -1.2629460954450582 0.15154881386013325 2.2739402766768526 -0.63440278565134767 -0.071981958138831459 0.087309011158298186 0.65035805479763653 0.20607102912157713;0.29881410155716681 0.086539271412523364 -1.3948069408138657 0.28213313145206598 0.0021224996453490935 -0.29284374562551974 0.16982507228753863 -0.1018384505995131 0.3897099718598413 0.62188172809780762 0.69811651316286139 -0.11846117548523606 0.71609258236660123 0.11273783642875963;0.1667017819240664 0.041638955704714917 0.57168816849713389 -0.41214118106354625 -0.54903497069704077 0.32757210931547104 -0.38344549095845215 -0.10472187264646976 0.36368527643144383 -0.37476142211321034 -0.22307550343308027 -0.11815116445956388 -0.62676760587302016 0.42117700722013568;-0.73281989759620392 0.3520086235051394 -0.54080064890618607 0.78457590484753648 0.43539802050968385 -0.73412602610019817 0.2723805384328139 -0.36577597275226925 -0.20204923735992925 0.58309104618754393 -0.12921357649050169 -0.029846773821653051 -0.71982006010882449 -0.39362767027982226;-0.33456917177359913 -0.98947212790008621 -0.30621889970144478 0.32128214037758041 -0.32496953072441515 -0.37639048927137697 -0.38561646922054993 -0.25827457155315681 0.20354053362992741 0.40342191453731374 -0.31477008240108673 0.3877458875687661 0.74512158235818038 -0.74815660799023964];

% Layer 3
b3 = 0.19279007368329065;
LW3_2 = [0.6536424644976051 -0.33439699335671297 -1.7500267770269158 -0.30713215963055818 0.43666253066754041 -1.1262530953150443 3.0082175710533541 -0.055493924291260592 -0.54246785757029314 -1.757102758088134 0.56194335207207957 0.63935727686683907 0.21339113815718846 -0.90258229299855652];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
