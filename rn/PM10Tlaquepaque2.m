function [Y,Xf,Af] = PM10Tlaquepaque2(X,~,~)
%PM10TLAQUEPAQUE2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:37.
% 
% [Y] = PM10Tlaquepaque2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.00773694390715667;0.00572573718866304;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.48838562526469975;-2.4746350076794381;1.2518368453221171;-1.9087188209881938;-1.2883164616549798;0.74084344324467577;-0.74368970771228615;0.57102996251957117;0.21123390771484093;0.64327163962359224;1.9225608334290372;0.59367907226543681];
IW1_1 = [-0.16917990505529368 0.93678101992191376 -0.14415146578687621 0.33399243607287887 1.1710121604155457 -0.043141529521032639 0.12730438679192718 0.18809168889446645 -1.1035713473363551 -0.047826627725054846 0.54221570011343334;1.8663604001115337 0.080850321156746535 -0.55525356052819919 1.6053643719784982 -1.6386045476713331 1.7713878192948547 0.51799939469531009 -0.62935652643340534 0.58613387192274724 1.1496234687198863 0.41121829641354957;0.32332269826525295 -0.244352652304758 -0.41874990360883219 0.42405917823691519 0.390156471797583 1.2858456759116221 0.1741595796179975 0.086933776792972622 0.39813887029210809 0.036562254498215228 0.18350466829500511;1.2842283944414536 0.069219277654262668 0.2087562786347385 -0.62746867248140537 -1.3210347768933519 -0.48795493076419616 -0.16619440282170236 0.1114073727816781 -0.8662697751105789 0.10508261216827786 -0.17142643672323021;0.47128518133939179 -1.6190407215524976 0.1613575036399108 -0.32815665793512355 -0.3088869021546235 0.23566374282466235 -0.035668518517588337 -0.22087446638822986 0.49098138443222705 -0.39387914728763995 -0.65606904817819689;-0.099577326244262368 0.52372477305724963 0.48645388601589096 -0.11319006916436319 0.16612232027939997 -0.61487762009333802 0.04320861910489724 -0.3150508398533361 1.6507298021847776 -0.0024536233131677593 -0.72586913946662446;-0.40146503846841514 -2.5754075698772945 0.45708035526241259 0.096166408625156075 -0.29069412495306535 0.20298439967499965 0.088955949056286662 -0.13448178169905986 -0.060323873483684273 -0.52331686576780767 -0.23027174110574275;-0.44434398387852581 1.1292697160268119 -0.48981054755260833 1.0054021953497483 1.7438602548883027 -0.32864418845332932 -0.14654142078324561 0.63254811726659244 -0.69054731163851524 -0.19211876519104551 0.091391337031368272;1.0430636627633465 0.21330055436235326 -0.17481855357439841 -0.32245453787210215 -0.1591231150416984 -0.29624958176893268 -0.47094217240298064 0.4409784029658721 0.32880855124808189 0.04740717859368726 -0.19204027417147645;0.68011067430244132 -0.069114568617371863 0.54280909932341614 -0.26888803620165508 -0.64268154809470268 -1.6027997613886062 -0.24256364612879994 -0.41861458585433758 -0.56139239671392738 -0.0093213043085920641 0.031496910856211438;0.6856705576242963 -0.25146387376724977 1.4162046775152191 -0.71053402188420933 -0.47911313778288006 0.4019643852523529 -0.81773808977158668 1.3701934350788583 1.1183436000066183 -0.62501048653451041 2.4493731979949955;-0.37009505202648857 1.3246188161986459 0.2650221273612734 0.072223748282505856 -0.23688149735495534 2.3191469874522674 -0.13767902411827146 0.6130203499145559 -1.5590484315377329 -0.29994674874853877 0.28660534087029954];

% Layer 2
b2 = [-2.7617254591550959;2.8470641098640752;-3.1809956122629184;0.76649512750688664;-3.108366235513452;0.2086429891716361;0.67291979262051194;-1.6450577769783346;-1.4106617090386921;2.4173871979504513;-1.1491498024995428;0.70397308947757231];
LW2_1 = [0.75147655482716513 -0.08578517677875229 2.8158431046160972 1.9957117859799445 -0.12451237219308314 1.735337516779923 1.4577322184580221 0.0029452608922148201 -0.3546536660298415 -1.6355548367524408 -1.3221793687631986 1.1168586957295785;0.47718352189352758 -1.7078700807214153 2.6451184992189583 2.9878251325154492 0.80171768882855299 1.4323489504411286 0.32700954760834222 0.83449117685627605 0.44133634104400205 0.38385416164132424 -0.03103655222466967 -0.69366690085189231;-0.28216064571224853 0.59449540671138779 -1.8535460235095187 -1.5069662707806308 -0.83901816359478976 -1.273242631020773 -0.10143449126962686 -0.62510158684389139 -0.67022290408404939 -0.083643453490727021 0.093673057269142129 0.6248810098499562;0.18123164383748816 -0.5692044398529611 0.95668972327139523 0.8549062066016162 -0.29586886853885669 -0.12929878575653439 -0.37774521963724211 -0.01329009642476954 0.38741679083131331 0.97701559486890954 0.53634081567106284 0.11788631810232139;2.9518074555061427 -1.60985403337807 2.4015757741816048 3.1092028163028655 -1.9996095875741546 1.2432113888337519 1.445197613588497 -1.8967763330372927 -0.27759608612218412 -1.3310448482965607 0.44084423157213598 -0.28702458318181101;-3.4791182051762832 -0.082923350760144815 -0.64410968807357039 1.6546166641920985 1.0226597911410951 -0.82280140223033305 -0.44994372951034189 0.41608960700550529 -1.9286189440299844 -1.7966836251106668 0.92909511031733438 -0.41479089213613118;1.5160263438390476 0.014650287798401052 0.17111494253585766 0.47148848169425783 -0.46604407904709749 -1.4928140191499122 0.86187276970198579 -0.34340741953100945 -0.94453922592476502 3.0358113719841371 0.7699948654195532 -3.5049429935156278;-0.84154984119369969 0.22906980089001416 0.61821148487549449 0.20104349903519866 -1.2266107742474035 -1.9348817111397791 -1.0744201813611116 -2.6080167322224126 -0.16228229062015842 -0.28372619809941801 -1.9079790266832948 1.298482638931014;-1.8094503523028689 1.1105954286952897 -0.68598194753513853 -2.4353397038074456 -0.82308107955239829 -0.56528889930305948 -1.1632975087405297 0.71803451064756707 1.1521313133095965 -0.49773548338844686 -1.7292092512027673 0.35827396071812712;2.2934014557321687 -1.3386320912819472 1.1029495285507365 0.51559004663364927 -2.5770530063914321 -0.56819241595295999 -1.3909595469327589 -1.6897934666260213 1.3466070717909762 2.0270631832617538 0.94014309240850613 -0.69779212803862534;0.067868706880210239 -0.28488664408330622 0.42416828103927989 -0.38735006490561202 -0.46127656652319049 1.3167068797683279 1.724273026475412 -0.65332152679462496 0.45104991267247369 -0.76097940071703341 -0.14916765581886715 1.0491941216577942;-0.0070021410754161004 0.27717581069483432 0.014847525552142145 0.64383133471846055 1.0932318364423019 -0.63379119084575108 -1.3240783931505815 0.83984835223226861 -0.42817454331325272 0.76529640102066931 -0.10874790866342518 -0.29640231788679045];

% Layer 3
b3 = 1.4599743981505033;
LW3_2 = [0.26431672329051298 -2.1788577163590501 -3.0151280078028635 0.52920518095091729 3.1022148766731159 -0.21042104957340793 0.068023584976365084 0.057639912142015005 -0.13456072508507003 -0.21093828259746214 -0.3673189823299764 -0.58024239517781651];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
