function [Y,Xf,Af] = SOXSantaFe18(X,~,~)
%SOXSANTAFE18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:52.
% 
% [Y] = SOXSantaFe18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;35.0877192982456;166.666666666667;95.2380952380952;62.5;117.647058823529;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.7560805443453549;0.23514272505247091;-2.6188737530691322;1.1699601561592134;0.66383351922764156;-0.22994795025605033;-2.6437297114381133;2.4566893809736348;-0.23868570870553013;-0.080580714957497759;-2.7504146020378446;-1.8832300643947144];
IW1_1 = [-0.25608355396831123 -0.032291955969629693 0.12680430686498842 0.023797354802492239 0.79393240119840969 -0.21343560420166993 0.80170091593942761 -0.92416822231741469 -0.218924001829885 0.11986121768094556 0.21591327765922758 -0.2732139131193787 -0.016929539085325289 0.56642650546736495 0.067988901533731369;-0.12450105843215524 0.10636393999918535 -0.010435277396318415 -0.018725650470568286 -0.18783507795220314 0.099265372440236255 -0.11507213767027775 0.02388164927435665 -0.03667044869537564 2.2250236726922448 -0.11095225250230642 -0.23640771351969991 0.014346057481712367 0.04020357986169585 -0.76743141170202123;-0.50298336037053593 0.32299074172244474 1.0012706946045149 -0.48549392317098422 -0.59546583277917586 0.55201701160112326 -0.59065008806699237 0.035508142073554454 -0.066129502375083582 0.49247666259308198 0.32651898754333897 -2.1213753646607993 -0.17002650156685467 0.072246677883080909 -0.69775240723924781;0.32081944494060183 -0.098869919416769161 0.65521546281121434 0.28858158800463157 0.22526383091877336 0.49802969938872688 0.37018610646774497 -0.02886671883528906 -0.11861825094814406 0.36010555170138864 0.71200466159172948 -0.39659814744641664 -0.71432405771849128 -0.42542698797814765 0.62480781947698627;-0.17796357647209829 -0.11329614513918439 0.38923668848861981 -0.61145119284224458 -0.76888487132994743 -0.52176592860608917 -0.73664439927964009 0.26911675406362945 -0.73959835298025123 -0.3068663080680461 -0.4781445320681148 -0.48632638335306239 -0.00242831595941432 -0.53984219291033708 -0.043958655805053079;0.17542173042076914 0.0035268808822276482 0.46154493811514929 1.100345539417138 -0.55331649773544045 0.42100481226725295 0.15233518833857551 0.0094396134574777323 -0.27114272428834346 -0.089815891067015124 -0.70111526247551537 -0.52043712720148716 -1.2274157533457712 -0.18152744453629849 -0.35729027005414171;-1.8705769683139906 0.405366284356662 -2.2843681648633938 0.70476975924181651 -0.50270523451868232 0.93316468710738532 0.87114275119953699 -0.1221228907427 0.3709673480306353 0.18302907011858663 -1.1919540193400848 4.108756309996707 -0.42731930538895146 -0.435753504755932 -2.5692491113122067;1.3172145663340635 0.21856947249994468 -0.77609288494346929 0.4061576306846611 1.6675621567426906 0.12031028804485601 -0.93038254241348595 2.038908919387044 -1.4639820725649011 -0.63617488377747189 0.37986843101984163 1.3912102040875873 -1.3571389390067714 -0.35437878313812371 1.3090572284046347;-4.8261114901989641 0.51891492438909692 0.49572211066351279 -1.5011894805935346 -0.0053285065805837584 0.8652841841279193 -1.0703764244027858 0.1104470625488721 -0.16860987815354495 -0.65139645330198348 -0.8582040338035839 -1.5400574002385479 3.0656382119890746 1.250906129232058 -0.55025517135785584;0.94936149640497192 -0.77909233499914576 -0.076204420662852199 0.069024720916544449 1.7418884925466545 0.2630690482094315 -1.1883179912539725 0.9164257154114096 -1.5444822206315345 -0.65518514022178076 1.2795393263632937 -2.4637529061532182 -1.1597631536979323 1.052887646003613 0.13571792748650033;0.70152142293054154 -2.6754100532699727 -0.32951340116690536 -1.1035576510042646 -0.91188175608738431 0.36459349098302352 -0.14585352963958692 0.072436328542526435 -0.044061142007614795 1.576740258558506 0.090023969728711989 -0.75057961411585716 0.52077690246663022 0.045249234234079144 1.0103084947147623;-0.25957912293770696 0.47610518831215665 0.41625401680032176 -0.19301535653138566 0.43552533271316579 -0.3302121108192187 -0.077732436328781004 0.23233167368597879 0.16094196479276107 0.41533082411961419 0.62005978526761896 0.27397970500819246 -0.18749397734743145 -0.4025086670210597 0.81799042938106825];

% Layer 2
b2 = [-1.6238507884309941;-1.1532044883005721;1.0242255556300861;1.2600026805157327;0.75190794511270087;-0.1854889761014748;-0.44595351395457361;-0.80859817544881663;-0.83482047017450711;0.59677625053408334;1.8202544540199095;1.804081188811409];
LW2_1 = [-0.0039766660534768725 -0.54619581226130309 0.19509104951061715 0.64891103077103418 -0.27571451355711546 -0.34558512440152173 -0.41445261045404519 0.027832766650723394 0.53081376233019073 0.59934905611530831 0.13904688083627476 0.31601794116046183;0.38646163354001656 0.7229321664934365 -3.2283006097659084 1.4962389903752666 0.62474401154739634 0.4410336849224944 -4.5857419370787742 3.8184563427476399 4.5604706626104869 -2.7394817038402204 -1.0454760593019083 -0.31289640383556133;-0.32064712481985547 -1.5413932409694051 -0.88274589049270891 -0.84535000001011862 -0.44444225822990174 -0.55425371726230654 -0.86568785218173161 -0.28569422443484954 0.91688374498328096 -0.44823735277190357 -0.32027143021904592 -0.38944216001222864;-0.55923673204002411 2.6535251357310963 -0.36914418315111475 -0.0033483164695846772 0.44503351892855036 0.059919547444895041 0.35912276111161751 -0.24990579547605682 -0.18846315499432337 0.039008023028599903 0.27034303384320491 -1.2895379381660617;-0.10860352657767947 0.35444703819223644 -0.05714706873921304 0.010863161552921857 0.88882173280378285 0.84787031741555208 0.92599510174577071 -0.81004857332392055 0.22319303452129091 0.4146092014311531 0.72273472946798567 0.040640334176246157;1.0399807320328172 1.2535432209143296 0.80943491149714231 0.56549251933343336 -0.348375145899255 0.18491903151056333 0.66050512821196539 -0.016369347204306044 -0.72478992583091961 0.91366415280854207 -0.70851558861552044 0.49469293305084122;0.17035526759285058 0.43601480781376756 -0.13794179768054438 0.271073397249115 -0.22929931801668751 -0.0013648024721898515 1.5205552660512576 -0.14033981096332976 -1.5330067006435497 -0.39873158973902434 -0.31290083577096722 -0.3435835616771194;-0.1760579252319027 0.48639618811713498 0.40622720292729586 0.66385144533656004 0.1447606029993444 -1.5506601376174165 -0.27035258074843982 -0.48993353283788554 0.5805262784770866 0.079965572323790313 0.85852542965251721 0.049781606875655429;-0.37768498944374002 -0.83351249228921387 -0.36668668209595001 -0.68354798759856084 0.42981870988731813 1.2495235154824837 -0.328376712275468 0.59815985059938692 0.6124440462146955 0.48173661639646159 -0.57286090257750555 0.031730159059689622;1.0198768995671796 0.58948889354305378 0.74696135254661467 -1.5415263526269287 -0.65368986689193154 -1.5040799487491912 1.3358530008799174 -0.10201954484502634 -0.41709132060166443 -1.8317615193554848 1.8918564259410486 0.97653281499688327;0.22827293970232163 -0.59306326183611913 0.35594989078389722 -1.3963940404625248 0.53445664275112315 -0.2624245232784107 0.48230295882801782 0.50408060309078906 -0.14209537252768398 0.1461501466524088 -1.6395668118767905 -0.26354495525351118;0.27182239354371013 0.41014184926003655 0.2964724237945876 -0.1880873620814254 -0.11050104988256 0.14746635029242869 -0.56361077250769331 0.74740008890115794 -0.6754741610494569 0.61882575873679901 0.43257056438151942 -0.59968803223622891];

% Layer 3
b3 = 0.13129582117497471;
LW3_2 = [0.59313974449061824 -3.6227936480571339 -0.98036995629616297 1.0049574725918111 -0.11608883046364923 -0.96397550176107161 -0.092157345921898309 -0.54893882641173208 1.607301617601419 1.8420192689658645 1.9203504773299946 -0.055897876518193057];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
