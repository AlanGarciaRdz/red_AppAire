function [Y,Xf,Af] = O3oblatos9(X,~,~)
%O3OBLATOS9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:45.
% 
% [Y] = O3oblatos9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.100381449508131;117.647058823529;0.0560224089635854;13.1578947368421];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [3.0485291969623458;1.277481735985599;1.6769083672819431;3.1703223069979463;-0.61996338893865466;0.79680951613158901;-1.415876420040352;1.2068232571959032;-2.0874618303493588;-3.5788858120065483;-6.2782892908838521;1.3701710479055964;3.8937541602539394;-0.34047850726365259];
  IW1_1 = [-1.1968313749127504 2.3809944904297944 1.0479427437080429 -0.68560680021042175 -0.89352244203586428 0.83084640274141253;-0.42121845617592812 -0.95489867775045423 0.73971698792839247 1.6463411697068737 0.73686560322493244 -0.68457347780929978;-0.086114134362902328 -0.21422531480825205 0.86247275800761336 -0.6793848183432839 0.40061825459079387 -0.58666200438631033;-0.35642101045942493 0.062806025947802574 -0.4396740453982157 1.9996303057661313 -0.88240678027957631 1.4881130978302173;2.2897253561180135 -0.90816137959602339 -1.6498216291831564 0.49571146152395446 0.61763508271354839 -0.31302462306105305;-0.74637402777443385 -3.3346239148196881 1.3510706446633844 -1.0207986349168132 0.79159230922593182 -0.02673127451741087;-2.4075252902550366 -0.98584127203231031 -1.297960402237595 0.10849092745326187 -0.36079925869790014 -0.059918270915997156;2.1199843694074012 2.1871210893740005 -2.112318649426824 0.42053160164795578 0.28361882505901975 0.051298048414116622;0.28367332163169223 -0.77588936732028357 1.1785676364943865 -1.1426066711358944 -3.4603831674695629 0.77942401722251964;-1.4231417477011368 -2.3627665138257004 4.0612899670599383 -5.7848583965333855 -1.2513899344977677 0.66767829880094054;-1.4094282699551859 -0.43098449174695797 0.15548328413201501 1.5741755610628252 -1.3516831157292959 -6.6720869662333468;1.5761683300007729 1.0357072652743797 -0.43327626948786613 -0.15205271072836105 -0.19092555565747443 0.22209156097648394;2.130760422190666 -1.9185499855639259 -0.67429445457373038 -1.5365767326820483 -1.6158809452035734 1.9343070186988101;-0.019331495016146859 -1.9789966457776749 0.73343904354291078 -0.77243268741088322 0.89047568225048546 -0.0037835367343084653];
  
  % Layer 2
  b2 = [0.087444079219461096;3.1052460571596971;2.7161486647741695;1.4531781978726113;-1.1409168524326996;1.3784634081829568;1.3356093242999734;-1.2176294219085921;-0.22730715792342704;0.47911643904255141;-2.2580346556282054;0.72264047051538638;-1.9256588530820054;0.25242640816130441];
  LW2_1 = [-0.42451263115417764 1.0400023520114008 -1.4557841855300391 0.1980793305531193 1.497789407478729 0.57243745916159139 0.52662949160980832 0.71787192060451654 1.1771891027225978 1.1975078710881253 0.16523919796621056 -1.6261824326641257 2.9828716489003946 -0.084396552105758818;-0.8194953188178622 -2.0031671006725857 2.6367349082431542 0.86974172932658511 -1.6239590658714504 0.080168694037101543 -0.75229251820600584 -1.5870819396702127 -0.57343807793759527 0.02133081643191051 0.028216290874409185 3.4610406762580732 -3.7459003275604603 0.66425468902604701;0.76173212356367603 1.3521698365465977 2.1992155201282908 -1.7466537083027398 -1.8788201027082585 -3.5986091880136195 2.3832597495169372 2.7076142485375287 1.257713676676411 -2.5497766942634015 -0.82636607524451944 -1.2391884601904364 1.5102394822485468 0.90590105542646593;0.43329770533179196 -0.7944771262742748 -2.018808379116348 -0.42155896387512609 1.1485220297978231 0.2077259187226404 -0.36333623611995741 0.20867543966093513 -1.2662139039562574 0.38205785051290542 0.08081758477153822 -1.1701562965763259 -0.38339220502520349 -0.80158093136169817;0.44282547490397822 0.32476775725568813 -1.4835154307225322 -0.11871892197624512 0.048599031305301167 0.77204175180382695 0.025143312059931287 2.2065322540930161 -2.0232525449957306 -0.20613315997281068 0.11120464095343671 -2.0045016021956874 -0.23336398297733063 -0.15574484456001811;-2.6103514721131087 1.63345175308854 1.6075070169315553 0.097061499998958883 1.5845154507224668 0.79757586438695738 0.51323397651068969 0.26578827759355733 -0.86762564251866414 0.048977339031080834 0.20599193115686767 1.2042537940404698 -0.58075081478317903 -0.37020145097404261;0.33161085502331639 0.13387420877216091 -0.054779326572610851 -0.11738190207849397 -3.0353407453317822 1.4850727275564024 1.0883793854733768 0.88585022991953399 4.9841240208549973 1.6287096792462659 -0.97556868187310419 2.8346687991965216 2.5360657137200522 -1.6817859035167686;-0.1192841715764098 0.18218248167237891 0.20612470929205445 0.065587526576238342 -0.88143653424589374 -1.6929194541060881 -0.073722774523173148 -0.14081452068472664 0.43800633262772953 0.41578127384636754 -0.21595654881751675 1.2022886083210129 0.77245463219518373 1.3722776406396531;-0.16399603545099217 -0.21099288634890256 0.054988001377010459 0.39395302672170301 -2.4909072500305407 -4.4918567789879233 -1.7923898204803346 4.5014630158854523 0.74047240923217972 1.849021696865939 -1.2934063015281183 -3.2713927237943903 -0.043684635394512748 3.842876858289447;-1.5471460051612043 -1.5816638450908047 -0.1080914051580972 0.90024210603247234 0.37359204295210047 -0.99036706811199438 1.0376883897513609 -1.3889192827353267 -0.9530625858124292 -0.7304579632792475 -1.2601055282115123 -0.76995382085070907 -1.7360650473045227 0.41724182250623038;-0.66871421883239135 -0.76843324341964403 -1.6442515736796828 0.30475573576763271 -1.0438168779694157 -0.64690792016562082 0.3356684960680853 2.0255539403752056 0.55225138502991156 0.52473388125635689 -0.76174476817672954 -1.2688874417243414 -0.62132736201919214 5.3038779442181774;0.41734596000242541 0.19221346827707589 -1.6428385110492196 0.08729572542862421 0.071977327417525508 -0.78766711314755766 0.27446291690855995 -1.0651390436019799 0.52907324416940038 -0.14593560933919236 -0.1220547469102812 2.5713605243631998 0.37333244566758655 1.4063980415353856;1.1978273296209547 -1.7150649742279027 0.56867509799826266 -0.60043455357235598 1.5995102872318336 0.24625537732389366 -0.69414875896719019 -0.23540021876048597 -1.254800013156866 -0.50300927620755687 -0.035630647974889046 1.3413633963684191 -0.10754049288434406 0.24117015408985831;-0.40471743408766292 -0.53270873754428461 0.57002473239865215 0.26121994046242175 0.10026953938217571 -0.79251013820097649 0.16670438356754486 -2.6313130642427729 1.7809345809104127 -0.052956783526195067 0.4542243624091874 3.4749688497649989 -0.22929050488071698 1.2170863163196739];
  
  % Layer 3
  b3 = 1.1403691303105976;
  LW3_2 = [-0.84435646816457555 -1.5883153251677655 -2.0838366477845671 -1.0458971775227242 -1.1671646802466549 -0.63249345313386229 0.20430999028539246 -2.6676205033790272 0.66869611959628927 -0.53092672013820985 1.0356997723387198 1.631169430685744 -0.36248540454417044 -1.2544508721006702];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 13.1578947368421;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
