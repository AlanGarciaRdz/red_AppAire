function [Y,Xf,Af] = SOXTlaquepaque48(X,~,~)
%SOXTLAQUEPAQUE48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:02.
% 
% [Y] = SOXTlaquepaque48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;3.03490136570561;14.7058823529412;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;35.0877192982456;117.647058823529;27.7777777777778;5.12820512820513];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.9819078959066463;1.8344345153210606;-3.5515097343264661;0.18098339162619223;1.1714479700022078;-1.6899564077271367;-0.96592338965302926;0.27483513846411312;0.22662568344959685;-0.24133277214172713;-0.87562243784232607;-0.43833556796226719;3.4007085904318606;1.7541785379780994;-1.7894711800852729];
IW1_1 = [-0.52294344287885364 0.18396177784346371 -0.53916834073643727 0.64745992777013972 0.095513544659816901 -0.22281526787959796 -0.65192438115744411 -0.35374219703755339 1.3476645844638997 -0.048898780330471278 -0.085284124602012401 -0.55787856289107662 -0.47521258971943947 -0.0051137097859705466 -0.27019895620554857;-1.1327084125188058 -0.3467148271638959 0.13042298053191104 -1.1366871316433889 2.3389842052643304 0.31745036273302918 0.24070232755038684 -0.14404705115571359 -0.54748249969144103 0.94242780727446351 0.65333605835106501 -0.86503363536266642 0.31851993669153872 0.38820657235399786 0.058286761705134027;-0.02804039776809996 0.16303129774208647 0.036362513906020966 0.35336247853992581 0.02812989680631188 -0.87784234161884267 0.71078856738630469 0.56091247679532752 0.50433173006219778 -0.35524278748758953 0.38203439982407128 -0.40182152187637643 0.29693675544108322 -0.058149716464755724 -3.6646173006453422;0.74340537522255112 1.6924400068151482 0.53395182739754221 -0.42931582269839691 -0.14836791958141266 0.24823975108834903 0.71076642214661501 0.1427125765217121 0.81739469699585821 0.22460750730330556 0.4506358411631789 -0.31823159651517691 -0.12661792628085353 0.98957289054606201 -0.33579985403639523;0.61306533038700728 0.024317767147965012 0.0029605442183681108 -0.44384879366357821 -0.36122713997483097 0.13095539735243 0.35837582687880443 1.2176504454282173 0.67481207265032817 0.31277799710529886 -0.2458669816697481 0.89501823858355145 -0.0019272241546719217 0.6611477352824261 -0.55769341051365262;0.048100954254432428 2.3007907518814723 -0.58642839816793713 0.61975223035524918 0.23373449334566104 0.23251419129908235 -0.5507134114254767 -0.51469912489847069 0.52921628580573987 -0.78268331250230128 1.1744410048209795 1.746539724491426 -0.64233741949917522 -0.5999568465118138 -0.38007925865375058;1.4960619124626939 -0.34763999269034507 0.94973245606805201 0.0056659325230358493 0.22229445804650691 0.33213873736986443 0.51774587943672767 1.406317690986244 -1.5414435051484245 -0.10705499052913585 0.24632948247631048 -0.49133594511062684 0.032390747931647007 -3.3175640526507766 0.40562972775719996;-0.3729162177423917 0.5447759193724887 -0.24548879423341038 -0.27742625037932417 -0.083887940305228476 -0.42338485830718242 0.68987625561330546 0.35552901241159723 -0.14594213519941721 0.27011029505470291 0.41461240821264278 -0.25120198597548371 -0.014757180498252673 -0.79708016286574823 0.30359791022136862;0.017224003807412652 2.3520306384905774 0.23829664374202419 -0.8579808994712177 0.14470311103444861 -0.08901742807456077 -0.34004073457205453 0.90821487193653427 2.2177247814514791 -0.57760173068345455 1.3012305732101477 2.1771483441722306 0.17142541173483183 -0.91407823587461923 0.70432467346030703;-1.0527539696329682 -0.1042864691602845 -0.0088375200122227625 -0.95696106397563419 0.60104422126257073 0.38763738230555156 -0.79027842995227848 -0.00037282174021402437 1.7489349460054393 0.25075027945645112 -0.44215194933614821 -1.6276699194826563 0.36835299688671413 2.0115349066812382 -0.86185014861417619;-1.3154495419080243 1.0721068165241379 -0.15347913814799607 -0.42501879137112764 -0.36940270952395698 0.87656023749344258 -1.0934710584812695 -0.0074241129832571251 -0.39382033030593067 -0.16351753545527764 0.26577305980642502 -0.97939847750836861 -0.77680363716892842 -1.9871622344348827 1.3775240272812435;-2.2659850144205533 -0.13855645164345995 0.28572924228323382 -1.3555500575399937 -0.57499655649096582 -1.4354397767030063 0.32600594805133926 1.4530309136951554 0.32515637835119748 0.14223787716834571 0.50366427072438735 -1.1632488804464671 1.0589528090792752 -1.2742401561060199 1.8033605298247226;-0.57380397071284939 0.17611726630333016 -0.15358278615158372 0.1295859443246275 0.090676853425010598 -0.019208112164920833 -0.24314421727846727 -0.44458841498080837 -0.27492517773640557 -0.18541591546696515 0.18617662331428331 2.7481069696386928 -0.099118050196702653 -0.2823052725779106 0.49974515793618135;-0.28544529245773753 0.31697898951921605 0.36691861851724861 0.097834643113851025 -0.71546150474648951 -0.11508535345973347 -0.63613559013150389 -0.34041608634355164 -0.32647827124838374 -0.92023919811913291 0.31009705290284395 -0.39249267582466901 -0.34214175431362415 -0.11393421559692002 -0.40894564470141931;-0.24018146139887531 0.5654111433499126 0.49417931750146932 0.31360745178448168 0.42652755750089322 -0.44156681481852972 -0.34999411984444462 0.56118410023619658 0.34494839777145098 0.40950494510478724 0.48316198147821904 0.43096717926405115 0.61859814952150294 -0.086536577478306814 0.77446638169672355];

% Layer 2
b2 = [1.653690413661395;1.4492124210976673;1.1802808342398636;0.97215698370834924;0.88182397116712252;0.4516836447299713;0.32558013030668448;0.20318014674070289;-0.11789999548796012;-0.18642079987688917;-0.77893332396865822;2.696293048068318;1.2354780974179458;-1.4295866105367128;-1.8783028652358016];
LW2_1 = [0.032011244160360962 -0.18478722208491763 0.13538071336443683 -0.5466913814978861 -0.1123519723550466 -0.37869576406398459 -0.050825163278053261 0.033529204859615747 0.70245655316327238 -0.16636681266394987 0.83633911185281329 0.46726599761107912 -1.669944355067561 -0.023674185686908857 0.088589723995518288;-0.55450599350077612 -0.32837794635440909 -0.028999414970258472 0.33897569488879226 -0.16253402040991471 0.38112120891760543 -0.018869920965531001 -0.12480810042838469 -0.3743335108365044 -0.41910626475798374 -0.19887887786471278 0.53448642246967337 -0.93399245400412612 0.54512427574565026 0.57719853801050169;-0.64456664539260311 -0.15607451994696842 -0.45187947748379398 1.2027379465323649 -0.69972734163303385 -0.94151091740236337 0.39262596314668236 -0.074232670430045833 -0.15285699914372738 -0.41930663220128583 0.89954606035356499 0.55029840807669006 0.41053071695104626 -0.30062594868713521 0.36624759608903001;-0.62537979938375665 0.12688831468260706 0.070581744188685319 -0.65186686935838345 0.76974000336638393 0.15475599015336799 -0.084062951346403583 0.28370146830958304 0.69833339070674005 -0.31443779098893532 0.12416405556596564 0.3001528621269145 0.47761823226299865 0.5333599409583164 0.54519603373898817;-0.20200728723070807 -0.041752594795198106 -0.58571018862916424 -0.30928819283821918 0.62042539276090924 -0.38662523096809109 0.56480611073301845 0.7404556801878619 -0.10302998274061533 -0.55502035824056928 0.56923661723842123 -0.18208422666324758 1.04181284889314 0.67413775463616465 0.33770489581214808;-0.51632467612491328 0.21111988798656631 0.18130560373499044 -0.26792869260839403 0.43695582228383872 1.1035021531052496 -0.31011085666086552 -0.39697606750363695 -0.75436110827162195 -0.24095486914622771 0.2059591886473196 0.052310979397416996 0.67730799214288684 0.38472808365356986 0.30914311000510886;-0.31948701195101553 0.030267573006068509 0.03634574098601967 0.24854139603258774 -0.02677482145078558 0.55018257383967573 -0.35873733938486307 -0.30159334362082268 -0.73887237314813903 -0.26659805319041535 -0.30923369915576515 -0.11041232276177901 0.54059608659236347 -0.46204773847652986 -0.54090152688905146;-0.73005947829293583 -0.041880280126456636 -0.34331133412624826 1.2816313249329128 -0.50906827776814945 -0.3409118929061955 0.58071429996292445 -0.27661920071328699 0.086350268266651764 -0.20537785725213287 0.95605463747008168 0.46581600742674834 0.58002664304185281 0.34093230030239258 -0.86819626874099276;-0.2422701569172625 -0.040323195461405441 0.2234731492080132 0.61841629519939845 -0.055547036841571119 0.095059248303124094 0.39577602539569223 -0.7175106131531126 0.58139126903164551 0.64122139997763816 -1.1029174744839396 0.52053690103519434 0.078161087633126597 -0.54393399835311018 -0.33913971773465068;-0.40635190134223231 -0.0086598782590831813 -0.27365325127440149 1.1932565249077636 -1.1086162092011751 -0.70904616128159659 -0.37757558581609968 0.72979335211795315 -0.49850531435967776 -0.079203069500796391 -0.93849664748975725 -0.73179688938833987 0.13522382575313027 0.52594995920686261 0.089269488377437992;-0.38279174072932837 0.55553165655299741 -0.16571892472714961 0.3007017012843064 0.41847843826939257 0.6946224234403866 0.082191682016796497 -0.48755068459473661 0.58943954688189804 0.26294479990912667 0.52858276987486519 -0.39969005302186511 -0.11871613926429901 -0.7909636055814887 0.63760563852082786;1.9962399270046531 -1.9796225919877612 -4.0271912293418595 0.55311448740332181 -1.1900041233297503 0.43734635031503988 3.6324171848508158 1.5711599971194607 2.6238243772193357 2.3190258456207671 -2.8201434421585154 3.3184342950373327 0.49926299709640165 2.2468538745032784 -1.5404683348772037;0.38787160027378814 -0.058530927969356591 -0.044575931795283005 -0.076712862406330157 -0.11511004332185251 -0.8159350022213534 -0.68108507945871544 -0.29219302566011129 0.78792781576960469 -0.62544839272198005 -0.47933035889603065 -0.035654654536159881 -0.25943292217216429 -0.19430186491728579 -0.50853211460244363;-0.45987437573472867 -0.39055911601415855 0.57926390258595017 0.36818136795298173 -0.29439055795393559 -0.690140717191566 0.64270258872172814 -0.23708923196119802 -0.16564190981176061 0.23811132555121442 -0.45104410551138635 0.14724041057433496 0.29440926366195752 -0.30412100362406919 0.65301938195737408;-0.62085585396204035 -0.30353962075644947 -0.40691398016411778 0.0032744943553321831 0.44794552673106469 0.22182625570157952 -0.46167183108589688 0.36855903640828452 0.031801976347234695 0.67425095950221481 -0.21713134276695206 0.11007536191968172 -0.33936559660721222 -0.61118849218002191 -0.20228897488092817];

% Layer 3
b3 = 0.17299690741539314;
LW3_2 = [0.46690901262749424 -0.41017419855212661 -0.28190758359065787 0.5169617034813242 1.2883834418997997 -1.0553599557270503 1.6680744370601828 0.33337830745935415 0.66666584920159655 -0.34666758247082013 -0.38161261666775953 -3.3386763444014194 -1.1483334770506026 -0.37749953375084111 -1.3137734265592174];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
