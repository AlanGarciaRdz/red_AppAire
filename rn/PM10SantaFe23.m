function [Y,Xf,Af] = PM10SantaFe23(X,~,~)
%PM10SANTAFE23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:36.
% 
% [Y] = PM10SantaFe23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;0.00341273633199099;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.2150166280852117;-2.0524985814380812;2.0875172149025167;-1.4298016423112245;-1.7809482162031411;-0.11462571547993916;1.7118386439000759;0.78363320933677272;-1.9094969959468009;0.8229464910807196;0.26149643853415805;-2.1640924651555173;1.6730902358943998;-1.8956306185223744;-2.1818759900545777];
IW1_1 = [0.87538884833453745 1.5077757849177658 1.5617549904245913 -1.2276972560081449 -0.37462143824368793 -0.35794433086384519;1.2979399450219069 0.74396317598277184 0.60884208819946017 1.1816159554417365 1.0362375533750754 -0.69503269999295281;-1.2621889936635085 -1.0767426694990396 0.40709376841683909 1.0119720983067406 -0.68559294575649554 -0.72501713805723356;1.4567632299953108 1.0065584884281165 1.2093510596712218 0.48664277288598856 1.5660204334061856 -0.037392317403331689;-0.48996067734418258 -0.79158180491798558 0.10149556916504629 0.61704488710062255 -1.4764743244181595 -0.039161672118212656;3.986110284584274 -0.49391088124097232 -0.11170567042900147 0.033313715334818202 -1.6034588791470312 0.049109954874405115;-2.5455084124754426 0.29690351002347076 0.20468870600375166 -0.48200636607798136 -0.21389724299567933 0.39431567608417573;-0.98897111879085875 1.1239973414532216 -0.42887825515755412 0.58912124247192688 -0.44301377219624588 -0.62128809232001536;0.23969763510749775 0.69237186914061166 1.7461926359832065 -0.67518348117776239 -2.402836623255058 -0.99385534497165484;1.7579494460596476 1.6599001539741269 -0.15107245485353957 -0.30891909934776052 0.051672567279469651 0.24511036953119514;0.12694432970552097 3.2901582269937495 0.75811208133765529 -0.053162881576782894 0.30129803157643881 -0.14832229592625748;-1.9909593739247984 -0.30631451300533491 -0.89317991440359168 0.89140976073769729 -0.68525133764898993 -0.46065725880432551;0.34997752291794249 -0.25337513288490282 1.1543403648338222 1.4207945978633794 -2.043060297236615 -0.60333936826405854;-1.4714212066049071 0.25248537555127287 0.5622313263590889 0.046661078426910189 0.96347058308149869 0.39688363048003672;-1.4902091321327557 1.8913021350611419 0.5468920875529637 -0.33814745266509616 0.31750591593096933 0.61149910303626476];

% Layer 2
b2 = [-1.6794262446066188;1.64359024364312;1.3127136543019158;0.90167011355941407;-0.64881945595557144;0.28815451281274845;-0.12099306572900356;-0.062976848035011468;0.15429841973213826;0.72667058490561931;-0.83713220250149345;1.0515732157670699;-1.2884351266943483;1.4131257392774861;-1.2659054900708522];
LW2_1 = [0.35927868558585729 0.22046711509165032 0.23389665070846333 0.5490950202691014 0.14735581466237926 -0.31378725264283724 0.73425825205141715 -0.21661881294526758 -0.12760656465108974 -0.78606747295708235 0.10500685126058731 0.05393875528480619 -0.47387669139925748 -0.63364929036447071 -0.5684694453674356;0.051616664352932537 0.063669504042725644 0.43848105465882209 0.27285164996044908 -0.48975275836128401 0.45894657144034268 -0.93116952294005728 -0.32848108161977546 0.36952197402240966 -0.23379207772959376 -0.56015568027698548 -0.33475725891881986 -0.52432716610216568 -0.88717060355273969 -0.20860571856557758;-0.16131690568832513 0.43092833468256958 -0.091862515684120988 -0.56842320274310787 -0.29765958702884365 0.4843399919733769 -0.14280698772599271 1.1660360588220335 -0.15802774705877001 0.41579250230525983 1.4641117695023411 0.90438934946929173 0.27137215614708277 -0.054649099332670426 0.47367951948186099;0.55179383525310066 -0.22581766066075143 1.1157186701168036 -0.2717828014137173 0.028676877624216904 -0.085419028231674451 1.9789233578696472 0.04913219683208301 -0.3199477127757962 0.51076169936972671 0.14504290251234145 -1.2710758828303135 -0.61474439591393515 0.37068868867292853 0.58216600299845078;0.27010484735810014 -0.68662976398636366 0.22653127723158223 0.010587299498612777 0.78088370871970714 -0.17648021978230335 -0.507335786018002 -0.33981432165039932 -0.68995663997840062 0.099244557346410897 -0.26723687131103124 0.54853649584952113 -0.82070175316957339 -0.055422255644027425 -0.43857079223737544;-0.46821863549445686 -0.009573878307433871 0.30777776418269981 -0.29661611904715246 0.5367685871654535 1.1019352625667878 1.1425239071329418 -0.35341766056344892 0.98507689276931931 0.91240514240837145 -0.10269043059733803 0.59098082284624254 0.58710664499630594 0.62327622503899049 0.98214668002413918;-0.80081981499560562 0.83338472242136641 -0.38570072242943765 0.56338209425265651 -0.10002454587294643 -1.9474783794255635 0.53134202780054274 0.4244021561003225 1.4384565022220106 -0.49093456052539303 -0.32317106737754647 0.54002363870449255 0.089222751424887337 0.58586752064266845 0.83212419382916447;-0.58401338497233679 -0.46027771341671497 0.3450912455132874 0.69508175111050552 -0.27781684104709686 -0.91149927467073577 -0.34663038277675717 -0.39860783765036956 -0.23934607317167578 -0.59423051558063311 0.24837647154703904 0.13829974206097162 0.4827414400096392 0.49200266890863181 -0.21914531198849488;0.37892182946826503 -0.36845264552918289 -1.1311819470879072 -0.076303730281946938 -0.18821913725557773 0.43432278965727777 -0.42084336759265445 1.1427793263069432 0.09608741302604909 0.18246563610011796 0.016208345318459688 0.1198030463942981 0.31847344614351153 -0.8998987561458851 0.47724254963229223;0.016932502828161996 -0.56129802754328184 0.60401501164345228 0.86137688717121563 -0.56037074541529797 0.56845017005053089 0.012096511247134036 0.20425116578948463 0.63506935683426335 -0.83947402137537164 -0.39004748026827213 -0.15125167717624716 0.1066195824807419 0.28123767850618386 -0.32772596677714649;-0.42190282791138878 -0.020400882999607566 -0.071408240288414665 0.48413359539329665 0.13392091919168103 -0.63007764807652178 -0.019798375605566167 0.5043865645864325 -0.8065822509657381 0.0043120413386283189 -0.35632386611960193 -0.25288042846753112 -0.12236014680840122 0.72573380808405075 0.18006090132814687;-0.16690833009751191 -0.48925756843455115 -0.86810066744423087 0.60174208851789845 -0.70235040723040454 -0.70675897535208432 1.021055936909105 0.40909635080233181 -0.72974056724211123 0.99079307822304885 0.25843195466648328 -0.24650775566579614 0.17725498935796655 0.4610166076662332 -0.69415457823627524;-0.1851424753235891 0.36274811616642116 0.47711395085052766 -0.16985768892893549 -0.16148333552674293 -1.9957170184650144 0.19660787182395936 0.13334323806593132 1.4784324134486022 0.36004528966734817 -0.98264401430811743 0.77546483060363836 -0.24048239847989805 -0.18864810699495529 1.0850026452404391;0.86400115148688561 -0.45400839372782092 0.28907026436758509 -0.33591065813438103 0.68042732961297669 0.44407143638770458 0.70529514788439795 0.13787929482030251 0.42165066013195363 0.17452958836260696 0.059045858653756084 0.43263568390890278 -0.29829496818442142 -0.54426058102984876 0.045101991444692936;-0.65534290577686516 -1.0406544981816535 -0.82100934195783148 -0.2260914180280145 -0.32275062737243188 -0.60717326534319549 -0.051406866078105587 -1.1906598155330768 1.1407375015174195 0.10794135038574808 -0.42391182822038403 0.76929738598558983 1.1014575577887384 0.017595110143876797 0.19617686954107352];

% Layer 3
b3 = 0.72776209397966396;
LW3_2 = [0.50007112026129663 -1.2474208312911697 0.47622072357019896 1.1538110189498862 -0.35946488697779722 -0.43633519812954646 -1.3080418719129561 -0.66801020396087119 -0.63837020427878688 0.43495562931235865 -0.20042316971897239 -1.1650055246567372 0.97922561270698649 -0.90903989308793642 0.37221481755110364];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
