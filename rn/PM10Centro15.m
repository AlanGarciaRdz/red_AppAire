function [Y,Xf,Af] = PM10Centro15(X,~,~)
%PM10CENTRO15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:05.
% 
% [Y] = PM10Centro15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.281968137600451;3.74531835205992;0.00773694390715667;45.4545454545455;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [4.9208739228159022;-0.69654903509545452;2.9415338854944015;1.5221545959046836;-2.2464189359910831;-2.9898347332728781;-1.5300638117512737;-6.5741728873966068;0.73918843512593513;-1.5860768337831594;-0.67374449095872413;3.4950663936049868];
IW1_1 = [-0.84068250286218205 0.32466066466675453 2.2887228983768915 -0.07620200290665366 0.27157483945793254 1.5926796295250649 -0.22648573364299743;-0.07849497844198218 -1.6152795739474064 1.242097753441195 -2.0536664857833458 1.0406161337892703 -0.32419609751414802 -1.2173225140362167;-1.7040084897036751 -1.3704454316895218 0.070851145713920885 -0.2555253842731669 -0.50072567415484248 0.65956519151202408 1.7599441954079285;0.99576773189277479 -0.27869920688846384 -1.1093463301170066 0.30526138225241528 1.1208695218517624 1.7751241363051438 -0.10640659504669538;5.5330216215326491 -0.037515877673704116 0.3661405465629004 -0.75795690144654904 -0.97585102113879785 -1.4519718320998749 -1.464772359591177;5.8727464985217042 1.9797649607249115 1.6129135498131082 -0.39655443911792315 -0.38930071382848741 1.3446299087420561 1.4948698465286134;-0.28601703329487954 -5.962754713893343 -0.16043729929197056 0.45837007038593885 -0.48616616521155764 0.75211513278519437 1.3843156242203174;-0.21498706633681008 0.23016384355452651 -0.044817658641044276 0.29572946703624303 -6.071173650782657 -0.59856336572838242 0.054772143296754026;0.98030479257128444 -0.62293291820203256 0.30115800610168125 0.47398777905514061 -0.91845569607389244 -1.7693195108514836 0.56742966701179742;-2.1951557790593914 -0.047330774071457055 0.045965718940179617 2.7763007540704003 -1.3771663016454838 -2.2946013941550096 1.3952420030084354;0.48141460394531804 3.7642209595708915 -0.1845244355654829 0.22948370083422917 0.13526910422716923 0.86880533809791005 -0.096712470000755502;2.7220939045012522 0.075310832001208791 4.1268060817315311 -1.3909268770163268 -1.0962255802147982 -3.1537366231458996 2.4608449947405862];

% Layer 2
b2 = [-2.1222300370084954;-0.94776663426236984;2.595924538049196;2.3423964656345957;1.4278756284110599;1.4377620695669713;-1.8099273378643512;-0.29880806275424648;0.094849942689200051;1.9815769383899156;-0.30353312019159578;4.0920016227950073];
LW2_1 = [1.8421097276115674 -0.38686982570415407 2.1722479365500864 2.7821907237330241 0.21782087758799687 1.1091384543719589 0.087616364493152743 0.23979664795503108 2.8836472268928905 0.24414913202671823 2.0622176987252407 0.44113083103846945;-1.9940831092927704 -0.62238361532964503 -2.8071397084073686 0.55447263177139872 -2.3709168800628411 -1.044597016399659 -0.070555184986110686 -3.9906899210919007 -3.1669783050658702 -1.1410142618801529 -1.0210149853687467 0.69079284565870447;-0.19734774695405954 0.66533390498750045 0.24640222985317989 0.68616049080502117 4.1160335323251207 -2.5701666991047132 -0.18160284214182837 0.25648835589519142 -0.50342798912549058 0.66954259061089272 0.62372730089869222 0.65889150678959529;-1.3064490695544195 1.2793529346351418 -1.3831144180756341 -0.55842724566516477 -0.57046895573441458 -1.1122750414113471 2.689927100311333 -0.32655698584760323 0.50652280999291555 0.88732723191663376 -1.6532874380280649 0.031670511849223065;-0.76847444803707765 -0.039051676995935647 1.398688323240119 0.72532115205376324 5.1054626575061794 -2.8842730819497207 -0.019098955939990933 -0.24075907754574205 -0.0018631683023795126 -0.35321538792957019 0.23430681588663799 0.07670260023870612;-1.3716726897460443 -0.20930515537112235 -0.47421159388342193 0.43302865095590193 -0.72850614493547827 0.76993560719343357 0.25367937490107229 1.0680005005679019 0.84957251791009336 -0.60712423580148933 -0.5649314315138434 -0.71679592345830845;2.2502499506655971 -0.7879941484765921 -0.11973735779347421 -0.19872943237091106 0.5060422255010455 -0.52337709192909487 0.14306715978686024 0.23279545992549439 -0.062195860527028461 -0.65554273872924285 -0.7042981649724096 -0.26742573300771788;0.83440625009589864 -5.5987313961376275 1.7736024767172489 -1.9848127099034361 0.55858750353714626 -5.0810750749182558 0.22497775318771365 0.61960183194917318 -0.53677581462314894 -0.96418522975155574 0.59658748068344147 0.68609948150814171;0.83536519435771528 -4.9156185240034649 1.5600639396353564 -1.7836317445673164 0.59091261365764958 -4.6946067955982693 0.25334024740423483 0.92459940459024192 -0.45132177326264827 -0.76529738139783443 0.76331617236409899 0.5433238426125383;-0.33069204341383523 -0.047040294113314764 -0.76906192537202989 0.76840644940151803 -0.46556188307939211 0.24717164352247945 0.2566151460696342 3.082043101738615 -0.088025853963682121 -0.35661108373838346 -1.0582860495422344 -0.52424013273975867;1.0344656309984761 -1.0982720376828856 -0.42467579386540144 -0.74728795595757558 -0.53307764123636892 -0.086546373505628674 0.12910082881178039 -0.43959267059108903 0.75026206453308308 -0.97032069158152945 -0.58657979330407584 -0.64804153885470761;-0.055970700715400556 0.51134345190547625 0.17255849576523863 -2.0798934586427023 -0.77806752274101465 0.26216099410738453 0.010791435371093958 -1.2622335026602707 0.88101693233403899 1.4573890700940884 0.60020237902257878 -0.36517718499265023];

% Layer 3
b3 = 0.6128170396559528;
LW3_2 = [0.14852992109862648 -0.127461770685218 -0.85793658379667948 0.10528609182337681 0.61731686878823511 -0.65024061444903647 -0.72081062458180256 1.4690493890576823 -1.4823502791767862 0.33546163937129797 0.55054624805211849 -1.5836509792508549];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
