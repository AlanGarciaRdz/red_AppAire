function [Y,Xf,Af] = O3laspintas48(X,~,~)
%O3LASPINTAS48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:48.
% 
% [Y] = O3laspintas48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.241545893719807;4.5045045045045;0.00280033604032484;95.2380952380952;0.212765957446809;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.9743318540982457;-2.4551965652951768;-2.7253622425760846;0.91406848987914413;-0.72357902828328391;2.1084025527698591;-0.89117552186289473;0.65973446019702586;0.48420928343711311;0.44803136349993544;1.6985315507251029;-2.2041456758323545;0.78238083747003928;-0.071941486160987833];
  IW1_1 = [2.1337454346203906 -3.1485923524503097 -0.26684483310515766 -0.89056310460543331 0.86273587807585417 0.34495829185884058 0.45017196419634742 0.31843506201544319;1.0929292363969021 0.49503919467957669 0.22993915687241204 -0.64536348713045244 -0.33273434675403579 0.024331402831932275 -0.36126164463692828 -1.0794090746958398;0.89995617323627863 0.52705584921113069 -2.7631226732308378 -0.50354761758600997 -0.68645708559316043 1.3647150904080121 0.19601396039518457 1.5352333242144243;-0.47778065420348709 -1.2143620540662248 1.711642229267428 -2.815055295448273 0.31720982946174386 2.6282223743218722 -0.76101850711836228 -2.944309400618534;-0.41879118159419021 0.19517871783123122 -0.38635828486623397 1.6753117170318546 -1.8841407930503122 -0.41067321617591962 -0.90786970811261514 -1.570372527991682;-2.8188956623322468 0.029095136294585034 -0.54236371274448025 0.86510737195640397 -0.2724007303662872 0.11230111334099699 0.093802978256349534 0.28877949239128659;-0.021684579421352847 -2.284078311171271 0.42345407251982986 0.4147944862871612 -0.93156205948698345 -0.078226292842978593 0.33478712320850607 -0.6193632534832304;0.93419243602777802 -2.1836100183714375 0.73460536873548388 -0.63758922924954453 -0.19971322362318894 -0.73257750858343873 0.1061754298493356 0.028853605602023782;-3.9149825724079821 0.13330520151408851 -0.27440707987119145 -1.3332228806454856 -0.06870682440875342 0.51852989381886039 -0.31022573439332002 -1.8879205512827244;-0.20792711960717192 4.1823440811572272 -1.9049865486582589 0.28406873923892151 0.028880632914839346 -1.3075222748688125 0.95957293801191113 -0.25170189004909721;0.40032765915469337 -0.46042347967822606 -1.3754431109337351 -0.64297294611395839 -0.0068628388917706196 -0.6212642674325739 -1.0371240985409691 -1.0769038994325697;-0.22104386390723532 2.3218831079485662 -0.67751649538784542 -0.86784605590106256 -0.17550477647115931 -0.1346394655045188 -0.56950103700357746 -0.91873345987530353;1.6666873951639507 1.9661789142639272 -0.67744286280063348 -0.26141140347958108 0.3481373045447077 -0.16991637219463052 -0.14332434856230494 0.35359066524449229;-3.0355581940539169 -0.29459852790910557 0.019058217729339383 -0.14225978268870404 0.067565286224651896 -0.001303658584626455 0.0092440365945063857 -0.27498370223821827];
  
  % Layer 2
  b2 = [1.9908850694291369;-2.2948788446767283;-2.8044016598445469;-1.5859145708332911;1.0955358478020047;-1.8723711683318041;-0.60364754544446597;0.45423185322565335;0.61259003788279898;0.54849093579825192;-1.1986690067589534;1.6890087400368987;-2.2217708738024893;-2.1902632919044454];
  LW2_1 = [-0.026972002438898638 -0.34248866697361824 0.37836390699672862 -0.15921875175231526 0.059081293712486146 -1.0989077098613376 0.87797917233905398 -1.7154577291533701 0.0010080291521255037 -0.16319772517143671 0.59398243267874296 1.0284467546297937 -0.072507680263083338 0.49875903418269252;-2.0622111186174705 -1.4395120771772218 -1.5941244344875063 -1.4471224817649433 -2.2121313228719641 0.10318940667702721 -1.0392692336881304 -0.7060863910366012 0.95917217018031542 -0.16032721093385952 -1.6159691920819179 -0.25126626469058388 -1.3080197386743309 -0.41526097922085914;0.13914384788893205 0.0012513883616099217 0.73676850649594416 0.41018366573842607 0.93887259055079297 -1.190701504131775 -1.02045394917772 0.92571276869548036 -0.97591495449988364 0.54655650285169888 -1.805890719046706 -0.44431678665601698 -0.6382360177191706 4.7541204326801978;2.6312147132521142 -2.4925165895092292 0.48377974996796108 -0.25717839377569013 0.38380332018410074 1.7617396429849845 -0.50572840644379558 -0.26393485174033487 -0.31548305882870636 1.1326530591214923 -0.76047212515893636 -0.64667346966895189 -0.21464882684004855 0.52922069887432643;-0.35504928323853918 1.6470617703300432 0.31520921713762123 0.18292692473505689 -0.46060237846367258 1.1400556918365656 -0.27742699696428696 0.14508324740400527 -0.18216736027624908 0.36326797573683345 -0.1284536758611784 1.1035918728381133 -0.30799548858372217 -0.98791349558621955;1.3325251364875732 2.2876569581942765 -0.64559112051937706 -0.53888663462286945 -1.0625588385448503 1.094500106204888 6.0063364178981136 -2.6703021571629497 0.65434145760352613 4.9673323370106361 -1.7062630236013652 3.6965216408045585 -0.35898336280580084 -0.97736489872719357;0.90500071371829649 0.18972250019513826 1.4186973263123839 2.5299730673266594 -0.92963389938079433 1.4294799111835703 -0.84236618118111228 -0.062147877332528648 -0.95807344374636594 -0.47008215601885517 -0.99450214468576126 0.72319006443777223 -0.19688349817085937 -0.64317895400470393;-0.35009164760774936 0.16852419574069352 -1.0451872222885943 -0.094535602622400863 -0.052644654391631282 0.59065622650664851 0.78844695209874183 -0.72534089270180568 -0.29171306077239817 -0.36759318094628118 0.55440213070457289 0.8890216947959958 0.19202462976826465 -1.115420663352731;-2.1861608445569427 2.1310490695003477 -1.5705372670325639 0.38179079775000774 -0.12344649445357822 -0.92939270962765641 -0.18839357292052555 0.13044454128460775 -0.23805810935290658 -0.66282581737405866 1.4503973762890146 1.1077626887611041 -0.49752078524229915 -1.1061334543540609;-0.59555157571359918 1.6151192947158433 0.35942847895430641 0.35223471119986011 -0.28630949336571992 -0.052458848920135331 0.31654730880640064 -1.1156980295772336 -0.19681248883221295 0.36278381907684037 0.60248905301375677 0.51740313821659334 0.52970043710771297 0.66791437485829974;0.77045583585721522 -1.5344307955804104 2.2623388753575657 2.4404825630976772 -0.61330404067429534 0.30448790617671823 -0.50077278386970026 0.77892798679758424 -0.25202432556136212 -0.12552328717247774 -0.97076794152527734 1.4864547372376808 -0.37178196087750937 -0.46047376416133501;0.15022425599925651 2.1154930240191741 -0.69858093254427689 -0.17631146156134697 -0.071911420555750324 0.71020066919482328 0.72763228400489854 -0.11545283500643672 -0.51082747920140958 -0.92672684263935945 0.73598507543667557 0.079627250668312471 0.33946336243669661 0.4958042337384429;-1.6309591548497966 1.7960868406149675 -0.3951392505273289 -0.7959754945799602 -1.2238401282302604 0.68507097690577212 -1.7052536877459443 -2.6078355378384104 0.83089069271004767 0.98311569060425585 -1.4575464943728003 -2.3776014866285293 -0.75882670105890038 -0.73945062457434774;1.3115337635667028 0.59590089775865995 2.381753154397146 0.83241269147867691 0.46096543091662978 0.87910377210319146 -1.3547207770624694 1.4165834291942012 -0.13388126674097472 0.95043668409189541 0.032469880723290989 -0.94293264753525619 0.88899137272057793 0.55520734859162069];
  
  % Layer 3
  b3 = 0.19334895575907088;
  LW3_2 = [-0.77361505553858978 0.67076301621142931 1.9268389027769868 -1.1759641709017115 -1.1293462294025758 1.023288548573531 0.66272972907804473 1.6799124493085311 -1.4309200394649886 1.1888034189492498 -1.0490485962939358 -1.0612330758454278 -2.8492233528808222 0.55439700594296371];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
