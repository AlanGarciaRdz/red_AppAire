function [Y,Xf,Af] = O3lomadorada7(X,~,~)
%O3LOMADORADA7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:40.
% 
% [Y] = O3lomadorada7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;17.6991150442478];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-0.058893897971257644;-1.7159569061279927;-1.6900907290247575;0.59878562272504543;-0.53865178813137937;-0.94855094137935403;0.067467134603020715;-0.1405594137351554;-1.8819037289095031;-0.82674430891106609;0.12413681233434221;2.1453242766302529;2.3749645429930011;-3.3368398201054617];
  IW1_1 = [2.6493321786826054 -0.10987287920535782 -0.32541910324569745 0.039242530356652552 -0.074594830697408271 0.1250164788127428 -0.21446672591307064;-0.21019279794946674 0.13020934427618996 -1.786619514261347 0.4973106710696813 0.41911737415446304 -0.34770402747800605 -0.27783652754666255;1.896872062198989 0.080665539565731859 1.67835712406822 -1.2060971730493153 0.38252403295338044 0.31549045860431846 -2.0596152439465665;0.1114684214948212 -3.7990688929725112 1.8834446024699667 0.83192759784358572 0.49959446421364728 -0.057517353333391891 1.8460133292298597;1.177892215736174 -0.11835055791229085 0.3171148979235564 0.60523542316624324 0.057408531549818523 0.3196884347002325 -1.2411530459123936;2.8006248317459348 -3.5807265756836388 -0.60867700286449733 0.58154629097250166 1.019617091959627 0.45108648103551818 0.24041753631922497;-0.10750609279679899 -0.079231553468481833 0.73902897841353921 0.50168953324866805 1.3100216438960992 2.1048012615241287 1.3566207261185907;1.4678296069847989 1.5234536688676641 0.67129005163020306 -0.0064888183212468802 0.21993228461743614 -0.29818947267781726 1.0037383771640551;-1.6430813221963687 0.45158135819819029 -0.71585682282795726 -0.050121947876176055 0.24403718268490271 -0.50858732991041888 0.75347274833639444;-2.0484404719674862 0.14684871433923885 0.34808810361675319 -0.2675549563201135 0.30529825086437834 0.041375557665216625 0.050271065388920115;0.43415657285064302 -0.42909480252217491 -0.20393359270286016 0.85800368166788532 -0.40458617540857045 0.37469639986760339 -0.96996418905627613;1.3930825501547823 -0.17831067244668888 0.23306577255321509 0.43317688126860282 0.71861734457187276 0.45917096968271148 0.072338575176788558;0.4372094837714694 -2.361568553882937 -0.51008501638648207 -0.40845434831807653 0.66591939787672849 0.64670988237454785 -0.47084142334363988;-0.8469682754365524 0.80364226764793867 -0.12993153486259135 -1.4869647751346955 0.75639876331775291 -1.026232432204744 -1.1005108682842712];
  
  % Layer 2
  b2 = [2.0251604524300415;-1.8945664118356313;-0.43652582875194745;-0.66248187886557031;-0.13000876893937116;0.40520430608318553;-0.68679125201713798;0.64850161105264126;0.29053887826032243;-1.1690464720972451;-0.8207073749821665;0.75935279073962136;1.366174462004873;-1.6175561226677955];
  LW2_1 = [-1.2025345398997858 0.92367130409010101 -0.83678599079260307 0.15849469715306785 0.81230278741456075 0.90052760871466186 -0.055829562899445705 0.092621050474023359 -1.5013219947245002 0.38282240309779003 1.2833431493830385 -1.1494823588442569 0.022514438841190684 -0.7199190759539571;-0.7330785489188989 -0.93015219974682384 -0.95192769230179319 -0.32093842895013652 -0.28448781433093012 -0.65874298972337464 -0.033512320450762537 -0.074985957701050737 1.4889623717726934 -1.0885942499822638 1.0798311755451464 -0.62606960521035626 -0.27011143721643327 0.72523008551790036;-1.4410739290146084 0.15939388440508917 0.90523205302902066 -0.30469796957617745 2.1996078069659606 -0.39606488483486052 -1.0036000903595768 -0.5295699142516912 0.40262224535598712 0.058534256709866991 0.098728760187644676 -1.0700729381907581 -0.47375930352281442 0.51309233691936718;1.6511223065726908 -0.7599166190775023 0.044452391529460497 0.14357338636702777 -0.8675569628554769 -0.0094602280781466361 -0.3610637218067918 -0.11632402523969035 0.35917428185609063 -0.36313761898781199 -0.04109504498252077 0.21839319147595407 -1.5475724646423346 0.35677819504169195;-0.42858766844959301 -0.20845018750427463 0.91004384985891051 -0.75644077148100164 -1.8096498204987321 -0.090578383930297338 -0.7709624177198684 0.53977036622927088 -0.056920828918449351 1.5205894670145579 0.66249240871930204 1.4793989691332379 -0.19853986860497363 0.63771771853447723;0.27504757337002178 0.87459986028971959 0.55344228057475708 0.72606986241076554 -0.51877592638254333 -0.045412627180545437 -1.27771737795194 -0.14038843900262224 -0.64980549746522309 1.8358938178117046 0.25831306851072061 -1.3628786614388531 0.2637490482251838 -1.0929220956275374;0.52947607414318831 -0.27641053428137968 0.31104717988610364 -0.29119423146736523 0.70615414719584257 -0.28790504612817913 -0.059366055764012542 1.2918002363433174 0.8094174826912186 0.67954209630037155 0.12395879556661515 -1.0984141639222904 -0.6885477123168432 0.32356581542157981;1.7300233462396337 -0.054415870312233688 -1.5798988623793442 0.30732633208923882 2.4642836091449571 0.13395124832358576 -1.4851626243585065 0.16814483601888841 -1.096665068966086 2.3092371855572322 -0.16901934948986452 -1.2490351243472957 0.2991117588385408 1.0554487655633802;-2.0914051561614118 -0.29787993970626153 0.14472300524510018 -0.61189465731064896 0.26350198532033908 0.10138518126500147 0.0035512251518543744 -0.75430415974913823 0.23391259588239188 0.28135570313426594 -0.72496300985806195 1.3111414762125218 -0.3369654053592549 -1.0126681525289758;-1.1977693379763583 -0.3673592491034956 1.0258650487469976 0.2099959204331836 1.260552969076439 -0.74394999159939768 0.74517819262461205 -0.98340187184431216 -0.66061789613439392 -0.37797156479726335 -1.0777596312108624 -0.0076473849662304985 -0.81778191778567222 -0.3570766391776985;-1.4407079511153271 -0.2321300690005873 0.21014576284114572 -0.021421506200864089 -0.93564429933642945 0.84107398627434549 0.073918979050553918 -1.2014848228467478 0.80249066991357343 0.76292547067166927 1.2547727850148382 0.59182500270297744 -0.21478078252265076 1.0298281409147811;0.43725715679007932 0.4117637732650033 0.23760624814094705 0.85060898346540714 1.3372423170166188 0.48471783602884244 0.44931993514377466 0.84828418256711569 0.3451106365755679 -0.070114901506295554 -0.30711896095008095 -0.28114040101750271 0.066952809154510684 -0.20748463095059327;1.6626223386241297 -0.489317810616066 -0.89610468156530543 -0.43990417648114366 0.58961637505478681 -0.24681956757377438 -0.21334645962055446 -0.998243306507831 0.069119606776815973 2.0013899627838123 -0.27388117796629097 0.86973826484158823 -0.37306695684580171 0.46709279355987016;-1.6194646570140632 -0.59843070041490676 0.78186384101799433 0.0012093310624917836 -0.8062195137201732 2.1754750132889025 0.87537653144674377 -0.46822290420359469 -0.20455729094419911 0.37031543594402294 1.3217536045288407 -0.19838766275571387 -0.47927136630599015 -0.16279101050373479];
  
  % Layer 3
  b3 = 1.2988784887370735;
  LW3_2 = [0.5509276843096429 1.3434570609666503 -1.4720270250250012 -0.88153033112793378 -1.6113751416213782 -2.0049736079411575 0.88989845342345086 -1.5619344541785138 -1.1606968539316829 1.989056968457521 2.1805667080627811 0.31251373152073947 2.8518580781305949 -0.70045631512877093];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 17.6991150442478;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
