function [Y,Xf,Af] = PM10LomaDorada20(X,~,~)
%PM10LOMADORADA20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:13.
% 
% [Y] = PM10LomaDorada20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.0956460487740411;5.8447159763302219;-2.0255084834763037;-0.35929436108666091;1.6078121445852274;0.5291276488970994;0.21240014527078929;-0.56656502639915107;-1.6705129519430963;-1.5997697196898961;1.6630272928117671;-2.9060578677030406;-1.1555763128880847;3.3323951842196342];
IW1_1 = [-1.6651511874233522 -0.50591424584742328 -2.0548749820421346 2.0168153146007617 -0.023657521500957211 -1.3682084678524007 0.55654971089642424;-1.0919545799474881 0.052261261280685159 7.3649530806362256 -1.0548069802086 -0.69659924908594462 -0.76523064580350952 0.96530092763051079;-1.3531747016395261 1.8519510661129954 -1.2346386653881321 -0.23720841802462181 0.88252144769033736 -4.074207502669192 -1.8335584708582433;-0.27473975822411456 -0.93107842005222918 0.93082397397982097 -0.66160621712196299 0.085058612991358973 0.33166196026481115 -0.40496468413433739;-1.5784963359302828 1.4904070677267858 -0.66129773604777842 -0.036285879004646096 0.17283415216650375 0.73909409889937039 0.55098848714729642;1.2507118203564165 1.7919143508337596 0.3312005548134872 -0.73053468746372852 -0.25521560388581527 0.31803524130023936 -0.075207704270575298;-0.75011690538718701 1.5979959199640312 0.054204897573687842 0.072675785359461564 0.026089688975403633 -0.040630946151975308 -0.26191371171882843;-2.5155118722267944 -3.5193420691511155 -0.58333702825661637 0.60659950442913313 0.39054186325727147 0.35644650954621121 0.5050177421312283;-5.7848998743617974 0.020490346050395652 -0.92054552033798887 0.87455584134657749 0.43500711250076352 1.9873682841360314 0.55373031383766713;-2.7277448101092991 0.063547040559652768 -1.052586661602444 1.1383978069619169 0.1768653874919883 -0.3836214760896029 0.3286239422465948;-2.0490570672754709 0.050501682552953078 1.5736403007834019 -2.0556238066517865 1.6381668640144358 2.8174484489840252 -1.0525317065534843;-0.79795610606180523 0.73675805077969714 1.7838991320943525 1.5066755606225388 0.18719386763608614 -0.65026082282311681 2.1064971164993547;-2.3943612658973845 -2.1365090036037948 1.0482047446549552 -1.2941093930055172 -0.32835944107197185 3.2175120705240263 -0.36009316589845203;3.0444385818175097 -1.6138368836226673 -1.1522806202895644 0.79745275412640337 -0.72465645101772225 -1.2956193664376801 0.55271776544070761];

% Layer 2
b2 = [-0.90476732695900097;-2.3362828692154465;-0.00069469915223833306;-0.57600128805362194;-2.6498407096283523;0.069998703205339546;-0.26759806453612589;3.1019981523735756;1.7714758600617042;0.71976120072372929;0.093474558211227368;-0.033149900138198761;3.6303543970096617;0.84089772066414148];
LW2_1 = [4.9832790612796325 2.5412279478440558 -1.7623707800322317 -2.1826846104728808 0.61762789786667738 1.094643530571211 3.0239557230541902 2.0548931904971153 -0.96954518276899382 -0.1464958560399347 -3.2824960294345384 -1.5348152765592862 2.7330540436333091 -3.9512537758462583;-0.59297754773045486 -1.5170420593962768 -0.27170731231266793 -2.9303057043610146 0.77022295778621697 -4.0558253065401768 -0.96212287523497841 -1.5582800010966336 -4.9792423582756742 -0.08749874321438407 -0.61323525697238901 0.11692183793385935 0.39397753979903122 -1.9543622647482881;1.2016007725210247 -1.6284190966179941 -1.2249572480004554 -1.1791565472199117 0.507661380056318 -1.6058699168463233 0.060085906303698193 -1.3348652970325414 2.7280039046558082 -4.6870254488536478 -0.69701536203079772 0.10576561961642664 0.90170727159299857 1.31812864174272;1.6268398859870774 -1.3917720722319304 -1.2852295249431529 0.54718353246409457 0.7252066469230023 1.092188467242426 -2.0060822390763402 -0.093751657329871646 1.6624253712358064 -2.4667071027106169 -1.0656428911107161 1.0460374895110609 0.76170625568415984 0.21264117287342646;1.866926334278193 -0.47416348415040077 -1.5992124940491317 -1.3987066178527152 0.59555752430436271 0.829673475516847 -0.38297604910089977 -0.53730358486872754 1.9318535021429906 -2.7988741637649279 0.5265878837909348 1.8067084013804675 -3.2170184511266502 -0.090821913583244901;-2.3757539439835549 1.0477275432057875 0.5991086370994444 1.9840454768482421 4.8384103212122396 -4.4313303028776518 -2.3741245232895802 -1.2053963145071569 -1.8236169317787478 3.7803662656974422 -2.2670563630717542 1.3848228545192094 0.082100088597915899 1.23534179051903;-0.98587013071244867 -0.17249522431700112 -7.1794669672271141 1.8618650145264373 0.94453444901269279 2.0701026758085597 -3.0045544373446131 0.23889900852423473 -4.141268390913952 1.5724675662739114 -0.88727073230890419 -1.9389742029662946 1.0566572821466422 1.2440265081956146;-0.46284281242672287 -2.4909856471408758 1.3480943656312965 1.4052132353488367 -1.1231435598664765 0.91728278586235668 2.3896800158598599 1.3152479908026227 -3.1875520779544204 5.8478127386149135 -0.72340685646422753 -0.0043333872206196278 0.87213110677000971 -0.60486219592213331;1.447779396241222 -1.0856378210710622 -0.75057936175825335 0.23638762910864186 0.54433641441115488 -0.50640243099237159 -1.4514145961834239 1.4939680954112196 1.9361165242094951 -3.4497230918332202 0.11558453261387201 -0.018018158602557476 -2.6934278607034381 -0.31068762015209789;-1.3613948558774847 1.9304196379292742 -0.48275123052190433 2.7268683655228214 -0.33183992698770931 3.9248237197381233 0.8026820830378214 2.2015642822679369 0.11630611308431273 0.26967932555611773 -1.8048820750721017 0.35172146512650299 2.0140759516513214 -1.4819108891800781;0.88804681355926984 0.86942123054844245 0.31525941990622297 3.3801567827913002 0.58828661098978474 1.3972149266831291 3.5846380052434741 0.9574251540550921 -4.7707148248849052 7.6849840304668522 -0.056533100701993327 0.34108547680982465 2.1654965413041425 -0.50364843142535931;4.4130831402770294 1.3194791505307328 -0.14866736894577653 -3.5475179716129981 -1.3656848360127494 3.132888389006828 -0.21252030495047922 2.6725513145949562 -0.027007020813942767 1.9238211325824086 -5.0005645191636665 -0.94286915388566017 1.2622606333343964 -1.1391783829306426;-0.77492381823663148 -0.75927420071545371 0.53392689015405759 0.029084037972792021 0.28189618611907807 -0.98173575801082102 -1.376438343034186 1.3639445921639353 0.024921893906079129 0.3034843301699896 0.192913226347839 0.67599817397182316 -0.62795641000302993 -0.54751029634470527;0.32247536199050453 0.029245736978126095 -0.43982387387208466 1.9567490313029539 -0.18339249716548336 0.4208817692782531 0.44837770655854675 0.72664299376081576 -0.39399860651601903 0.12202358131940509 -0.43574234475074158 -0.44447692542532652 -1.2446936987341684 0.41211214967609205];

% Layer 3
b3 = 0.20794419208273163;
LW3_2 = [0.12754603049532137 0.63698305289173263 -0.39154495390587041 0.56648887120430924 -0.65373801197680115 -0.13163694304665152 -0.19340237849702707 -0.34356953392404954 0.767141933382399 0.23747629341607965 0.266665273233128 -0.09791883142396636 -0.77583785371560787 -0.82783230109073158];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
