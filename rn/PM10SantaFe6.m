function [Y,Xf,Af] = PM10SantaFe6(X,~,~)
%PM10SANTAFE6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:33.
% 
% [Y] = PM10SantaFe6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;0.00341273633199099;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.3305816121877463;-0.22021296375997707;1.2429601168952413;-1.8762503559213093;-1.127114324186117;1.1104304548690127;-0.37195807997951585;0.27744002519564209;-1.6867650432495858;3.4846082006873971;-2.4450619972799501];
IW1_1 = [0.52098451465522 -1.2282474596057675 0.95871492459725349 0.85731125206970049 0.72783572546957465 0.10998332937328915;-0.71657918902254014 1.9263132973201473 -0.63544779779354021 0.28409316381298028 0.15886523155959195 -0.023032621007571953;1.0111836873134712 1.6585362581825975 0.096938475664377799 -0.0092554080181257853 -0.61667953404794429 -0.31277948014198087;0.37130043034681393 0.29962706138519646 2.5311834349568674 -0.39179800557990263 1.8783497000370823 0.063186774978695653;-1.7864464540559657 0.58219898237176326 0.79026863272069414 -0.23988381961672156 -0.97673900983619788 -0.56283505271376133;-2.1447872732201736 -1.3550823185050691 0.73690136281352125 -0.79459693693033218 -0.60418866040408559 -0.56194568747307538;1.5002638310593257 0.0079022236707804502 0.26958442576220343 0.231616856444673 -1.9134053161954714 -0.38251804294433844;-0.23012583441284909 -2.123828607132431 -0.7236141076798055 0.57136451849139214 0.30319407877538201 -0.62078270846753614;-0.90855218879808686 -1.649342693210341 0.41021155228843664 0.37014388714625523 -0.93367251279675156 -1.0199240248614145;4.4688400488855651 0.097895669090779736 -1.544623626195859 0.52655869369832797 0.76078159051509553 0.61413500771752183;-1.1963460620226802 -0.3451546452799642 1.0947532191668563 -0.0092541256015226357 0.53705843630072325 0.67352292408105552];

% Layer 2
b2 = [1.58229218675042;-1.2753367433909757;-0.96572983130990464;0.96526918354658076;-0.088594368968341566;-0.39052798072848866;-0.43055091090422848;-0.21089653923898519;-1.1867746512655768;-1.2581740857100057;-1.6927109815901975];
LW2_1 = [-0.60766515852593062 -0.77411226814664635 -0.56756239810987463 -0.54904077716954569 -0.14564264877561786 -0.91760497221667037 0.94614549039613849 0.31931817257551742 -0.10956855453365706 -0.24301969341778312 -0.48989738713349418;-0.069312682027493869 0.17402787595378261 1.157656981933076 -0.39685668535823582 1.4086303475541855 -0.34468894883895795 -0.91038701343249928 0.049026908572300083 -0.76482347297130049 1.0484244462748 -0.7632198104931609;0.071295305917126892 0.47034753027251108 -0.68686959424434424 0.35607541006170385 0.3169150074405781 -0.23137241837632311 -0.25479368203939562 -0.82601818983813735 -0.061990690257659339 0.12836477477216185 -0.75526397399529588;-0.45148566804404144 -0.50480211294067967 -1.0566125844349208 -1.54019978388093 -0.15599710346313822 -0.10220447635819177 0.55916735835774933 0.35468541827458089 0.95324190388487207 -0.23498216407052336 0.1011264518455005;0.21145688603673576 -0.09729387030332623 -0.17205943582905209 0.43797152793023947 -0.83833231544782694 -0.074677192555905228 0.12665046964385246 -0.68164191499664861 -0.13987431388180571 0.35422306029935396 -0.21207686086059768;-0.4233486220908006 -1.0702892205410985 -0.15868349031296147 0.54431542020640444 -0.14505233651730096 0.26908701873491259 -0.39017248869819043 0.38574719360988624 0.49120681518360826 0.29559905760070493 0.81905880457257541;-0.44201956766115275 -0.80615259032108577 1.2533236934608356 0.57212818470625693 -1.1539128510480643 -0.42862572487530515 0.52582131270065158 0.065452510275735454 -0.31197608762424678 0.54645720199907266 -0.43402819530180736;-0.95819493345088791 0.28802287377850383 -0.036384983068830999 -0.65309421900023001 -0.81148964357358511 0.81617806157370765 -0.32665522399035585 -0.70387450437414534 0.31412719227155905 -2.0038164238908309 -0.41921610150077804;0.26030038311654358 -0.78309225479900213 -1.1120611130485378 -0.66752558183617927 -0.044985263920033519 -0.81305383311013424 -0.24305964104348823 0.55268127173924431 0.40400638819852991 0.32551857219299762 0.56648960787484748;-0.33002676149063165 -0.13030152281078428 -0.97794444755888299 0.48676195275565859 -0.75125943267013084 -1.1919011100068571 -0.65467531387879774 -0.053012675127078579 0.31360631785190196 0.51592824026006745 0.7983282604263463;-0.14671691521855024 -1.6588470119745451 -0.29168701950878906 -0.45941799044480935 0.015974229074307258 -0.85468185068465941 -0.20202151576212554 0.57508689309730787 0.53782026652852355 0.655252905004436 -0.62103772007830971];

% Layer 3
b3 = -1.0702526441692206;
LW3_2 = [0.42148516406568237 0.58420618138412173 -1.272672959000128 -1.1218779030745654 0.62460191682120136 1.6079609253049416 -0.69619216394856853 -0.82268492637435786 -0.4315080029996497 -0.47033026315160986 -0.60654007040533453];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
