function [Y,Xf,Af] = O3laspintas17(X,~,~)
%O3LASPINTAS17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:48.
% 
% [Y] = O3laspintas17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.241545893719807;4.5045045045045;0.00280033604032484;95.2380952380952;0.212765957446809;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [3.3093251419373519;-2.0250784479560835;1.3901954689442328;2.9460231337267224;0.57990808307553932;-0.065516287755306227;-1.3356830958254104;-1.0741182823282474;-0.48564921690997775;1.0205882011896894;-1.4232669847175488;1.2883071450656012;-2.8735945122364006];
  IW1_1 = [-0.24167283307354406 4.0155937693386727 -0.24064629258653608 0.20982408142454442 0.035670585359213566 -0.17127898242663259 0.033160018403308754 -0.62968110587705284;0.29788202124892099 0.22890905159095007 -0.037516346113767647 0.21603217470968178 0.06068533106989174 -0.38167742205403843 -0.46269571080495919 -1.2967482275868352;0.033875912792047089 1.7397821300138967 -0.11411166578824886 0.56634611530309797 0.63814141499655974 0.40627247308016939 -0.75298568292666035 0.19962151010132473;-0.18047096217783803 -1.8502504574026828 -0.27132516565621345 1.4472079109613387 1.8392077088735679 -0.68865168863772408 0.28375455571081015 -0.26587681736541996;-2.804565428043301 0.38258335249348352 -0.29318362645112006 -0.23427654462904063 -1.1199261087673174 -0.21721356940823699 0.14265428191154902 -0.46805294505737399;-0.30571407615367346 -0.39952978310971837 0.52014973247060992 0.47391542225123218 0.64975622075679718 -1.4500068776816615 0.19796771212014269 -0.15445155565569318;1.3502166320210445 0.38566450190924406 0.24273619037425545 1.7912839048542781 0.53142913053679763 -3.8487594018331657 0.073231228397204876 0.76127922373749157;-0.81671749156583051 1.2720995320187518 -0.17793266336981434 -0.039204335732491997 -0.51012866914994848 0.23860184015380786 -0.55071482367428459 -0.30884196646169249;-2.1400337257984452 -1.2121663610610078 -0.17507761611748607 -0.31853382222678106 -0.61026375774726871 -0.048643987396144672 0.38329686596345214 0.79999469793668576;2.4026117084902516 -0.093284565669281699 -0.22036166417123904 -0.34472264901221672 -0.20118549535708771 0.0021269319805516575 -0.871081012225422 0.0069805188186624918;-0.0072078345490081859 0.96771348681325853 -0.49063950912638454 0.84685333094676629 -0.18730957366577089 0.45280853902144214 -0.68770169883312438 0.34350878970685195;1.3248675951908389 1.7594925793089451 0.043476259851109686 -0.053861625065066011 -0.22054916935086583 0.57082128853910497 -0.11586793014936989 -1.2933081705103853;-1.2864767714982335 0.99551965916200902 -0.42379923661726993 1.0323902648694459 -2.3009513018787673 0.782082163550337 1.0785367082930866 -0.19141662527042377];
  
  % Layer 2
  b2 = [2.0569665565287769;-1.5046732492773598;0.89372705995206292;-0.80914841193921783;0.66994402646793816;-0.82894947637610805;0.84512928336711812;-1.6404169037720913;-0.32652550636611732;-0.60333582799278962;-0.77964280854218149;1.8722461487664839;2.3878696181230072];
  LW2_1 = [0.64572184235274266 -0.41616796898280767 0.31912096282020769 0.3828264003803305 0.25129125729069246 -0.088552979995536685 1.559617622871452 -1.0088727561358681 -1.471419139883642 2.3728158793427596 0.22485004310642362 0.26705146811271874 1.3152746885547217;0.40613464434746577 -0.31305045098430739 -1.8369776729574008 1.0064256551728887 -1.6547535973216578 -0.5262516064487438 -0.43785585036062635 1.892365115193839 -0.5406580117129367 0.67539683348569945 -0.64325350425865757 -0.23320646628655323 1.2397270323703451;-0.35934944707107808 1.9036946938758579 1.4008126989647005 1.1737193623657354 2.293865101217039 -1.043668515551796 -0.48296008949754538 -0.71333215736873068 -0.79029505461059169 2.398610526868731 0.50735487952762348 -1.7854736265783324 1.1809583069369551;1.3377375472731421 -1.11968237729741 -0.42890659047692858 -0.26118098783409394 -0.52091611079510181 0.22526092328786346 -0.057198790652175549 -0.49628917829354541 -0.55349402180183638 -0.70550567471853221 0.8403371554524327 -0.3328891336616896 -0.57425742589452355;0.88957092297411511 2.4838448230703358 0.14060678102811972 -0.0018405491945623909 0.555078393033832 -0.66683032924871322 0.089622986890308176 -1.5126511904897479 -0.047793461136131685 -1.5636727838838265 0.12325257188654401 -1.1835352507908823 -0.78634034938187791;-0.054734006436445382 -0.97271241797641816 1.5315767434508154 0.49578278601358527 0.44989758919713702 0.93833644483249068 -0.41825369826143849 -0.0053667531294785409 1.2149917516299129 0.85218464237865943 0.3493736749257893 -0.064731378919243215 -0.19055631753963514;-0.57864407953064756 0.88070645006659098 -0.51385367734854293 0.89225709734634373 -0.29621850711911735 -0.37412285027949249 0.0096183770375102284 -0.39455242296138521 0.16226145748450915 0.60192935913271628 -0.86784495370429338 1.773306513123817 -0.48104092785688235;0.4921244330218566 -0.64220026466316649 -2.1623988180523002 1.2061350810032174 -1.3085988037891385 -1.0028247280174971 -0.01051865844034044 -1.4838271781348524 -1.307535157675215 -0.42534780019687118 1.2615656061993468 -0.58527138682295499 1.9611431668050512;-0.13244995289514283 -0.26110458938049935 -0.42471095978931495 0.18754193422121304 0.5259168820962774 0.05007725924048799 0.036692687036263889 0.61514662973238421 -0.99072716204212208 0.058233165386799401 -0.67356594273485293 -0.33830356817661017 1.1663841628486717;0.33957296027300465 0.64424905172580715 0.34046934389056022 -0.063682805812943652 1.3369747940432286 -0.055868918474403319 -0.028701779039145579 -0.21383347546128803 -0.94703448429865589 0.7303538151764104 -0.67950014509773282 -1.2845540592191638 1.3054604927385178;-0.54028743925894451 0.078162889772128888 0.56611859526926245 -0.60125105523952826 0.20592095746259251 0.009923620699465098 -0.14976179181085089 0.097696701843011588 -0.073679467015433653 -0.12379887118858139 -0.030008173096608259 -0.14442180843249255 -0.37879492421864686;-1.3694339537122682 0.99007593410741568 0.25397514295262852 0.30295616869962377 0.082742509840279629 -0.07479317318219815 0.029689504933047874 0.92928769403552014 0.67606856895071799 0.19477965625856092 -0.950290013867092 0.55576476413072418 1.0418712263867707;0.78379486251295538 0.78708147664600492 -0.96674899768049816 0.35424870984962498 -0.11234095891568352 -0.30227462200011357 0.27150792196184903 -0.71878599083012473 0.42793878079978664 0.2072578560266084 0.44914845028738609 -0.68909169984500684 0.062845817768549];
  
  % Layer 3
  b3 = -0.82873044528047068;
  LW3_2 = [-0.52028799330723097 -1.4073334714723695 0.38717698531610739 1.9343345906310221 -0.74625883630069367 -0.75267930463188892 -1.1750473562890651 1.1497029479152034 -2.3410699641002837 1.3573795523579031 -2.2034313404115005 1.8449272565113533 -1.3562118396760137];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
