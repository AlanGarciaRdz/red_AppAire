function [Y,Xf,Af] = O3oblatos13(X,~,~)
%O3OBLATOS13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:45.
% 
% [Y] = O3oblatos13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.100381449508131;117.647058823529;0.0560224089635854;13.1578947368421];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-3.5374624716009726;20.048845041097309;-2.7508845143713501;-1.5069119821398047;0.21864715024946799;0.064676039773544483;-3.1177653102302676;-1.4074568251299115;-1.1033813474825913;-1.8966998123680225;-3.8747474929089174;0.1309161337207152;-0.13179513226252568;4.4824157508219091];
  IW1_1 = [1.4357330100050334 -1.613653824543267 -2.0147302971237382 0.18687703376231521 0.18136617785518694 -1.2765327371575037;0.115326843153315 0.82386990804616012 -2.6213631419265857 0.025157280104998823 0.21749826298007252 20.56137730839836;3.2136401191987365 -0.61072863329280425 1.002910114586133 0.16140216240062252 -0.43685640101319545 0.085780372575286687;1.3282307006332295 -2.1223832662121169 0.4520768882858327 0.82081255219878602 1.2490362378405278 -0.065094510297104849;-0.260278555665653 0.25964022015996224 0.68214799796592529 0.012071083976928552 -0.2199546911759491 -0.20911056152957999;0.6393509488180894 3.0481245349726112 -0.74344630589371519 0.37271723090044689 -0.53820433792094069 -0.41394861317142173;-1.8519316784727338 -0.61568641044057726 -1.7371169553404495 -0.25145606396295389 -0.67961491128293272 0.56184516316804811;2.0672581988677217 0.45327671438439326 0.24350693563445377 0.23740810178222577 0.32568518188123741 0.21005627323532849;-1.5697930373717253 -1.5772326191982582 -1.080379428153549 0.10983292484389026 1.2907039755314256 0.12870473071460914;-2.1595600612932619 1.2921853703887387 0.31391469482457313 0.010929270038330793 0.21527020883604758 0.0010629982324055947;-2.7579324937191454 -0.28975649291113281 -0.94028924673211145 -0.017023240107226181 0.77622210960596116 -0.70864534570498872;-1.5964967206793768 -2.7946134070631805 3.6902817591458978 0.14002358106335891 -0.87690021886892799 0.27714588114363986;-1.2828040326362808 3.2002108254776358 1.6127945581598915 0.33449883077835363 0.67048933008490585 -0.073976973532444493;2.1760567003147218 0.66359806050982606 1.8988368106474527 -0.11254770534441447 -0.70491562678508124 0.85433740540779213];
  
  % Layer 2
  b2 = [-3.9320106336784932;-0.86397591807418717;-0.58521407862231067;1.6599561752079008;-0.36781768994691483;-0.8596134856776706;0.10837794987883514;-2.6347879821902369;0.64863763899021853;-0.41880627962736638;3.2311371063599696;2.4660087900361169;2.0717196489713605;-0.80642042622430588];
  LW2_1 = [-1.1079206895265679 2.8404537862266706 -2.0016384563106726 0.97956132294388298 0.29625682206715531 -1.1918834825387856 0.78302850569441185 1.0986314686181873 -2.1319181690604498 0.92629651343476016 1.4555370326102415 2.1501965933263474 -0.59443562804772154 3.3578424369569331;-0.95942740685441419 2.1808486052957776 -2.0593506802686679 0.83624478661691304 -3.2196747182338825 -2.2975064929265128 -2.472120348287651 1.9234216099190278 -3.4457141470394244 3.8606432235323367 -0.29451331483230914 3.8662366712247667 0.43390769037321175 -0.40824330853680263;0.20386380190751338 1.5804933273271105 -0.57265266461932951 -0.41459494671393121 -0.80730601181093087 -1.7113590303946058 -0.51737369930337485 0.74575744652788856 -0.29082316497462429 -0.75597626243033611 -0.85731807126531812 -0.4919853422635912 0.99822368491741076 -2.242690658987716;-0.41425524073495851 0.80066804355578292 -2.9564550409020525 -0.089803235289482058 -0.7186879438956898 2.2757495494137343 0.70942258521844825 4.1711555412003962 -0.88380798528243498 -3.6883713337768897 2.345343049436047 -1.5530218895812016 -0.57386889753009873 0.18279203868080585;-0.19823214530901848 0.042596152707272558 0.17765214340019339 0.47992757779304357 -0.68865295042388308 -0.57295409266093644 -0.71558447131215341 -0.064058008898034258 -0.94998583178409657 -0.56273276785707527 -0.28484303833118602 0.81204793269315989 -0.43844954688145654 -0.65740365797035594;0.43652702379727837 -1.1128209272458107 -0.36177167848982922 -0.78352255233906287 1.1943245889298364 0.93508624909620042 0.97171336262150643 1.2781977471470447 1.5384657545319651 -4.7500218560138565 3.3406444502169323 -1.0503020348893006 -0.35421506336591335 0.50316836592216774;-0.22881203498646721 0.098937491225938409 -0.47929576102926774 -0.18913963539928513 -1.8609179996590834 -0.23950072427618449 -0.67554962290261478 0.63464317289673688 0.048661959008087785 1.2052027014186502 -0.17437425110293833 1.2573713714720605 0.31891150427426074 -0.21214411484513038;-0.45796183923984585 1.3119531819688039 0.41119096845107611 -0.14820483496714004 -1.5498171506782066 0.80536983567829357 -0.083886292052464131 -1.7598887666892 -0.22057494658837948 1.8616307491825885 4.7708153207935862 0.92779868484347172 -1.8627695187556517 5.721556313414788;0.37135864189113532 -0.11367764041276573 -0.20304893879904543 -0.37671471772463638 0.39795880526238936 -0.80057879645187791 -0.2968704870599887 0.84632172813231232 0.20550870046463462 -0.6143917816008404 -0.17917111589211177 -0.75017751209269634 -0.13630587971273644 -1.243468573038516;0.22337630711143006 -4.1269003986818742 0.63520303403513878 -0.33384918145799414 -1.8633123842662411 1.5896446158916333 0.012080350336545836 -1.5839877686128383 -0.11702691798445515 -1.3049948224758761 -1.4142933425999575 0.8046641657988316 -1.5898194896609972 -0.45157473481274613;0.11591462865589014 -2.3259781581892573 -0.13740257543894596 0.71946572673782305 2.842176405925374 0.82262587805720111 0.91786238891731164 -0.71763881616299507 -0.44161980645593141 -0.46595585094025826 -0.95461514599784747 -0.2476765435088028 -1.3212894817656258 -0.35343961960721548;6.2009916377631082 -0.28358368763465452 -1.4332175340488866 -2.0100251192261274 -3.5238774571314426 -1.3305862186132122 -4.2353461189706785 1.7771085977744521 -2.2034713461000286 -0.57603722000039781 6.7440785082513859 -2.6773392218972196 -0.30342088251854848 1.1112730261256039;0.27792796357605187 -1.063858175176198 0.044550286882020167 -0.66287854032331384 1.3676210330671283 -0.010053334136779592 0.9842463760558442 0.96164378622487112 1.1181568510012521 -0.027403014481752988 -0.34916772245844191 -1.1282492544522855 -0.33160906336710372 0.15888410626276669;-2.0327535473649889 5.151107653992395 -1.3917202773657702 0.13214289111988947 -5.1227849015494566 -1.9208052414592887 4.4554539901343126 2.4377192305567355 -1.3348922158916412 -3.7770238148174275 1.2087046328996558 1.1477925005792633 2.8778835153610589 1.7644634917736961];
  
  % Layer 3
  b3 = -0.55003799295463773;
  LW3_2 = [-1.0577079808036995 0.7167204921380258 2.1033885345637855 -1.2074801749526876 2.8269413128882492 1.6351424978938787 -2.7134251567415029 0.71841081568350018 -4.5360696438119401 -0.59003078553400712 -1.3735443363165816 -0.12662099432989851 2.4560059406651713 -0.30781839037805347];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 13.1578947368421;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
