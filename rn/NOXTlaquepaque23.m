function [Y,Xf,Af] = NOXTlaquepaque23(X,~,~)
%NOXTLAQUEPAQUE23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:16:24.
% 
% [Y] = NOXTlaquepaque23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.03490136570561;19.6078431372549;0.0212539851222104;0.0523560209424084;0.00632111251580278;0.294117647058824];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.6444882662959492;-2.3295918007750096;1.9777094764069105;1.8780643820846208;0.23682083329151696;-0.84395500894051334;1.1975582846585824;0.15281392198768393;-1.9004728888570954;0.20491057885492756;1.8415791328070363;2.9971956486437907;-4.2563954698672744];
IW1_1 = [2.250780224272364 0.38765918586577996 -0.25391582702240373 0.66305685772735856 0.21864485620701621 -0.19899422681561077 0.1956455494059724 0.38318124593415726;0.92373985145925008 -0.22071911414648346 2.3796059604242426 0.055911630733843261 -1.4273796577082538 -0.61042612152311093 1.3799972969062695 -0.0034115872550595709;-0.88861888791401744 -1.0168339716405179 0.73129429144016922 -0.4519063350848237 0.27644034657048877 -0.3667024894622955 -0.10969063210581417 0.87382659220311698;-0.096142601420621504 0.29185417062623159 -1.3944893717861488 -0.62023461526348056 1.0185809485675172 -0.48873389203602624 0.29809867695636161 -0.62577075971605001;0.26136253684765359 0.13020515961958168 -1.4546766167511334 0.025995356580787238 3.0844173477481429 0.6301128286467923 0.050295369029983224 -0.46099595139433508;0.094820650678891408 -5.9683607945139894 -0.017015520158839063 0.10475413722644408 0.27241683255690552 0.87399874906075448 -0.14366211849281627 -0.0095400693321739654;0.95386792735838422 -1.2434048182325037 -0.72108420013813901 -0.67975020114900941 -0.52066217184230268 -0.47638526626111433 0.024913174443603227 0.99271375108470084;-1.4828081629533114 1.25621974725342 -0.73301917522100413 -0.5615600132216767 0.14752338342818364 0.69029253319631212 0.050559613671103447 0.127846748087726;-1.506323979964717 -0.70458856983176454 -0.18859167420511094 -0.070369186325402483 -0.48199770974510797 -1.6306163725574998 0.14728008259998754 -0.13012191288043365;-1.1307515646064896 -2.1008112077523839 1.063767542327364 -1.0177737464646512 -0.60117236026254017 0.61068910342998772 0.23919119610794978 0.23705701746923419;1.3210481718966458 1.2456542168089157 -0.502297849339713 0.35953303663686131 0.37075235118008276 0.43818718092330061 0.72491848074243526 -0.46383872636649326;1.2832893325239862 1.8974550215817862 0.42261064653721114 0.9140676074017412 0.88505552027837076 1.5498397458052935 -0.35064768575246458 0.30193082603479005;-0.0073664196754275029 3.5029312817776188 0.11568533170080506 -0.11140111576895079 -0.25673065246798304 -0.5045572105467595 0.06869438196678658 -0.45659275409222372];

% Layer 2
b2 = [-1.7196169393627136;0.98261620981674436;1.4517896348374664;1.0842002095937626;0.21148820187144352;-0.6182769686292453;0.34054307385684468;0.83351778134833709;-0.73157807903385508;1.3999386918527328;1.1570804109560417;-1.3718698031928833;1.4334071403981841];
LW2_1 = [0.52721237828904388 0.64520810551440733 -0.27935692704527354 -0.5728326202972186 -0.54191219814240321 -0.59378533192532812 0.19672363578838806 -0.06257463996982994 0.44211057091967687 0.72119946210362218 -0.62746617758549239 0.12661853809491869 0.19662199331869273;-0.73438158416697419 -0.29056534193600508 -0.14102070639922179 -0.42003641429610999 -0.38722393110945386 1.023710857148431 0.0088538479569650885 -0.44001995345440342 -0.29462497871298554 0.18366880845554903 -0.03433830089986957 -0.99338309509369938 0.12920673867751462;-0.095406721849866094 0.11902144493243338 -0.54800750276647225 0.0083801032778500935 0.37760836362053457 1.0279384755294736 -0.14373903096034016 -0.54255692937437894 0.63258369511765633 0.16254735032903195 0.5153424923516966 0.6959382968978497 0.47069434131780946;-0.0019059715182555854 0.3612309133073236 0.74162646689926637 -0.28600564869770373 -0.0084545339051888511 0.71183046074325684 0.32329129578873128 0.95299579992963468 0.31509139103169309 -0.32684556387130836 0.64698861873427549 0.34130233172885927 2.0181805523931362;-0.30441580704078325 1.2419698898087195 -0.86966807786245948 0.026046123614974874 -0.060397319973727825 -0.77520781341795508 -0.19696545868007612 -0.86061492447165255 -0.44286212404160752 0.18338732932496499 -1.0737826869676879 0.028308836387675784 -1.9923744021648562;0.68694603259605203 0.16928260295686173 0.76703364980356037 -0.2246149698831067 -0.039190055861226494 -0.87328478587224512 -0.0043232990173786004 0.41635565136112002 0.66381101967682965 0.061770109282769936 -0.22276539357534489 0.39555353095989326 -0.70966402220003877;-0.59026488591658899 -0.075684835056398322 -0.77355505887516518 0.29167753879945985 0.0045595299341151078 -1.438040389162647 0.35374279731687119 0.34087147598825668 -0.31782795790043133 -0.044968917902709842 0.42459554138878547 0.81554129585254942 -1.2748673277675449;-0.082135631558917732 -0.044521615409301184 -0.12341707398075158 0.39276278351323934 0.37803764423079805 -0.49444879549191612 0.066175307895234362 -1.1559286072939692 0.58867589656576325 0.65563870743290009 0.37195529323517529 -1.0836086833429799 -0.79313799717191602;-0.20349517313191648 0.59835873629071812 -0.57467642005867536 0.41694023375541228 -0.38716270831116267 -0.80650320725340019 -0.30914017988433429 -1.1001616513269683 -0.46194899480461543 -0.1151528021288329 0.55628879959634314 -0.28978819831985819 0.46847958362043246;0.13727884751280181 1.5111039414672831 -0.090791256483128496 0.11195449069382282 0.21462712165476935 0.69781718881946864 -0.21093909680407744 0.58197098848636974 0.31777536369101345 0.060322001707675786 0.2610094045030727 0.2481954851524289 0.45202644694608846;0.43866344277202757 0.31860753754983451 0.1526461796740155 0.63525506156494449 0.63223862687990384 -1.3301938510302103 0.16564733459173592 0.33153634295164269 -0.90554925240299944 -0.13501684286794274 0.54668194315022189 -0.54944795290834769 -0.40594553617299384;0.05691567014902553 0.39131118978157819 0.51736114318908188 0.40644037580728665 -0.40983869755022745 -0.052415278256713271 0.23471264542501813 -0.10584363253589388 0.62150346703958226 -0.43090312701436762 -0.51842103218396141 1.3559161370788528 -0.76322929645193482;0.75285733566476398 -1.0992665109780546 -1.1727411332461626 0.13086008095984669 0.73409254935883073 -0.15291960350441131 0.26697039310353621 -1.5149232194458091 2.6622446543137719 -0.80098294295029582 -0.55725480563174357 -0.97118632625612777 0.3906863609579363];

% Layer 3
b3 = -0.24773131059648359;
LW3_2 = [0.34902870574530021 1.1581783146666427 1.9257740826334673 2.0114530070626948 1.8905270202310183 2.0080593171873899 -1.2021313620527954 -0.76008925843794473 0.19655558247123334 -2.0440237045720471 0.66655971015029092 -0.9563965572926949 -0.32755396658759783];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
