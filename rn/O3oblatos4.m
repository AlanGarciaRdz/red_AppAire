function [Y,Xf,Af] = O3oblatos4(X,~,~)
%O3OBLATOS4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:44.
% 
% [Y] = O3oblatos4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.100381449508131;117.647058823529;0.0560224089635854;13.1578947368421];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-3.1840889222858859;4.8721677570957631;0.7892232379234525;-3.6387274265244542;-1.9265118227970734;-0.34903189778726851;2.4336832284120611;2.1895424949493321;-0.032241862269833749;0.90594533961813073;-0.593570611986314;-39.756962821316485;0.3806944855231969;-0.45244637455986891;0.50691736593937731];
  IW1_1 = [-0.78517392060139324 0.54448937137702536 -2.7623237097575823 -1.2281061610473276 -1.6978186930273629 0.5498271877023635;-1.1208827425026111 1.7912268014471724 0.55026922929548017 -0.62437711528109685 -1.2623203762844382 3.5681649782706022;0.56344930263315129 1.0223873975283186 0.057290564755777429 0.39923033205522018 0.62851883726095747 -0.84083068493113444;0.9722335805474529 3.9050009827023016 2.0776983371081861 -3.5940281942839833 -2.4933929721960744 1.2179423275720971;3.0990633602033686 1.0592289153456502 -0.13835890167981033 0.091042902203026368 0.54718713496181859 -1.2020964897482467;-0.90238149612282448 -1.9988097834271616 1.7047752482740186 -0.075087860976987539 0.98798497646214822 0.82128078872356314;0.87995820283667436 -0.014362046220556222 -3.2040715582397681 5.6305155589999556 0.62596047763153306 -2.1711166515352454;-3.8184973067995842 1.7874246353859913 3.0021089163088641 -1.2519276587956489 -0.54027758212883703 0.8085859525832112;2.5052071634833677 -0.47445487282292975 -1.6394427627780024 0.84937602897085807 0.56121577218805929 -0.49362393214931488;2.000953826709905 -1.4880533326003156 -0.28420501127584302 0.4625713910684528 0.01655805493999887 0.78946978837654036;3.2178350972486625 1.2578312130372042 0.4431232754119438 0.54758308847065595 0.011458051264900716 0.1814343793233992;0.21111836889899213 -0.2461375459767966 0.50626873329983224 0.25387774747723818 0.06657886147435052 -39.253256978520412;1.8648584583507239 1.2177466293221295 -1.0588811569546654 -0.23317411960312889 -1.2560499093660926 -0.46442876872505051;-1.2267076924414413 0.84841283140464652 0.27837308735969918 -0.71787887808388628 -0.18569658631007604 0.60875783612365153;-3.9512763774520425 -0.42574857721499076 0.060322345457917953 0.09962397414688999 1.1347632225367053 1.2050336175163034];
  
  % Layer 2
  b2 = [1.9926342360897253;0.96846881174412547;7.0685704036525729;0.30403174352438539;-9.6409966723542837;-0.23988739340772622;4.9486572633345505;-8.7025026622170021;3.6949504407062852;1.025420522183758;9.81263644711224;1.2953399873183455;1.1455304220186204;-1.8365785262464183;1.9436013079356467];
  LW2_1 = [-0.76235673017618588 -3.9084113363734785 -5.4589471890771293 0.34447039738563356 0.43331171168076105 -3.6603040450396738 0.90970745795542951 -5.9929246112697356 -1.5528805050652621 -5.3832975000397107 1.9684084683941778 -6.8286695989090376 1.034678609092694 -3.7038837382222032 0.86512892490280702;-0.28952633069583411 0.33016524270906927 -1.0197434372905163 -0.77617979995474817 0.43953184161135567 -1.3865701461535704 0.41522039368997293 -0.14336190282139846 -0.095710383015392392 0.097342332078940844 0.039903821509840585 1.3970634673955862 -1.3831530844008679 1.4192476325506826 0.38600951158592173;-0.22648810595042931 1.1656749613240016 -7.7386638986663243 -0.076828452247369561 -10.562905637955591 -9.3779625843463048 -1.1786293190577273 0.79876863041217372 -0.54952779534446083 -2.6078709865747283 0.5027790630609128 7.1551168131679956 -1.715713902560007 -5.422878783602215 -9.4027122797083447;-2.365623431342271 0.37525109950726615 -4.9640333722408219 0.2396708822007029 1.3550306438617781 -1.5455819883905573 0.84741946923586031 1.6164497354511522 3.2624852008849907 -0.23355551720605605 0.9312262758346691 -2.2726668075833119 1.6692879975658723 5.6538797177455038 -1.0418876005146316;-1.1566899533223789 3.5070400893303524 -3.9030350334240267 -13.6977062008418 -2.9245859414253621 -0.68026512678219597 -1.0308728726416567 0.85601584232917294 4.0884455832535327 -1.3008914248021677 2.1456308343520565 4.8380640846333884 -1.627918869312353 4.0543917771939464 -1.4055839891382531;-4.9734821699307794 -1.1305516127624626 2.7613305401007495 -0.19817755402569598 1.6400666386485361 -6.7076962884699372 -3.9864969955458278 4.6899788553829076 -8.4610040522737258 0.81787591453269326 0.81909445670677505 -3.3135069877165453 0.45283104780380179 -12.642591892709937 -1.7024805949693731;-1.2430118350353236 1.0631062543413885 -2.5207515247480314 -0.03585456563944036 1.9736742485300225 -0.13484259441051327 -0.47793472531333425 2.0211057195981632 -0.69768140683060487 2.8424678809949651 -1.8724463219785041 4.2269788800836583 1.5595373431080963 1.3275116674697187 1.1156473365630275;1.014531595938142 -1.3522286766749581 2.6320551475357101 -0.96369766099374998 0.115609318791143 3.9733683121933705 -2.0289924617504749 0.48638980613890376 1.3831130298553245 0.23687949008848688 1.795557201576478 -12.850606169342136 0.78785678937174852 -2.3776349712123608 4.4748120214181064;-0.2102212793232642 0.5384294273729674 -0.73489521955820791 -0.82370680172911637 0.048404532154194012 0.16208452190117761 -0.39583704715958823 -0.408222369636844 0.51535914443296749 0.11435108064394744 -0.66634743139538599 3.5390701222015171 -0.35403893356577482 0.67717782806215321 0.016975256981283611;-2.6287407545701691 0.15171970672397145 -5.6633813943876188 0.88011012306679848 0.4697131541060629 -1.7878591474907481 1.0398645832153255 1.2105353923503006 4.0000347340091764 0.046502783254270499 0.96391890621545451 -1.3360439050817188 2.1445318037235208 5.5828844406736886 -0.015133466729666832;1.3752792840071995 -0.11025546812141121 2.3764410383941819 6.451329788779316 -1.5329649349720249 -2.554645476592885 0.1500811324199888 -2.3776281285993401 4.3502369166939143 -6.551243472602593 -0.40322332199325328 2.4792876290813219 -2.1194570418975482 -1.8194838735902266 2.3648579285836338;-0.19636503177484677 -0.79547213339181078 -0.41571240899939543 -0.57803265240799739 0.82469723295134978 -0.97187759340463131 0.24865637873976251 0.54705178954712308 -0.70366161133014549 1.175756633693178 -1.1436200126177449 0.37389180236328279 -1.4063035157521115 0.87510136302702746 -0.028653488942027357;-0.29646450925154005 0.91585676252013637 -0.85760788199572724 0.59401843948343647 -0.29547746362390537 -0.31346728910146054 0.62945250227430993 -0.16427726606255169 0.521746977686951 -0.28156562482809289 0.92837638384106225 0.43461262222248626 -0.20381201172513783 1.1056939255706131 0.36823190934883315;-0.86211997503645621 -1.0422870295168309 -2.0850523072959262 0.051655468580843349 -1.5135013197656113 3.3828865813332039 1.1779823943857668 -0.36504376921711579 1.316268013297947 -0.72112221819478506 0.78477411347125159 -1.4296637941777375 2.7358504023462151 1.9340712739806736 -0.56120296305900663;0.84051277845598016 1.0382772569294751 2.0169860696074715 -0.1956165227487448 1.5111466017937367 -3.4240577199046331 -1.2557072470730333 0.54171019495952155 -0.6146338780606575 0.26223986366268859 -0.8026577272334765 1.5016956079671488 -2.8785881060179461 -1.8180375033968759 0.5232258226556239];
  
  % Layer 3
  b3 = -2.0422705575540605;
  LW3_2 = [0.27485564373017335 -1.4555260599275572 -0.27833497279574843 0.41367126755194389 -0.15513571179135127 -0.14659441675149609 -0.32048980169630498 0.13596579699912215 0.74381367852083025 -0.32466830419962328 -0.37637408247665649 1.3626503592804697 1.5620554152881987 9.6439909158345074 9.8506951026583884];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 13.1578947368421;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
