function [Y,Xf,Af] = NOXTlaquepaque18(X,~,~)
%NOXTLAQUEPAQUE18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:16:23.
% 
% [Y] = NOXTlaquepaque18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.03490136570561;19.6078431372549;0.0212539851222104;0.0523560209424084;0.00632111251580278;0.294117647058824];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.382554803614831;-1.8680301710488618;3.2378610354215698;-1.6483908302260011;0.28870940972044495;0.082008761727255977;-0.68340916395023088;-2.1365227962122511;-0.2510762248713983;-0.14249593024799664;-1.8427408956895885;-2.8819275139033618;-2.0764787454620945;2.883723499530285;1.3459499276378002];
IW1_1 = [0.69577088095281769 -2.172794676652599 -0.33498214919914726 -0.078520352282719336 -1.526763577491276 -0.57346981939553487 -1.0382108893549751 -1.3373727802789397;1.2189386606918791 0.11081962647371169 0.49907881860626802 -0.82124216064661237 -0.19208242978800974 0.85095243257295039 0.87017717431076258 0.37072002685545891;-3.6919651551887549 -0.010424613862052848 0.10496749111575193 -0.27106017913179598 0.31856273007182623 -0.22012766572526146 -0.55215998394680377 0.096456118620250719;0.99878341775929536 -1.5078500377853037 0.13762188761612493 0.96479285891623667 -2.0977860908923867 0.55154427899103464 0.24302303757895044 -0.06752282861490827;-0.83400771123045758 -3.1369427423827694 0.98392644341043922 -0.28039299519111838 0.50611476009209144 1.0406642919166604 -0.15116623221901113 0.26062908035638133;2.2657981037578265 -2.9374749268577025 0.37787495584618447 0.16400474129586629 0.78071805466863531 0.64849520584092268 0.071065867950600048 -0.55029961491182167;0.29090943328133312 -2.071395180035021 0.61431949254356211 0.3400227302278388 0.91758047985018121 -1.6992645053835724 0.18710439538355719 0.25507388410042664;-0.072909309548943646 -2.7858802190435696 -1.2189277838032757 0.070464183541139355 -1.7824352704972615 -0.71257011083041 -0.068491926923940821 -0.12644801657870647;-0.79524890016911776 -3.4941200977497804 -0.44837502818902703 0.059390223729764866 -1.1998253716770628 -0.15062275900908587 -0.11575163877423159 0.2379836312950433;0.788512980209361 2.7091352854363322 0.6681320922860684 -0.26811528633882381 1.4422349377740751 0.75116296726116849 0.0047901144718297036 -0.28200762632473764;-1.7640869774908168 1.8466858043040022 -0.70737873055674216 -1.3514081504575464 -0.31319516605067815 -1.2340845251559585 -0.5585659936739763 -1.0461895434283968;-0.84099020059044183 0.066267312042560839 -0.37202223695123054 0.73879010267790157 -2.7651879686707193 -1.2436192266495047 0.82564877294914885 -1.5594413631971846;0.12813131339353032 -0.65385479731559959 -0.14871791670115608 -0.39979173994697986 -0.049509647456590831 -0.32565706863162308 0.36624891614575811 0.45850496123950557;1.8670533892519789 -1.7655633006984179 -0.94314146358860129 0.15440597503886744 2.2587303472501405 -0.59682222379704908 0.52670098765141393 -0.68811124623423647;-0.25206063928753053 3.1085927352680902 0.10748345707382248 -0.58964767216018787 -0.58957263523697179 -1.3872165701754753 0.080754726879045821 -0.1329850310142297];

% Layer 2
b2 = [-3.4951748396851778;2.7933390919141745;-1.2548152156918264;-0.43157939246802868;-0.49188968094164554;1.5255598369948591;0.54865929202996888;0.4371258248526711;-0.35549069383186144;-0.073781292377088928;-0.80558421525618895;-0.69281642462323167;0.38100812360724379;1.4592764234278728;-2.5704147540904203];
LW2_1 = [1.3423002647281348 1.3971249995353503 -1.0136300431451268 2.9368324514026241 -2.640085029779355 -2.5357044404887512 0.45603730939812442 -3.4234142584397738 1.6376081539442524 -2.0322095117989458 1.8559313532315882 -0.015896495160670095 0.88640425864197303 1.1299999848797744 -0.86293627208646217;0.065680714252862205 0.80904653192206755 -1.1269420801701537 0.65500070683784228 0.79555381229069733 -0.32593334234318377 0.018176281187582924 -0.49603589053785474 -0.064056526610151932 1.0163368850692218 1.0595711649656843 -0.78507476973545198 -2.0418187790184263 0.75229442596283047 -0.57246086113470174;0.86645015641131029 0.077039577604460965 0.046102236972523171 0.29900869126267099 -0.10901165501256907 -0.34513298578061369 0.56752994587926009 -0.58840858058160972 0.22984142546071443 0.76149882546640058 -0.62741859652549681 0.32662037823506157 0.83519867857873675 -0.42451717909756881 0.45392845445334673;0.53219578106829146 -1.1931061900805151 -1.75925915713397 -0.64368624943883734 -0.23530118579896889 -0.36506025707717693 -0.41580541245712282 -0.30763466810785178 0.37316880686917664 -0.050556315447884775 0.10042122736002383 -0.22280471761553977 0.076528453819262404 0.76064167775101554 0.08748913341791148;1.4415083260109951 -1.1133816335648052 -2.7696980840084375 0.953278139848316 -0.10986804556809626 -0.74397485338698066 0.29502517728192501 1.3827673478749265 -0.38745331505543334 0.34057507791613562 0.45989789581789703 -0.61615023750934228 -0.055196257134780019 -1.1654175175797539 1.5721153466784581;0.32121595044805057 0.49852976690662182 0.71932074927670675 0.95202599299415158 -0.18375235081105348 -0.12492471208220988 -0.011812649513704188 -0.051710211401108472 1.8582547791896724 0.85874325915747229 -0.25012481748069426 -0.92759414559106923 -0.82255538898455771 -0.80706986329008124 0.4307907057254915;-0.11288575806366512 0.16814071896449762 -0.54255940058682939 0.61500730646741031 -1.1012956072570177 1.1491184919702411 -0.3881438591547362 0.42238912780849258 0.66850193662580304 0.35322478987817796 0.10282402129321543 0.60129283300323699 -0.67147928234448906 0.070496322789184412 0.031825141544454413;-0.44211564193156661 0.14007912460968613 1.9276602223809574 -2.1874879746649696 0.25374637517664311 1.3688162919377413 -1.4942422119956398 -0.32370489479320191 0.46352465323815761 2.6375235540898512 -0.34872985366982229 2.1198696887160331 -0.52139284916508477 0.77200507321528034 0.16011763281132602;-0.3225367744843412 0.089029466741643942 -0.40921221863365181 0.244259157636597 -2.943951787823111 -0.44159048175875321 0.7402973597949678 -1.0694187928091805 0.13565914323961067 0.20502846990135606 0.51921401109277732 -0.19783509166948676 -0.17986863519293594 -0.99248406718401261 -1.9891077410668849;-0.24731894928362647 -0.074182407027721886 -0.33929694698750679 0.034752043128946218 -0.62284555735782798 0.80582402013962495 -0.44721593293334566 0.3089946659906983 1.0187095590514585 0.8393443671308346 -0.17389806354988874 0.45121942872149962 -0.080462111128454833 0.14635766028015029 0.25499866336384319;0.048453856022109512 0.687094467012067 0.3118932226880235 1.7290550057452503 -2.3072603621263608 -0.23466251165741139 0.072230441969511922 -1.7296850521388296 -0.29368478373126689 -0.79016643894968974 0.52520037425424682 -1.1221380651480086 0.74367106155234675 -1.3779266492413036 0.4173700963535969;0.084684949913404153 0.34438442380380968 -0.44509820577076387 -0.75925233134688186 0.68596792875622981 -0.89818098756440889 0.75531923986967642 -0.45137884318731697 -0.87918731823153262 -0.77666441766574079 0.38926331886476923 -0.30082688215131709 -0.066409354899465187 -0.48785105025180364 0.070880566897212158;0.17482053369797962 0.033857742580857206 -1.8533911553399636 2.3809387582378823 -0.045248854564517937 -1.2879216956263635 1.3223223351474382 0.74960804153858152 0.079163820013067668 -1.6924913458668238 0.24206895281540844 -1.5074787168372954 -0.94643286270069094 -1.8299169076093971 0.20238568508871904;0.2834933386869935 -0.92421037712828769 0.18382195004385443 -0.55772394082198806 0.2926140431421313 -0.2386944306060991 0.09424959756087764 0.14120175274877078 -0.24845369251986416 -0.19872283343106301 -0.10547270130229383 -0.41762088393826607 -0.86829407690314453 -0.18273560107308096 0.54502176093069987;-0.23990345372093397 -1.1315225339693873 -1.5350160549020342 -1.6812692247128029 0.80185596780871027 -0.6256087925278685 -0.88148103023568736 -0.35764094771132865 -0.21461464097047203 -0.064795611983175266 -0.3304898714591617 -0.23133783442640046 -0.14908660245830602 0.62723879788926318 0.35729584187280733];

% Layer 3
b3 = 0.15538355270667289;
LW3_2 = [3.0239859929131954 1.8759226314601285 0.04154474871253952 0.50173562061528898 -0.4609349401957849 -0.57369359868200198 -0.99924710126840155 2.2935061379720878 -0.52791235608967402 1.4068447784364373 0.52192061708061077 0.46893193945456113 2.3543229229711153 0.50007461166919187 -0.62549010657613457];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
