function [Y,Xf,Af] = COLasPintas16(X,~,~)
%COLASPINTAS16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:02.
% 
% [Y] = COLasPintas16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.241545893719807;14.7058823529412;0.0179856115107914;0.0558659217877095;0.00576368876080692;0.212765957446809];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.6026802469477985;-1.7921156197652537;1.9998575720204783;-0.73561545943167772;1.079782380762204;-0.40724832942024808;-0.11086534754159769;-0.37490387829528105;-2.0381326841682359;-2.2186472714990209;-0.21567806644949886;0.85307887968417129;-0.73083109606355057;1.4842581869531246;-3.5819547039428854];
IW1_1 = [2.0478795825800158 0.64559337731461219 -0.24394212952989841 0.3908201040923463 -0.68383657649363827 -0.62507676359634479 0.34910285479320602 0.31710869410613574;0.41657453153289181 0.29262775597764351 -0.96011487349552571 1.2598373335934032 2.9038253133339005 2.778726325921121 0.59281596602514186 0.66790794519406771;0.54686879864307081 -1.205660402010833 -0.51252165404054351 0.56068214784907677 0.60347503368646505 -2.0788516501685659 -0.22314708212494108 -0.83518332792915728;1.2975738473720484 -0.97892722503522367 1.3199245939484725 -1.5160223845442404 0.23219960178119767 1.4123295972849121 -0.23346538371452696 3.008232631969439;-2.1225869500553278 -0.91503670940943571 0.50738440607175472 -0.94304613767059364 0.58281133356745674 2.405543529010576 -0.92014664041918137 -0.40068401573319795;-0.056536114674776178 -0.15857868834211464 0.24033501320036499 0.17966417885621497 -0.024778232039379129 -1.3434468106948849 -0.41639703986356746 -0.2283701664943891;2.49392251156402 0.26998155506781379 0.1732895140307954 -1.0696032492121883 -1.2606448398296619 -0.026681302544587192 -0.097696040667363551 0.50791093065014725;0.26393230297155695 -1.1791312004214354 -0.13267061608478356 0.20479444689892007 -0.70295811244670803 0.14733568066126668 0.27792691126878305 -0.21095725174711885;-0.47372770945380471 -1.1126367220252702 -0.36202566531164748 -0.93931162090677955 -1.5992682138246994 0.10022319057891026 -0.27936883318639116 -0.051373799761850976;-3.143173773573416 -1.0610330714993703 -0.094546509341337917 1.0453323269434625 0.19992309818305032 1.9667451501990623 0.35730435129289217 0.015643486674194487;-0.3341844647428121 2.6109385285165665 -0.10573560412277228 -0.2691011186445047 -0.094110380038972763 -1.8534954851938368 -0.24946371686863078 0.10641613011813857;-0.2186084939668963 -2.8397602144581282 -0.21155610765693494 -0.19181146503068408 0.13319411636765527 -0.059973314206449434 -0.0090673579566820043 0.085098975061569965;-0.36819668749583728 2.9930002840339736 0.77613656544140075 -0.2574270014932441 0.82173388890978349 -0.095395268839714747 -0.39561325797341051 -0.12393138433919117;0.97837107393579281 0.39925957995201572 0.53269977389965018 -1.1424155704525112 -1.2731864388530374 1.0378516599686629 0.46494375345486871 0.93075043277202352;0.25797224482178721 -0.99113572232813385 0.020444869822449828 -2.1284257101050454 0.8452170328452091 -0.38238168408228024 -0.0058840622360760431 -0.3449306464562118];

% Layer 2
b2 = [-2.0220799936899878;-1.4646418141219695;1.3776854706433868;0.67286068438159785;1.4814076072396003;-0.10961232272904783;-0.55863636848886788;-0.23753232601375748;-0.32093245139580429;-0.28540777368148751;0.37841154811413147;1.8967892742612185;0.19748518117206218;2.4247013132056394;-2.1457643165707472];
LW2_1 = [-1.1426203884704267 -0.89701000312079904 -0.44299610782024768 -0.33607039524173882 -1.096139307555754 1.0519310565273801 0.43974989049164515 -0.75557747923226926 0.62012474310972376 0.67420592882379582 -0.44407345765307948 -0.79780932614289557 -1.2151692015207822 -0.18048235155610651 -0.60913415119257208;0.81589164065864772 0.70090711564227182 1.9631615295539415 -0.31747599021053585 0.74281411302286471 -1.5632172751679541 0.080974768780588513 -1.6288910088717212 1.2848048095050892 1.9170744879108947 -0.52419945258599032 1.1815400883033151 -0.44913289170101223 0.45974041596841098 -0.079664360840975751;0.48519971314047727 0.048222741805687058 0.064585666291907651 -0.098497126711718702 -0.1581030438843814 0.93258778685117205 -0.032805555107131332 1.2166470785246446 -0.63700219374901745 0.069769422117672245 -0.33438567062855284 2.7712670815454681 0.52751822528006109 -0.28943982741913188 -0.56079946122285429;-0.35067723124987504 0.66550166249422249 0.27120474666986027 -0.021445878623164875 -0.088121280481733025 0.1344676165774405 0.49680073606022651 1.5025694502380993 0.3891895722773307 -0.41013822501994002 -0.9224791027737026 -0.14434428733887822 1.5824347115244555 -1.4873707936313749 0.97511301627731084;-0.093977757065596024 0.1914598786041527 0.082758204503752014 0.73058528666310607 -0.074811419920486788 0.62972329038986996 0.2186639668176088 -0.08306089603172287 0.043858714016063984 -0.0048576194533564467 -0.66485953878200044 -0.73751931221674549 0.72968804782567043 -0.091292906187116163 0.25153933000531387;-0.42364390853612072 0.76576335219651759 -0.070180617830675612 0.6145859192390879 -1.026097884098951 -0.33917861832941854 1.263574614282734 0.26337565672462604 0.21863068606007924 -1.1469901545453771 -0.095318078065620496 0.89393441819717612 0.61712647715773516 0.11842694601978056 0.43015724513184556;-0.1346853856836715 0.21540302833224592 -1.6658174769774348 0.12613884587182206 -0.14023236390445351 1.0282932727166856 0.10198532885403701 -0.079407636149487579 0.061068431339590418 0.36983375211923675 -0.31941754299447472 1.2977890541515105 -0.074555347796522398 -0.22775935784565127 -1.6118839738166764;-0.11096330894713977 -0.22908111895498151 0.12247923933278969 -0.23486594823906673 -0.18462331387985828 -0.85080167991258504 0.099267441427452932 1.1800911595578067 -1.2296072818777177 0.19449571654429418 0.057860830056816949 2.0185473526757409 0.32800300797940585 -0.7219313398964059 -0.11776113380712944;0.32517701820685047 0.066398785339477087 -0.34534444399465236 -0.11060114790486869 1.1329237517554185 -0.5456530276891044 0.45170834582909664 -0.48369942673839916 -0.11020943301189781 0.18441774049296528 -0.18530680268072058 0.6109335374057614 0.53650386015959461 -0.72413101841167915 -0.71964100571139589;0.51758041945240885 -0.042326886545909242 -0.44240086429408448 0.014345439609867153 1.4638420429919901 -1.0608545307427291 0.37002017182027525 -0.83520596523166846 -0.025119619693113764 0.2207222718436356 -0.52039800476974307 0.26233547650486178 0.41821613092608556 -1.013091674147746 -0.58247970204759203;-0.61981651463831133 0.16956062027048413 0.15731113838782104 0.54577723283030932 -0.26916763479678507 -1.3319938100089805 -0.33952475833495299 1.2944345149278054 -0.75686016643664289 -0.55913973819054474 2.3529434521870676 0.71910678855162358 -1.3733592320209733 0.013686834098431092 -0.1172902067511685;-0.20692413807060006 0.5815064308600556 1.6275509116572977 -0.17052527235929679 0.77718220391548243 -0.71214808006371766 1.0528149426018767 0.40987636233666658 1.7260940775204938 -1.1840152263986434 0.22626875891658546 0.18457692743309961 -1.0228159580088805 0.59439297426556736 0.031823114095819033;1.6950277655193027 -0.21541299340726222 1.0682301451252085 -1.428927276915807 0.57994098746617406 -0.85972904245269721 2.2387544175858647 0.18792465607247871 -0.76174796069460338 -0.22664926949578695 -0.63071965810245412 0.6621039253630816 0.14113727427521072 -0.43580578930514696 -1.9859985749479165;-0.042274479049342964 -0.035248453637419741 1.0102667138213197 0.20518510937577494 0.078377179270189251 0.28371293506343059 -0.08611737269111433 -0.50133454508870023 0.081664294792659825 0.82089509953357853 0.7984253879116241 -0.18912466955584012 0.9091899011607838 0.3543331435627301 -0.51386300527765227;-0.25194548411396034 -0.17456726498533809 0.28646876924290321 0.22174405488570478 0.38844099983483776 -0.1934645825724027 -0.062441327601629862 0.33704888206403394 -0.16241005854925375 -1.2465496797690483 0.18872857623607117 0.052077373332127204 0.75250214216231825 0.34385864280014294 0.38111721189521158];

% Layer 3
b3 = -0.59369524311948096;
LW3_2 = [1.1908991460288592 0.15766687885533071 -0.69597110128726802 -0.38836848549446856 0.68117198433672588 -0.20501743032593137 -0.51040669464437238 0.81827100027824184 1.4058860582188506 -0.98879115289490271 1.1152996771641879 1.5794795055414343 -1.5928110356535998 -1.3374878850525864 -0.38215659761562981];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
