function [Y,Xf,Af] = COSantaFe6(X,~,~)
%COSANTAFE6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:06.
% 
% [Y] = COSantaFe6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;10.752688172043;0.00341273633199099;27.7777777777778;0.00632111251580278;0.294117647058824;0.448430493273543;166.666666666667;95.2380952380952];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.27175041395133576;-3.5232417941797252;-0.34441427567629962;0.75050469933136343;1.1539637289604512;-0.54012972809499837;-4.203142786402724;-0.64734787366547863;0.29434144835827153;1.0702887179734997;0.42852213565041647;-0.30178293443763193;-2.1664347457534308;-3.6157117741030289;5.2510450268577182];
IW1_1 = [2.3491004876577493 1.2448456093314699 -0.19460171447023458 -0.21131801870959455 0.68651750097427777 0.51443641898007741 0.19207014445579967 0.014920074972970432 0.22272649342082529 0.11131276341147117 0.61483649070345769 0.16194248852170659;0.47107318993631098 -4.0054032583629118 -1.4974893321063594 -3.3724632594677217 0.34638586047462383 -1.4924283312727815 2.3355406941915287 -0.62597840577567054 0.48080281267119945 2.1091570674200812 -0.43611445967127621 1.1022846084735296;-2.923318838704843 3.128178087909431 -3.066270135920985 2.4467668900674395 0.77959501006455967 0.56961293002281788 -1.0998684515149997 0.18892776378501602 -1.0750765570813796 -0.53468479107323108 0.54550033473256954 0.45412369311970557;-4.3999688240574235 1.5424155475091939 0.26522607134135456 0.097190771549393332 -2.0470329367675264 -1.2713203138486524 0.10161796937687836 -0.10483008486058495 -0.25005258582372014 -1.2069879198895497 -1.3555015031069837 0.24098830159675499;1.6306540748446545 -0.21337461968218857 -0.174036912747807 -0.2846399462002262 -0.42211586980144317 -0.11040970739452044 -0.35279592574596103 -0.081654926835909011 0.58256693320020503 0.1597800021967089 -0.1429364516853765 0.25099529353327954;-1.0738282246173383 0.19663471027318438 0.1942640245864895 2.0687783640689057 -0.94651517679930663 -0.013382277244329409 -1.2238024787710704 0.42058798763949723 -0.60835335484421649 0.13865041994158175 -0.18008006948527613 -0.26192106784344865;-3.8100097392705563 -0.86719658823076451 0.68121418330548289 -3.9688827702602354 -0.29151117542663546 2.3203171107855911 3.666812104955016 -2.9270911492377665 1.7003323150536527 -2.8699949930453217 -0.035650652865811497 0.86002525475719516;-0.4736808636295855 -1.1820445510857382 0.31975455084812715 0.81488493953732954 -0.34308166809427443 -0.11648833611507239 1.5749154557365785 0.4575771033899097 0.0087981230555306544 0.35381300110070935 -0.098707524958965745 0.28388805055565264;1.4831698795705928 -2.5794376594848631 -0.10556084685818282 -0.69250953534976689 0.57283341444138847 -0.08018632932704782 0.3667715646751134 -0.12765158527855985 0.38924266464137314 0.33473076571559485 0.013854217318160281 0.32084492464378922;0.11343068726508648 -3.2318801667531836 -0.14421003494243934 -0.33359871940664704 0.27189936876500675 0.11518650422430325 0.81649159232176716 0.23007585535498554 -0.17801344115133885 -0.080059734858650214 0.10139618695723075 0.37128996994573182;0.44019935380995906 -0.62356087768274959 -0.32296793818319314 -0.28070177545362124 0.69435716571258721 -0.010499897457444739 0.35734817357610377 -0.08255919471705972 -0.021878670601253033 -0.062849825230539766 0.087850338461506763 0.18020369493213387;1.7867862541959538 0.59422606572948677 -0.62785463678489672 -0.36440858636936652 0.050642772201213826 0.74801445103495778 -0.54308785193094122 -0.081001220046057157 0.22523980965606433 0.76977885766774923 0.78210273328931357 0.6359099346013577;-3.0994331308354268 0.10304701311044832 -0.38389885849474747 0.38700352910054125 -0.29810656970777377 0.52972046198396094 0.13036608610422809 0.076818320651914559 0.10386129931062364 -0.55824267698340591 0.14907496801643969 -0.15768026310306923;-0.27358100906832356 -3.6020624796807019 -0.41630385800688408 0.68915073456608666 -1.0671489334415702 -0.39934017901777058 -0.072738258310700979 0.13174616029999792 -0.019042027291997873 0.51778491193535048 -0.21916893237801996 0.22753136738675064;0.5830941336916079 0.36526308586560369 -0.77785026585309036 0.039779961211246426 0.25454407403273599 -0.29992797702982721 -0.26359149764710871 -0.14219627183485142 0.31290578706449451 5.3616256719444735 0.19871291494639234 -0.24647044813255159];

% Layer 2
b2 = [-2.7927862946123629;1.0858073261282015;2.5404225602337225;0.55192955909147356;-1.15747040015615;-0.81271894229623443;-2.2405761969593363;2.535107901744972;-0.65911014594583572;0.33927474563041599;0.98621055296544524;-2.6996158554128384;1.2408023943886846;-2.9966407628462792;-4.3217629059253317];
LW2_1 = [3.6170218315919622 2.2684108378346295 2.6644542830971494 0.11518064141575861 2.3863735097817935 0.36981483488468481 -3.5704716741377469 0.9233347339502056 2.3029264182312712 -1.8745101593778957 0.27942814319457182 -2.2930354086571807 1.1174359945804642 1.0422414264046791 1.1404562933084637;-1.062445092071999 0.010744747461599698 1.010019911931042 0.2618924125365838 0.22490492049835661 -0.23860762882668865 -1.1962006161028254 0.037102412873038795 0.57246055704635213 -0.45551536206996251 -0.32036687238744471 1.2970863673668513 -0.051824430300249837 -0.31858485512141232 -2.3982771546221673;0.016579037145558678 -0.038627745760190971 0.25487423359886435 -0.068939220950232388 2.5810883540217486 -0.31680500860288591 1.470372387546601 -0.66239397470792316 -0.77671958507420913 0.2443589346698205 0.35040534179050215 -0.53104327615550717 1.5191780846661902 -0.16349715602824647 -1.3094070266027185;-1.0640181802886366 -0.00095067276071238334 1.0231530628640348 0.38723177304025502 1.3286931982084527 -0.25775938142913901 -1.690779284782729 0.43996226891818307 0.2177272898108818 -0.44314045827960713 0.21065594700202736 1.3417747065670516 0.71284336754340338 -0.18404963100371932 -2.1948282439282463;1.1298394660708642 -2.0164188445100426 0.1316540028203193 -0.6864546396848048 1.1659495663144326 -0.2645491464017572 -0.43238570042673191 -0.51952558805442095 0.69576303516017146 0.0047398705013846285 -0.690062963618852 -0.78723279726260709 0.7199364649795077 0.3688247829438544 -1.8090541870695895;-1.2893131268363269 0.66342912355039885 0.32642542123417162 1.0020150717559622 2.0367098130316643 1.4653256033713509 -0.35938286026853122 0.70642897444400887 -2.4343242880201288 0.97650134307758685 -1.2812866334784325 2.6564701452693491 -1.092949952021494 -2.3986569754135494 0.93528471013980741;-0.83170166718786454 -0.21519190650960041 -0.60308483225691545 0.7757914797219555 4.9136624986116928 0.4802272148597207 -2.8024726541505949 2.0605471591320992 0.72867675055024028 -1.8292037832588599 3.7460291103580756 1.3698883317409634 4.7198807895775516 1.3315429971811423 -0.19720597189360672;0.85666962171762007 -0.21496035547058739 1.3485099956609115 0.66050815425510523 -1.7394696790312358 -1.2909394303975903 0.36745946322647949 -3.6291289155654227 1.6803590360238887 1.4181517608978185 -4.025880833216533 -0.78116542877480555 -1.929689519579596 1.5812713326000769 -2.3098257083984;-0.46629538516224528 0.86244059353886648 -0.93330016736675769 0.59752028765458609 1.1120365398267611 -0.044313058154936413 0.23978281536354693 1.7063699122179581 -0.64420065271325744 -0.10031548641809304 0.52391090907235605 0.52690332583254318 0.58529328817252413 -0.121977543698086 3.0174749858742027;-1.1335889087016069 1.5919962495000541 -0.33131560755365408 0.4994891706107531 -0.22799043205819319 -0.058012641736568289 0.16264836146698436 0.13895376867907688 -0.56528707025461311 -0.029019897502289872 0.33934824200510821 0.85779252849034082 -0.20394794916730638 -0.43332713393251987 1.0775703263467264;1.5808153462684997 0.29759354242946962 -0.37272631059560535 0.60444479942279927 1.6919658965722026 0.23385629846769865 0.89764950919066511 0.83596576016846247 -1.3937417173713562 -0.019027448309980238 0.023712615506131761 0.00066645315676017863 -0.52832975257190784 -2.3579186018005132 -0.87231648975187182;1.3109925382508349 1.415814460681748 1.1396591391051425 0.21379138577263668 3.1592852357436287 1.5711427791819463 0.082903953892448298 1.3527241811350925 -1.9389413543777705 0.76827792903171432 3.8087566272335103 1.6689681260964604 1.302330145316668 1.4275428669974686 -0.17822986293072757;2.6201628513481521 0.1259833672513517 3.8702064292772316 -0.016114851031728258 1.367483713947383 2.1888659250352243 0.46405710730282856 -2.2187802845284366 0.58727804791176175 -0.23858797894712319 -0.23306034057472513 0.65031070985163808 -3.5338823633212049 -0.59230788642714793 -0.63539367761576582;-2.9316844729068738 -0.86533217236745386 -0.67636625895956315 1.4080132403089147 -1.736850854878891 0.24825870185869575 1.4027200245340543 0.36265537144190274 0.10564349151568153 -0.015385827155440476 -0.37769027694564461 -0.29328588961127733 -0.36608632080929604 1.3388113079988626 0.71562541269771618;0.045736914525725716 0.39679953951211483 -0.78353901454812336 0.28313482526858086 3.3707929563719299 -0.16713833980652482 0.36362165830896442 1.2539065310283188 -1.0994211001221552 0.93620592032433303 0.88930861174701004 -1.6824407886840171 2.72409552669244 0.57545222501361348 2.5934961621780315];

% Layer 3
b3 = 2.0940716191385462;
LW3_2 = [-0.15275005143970846 2.4331921628898456 1.9641658193747056 -2.1670976744059103 -0.74497878408486662 0.42450862196349765 0.47704201286704695 -3.7787544728247497 0.54536720547276363 -1.1074724721412657 -0.29009604772309161 0.93843778926567001 0.17791464762072864 -0.32851518851416028 0.49062228602901037];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
