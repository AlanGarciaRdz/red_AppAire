function [Y,Xf,Af] = NOXCentro21(X,~,~)
%NOXCENTRO21 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:21.
% 
% [Y] = NOXCentro21(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.74531835205992;15.748031496063;0.00773694390715667;0.0203458799593082;0.00627943485086342;0.132450331125828];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.6091147922784415;-1.2720255168542502;-0.97131509638043634;0.52838356034657286;2.859797274726513;0.39829755478506057;-1.5345061025898301;2.3944162699959017;-2.1173153831743816;-0.25355022100950192;1.5412118157569636;-2.1164573476646797;-0.33340427276932327;1.3310299969161377;2.062251539697515];
IW1_1 = [2.3966910886089967 -0.37177914782647437 -0.85203402130550165 0.61836214430622671 1.0137535377417624 -0.80325956184206082 -1.4035391711672576 0.62066684337316425;0.51691064288100708 -2.8174308641162775 -0.84395381740570607 -0.41626524115921604 0.28087378715672767 0.78145949881138232 -0.24258889547658297 0.062123683893710105;-0.070220752681736054 -4.2196653950102796 -0.33617937336360143 -0.40350760999262864 -0.52197860278752617 0.13052334598230508 -0.036144955174766971 -0.19147531752313249;-0.20536922659900275 -1.6356735238339213 0.24714088363918901 -0.78366987059220683 0.13628313163748679 -0.19410903576420308 0.31699263081397494 0.057226302023358287;-0.90858056609770121 2.4879992480490603 -1.3385730797259976 0.85056277158907301 1.208868323823554 -0.81970775158773257 0.3468881449475818 -0.25803416371486071;0.022691882959194762 -0.0028076658738540004 0.63750561459230282 -0.2829341171455983 0.72406808190658212 0.88837124766959119 -0.5767033623740746 -0.24373813643240075;1.2877883236110861 -2.0895415143085612 -1.032295389891718 0.93904299895623056 1.653311693455114 -2.2484709913101977 0.24297516550208431 -0.47045642097814994;3.691572697763331 0.95854903221317078 -0.22290479426622933 -1.9901953406437189 0.09166358625394691 1.2411377612165095 -0.24183673948006093 0.15304529378604007;-0.94338233964726292 2.7940806493970531 -0.35472012220449251 0.0085027615311615568 -0.33367809024496919 -0.86177273596713422 0.21898477433901894 -0.2531955481431975;-0.3499577273685785 -1.5274279550643421 -0.76698395129246533 1.141181765415145 0.92536731359260382 1.2845524150264771 -1.010367280517096 -0.12363641480907395;1.7161612896735179 0.13789083802813101 -0.41457854886381551 1.8422812291560242 0.095518190484976256 0.10353324048343077 -0.05223213184499282 0.22885334730290449;-1.2563134663079565 -2.7181022818223073 -0.27522169638851496 0.15524184824253143 -0.81887550422271893 -0.18651783551029966 -0.001587519156555842 -0.16828552225091276;-1.0348564803253133 0.46497653440086978 0.82014342521822747 1.2824949792754072 0.32096225581994875 -0.6062312694811931 0.92406034695026218 -0.23922483236851566;0.53534804456386675 -1.0379777737331346 0.63411162872440907 -0.13667651686955434 0.17956743822305413 -0.031332494597629976 0.21972506644692072 0.13080421317130428;1.2349241764803007 1.0585193607482783 -0.59346714794887023 -0.85164423056751393 0.45420106253108711 -0.80953671609775646 0.58306618599901305 -0.94809699858195462];

% Layer 2
b2 = [-1.9926573710672084;0.94952834666754371;-0.14714076608988066;1.0180787311547419;-0.35648017358736417;0.20795446213001567;-0.87615971464380049;0.26477219981489325;0.64748849284988375;0.56259565541964807;0.25820846123137298;-1.1570903380865614;1.6675965529086441;-1.2031113864712795;2.1138930577004897];
LW2_1 = [-0.34248804950884471 -0.64894476585850636 0.95893170540864747 -0.36638726339442634 0.1421302391346419 0.28365232583667127 1.0638875544833415 -0.63474368815943927 0.46499735620733729 -0.55536968593921898 0.8820801237615028 -0.5253129849802487 -0.53725836715701381 0.75286366381082626 0.045325014860902305;-0.41651480670345953 -0.39542194659434016 -0.078080350447572042 -0.22730766881880712 0.18199089491259479 0.33754021895614061 -0.060103576742640948 -0.52602478026409294 -0.91887243920539818 0.83420807481786241 -0.10995424666177023 0.042645903842907854 -0.64972447465618166 0.96092337017878349 0.016640923133399467;0.89400534704856638 -0.50753396131197859 0.57249770070673711 0.12830134091213152 -0.64606295476138353 -0.95001428102712604 -0.79182104945044085 -1.0354555354921904 0.073805312635762108 0.353765513680106 0.0072846754784466339 0.092903185658827811 -0.13187386636926213 -0.44349740934028575 1.363405630444374;-0.70321433800581112 1.0186383784120161 -1.2104551870120044 -1.7497473004464934 -0.6278197836028967 -0.98809473029479622 0.037093801775438376 1.1399824693366951 0.10208259938218495 0.31091526704519701 -0.22887874810656728 -0.54106584715250516 0.17856523207978689 -1.0485402802746875 -0.24023553853806778;-0.29492379466358415 -0.73197743723505071 -0.86566834331717513 -0.89048223886975508 0.3585123178140831 0.49973422540181045 0.2428752097343653 -0.73728921250383517 -1.074993730296343 0.41641764120312863 -0.29721062878951976 -0.81691887401808694 -0.59960293608211124 1.0081780247654306 -0.43013038670711223;-0.24257218373747283 -0.098575885254599482 -0.37829359823390474 0.083480618690151845 -0.57179477355451225 0.69977171972894636 -1.0407420552032882 -0.94828501562076128 -0.050453709016068 -0.4201360749438785 -0.74467308156471168 -1.1527376400633107 0.75450945068028297 -0.65940155275075074 -0.92348092150177841;1.1547542140656915 -1.1923145547743541 1.9660917946714931 -0.13439065610074846 2.3244089512848425 0.13891207617919379 1.3587184634562692 -0.53965827835508595 -0.32113739912083983 0.14323477049982333 -0.18049181602017184 -0.88217222938244622 -0.38599390769333675 -1.5090669071240472 -0.79949362011783454;-0.29780193088422169 0.73383978108876258 0.081270867328407756 0.83980026938142416 0.23550353895330661 0.048461161033617757 0.8295193687347644 0.67556155445396637 1.0627367292925882 -0.55948072132736992 0.5951421051008805 0.071956979564914703 -0.31454016810754165 -0.63482607559205695 -0.20265919388104639;0.058056639741382435 1.4974401333646878 0.9824048810651681 0.64585449034047282 -0.48837079789190185 -0.71225211261225796 0.72846122448611506 1.2492050576875211 -0.075711747787995901 -0.44442322506413456 1.6887566009573314 0.34480655542666327 -0.43755503979467869 -1.0033019714584233 0.8534025227583486;-0.71107698663222152 1.2587980490809847 -0.59154004139373295 -2.9482884287882487 -0.79506062095189711 -1.4669141028451698 -0.53072334878814753 0.48988226959388337 1.0892366724789848 0.0021573814854643734 -0.35169906469660422 0.97088800479612258 -1.2593653715581794 0.32502660909863967 1.4175840980834069;-0.035027156722312186 0.5789908236431901 0.56264133808843264 -0.021753856913764056 -0.25735205147014889 -0.74567012361575846 0.13018305723228801 0.6888639330700207 -0.13323675141788635 0.35747309236054081 0.95245048067158933 0.099684940085150983 -0.61469558715792649 0.13054146160121227 -0.056448489195225784;-0.77762767932701005 -0.27665642080811537 -0.48807320552583577 0.55231960305180172 0.27522670555190687 -0.11899943436678781 -0.59422546319565928 -1.0532191753110411 0.61919354070212484 -0.45515618010313996 0.5303192820623206 0.56165850646980009 -0.55704519822278098 0.36314859047451875 -0.0001476095292276548;0.96800027681460099 -0.35433882792233373 -0.10594560364010505 0.084268489795435289 0.66680312749498138 0.63929646513139871 -2.6906549482419004 -0.23780749971685647 -0.55233781907644286 1.6812204833914903 -0.28168196472507773 2.1400775163714929 -0.27658474923616988 1.757271198154676 0.36934868747482291;-0.66485222203456673 -0.072510220423270419 -0.89930546951470269 -0.91829761146139699 -0.27232675431500381 -0.071217341070218904 -1.1242908291295193 -0.47728448144472857 -1.4434636784970691 0.39801119905299681 -0.64744898872617529 -0.012161959001055083 0.35131332048630864 0.41067214875260499 -0.51739848184237824;0.31838863083634455 0.030619735805367261 -0.68413158066192892 -0.21274482527819163 1.2483087770384576 -0.67986852922976793 0.68607882412659715 0.74963748366290184 -0.12240711566565644 0.24335527897994674 -0.21355120617043641 0.76708078456812068 -0.44709506275254118 -0.81146414458858163 1.349949941183896];

% Layer 3
b3 = 0.85743362007780499;
LW3_2 = [1.1635085883004967 -1.2564165983286086 0.61749967595943056 -0.84402221100153674 1.0179188989813186 -1.1327670462558217 -0.45562690180504051 1.1739029519525475 0.66527747416910943 0.61229373301083723 -1.8974565892401174 -0.52198963423869649 0.57270094808313587 0.98877584824262787 -0.6323115938879954];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
