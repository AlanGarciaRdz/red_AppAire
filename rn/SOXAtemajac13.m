function [Y,Xf,Af] = SOXAtemajac13(X,~,~)
%SOXATEMAJAC13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:24.
% 
% [Y] = SOXAtemajac13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;16;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.7040475216824329;-1.7663808848739422;3.4245726621221011;0.14312120559942945;-0.17587448630073141;0.33096131570302356;1.8867462621961668;0.052509880793489547;0.34517404435359622;0.72334560343835719;-1.349721713877029;-2.4778676129159578;-2.1620077752012752;-1.7671756786734318];
IW1_1 = [-2.029731347860634 1.4555059654807601 1.1472720633968996 0.18561926793807199 -1.9905231967093515 -0.16451382504933582 -0.54328714541715706 -1.7558094504078781 2.2541667462793429 0.79449879889747066 -1.189149381935946 2.1424014769739723;1.428020342095921 1.0241098378190254 0.96568196984275312 0.36731867587788358 -0.68811710506903012 1.335011672790992 -1.1733505080969091 -3.8114982436349298 -0.51252735264297966 0.76859215204793341 -0.77296782251933571 1.3306437946651797;-1.4802846404536056 1.2220651903700088 0.89060782080344669 -0.20202085667670688 -0.75788361203558896 0.028238257331764008 0.64455974982238584 -1.5195167984387834 1.3483064546606456 0.582942410785253 0.13497671263526367 2.8376530281409083;0.063805415106523197 -1.1073356571766113 0.20941596438033633 -0.18258089161607655 -0.20523022244151279 0.58935282082411122 -0.27400735579683616 -1.4030034353305987 -0.64559013904944251 0.12661646405036378 0.16312540527405212 0.41225511903159806;0.10376503698756442 1.5230340668328257 0.18062626248502531 -0.026286566721332314 0.20423767454293587 -0.1221371582428087 0.5091864983550195 -0.47747879887411099 0.081129539399071179 -0.24184787894374557 0.77876256566094004 -0.31259324712951975;-0.50875121227666054 -1.7918683042503745 2.0220186687076129 -0.66760160617402697 -0.85959857719818555 0.62823591020981617 -1.2753424079659339 -0.44309924834942477 1.1369473623880875 1.2592320469315494 -0.91043255810289814 1.6457221166355178;-0.7919263434035192 -0.70014139033240841 0.2980907851403623 3.3585428405147071 -1.3630767685162946 -0.86567908208660926 0.73851143966668309 -0.780489321016135 -0.19976857755918201 0.41487791314547739 -0.26172033349786222 -0.98844936505094472;-0.72909778886450682 -0.32146600034939882 -0.38566826029642082 1.0085086067494282 -0.22325749130349318 0.91557316755377538 0.093507169346534316 0.20199510126564593 1.1056530607155519 0.088970915784814433 0.12540290506708815 0.41148266928106714;0.056476272104081321 1.8719859849614864 0.25907484266229747 0.74821540831267119 0.83551354145203538 -0.74250883338727125 -0.59874689514096324 -0.98560795940943091 -1.1709305816801918 -0.52217756785063441 0.2543900162093457 1.1055765307143874;0.067986244370760854 1.41499462117936 -0.29699800254467174 0.1199721321046118 0.33712240008817518 -0.37313859852182057 0.28023927176730218 1.2024537599808842 -0.12454295221624184 -0.20943035457767892 0.28409999786032836 -0.2598708308665939;-1.0276677692780811 0.32119320711983262 0.21333793633846132 0.4103842303674119 -0.29590472697637499 0.60716704373142671 -0.77210095838973625 -0.84650908368832578 0.22007595018798554 -0.018283248693943172 0.2409428844482332 0.016947307141479379;-1.681160608216953 -0.031411980715359222 0.41451680940540292 -0.70780286589003394 -0.54884344663334261 -1.5419220137230367 1.4718764695920914 0.043812390921852684 1.4344223980074788 0.013712889504274663 -0.39256064772277383 -1.4695190535122717;-0.15260359192097978 1.8033487200009735 -1.0733171829441515 -0.087574090003769048 -0.44324031621333498 0.3779064878878981 -1.4583405348576091 2.0068545659034633 -0.87396051066482749 0.3259262893090995 -1.7136818977359261 1.0613461195033491;-1.1966019304540751 0.40538005846312813 0.45519603162907402 0.97406828787025312 0.31651153597120613 0.096828295930428632 -1.3731701513295245 -2.1724047683684518 -0.56636031079016513 -0.83834613737807373 -1.2723820991795649 2.0440674764070028];

% Layer 2
b2 = [0.17393780348538113;1.2494869307280447;-0.25041739583280526;1.6450952887985384;-2.1530664010318032;-1.6764724022066033;-0.056146791163358141;-0.3107287023665618;1.0830191950358716;0.2271796386065402;-1.4000417744158045;-1.1016404156792248;1.2318526642913641;-2.6058751304639958];
LW2_1 = [0.82953888198076198 0.67346922619541527 -0.45665535342466906 -2.0105572858853704 -0.16696688067000109 0.6573941340060927 0.12307557483574173 -0.022214862623071412 -0.61052812316514338 -0.29330120778182883 1.0723413522893865 -0.42671704124196463 -1.1216714319999674 0.095111348371884827;-0.10465443655707925 0.05816313723659728 0.41599587925904907 -0.25777826828191946 -0.50024642664072039 -0.4715047020637636 0.24546376573574796 -0.65790418523256045 0.40906955980416859 -0.38432355463232543 0.75059716069443483 0.29235027669505947 0.6329135702011417 -0.4736563390010638;-0.47675945562122518 0.4008497181197162 0.87762515730121737 -0.73879029297200027 2.8953678062176178 0.14203055999650999 -0.47392417290925193 -0.052568189489265844 0.51914378134109185 -0.52648574263486247 -0.17802174657351827 0.19635770380097498 1.251543863136225 -0.016700561434581453;1.0341941491036786 1.0292422224674986 -1.4443927481077699 0.20504111436270936 0.49060995181927253 -0.17522551167979206 -2.7793226692397734 1.6788667713479704 -1.5925560554447165 -1.3647291873654228 -1.5793186631310707 1.8233562234735372 0.24449572531690025 1.7229943034932556;1.1075969363188396 0.34290814857201934 -0.90571382448416937 0.57803619401501927 -0.72918826028325889 -0.088219339707369421 0.84683079940575079 0.082795929071706881 -0.64003539749976379 0.6132888556198689 0.38893119210408317 0.74681201047316659 0.62371595316393635 -0.10890277226582187;1.1302724261686961 0.3095347515477091 -0.88833517455276556 -0.21494051569772438 -0.31434634158507385 -0.22535042471776345 0.77441462545288775 0.10439952499756078 -0.8307132055085803 -0.55243134377623693 0.37861669499733236 0.75828801283366931 0.76046197948098793 0.28462191794462538;0.95136644591050368 -0.315669848074421 -1.0245141470070724 0.68221849182077265 -2.8800458266308624 0.036827424587864088 0.54153912574649954 -0.068610149181935393 -0.54058403332119664 0.87873324271623132 0.45296910549500513 -0.12235066382586314 -1.051917855403725 -0.12132662309253076;1.5302542067529823 1.1995502429086682 -0.9810564922987568 -0.30385361144420325 -2.4747980349884791 -1.1439999014228013 3.5804482799087358 1.1798371420036884 1.1664879946462394 0.71533364984478454 3.1642281125971445 3.6067314075788723 -0.13730668081759634 0.86063199268149726;0.70719153942444968 0.55366659069876056 -0.0095484468521410942 -1.9280925880785789 0.67027734327862964 -0.22371345860916464 0.04580789595528114 -0.91714151924872833 -0.11523992797803743 -1.5750682920116517 0.86680876656647865 0.028704459062563345 -0.28795572494935417 1.345582190421541;0.7015719876747738 -1.5925648625490345 -0.01938571813603062 -2.6029761700291338 -2.1026329537886177 0.085961828420034372 -0.096037238626607152 -1.8984270400182881 -0.50044176850137501 1.4940526088235284 2.1494791954028667 -1.828596614771312 -0.35555920579382 -0.94553165828131913;-0.77004757693146608 0.65196637146899084 -0.73173493903135356 -0.57077370354056212 -0.83242886825779072 -0.21277951093128883 -0.39023895867944025 1.4628218936250335 -0.48822935769935172 -0.11317519626911932 0.51952963558095644 -1.2016578659093291 1.1730450397536307 0.53734962128977504;-0.46379078672922491 -0.39094860275479804 0.72827186562042479 -2.4914148499521911 -0.14435576740730177 -0.6472629702739352 0.64180257441334598 -0.21853703468719843 -0.84777865996420132 -3.1869583635424248 1.5682675447376397 0.0037970948028736356 0.5774104731630092 -0.18009364485507237;-0.23179993147038494 -0.40552662187544508 0.80929313272139325 -1.2915115414358673 0.017326194291351165 -0.62237349735002467 0.79666511130320261 -1.1110804704403432 0.45669489110417444 -1.2829181210293845 0.82512326314882056 0.19247461816734213 0.043615310652218423 -0.19751661739918619;0.64376784149582866 1.0310126515265698 -1.2052849418616056 -0.68574029645564394 0.29124483275501539 -0.31943929332595328 2.0727522913022982 0.4111024646465421 -0.21411490701207367 -0.23643437565144956 -0.025549350531490003 0.29427610843697999 0.013567213764784015 1.0139066729289192];

% Layer 3
b3 = 1.5203993216823624;
LW3_2 = [-0.25975291911267862 -1.6800764024858208 1.3315128488728303 0.6374997663498656 3.1341285768351703 -3.6237957101935807 1.3772522821651201 -0.17445494879748449 0.44437462544175138 0.34873501930653678 0.95815035509579549 0.54162325270877543 1.4882080715134984 1.1111737737095224];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 166.666666666667;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
