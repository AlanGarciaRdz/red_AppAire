function [Y,Xf,Af] = PM10SantaFe18(X,~,~)
%PM10SANTAFE18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:35.
% 
% [Y] = PM10SantaFe18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;0.00341273633199099;0.00632111251580278];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.656915286534602;-0.40029754770349735;-3.6685843131070013;-0.56805407789459028;5.9102064574277859;-0.48602090583269397;0.95189942326177301;0.75020582128121605;1.3989018747803792;-1.0859216027484606;3.5753558214127756;-0.59633851419150008;1.6118727922909888];
IW1_1 = [-4.1507815290309491 0.71042763950477839 1.6496897135006245 -0.79493352276790508 -1.6220979752041504 -0.033877066238084903;0.66128172406233676 1.0092735760700302 -0.790842729879499 0.067227212700089536 0.25480467949522589 0.11968044848542141;5.9686041561876717 1.1827887210265695 1.1774638295437276 -0.17799736169994226 -0.36260098906324478 0.024675668749798499;0.32629055725447426 1.7074922786925564 0.93327044346417809 -0.438783774879897 -0.86550173230795913 -0.12258166283258565;9.0387062997535672 -0.050825482339291794 -1.0830266507102326 0.10854504629434335 0.15220062820438662 0.5308386418778327;-0.30657672974746175 -2.8824080426499861 0.7938564118515834 -0.14702971123580319 -0.15808993499892718 -0.12187004424583628;1.2121830154214113 0.48108318177668996 1.4993417429546101 -0.88999011623891533 -1.1403266415424591 -0.37423559025450459;-2.8148491111266547 0.38716854706523912 -0.86283805793434709 0.45258001428388672 1.9161024494134273 0.034163916288374931;-0.73381546223627125 -1.576317672923105 0.23008677823307228 1.0881612362695117 0.9865944900455238 -0.41044661548263178;2.4513217414177855 -0.87449775810963015 3.3157094932788689 -0.43650507193266219 -1.844025450213989 1.0615359545048224;-2.2003156039826384 0.25417233442998555 1.6762539426150929 -1.5066504897639634 3.3397537041117564 1.087487167334537;-1.9633781773314596 0.80787356682802103 2.1312735610511888 -1.6687821496631974 -1.9176542880128471 -0.41606200090093021;0.31627961825182166 -1.6928556899217644 -2.7766764391257217 0.3557166633218326 -0.27495637829140862 0.92687930703060528];

% Layer 2
b2 = [-1.8790424234119536;-1.5166283190484431;2.5213301638261041;-1.5861980615911302;-2.7351462236356014;-0.95397268637287713;0.21602123973089987;0.74603341054093453;-2.6673563040718209;0.50078443659423388;-3.3649119924809452;-2.9183454237265734;-2.1676978509234983];
LW2_1 = [-2.8248683583868539 -3.3867589814302939 -1.9586415290699173 0.55540467256457027 -0.2333440964603927 1.3133387566194108 2.0114329127414163 3.1898836679300602 -1.5396517115505877 0.73145617285855702 -0.75998462536141442 -1.4988794553881841 -1.0837487868114972;1.0340724288925789 -2.8059511865757312 -0.58661164123383935 -0.91048755611083076 0.35701737622338348 -0.65508843776888082 -1.6084822181872396 -1.5727678122664444 -0.31492130491826054 0.45641664314038199 -0.49814738624504012 0.98590252765245789 1.8119851096043498;2.106957266549851 -0.89292478880572912 1.8999587512620086 0.44212070785081309 -1.5154588373675011 -0.58414866754038419 -3.2901234227589264 2.541267642467663 -1.552836450830599 2.2434077839428359 0.99595301239158607 2.4899368083863878 1.3803269979008583;0.17848683384020836 -4.2253845912434631 0.77037998880243852 1.8367602723312877 1.4787905806052382 -0.48672495092441131 -4.6005722771068545 3.5263697812647261 -0.22760032899295099 -2.0467304052970188 0.70892175655922895 2.7872134298412004 -1.6618651682039141;-1.8059752526559247 -0.98914932932127275 1.6793965226819678 -1.3679137569350412 -1.3760092973444089 -1.2842242233038648 -0.60147801295146575 0.24052464275803409 0.13830534519284532 -1.492998465696981 2.2226254438944624 1.0469544074564876 -0.64558367078598433;0.38080360650036471 0.4754008330306933 0.84605768600444287 -1.4426573547784802 1.3679052013974564 0.58564455202421906 -3.7364078079370926 3.9511858937198916 -0.19397007785331952 1.3271481223084063 1.5578745310164464 3.6864956391971582 -0.97304287830736025;-4.1945889307035333 1.3001812392169418 -3.1524752224007004 4.7837638881103342 -1.4719722565050621 -2.2323561790633311 -0.13452895922385572 -0.28558678145475463 1.6401563129683006 1.3741195967969966 -2.0983516977695582 -5.0606526233006459 -1.1518227456331669;-0.32765750399656673 2.7943406010040035 0.5594458401099941 0.55239848301862826 -0.31192742699728399 1.5899178968434209 0.61599184909497229 1.128299133565754 0.18830951765988674 -0.25632033124871678 0.31212123934515962 -0.31310573125365582 -0.11355286050010549;-2.0131739351496698 0.50780153742710843 -0.10549389904724697 0.48366484283062161 -0.42451998355294318 1.5691555423230164 -1.0891377822320687 0.4153519007989091 0.37502872036690027 0.91676005160585716 -1.277623393173287 1.1594231888554862 -1.2231656833243045;1.0367441979038672 -1.2341283206848475 0.099035835656485549 -2.0367892322062668 -0.21074058434457965 1.6184915597889837 1.7929323477462171 0.066846385697148888 0.37197775128246485 0.10594143885756549 -0.43821789574525288 -0.32225813789193586 1.6670787653534422;-2.1511784159133764 -3.8738594470387149 -1.5183921323934406 1.756341525814205 5.5260420260729148 0.37744359576250169 0.69389690541664351 1.0628468717305211 -1.4511837297646624 0.68335114727266788 -0.66591320264725384 0.13018502492895101 -3.4041042489770676;-5.0306780171086549 0.67658695044141659 4.312347523911308 1.8296674326331601 -0.32812183656491828 1.9098515041884228 -1.3046696247735705 -0.031595732047756425 -1.2584250781183517 0.56556362914768077 -3.306070451964739 -1.6273217617805327 -0.59622219108052321;1.3676304985165215 1.5557084359769933 0.25817827826591516 0.90627240467269043 -0.74690779048426492 -0.7084931279930492 -0.72264653787556388 0.10568000176718975 0.925404885430268 -0.029980208855819264 0.83760334387979152 0.85527119570205956 0.12677639513832678];

% Layer 3
b3 = -0.74619922693544749;
LW3_2 = [-0.58857168118568526 0.3040767347424651 -0.067867413122802533 -0.28991251244390193 -0.20864588489797187 0.29934462602053907 0.15675447016675795 0.44607588289184019 -0.17287993429509776 0.29498049626240447 1.0811623878015491 -0.15555292667167706 0.26139861505367379];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
