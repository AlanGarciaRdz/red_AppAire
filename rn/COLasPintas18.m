function [Y,Xf,Af] = COLasPintas18(X,~,~)
%COLASPINTAS18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:02.
% 
% [Y] = COLasPintas18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.241545893719807;14.7058823529412;0.0179856115107914;0.0558659217877095;0.00576368876080692;0.212765957446809];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.981042151879528;-3.8354807815734864;3.8271652890245758;3.1345044740733869;-1.0896162801067435;-0.12727267121393371;1.0977790874266589;-1.319978007625924;0.22527379194291869;-0.39770354506256039;-0.0065181574790512649;0.96655386021088829];
IW1_1 = [-1.3909078283699658 0.89734098571280596 -0.38307533536935812 1.3157571441623004 2.2370635574167617 -2.2149945112429603 -1.1163426153902092 -1.72083028671926;-0.008882765895026859 0.091250798707797592 0.51769139432333178 -3.1492830876930347 -3.1540671720237845 -0.62585899385212274 -1.2147672317087692 -0.44973502890539518;-2.3870371397328398 -1.0806742086894392 -0.2152127572791934 1.4260045918061033 1.0253421937613973 0.78965920009086377 0.12423504839620195 1.2425247465941378;-2.7308013386445213 4.1089495158147464 0.27844031170311739 1.8557806854345518 1.0786751911522277 0.57161485337054452 -0.016750873538212988 0.80157762231703167;-5.8688716940712062 1.1739446410501775 0.44884940127276007 2.5488004917584348 1.1838678184112212 -0.76935765567058279 -0.32918672277811428 -1.0698729577189405;0.33824334357798974 1.2074527525549132 0.012648668621949763 -0.35105947176619362 -0.45735455915061513 -0.59854299779648135 -0.030544907225245208 -0.13019540923426676;0.33526478537127669 4.2080543040043583 1.0225030687317398 0.51592678299219208 0.62598966439982084 -0.010554759040254012 -0.068590874807890861 0.30158608093272748;-1.2211031799654373 0.084943988946836371 -1.264683734422922 -0.83410460763276095 0.63681062456275539 -0.8980024036517531 0.11820450525941086 0.13192814619980597;1.0441802651356569 -1.9113746226925152 -0.84772209200595716 -0.47425206885709981 -1.3223618536397135 -3.0786076716170805 -0.034557850542026737 -0.81429659101761565;-0.77080728626105788 -0.71478455723114309 -0.77717674319113772 1.3125071361063021 3.4469892881952462 0.96979785145485742 -0.27419202211694543 0.47830614120295162;0.58056953857621874 -1.9273823828473282 0.13204491970651522 1.0089347253710661 0.86100686752249256 -0.45199972885473205 -0.20777056172092773 0.63108764800875772;0.8948151912625294 -2.0564806329433081 0.17472338018005729 0.31579377983379736 -1.6986421860141752 -0.81393420004413464 -0.1387471166657431 -0.93522855017604878];

% Layer 2
b2 = [2.0678117543623391;-5.2619170223593272;1.6415156785705374;-0.23507658361282974;-0.19493758722801055;-0.1840349809801724;2.124351217930752;-3.0592717905260742;0.37968753778274572;1.830682110020625;-1.30844161243257;-5.4590623112573073];
LW2_1 = [1.3971990087114112 1.2562869559912486 -1.1586943303440809 1.4253629604793225 0.040495854526303901 0.6925986105504095 2.0262894996672007 -1.274455325655985 2.3058339120290245 0.041591530825741838 -1.4989358235775954 1.7465975475942292;-0.6257847138206768 0.51933641882299253 -1.9500946369666783 -0.119764193097215 -0.67120833329964635 -0.33627947099917804 0.50657139451352573 0.2628044732966785 -0.16929729976950392 -2.6226247548406918 -0.24564813871921506 2.4610863057547552;-1.0384345275660669 0.47378886183337776 -1.3782844855065597 2.0092686142265985 -2.0961853418394432 -0.67348132167607222 -3.9219348651316324 -1.3153467320715237 -0.34556133505891939 0.9200625660058479 -3.5877846931800867 -1.6711622228407523;-0.05858730992915747 -0.08824783131243899 0.22483915034818272 1.1748011670677259 0.62047806560795005 -2.0172440758330876 -0.36026649903151475 0.37615958460336751 1.3794769060484497 -1.1061563280227176 -0.063610262071138624 -1.1656023458966516;-0.011212115401165405 -0.29639523787550559 -0.50154663562107438 0.6298803662525827 0.44704919500347318 3.1440752423234262 0.72915378142557674 -0.66329047053348966 -0.68669797396289345 0.23891912806467094 1.1870953781651017 -0.1848706638180036;0.47601867973963635 0.98883477228779315 2.8307377230607318 1.0092736833509777 -0.0047985813316778845 1.9373652703736846 -0.7493525352623599 -1.0694991350404806 -0.53353565954328619 0.27971599930782254 -1.6498017228024406 1.1033333498697517;0.28351226454987516 -0.46460726746738346 -0.8878253423516822 -0.82827179599427914 -0.76171925064592705 2.4639616321625706 -0.84227070899962675 -0.59948141616913608 -0.075601278340137232 0.67456777188793171 -0.99181149071629116 -2.1230464302316783;1.3047830533502236 -0.17187149014646047 0.43638967941192841 1.7356829060522818 -0.4907027129058299 -2.5420520647157043 -0.99811363060246994 -0.067730705622534415 1.5354052039749777 -1.4820227734209772 -0.3106293514470978 -1.7061168457417228;-0.067944061452798549 0.055953478613891848 0.17397711369773494 -0.30852273401245056 -0.36237076755597802 -2.6288927128685069 -1.0944458665643677 0.44552358706679596 0.64983975953884021 -0.10783115486739243 -1.244222201442208 0.12052187764926786;-0.37541234105081439 1.5360655179329632 2.7418170143694001 -0.046424836747578427 -0.56932251485760021 -0.66757071329905648 0.43715810826641766 -1.5324585942145421 0.024978494281903966 -0.53308548839338699 -1.4406108588452995 0.41767378971897162;0.77577921319142884 -0.52044424606345696 2.1574107344191304 -0.81527858192482827 -0.99007713265183417 2.6600830972462046 -0.16383851917088549 -0.36968547801450635 0.37809743090101483 0.66027305073644171 -1.0101484889065282 -2.3950897328000811;-4.3442441194776267 0.36565912252197091 3.2222219992997263 0.21937927065004953 3.864528193954563 -1.2507736444563609 1.1670619012956205 1.7188317526507586 -0.73389132617987229 -0.28311688773329419 -0.35844087405906228 1.6118030996142736];

% Layer 3
b3 = 0.25594632095721259;
LW3_2 = [-0.45994816525219762 -0.47797870478937116 -0.11919102050720981 -0.27158350973878603 2.3961713590625222 0.55949892426722747 0.55539144635473403 0.20107093285716096 2.4219740291027181 -0.64584156833201145 -0.49576076441261607 0.93671103047860504];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
