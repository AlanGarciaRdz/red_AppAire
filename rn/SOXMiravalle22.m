function [Y,Xf,Af] = SOXMiravalle22(X,~,~)
%SOXMIRAVALLE22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:38.
% 
% [Y] = SOXMiravalle22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.0208986415882968;90.9090909090909;0.056980056980057;0.0063552589768033;166.666666666667;45.4545454545455;117.647058823529;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.3620054527183032;-2.243731588752135;3.8195869105573599;-1.2078964247326767;-1.6991305345041685;0.5700179154383278;1.9978282826870648;-0.76788523784851548;2.0104143686703;2.8249299303193416];
IW1_1 = [7.2205848900627618 -0.14091986548295807 -0.38020266121495505 -0.69111168198285688 -1.4948536264347545 -0.52193880069589671 0.90523174731909362 -0.59474561993656405 0.25295847559492812 0.51386334894124541;2.3966912273806695 0.41775944548979493 1.2711772677116402 -0.77459571597580879 1.0911598332884909 -1.3939422494155962 1.1963348843167736 -1.5737566087361421 -1.2233337248590097 -0.61709299831305953;-5.537090260924562 0.22732265876082453 -0.029726214408606857 0.60339859733025281 0.25559048570652565 0.28836418864328484 -0.456945148552099 0.4414133842495821 0.0010444677519270695 -0.36349732402018076;1.2237900718492971 0.41176242142714203 1.5342878058458329 -1.5675412610209822 -0.5097281182815866 -0.78477561437152665 -0.57298153299759502 -2.0586568760885058 2.7806810294715998 0.50243788675002521;2.2039006235976681 -0.17386328282411562 0.243097189029053 -0.01016631970579731 0.20443030180886443 -0.09907459002697705 1.0761872514355608 -0.84005488130146078 0.1201279313367601 -0.46647050555017922;1.8441509380640115 -5.334575759395153 -2.3726126939566132 -1.5528885644845902 -1.9324257971433974 2.9459079295141608 -0.47293576069527599 1.3492574253109759 2.2383585480890886 0.32003381658018032;1.5426478280065072 0.081130897657693754 -0.28231427217959071 3.3752040361062448 -0.41779296958356349 0.2542567913461995 -2.134766231105695 2.0119020597880413 -0.77712198707481739 -0.78795747816154837;-0.73868141894642103 0.35197288733823212 -0.0073183038826075044 0.66573624447687418 -0.45383485662898648 0.18578058704491579 -0.26832336257175976 0.40113181680898902 0.051787485529512137 -1.3359013876748822;0.4275759622410979 2.3276283995566684 -0.10023055206361182 -0.83943219787947809 0.91405771668213209 0.40529445599441538 1.2121714248450217 0.16026476634649378 -0.45684243559062826 -0.85463595208413246;-0.13432961240793537 -0.10900766905107001 -1.0297145969886532 1.0262201168291294 -0.92306937127765432 0.13125548015179736 0.21659286986645387 1.3792338713596448 -0.14746211031389056 -0.15098057373912888];

% Layer 2
b2 = [-2.149862701307391;1.8891134327998935;1.1928840261802143;-0.27494181477874979;0.48815987423244656;-1.3621254138341148;0.92090909171336299;2.2355326100638861;-1.36214566561938;-2.320029480644211];
LW2_1 = [0.82971641559289511 0.20974509134471153 0.5504776499697227 0.18768871259527592 0.59447221655105242 -0.12213428466706241 0.27217038909319285 -1.7304083906597536 -0.4142434140855637 -0.24887408736848107;-0.62226937958654649 0.17744614148693694 -0.21265363143024685 -0.028914655725314348 -0.15502505017635343 0.61603913795699417 0.79340270211712505 -1.4105453261662759 0.49546961957490487 1.7003655621740565;-0.21967894463439705 -0.84555254838639016 0.47631998055872282 0.1458231736375202 -0.68295105750799179 -0.14130522756919978 0.13616473591655578 -0.094114940265547037 0.11941943346714859 0.59294281747998756;0.67238809379324482 1.2140034130308013 0.78752446387797603 -0.41023569204460458 -0.45334947235466816 0.16905013742804917 -0.49423089217872251 1.2843738976158199 -0.18892236714812971 -0.23343559903312319;0.60603688475115891 0.87095620159324083 -0.40187759225647135 0.76085562204284041 -0.9599847281940932 -0.033698710403739687 -0.69822338020619024 -0.13088337502868644 0.28879222893183509 1.0017303069343646;-2.9616670931210369 -4.3150498792463994 -1.2792172670181596 -1.2296785938160921 0.37624972398462841 -2.7938759889062936 2.9988028571169285 -1.6469659959350078 -1.6166470966517574 -2.0599807410252957;0.32841524242121134 -0.24349861501514519 0.59978754763797604 1.335122436881887 0.57716706156796549 -0.19714467020477494 -0.26836698724108465 -1.2194055078659682 0.50397408201037208 0.69481088975730343;0.97343257903736957 4.3102332135092736 -1.6748399390015292 1.2408015596034927 -0.47336509545273725 2.7985248859511911 -2.9929540661314404 1.6015031184028636 1.6078877851716848 2.0812265515410231;-1.1761710687730136 -0.67874949682883323 -0.58201901533815881 1.1966341651239629 0.80921954544996588 -0.093114494221989197 1.2542589543342748 -2.1046168393777345 1.039785072352992 1.0499118087621322;-0.48042577897569483 0.60698530456319288 -0.35130118191794751 -0.2603046275585939 0.3166460774296721 0.05446714605311466 -1.0691861728371383 0.36283789878530132 -0.8232998281770908 1.2287380788319826];

% Layer 3
b3 = 0.15045240115974476;
LW3_2 = [0.12772822920387733 -0.51299026284180949 0.087651666048536608 0.069482673036522807 -0.12153457149705316 -3.1070815240088434 0.10067972733562998 -3.1131504246892336 0.060991272823512577 0.56630759860318292];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
