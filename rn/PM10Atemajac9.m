function [Y,Xf,Af] = PM10Atemajac9(X,~,~)
%PM10ATEMAJAC9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:56.
% 
% [Y] = PM10Atemajac9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00968992248062015;166.666666666667;0.0561797752808989;0.00614628149969269];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.540273868018941;1.7344898525281141;-6.0525681718725508;-2.6614515994440664;-0.014110882851864367;2.5214471887065009;-0.81004325616096207;-0.09459713688574059;1.6839866045120053;0.27509753862688452;0.92509336106465234;3.0973340768654127;-1.6825876275967122];
IW1_1 = [0.7885719605355711 -0.78620076639288106 1.2936176159106747 -0.19824626505618392 2.1936569997646784 0.11637180569908279;-1.8461050296330537 -1.1179701647369726 -0.22218855470297003 -0.013620712399629717 -0.0622009583212456 -0.029177818749028108;-0.13227457822321284 -0.099968666066998807 -5.8551405902072489 -0.39941396121490597 -0.68043536115822145 0.010537251817091356;3.156413769203755 0.75322840633081733 0.2569908717503509 -0.36568226525965308 -4.3082272948283755 0.064456264693189574;-0.025032266808800725 -0.59964920803977317 1.6598559243441553 -0.53493909141580476 1.5468567315196031 -0.95594113141582449;0.21765772938976735 -5.0292789993734193 -2.0786269250702247 0.82702598097497826 3.1543397532139688 0.51848838942565323;0.65454260135214937 0.25010038580389682 -1.0753165807897362 0.98815421946475146 1.4781114660587937 0.12439549515723133;0.59934370445834506 -0.50714841495450091 0.54433522210629071 0.060392218743634624 1.6827356628000218 -1.3612636866528494;1.9788067452605114 -0.0070794581904953663 -1.2552272085347518 0.33660066122104088 -0.61232471920597453 0.21655384985302029;0.98208211003324741 -3.6334405833553407 -1.0630722171936042 -0.036586405791390109 -0.69116230466909878 0.49875685969093353;1.1285021050853616 0.047154193793233767 -1.9129597264850531 -0.14316202291433344 -3.4366484756872784 0.44289354015184379;4.4196849749802878 -2.0098156641995439 -1.9101377200240854 0.46653888658011716 -0.10625244740775183 1.1035437370122709;-1.7475605995656482 -0.67648193012333457 -0.085499227323944549 0.41263909870923837 0.90581653530172179 -0.15080991873684577];

% Layer 2
b2 = [3.1376005112429719;-0.66956176339667917;1.1984836066731921;-1.3077019171657507;4.1358919272977746;-0.53474001936710891;-0.6544725355943698;-1.0916159117503292;-3.4549146985252137;1.1316498264827206;2.1916383969284752;-1.1387853813776734;4.3324051262660408];
LW2_1 = [-0.22148617012308758 -1.1477293129936519 1.3886879591538981 -0.095167929541675356 0.095808352821073056 0.38744425256569431 -0.062503227946841849 0.03487891948268966 -1.1084947149438331 -0.51038695141740054 -0.041619877400821986 -0.043327217239158639 -1.199015017722856;-0.31332054180875674 -1.7540022719149964 -1.0695909405731352 -0.65365663232335802 -0.69353370326959951 -0.40777269087548673 -0.35772172594918467 0.69355934724065704 -1.1921132929587352 1.4672055613615966 0.32818733608729184 -1.2039872819902433 -0.2003992393622058;-0.022397134401509953 0.22039638588544047 2.742880127870627 1.122732017038006 -0.38260282962006625 -0.21275369793674298 1.0775728639146367 0.46983938845009593 1.8118239884992953 -0.83555745181210772 -0.79610727779796886 0.74208827065575611 0.98241627817649946;1.4888240119059484 0.13903991091715698 -1.5709058762006474 -0.39976338179814069 0.64522792244920624 -0.97753636601325222 1.6733556373428866 -1.1494173918390622 0.41698375909791863 0.12100006103265569 0.28769741350542416 -0.89072854833769877 0.72330023563909462;-0.97039581195567393 -0.42307267651350433 2.8049472833578535 0.23854241327802672 -1.7609246776449055 -0.83786640068899709 1.1368944936191527 1.2980362382705453 0.054170926195149877 -0.24429255643562137 -1.8125532577595931 0.085374795734318915 1.5050801176631048;0.15367482135330054 -0.31696231376342182 -1.3928504525966077 0.11423879938542211 -0.36409591903343258 0.45422212907721243 -0.44802776244353532 0.37314599746138516 0.6145293004538499 1.4167766778546216 -0.89388907910106785 -1.2249488885520052 0.31077841047543964;-0.85232819176285457 2.689300818032343 0.95440386777586339 0.06199684749353928 0.22932862448616903 -1.1140052653281034 -0.4100723703187194 0.62014391056144091 -0.61977460716768051 2.1646421991580445 -1.5657557578417058 0.51833844951536967 0.98051952346341298;-0.55469899314375193 0.26866052849373639 0.56832270561715481 -0.29056361346835458 1.3265694991621564 0.092411148642939089 0.78631307401636641 -0.41163673313442967 -0.49743456920829665 -0.95976034400857657 -0.34679351376159862 0.98480291064835734 0.13072935820706591;-0.5805497128546141 0.0034268185764300615 -1.0467700033582239 -2.8807042144000512 0.43109217926174392 -0.2633398113935066 0.59904298380454102 -0.23131693674871268 -0.53782376073516869 0.69418443839451216 -0.13586622283269459 -0.75044075814716682 0.64244260920456553;1.1851826934124154 0.070030116406765583 -0.18903206318930624 -0.62897403031720744 -1.1169225591969694 0.27172035082883894 1.1546456882273606 0.85065155933077208 0.52006738251442308 -0.86212261422104997 0.30010767776000663 0.54641500817582234 -0.97817390591535724;1.8398441294084089 1.4293959218024623 1.806515020806124 1.0857963016571082 0.38599856289054879 0.49887170646101164 0.41551002388716002 -0.60838158286394806 2.658557350019676 -1.910200766803184 0.5443731318033127 -1.0580304688897224 0.33453411277781042;-0.22093354125966053 2.1345960975580724 -0.062117267013134789 0.60787239398534199 0.50894980542473667 0.44205901045914608 0.29210947929499148 -0.33490737265494325 0.66248917067786139 -1.8696804506834097 -0.44290045099324277 1.6848674334988676 -1.0566901086092446;-0.88125073947159649 0.24538317645368105 1.4862102482780648 -0.3604154981149752 0.61252901364589241 -2.2042955109124609 0.39642517521209109 -0.31844778357928621 -0.72080620198096546 -1.1717586396787478 -0.18129545404666877 -0.32389742874912852 -0.80226004839106646];

% Layer 3
b3 = 0.59943968969132944;
LW3_2 = [-2.0300093271672748 1.2048370976407061 -0.22606082224123578 0.73398183799826722 0.16264759622508604 0.98180435912350905 -0.1278230834321408 0.032379898743165304 -1.7780430469159931 -1.08773809927176 0.46688251532058594 1.0049896363817898 1.1066239506701308];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00968992248062015;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
