function [Y,Xf,Af] = NOXAtemajac20(X,~,~)
%NOXATEMAJAC20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:17.
% 
% [Y] = NOXAtemajac20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.04040404040404;16.1290322580645;0.0210748155953635;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.65539093991997555;2.1787884168436857;1.4890373605887823;0.5286478056812498;0.18342304191187447;0.91602612531951055;0.62389893982813549;-1.3157459219620291;1.5152925802615056;0.93490623953560936;-0.25400698495263668;6.3850272534358083;-0.87972532009163817;3.6163220999284329;2.5571272126182234];
IW1_1 = [-1.1943823180637771 -0.863455203172386 0.7257028807577478 0.34373718953749866 -0.61106954287240056 -1.9118616817500202 0.056832971083492945 0.58740956661232624;0.099840114941552024 -1.8736651679699667 -0.50276156436380059 -0.13901839134102034 0.28855012524865292 -1.2538682540099964 0.55954908190531594 0.17732553757351216;-0.75400745477433206 0.95002508404457597 0.48963232914494198 0.53418196509787264 -1.0335069860000643 -0.80933697718045294 0.023063431904680739 -0.62259057090218717;0.63217826976174918 1.2523117973016149 0.37000237030798627 -0.57555876661473826 0.61623820580008271 0.94712474641849098 0.040264831247488121 -0.71557383480325942;0.61682358425205608 1.0102597532801521 -1.7188124781057366 1.5760093511511828 -0.25094621087680269 -1.8652481270274142 -0.28556395491016079 -0.58217156435331907;1.8043743691168612 2.8441333988797743 -0.24333949888645962 -1.18635593520353 0.66728512006789187 1.1739891692839792 -0.19920593505654377 1.5245067716902725;-0.12846439029081944 1.5840463272680363 0.95938469290075479 0.28104545259897667 0.14361765833790907 1.5887665283007997 0.22099592505336674 -1.0585110079707067;0.80718690737340915 0.81492481032918007 -2.4097752486174646 -1.851251759787456 0.29236790382025879 -1.0846443284453366 -0.52391305199956517 0.27227040020883903;-1.6554173411748021 1.6813493933898671 -1.5257113801463273 -1.2044731468697298 0.80541610765682214 1.2132832887315343 -0.3114792166215935 1.0923925330145816;0.67872281773259002 -0.69607952720118083 0.32343035587036839 1.6171116770350262 -0.90977507853375761 0.35495602049823433 0.11816662824777645 -0.24507668565358925;-0.59905265045015643 -3.0365131949259094 -0.50311315903022424 -0.39119571751159371 0.54245619849694859 -0.44864035200058183 0.013489401948126126 -0.27565192762090851;0.36063358118113259 0.39548716141434925 5.8123798557409634 -0.88692730774422046 0.68669856785117267 0.403033112489037 0.045748973301493544 -0.077527136300859986;0.38492171251539631 -0.73457637797496256 0.5980962762692752 0.45155724276940318 0.17903988615429683 -1.2407628071017733 -0.025249072454750283 0.93558429997900461;0.24643913530634351 -4.0742038436313095 -0.37768707539506696 0.19499585978958037 0.20310874027123996 0.53852577542164459 0.55233315354182277 2.324348596139704e-05;-0.70946832986738328 1.2570056535349616 -1.5868065657288015 0.61577004111853562 -0.17440046247573529 1.6321016479730204 -0.45193317249349657 0.48729816097426798];

% Layer 2
b2 = [-2.0298999006438043;-1.6389628163275773;0.51735018382276432;1.2107783559444498;2.134428591653009;-1.2385727399544986;2.1894001067886011;1.023438841698211;-0.63205938203910628;-0.87308543022230312;-0.51218421870094011;-0.88389447753484207;-0.77811768355928324;-1.1559653459128432;2.9911266124669771];
LW2_1 = [-0.31968999781526541 0.083857755882017243 0.35324526759337654 -0.92108402620496554 -0.12055128089348376 -0.20986607748736183 0.11377241375280461 0.72861916815583916 1.0414118595588699 0.62158792892798564 1.4636010818047311 0.56633579810915624 0.72106355168750225 0.12701484966010904 -1.1027037265482715;0.89963030140519973 -0.74141346694574517 0.023456036894321169 0.54331459451520603 0.095505911909444963 0.55811219366813636 -0.3792873981326364 -0.12802831506337317 1.6726128106004323 0.17976217757940291 -0.019190342521349806 -0.25368270471159682 -1.3192714838889499 0.37386532955451945 -0.73781969908715339;-1.8540623373789589 1.2217977830455959 1.779844236488437 0.19233275626346044 -0.41504689539071454 0.39587658481721655 -0.92596539199366967 0.31470374692657099 0.56755136193435096 0.45474922484906954 0.47799372153538666 -1.7692942630824793 -0.84234252678949229 -0.81467512853373603 -1.0837395743263978;-0.35636128085408181 -1.8954016678131775 -0.31814777578146958 -0.41490206029226695 -0.71674286232012308 -0.3718538509717505 -0.56970685541365407 0.58578701118227916 -0.49391727037528532 2.1084051782717017 2.8286177426942891 1.0522536574302832 -0.70287614118342823 -0.19308232130684996 -0.27761611299194416;-1.0196508219084039 1.0327586716492265 -1.9225773807306095 -0.2656200526587662 1.243434801361277 2.1025630286498909 2.2825433811512448 -0.84731419106990125 1.3554828096219795 2.2113889952672134 0.27700319357740355 0.78836476600488647 -1.9269966041928956 0.65593678509497366 1.5083402242259354;0.030100657307549107 -0.26048920322515168 1.0761501163986942 -0.73525044850953936 1.1741159703404087 0.47293687165901716 0.42109942288249541 -0.51942091042151517 -0.31224152510617431 1.9537584160580672 1.1568562668203257 -0.36891628914232732 0.077448724329708674 -1.1855760829060626 -0.8635744653036751;-0.51862013693735598 -0.65078822354235943 0.20383973870784353 0.52840426668810225 -0.20145773134809719 0.0064160520759832512 -0.44997724824572083 -0.30992456511484212 -1.5933254253104305 -0.18762621282213485 -0.53837558769902094 -0.45003073589315645 0.12339664004472317 0.48908426616733885 0.71956733373116077;-0.53377047906440922 -1.0764002207778538 -0.21954851508270637 -0.73157288989786085 -0.73768439433304367 -0.72776530651045535 -0.46695201059769381 0.76964498973997097 -1.3679113102101086 2.2087565340698645 2.8509209868276444 1.72780712423321 -0.38182838843632594 -1.0702905696555716 0.83235599817279227;0.55773168152618435 -0.44409244233235273 0.11295148252054195 -0.16928733778233615 0.3194974642313948 0.50852745367017549 -0.25147046136617107 -0.15054132018509661 1.0934229899659138 0.15740875986954816 0.16906482575367698 1.03938708372178 -0.41769167383098704 0.22514152821086611 -1.464577626672297;0.69610743279507259 -0.62469590129689656 -0.17387173852868884 1.0838081021619816 -0.12622832878770504 0.021164485091306369 -0.098319039352159451 -0.080936438684747217 1.1004205091629355 -0.02409143681692812 -0.23766252013626527 -1.2152019792058453 -0.33264209968092695 0.37723255273599532 0.020327990936966939;-0.28875515686316977 -0.058341547061083007 -1.2567710062255626 -0.15724822322149609 -0.8172925644682143 -0.065710633924049924 -0.60130336874530588 -1.2200286370422755 0.69880463517717883 -0.20140266517306393 1.1184671710798695 0.527415329557964 1.4274005130029062 0.89065595155548172 -1.3401504791355339;-0.14006573929206542 0.11504362373821686 -0.11707517487110533 -0.34643799505846506 1.7484547263436512 0.44903519581867318 -0.53424668014780774 -0.95777291496333616 -0.004281857825454316 0.86280228009018156 0.8110404223644575 0.45425068634805804 0.39765060701888366 -1.0973801964246306 -1.2939962678847017;0.31564453592374525 0.71438254700103743 0.75602754698322883 0.88405690743824639 0.54541961046071885 0.017921639979618469 0.27165729590137261 -0.083452938647713235 0.24946221072205238 -0.38046685932745572 0.86105400782123076 -1.7625405108932461 -0.21832508361715641 -0.3997671943829888 -1.2127451305937287;-1.57199477232209 0.75118666681163515 1.5927917868217967 -0.076286042748869465 -0.61746914333867142 -0.093787841252399307 -1.061516612567629 0.37416249527132561 -0.99414069680363015 0.48604213039961358 0.59189657370872362 -0.67413876694938835 0.28417691258974864 -0.88768554308370629 0.68353487086488507;2.0499714631377359 0.61108215368442798 -0.492730357889264 1.396125741057975 -1.6214800730013617 0.30832019369755231 0.3164647444859216 -0.63286949313705665 -0.048954376325941136 -0.23582783030150634 -1.6626604037763701 0.39686514768058695 -0.086181758451380791 0.25570422025767486 0.060134010178253247];

% Layer 3
b3 = -0.055145006585531418;
LW3_2 = [-0.86456332890352816 -1.7082002569006494 0.54928901389438123 -1.8606379976458831 -1.556046758850419 0.66814610943459374 -1.4652775126188218 1.6423522692097436 1.4761672128710954 1.6140364404043259 0.25119687487865699 -2.7485674004570479 -1.0498262408798957 0.60077881756383456 -0.95096748824513955];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
