function [Y,Xf,Af] = O3aguilas10(X,~,~)
%O3AGUILAS10 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:33.
% 
% [Y] = O3aguilas10(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;5.42005420054201;35.0877192982456;0.0561797752808989;0.00588581518540318;11.7647058823529];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [2.1378588247485211;1.6765456526371361;-0.5225799497105732;0.88597346655833509;0.41147741381619096;-0.9594833530026714;-1.2484833697508255;0.18084298215973807;0.44341726154773425;1.0978530513926907;0.37100937365791214;-1.3595113551681981;0.12925788137873362;-2.0872306973529775;1.5100868454125504];
  IW1_1 = [-1.2693299596493663 0.7665660831597414 -0.53568664556125889 -0.47462064304627638 0.1791322931910424 -0.59838149527862861 -1.0999102485577283;-1.9538745996338736 0.18010809724251864 -0.15368995796266602 -0.36188521516463623 -0.20592326230739036 0.15878024477059341 2.5390344269593026;-0.28282381641111487 5.5905315385961138 -0.60310293284434546 0.82889274324063211 -0.63531753737283347 -0.14768778266217342 -0.84202874743139466;-1.3693652296000645 1.6706084722940115 -0.16003325099794508 0.10638672514622276 -0.62949484195983851 -1.139969149810677 -0.2187874443525441;0.72751210565728219 2.9379270935720863 -0.18429048372550938 -0.1948200734271906 -0.44863793950495456 0.27056668384364191 0.95986877956929517;0.75770168020029105 1.1476488940301715 -0.15200694233690296 1.1741032643238634 0.87645831178878553 0.27092191768162738 -1.5009957969252457;2.1072073673186753 -0.048540286325150561 -2.6472399891746954 0.3087931203491624 0.069294020140840754 -0.17562911040288426 0.38998727775860215;1.7570338475867084 0.77580289025432869 -0.4255897788053396 0.63925878802256508 -0.43847011174761641 0.43234207355064219 0.27486652289322988;1.0486183092512373 2.5374927098427928 0.059667062431563021 0.68771702872098006 0.13144099639056056 0.30546071201321434 0.51380628690317376;-0.46855679657967442 0.043559595256164159 -1.4250706467563663 -0.44055793612981042 -1.187100132378035 0.76999466829823171 -0.13087193685752968;0.77822569721302326 -1.7772394711910187 -0.54074067004995185 0.10153324279486634 0.37253016586450488 0.30186351957219898 0.21857529085245483;-1.790055566481175 0.2626929464618592 0.011411566034048526 -0.06674955299819714 -0.06770070510515877 0.026859908387594878 -0.27112161139979168;-0.86840338986354348 3.4360041332756586 1.0419567335892226 0.085420037999930726 -1.643743058479147 -0.84918979745632217 0.20654434582738176;-0.70605627053618725 -1.17849983371044 0.024577086635899775 1.3399598240944659 -0.53383711430480441 -0.33123643467281 0.79103822352280195;1.2409846213301636 1.7309915106541061 -0.32544518951391904 -1.4287518131071735 0.65542998984825585 -0.77444540929753025 0.67686068293900259];
  
  % Layer 2
  b2 = [-1.6617651560035864;1.3738426125217278;-1.1612746467669164;-1.5516681591926211;-0.93738789891551555;2.0275875037509801;-0.3414660810159692;-0.44307162611895973;0.64396756071837313;0.94607720362211378;0.53640424429627731;1.0897083073492468;1.2566018193199096;2.2225449596555595;1.65466689862048];
  LW2_1 = [0.65658538173418179 -0.19803255663847674 -0.37427872882950303 0.24930322729518772 -0.50850185509390589 -0.33630351603184927 0.50794323920199225 0.37874618188412623 0.8495877825958269 0.30197938934140361 0.64955204076555828 0.76106636708766495 0.45468250086404721 0.26372789195037094 0.32610243891063656;-0.53215569938682472 0.060671973307909757 -0.034877590690436229 -0.083735881500827281 -0.010417099214437484 -0.35860059633780061 -0.24270214346676583 -0.23892918115531278 1.2390445240379073 -0.17493879391840356 0.70851083891608957 0.82319735424046114 0.18924158956842568 0.9616915965562336 0.21295774848382945;-0.019659130887536704 -0.079091770276069825 1.4105290040141747 -0.54500109782427564 -1.0972015889776112 0.40493158572710547 -0.038997619992189862 0.0058195669111379498 -0.31498318833231059 -0.345785235851015 1.3323409711817331 -1.1469889248936289 0.92301752519035662 0.46213531079205211 -1.4541490859119237;0.25213959747820214 0.88503430568005825 -1.4730954888562036 -0.87587609808487599 0.66452930981489311 -0.46391358015948947 -1.5441439656790314 -0.086872678688804439 -0.24991295144402867 -0.54408921041232927 -1.3865928076522915 -0.041497657621409903 -0.089328973188149072 0.7383925503708525 0.79681288009736539;0.23296643463656314 -0.56803311034776083 -0.45139174103715995 -0.40329454853700208 -0.49603975745522716 -0.18132841132708347 1.1845608985988081 0.088876814321560235 1.045014494467865 -0.94209903516307225 -0.60843732979539178 -0.49228481307408195 0.022086352484575425 0.26231585391592976 0.64633376491443961;1.0294924268381307 -0.60589903970739012 3.534727696809508 0.13171272147336457 1.2320949745476757 0.46224590581050218 0.7845039546676742 -0.13523655586878627 -0.91670632108255379 1.4232862295230735 -1.1429177924153584 0.95349972849402143 -0.73062568442219999 -1.4295019016682613 0.37188008520456545;0.12290797090461525 -1.2391999782020429 -1.2206363032443246 0.12332410725108035 -1.6100898982884531 -0.23322616640659294 0.72512436850071016 -0.31259867037565181 -0.59016020503411581 -0.13167338974344941 0.74531945606385719 -0.69329346184091967 -0.18340304648699671 -0.21829672896061481 -0.0090634879236893336;-0.48220733982976449 -0.069959509396369621 -0.25799450265314988 -0.40398096091614877 0.088374920642166219 -0.036943728549588772 -0.32286443460202169 0.01215068682903685 -0.69651178803655722 0.92849305807378502 -1.4921326303780593 0.55830701392924398 -0.81626657742972464 0.8708307916676733 0.27169628562212372;0.27500392439623261 -0.59812806644508187 0.25603423330269715 0.056114583662490357 -0.40232399882867137 -0.22953816012584594 1.1053394006338297 0.1007528482736077 -0.24859065615625633 0.025464606654567016 -0.44399287318108799 1.3756679657364688 0.17565438452418433 -0.9747618325598707 -1.090019067866536;0.93528613687366269 -0.15468802566187956 0.37264676173691569 0.03130446102137166 -1.0672973979724369 -0.70671826249444181 0.19295867071072356 0.21597374031144206 0.51364734142602164 -0.47427014752804275 0.9245411110103241 1.867230110740892 0.29996287846679848 -0.92668772560199753 -0.78237588249834356;0.20464377835849787 0.10073950672965702 -0.46668860626259973 -0.024738887927153643 0.15722536584340807 -0.060967274523738429 0.0097591603452613033 -0.48449347102903262 1.5084743790290565 0.13807288750860031 0.39024825629026294 0.75116951868797766 0.40187900322268461 -0.36872473730153676 -1.2045062248565044;0.50055554479335751 -0.13554103063959327 -0.10937843615410366 0.42088676206008574 0.47062941844185369 0.31117549972885306 0.27809080883619719 -0.15441299869326486 0.60797540011038165 0.80857646581094156 -0.63292992438797502 -0.28761859754319063 0.26164555642349702 -0.27752021354502004 0.37399816198034502;0.52142425153720484 0.75964519947758158 -0.17831197421834277 -0.1714472002742306 -1.3884606193097619 -0.01492422916511329 -0.32480936945405714 0.1324658404049664 0.61033985141097558 -0.87817552854924019 0.67008451462045726 -0.52386594561038002 0.80506152147805243 0.46873759401443849 0.37925099363709192;1.067491830667497 -0.3882718617906431 -0.87780771003858071 -0.70288307670225403 0.37291669389708021 -0.13144988354708537 0.58606733228269181 0.89056078282974904 0.7895431718701259 -0.030845655161052796 -0.15209263119487171 -0.38405092378494099 0.54387257016511315 -1.0138829748036224 -0.75089295682639423;0.39156317683552405 0.30473663668308498 0.27259327908295977 0.72141617329515151 0.41691337363775444 0.74124950561665415 -0.30672279707227734 -0.50083554252586271 -0.69845359705151633 0.20729841950668484 0.95729347144483434 0.40670514152754311 -0.38929511852685705 -0.00022683329026377619 0.66461897359013111];
  
  % Layer 3
  b3 = -1.1789055758008935;
  LW3_2 = [-0.51483261386069334 -2.0994175177076424 -0.75927089619212973 1.0102502941837006 0.29790878512576835 1.9168283974994995 -0.14917362154547359 -1.8093792535196362 -0.93460126758105422 1.3905096949004239 1.3707043303637205 -1.3859817431653316 -0.38629371729301465 -1.7069162346516173 -0.67144761094147731];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 11.7647058823529;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
