function [Y,Xf,Af] = O3atemajac48(X,~,~)
%O3ATEMAJAC48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:37.
% 
% [Y] = O3atemajac48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.201288244766506;4.04040404040404;166.666666666667;0.0561797752808989;0.00614628149969269;9.52380952380952];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.5937430120790643;-0.92033526140462962;-2.4106082359268908;-3.1067575324187655;-0.44421283252113403;-0.18970739090427213;-0.59507168849342063;-0.73581792327404694;1.0038838791588027;-0.53392337070773954;0.14862350170448152;-2.7917382476814945;1.1835199317161804;1.2670445416694247];
  IW1_1 = [-1.2485522199835188 -1.3290716109942058 -1.3192470326205759 -0.16765320439587947 0.98261431596123683 0.54387708571649573 -1.2681547545441521 -0.18151379074388246;0.95583268710166003 2.8503564285090111 0.59053141318031732 -0.26481978605672774 0.29687188490121486 0.62030778515461549 0.043870230407213745 0.68753194318062993;2.2544150911564462 1.6072943781548441 -0.43095729162158403 0.3502864603157021 -0.12215294462492407 2.0758267733662841 0.79310071250952974 0.18957159184632183;-0.13438250648386502 -1.4211096802345817 -1.0261004588695748 0.41840910665164222 0.32672789345698894 3.3487586030722558 -1.9381334175314793 1.2261341036173901;1.2379525249479371 -0.98095991983749642 -0.13057649809501468 -0.16270024572667741 0.31284005138541393 -0.13998899895214539 -0.056467381243455309 -0.62217076977230446;2.127654629985722 -1.9803999018280811 1.7781613481297935 0.16936978328741581 -1.8829592576809531 -0.20798055663045401 0.1380943379706808 -2.8694545910183891;-0.30034991776164349 3.0457120869808896 1.4799661693393185 -0.83558741653688517 -1.0584104703099444 0.26348938005763578 0.19857983766268023 -0.41813655516277015;2.2444802618734241 0.44450812373916432 0.52142062273676582 -0.13141742121715946 -0.42293261553282469 0.94639989829360549 0.030919470183735726 0.14982565689594948;0.26669102231853414 0.32146273459277369 0.3087926649622052 0.012640273646405652 -0.49206856812514271 0.93107194973846996 0.056028828504006055 1.3657333666963853;3.3622544212308205 0.4587132003997067 0.94064529466283209 -0.0030517429085055309 -0.97919492532165453 1.6307378226701046 0.069734062444294836 0.18707188494852839;1.8479020006427747 0.92047158643385607 -0.24549428417275596 -0.27585977681617674 0.55648372218162712 -1.5238290713708436 -0.176941871475435 0.24895409932742923;-0.39768696181629676 -2.2659825972030925 -1.0210509860050867 -0.28134218000646433 0.34667939410286974 -1.2328648196030605 -0.12734573141828565 -2.3413992025711261;-0.5118225984455077 0.66797073084860703 0.0070240740921474892 -0.18695332180540528 2.6481342861810293 0.66277207778753011 0.64652940541196013 -2.7003975159082048;1.1892242326150488 1.1095273502004737 -0.15953974418101824 -0.49105039579510956 0.92021440029984025 1.1432960548683688 0.15177210213774361 -1.5048047217337732];
  
  % Layer 2
  b2 = [-1.8312203792792687;-0.25117285539719553;-1.0662806379128584;0.30037486270408381;-0.1997655378155897;0.12550881602904135;0.59223139379279977;0.76822897803003909;-1.4970355988330053;-1.8863224820466322;-0.081314740498934973;-2.2046134707799068;1.1790544344307228;-2.5575796762239396];
  LW2_1 = [-0.28299071900381056 -1.8019885672564087 3.1175372098937411 -0.088866542263411286 -1.3136590517484465 0.29507680520195628 -0.73616546258505944 -3.7876892782339477 0.17169389806607591 1.6432756113801683 -0.39853809426663395 0.41900856877112252 0.11326841958624456 -0.4744663071851985;0.48399537953349986 -1.2753861277273795 -0.35229884593979199 2.2435751205923982 -1.1925404448138084 0.024992255427628715 1.313340198374642 -0.20436587632654962 0.33834037722509835 0.4875095830559989 -2.101285696401872 -0.8936725292304728 1.1327833433401073 1.2250808788775815;-0.086362877281932107 0.39072565052278546 0.19174938654624246 0.78629074875247618 1.6607257743266544 0.56364540252158113 -0.4841175126546014 -1.1721545047452999 -0.059096304225201596 -0.77022429161150341 1.0960328637493757 -0.41280518853040382 0.091759240576928483 -0.37672834526460064;0.38833134009754727 1.4380531366400477 -0.43904665210806026 0.76304660476459174 -2.6021520883802061 1.0183245781453105 -1.962422785377036 1.2092293230294742 -0.38144974460136943 -0.66852516765399328 -0.11960275288709299 0.05942436632262886 0.65984719813468218 0.091630542190600461;0.54244964534924511 1.5293204866013714 -0.3090230380651981 0.29427110895511677 -2.7576311912302596 1.0359467870838257 -1.9469006838950849 0.90439961363615873 -0.3489732434566778 -0.48125809893553484 -0.02701919492869027 0.20337601479998921 0.54282755103101232 0.19800030160954254;0.15934774887403313 0.67752864115300271 0.12021883919418552 -0.0058358332635777138 0.7654902754490126 -0.28575507138700457 1.0958486876639808 0.31657684588806312 0.52634699369506333 0.14734781688204712 0.077171874378230143 -0.98970263405058512 0.534691984148287 -0.96692120264730086;1.4030275503666481 0.57278088419254791 -2.5823138234234433 -1.0314078950707692 0.85886974699409757 -0.27246671501576419 1.2794060216293213 0.40283222760376286 -0.7527492895767971 1.1671966206827089 1.6380323688152458 0.028767103707605074 -0.78627034235250659 0.099188338538238885;0.91774944627777 -0.81681704338533778 -0.36841123655657643 -1.0747271910458021 -0.3142037633184791 1.305517415345457 0.52746885642389418 0.6266229156384463 0.67921618748713519 0.39519106264765891 1.068248685832685 -0.77615871630786204 -0.10723444661245499 -0.41066689804665668;-0.95344108654732618 -0.11567711437696909 -0.98337145002418347 0.44407152433091962 -1.3650867293532567 -0.067115937120930336 -0.98312749522171705 1.3616884863235303 -1.249585336040506 0.61124388028071808 0.10986850546943283 -0.68612204303314783 0.1971710653596648 0.64766611378720851;-1.0592175260543566 0.2233760590675283 -0.11770945064137264 1.1308160838137673 1.1784991478719065 1.3493077854132731 -0.061020918174087897 -1.2087745666115308 1.1237081006820402 1.8771895055311598 -0.65914189357531638 1.1530714251527259 0.22707864485904528 -1.3352029761812254;1.5711478978870186 0.35288919210781267 0.32834570083621323 -0.23986367876873743 -0.065396903052509225 -0.32447509609822439 0.41025783987244635 -0.24646439785383262 1.3848477293253545 0.41785798092765014 -0.100224656700601 -0.29693024091872283 0.53917287195688479 0.07639035124004806;-0.67227964873777102 0.23814793759290706 -0.39627251877130287 0.19833839330857109 -0.62244579092987973 -0.39210027160067618 0.44043966575969917 -0.58755046316638149 1.2194332303680453 1.2352351462352757 -0.8698079622880488 1.7361150564912742 -0.033681487231177309 0.77669308036229501;-0.38467588365462269 0.96376233600839001 -1.4330416282214133 1.1058869524497827 1.4587060950389832 -0.18735909986125013 0.34200018721853515 0.97954758307772061 -0.30037624302105997 0.13523270261940903 -0.48431513472179832 0.25899076955125366 -0.13926179071172304 0.94741904597663262;0.029015461872987522 -0.31451569574837046 0.40095921743964225 0.44755318432155633 -0.99844911597127539 0.20614614627349775 -0.52520085137165651 0.41379693317074129 0.41879693164717713 -0.50292442981580321 0.11014515080146786 -0.83275262967332031 0.40855158725012924 0.92964097577988469];
  
  % Layer 3
  b3 = 0.84033873748567123;
  LW3_2 = [1.3607760438910623 0.22527275690230053 0.67343629596931709 -2.2286370524885597 1.9878464801430977 -0.24825418575775676 0.75950757010567838 -0.15683733345519688 0.62712874361349025 1.0296633827917281 0.62530066909028348 -1.9232813077994761 0.50245447386260822 1.7804846385114905];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 9.52380952380952;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
