function [Y,Xf,Af] = NOXLasPintas2(X,~,~)
%NOXLASPINTAS2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:35.
% 
% [Y] = NOXLasPintas2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.96825396825397;18.6915887850467;0.0175284837861525;0.0546448087431694;0.00640204865556978;0.138888888888889];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.792462184178615;-5.9842569084748423;1.3571700763609811;-3.0201409865028714;-2.2315050002527763;-1.8700263634996304;0.13709223203188844;0.42833342353717446;-4.261288777516711;-0.80349010507456908;1.1102061286003573;-3.1393243804373512];
IW1_1 = [-0.17667685596387347 1.3084972147654401 0.45236732837860616 -0.11665257173473263 3.0391988157280494 0.8086353874957064 0.44881597831110565 0.96219765764735554;5.3100915635956474 0.49961338893035256 -0.066312140881139556 -0.16975216857408271 0.53767092359357394 -1.15778314404656 0.57030380917503543 -0.5573911937870808;-1.2781323479618645 -4.3076497046813076 -1.0695266881859267 -0.053161949513658498 -0.66427432942848097 -0.43277751096399919 -0.28790088937823016 0.12798259150224905;-0.43476585764463371 1.2248477964577587 0.47306504578490138 2.0747449737280546 -1.5177160072143503 -0.64606901958183227 -2.5598573142835721 -4.1238485453663989;-0.11747979532339359 0.11447862485235247 0.47759588145735249 -0.50733497549080919 -0.55420872070747229 -1.0510087594317168 0.30035622843524667 -1.6356571130652673;0.3413645891562358 -1.7988000644452116 0.25512743699683738 0.68746425107119835 -1.8339357475465938 -1.3366921784049859 0.48813104129451423 -0.076858682495865277;-1.1422866918929504 0.067174559717233684 1.0800986872636693 0.67352034734861199 -0.14641773923945087 1.1446926881296706 0.70120449206113844 -0.58157345742908018;0.48182670684660345 2.0152604760389332 -0.82097745450584003 -0.26366729107541853 0.87642432102100676 -1.1379595669907645 -0.1740110071188786 0.64570492902666776;0.28840786293077919 0.18021622066082066 -0.049431332077336632 -3.0272865057441676 -2.6934717423124268 -3.5758637734880523 0.64611921115741644 0.46130178158242574;-0.17703808068232926 2.1121347796643977 -0.11057293783532848 -0.15803609001933139 0.33516490021616246 0.065073614169225469 -0.0054982356318082886 0.34057856734685055;-0.17932637964738579 2.5068077037576266 0.20284976071948921 -0.077792770343256656 0.22650884359224002 -0.41469229092642085 0.20601589740551551 0.31511504741399909;-2.0636297368819223 -1.2748581434086372 -0.0024259639427856097 -1.8193701854195918 0.95126860152344273 -0.67392490895966284 0.60153662912687433 0.81909052140211225];

% Layer 2
b2 = [-2.9120280817018043;-1.4483145754627849;1.9066213204039202;2.2051890937576468;-2.2025490594313113;1.4333192373669281;-1.1518852163712721;-3.357739629570581;0.5365844184142996;0.35497049027454308;3.5576570705489532;-3.406413694281393];
LW2_1 = [1.5367213365958126 0.67295569504835073 -1.3088091330364529 0.5339208179547571 0.70933645024056835 0.55892162734468953 -0.44972403340064726 -1.9405769319774726 -0.66350525188149001 0.58005282219121024 1.604755704410969 -0.46533581635147175;0.90092603158150408 0.878057938703802 -1.2034033434213591 0.54479556912066951 0.71678571672415603 1.5745754536048373 -0.24346769316763894 -0.64447601701820512 -0.027143008567784392 0.56033403586613106 2.4055973725327999 0.43872272360020059;-0.044279151237368697 -1.5823078740165009 0.91397469622395122 -1.5889051609854503 -1.3878292201668474 0.55249931157785748 0.9701242558477251 -1.6636199224693624 0.59261055955629172 0.25699462896494923 1.8317269026924974 1.3190508617874406;-0.54855802073154769 -0.1434350809270184 -0.26950015949457201 0.014516694748690591 -1.7633348237780582 0.21303120959852548 -1.0822854090761038 0.98579100440465939 1.8482043775164645 0.42360783232739951 1.0284981365468164 1.9476571737379031;-1.4791143624397158 0.97309901867971904 1.7661392356169701 0.2761131170693073 1.0869223853876975 1.3154733876473093 1.30634918616037 -0.30190989822260894 -0.67526660316055698 3.6282749210701728 1.9227788465909541 -0.30905541754329025;-0.1669754400916548 -0.96476967239242817 -0.81561509656244746 0.12269197854733795 0.62396664703333282 0.94056553102502338 -0.51934344239381736 0.33806844277177017 -0.50289642615812391 0.099528742409523918 3.1261495013962728 -0.86484518364567786;0.4860031001688852 0.2516533318337737 0.25234911030699131 -0.039312092686103139 1.8752236916079432 -0.51862607841481989 0.98282895229007861 -0.93499392085070465 -0.69864434144380305 -0.84461465099472877 -0.71172482394154923 -1.4793365938774754;0.10600504193810296 1.302483414739658 -1.0306821824672221 1.5256952811493589 1.6497593822835441 0.49656544071723924 -0.91795910949157955 1.7641341609358083 -1.6468027514347423 -0.36887560664543539 -1.8406814548271004 -2.7146871523890432;0.46557062757288581 -0.11254360136760681 -1.5153530002575151 -2.1353422707689136 -4.0465140553860053 -1.623872448054565 -0.75791558863048658 -2.3308904736730822 1.7668823625062029 0.45914101499798704 1.684725438530819 -0.42102797327066743;0.092008858810364538 -0.75303423205956344 -0.50967708990621674 0.21010590937910484 -0.66169456266847049 -0.020874446170836752 0.38181077889275966 0.34832568285436555 -0.03236160372147507 0.49694620822951568 3.1010915024164385 -1.0726696535085862;0.84027731465946864 2.4921779595134312 1.9562362951564229 -0.040054281368021992 -1.7222842472914774 -2.4437233581408511 1.4269510528346818 1.23865598513593 0.50966067211072952 0.92833680090216375 -4.1884424437532362 -0.41943352515000215;-0.9297342802113352 -3.0112344885981894 -2.2014796323586578 0.050763952560153439 1.8373816050630145 0.52081775116335038 -0.9855771136657242 1.1151979885225276 -0.18782501753458861 -0.53491737972064779 -1.0952426544123632 -0.26856426010758672];

% Layer 3
b3 = 0.44882489938137266;
LW3_2 = [-1.8404594568132842 1.8779469889079106 1.3059596982329871 0.34462110053611383 0.83738679879856082 1.1685495807072865 0.365692355604401 1.3457361283634179 -0.17687701112900525 -1.1416534898347173 -2.1046110820575255 -1.8145629224689932];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
