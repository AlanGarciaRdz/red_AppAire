function [Y,Xf,Af] = SOXVallarta7(X,~,~)
%SOXVALLARTA7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:04.
% 
% [Y] = SOXVallarta7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;10.4712041884817;0.00782778864970646;0.0208333333333333;24.390243902439;0.02710027100271;0.00630517023959647;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.2130710844853754;1.2728914929525601;1.4262197711470566;-2.1526314530715842;1.8207476621638541;-2.2298540934939233;-0.79115090188600801;-1.304331585485337;1.2735115690608634;-2.7027572590453435;-1.4117397353581898;4.3741314649521987;-5.0017237409539614];
IW1_1 = [-1.1448288311051309 0.038740614926595918 -0.49525884425894884 -0.49825857274948709 0.8982800785544437 -0.27567456643378924 2.3525777312492271 -2.3306898272698047 0.93518484946383051 -0.65872727583374446;-5.7088831583796305 -1.2990410798339758 1.1908265873261721 -2.3542338447386584 -1.8649327608182729 -4.3962161369697128 1.0839346674969885 -1.4573028243416279 -0.8918150240703947 1.4593193684883803;-4.152094358882354 0.97266587891629264 -0.71588483887723853 -1.0363799289527338 0.13513202228432369 0.52664438798402147 -2.9069970573759356 4.09663309284341 -0.28447270796898599 0.88261447025987338;0.23041512185452978 -0.33802484466280758 -5.1556855108911712 -0.41940030988419547 -0.7851749833199666 -0.64817057534443978 1.5850506240244777 -1.123631628889348 0.13107840013176811 0.73608287752351653;-2.4938434879381388 -0.54823908031366098 -1.2645411497922903 -1.1357693866684504 0.91444322603657446 -0.75113515865794711 -0.1126236529826514 -0.080903702824376075 -0.4292961612414265 -0.48756864614810586;1.7903595454554633 -0.15243585334749313 -4.2307201599930311 -0.16599141005079457 -1.2705629841330022 -0.66976191464290746 -0.81761634883133494 4.0878608979876141 0.21440329299398711 0.44592548311202651;-1.6388075482613742 0.23764789164563357 2.2897870130185627 -1.257890861290613 0.55566843114965825 -1.5606227773932655 -2.1766491869298181 -2.0221065716199274 0.012443318333541441 -0.40901803068295339;-3.664460161379528 -0.27586629089289688 3.4054331836031295 1.1833573057838007 -1.7250216107416847 1.8567920461302498 -1.2096164850272226 2.1730975596385775 -0.040191602429894543 -1.8823439746831825;-0.86270504754351374 0.57919228352416785 -1.6387721290572863 -0.013126671955167651 0.66041134213973229 -0.20078507369319845 0.12036369074671729 -2.9658182560667798 -1.5199818982488968 0.32435494930270448;-1.6465426755581867 -0.029983996596633269 1.2157095889664395 -0.036286645114557398 0.31595262140459224 0.34441448253555601 -1.3348987935894241 -1.3359517062908834 -0.012574151420821248 0.38277865818974238;2.9923770060915538 2.9858412614184897 0.55402109551882595 0.059566473875271322 -1.1479728958849522 0.35146567903069059 0.32516069635587402 2.3904814199552664 -0.36507708551637152 1.1723910699250208;6.5493211601354204 0.088394909323223553 1.3315887890792897 -0.54884805134106585 0.98794882823543428 -0.735773344381081 1.1486402105133624 0.28336560978321845 -0.24349694496885244 0.58955626841785835;0.31848718326620662 0.057620941942734046 -2.297546866188124 -0.61846088265153376 0.054112565997149489 -0.78320118773301084 -1.6754133214456506 -1.0067836068873561 -0.11547245228883216 -0.11712442363095016];

% Layer 2
b2 = [1.3779951748471533;2.774068571684881;1.1317315049320096;-0.83174806724506967;0.84419780244061537;-0.35302287292395845;0.64269729018998489;-0.29735082616502212;-1.5691571937133508;-0.73922887244018931;2.4611625482354764;-4.331645226454846;2.3055349882273726];
LW2_1 = [0.42432519429643278 -0.0068376942176756987 0.3557632194336991 0.20270362209571804 -0.047441090265359295 -1.3237832393675348 -0.4245002457486271 -0.98434022728865123 2.949682028645948 0.52466522827328943 -0.34518277145420934 -0.77858306058227844 1.2316267997701507;0.82637235542304477 -1.0163275461471433 0.16487863667958724 -0.4001586126586833 0.90968283783397796 -0.93777042147315504 -2.2683196941890742 -0.29384811614241058 1.0009746671075042 -1.6400241733175183 0.60673274533536814 1.5453942690772215 -2.1780447706592465;0.4492165946611627 3.3174434997735607 3.4305638290887783 -0.031982307883193832 0.62302741720181265 -0.75057416561445334 -0.41764260293193672 -2.0944630966358622 -0.53595055877720721 1.0467976034656536 -2.746132873342888 -2.1383193456592537 1.1262083994932151;0.37998771193566533 3.1852985139222749 3.3080378841887841 0.11662744347599614 -0.52567207590034426 -0.83149233095649522 -0.2600015555564788 -2.026514613007325 0.24324924449541144 -1.3677407289202717 -2.7088674844807459 -2.1714280613008308 1.000956131437224;-0.25658005982251259 0.43796415169097785 -0.81029722776139723 0.21954747965227048 -0.11174954859558854 -0.94115569595100468 -0.31834491136838972 0.019350327280659871 1.298465520817075 -0.94100075190135102 -0.26229891452964893 0.010582091593093729 0.82332453046472687;-0.86657565673904835 -0.4995811190362982 0.14769895485160897 -0.60903646127222544 -1.3489001420239797 0.21755008997798994 -0.21451395747385307 0.12741300155694663 -0.27116500974461638 1.1723315752064754 0.40692961117706872 -0.062654260816899038 0.12992993208848158;0.5870785985751561 -0.21189856600978396 -0.045431813364665799 -0.30920442584424329 0.024310858767933832 -1.0341597217317495 0.097936823814599325 -0.37073767150256076 0.3131527041221574 -1.987509213495164 0.23052955595129374 1.3252073345812139 -2.413149306235999;-0.21796790053502374 -0.10829844376106551 -0.36259617592106524 -0.24284305634547265 0.73765408857205639 -0.67410089715695432 -0.9334422858605268 0.19731450281682075 -0.23926162332520837 1.3398202978618698 0.23029917889771334 0.52174648732219087 -0.16449095284830179;-0.060504134490957956 -0.40060317927610195 0.40473892459203153 -0.10275239001400796 0.20811973589909333 0.7159296943594109 0.33764507026682361 0.12083101475437943 -1.5253840549747575 -0.25779755450848502 0.046651326394617998 0.35885877789912468 -0.59527338320459;-0.69858630369619512 -1.6623068084878456 0.021575287953241814 0.43372821570806513 1.1313195440558101 0.33513148233395146 0.53700076689506326 0.14995324836635726 -1.5283346434065448 0.065369454522771764 -1.3762925085405175 -1.3868130948336828 2.7849828031450214;1.0761248981022584 1.1248166120248466 -1.1023038715811175 -0.12923104425797532 0.38788806216953675 -1.6293620204871249 -1.4397088239533002 -1.5843074953536911 0.93813094262897845 -1.7086974692278196 0.9324809527947443 -1.7060179649819223 0.44145187022980864;-4.2259707627046703 -3.4215543797683861 1.3882692247584161 4.0171554807832441 -2.1344418260090285 3.3003461233828264 5.6744238566178451 5.7286693740915515 -1.6382878459768755 4.4718178809975706 -2.3098850309772034 4.7446811206554385 -2.3792582868529002;-0.54843745693788049 0.15770627581535918 -1.4058246013751508 0.36532949414913668 0.64787572565870311 -0.63124973752919655 0.066929801044079709 0.42597082848078854 -0.031736993451571785 -0.15030603467061748 -1.1309097878548211 1.1644618764594272 0.51328022030630738];

% Layer 3
b3 = 0.59602083770336756;
LW3_2 = [1.5771554166229735 2.8560518515916957 -1.7438474562290889 1.7937562017573676 0.61371512818936136 0.088944093711484526 -2.5414464716049525 0.21627604715562526 1.3944800701153888 0.034457698248129498 1.8162760341645821 4.0411557198765671 -0.20904391101208986];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
