function [Y,Xf,Af] = NOXLomaDorada17(X,~,~)
%NOXLOMADORADA17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:25.
% 
% [Y] = NOXLomaDorada17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.00280033604032484;0.0179856115107914;0.0558659217877095];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.2718454333691542;1.4902483745461195;-3.8673844484920976;1.5422397504812395;-0.52122829658481606;-1.1519460945741218;1.4885344730134287;1.369044030079972;-0.61869376636990225;-0.13677146753005182;-1.7226140990602414;1.4338521732229901;0.2260600767805156;2.9516735673417496;0.91084371897171412];
IW1_1 = [-0.54662814444992469 0.03229432801979968 -0.67408908472742757 -1.1790240778880139 -0.95183048989043584 -0.80632630147670037 0.30402794959215229;-1.4769326486984489 2.4466659269327087 1.958635048523055 0.23081819193246905 -0.79035242288889418 1.0519727604216296 1.0593597827576535;2.1082821111554799 0.50493079863153023 -0.46986950351156365 -3.2294595055607922 0.88845249041248775 -0.39026977521281353 1.7103478692680865;-0.52645956249176407 -5.8742540336622273 0.1948548654438291 -0.23738877332148828 -0.43548469275354335 0.55792241915907814 -0.25437212337225351;-1.3843529712091438 -1.027725317704276 -0.17264110905010055 -2.1515081698496403 -0.9420152087536684 -1.0009452217671833 -0.27955027796342341;-0.40180116805354638 -2.0220359529498815 -1.2602642740120704 0.42900300003990066 0.83144875772520921 -1.0237434969721189 0.80381758295881423;1.4517662401715679 -2.3440337426085653 0.54031414364748875 1.9862081551095252 1.4003764046972591 -1.4972190768046174 -2.7477699641517801;0.63455152058409892 -2.5550652598133881 0.86824358281746827 2.1214375708190323 1.4362705239216398 -1.1123265755034017 -1.9141717468522867;2.3659376106062475 -0.31781120011671626 -0.13130311440631465 2.1938965883448445 0.80733604812084425 1.4865079223764068 0.93882783437874917;-0.35995478155380101 2.6388534603461755 -0.0016147210183162612 -0.72245178858280823 -0.11806366241510176 -1.7037020350374021 -3.2819704590046168;-0.29235135134274792 -0.66818142744094022 0.87263830549953869 -0.82730295732807357 -0.87037138880656018 0.98509145408108933 -1.1649154765562983;0.19541225432193762 -0.76208630544019584 -1.8900661904039588 0.030466003767469121 0.17064478969117139 2.8209382798320828 -0.97008376146155428;-1.7932479470751921 1.1919902389585493 0.24915184955721853 -0.57697375411130147 0.12041656822508499 2.6223233608053547 -0.97505194152045149;1.3804584911394566 -3.586602332819151 -0.17891309846759074 0.098221114235120116 -0.65555993987204986 1.0942756729682344 0.20170465747923291;1.505556730291008 0.64135975518592081 0.94244658599854148 -0.091027650679599462 -0.67052655481029166 1.2346675248673655 0.33986683290294806];

% Layer 2
b2 = [-2.4314140973814258;-1.5812362602576748;0.77140005583305316;0.64095344803447485;-1.6687867455547083;0.55911901574157596;0.3264534135425074;0.05077628741436449;-0.13115745823682445;0.39171606993076152;-2.2811651829558612;1.1658810629073539;0.8882404202305465;-1.0354561481026536;-1.4645936404739135];
LW2_1 = [-0.40645291919423321 -1.1904053021638343 -0.15670496880532114 -0.85675026805530974 0.25519866019173615 -0.8212363879660014 0.66943224603993878 -0.49769792220906461 0.50242432334494536 -0.35545471598500156 -0.54950638374060956 -0.27386212573121699 -0.35196786948931436 -0.20781627422560903 1.6702946620851939;0.029320880673693574 -0.37512683291013615 -0.96724911521530321 0.048879553046269841 0.017729874007778389 1.2456912695893891 0.90695982898876604 -0.29618458528966451 -0.63398709582729718 -0.87170887627011551 1.4101610452199251 -0.41213943960073457 -0.11315427614346897 -0.37941682131373472 0.90520995236532698;-0.83486106326166132 0.12170208776900916 -0.60749119846803412 -0.74865311639661236 -1.0401722263965034 -0.89466794237588476 -0.86357864990613376 1.1637667117991679 -1.4691211014933185 -0.027818674477157791 -0.090802331488439469 -0.21791665969132445 -0.24938928843955402 -0.45909678680141119 0.060576959141452946;-1.0520964625501228 0.10736272681127371 0.91636632422852304 0.98100077536985386 0.012839988918681641 -0.18868881615903624 0.30347538892048437 -0.99460858378249017 -0.32630254719116436 -0.19850250542864373 0.14507344065288938 -0.30875768719876745 0.32467018252043667 -0.25580314583469937 -1.3347320191556602;-0.052651813396736594 -2.3994413230861378 0.26050155948413384 -0.12061292654010747 -1.4736099684466217 -0.2888350514957691 0.99897491768286195 -0.067376744043764036 0.51684306731695506 0.5888115257195311 0.95648780353877472 0.45076169416079664 -0.79577297590430696 0.09483071655055364 0.065832107243087259;-0.50019809920761171 -0.57746173838379811 0.64820535546401636 0.38926514862613321 0.59378088384954364 0.6640941897437086 0.5994095622741954 -0.96593672861650692 0.81048566096666907 -0.32020681825214492 -0.27017694315220553 0.023142125901993927 0.38016708082028283 0.57351652941771525 -0.20558764063749346;0.97018207434985282 0.85648717038916355 1.359092729040096 1.0693818830182678 -0.28728623204319781 -0.81880499163609111 -1.0251971389488992 0.074530906748339953 0.46180655608879406 0.93282478319195328 -1.1344177596738458 0.43214671359349982 0.22022692206691932 0.24380808115331595 -1.0059712126005942;0.39601758344160942 -0.88239628251560875 0.63635328799112578 0.070713629711106007 0.32356236595077592 0.66869486319047766 -0.35600721540377944 -0.34570635310780057 0.46571997547047894 -0.57482402066464677 -0.53912821078277862 -0.23416800473648933 0.57306158972925569 0.3328041451831491 -0.34764076959146017;-0.22973692746952376 0.42530165716388113 -0.56262541105126529 -0.30589861077663072 -0.0040214223308077113 -1.0543507330596493 0.86734668970706263 -1.6472460348801405 0.96207187627838886 0.24616474956845777 -1.5469777613016447 -0.34206724440188152 0.39182377219287151 0.29892603344816882 -0.70096799663594478;0.55244905792707444 0.21920681342406112 -0.96035768858888759 -0.59477575418349815 0.27689999711975538 0.91192741330048377 0.4896977466106463 -0.54903461528302033 1.7979948125750416 0.6745776190534758 -0.3875792197113041 0.13394702858218455 -0.072379558125996446 0.4293542088132658 1.3093381054442463;-2.3048203732222268 1.2716735980200315 -0.58269562796632135 -1.7248858078057119 -0.21458096545992031 1.7913473220670808 0.0060238552600158923 -0.64616462826288412 0.9910345675649842 1.0673409532134233 1.2189425712987543 -1.4647942689048474 1.7531080811793942 3.0114161633790038 -1.8838021436505672;0.8958815949134985 0.0047970413892349587 0.76087827209922476 -0.7672004234019496 0.25547852095251372 1.4551330072757023 0.061402225264484224 -0.49873675731295319 -0.81333836702360562 0.85721477245016076 -0.59096355676814005 -0.81139343886507476 0.28591677814674099 0.050119287856854919 1.4431916637152538;0.30731187176249353 -0.051127920078058636 1.1615844838199327 -0.31684115285164988 -0.21673793122811585 0.10993979853313932 0.1072595990483512 0.34875454311177062 -0.51942456563339101 -0.29105766504799274 0.79876961474084807 0.30916677318153751 0.14985404969852387 0.15312587636600011 0.28580187390468148;-0.23974296695756886 -0.17615590744788295 0.0020738930709585657 -0.94247503952705936 0.092899083652524833 0.0038774583735033223 1.1259946853124594 -0.74611377626861364 0.052743509590088916 0.013396860111143521 0.50885850177153247 0.099606012656553861 -0.18663756931519659 0.08654830465122737 0.81207563998497367;-0.56460414385092128 -1.5667176911124425 0.29237566259515918 -0.40477562165707737 -0.3317630395396251 -0.48196551111537711 0.75169460932410093 -0.050025957910987261 0.85736940211336188 0.37931503194191191 0.63452722616353563 1.1545431723231128 -0.62086605910787662 0.040239626116316554 -0.33245755341805527];

% Layer 3
b3 = 1.096739711111534;
LW3_2 = [0.45358526076995964 -0.82968427538682643 1.613444499401431 0.87485985646156805 1.2300429906350263 1.9514761058616379 -0.78852688911587299 -0.89159306075068345 -0.35296378343999624 0.81926427232330512 2.3505307178857446 -0.33849909356882785 0.24475533616586276 -0.64464433330172832 -1.7921124134127957];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
