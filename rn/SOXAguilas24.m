function [Y,Xf,Af] = SOXAguilas24(X,~,~)
%SOXAGUILAS24 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:21.
% 
% [Y] = SOXAguilas24(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.7295500357943672;-1.9626596220442929;-0.9683632752250213;-0.37334317919237059;0.86117813823837164;-0.05568625652190598;0.38271854737802419;-0.29098932428233881;0.57904064948383915;0.92876075914783862;-1.9037713832737195];
IW1_1 = [0.60863493251224643 0.72070110514954078 -0.086999764648573272 0.48601873072935947 -0.47807032396770577 0.18024108518135601 -0.55278862912500493 0.52700955938167782 -0.76217072670439889 -0.0402517358998951 0.14434502140162792 -0.23154803362561907 0.12155836292647522;-0.078162263923317155 -0.41433057552314795 -0.011456501156980733 0.91824619580243538 0.23762106241334091 0.2549861426351106 -0.68643967224832658 -2.9593828091719341 -1.3263998243461712 0.32159381867530484 0.061092288292609917 0.51974744235672699 -0.25627691676262049;0.29919857707165359 0.093820971240846068 0.1339660143368275 1.2769910358736667 1.0996987201722705 -0.91468606374436201 0.83069632387165937 1.4882257107434047 1.3946277719164819 0.43769398951447192 0.73255762028681781 0.71243093643730904 -2.7343951569191201;-0.32126312798052103 0.31002797312412822 -0.56654232340861577 0.92607165373984712 -0.066615461549171084 -0.36809504371316959 -0.60828140504889461 1.1543084036314091 0.51999589048758454 0.092825370639150862 0.37757655787378441 -1.1239455701557057 0.57024363695428892;-0.47834820250743521 0.97558401892207203 0.31169833901811383 -0.29459357496659022 -0.27454919223615804 0.17747710689719853 -0.66984986163825255 -0.51066550904824404 -0.35093258645703673 -0.029349920981800885 -0.55337372022139175 -0.14649108451470266 -0.48630106370931608;-1.2665227029674824 0.017640725386763624 -0.33885006211004215 -0.092041951065532354 -0.39525165802572332 -0.43242531024568126 0.81367104637004373 0.58406894605184467 0.48294439528164707 -0.50608035737012846 -0.22736194835132473 -0.9398463064232031 -0.18244122390891282;0.76080316915306445 0.28726539478759772 0.76059120776552891 -0.57786696741760457 0.41868406122362778 0.59163236492563753 0.044117637893845651 0.80713963968264646 -0.39021152282393301 -0.24872741387957004 0.53637924418898231 -5.2306041136858648 0.23900384158895055;-0.97770710530891836 0.33830971076183558 0.090388111324382056 -0.637472801831242 0.20281921990592008 0.012170069255946702 0.72600207890963253 0.90723110872393686 0.63830863979165997 -0.072496790366356992 0.081241604591339445 0.52731660380353307 -0.036761510615437476;0.55767047404955483 -0.10435872177666683 0.57308784722755768 -0.20930138992426722 -0.15679393513862641 -0.00081446520076763722 -0.3222796223751424 -0.61094106645305601 -0.78534964918927619 0.19076276672423856 -0.13912070184386841 0.66263820621361258 -0.60941974146708922;2.991097434404641 -0.26490285240375733 -0.65309955529617603 0.74005781895089906 -0.13588806106351164 0.7231458849493454 -0.2168445505161723 -0.37392828897416391 -0.79314438629348671 0.1200289882531477 0.092710072739444704 0.69485186527083331 0.38505604364494894;0.16178113662986687 0.25881348430781226 -0.051700388744264719 -0.4524279048033687 -0.1499606499582308 -0.14574245453410892 0.41508280374904155 -1.1456147942856205 0.8365169548941217 -0.17206725506114362 -0.028453912046774131 -0.44187316917951103 0.19302295403909561];

% Layer 2
b2 = [1.757901089479573;-1.4276927761244869;-1.6184664048247175;0.85811736930646565;-0.063629189498843344;-0.21898407398766104;-0.73122024824545773;0.70671374050158242;0.82460789806415136;-1.211691021384768;1.6880181043645255];
LW2_1 = [-1.0546547710584377 -0.45780687659707042 -0.085187188744540579 -0.61366970450632619 -0.22924786830726801 0.21615176926057819 0.61489518129040932 -0.2665239429600752 0.21224852887651313 0.87853804349647491 0.015196221798256318;0.054127912929801084 0.29393697447405726 -0.50098559320888558 0.53815650349821265 0.32214594639663574 0.67829432654470923 -0.68988984879006843 1.0392537089991019 0.26564125885521611 -0.13180905561180919 0.27397156367399461;1.2880407936342118 -2.0392044183087403 2.2007088127820196 0.83264203447489593 0.13157086521105643 0.85165355305682611 -0.25134897125442107 -0.62445555892908189 -0.23584776880416461 1.4830120334833974 0.086298283774508558;-1.0320147335053096 0.86624938411670427 -0.32521541976878948 0.018722301116107468 0.48833347285868794 0.05138896483731005 -0.6128347605254818 -0.25164544832893487 0.56821588086995911 0.47476910773912651 -0.57254604537055143;0.30440679944441207 0.37745387357961857 0.35560387054778397 -0.31210554627849424 -0.11246012524962171 0.53735510407044829 0.64144995630469925 -1.302281786203823 1.0057333146942047 -0.45561237019319478 0.25534962071782424;0.66147239349173614 -0.56950310898176126 0.61172001111362651 0.55722875298635111 0.67964255530879203 -0.35235097751650585 -0.037638902956934381 -0.55857942209405209 0.48405296447805723 -0.02193270622721288 -0.5597678126432839;-0.73186546004589115 0.22115128038959739 -0.49014279177328568 0.51232834355831924 -0.53565006774318524 -0.30198153608638573 0.28029061484692197 0.48450452755824036 0.32287729295543188 -0.017716303408997703 0.30498407564000946;0.46025800511126297 -0.5189167048426151 0.11816336303263132 -0.68173357391796741 0.35503633706184407 0.57647265862359154 -0.4666020821798158 -0.29153388683319514 -0.842551993482059 0.36851229679572695 -0.92104005930198229;0.37977001883356393 0.043306973703923383 -0.95004220228414427 0.92904497568272182 -0.44088417679456271 0.89252382396092922 0.69009792211690091 0.62802601899632426 -0.79288477894383813 -0.71945279859143141 0.62453981390493485;-0.68798842765487622 -1.4998974643770027 2.1084805063072189 1.1874896592857218 0.4291019384992576 1.209526526345611 -2.3437931512690309 0.032876329407447585 -0.16732243652426509 2.0014607253103365 0.38513280622085988;0.92899368478577404 0.24000365560922185 -0.013707642097018599 0.46801294492491624 -0.62732786577551691 0.5313018429544355 -0.31205808684489345 0.30998018329384464 -0.54926688733438866 -0.13497545172063283 0.63162436702614355];

% Layer 3
b3 = -0.63776624660541892;
LW3_2 = [0.044986860170753248 0.28122552659772587 -1.9175566844541603 -0.59134029446043868 0.51583774384556402 0.24385520271550823 0.55949279975594546 0.47325992939700079 0.088543625089499201 1.9277097743344949 -0.17994786920647102];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
