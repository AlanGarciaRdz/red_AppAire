function [Y,Xf,Af] = NOXMiravalle11(X,~,~)
%NOXMIRAVALLE11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:27.
% 
% [Y] = NOXMiravalle11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;2.48447204968944;15.3846153846154;0.0208986415882968;0.056980056980057;0.0063552589768033;0.141843971631206;5.12820512820513;4.16666666666667];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.5504275151467248;3.4697091386520875;2.14183830269672;0.79805587003310219;-2.7260413689530605;-0.28327581775460853;0.399065288354154;0.69305078450880586;-0.12184712999593819;-1.6407508563934656;1.629572319742888;-1.7326737889786541;-2.340288459820048;3.0389105879325524];
IW1_1 = [0.36831861287937684 2.2049764712563609 0.66434789732546318 -0.07722507155840945 -1.713525503198589 0.70788214729471222 0.47730974908861112 0.39894693428253025 0.12211766016313114 -1.217554908438975;-0.2197995633458785 0.67890504806676877 0.65646711248701428 0.3304491088250272 1.7359484257908087 0.8977207614571826 -0.1302774178923623 -0.75387031735268184 0.34855161266045842 1.6317622471816449;-3.0523072929358634 0.035117049839917452 -0.47311116436652711 -0.13579714900277162 -0.028283159460575601 -0.46040902931057065 0.39874184480430119 -0.86280380247897714 -0.27384478595979805 -0.11113156788273582;-1.3912781469046729 -2.1791693591073265 0.52335397330945488 -1.2429960440017644 1.2181829288289552 3.1084495302765562 0.48077945308991127 0.11903734316478617 -0.79702824267236816 0.64099618827870608;0.25330804610563545 3.5220619376219893 -0.10163081020125586 0.34051497241153184 -0.16357268011764728 -0.98324784235372731 -0.10541700198247883 0.068514151113366104 0.65651260295939662 -0.51643507835944014;0.54630104932358137 -1.4236887704329597 -0.37622023378170494 -0.56170524457330107 0.6436853607751285 1.4986791416825445 0.62869395592603727 0.077674670462814538 0.66599188681577459 -0.91603164943394422;-0.14799960089186193 2.511356266724492 0.60893976229952473 -0.12936958989480885 0.39921875256084249 1.3083541652404014 0.051069763083558484 0.1912864631866821 -0.215708119823073 0.031391084896887897;0.14830074924968906 -0.42366422423542804 -0.44147443451673873 -0.40460984967683677 0.072560982111902983 1.634165213892407 -0.051614604420626146 0.61149981583275936 1.445285021599392 -1.6467633655770282;0.78115560236532189 1.4394816613350878 0.021271374191810105 0.61641209384139817 0.11082482761588688 0.29160085500327276 -0.17149382113666692 0.7060612638217012 -1.4908070433529628 0.093479507211089219;-1.5126152996934905 0.94572904513682587 -0.64921109013318667 0.044763520797125089 0.54407293608746643 -1.7231269530856455 0.27176107917062881 0.47364422563502656 0.62140466241289305 0.42469435780023912;0.86425261450031177 1.1300849169757505 0.52150771879627733 -0.12948087491531868 -0.10538134667019261 0.15003140491967565 0.23138607102706493 0.36124126295528358 1.0052778244391394 0.54973513799590723;-1.4099314066092774 0.47148438495518979 0.67002451540296026 1.2187690131550335 -1.2025099084720559 -0.59347519928072257 -1.4229689675295376 -0.97305680099787983 -0.58573670471908268 -0.13611687967357253;0.080720381914391764 -0.99301562156975409 -0.37450242978592896 -0.17767510961934535 -1.1645537687525978 -0.45916692526802294 0.13988779978283311 0.43816591189430126 -0.10066025220852819 -1.1511507423174476;0.81968025822067569 -0.89637627808622766 1.2200473750161758 0.89853763041403467 0.073579047743588533 0.8629294050296622 -0.51158264318456637 -0.8354153361087362 -0.58958005496172072 -0.65654041957987463];

% Layer 2
b2 = [-2.1307252909717422;1.2899932426261889;-2.0138322985926687;-0.99827031884798656;0.66947246096392576;1.5324665920561462;-0.70216409619591857;0.42065796553723922;-0.43445312074801712;-0.15995349671382716;1.1115055119774231;1.535523997799078;-2.020104419404424;-1.8146580551541891];
LW2_1 = [-0.50478037380255036 -1.1352668510223543 -0.53260277544596157 -0.90077103958317728 -0.33910233912023735 0.51329272578091933 -1.0785745640196265 -0.32999650426837684 0.81763506234520045 0.19933347507618054 0.32242342845130106 -0.88761138145762619 -0.775235008092928 -0.081568645130815437;-0.51377285250590565 0.079115553254555576 0.79489615591306451 0.72302517426650392 1.6242290698194477 0.79873827065906033 -2.0500732796228212 -0.80313641654318035 1.5551453840788168 -0.12698235398475272 -0.53041463288106327 -0.37871095722550974 -1.0180894531601887 -0.25722699664155946;0.45855632601614077 0.62135906862582591 -0.294479120590735 -0.58973147606597487 -0.5529959627969343 -0.35545351998136826 -0.82152087947711172 0.2495599967527844 1.0300991066944047 -1.1070246061301814 1.1185262162750309 0.5459802418218962 0.085072053599992536 -0.91000246895019932;-0.034231069161382299 0.38175824287222609 0.31772067177741381 -0.91540237631816856 1.0715528602878899 0.87595369576120929 0.34122652858719205 -0.48336889466064653 -0.62852750274759339 -0.36504348428032951 -0.24075238124293002 0.53099644449196826 0.1455791117565334 0.45857564485913477;0.36941578201376335 0.30101019310549954 1.4904349514351447 0.11175945970407186 1.9909125725142724 -0.4580171341651042 -1.1829529461110369 0.021689052063157951 0.40129725197823579 0.023573785211207871 0.43395270654415424 -0.36000659788726341 -0.16229116698159821 -0.30281066101696752;-0.73379793134006466 -0.072747768347025024 -2.0307523374455281 -0.78470999563543553 0.82557233058845281 1.2200096484613421 -0.49810031971983254 -0.073645744763889603 0.095789325526754232 -0.1631880722072036 -0.14877292184173899 1.4410255988352292 -0.51614002018877325 0.17207454061968211;0.46124955790741873 -0.3166562190905316 -0.40536586720468543 0.30448732551702684 -0.50270442317941544 1.5475286215490442 -0.748557384391623 -0.3238160517179085 -0.34447926146090246 -0.33972871481019534 -0.37955505618679486 1.1323229659122649 -0.2906086321810003 -1.2036495162992986;-1.2569751444586656 -0.29519313165483785 -0.82609464522801013 0.6848487771795998 1.0628125825121535 0.96637165619834509 -0.17412212956314466 -0.15489034983560152 -0.12864365894105473 -1.4671636731784663 -0.25375443942074571 0.35129393942852877 0.72228794278910646 0.26946560538667652;-1.4413455711137892 -0.4373872629637589 -0.76573793860048767 0.082459596853756548 -0.53724870169085426 -0.30705553194118512 -0.41418099815582837 0.80553484417534416 0.70773224879301266 0.44028361023998219 0.53275229278326908 0.1570701227543731 0.65709520614307815 -1.0290750319100783;0.83408475230461165 1.0586736985599212 0.2843783575679677 -0.5776652935243467 -1.4334278278382113 0.31983551844529456 0.38426973328762604 -0.60296191066217086 -0.93395578767792298 -0.38798751259465125 -0.70930282677961753 -0.33692594165312573 0.21873778826823606 -0.31836087195735541;0.47899723854017423 -0.33209115977791021 -0.045043629816959599 -0.54624791734991684 0.10435805722728263 0.45551001939419822 -0.19438629727593362 0.22575261162273269 -0.16325618045727533 -0.086630485914440086 0.84092051308519267 -0.082429989840122592 -0.86597783155976127 0.8372073557101114;-0.19813294767780121 -0.1067413932611405 -1.1879377912535378 -0.5620153757376295 -0.26880763274833663 0.16332345519657593 0.95068159223301829 -0.096175112757667505 -0.071452944111956379 -0.10834510576659639 -0.21928345163567461 -0.015825086814193062 -0.26045872339988335 -0.044769797609596443;-0.57218279882486511 -0.16419363033646603 1.7871374819818173 0.001276126517989095 1.2717001974782067 0.66069882760564558 1.4958991543694935 -0.67109569673727654 -0.71193770445234761 -0.54280138070477413 -0.48424281881144315 -0.96555904786677493 -0.90644471719731134 -0.69223072475777581;-0.86755924421517294 -0.78153745853690326 -0.24112463463459197 -0.69809176799673922 -0.11135537976835558 0.84917296327892056 -0.6812160587670707 -0.053682844136870612 0.6508576760565401 -1.4157552280477077 0.118427067056495 -0.27607223333023245 -1.5736294959261095 0.78261112937237642];

% Layer 3
b3 = -0.71911611496653005;
LW3_2 = [-0.88871423806673377 0.48041374823476501 1.9071935623612175 0.53838684708332274 0.82433481854742652 -0.70780333281713648 0.86345336119838767 0.83614297761447753 0.83518410341436655 0.77400005320191956 1.0067596642500853 1.5816052582457727 -0.36663810216943171 -1.019454390112688];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
