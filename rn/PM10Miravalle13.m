function [Y,Xf,Af] = PM10Miravalle13(X,~,~)
%PM10MIRAVALLE13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:17.
% 
% [Y] = PM10Miravalle13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00382043935052531;0.0208986415882968;0.056980056980057;0.0063552589768033];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.3159854000885254;-2.4528453852953236;0.7349153385138909;-2.7633550782357621;-4.0397610908814423;0.072397829613521786;-1.7626015007107327;2.3582579810722653;1.2315347653625068;-1.7942734431126306;-0.92889267382413554;3.6112817728952704;0.57297324107137038];
IW1_1 = [2.1771495688390541 -0.27090163210789708 -2.5064170089355109 -1.3335644642639752 0.97827965483687307 1.6907013633323678;0.22629776630984569 -0.18370181096822119 -2.8619833284271068 1.5555865496506314 0.88588627998493941 0.016631939200658932;1.2219132588008108 -2.7638115145454707 0.11722275802901334 -0.73488288043600958 0.85125118163063629 0.48412384579084777;3.6297372511915693 -0.38930402172525475 0.32022549359122587 -0.43047059013469841 1.2050224936734972 0.39882292018223592;5.249929156635428 -0.5792357399520105 -3.9159679544763319 -1.681360415061214 -2.3845447055453062 1.2387354011806346;1.460440224020942 -1.0546952052899456 -0.22167275154326596 -0.33150925088219352 -0.18460739076887472 -0.22965351598947953;-1.278822290370184 -0.40980562386820557 1.2419404882792306 -0.3471567081774386 0.50775943945022095 -4.9797302479227596;-2.5824004867826473 0.91847561044884884 -0.0094875488970004255 -2.2362121842331284 -4.5850978773557411 0.17299792705699479;-0.56751755458026421 0.57050234126874522 0.99052198406723835 0.49381104745269849 -0.8390483353280378 -0.39412623268379854;0.012038361887488096 -1.8872916844536132 -1.0428216212625232 -0.20811591017891018 2.9921187477752125 0.13453626597360122;-0.17684567225172873 -0.64589726043895013 -0.54437222692841547 -0.4011672341385174 -0.28155595532208277 0.06773155841922808;1.6041451995789107 -0.10352869236431593 -0.28158934292228088 -0.31583540701564361 -1.1566987088856671 3.7514033889047336;0.79223617089467335 -4.4220704719395663 0.32388129007682542 -0.49994462904304465 -0.29748707349431547 0.1692931976360971];

% Layer 2
b2 = [2.6459655374896731;-1.5321338166327267;4.5580139578721965;1.0321812308437737;16.063644375478709;-7.1890154231559462;2.9510745538256535;19.490901728355684;2.0853539883953989;-0.98865689802978229;9.9534436906626542;-5.2263895673720961;0.84643624153130081];
LW2_1 = [-2.0175888895761975 1.8443248773082623 2.7415112850136203 0.59595114253854242 2.8504814753672938 -4.9409758247439513 -0.78794016772304454 0.23661427818448247 2.1936410463599305 1.0732126046701878 3.7238728587825731 -3.1163062967948605 -1.1878694427130221;2.5861650748269849 -0.29440844613360045 0.34698619463452951 0.23117448409853619 0.68776974732408735 2.9728714400321876 1.0441546396079504 3.0530436911393539 3.8718450082041422 3.179583643754718 -1.6033174466750415 1.2895023463085997 -0.68453645184229162;0.4581486943476189 -0.076729869995696739 -0.10818992483359416 2.0764305266769156 1.9254780864453931 -2.7259743998075292 -0.58014991626316714 0.068255242440685371 4.0148378335621633 2.1552163506157624 2.9442476316777726 -1.2772146179728057 0.15241788179830831;-1.9770143339229569 6.6769702435715397 7.1479633478072984 3.147170142819538 -8.8604604108845635 -3.9191681269484899 0.68341004951082873 -0.82090775518952175 0.5048070037646859 -2.9123245692007109 2.0749099184127293 -0.73836593344403034 -1.8296654846416407;0.52922947739238702 1.2397439908687118 3.2225121021675918 -4.6496685358211343 -0.13640572911966314 -0.45885205160005826 -0.81549726054450711 -1.2912388222623201 0.80754867540823549 -1.7425853646303091 7.5559291494670004 -17.46371215859212 -3.154410790989346;-1.2584969259669874 -1.7452279839022267 0.82185191391623835 -0.091267239309046372 1.4128225297394126 -3.1454061316991373 0.20256136259970006 2.1238441643340753 0.5723687398132169 2.0310754052147004 -4.3770140446299068 3.2441515382071655 1.594630239252826;0.59378700060791623 0.13614617168575549 -0.63210847403701131 1.5637384243505588 1.4566858884618683 -3.7743089664328497 1.0655011552135834 -1.0279355639511396 0.75323274548385455 -0.12319133576053859 3.6296460125846419 -0.19848352982279016 -1.0249217989224932;-14.515041572368894 -6.7193380212504552 -35.468753691932271 20.706174802025885 4.8020692655477193 -4.3745869190565587 -8.2841950016974568 2.8354820360502884 -3.4565725698099858 -2.4709114669150196 9.7248818969048507 2.9608367767288892 27.446972428438922;1.6898028114798052 -0.82910243588365129 0.29000787074078044 5.490662862576003 -2.0588197935154815 5.0721238797051322 1.35787482830409 -0.3240718612583946 -5.0626424488052555 -0.69423735903889983 -2.360079470590307 2.5626915768816563 -7.1753590039237585;3.1962774631158393 -0.031919583860204596 -0.37630292203442889 1.3784141018720271 1.0281792503257574 -1.818870305603749 -0.097527631344544091 -0.97538215716139576 4.7396240780857486 2.1989548617372994 4.1529554069477701 3.634076610576507 2.3852201141738902;-1.8339973605298558 5.8432162325006125 5.2670199205694779 3.0293103961785897 -0.22838534318695008 -2.0234332034713658 4.0357025577871788 4.9911264418255632 -1.7604381140204028 -3.9795802070527189 2.2338595212212478 1.6992617878925937 3.8035372215675518;0.91048136554932046 3.1750228563656959 0.27891598125591932 1.5359123441976983 -1.2803533445794411 4.628579822285543 3.5782285388099675 1.9030835034802169 -2.4560551531966239 -2.4243303410296613 1.9897628196868782 0.080946771586799318 -1.9071319501278519;-5.1616119884395681 1.1791801424021995 2.8709502646684029 -0.55301383851953112 -1.4455683328507214 10.19428970601782 1.6144489132654605 1.8599336823434609 -0.80213181389443955 5.0705582169372549 -3.8525851133505089 -1.5419879245047836 -8.7757997082813866];

% Layer 3
b3 = -0.66248871668777309;
LW3_2 = [0.061456299369371276 0.076564897251131442 -0.22688058039082004 -0.049085148143517186 -0.075759531107199587 0.092802254369111603 0.076157829667217902 0.013772900436315504 -0.024397006745963148 0.052853103752555836 -0.055874232816596009 -0.13490768260990749 -0.024494083476943769];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
