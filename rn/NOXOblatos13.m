function [Y,Xf,Af] = NOXOblatos13(X,~,~)
%NOXOBLATOS13 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:32.
% 
% [Y] = NOXOblatos13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;-10;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;4.05679513184584;0.195790504160548;0.00618238021638331;117.647058823529;0.141843971631206];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.090123450428726;-3.2042207130632456;9.5638976529314288;0.80809167849976293;1.2317036774117225;1.147726108344735;-3.2971354405631326;-1.6222121267682126;0.091003420862861686;1.6276449210167285;-3.4706725574076476;1.1047437599370931];
IW1_1 = [0.10541204106296115 0.33857395631824133 0.52386432550794104 -1.1223291595466567 -0.8374932861662947 0.46759623490955643 -0.51995891097916436 -0.10207325352378996;0.46534238624508628 -2.2543739686555515 -0.17313799371641483 -0.87003311580621112 1.7499493452521697 0.026725110430379843 0.074792052806101766 -0.040485368736713392;-14.67594851464829 -0.84775035998252302 0.16773018336227291 -2.3556167548540361 -0.55632940492976579 0.47910285329327007 -1.2529243944380111 -2.1338783938372177;-0.46543873805521252 -6.7932099379284869 -2.0415018581197204 0.1389761246885339 0.93603741195472545 -0.73899169204028481 -1.2791693562162059 -0.36056335347303342;2.8237555982592353 -2.0481223540165749 -0.18852709099425258 0.9024293959563221 3.555460341451008 1.3773218124312432 -0.013570802199029026 0.19977067429891465;-0.80049449552845309 -0.34340798173053022 -0.092489116358658849 0.59428196548535361 -0.52047991309695851 -0.22964414197479072 0.16773367116621227 -0.011482741136774076;-2.7602606059506449 -0.62680273382969831 2.0209997561545565 0.9265503475257022 0.4512910113669073 0.04958423266386678 -4.7657413541326834 -0.43980120980164011;0.29439887069852044 -3.1694917629199177 0.41952348863801797 -0.014987552955028318 3.093628665545467 -0.37571220014389389 -0.11202195701273517 0.13306735757938085;0.80176699890914327 2.5821394162651918 -0.84358378939513246 2.3587726988287883 0.81718217819275107 -0.093296694825966572 -0.14209429543113911 0.20621752831066603;1.0038010698104416 -0.33826983573817454 0.20901380193508115 -0.64498694607996121 -1.654449751912991 0.2966168222237181 -0.22653480151454333 0.035609606362413532;0.94246127474378438 -2.3925406308500121 -0.19271300391978818 0.55861952645182056 -1.6492824264913952 -0.97888614019408182 0.72051427144198577 0.24605784530191627;0.53137137838974435 -1.896367400999504 0.66903840091377909 1.101555107136055 1.0989193370546733 -0.22092274617737992 0.24662835584770648 0.22575394331539095];

% Layer 2
b2 = [3.4848363919911134;2.409883149275486;0.62429444216166874;1.6023304652070818;1.3606054759498032;0.040809554718418989;0.76053297018805566;-0.61991233100106102;0.55763008937825187;1.1430602704425952;4.0810093979006137;1.5648676489642028];
LW2_1 = [-1.3446441720712108 0.58097849635431587 0.031227736127642295 -0.47915009277816173 4.5932080771107522 -3.5569231886772092 -0.32149890418268867 -0.053075002171916331 -1.1954864658811726 -2.0513218273741751 0.87323170288001595 -4.7475592940580915;-0.60949601994174851 0.1628046040185816 -0.059474111349329686 -0.40948585445663827 -0.25349701132300984 0.54749346200977178 -0.14509525956095076 1.4794253932423378 -0.36535081607071174 -1.0018047971371649 1.3769998514104216 -1.4355596177634269;-0.62311991223156582 -1.2749768230862106 -0.47949687287617909 -0.58186148768455992 0.29633153937537648 -1.7652142588187947 0.36831062372201323 -0.35693716599013325 -0.58316234627497543 -1.026429633010876 -0.094012995774615138 0.55078410631580765;0.47050643364035433 2.886913017439972 0.4234205524642552 -0.67444988126610872 -0.076661346738488664 -4.95612480097288 0.096159744272723807 -1.0476118334683271 0.99523167865296092 -3.4143981980390397 -0.3873162638885268 -0.09449861271895979;-1.6607389907869414 0.70030014730919921 -2.40037946842526 0.93606686017504492 -1.1261236310442559 2.4642998493931323 -0.5483955451914635 1.5656879894071203 1.2177485979019516 -0.67434906038500897 2.057085915701137 -0.44448420953115353;1.19269447622811 -0.44252216498229047 0.14499854274961413 0.21929510013944573 0.34205979525903457 -1.032074010244679 -0.10979463664529708 -0.77530010411582284 0.54250628522064359 0.52956853652063329 0.5017389474137619 1.975751316057079;0.04097987287140336 1.4696114651205783 0.18874329124181186 -0.93884406309105317 -0.85549804130881546 2.1921127177992337 -0.26436251578354864 1.023247042637438 2.0222723655388619 0.97380932269120968 -0.29153610913815892 0.061467425526581285;-0.27973028057085658 0.74273188844393068 -2.787297903508251 3.5712323822778909 1.3536924047874586 -2.5888919215489459 0.42160228445397868 -0.29827856540034392 -2.49991225086139 -2.077591700278592 0.16948588933338257 -2.7302237495466066;0.60689013332256347 -0.36018085493338708 0.1333826280676905 0.85033465665197383 -0.26795297470722712 0.13600336744478367 0.21036068073118289 0.4606440757225147 0.74111916897728614 -1.0893030724272066 1.6516551538904507 0.82559648544948805;0.52065252533714468 0.13128601488752153 -0.85244294129145448 -0.87202611479604897 -0.15359598942529376 1.2436177983249892 0.10508883846369232 0.092978541416418647 -0.24971440505306872 0.35151894899987551 -1.7255539379307281 -1.3373117583376197;0.81380670850628545 -1.1804079392684454 -0.31823183163358298 -1.2154338797438693 -3.2938190291093052 3.2858303949838819 0.32867884502176481 1.2100520042348362 -1.0383615594807027 1.9412548744927076 -2.168269950023233 -1.6499769468557763;1.030306849085413 -1.0271665605521447 0.049675706610764904 0.86435359817085644 0.43838529787373709 -0.83970065447921705 -0.051653571838585585 1.2972345476359475 -1.0393107818380203 -1.6672653223488685 -0.0033401104327044056 0.5648020890343034];

% Layer 3
b3 = 1.0268836128555692;
LW3_2 = [2.994900555945053 3.4570568511639226 -1.6511540193065108 -1.6728494704338353 -0.35287742998994076 2.6527336274073368 -1.101437926389895 -0.38161810269109875 1.2584163650648255 2.1608811232906673 -5.528012908259627 -2.6515722399546386];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
