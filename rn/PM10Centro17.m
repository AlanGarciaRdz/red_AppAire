function [Y,Xf,Af] = PM10Centro17(X,~,~)
%PM10CENTRO17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:05.
% 
% [Y] = PM10Centro17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.281968137600451;3.74531835205992;0.00773694390715667;45.4545454545455;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-6.519645739529933;-2.8766594467168329;-1.1866392426132233;-1.0665958583867692;0.54542830297866329;-2.6988769944151625;2.2381739550038056;0.57822784242158209;-0.33294569509407751;0.70608312253740579;-0.29863703059515495;-0.55752430274990328;-2.2063054995117897;7.132579390185259];
IW1_1 = [5.7659798122235717 -0.80880734972185941 -0.8108693223301352 0.13922094141002267 0.25674996399226158 -0.057395647491059243 -0.19390692205285653;0.77436027023393184 3.4532716884975336 0.64187263765210423 -2.4071250880747197 1.0700497198883612 0.011412048720243029 -0.18945699182309453;1.0849321202099511 -0.59233950410141378 0.98574229334678987 -0.6290468348105307 2.0567765421175954 -2.9298750662961011 1.5923452798198032;-0.41324206426892879 0.13939450761035635 1.55899432217032 -3.4105636026214352 1.3473831136480352 0.4010939602293308 0.39813222536481879;1.8600171959821161 0.95798342265806469 -0.2310648191718348 0.41114441992435552 -0.2986497988847322 -0.36734917626488311 -0.31791926159479422;0.84332678680337747 -2.7509268495131729 -0.0057122915480334029 -0.0048161594497452727 -0.055347479393287227 0.56162780728928774 0.41354143200979421;-1.2154676906409014 0.24001603606957031 -0.54760572820532905 0.2502037943888355 3.249862363761562 -0.24071038475629802 0.021150966609080547;0.46476813343084877 1.2149423571656428 -0.49306740773577612 -0.79762385182407758 0.51187074262139998 -0.51253447648352468 -0.64985720820725523;0.26019114891242084 -0.32639531352902224 -0.60650506541628002 0.0048078209312100578 -0.61235294477905744 0.083550900140633821 -0.56199592328923653;0.47402749489762258 2.0036390894302132 -0.17464861840595347 -0.045427033972762383 -0.60298205355124357 1.0601042918816828 -0.014104663718715604;0.80421604432843252 -1.3784844823047371 -0.24678483124114184 -0.10788219206251215 -0.11143495021175924 0.082403754954482739 -0.097934088267866384;-4.6471180379685721 -0.38558828158666425 -0.16122005679221393 -0.2694952800852829 -0.10058279771112931 1.3538288938276226 -0.094206240057684257;-0.079465365889339987 -0.51591339179357532 -0.73833132323778528 -0.25010601237360053 0.66127255181435907 -1.3635001845023598 -0.32245058929428633;1.7034901210675837 -0.034045840007666091 -0.52051027756856039 0.18809162738612389 4.2742092285813191 2.5728009843904784 -0.49651159373566039];

% Layer 2
b2 = [2.0939688162546175;1.9362004861352993;1.150974237370787;-0.85713970531326444;0.61492556204869009;-0.70054771420575979;0.27552516618303197;-0.48307142049795504;-0.59909558522099171;0.46925839485013171;2.7062366341471336;-0.10337913729518798;-1.3104720933031191;-2.1335104279563861];
LW2_1 = [0.068755037698115834 -0.65405164279405259 0.33554688678754452 -0.24028274425445267 1.3707017426146817 1.3306237929671167 -0.58279161471495255 0.93297622193469198 0.55481206465013067 0.24441823916484129 -1.2065117519063759 0.80974203897014452 -0.28172371181699141 -0.22000173214807595;0.06320804447657323 -0.46792994549298672 -0.4790299934144307 0.53637903472026638 -1.4714570409541687 0.2593674647077045 0.41044718933591728 -0.21145838225079805 -0.68356461436489813 -0.0011397311421731809 -0.97301348686710931 -0.37404246568959298 -1.1514959484955973 2.113575118672018;-0.87419575858231457 -0.79756629871480422 0.57395422244110594 -1.4885135612304918 -0.50634868055723625 -0.0048401416686204343 -0.63097983167601557 0.34317739829302601 -0.83484714711646035 -0.58639436076992335 0.51418199631534478 -1.0573874179893328 -0.99646253419704245 0.14447183504220704;0.040647927316070614 0.39112584227590153 -0.64347183847199818 -0.17733490218959225 -0.13948140609179266 0.33173197128630072 0.29641044121717847 0.036828018210848398 -0.51474425881731234 0.54423482754814756 0.7439155292261237 -0.16582101452275858 -0.78967077751548598 0.62881479010021901;-1.0700341585431425 -0.0042259812370230836 0.44368963141712786 -0.007225873495916431 0.49715156498851781 0.21397573034399742 -0.85486267056729193 -0.2647938588254079 0.23776467111944691 0.038788223613892475 0.10933713358650742 -0.57862537350597176 0.17731596160688398 -1.1826357554539457;1.2531874424616682 -0.12579621120919898 -0.49617381519781201 0.010345991195546059 -0.37906533161271388 -0.53939158672697596 -1.4604983444370554 0.47335477865812342 0.15497923065743607 0.027170360015813029 0.13553906341812574 -1.4268096107402004 -0.62229839394344166 -0.11955316095497127;-2.2652641652752057 -0.21979521336326421 -1.3348450899870115 -1.1871919509818769 -1.028254731778393 -0.80267743711663586 0.6814741752253165 0.11813273929808227 -1.0287720049119353 -2.8518397128042814 2.5064678280915738 -0.5214324949770357 -1.8696314248692998 -1.6985292667251195;0.27657135210477091 -0.52655691228728652 0.54754236027469805 -0.42371887968293659 0.58547048922346856 -0.45015438186567935 -1.022995513112843 0.19030075584204886 0.079832797056750615 -0.68941112594378051 -1.5395575765474168 0.77664357399556117 0.65506985918627036 0.10204557105945611;-2.6334052726375665 -0.88922065514185911 1.1142987516985536 0.66426488471129508 -0.58798149584041692 0.39122316399482038 0.15333690941175854 -0.8512889645861943 0.27867297246735079 -0.50723918755630082 0.68109985674154327 -0.17778225454780472 0.18326408803064823 0.49295149352580697;-1.366291041504702 -0.5984351809593762 0.18901726338816294 0.88739891487010358 0.72332845612757124 0.22130175650308087 -0.10805118889185782 0.12013963492366835 0.80771164416675911 -0.012003066697882561 -1.3502085411681557 0.42426475613461656 1.514933758977651 0.16603756075681231;1.2853664100873938 0.52989139343009872 -0.53396804178117963 -0.00054904655222272249 0.43312239891829851 0.59241072322389332 0.19627331431487446 -0.30720891836707775 0.018746331081244683 -0.57716783416156647 -1.2074605782221608 0.087251537408112242 0.083321554023265271 -1.1194744252516748;-0.4329415152769453 0.093223264049134086 0.84884589727084669 0.32901079556424412 -0.77690477993177998 -0.27179892071477413 0.63330242851136798 -0.060719886610742492 1.0160104544237969 0.10724550850075928 0.36306511191281582 -1.3622124309462886 0.13489189681590269 0.64713614016056309;-4.0227487288703685 -0.27622891643230063 -0.086755531337762704 0.49992396549543316 1.6669597871744475 1.4160748352583532 -0.28531742517836106 0.15631565265522968 -0.2741522586479454 -1.5804253725299819 -0.67901227993214242 -1.5133638315571314 0.29074315933264999 -1.0636583493651366;0.59704780101425725 -0.60786478082454276 -0.018202327454690907 0.20851985237693196 -0.34322300791644711 0.25282523476183277 1.1497906976548635 -0.9087930309455422 0.12323478057442667 0.084644457666879197 0.10600927090494247 1.2829943853291292 0.67580135253464246 0.18875164156634577];

% Layer 3
b3 = 0.4021097018588552;
LW3_2 = [1.1601502671438468 -0.94638137000026668 0.27922655262836998 -0.76235127358675436 -0.69092906964645517 0.25505059516014206 -0.36844438255947831 -0.59922172681611974 -0.31635587798917275 -0.51515348906146519 -0.48341066362402924 -0.68004299625992359 0.50436700632750198 1.0346188248889587];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
