function [Y,Xf,Af] = PM10Atemajac11(X,~,~)
%PM10ATEMAJAC11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:57.
% 
% [Y] = PM10Atemajac11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00968992248062015;166.666666666667;0.0561797752808989;0.00614628149969269];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.3556712551602441;-2.0048514005116282;1.1316018160524139;-2.7653777905337709;0.33396518116649027;0.72503538671475221;2.0363447006580215;0.6938173549273412;-1.7034013212727768;2.1031295088783879;2.2372492638345105;1.1947854074437969;2.7496601637505824];
IW1_1 = [0.22215474044746933 0.6590352142739837 3.4517533217620828 -0.27468234541069497 0.16371525584400207 0.22307204279819512;1.9440192881562199 2.2596350579313471 0.27269715347884266 0.22445967541536618 2.9410504357039731 -0.85521658348115592;-0.13468421720749299 -0.45894546356669003 1.0446837674148393 0.29047625515861503 0.049570654435549179 -0.21029897096667022;2.556637886797311 -0.6331439132351756 -0.13919398538921446 -0.28966710878544782 0.30675728236517724 0.18611680085891449;-0.16437174800161275 -1.4638461087953176 -1.2375557716367642 -0.34287091943802234 -0.98614214578885662 0.1927660122874843;-0.57443589962240804 1.1279989051980688 -0.94491655871716351 -0.3285771778599596 -0.10032027273382413 -0.20913424696641594;-0.019676843443327673 4.5609859826383774 0.89664071618256902 -0.13611646688749451 1.3013294119743508 0.11046374942690755;0.046314004527594439 -1.1305898175913653 0.65692633011964707 0.41937855349609521 -0.014098580541333785 -0.25496291103758045;-1.3576997497502998 -0.384426148856853 0.35463716177684734 0.71637403713337033 1.2157148614083606 -0.52568863090799212;3.3904696571320594 0.27675397831582327 -0.7184412546476614 0.16136208195329202 1.016648095083837 0.041303899636734122;2.4196908789853935 -0.18629257226598789 -1.7411260856530828 1.5951432263061767 1.1861406417532663 -0.1948023074996488;2.3999924146622753 0.28099745700418327 -0.52881711215044713 -0.61821420406652405 3.400598981179316 0.69432239018662256;1.6649816418728858 0.41284083727632731 -0.93679070335934922 1.0937359037492367 -1.6192400073563851 0.096451501818034358];

% Layer 2
b2 = [-2.0066501505674816;-0.42705728182648073;1.2243547670049069;-0.85658531215770728;-1.1632150233620431;-0.2800076284020549;-0.83025922805798003;-0.54204137191977719;0.26852653323621095;-1.7802188213182513;-0.67086414332183131;1.3943808642300879;2.0949742590175133];
LW2_1 = [-0.45097252122899201 -0.44491074919299944 0.061697071384506023 0.36121074883168552 0.76252241831098666 -0.42785951892229296 0.007153056920191146 -0.95018051678878168 0.23914990227992161 1.5352414334103095 -1.3004119764550184 -0.46052602960827621 0.98341971669766493;0.61261048264798268 -0.36768243250275834 -0.14131103529586025 2.6212460239831805 0.84329359826423178 0.93763559781276806 0.03755506035840734 -0.037658409763825201 -1.0764435164011161 0.05338668456837501 0.73780602250831184 -0.90529850825452973 -1.2841255319589508;-1.209817967523688 0.98970661055278397 1.5049600087188082 -1.1144488341875103 1.7012120532056048 -1.3003885429344155 0.98278352103242872 0.078518157115929618 -1.3053214081097531 -1.4260377177440939 0.046062841681412815 0.77250089818605805 -0.82585425427221493;0.01871036471262881 -0.096617172555506475 -1.6402772452667089 -1.1274361609014505 -0.18972056491787637 -1.0313478203629083 0.021835050447419492 -1.8609014203153118 0.65312911359095949 0.71695764029833775 -2.0234436452202433 -0.76725490675110797 1.1562742153259515;-0.41633872601817662 0.62405456358700251 1.6792449704481436 -0.84851416633836263 0.91300866900334288 -0.67366603395129854 0.54897651879868403 -0.83627206937607168 -0.51026244779275376 1.5794294063705629 -0.89872957774681728 -0.39156362579878118 0.26986579678860967;-0.12722288787337427 0.33635339612744147 -0.73955459277558366 -1.6580159483790122 -0.38630892532793432 -0.10954664416811438 0.30964459675412853 1.2257968167655446 -0.72311977645702863 -0.17196397514383052 0.44332218534614592 -0.11193209834148266 -0.68627265034146734;0.38590150494138675 0.63109506685499683 -0.0038588726990538558 -1.3504247337539332 0.11372978689293262 0.0095844414539627693 -0.47622242264583536 0.42895602924779697 0.80170890609817735 -1.3254374593828957 1.1101397630906034 0.76448381945996047 -0.43410423535776105;-0.80028978422927355 0.93465017630993541 0.41928803110279333 0.19863847618113376 0.79557077165167878 -0.26727444908043763 0.52664467486744082 0.22134233722833277 0.67335150893715623 0.29346033287393114 0.095037065832813697 1.1215828258667484 0.77928846522705086;-0.18601034956265428 2.2285674236744821 0.51971085120476079 -0.088338408981855993 1.560284862798504 -1.7429830553389445 1.384038449113782 1.536717338720953 0.98215058777762054 -0.10856178768413392 0.75044418048067363 -0.84587770543442498 0.26900204195536997;0.29353073515483519 -0.096816485507355346 -1.4287465744778407 -1.5754427598465266 -0.33634171913880423 1.3579190678876374 -0.21416299801162819 0.013318645403549299 -0.0020085572676414951 0.14584987120110801 -0.16785899686741437 -1.1313563614635285 -1.1942062061641736;-1.9897643982335191 -0.073705016672023782 -3.0162620218299505 0.68829774510002983 -0.13739213492416424 0.22055667661243838 0.48109666469774182 0.79381164526171999 0.075879041807013672 0.56651304495985988 0.94950512372662377 -0.078171784340352005 -0.5517784877019527;0.5699252245044546 -0.29615300171703335 0.94922363409540023 -0.75824892789810727 -0.20600443162359655 -0.93088273034982272 -0.64919233106886787 -1.5208840486008381 -0.97189560486962412 -0.0020671961905150736 0.12321745207187847 -1.4050434529882918 -1.7725652604417996;-0.93866601483039336 1.1714177087962916 -0.89627948408608715 0.86166565316302457 0.32418084182015999 -1.0114915529746604 0.67601848766059169 0.347889495947595 -1.7676289479275671 1.2047796865898788 -0.04997444446325422 -0.94881347808622618 -0.70903111095247262];

% Layer 3
b3 = 0.20532333318981544;
LW3_2 = [1.7484320801452262 0.81165319313548601 -0.43507240247724577 0.29281080258734116 -0.68541970239506778 1.6909587932612351 -0.89059408922878769 1.5103786820107097 0.2015722270173049 -0.7496015178215748 -0.52715810391185958 1.1266234106344115 -0.65431842642965898];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00968992248062015;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
