function [Y,Xf,Af] = NOXTlaquepaque7(X,~,~)
%NOXTLAQUEPAQUE7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:16:17.
% 
% [Y] = NOXTlaquepaque7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.03490136570561;19.6078431372549;0.0212539851222104;0.0523560209424084;0.00632111251580278;0.294117647058824];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.5962229777199699;-1.6807808366796302;4.6788293380205337;0.90525763257041048;-0.030198237723780073;-0.23199115092885511;-1.5557052849434252;-3.6462883584175083;0.77340173524499856;-4.4099243725479038;-1.8483125935703484;3.3251158128662657;-4.7528299133854253;-1.7506731405138549];
IW1_1 = [-0.074714164051105758 0.69163938338451381 0.20600773089377195 -0.0083051738894017371 -0.57712191126240908 -2.1445929712670324 0.54435919002724542 -0.33073810571467471;-1.53097668421241 1.5581754472919502 -0.22957347474340126 -0.38412083291605503 0.68263951259924882 2.2076638841020024 0.26116043990234389 0.31430069674580013;-4.4977816578564793 -0.51603349714452618 -0.75388342099227768 -1.0741419754977979 -0.49051340198879512 2.0077996544765386 -0.41359269556054634 -0.0075664768292925139;-2.135584358273555 -2.6207309468530213 -1.4044098735683752 -1.8120064130100346 0.061975835590178829 0.69474883125083697 1.2295850150006515 -0.30480866210793323;0.90820755926436481 -1.8736078401202974 0.010549897329548469 1.2553595269927524 -0.27479446541917324 -0.33346216505380194 -0.072765477072608983 0.16094323118561552;0.68974152139918044 -0.82470563401465524 -0.021768050323720384 -0.42160241427302853 0.48529320520551944 -0.080671302813351761 0.041076047535849522 -0.2908726893858915;1.203906193531719 -1.9442255913802331 0.26371893942140484 -0.081712449339406121 -0.50118269390978099 0.75071450106516191 0.068764882264916741 -0.116449339106993;-0.26932314043637651 -3.3149096686883506 0.03266475937696485 -0.95073600803821001 -0.25760401615222922 0.31529213647275078 0.012900184619619353 0.16309358479363811;-1.142579115600354 -0.81526512572156618 -0.1418834493986581 0.98759140746490126 -0.94831964916345335 -2.0890487699139229 -0.071705494333379735 0.30924105377266731;-4.0547437063997984 -1.7150794364814006 -0.39120740864725029 0.16825713758320879 -0.88928178471412944 2.0449564925198334 0.24552711300516228 -0.11950225796559338;-1.2224084359985088 0.24900342679687149 -0.27006187809279281 2.2166426201858966 0.28419442223216651 -1.4416382916588588 -0.20122260325546107 -1.654083109039294;0.66482180494567178 -3.279151793921034 1.0665861642497136 -1.1603578066855011 1.6970290287900434 -0.80970990345795446 0.23289847150023013 -0.49751491002614789;2.1016265788306687 -1.4445774357129588 -2.9618994709193447 1.1872104055067561 -2.3253997318394473 0.54686059292611033 0.013424108288973762 -0.51387753036612582;-3.2239007655532781 1.261216201732847 -1.7006366220987097 2.1530797209990093 3.7443441841609304 -0.63848081325334549 0.28602011086606099 -0.2146670349230542];

% Layer 2
b2 = [-0.42206973282725024;-0.15564818466118976;0.96871526709623124;-1.0633560423557538;-0.72482925181277258;0.57755300885803573;-0.52853080377092398;-1.4531099036045947;-1.9986686052291114;-0.58270468659442942;1.0957636600581264;2.252390023855853;-1.4822318958044065;0.60502933494469624];
LW2_1 = [1.6663222275748224 0.25139300829839301 0.74069078006660749 -1.0378655981033988 -0.36023546408454621 0.32400556427869098 0.826590533228445 0.42617892816658431 -0.057478753540985666 -1.5511122377562621 -0.18585782570489029 0.086138253055610389 1.2191961227589265 0.15538203866704225;0.11325648938997541 0.37689426798734732 0.6921612694149385 -0.040920092682924201 -0.75846908681448111 -0.44426001018542244 0.3364353950700642 0.93018961397823718 0.53589186426415769 -0.26617516460373203 -0.21741470672720317 0.67104660523690673 0.71953219841670757 0.066656867568085976;-1.2736190108759156 -0.511452438977263 0.11506298992945918 1.7660526462884676 1.1983789261191535 -0.59264172792345615 0.99807423227457504 -0.50498414790698121 -0.19562162563281435 0.74700262657071026 -0.21192225687282634 -0.4491109748469011 -0.61256545123781536 -0.094743484404168118;-1.0922184547814953 -1.6118070246803515 -0.53186898044410591 1.5096021549487646 0.86643147243246743 -0.7836397563715205 0.15432848889296677 0.87424556205937487 -1.3807686490815381 -1.6523167761368704 0.54164479487366068 -0.81229372226891217 -2.3443988040848591 0.59071683964869848;-0.27740883769525332 -0.9953034731215511 0.025803940381666779 0.80038702995368616 0.15005885516955175 -1.3887328650545789 0.097447361817337166 -0.95002530190708578 -0.045412006428616418 -0.91071332283693196 -0.46279819724687887 0.034960762255771785 -0.30445900228858463 0.006100640942188781;-0.23539166775271403 -0.87822694447097516 -1.4172892446779666 0.9921885226627426 1.7315402887551503 -1.218273571545653 -1.3259765568550168 0.46305983202650558 -1.0025629778831198 0.74227823344316335 -0.3029104611505366 -0.61133708157629674 0.12729962046908652 -0.072881450887658322;-0.61999858228333127 0.16909718742871854 0.40615103133450681 -1.5308250687876277 0.37830564193467608 1.2226646528417047 -3.0418165620869613 2.2131924104741953 2.0627464035808107 1.054017135078186 -0.70763383426369963 -0.13061658268304938 2.6270853590888628 1.2438906064600332;0.93981409387810166 0.25071794164480499 -0.36510064320655777 -1.311004733584521 -0.47655606406384438 -0.37265953865152612 -1.1934579313698481 -0.90523805563448989 0.018277625830785627 0.40786118736719001 -0.3768829023205581 -0.40751506378467489 -0.22599505587092364 0.027151514532821573;-1.0347924971745956 0.42043273159692562 -0.38483333805504977 0.073923526254223937 -1.0170308358564826 0.90242017649975237 -2.047877291473347 1.8563201339383126 0.25968419084165029 -0.97870181572859427 -0.82574860469170486 0.96935181174329788 2.0342381119238766 0.041196149414971725;-0.88306228779422735 1.2969645533895056 0.42352775887025107 -1.1418024336872299 -1.1331940151745452 0.75683918472904876 0.055129911311199209 0.34320280569454287 1.2128375901264914 -1.3923399367384739 -0.54368492080201869 0.59177823966994159 0.42687238606638161 -0.09778033114023206;-1.1447521358924351 1.7751963463942164 0.83909194738024251 -0.44430971395701602 -0.99488870217652559 0.10818980648987975 0.85182730217037783 -1.5910503412308892 0.66350891527243727 -0.59259246363805329 0.1578772061438492 -0.25839395077805882 -1.0356353851081657 0.031790511340996766;0.69138501481302383 -0.68806626970386675 -1.8677038757933757 0.54288487497022275 1.2392395435657577 -0.18841383525279498 -3.5456425141657237 1.4351444221226197 -1.4516834038449602 -0.70323918849451406 -0.33113552830244719 -0.15810979663509345 0.73125794484224771 0.056454761151082097;-2.0354085986907906 0.014528870786967076 -0.76980304545857503 1.0387959469210126 -0.54348397693185446 0.91353135170481359 -0.78735510921377527 -0.5223629931833883 0.5061066013242207 0.11662334768030007 0.61536729272580992 -0.24722764298653718 -1.9204635425823799 -0.17253071122974842;0.51994338365226433 -0.64774557077650319 -0.73845107757892969 0.88118688659217792 -0.44577454869741245 -1.2444876696334066 -0.35129455397193993 1.4482803392538359 -0.58797001283521455 0.42786797306337609 -0.14764636105012316 -0.39985161189810475 1.2381654297653184 -0.0077092790275414651];

% Layer 3
b3 = -0.53454407252263914;
LW3_2 = [-1.3058631935654319 -0.87138619071003753 -0.73988827993623785 0.29261835076621134 2.0220550495863012 -0.75949023300371976 0.62090153922525937 -0.7819721840231616 -1.4157444446416239 1.0338361943304415 -0.68957939232713228 -1.8812664041385769 -0.84709178880030023 1.2216307060882776];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
