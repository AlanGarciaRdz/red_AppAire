function [Y,Xf,Af] = SOXAguilas48(X,~,~)
%SOXAGUILAS48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:21.
% 
% [Y] = SOXAguilas48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;14.4927536231884;11.7647058823529;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;95.2380952380952;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.1484135960410025;-1.3945991250339544;2.6440981494056528;0.74556612105802655;-0.85823468635393518;0.51318001312992501;-0.55497712475967564;0.86646656438703484;-0.074413978332492303;1.5320323038920323;-1.0995837367268348;1.5555593050768337;2.0312394272356711];
IW1_1 = [4.0418512982531984 0.029845308811442327 0.026798422712383842 -0.21795486854470908 -0.17643186044089013 -0.054747776597871757 0.32554845770831559 0.2607775825314772 0.038836571338454112 0.20092992470218812 -0.49073981377151965 -2.2326372707314803 2.1579218597087477;0.70411210359106868 0.15595778560540227 0.010016853529810642 0.10769398755030161 1.3230087283444232 0.25091339963152504 -0.048036066352361621 0.50880747877543764 -0.23364466869121675 0.20653202481819932 -0.42487196650659725 -0.24434798367422522 0.89270903489013931;-0.59101301434679521 -0.14733740483421295 -0.10067966046203501 0.55594452585313203 0.012277847243213715 -0.30431283447391894 0.1084114859542314 2.3333815353074137 0.25917488886169676 -0.14039748181557998 0.35693461683936878 0.074833070839209231 0.79268876858536297;-0.08513807973678239 -0.095606819113565347 0.33906012471617869 -0.36772227577538041 0.37946504917525181 -0.35319571038886688 0.40153120750251475 -1.0577746699701496 -1.0289864997134595 0.23562078218145074 -0.17504568730046707 0.96552336711687126 0.29077297046763034;0.82032505972831893 -0.20460533038771808 0.090813105354828227 0.46425535492715819 0.26933878797475053 -0.21122512507289692 -0.4141372012324297 0.34497951352047507 0.25625935918627141 0.016615399801565133 0.59773199433934199 -0.32634679380678439 0.22295264084665614;0.69702598106702518 0.24452792992455138 0.0076836838160863896 -0.83738766655114572 -0.033682634196308528 0.73911935943785589 -0.2941829999662221 1.4192879318353282 -0.33976514156860382 -0.1922289471436687 -0.4445231503298836 -0.28336460193288798 -1.5862455938144735;-1.3494832865012438 -0.10121243794893825 -0.26484050198089915 0.74553922835747266 0.076984487834024479 0.093118170823867641 0.13220681933788336 -1.0798849263529227 0.199971392416084 -0.4858173540829972 0.53086602446778675 0.12556339699021374 0.41963563631460116;2.4912208514467151 -0.14963092335395783 -0.21705254208413002 0.34051085978301548 0.5655778929327947 0.21862660030605874 1.1100546021806059 0.71578424646684402 0.11090552558039633 0.051559113499586182 -0.7842436163361477 0.44090926551780912 0.69947575306240983;-0.14169102534715655 0.40242763084906596 -0.040543135089737947 -0.17021755179321893 0.59740948166590102 -0.92930397387469521 1.4986776068379193 0.80354219827437212 0.97100141965711584 -0.20698842324766081 0.035894918597674116 1.0266273756374238 0.23815348647605009;0.10872353770150033 -0.37392595325826389 0.080897841386696978 -0.75853715736355543 -0.85105206665975663 0.68305806385839352 -2.5090511592798368 1.4078174572547686 -0.93680711816564655 -0.20219590601514595 0.39806101960868356 -2.6634763157327619 -0.55870957613840089;-0.38884748728430235 0.53247315263884887 -0.1302988061874702 0.015852476543202744 0.19596480667830871 0.63534801928695583 -0.91969820864272789 -0.32334229229874412 0.80229653097298392 0.12291700276278301 -0.017044255294202157 -0.033691140707481568 -0.63172662998013795;0.40393900921666359 -0.37146916317975348 0.28292000805777057 -0.32794704564500193 0.045931182474645692 0.35438061190156428 -0.64455746983260864 -0.67258005406377641 -0.12190784319868085 0.57851427981081982 -0.35337948168188149 1.0428400453816562 -0.81938126421861013;-0.16716980026800399 -0.58590777408569406 -0.35385516318783689 -0.059416678664172523 -0.34074361194178859 1.2551004025996424 -1.0673211189238367 0.11620066992238591 0.57174705646806734 -0.95647869030127919 0.8288041680524072 -1.0854054405937319 -0.81045597228450561];

% Layer 2
b2 = [-1.9100389269637401;1.5794004038988496;-1.0390143923005877;-0.70609895203984696;-0.58125197274904605;-0.095100786290617134;0.15057781454875674;-0.3961755831138517;0.43918259962451273;0.75473886207557783;1.2844592317542982;-1.43389993664808;-2.0044082410089228];
LW2_1 = [1.4928453604251903 0.099643803121113969 0.79535891241779866 -0.54128271319507093 0.37227544886656261 -0.059439257886827294 0.038512898724306785 1.0012050509206634 1.2316887930836513 -0.092596230522110676 -0.27528019616923127 0.51778985807194622 -0.50774678974512144;-0.78046486699647322 -0.25687077730733876 0.58672699371173198 0.2616569831326323 0.1438385384493607 -0.70758599252273113 0.31481566754972551 -0.6707011024858428 -0.55711386702851562 -0.23373808940140414 -0.068470606885359442 -0.55506279776898926 -0.60412833976009128;0.62185482837436701 -0.5161002590123891 1.093509750708318 0.69112056386396969 0.48166168354808331 -0.13164670990331473 -0.7950331688763892 -0.0022620983777457138 0.27958149951081873 0.8755618672051777 0.34518408146452123 0.70972484481957676 0.0065856571377160113;0.59040131677303631 0.14684879967844647 0.61316571053090119 -0.042544987929742477 -0.70655963818089207 -0.76822261688753068 -1.1052265538878496 0.074120604929359554 -0.25663463639057027 -0.34645809998890842 0.14863216421924674 0.20841774595431217 0.73384937349676838;-0.47683422376900142 0.83804582596137878 0.19353175226094865 0.4325093033570977 0.78295717994659098 1.1226284785207101 0.10305660824431684 -0.54722193237827066 0.4011397708810075 1.250533119863273 -0.064772820545152224 0.32162893013817595 -0.49131465407063984;-1.3394663796177924 -0.22887099858225102 -0.2939240142007235 -0.15672880496947808 0.89689619351378391 1.0688190344994839 -0.78597217131990216 -0.26827906807216312 1.0794067703556365 -0.83552303975724329 -0.36367985343278658 -0.31861674589128269 0.85138328036931687;-0.23800310043916301 -0.78815009227532917 -0.31715573911161432 -0.34366549604794266 -0.49780630135727216 -1.4093605403692417 0.73793158913212376 0.33140650891138301 -0.056083408228826896 0.4817236482919805 0.11898628003154721 0.21940334435198161 0.14472582795409758;-0.10282770606307574 -0.39500357711745299 0.86741559554100423 0.21496797833664821 0.43960191649363012 0.20037471639794674 -0.39792370481307138 1.3740600599606245 0.88387614139243853 -0.53788963798849843 0.40446055077299387 -0.61661130990575863 -0.33562666151869763;-0.36465697389166007 0.59232605519739212 -1.4474071306198346 -0.054800611671789241 0.87801087943632727 -0.078140450388752655 0.57127071344712876 -0.096795915056380716 -0.68372680888383974 0.036820036269490389 -0.17772375312008148 -0.66455704363601287 0.033677877636582615;0.35550472571987207 -0.37936394019109915 0.48729537484417801 -0.40895962894587529 0.74728023407117306 0.96980626798503777 0.098250952145989223 0.24192824205788097 0.4948631322284156 0.50484685880779201 0.62488157870812922 0.088570422127029716 -0.56219044436639165;0.94054857977398088 0.32701763469864592 0.0070701688734944174 -0.026953923697522614 -0.63028033847504095 -1.1333438034641306 0.49905283155825042 0.42863389137480973 -0.86554790361173584 -0.039492946291067602 0.24975762385603142 -0.17757283323273415 -0.36454201618874338;-1.8495044562271621 0.24389142685889456 -1.3677100025569644 -1.0456377244929032 -0.33126527002224176 -0.89817282361926565 -0.35456087186067303 1.46635117665464 0.94917098631650498 -1.4511312552085189 -0.53880778091747827 -0.47294319683924246 1.3043887870404915;-0.46992980942583945 0.13080079203853401 0.23651278566516959 -0.093936868124180686 0.052112473021319633 -0.50822664918768434 0.45290681207635447 0.32290766139428462 0.60746549732368815 -0.64549574579022662 -0.53083716274555559 0.26565158384320026 -0.34147382852001168];

% Layer 3
b3 = 0.37051572663249405;
LW3_2 = [1.0942835497483248 -0.050416897338533315 -0.48969290148579198 0.53485259548892961 1.4238811953671648 1.3746997308540974 -0.13709910079151588 -1.1217756989186587 -0.43127110610213587 0.018779630600493463 2.390983792515851 1.1947695969821852 0.093448662698633528];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
