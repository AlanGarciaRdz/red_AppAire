function [Y,Xf,Af] = NOXAguilas7(X,~,~)
%NOXAGUILAS7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:12.
% 
% [Y] = NOXAguilas7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.5468303868119495;2.3682018584400444;-0.10552422579750999;-2.9639093433789392;-3.0572106324673265;-0.76250791876053425;0.013945303614088904;-0.0080700694142478713;0.4743136563255288;1.2951746379693105;-1.4148065675664849;-3.7209656444625172;0.96261906236336148;-0.81174012652343963;-2.6737066539454037];
IW1_1 = [-0.051307974738388912 -2.8729520165302227 -1.5483834070646634 0.53537889201779332 -0.54294326279808525 0.046906312852969999 -0.24220773591269354 0.60667327918061953 0.25366341884090332 -0.28895977856674804 0.21973837068601504 0.33013800848386421;-0.99411862858740119 -2.3363242693221715 -0.29824542630184092 0.69362273740506819 0.59079854442308488 0.089394772529345565 0.18808640517970601 0.38702241489520117 0.1033546958115453 0.30420687835266796 0.36837620975183499 -0.48680156520992024;-0.77127748232123727 0.29213193330610004 -0.28912079751013647 -0.66698780390551038 0.81741699255785238 0.38321061465128936 1.3729572054113899 -0.15477621708665765 -0.3114334902660974 0.69775987919850124 -1.099161421411966 -0.60575218687080046;0.78871050468595028 -1.3185413567876867 -1.0980185719944253 0.8736822383584999 -0.631392109404042 -0.46909665877068257 -0.64732241953701353 -0.73553434807792928 -0.41310757148634192 -0.22435842663274988 -0.31726237238147498 -1.0167843132317362;0.24220224878645968 0.26656565702946827 0.011522879879375409 -3.2128288253684354 -0.24256378501482362 -0.052234701168120325 0.46107348362306716 0.96890184837279802 0.029049389325957325 -0.15064355490956993 0.12457390991199044 0.20820629733175197;-0.2988759614056416 -1.0475741386701936 0.037791587741091572 0.68707476579393645 0.78418813966082079 -0.16292947834846069 0.34215142689937067 0.60984728188743786 0.025452592343420646 0.075858039482560966 0.57605392031111069 0.074224484555330816;-0.0096081960332479056 2.3209911265176544 -2.0330990442490458 1.1747116078708388 -0.88770848896172749 0.16820156859337093 -0.39884813271918584 0.23712369332548439 0.34675715723243267 -0.58907837462840629 -0.46634717716937152 -0.59265963456296256;2.3214307173290254 -0.024764420148163997 -0.68432416789965467 -0.45440319200819707 0.19665111194424301 -2.2463615648640838 -0.067657793431922089 1.1321758362833407 -0.59167893121013104 -0.087532452568513469 0.11275060253727777 -0.054678769729421373;-0.25329161544675149 -0.059432864316698635 1.2449888548090853 -0.48555828561569087 0.27178031003554126 -0.24510919448247251 0.11030930686166183 1.4124525525329288 0.54911320474467795 -0.091208046819279381 0.71906206064547584 0.38473945001934973;1.9065277275569625 0.0084090273231285251 0.22673393539186418 -0.82267301567198947 -0.12988039419626343 0.27296801044791696 0.13233920801944815 0.81973450708203888 0.015224601583346665 0.12679195717937933 0.31533627074304688 0.53609070992320418;0.15027784227775379 1.1743939447117715 -1.4950862997874683 1.2160797773553755 -0.46238190108291144 0.19677827287392874 -1.1081914538580226 -1.0766094172012795 -0.8094443451253609 0.52864298598428694 -0.24625741647435723 -0.3617009518008053;-1.9178484288620283 -1.710589961994099 0.89571502160738681 -0.13817767758336216 -1.1167987130441381 -0.43358197002527893 -0.69627920801828391 -0.14037932868611852 0.68215686714294088 0.41837436916269888 0.54441202999493477 -0.58132825867528926;0.28288093773056389 0.37877004444155565 0.27445878119939021 -0.94962663161530392 1.2165521532367132 0.2318517216798886 -1.3577456231848017 -0.92152503349039327 -0.6489123939289374 0.77129136178680724 0.35730659252078162 -0.17395171988122976;-1.3593523157049001 0.013466830828843111 0.15609492166603772 1.2034943002252956 0.32674358592919112 0.98989448607308916 1.3998080714607894 0.95628254123428547 0.8045536118012111 -1.1088195405719545 0.15570773555616849 -0.25209339612380827;-1.4486372954542519 -0.97575097303905878 -0.21398129759785134 -1.2987681151013262 0.61737759122582325 -0.17601952082351449 -0.8325408523122364 -0.56177626268847158 -0.70745365013475259 0.09003437873442309 -0.037369280595075521 0.12112356216235293];

% Layer 2
b2 = [1.5617236627295568;1.6376399246360289;0.94200628681950094;0.27887635067277478;-1.85728526555892;-1.129222035721835;-0.32019232966095268;0.54272301169982862;0.36985932579198144;-0.95102520972768079;1.0417528301155259;1.0104625256180861;1.7194226601074878;1.6433407131228472;-0.95127753266913706];
LW2_1 = [-0.97875235457120657 0.0012446011132135979 0.49430233208855034 -0.80808639691042572 -0.71606793589999296 -0.35723576776436711 0.23678892267455287 -0.38183283132835372 -0.14243174458316885 0.45809729146007905 0.037739800817099926 0.2897704248420781 0.35605117810373127 -0.44341678887511854 -0.76816208899062322;0.36749683566089897 0.59902046696267441 -0.063839590243498195 -0.59456492742926514 -0.1816005434019905 -0.12774901467893654 0.046955103966680678 -1.1118961365491189 0.60721704008515132 0.2313574231243313 0.52774221757412676 -0.82391321102013115 0.37359414817302583 -0.39771735985921131 -0.78226681230229134;-1.4954160715111176 0.25968695465568442 -0.38239965195938841 -0.97629972892612626 0.46973580396540082 0.41668120172095091 0.77873045156761322 -0.065139010424491439 -0.020665652046500296 -0.12155486191498949 1.8332336134750544 0.41690940295688994 -0.10124766620082654 -0.87951563253523091 -1.0001863268880915;-0.75613024819433217 0.021585749066675958 0.32354449351182568 -0.42632510599017076 -3.5231898438454694 0.0028339946406855457 0.029721662178139294 0.88582990343124113 0.64828506334585301 1.3715352729601478 0.088196173348628365 -0.059318276389342027 0.17467509185510896 0.60694371368016564 -1.019383411211046;0.24183727976033118 1.4546175207160583 -0.84988310435284187 0.43897251410493532 0.14062327021228871 -0.059039519564500639 -0.23144445423601154 0.47961672218371931 -1.0684161101035341 0.94839773546645589 -0.3957314833070289 -0.27626925825571141 -0.28668378215405954 0.66959935985061925 -0.38666910134380295;-0.43851855908615567 1.0279615042257777 -0.70971337690245317 0.65916036479827411 -0.068944441916985066 0.77184875961703603 0.221263470552407 0.34827938816214737 -1.0688444988020651 1.4666585815856878 -0.7421457777284266 0.49754999681186185 -0.097775732027678683 0.52498005385806834 -0.1811045054629237;1.8635170086977424 -0.86056845648514912 -0.084789203000698116 -1.1786458621381382 0.48414057048440118 -0.18116335840821757 -0.1054893671300421 -0.43481405008375806 -0.033594590331338214 -0.49845267751595668 -1.2147459440783066 -0.85499372402931662 0.82727985544349114 -0.16884047910732239 0.6296570117736503;-0.87816100814035247 0.30309221117642582 -0.026834847542771385 -0.60823847890273641 -1.5849603442859586 0.31195305683629077 0.77603145381599958 0.15048417240265974 0.056353869775191627 -0.26589975251133502 0.065581286489254501 0.023699150132169736 0.12532700574024097 -0.42296642387768868 -1.3399826017594443;1.7079177073315801 1.3683572932338179 -0.73803638286172102 -0.44635604190453837 0.88192314260581695 -0.99788080711960458 -1.2628818135490252 -0.057561977183344382 -0.85243743782597103 -0.68415780164814588 0.57387934076330516 -0.20825129185889654 -0.92730020123521606 0.30620913989849069 0.21000075747841557;0.58515479441497942 -0.091252114262812184 -0.72785943081690363 -0.89085747279296623 0.36774406932028164 0.66100712378003179 -0.71329022132013997 0.57412151295923342 -1.0215518105660542 0.40018987757408853 0.28187798049182344 -0.5751517544367869 1.0047202250343228 0.39285161734710472 -0.05497490115875879;-0.78051622214695948 0.2685195065338421 0.090025145815973318 0.95595726636318334 -0.52757991450320263 0.25706001199466549 -1.0959513558735892 -0.41189964517424732 -0.59801190268359372 0.87590116569920629 0.12134681721067093 0.068189582789473013 -0.68379350383645632 -0.22457955555963832 -0.47829009732712235;1.3843258810855512 -0.50170763690084774 0.20140276384626921 0.91110390499011618 -0.4911427245149797 1.1455999367294076 -0.54890957297884913 0.44804995569370243 -0.30162756676690183 0.2288916918075011 -1.5376873419433037 0.025100991645705027 0.073233408469865036 1.0768675013622975 0.97109153907994061;-0.91491552467785442 0.022328312981135807 0.12925481507110237 0.58567752919728389 0.15332993700390729 -0.31109600136299037 -0.5059805568217981 -0.86258291815483568 -0.94162914692916744 -0.088593536297686543 -1.2426381734259415 -0.37401011873662565 -0.25703358995098036 0.43203526121903602 -0.66666065707914279;0.92105925485165607 0.52083716871097785 0.048793106873100886 0.039168880541502325 -0.34631926139611724 -0.82453792755903998 -1.1491628687138211 -0.048852992853280375 -0.31486992909022787 0.54730103222913129 0.98146493600075613 -0.057473817485862957 -0.25626740740374176 0.042965953202702356 -0.53563226369219763;-1.1758572193986678 0.40216521885177087 0.22306484432543633 0.819545230846771 -0.66377978951858707 -0.61869006330979448 0.020819893342792134 -0.12564702352100898 0.052248563421543437 0.60423557877671286 0.58719035596295432 -0.081601761894994698 -1.110480374250276 -0.16795881350606029 -0.019023438400804792];

% Layer 3
b3 = -0.51642886841594904;
LW3_2 = [-1.035965922128413 -0.73787248051290955 1.9310766250491118 1.0322719016258102 -0.66337390912835981 0.67563898892501562 0.75814320963655457 -0.85651095876010386 0.20054116904364749 0.38941151660942125 -0.76566359438034182 1.7908571179153567 1.5732087523899423 0.65879998571021081 0.87840934486059341];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
