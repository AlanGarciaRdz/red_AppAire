function [Y,Xf,Af] = PM10Atemajac22(X,~,~)
%PM10ATEMAJAC22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:00.
% 
% [Y] = PM10Atemajac22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00968992248062015;166.666666666667;0.0561797752808989;0.00614628149969269];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.6326292187746122;0.081291491137660515;5.8554673322957065;0.75483440750576014;4.2471774540128351;0.33016770659118921;-0.79687479620821056;-3.7127606927762753;2.0581873482346231;8.6669028209147712;-2.9403835155079072;-4.338395882918169;10.760310957807114;2.2302113551272091];
IW1_1 = [0.11524931320126348 3.288105518131279 -0.091443565607996907 -0.006116564788128412 0.057085872012273421 0.016818340901626108;0.1128569738245636 2.4561495008742207 0.075457702145360808 -0.038486103722280229 -0.27657013428901672 0.049451576703088383;-3.0686348819713114 1.7275056110301399 1.1288640900103977 -0.31363864182074686 -5.8711635439874303 -0.025600533465312526;-3.0173801522719925 -2.5620671407751807 -3.3792517943242255 2.5973651403980549 0.11180283871330446 -0.2491137576772611;-8.0885430009354398 -0.79650793437519862 -2.9558627830529502 1.3463749237198683 0.99037654439934208 0.43071331008214753;-0.73199929699602184 -0.096746543540925198 -0.49915822245696184 0.45418089705164416 -3.4840495159237808 -0.37314824119990836;-3.3301696050194427 3.4739114008007945 -0.22497987024332927 0.86617169306109687 2.5342435073863885 -0.15998139899591274;-4.401213765370473 -0.55359721004624873 -0.74929197355813959 1.3341626200389112 2.049428993177802 0.4812055235963264;4.0007963631458585 -0.046278169580803198 1.0257349289182349 -1.5321540982612507 -1.0480755989882233 -0.39618924252448517;0.07373917105589213 -0.23203811928907819 7.9242291875470219 0.2162428834903021 -0.12132714012745735 -0.0061081519216711587;-0.68525362861633177 -4.4082521899043732 2.7979323384304275 3.5864428617496285 1.1309362944467598 0.86255480524272554;1.1011927617155366 -1.7283788088353131 -0.27154480900445865 5.3037066230746728 0.29881977407051896 1.5149855301689608;5.1965548827025607 -0.99737338116730268 3.1275352328111694 5.4638699674690345 4.2814371112047764 2.2884043790956992;0.2673052395548195 2.0471930183600335 -0.12166421088521832 0.61013623471905909 1.0190436593477799 0.32952103338174854];

% Layer 2
b2 = [-3.0864229379110428;5.4800026126449186;-2.5563472911739145;-6.9172136944438289;-2.0876213315031316;-13.397203848905191;-1.7668311757733233;1.8980640916647666;5.0499455169628265;6.9843332141901371;3.3898569013757456;-0.77952960303161101;-0.66617095370181323;2.4801018144730209];
LW2_1 = [0.5301097496672541 5.5414481792443366 2.0142382917386468 -1.1274097921863462 -3.5193832010036354 1.6792591267252968 -3.1663350762640419 -3.9074533058417376 -0.15878046667237117 0.01389981938762389 0.23220064603513862 -2.4575771291115585 3.6814028999317432 2.1902992501978806;3.5099305053903569 -1.3338278533468986 -5.0160239262161959 -2.7346683861810099 6.7773821898669002 4.9054888684121991 -4.4319688264535442 4.5798543835132968 -7.6478194531688439 -0.019216143116814799 -5.6523533441517975 -1.9709659875775261 8.1332033259216114 -0.015365437398173717;-10.005634701482364 -1.3468719724782492 9.5466096726790042 4.1018662060167044 -2.6895513288385668 9.9116368461293494 -3.914618916369625 3.8755011435177846 1.7160416596249441 1.0913348113997865 -2.6701827229608162 0.79095477353766441 -1.5886071431431281 -7.9998352249010249;1.5621820201580328 -4.0835561670440619 0.52342875673790423 0.18025630776327067 -0.19555463804584552 -2.2029805508516547 1.7745118422201303 -1.274127421701619 7.5454986533294557 -2.4602102689636647 0.39689880523429522 0.84190217100148357 -1.0643453727267058 2.3004899071578953;1.1400764221330555 0.66560566328737547 1.0449140500499456 1.9720744087118485 -0.4012987799463793 -0.78881530985701798 -1.1953071544887524 0.62207017906977602 -0.64947667860627945 3.5431279878795401 -2.3610518239375282 3.3171227089796176 -3.3330010461130684 1.7891689352158304;14.253203610233834 7.8292962016713528 -4.726759300788907 -1.1862342379232456 -0.50364747297665546 0.88281318058345959 0.83286232248517589 0.032710734610429427 -1.1597582383314091 0.77048099560789374 -1.510010201907853 1.0533546473819579 0.36848087246902572 -6.2200992531275316;-0.048679473047179872 0.79406023793160352 -0.1852816367259367 0.24487085248361318 -1.1516118472134831 -3.1582413869012202 0.58313507738540404 -4.9084060681882118 -1.1250771805267461 -0.89890709686069958 0.18787089320178421 4.5744475962273139 -4.4399922394755249 3.401114496989591;3.177709855829026 -4.2723109522033775 -2.8057315418598145 0.30412829856135992 0.078596076197674211 -1.6336064269411461 0.58656900037454462 3.0839234973251757 0.72231432440738708 3.8172136111319341 2.9311235677245442 -2.9998964677265909 -1.104059632728182 3.1086024585075624;2.0210230100733275 2.4074838237800567 -3.7432636726467439 5.2204018909414085 2.5323092751731111 1.1495751725635386 -1.3932587328254633 -1.2644561722418446 6.0269127237603799 2.7149418837261323 -1.1177641372717657 2.4375665412441481 -3.4587464309909692 2.419608930046822;-1.2242676791419183 -2.5786523065801497 -2.0457955502775267 -1.8823533369745173 -0.82801788269636334 -1.4106200068016026 2.0667064485866584 2.3113211312718218 0.95578552405982098 2.6581505853910827 3.3948924943929781 1.9602065742527681 -1.6550757141070556 1.3506097215806088;4.5441675911855901 -4.9738715855552051 2.8155912466577284 0.29297687813529877 -0.39986052220480839 -0.02400311131840567 -0.37511230219668873 1.2859193401809061 1.2292718500358517 -5.2085279960804645 -1.1365417963346016 0.32878849411557187 -0.95321157345810636 2.5435429483947631;-4.0355164708893332 3.0760878525779574 -1.1006953067535243 -1.0164205905073136 1.5076258439261707 -0.16231102638115891 -1.1419916263520049 2.0977032446307469 -1.7664279896165491 1.8883750628428562 -3.4996118182870499 1.1718499649895193 2.2186157197805345 -2.315009429409951;-0.71382783783929959 2.43453349240243 0.58964963230541279 1.3336998378954408 -0.18953755115720597 -0.70436516920285619 -0.91104790890255682 0.90704300003422156 -0.33509977454906004 3.5695472932680992 -0.94013595918640069 1.4053910631902626 -2.2997652990401041 -0.86243951142309583;-2.0455202137596928 -3.5841022294852989 0.019404172079164794 -0.21052672580590803 -2.169273610429721 0.73333213111269213 -3.6299780025292616 -3.6676693789416128 4.8326052193168652 -3.4941612288179229 -0.39947554752588421 -1.1572270682441597 1.501666712558531 -1.3801294118239704];

% Layer 3
b3 = -0.17456433965669552;
LW3_2 = [0.10038219251005433 -0.14604613306006775 0.044951867359210161 -0.06104060435559152 -0.22445636919793099 0.56428435507863239 -0.17843834041898585 0.067862140673469046 0.049466689168850872 0.10249788181161551 -0.23710822080683011 -0.062593053698061576 0.32471305721388621 -0.019758846864094952];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00968992248062015;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
