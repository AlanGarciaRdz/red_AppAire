function [Y,Xf,Af] = PM10Oblatos16(X,~,~)
%PM10OBLATOS16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:24.
% 
% [Y] = PM10Oblatos16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.0772869161223095;-0.64105933519587321;0.33968748275223565;2.2404150567030117;-5.6771725307581065;1.7701125875817147;1.0685151153046377;0.95187359814251793;-2.8558525637176038;1.5444160579086088;0.97544260878333766;4.0224802101106114;2.3557327589271244;-1.2249702211214097;-2.4768914098024175];
IW1_1 = [-0.90080951949982857 -1.9158046301170084 -0.82989896859049039 -1.2938910271891635 0.97048113503668021 0.28284596324103739 -0.66254118056854794 1.2789616556611643;-1.4521355038511297 0.25528121580027086 -1.8895950114607034 -0.40121492898390615 1.6085097402751229 -0.97870791995644713 0.8799082527315355 0.044225024936700205;-0.76177611998200789 0.79869112568611378 0.65650983981895417 -1.2193789415843843 0.89334565075261896 0.46761788749329491 -0.82403071582241805 0.1709037641256356;0.35592129302033482 -1.3226305615616019 2.7215945375278179 -0.104506971840576 0.82688658177204943 -0.74409077071011098 0.62154815454303969 -0.18971028363842946;0.61186310822462109 -0.13042731352181006 2.0352481339662476 -8.150245532227185 0.83214870170863575 0.41844138070487691 0.050852593617445596 0.24459407073022446;-0.95148792031651708 -4.4078884155650053 -1.1672909054864087 -0.72408246030467549 0.13337270338965665 -1.6159098697843308 0.39629824441747868 -0.078004543073850643;2.4797539791131977 2.7582684389541727 0.55440044035234348 -0.49128764900186417 -0.08532958170895924 -0.27468904339908379 1.1499350544741003 0.051608307003041899;-1.4719474841125204 -0.59210015726519405 -0.72546921855360802 1.2192166478355146 0.40447054861246096 -3.2966363576818618 0.24391782475850532 1.2153501586593434;2.5821974712547542 0.82897099628359683 -1.6555964693108314 -0.16192607085543673 -2.1516358436053618 -1.4848325760621037 -0.077411696358243784 -0.62454528981292934;0.2567062241473454 -1.0284462619370265 -1.2244505976240538 0.50699954433107675 -0.74186896487394893 1.2110039504214647 -1.2652594735885667 -1.8211139404989012;1.2496160117165862 1.8612568333932815 1.7518068980985584 -0.26490173692443902 -1.0431080678020841 0.65763588849927757 -0.14482158402519191 -0.98637447208235218;3.2994444254518691 0.16806798187863417 -1.3376681329521241 -2.1854787813824275 5.3615311537934076 -0.22838733494073238 -0.89698587119211215 0.38910320080218458;1.8784517897779409 1.5992120557661504 -0.69649533893978699 0.24644802637451604 1.4718356752892729 1.3549858182486203 1.4093724409218165 1.5367589315384955;-2.6633540408220449 0.2835289219650845 -0.83391560958932298 0.27419569458734044 0.15383090642538766 -0.63645869104334118 -0.059699346889823354 0.16255049585290582;0.32602745158137741 -2.3709102187274391 -0.14961397777467272 -0.35107531468104403 -1.3305561961798067 -0.64433837925634607 -0.30953754822721924 0.62367223069113498];

% Layer 2
b2 = [0.4771023655331546;2.5794944154048935;-0.82202448313577381;-1.395932206060456;-1.111317211069095;-0.4564911340739769;1.195966871222178;-2.2579101280149851;-0.86154547284001948;1.1983927750154895;-0.81800106400517947;0.96829207625881775;1.6482242878331397;-0.64917870309605596;-1.6011530698199303];
LW2_1 = [-0.708469354034864 -0.76225854618284927 1.4095935296284003 0.79844980372714602 1.3159025216099423 2.0727458064690327 1.464707182467514 -1.051577068692263 1.415667081368988 1.8553199866148398 -1.2693813661651625 -1.2335950524587129 -0.7298028219750502 0.75589132318782193 -0.093713338783506475;-1.2646070186155498 -0.34141012153969319 -0.27655571155895176 1.626922885469708 2.0299032706202476 1.6877534008576691 1.7007119914621653 -2.0165137730233353 1.3465219541321978 2.659221435722452 -1.7315691952283574 0.24980644528068563 -0.36753309183956284 1.7845286827402294 0.90078132885107021;1.5437387225475796 1.1669703902844226 1.6666601763324964 -0.30579072669979945 -0.63817988743720622 2.8813140804279631 -0.47555558446330837 -2.555588441556266 0.91103148439909121 -2.1438045932772187 -0.25373852395490232 -1.9914110010093935 1.7132062043996039 0.68390061701829907 -0.31731645161844035;-0.30490278445223118 -0.2107635011145092 -0.99710961046303681 -0.60997437032516277 0.19655169072929107 0.27563211231688606 0.058052608505991254 0.19529019750581461 -0.0033940574052574151 0.36788722573748694 0.32126372463073993 0.62808981050279267 0.20155811020796768 2.0552495002678941 0.076732130304033308;0.26465223100108598 -1.40746535471222 -0.9328824737772321 0.96717440117779963 0.62841469441700015 0.18396082649243678 1.0269956436647649 -0.24482661126141525 -0.22038636237422118 0.14770744092344618 -1.7819344191515192 0.11508356649802678 -0.66560305413880128 1.7166513796271863 -0.52594210243751083;-1.7114626627464475 0.8509728683257588 0.42925599451660562 0.26344743087911726 0.44878992589810141 -1.9063538069339232 -0.36136722671987787 3.1236635228507033 1.1549995916209364 -1.1113022495611533 1.5264927714404803 0.99146451810624836 -0.83230479326143214 -1.0856546828127249 -2.587803810290934;1.1421231928190292 -1.1294523421103044 -0.88424566248927527 -1.8662108929502432 2.1930554743243547 1.5480902759085793 -2.1849241537146522 0.057046394940182377 -1.7108290650240898 0.82851655924996037 2.7161948108659009 -0.065483852936862846 1.5334171089055226 2.4260504578727407 -0.98293327680794396;-1.52054841176821 1.4181845420215342 -0.49310122546244384 0.22537110968896318 -2.1546752198613617 1.6905002690407172 1.1801632922011718 -0.17088062742626264 -1.5618791280217741 -2.7503618622573538 0.67152258522122987 1.4561732272819554 -0.12963925358076633 2.841152060519331 0.39114559469554;1.0686305044434701 -2.4411120658380523 -0.85625919618606638 -0.021719071399519823 0.8110160189049187 -0.39249347026074771 -1.3899887379506004 -0.47223588430644448 -1.0990944547711705 -0.33952326309160391 -0.38874240683286632 0.34136211860922938 0.8813430630505722 1.3880734398782522 -0.1616850920714078;-2.9298873517242008 -0.32824065037243322 0.83757160378541362 -0.92509081295788431 1.439612973182949 0.34105551251693395 1.5153934449189332 -1.5782470320707926 0.62163385315989261 -0.60382167117484453 -0.28525318254704923 0.32505514644450728 -1.1638870126379401 0.6814772852703862 0.6251718408620941;-1.2689964702073073 0.8366422552581092 0.85009331487262196 1.3901840309664415 -1.7810748306496103 1.0219678123438742 -2.0428791055104045 -1.1990111646271766 0.67125718218945041 -1.0038258182514948 0.68057334452956553 -0.34308213129077686 1.2158947852291087 -1.0719899476073662 -0.13941218968105204;1.9657356133913901 -0.00094279710034948089 -0.078952276290767509 -1.6424358318046017 -0.45250483629113886 -4.0813688559697248 0.30624437919562858 0.34213436685867976 1.0416119753434809 0.37932658248753109 -0.050812309558426444 -0.83727654421818565 -0.45286909299540723 -2.1245565001512872 -2.1415361935990949;0.21590148457138023 -1.1189958787732635 -0.96408315468632355 0.56349922440669353 1.1096826714348131 -0.10396471944149036 0.61713786034292417 -1.2540133511332274 -0.059805276188905049 1.0450821317838694 -0.41520767068150977 -0.11805548818314485 -0.10180368663649549 1.6850821904423539 -1.2943497187623307;-0.64643813287562402 -0.20505621880075814 -0.10145262354001468 -0.222490125002275 0.79410469889641755 0.37384055182322545 0.13494061021247633 0.37726644798545428 2.5005180744459969 0.78390016785494576 -0.70298496938511013 -0.63697445156007815 -0.17840765847333723 2.5040986744839824 -0.75704260220359754;0.11843473364282026 0.2139398037283009 -0.70284065771839754 -0.89507215809044682 -0.3023073206074034 0.16943024862229392 -0.37942528915052365 0.35167764747375591 -0.05591086323027037 -1.2254819376552948 0.7170285489867827 0.4144470662270312 0.36957327489419972 1.4007799837067563 0.92449906219492761];

% Layer 3
b3 = -0.5334007028947797;
LW3_2 = [-0.16574956467141219 0.23984370135204125 -0.0768980073080619 -0.57264901172087634 -0.16535262921962415 -0.12168585356180893 -0.12531683473973715 0.27560873205448833 0.13761497120414301 -0.17018119299356232 -0.15786893943092778 0.20356893316253472 0.32815902589466339 0.21669532530850125 0.98204736035030238];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
