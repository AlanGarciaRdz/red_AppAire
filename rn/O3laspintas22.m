function [Y,Xf,Af] = O3laspintas22(X,~,~)
%O3LASPINTAS22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:48.
% 
% [Y] = O3laspintas22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.241545893719807;4.5045045045045;0.00280033604032484;95.2380952380952;0.212765957446809;14.7058823529412];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.2929967603405328;-3.1502833599892286;-5.4607824866852894;1.5826000803802893;-0.04194732575790356;-3.6616812433298294;-0.24877249777080385;-0.28026424649571408;-0.69205589958603619;0.021573599249933774;-1.7054883328314456;-0.074636302202259308;-2.5793264104616895;1.6502405302459933];
  IW1_1 = [0.1051561674896553 -1.4289280376754714 -1.5778149259684318 -1.1931810143172186 0.44443076931623748 0.37688055984386315 0.54466205757438035 0.5913708101416475;-0.67264073330040119 -2.3838141502585675 0.22890335841736376 0.86715263741380499 -0.19296136939938779 -0.086130220018722253 -0.71272211160226717 -0.71678272467403081;4.1620040414746118 0.11288279973053034 0.14528478735795491 0.81975998735870603 -0.28308304738580492 -0.28656953947002467 0.32603728581599806 -1.9122939359182247;-0.37366553397414226 -2.2545210437781256 0.65929491638138682 0.29689202015435207 -0.072206720697937876 -0.070058305817253905 0.084347336755111094 0.6698119753429268;-0.24047636910032547 -0.58736213657949443 -0.16245313510150997 0.11185800045176889 -0.1952429597491028 -0.60948285525156598 -1.7338683434955522 -0.586478881215859;0.23842682752161284 -0.023224896657713674 -0.1482734284925929 -1.2971895183467466 0.37277185729235496 -0.96186775657627754 0.43393817652203115 -1.7599791212504323;2.8927283062717533 -0.30056428236935717 0.38928090254461906 -0.019670418326865044 -0.31125749718080647 -0.12709991588216596 0.25392844214226823 0.14581053502026109;0.018883403212549221 1.1157202624157578 -0.15778068712476204 -0.46380032593634035 -0.27578928944209447 0.14981482875855692 -0.17270420081255608 -0.10751205200418922;-0.15416539189949086 -0.064508478941230393 2.1333344085967259 1.8010830620720168 -3.3245745260581048 0.50604857137715187 -1.175711226606021 -2.0114999381982597;-1.0290597607877383 -1.495903652932959 0.64006341206410111 0.96255349499145781 -1.0845685765756508 0.45233139784398735 -0.079061030819784606 1.8785324640695922;-0.31362887549929042 -0.39764365445417493 0.28831093582043232 0.65540389494277607 0.4270956029457163 0.46246187417420204 -0.21535619578015858 -1.6851237449531362;1.1622888467916326 0.39735832373954566 -0.30798745262719712 -0.51966377019440457 1.026894995074267 -0.78684007574430326 -0.027416098763195666 -1.4553995221631668;0.24028012716278244 0.78057586417059643 -0.44987620367691056 -0.11353572385137883 0.40166057571536939 0.70120725406129458 1.1673470361880305 -0.67543762762061821;-0.5042995667697181 1.5502981080143046 -1.0183258895179992 0.87494669641819212 -0.35456714666838834 -0.031183887908154233 -0.77084796025418478 -0.11906764245946543];
  
  % Layer 2
  b2 = [-1.9890225029021584;1.6672288911819662;0.82407176689166628;-0.64743595178164304;0.65376156942310826;-0.32335910378492205;-0.87425969864427366;1.1824297398393637;0.38681509669549641;0.77783025340990719;-1.1191529496414023;-1.2689646254932818;2.9534046956494904;-1.7302523109238972];
  LW2_1 = [-0.013819325059021795 0.90712766226751496 0.0070597301523664044 3.0038740368068306 -1.5779821563081688 -0.13570862604735487 0.96395302426709983 3.5032029630154491 0.70889862355127309 -0.70036373368185179 0.82663453626481775 -0.46355621344505105 -0.051640521963203317 -0.27166519736295353;-0.51499417328545494 1.3745420501149506 0.17881223454356132 0.20782406905984729 0.28401567717061599 0.76674631810584482 -0.36327973475918901 -0.59462328589436875 0.044258217229727503 -0.29493015926649047 -0.44617360793434951 -0.4911465840694052 -1.0262991890373618 -0.40428863661962117;-0.91799237779697074 0.28614088619383748 -0.29226857539078221 -0.67645224996008446 0.95282185502829475 0.31125608943682531 -0.072015176853919949 1.1800486395021468 -0.4021055169126711 0.26353456951330329 0.1499507635055817 0.18042357897845882 0.39571801724727212 0.28472801196493641;0.24798886374185472 -0.092202656337382227 0.45444072104679295 2.2575618848169361 -0.38241425423665265 -0.03158162265252866 1.6249350408119927 -1.7131103138170014 -0.17153289723361417 -1.3418964115113863 0.23359256283745056 -1.9872691987552566 1.1971754603684528 -0.78311155443360714;-0.30561146776975728 -0.49294814944180732 -0.36794764458562346 0.32977739144303903 0.2114373082465236 -0.49374633393996192 0.62370352750036362 0.42642284611784015 0.1305877240062924 -0.50413404465540268 -0.65634064260159908 0.19551113631033587 -0.56267363989077945 -0.55496556406455444;1.397269057160667 -0.67440302168668875 -1.1901454579821458 -1.2500542681717293 -0.42966856706146184 -0.81191488715828763 0.0028124451300199742 -0.78260556616381149 0.40246499777578165 -0.26983016254265224 0.38906596288598888 -0.35380843893154196 -0.071952133435383328 -0.43756952752615641;-0.014473551935945544 0.49259999356205286 0.092570670008054981 0.75608843008824889 -1.0129516695115748 -0.43460439675284956 0.65335389740671601 1.3724812815648262 0.91124939537650251 -0.05844840631162436 0.59332557963531096 -0.0011892344755556131 0.060249517707085587 -0.16735991155681071;0.38071979830914443 0.25905314521102396 -2.092601727612097 -0.47927409646920527 0.53282314078459247 0.90012507884996684 3.7472965898841761 -0.042462826017681379 0.060202464248525128 -0.18801386512848278 0.77833054057377005 -0.15221070462630304 -1.9483572822921809 0.52010289672036913;1.6556774621553696 -0.12968975548116798 -0.29728048851048872 1.3779288830950185 -0.85401079993873974 -0.42524955292423239 0.34132845087943398 -0.216342652873143 0.54401100173356431 -0.7690235573455132 -1.0837222013558112 -0.29516098255832368 -0.42357028283594467 0.2848216663210289;0.31345815302740754 -0.66912202991042569 -0.07483201651173034 0.056312877156748889 1.0438882093718846 -0.57788100031490519 0.35384871156073089 0.33634781127398339 -0.60170519601524786 -0.70962869439988252 -0.049127250083983789 0.10535212056825853 -0.41878788205155171 -0.053967891364971765;1.0601721200810643 -0.036981199221531869 0.31830837944951418 -0.63673733921078624 -0.30628057825774146 -0.4456891060908747 0.84447943462847475 1.0404308261571757 0.09375725628500986 -0.85055282920907804 1.1026120328265838 0.64433091120080699 0.6758499539131495 0.0060407946263670159;-0.67829250297815147 -1.4153303660989138 -0.2296832242079834 1.4019767601864785 -0.44642704140983952 1.1373972199398825 0.35979097865220183 0.39399360563090391 -0.11723272994270305 0.76781634261432896 0.14217261297586745 0.51143443094872576 0.44667007526067914 -0.91949297193691815;-0.34378033653992951 0.70985034809731051 1.7477388337668056 2.1388874712208761 -0.073136441797998386 0.41008065420958784 -1.0154413090049621 3.3578688880718 -0.027227137331257808 1.7403229237378715 -0.35669656875096556 1.8967422280539905 -1.1937012018662827 -1.4776995942543361;-0.9623501006102928 0.2911583056626868 -0.55090380321387811 -1.2093860059070094 0.48569817142970068 0.019256537515969271 -0.24407494964916854 0.41818977703649379 -0.63977714781316997 0.5158660749299433 1.2153797648921603 0.44808782063738312 -0.36335363243800167 -0.048293521024354177];
  
  % Layer 3
  b3 = 0.46968417775993965;
  LW3_2 = [-2.7464579972584477 -2.4591937708006091 -0.66854335232211803 -0.5360366445238578 0.023639243229723706 -0.6018225000059666 1.4127141268488677 -0.67295356659629035 -1.3955404959779005 0.54842744227285434 -2.4934165160941903 0.86560577280962503 -2.645262938602551 -1.4175046085811593];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 14.7058823529412;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
