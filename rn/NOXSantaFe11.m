function [Y,Xf,Af] = NOXSantaFe11(X,~,~)
%NOXSANTAFE11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:51.
% 
% [Y] = NOXSantaFe11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.97562550431129735;1.6345359864439588;-0.79813996429822009;0.78565127744683216;-1.1613269305440546;-0.039502955075032556;0.50951219893167221;-0.35779724447128874;0.76211725739510461;2.8521111430954496;-2.5547080225801619;1.923287182527512;2.5779720495881775;1.9943589104621515;-0.42612857684689193];
IW1_1 = [0.71378913004650424 -2.7492738328270243 1.0694829439491134 -0.9497446682599896 -1.3803297580834433 -0.38758971624531341 0.61140998099280108 -0.054216159117164459 -1.17635947966042 0.88020954465437895 1.6873731438275545 -0.84543579187934426;-0.72871060816227573 -0.45432033343124117 1.8450401944053048 0.12508660842218075 -0.55395140607908155 -0.25408043766664234 0.003926098348798323 -0.060735060820432001 0.62909259653627558 -0.080802828953536326 -0.084664240172535529 0.67552736285812975;1.3372423601990895 1.2292974035703648 -1.2227347327474125 0.72043024019649238 0.41814746838320366 -0.059159228830668473 -0.25437082508128428 -0.30666420860117022 0.30069169001514684 0.42150858012266745 -0.2491621985323581 0.69739010510425081;0.94777240654190453 -2.895727490656157 -0.065639206658752627 1.1934335918809553 0.36365856219530679 0.30731518910327088 -0.35783987232092257 0.43162382856465026 -0.26611604875005335 0.79630250325857643 -0.052459304098325006 0.14979750515123605;-1.1156260130641609 0.15587844797548045 0.95313702689767965 0.45208381093946792 -0.1950813877091897 -0.41261815243144745 -0.56483854864582872 -0.059690685380880688 0.99228353345908304 -1.0330089614428275 -0.49089167779404691 0.35786479630060508;0.64644515326625629 -2.8664757905234608 0.28516035031024523 0.87761365497954402 -0.96922941657575445 -0.16449914104829894 0.43061868650301921 -0.11178209435982821 -1.701337710398847 0.082655692307247744 0.47948513863055964 0.37361715672598933;0.79214527072014929 -0.22176676164435874 0.74721946553921104 -0.49927095740296351 0.24851969958793152 0.29800461413122875 0.24167031909116105 0.025803327637882116 0.031989588831285096 -1.7378744224114735 0.16286056406830532 0.13476232905921759;1.3929915415189325 0.90444843800794716 -1.2643903901602926 0.22845319886775445 0.28704833497281801 -0.40670522972285661 -0.77365952800945736 -0.51557283410171983 1.1581211426365243 -0.96884754145825325 -0.035637303071968308 -0.42134639464914903;-2.6602540894002309 -0.61161122253084022 -1.4034409730843684 0.96309617379867696 0.81131946505377972 0.5346570753204658 1.040093562475005 0.56031215495713693 -1.0927299618841562 1.1227596346864244 0.097109226618449104 1.0572007117513822;2.5578219171424728 0.19542374575476815 -0.97004537892277709 -0.14644591298893606 0.89289376529924691 0.15644020944859963 0.73743491952684737 0.26994049743950033 -0.56660690622457766 0.63042721788571232 -0.20528749587988324 0.2104954163279793;-0.83717106874555069 -0.3911790064790035 1.1879164146372512 0.68494279905319999 -0.70651115923748797 -0.45923032934285035 -0.21424767518241708 -0.1621106605834827 0.65295742664824086 -4.0500637356912348 -0.18078006221693629 0.70037753242541723;0.63882661657434403 -3.0396226256695358 -0.006966460144969485 -0.28651900545029169 -0.14146346393748083 0.203677892950127 0.050135279433553503 -0.069859922986665351 -0.12338482161896284 -0.89660767553354004 0.056588146202774366 -0.076061424528110919;-0.71247703580443011 0.70012051293219191 2.4546771293599763 -1.0484942276828224 -0.23817639074447566 0.36436294835785699 1.1393678165274868 -0.40510188579683193 -1.1439484095520569 -0.70151838887827067 1.1856104329134054 -0.087250382660133269;-0.2847831454597185 2.6257154948423218 0.16985398255678075 -0.44573318502737524 0.78128622686072124 0.28237841331374031 0.4061736132426858 0.015689905402350473 -0.33487215715828716 0.35270637342693861 0.15581918265536515 -0.3789197098695174;-1.4834429044917519 1.1038913826260965 -1.6334247656295273 -0.19049188719317961 1.9217429376242354 1.1446754257540634 0.76294949271147605 0.72403972723125343 -0.67559886467609087 0.62192071816161398 -0.80450486276342736 0.95054159340846545];

% Layer 2
b2 = [-1.573789696228157;-2.5049405357098693;-2.6646438391950671;0.45173068986961684;1.5976857663280688;0.15914549239988468;-1.4432657178153032;2.9370154940414408;-2.3584853716162955;1.8434624697907294;0.12280027947228388;0.81551669120805048;-1.2145209972024291;2.7201686127237381;-1.4948170769854467];
LW2_1 = [-0.79891929062044365 -0.086196140439943281 0.88072081512532263 0.59719001706457819 -0.22978203151533613 -0.22979544897125911 1.0393582550494891 0.56704695167763497 1.0165930185494281 -0.70839727260816987 0.31113841124185404 0.42041256992127407 -0.23249895820220431 0.24399896269314145 0.048144160095550226;-2.683190617919458 -0.28845382034782374 0.023688060405984927 3.5039561636407432 0.076501894243165433 0.01509142837790229 1.9735648694503274 0.13796661876528646 -0.89707256101533595 0.86967262678495838 -0.49707848744103661 -3.894358617587752 0.4224665656320532 1.4003134829042103 -0.17543522629787225;2.1421483424531833 -0.72716200692687638 3.7481905878887081 0.82549758640576398 1.2221938162620116 -0.14771176193658078 2.6882277877787217 -1.3749121064517313 0.30431631622168159 -0.77039562498530312 -0.48805911955159548 0.61594011793687575 -1.0973993896057133 0.34311082963306128 -2.7756955082669652;0.30861892668197172 0.095497367681159434 0.56038735474292178 0.65033575053668657 -1.1239234564400624 -0.8841656422183729 0.42664976550449707 -1.4932738653955653 -0.61779251459101003 -0.56081017460891225 -0.12185089465536537 -2.5890859650830773 0.08874129850482336 1.2717701166216568 -0.55045452460105504;-0.72628916885059047 -0.18262434410076731 -0.37869156122979364 -0.6476028326491966 -0.28342255676460876 -0.30938550603875903 -0.034406948400867582 0.29911827022529214 0.033074460250293085 0.24275811750676485 -0.14909497059312071 1.1521975721148872 0.057240616637294059 1.5338532696377201 -0.91388766047034764;0.46293445532781086 0.59864432002727785 -2.2355581849572204 -0.021351118850191388 -1.0284171711282608 -1.7214444469765631 -0.70652527874684024 0.095104759847319087 -1.3341253371774651 -0.20432568958711267 0.62323739533957934 -0.24123258839042938 0.2631590912740181 0.16434551023951641 0.68890292574491119;1.2369861480083431 0.50927466490855544 -0.12383250629672404 0.39542628861225254 1.0317849516440163 -1.115272548399677 0.049433389845519496 1.1377024497918957 0.4783595753837151 0.73165825904906689 1.0929083998563009 0.90379822508961238 0.1811883655564045 2.3929466264851418 0.73014424863838567;3.3223245321947985 0.46552330863342761 -0.094490910683961149 -4.0673001409979443 -0.54635159175945291 -0.41239840031146208 -1.8531944839891796 0.00055296952842362815 0.69915214204275289 -0.99270287225828713 0.65180831745220691 3.8456484904733657 -1.3022229950642727 -1.7181686717458513 0.24468649064947681;0.013681339292350513 -3.2757478623028162 0.28431693183769047 -0.021389178804758338 0.47223857533927682 0.11724563604931916 3.7159348483155785 0.041317546038009613 0.5741507505726986 -1.0109366376470215 2.7560190752179019 -1.079357640031096 0.44786668836233012 0.23318599111489793 0.13384800450347348;1.0695268035034207 0.052249281638297701 -1.4031511549729758 -0.4367099410462606 0.10302637063355911 0.15178047290035929 -1.396482976202418 -0.61447062952148379 -1.3466095081132918 0.57784024942882872 -0.14566142660507428 -0.78974094305738796 0.001155736892261866 0.18446726295113544 0.15129130120157458;0.15127455690109515 0.035384468210344522 0.74708909555925174 -1.416958438998605 1.0396727927682732 0.82084220765795368 1.9875840381359764 -0.2858394964462917 -1.0600384010324653 -0.69841964554441571 -0.79880396987142965 1.1130092600154942 -1.5747527774396277 -1.5900844430125882 -0.14778170879328226;0.040022808979744966 -0.72261946383969644 -1.5886407516371945 0.70523079663034227 0.17435505543725704 0.4448754058020844 0.19040832513043859 -0.28765015114217474 0.67967382114262109 -0.013962064018029657 0.089512373092982586 0.48208243947261087 -1.4501208889037738 -1.0750999497978733 -0.50518341730085692;-0.2555941991052878 0.784331000500606 1.6256020835049247 -0.63243857797617831 -0.46367995284926672 -0.29134239054993766 -0.22811172360814558 0.31311973544758748 -0.59088386506493673 -0.14664204971065409 -0.21094893098834444 -0.29487413784515359 1.4491508141751881 1.1946967538754147 0.3393008279702201;0.89947091761103504 -0.67989493541294688 0.63302715566753276 -0.12020476300220181 -1.0514556890893472 -1.6962065032614659 -1.9299850986269611 0.0076441770782699307 -0.99484707512631265 -0.36150954564758619 0.81311653289686148 1.8225049480381259 -0.19507063325961227 -1.6620330548242042 1.1156834622924625;0.2400789400169063 0.32233555378410428 0.0078339130596644935 0.37985303515029545 -1.1580724399289153 -0.67920070189862347 -1.747782136187098 0.50762803593706374 0.18726219322655413 -1.9007970685577702 1.9417694931344347 -0.76281827385988177 0.4954639842286484 -0.23404890168734355 2.1148612425469904];

% Layer 3
b3 = -0.1053830696024384;
LW3_2 = [1.7799557972227877 -2.7295184391865019 -0.3277922136611649 0.38308311656680322 -1.0684461531263454 -0.35649708510493228 0.27035450342493256 -2.6499984943858812 -0.47411683449795217 0.995909600855449 0.18080882349246749 2.1776471618204751 2.0661850469732657 0.19837364689080073 -0.6695053287817947];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
