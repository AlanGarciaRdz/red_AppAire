function [Y,Xf,Af] = NOXAguilas15(X,~,~)
%NOXAGUILAS15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:13.
% 
% [Y] = NOXAguilas15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.3461512142451677;-2.0242849524123279;-2.2290497938121563;-3.1626591557975532;-1.4970866572094996;1.6808841376729897;-1.6210190601707426;-1.1167906342662544;-1.0366653946983215;-0.96956160797137736;0.96991650707591348;2.2798037340496329;-1.6181711901116953;-2.4870505506425169;-3.2760700619032912];
IW1_1 = [0.043794438260305595 2.2781712423529132 0.11365554058259607 0.85435020656907512 -0.99492899518841582 -0.049978984174572354 -0.55197103876361364 -1.1178311018884382 -1.3805600280485721 -0.41011746792110493 -0.85435414613785088 -1.2727271980640416;1.5753033107616148 0.47696670567679139 -0.96945638705053683 0.19992563481291303 0.19706970830854775 1.1869587421771965 -0.2948617995028095 0.24826690737742871 -1.0185954217630391 -0.16876195576026268 -0.039698008526704257 0.78571869665751926;0.093195944723440491 3.731719644172327 -0.03541303361205303 1.1199327352960815 -0.12471205937682656 -1.0242894399020133 -0.68082045888650877 0.0057853685332345077 -0.16457878139015364 -0.36356299676036907 0.12604702000114312 0.57492250763706976;-0.033184494958420206 -0.50050732686623123 0.85813298311039932 -1.7207280044973841 0.35255096613236536 -0.93777531798378222 -1.1714918620438226 -1.3311413103215184 -0.2623389243928223 0.41262682254960192 -1.2776504128870863 -0.20194540190706911;0.87859677815793624 -0.97505464893601967 -1.1651163560684052 -0.33734423844962147 0.021928303515505673 -1.1384892916044367 1.5422241705107096 0.96730747719341703 0.23145821835371488 -0.11694071220792007 0.6482877358731618 0.11541417060294598;0.026496103698466493 -4.0521968869842677 -0.37464081204036304 -0.26758135064329025 -0.16735247587012136 0.55587675075866749 0.78452863951201646 -0.31062948157043996 -0.33556590254089647 0.041769767204850254 -0.10324524219757295 -0.55401144925141033;0.70507942798729362 -1.7605236221663314 0.92984345129447499 -1.0371856534582029 -0.17639373688731635 -1.2281778686822744 -1.6036064334351263 -0.26036029193560706 0.43667036466669235 -0.14062759836255151 0.010234625357446094 0.25114813998591806;1.9059753099496768 -0.27414912935606506 0.18242555768957244 -0.10272242405587212 -0.8475120675150688 0.049118170927055782 0.30981855195365426 1.0705946129643362 -0.0059257612388913319 -0.24216630383939489 -0.32389726554770398 0.98753869798186733;0.32689195039704017 0.69321118357993328 -0.48296679438138851 1.1394761774100677 0.8957964990492443 -0.95867893880216437 0.97871956643172464 1.4281251700872961 0.34213625248148871 0.53965696501165206 -0.27138231116360362 -0.105979654094551;-0.80047907949302388 0.56966863137203538 0.90756271038544167 -2.4015851622547331 -0.2993331666983674 -0.99415162787395883 0.23843504184394554 -0.79851706764032759 -0.19580612896889288 -2.2710653958644786 0.10246280654979539 0.41493111382513137;0.11769006846934515 1.195224452328687 -0.66439601421759797 0.63406180892890851 0.7894750906153345 0.4115241435718362 0.59031763333779774 -1.5599912635939555 -0.42874421211943653 0.10623473979190515 -0.081127742555413801 0.24760006285120822;-0.47611423166910299 2.1065031679883401 -0.43499640373983423 0.2502700447684103 0.9737096290172591 0.79165356761464345 1.2493398208399509 0.4608875621203285 -0.10191357278695704 -0.5144646765710591 0.45383351702647357 0.90652228448400574;-0.4179699490134719 -0.87896564404594735 0.91275454206435025 -0.15368827349242409 -0.44481981064150844 -0.28476202962586472 -0.86890573835309071 -0.6515049724856693 -0.2835703624869646 -0.35223273766500146 -0.2537876393012401 0.11199821106216398;-0.47149749872620506 0.36477320530025126 -0.043547422384466863 -2.0620183715293172 -0.5851276852261873 0.19647447793493317 -0.039259172002965241 -0.3434396644484573 -0.11721952065018588 -0.014466953803683059 0.091389150669383468 0.12167024595301926;-3.2084386198815671 0.094764152613196734 -0.76627191534645722 1.2711269621216734 0.58895055053194567 -0.75008703668898502 -0.46901984564828691 0.21234035092532436 0.26256964296016627 -0.52103316908592789 0.37985075419451414 0.036822106823446651];

% Layer 2
b2 = [1.8879298676433989;1.6408951531133487;1.671401323826045;1.5197438286326981;0.70201073790291757;-0.37038899008673887;0.072561393897712587;0.21221236603060081;-0.076769001545066329;0.13394703247176781;-2.7574150741002783;-0.89033167422884052;-1.4753317288622292;0.45160193895063938;1.9374987498149268];
LW2_1 = [0.068472237351732634 0.48937306644501788 -0.072027623027792989 0.24899063155171372 -0.19839113339232681 -0.4984883778909614 0.14032593850870173 0.16402723209937903 -0.10184457180779147 -0.22922588423384366 -0.17846044286026236 -0.16241209972156939 -0.71803066670039573 -0.12933536539055671 1.037039201795209;-0.45589755457165038 0.93732567205946782 1.2529177384407413 -0.4398771513121883 -0.015133421191390647 -1.0458872678610855 0.067786509097230482 -0.38734478370463765 0.0069207886496042148 0.72176956220948196 0.99374804675814066 0.057965805286351223 0.68023279116897506 0.52796586095926568 -1.7213617988264103;0.031055030381945521 0.47305205123648253 0.038086935779893152 0.28746201495526313 0.11123323666323209 1.0335863168873118 -0.4645415684526471 -0.16186051733338397 -0.35641714156520993 0.041206162828198938 -0.088678073674084174 0.14274055459931972 0.48725109891196045 0.051055570160452216 0.99189908983715602;-0.83243039354662562 -0.92744953778849593 -1.6099142486233171 0.21842612272554848 -0.45332302243884665 0.1154999088054639 -0.7987677462580175 -0.28452469958275584 0.42759789746324628 0.39516376068637726 -0.52317802450578821 0.56437231905781482 -1.4734227572593575 -0.052789714224504861 1.354419269908691;-0.488534408588156 -0.005401777251029468 0.83183556881882581 -0.013565222217796682 0.2226089015820519 1.2428861980316372 -0.35147728338530576 -0.13377081975630595 -0.597944126080594 0.39520023481375921 0.35769272926477702 -0.39215951620160339 -0.67965128649550766 -0.87113979133054753 0.28409782798299499;-0.65572048866346799 0.19708733722114574 0.17164227477059524 0.80939794964166012 -0.12582066265632627 1.077102286611171 0.6829873505936207 -0.11217115907046801 -0.58097021776822055 0.1032478511427215 -0.60609453208239406 0.22671432156619689 0.43851653614148667 -0.69591396191148558 -0.3780860904534768;0.48629409299204024 -0.1559232731577834 0.40882655885579322 -0.48114944999687642 0.066069138925495069 -0.44382217494531401 -0.80822962653383845 0.24887845560038668 0.73917953603920394 -0.035842541701093328 0.40332347337467028 -0.012516253486783525 -0.97352302022615667 0.89733353518228953 0.31832958234545128;0.22430539022379731 0.23584227516968931 0.12293643242379418 -0.099671504481810946 0.46869499653140057 -0.2847029167180341 -0.13803902257804151 0.32123892814331562 -0.4994218248636515 -0.40769782034410074 0.45577489008444411 -0.029238669154638332 0.18716021811932732 -0.6611750520208568 0.1400222226516836;-0.22948643690113779 -0.041362976295178142 0.033281107963173247 0.24540377916655379 -0.35957551859672515 0.0094676599380646501 -0.10364097847452836 -0.33187886821921581 -0.042365730741682837 0.25725417944199308 -0.3779565547742853 -0.08043174271417354 -0.39201190015736981 0.31961682829107968 0.47697301335928161;0.3287877439424356 -0.68351046311878128 -0.16178121005653373 -0.42692398505232859 0.18953042847183699 -1.2062299810698229 0.89163778282150419 -0.10771603169494207 -0.58899021070572533 -0.15402396645578653 0.59682942649704718 -0.36309490208960732 -0.2775455338789064 -0.60221259829774376 -0.22105190147252146;-0.17233110461462423 2.535336851930778 -0.21385111670923715 0.57286318017347537 -2.6857352217201664 -1.2865081098282778 -3.6041112609781814 0.10916834875024112 1.6149252816963473 2.4716328606427576 -1.6295864221078704 -2.8659085801290041 1.2704764735106002 0.62396459001238802 1.2625102340816232;-0.20365995676463758 -0.24497596247863604 0.16515306178403594 0.37876375606080442 0.17427455362455951 0.40821376087425421 0.74986438286698087 -0.49333778525395455 -0.52197376534701156 0.63435505573022266 0.28025141603354675 -0.026324675382941479 -1.0576456025128249 -0.95170461712464216 -0.7045616534158522;0.12747230765804127 0.057385654129242875 -0.97122762002717444 0.74333090316040806 0.48969540839653319 -0.94822866644493453 -0.33621746562818755 1.2746963153123343 0.34129085263514541 0.88860384647875368 -1.3164488622802202 -0.44537852640040221 -0.49367475587553572 3.186193287653929 0.60625792510346854;0.4673821171363286 1.2713083026175915 -0.80891031291047955 0.90490792287666111 -0.30334274117663029 0.80466289108899136 -0.77117093404749171 0.40566182688383534 0.45206523050334202 0.34016128819132807 -0.43597217185268 0.96149299152888767 -0.4283686340715348 0.54322647284313774 -0.12856671027642308;0.076791514790704535 -0.10873757028362629 -0.45522596093930717 0.14037158632438637 -0.50679538754199593 0.81229759170187876 0.82905811031658838 -0.60651102199431151 0.85925990452033341 -0.17590273017368083 -0.17831686548902345 -0.51757782666556229 0.39015670149248272 -0.099537235498254481 0.63231645580350171];

% Layer 3
b3 = -0.89707743839516074;
LW3_2 = [1.2222913694393567 0.40468872606800121 0.70878255654265454 0.42415377373184154 -0.84463859468377156 -1.8194234015711463 -1.7642818143593173 -0.9258400192963141 -1.3367417920527731 -0.69668604381521182 2.5905836837807019 0.86551903117178175 -1.6404173970983624 -0.31546997716055558 -0.30159896926078017];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
