function [Y,Xf,Af] = O3oblatos7(X,~,~)
%O3OBLATOS7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:44.
% 
% [Y] = O3oblatos7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.100381449508131;117.647058823529;0.0560224089635854;13.1578947368421];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-77.142586885512955;1.5543155821078676;-0.92004426165366038;0.71280193133260006;0.77673211609174875;1.7382640497618631;1.2449890914939801;-6.4144437728311274;-1.3677111674564266;-0.36079830776029537;3.6566477657513206;2.9307337242881664];
  IW1_1 = [-0.096493887118878657 -0.092685709309779193 2.2854640588054012 -0.30388977397835482 0.030246184047372025 -77.691333432478586;2.8055558595211822 0.56447710189583566 0.86186392028900149 -0.83506168139198267 0.45969748956017015 0.036534299982316006;-0.23040375810061972 -0.36919598906093315 -2.6653188720466452 2.7589761915306918 1.8467615493390321 -1.4886348512305565;-0.083952825740230427 2.0672136164401067 0.12540012510770715 -0.037177746005103637 -0.36534191062851445 -0.19651543524014123;-0.81248989969961216 1.1045875440131907 0.048269587513266966 -0.23110636877261673 -0.45516927332391688 -0.80231502412148425;2.064437822402116 2.6542762357937382 0.18658137736196279 0.3628453445794898 -0.2625362444691185 0.2602814561932224;1.1915243036601237 -0.094323884177718462 0.0099404275442568947 0.10842796427820715 0.26761162789412307 -0.16598253889609618;-2.2431076570456359 -3.8711204945171924 -7.8968353736060299 3.031962490597548 -0.98244402735952641 -0.19934155700169523;0.14719083792111923 2.1274806769038235 -0.48157928817404833 -0.08653176153571418 -0.56063852989241236 -0.28669697332179134;-4.4422205613888854 -0.064119635062592745 -0.74121274190053954 -0.65350753860428268 -0.68595122228311578 0.55474800157705417;-0.95609937873184525 -6.898316523561939 -0.13726019631003206 0.48914338383596129 0.70618358527666114 -0.033392500848118976;1.4893366014513481 2.2889978595506277 1.2190254005188506 0.32543289277241355 -0.081618178015796419 0.27596669600050594];
  
  % Layer 2
  b2 = [9.5075299483014568;2.5155580911936219;-6.4301671679275119;-5.0202617739947719;2.4332206482926013;-1.2145400966026469;0.89796372425365212;-2.2120348566795078;-1.9057751526127897;-4.9830709697116502;6.7431760624837125;-1.6398380976746825];
  LW2_1 = [6.8903601195724109 -1.246464516949837 -1.4043083931577049 8.0337309090604112 9.8976763999323794 1.6350215153594134 0.3133294054075777 -0.92040878611276533 7.5732534751650222 -2.7449690506021707 19.235843262907888 -7.0808400813228669;1.1746715501741896 -0.074056182487692065 0.55827380577005037 -0.1578534897347991 0.11566634815659832 -0.50469841355250666 -2.4947672050001781 0.046563299055397731 0.44343847495945021 -0.070070048733883963 0.40146309763496463 0.86410674401168575;-0.40866321161506441 0.51966706849088973 0.39107089174851684 -0.42546925490987797 -0.48262378308619236 1.0525248794387827 -0.31523603471187944 0.28715964660764548 -6.5432715672414927 0.47373088786331574 -1.1102202334754849 -1.2250655650410931;0.23455195949930902 -0.965359693132537 -0.81193009272802441 -8.5292589510631061 -0.88898903050555589 2.4165997343976429 7.1054822662429116 0.68299523923247829 5.6667670379030781 1.1868317700626909 -1.3272182781640114 -2.565415503988989;1.8897215486029635 -2.7366486759494282 0.17998293924771439 -1.2330151101366451 1.9685547181011798 4.2595524791598924 4.3820277120014959 0.26965116784252502 0.51660657807297339 0.82465728719110287 1.8076542986680677 -6.9645276116680526;-0.56599290026850391 0.52156988299842066 0.50833684326669792 -0.8641885065589372 -0.53629326409824074 0.93489663572093518 -0.5718018112833867 0.34649563312673304 -1.783235072740204 0.64145072365055034 -1.8541767687944717 -0.88924757278694733;7.155562050355873 1.0189962930384908 0.81668058439401048 -3.3480511971219911 3.7949111610757851 -1.9950416709183045 2.5876127658057038 1.2083440326835611 2.267039523967846 -0.49199704178245857 1.2749560439023877 4.4338591826637721;-2.76326552775472 3.4852188081702979 -0.204550119683268 -1.2601437492371912 -0.49586070028089924 -5.957396768302611 0.044363751208971153 0.6454809015192583 -2.3526896779851243 -0.42913473616510306 -1.5565129021340767 4.3677416117564611;-1.3352849290784288 0.47856362954367354 -0.69713906151058291 0.23167699834916575 -0.29063834479649808 0.62889630941502561 1.3557507341429822 -0.16885932786182356 0.092663448056264044 -0.082094987973035008 -0.0053090496421609526 -1.6160234687437982;-5.1286099300825274 -0.54576954358825125 -0.89543338756308788 1.4623195607775639 -0.84341783458175856 5.077884945507626 0.73436517938856494 1.1241925673257203 0.2549286331910679 -0.91314892824927829 0.23961196250649139 -5.4968222501875266;3.9429905759758874 -0.44223497969990111 0.55591184633753898 -1.8907531496462417 1.7117013265427012 3.5381906058803705 -1.9549552563136108 0.43723494746761038 7.3866148467264612 -0.82638910715576053 4.1980869649074615 -2.0663476925331885;-0.53656452157914936 0.48226462291137906 0.17335846845940489 -0.589379423970114 -0.30570381957239567 -0.45857328544193754 -1.3287103743511537 0.40221354734265902 -1.9708956659246282 0.92572788793203908 -2.0845702391812688 0.81862487347899904];
  
  % Layer 3
  b3 = 2.8602719905931058;
  LW3_2 = [-0.34207847257662277 -2.8069330135681896 7.322715362964975 -0.45774880311672 0.28732897514605699 -6.5006874368369969 -0.29076435288848623 -0.4402314601893369 -2.6679282919048983 0.51238563072191168 -0.29626219880639693 3.1993990221475896];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 13.1578947368421;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
