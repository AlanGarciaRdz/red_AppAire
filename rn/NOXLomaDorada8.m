function [Y,Xf,Af] = NOXLomaDorada8(X,~,~)
%NOXLOMADORADA8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:23.
% 
% [Y] = NOXLomaDorada8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.00280033604032484;0.0179856115107914;0.0558659217877095];
x1_step1_ymin = -1;

% Layer 1
b1 = [3.8252431447125108;2.0751101074795719;1.0622050018558766;-1.7848630533617096;1.3810776459371712;0.78093853681890302;-2.8752244259730921;1.2563451369517393;0.46091942679066383;2.8891109999205669;-3.0740089271002367;-1.3069072328588676;0.82775276924719121;-0.64299063695545];
IW1_1 = [-4.766150613766972 2.129314168748901 0.31798041226204926 -0.89108152504031291 0.0097989593424640878 0.24414508397174869 -1.3017363734960701;0.39306507064452273 1.3342852294665357 -0.20877894298148425 0.26844532289207573 -0.45313991229871253 -1.4340075066247202 -0.29873218735201557;-0.90241751131580938 -0.61759531285644098 0.1695450824764794 -0.12708495489874574 -0.1303749146923075 0.67881508083463904 -0.45071493665126283;1.2335563412802064 0.98660104693473438 1.4401061652296974 0.59434176881942424 1.5991595554263855 1.4887951412667277 0.30982997334539059;-0.14112597928963275 -1.8359553250582692 0.21872659650127949 0.076022016090373526 -0.11910901811262559 -0.17948641641149926 -0.86832757961804019;0.79250217973835491 2.3361999708149299 -0.039202579981398811 -0.72879728704861602 -0.24260926047142478 -0.94293855082101374 -0.36171740384299128;4.6753027605148887 0.080843884892538076 0.61007800393389033 -1.2495801987694772 0.64943610728343404 0.6310603584195198 0.11570693240435648;-0.42154528563387117 1.4200623311508003 -0.041867633919898603 1.4979287515126627 0.19166620547058016 -0.64283299542003136 0.99413006766515577;1.2235042849676954 -0.87541836978876686 -0.62445897239090431 -0.30994003344507282 0.3689580791054265 0.25389691799917136 1.175575875357981;1.2391972590479581 2.8761462276179803 0.57923159449647765 -1.3201709021492221 -0.63948161207489929 -0.67371668565587361 -1.7501128135811281;-4.0739636801808361 -1.3858597886385109 0.4762305744135617 1.3438455771610596 -0.28621222463930185 -1.5565427034305146 0.1507779876344581;-0.92833161486283711 -0.58357365560916408 0.089575926970605915 0.33736665382403264 0.30628997670149305 -2.6096034809618289 0.95078466602703293;-0.24004820089932657 1.4310910210981829 0.17249587800671998 -1.6531673133424467 0.39484973569504722 -1.3479139654494827 -0.032636794725977449;-0.40081174351191884 -0.9069217489085013 -0.47335996577292649 -0.049668557585259572 0.52696214055020474 -0.65527734355292611 2.1526396994082408];

% Layer 2
b2 = [1.5380113287434758;0.62590253938273166;0.52672812723145346;-2.6142216323894809;-0.3342615150405403;-0.83556414530957157;-0.14655150009739612;-0.53893042370749811;1.524220992323668;1.196144676464393;-0.94234514740289532;0.92817420527263439;-0.59861363605780438;2.4897665265985407];
LW2_1 = [-1.0912019952985748 0.61584624237483909 -0.095605999434758102 0.072130967302050694 0.69600409114660766 0.32398074036321245 -0.99054883174597474 0.9710047012267472 -0.74982457706615757 0.56605434966553003 1.5484903684309554 -0.53972372275383862 -1.0689280336893026 -0.20795687210575192;0.069062045537302399 -1.0114960653615799 -0.99933966981370248 0.74182846288025639 -0.26620659649957318 -1.5969474738650027 -0.17592658448499185 -0.61755080420204467 1.2275721922798675 -0.67286108831057168 0.4090772228661384 0.86598680337456357 0.29544390159877471 0.1004119192249372;-0.51598034847650687 0.26840177290519324 1.1959347528891238 -1.2820997484154222 -1.3250935788163591 0.25559427104214533 -0.00048818540492627516 -0.32543168809883521 -0.071309540826595352 -0.91758122391635699 -0.95667127215671088 -0.12313890006441434 -0.66763191301179836 0.91811101090271829;-0.54393401721952117 2.2049115259456853 0.76684591040726569 -0.20105749291310249 -0.25038304250183291 -1.5052942966571823 0.712998344985038 0.3847959134940182 -0.88043614775221857 1.0035357754578005 -0.19643406072994712 1.4476133967207836 0.6507750344909109 -0.49062209630571058;0.65669779627207103 0.99923310745134253 0.25391526671211267 -1.1821570899874527 0.83537265365714597 1.1625858685196611 -0.66126038158269707 -1.8004205843798478 0.66954988940954185 0.21416557407141287 -0.37809362382357248 -0.56820132947623059 -1.4069939415453463 0.86508946376037499;0.67787843771151857 0.49087030229766088 -0.46305410579603706 1.1793711863694565 0.85864819311838414 -0.41152105810361228 0.049993365361525315 0.10382050910596988 -0.11410734384940258 0.034152027708306124 0.63442849092131692 0.38286940870703123 0.70880748716640862 -0.7984911572079767;-0.012017440361935076 -0.73109789727663388 2.1074476161258606 0.90844926381559976 -0.69011392778082159 -0.073970410958905553 -0.82342640304236137 0.014175003042641868 -0.46450114478695981 -0.41002679278055715 0.29745733309207939 0.7053882539779569 -0.17938586532048839 0.42140883651172723;-0.63817204817357576 0.38801229931455339 -1.8605371359798033 2.923893848388563 0.30518162241439839 -0.7286837048713295 -0.11934605853584437 0.53996722638453165 1.3822449106993093 -0.48876346027505624 -0.25879666115518585 -1.3831396120779522 -0.3310485838481847 -1.4670127049912696;-0.13013382236828547 0.61087285379134426 -0.026353161842048431 -0.44401383731283223 -0.26680413271158671 -0.35750387405156547 0.43294114513406806 1.1039703352135803 0.74719683774704737 -0.89058824199381792 0.71656872817045603 -0.26854988101145261 -0.39504451426308251 -0.30457046236907726;1.1463655221671862 0.67126778362293926 0.4902694739383594 -0.86979959307255172 -1.4791252471217913 -0.84172805123798866 1.8961952338927237 -1.1990058502226073 1.980849338420442 1.050765225917818 0.40815922617476452 -0.006465847524301389 0.11777182761997633 -0.97953782529159883;0.3314852530954383 -2.3397962327358974 -0.12497485963872637 -1.1264956613221848 0.74403663305211976 1.3990810885373921 -0.88699446097898005 0.52166842274848924 -0.78963626383469498 0.4798667145378227 0.56524395742730726 -1.1502825257989913 -0.24085085622870145 0.24786380002513542;0.40502879474039233 -0.36670493120352921 0.85552257633932072 0.28323993107232609 -0.58782133840432105 1.0843502092776882 -0.19034443209552615 -1.2828903573784822 1.1971858597586731 0.2049018538559168 0.92139141730910601 -0.91949368219417926 -0.18098265571263014 0.40388874264846686;-0.42124978886350428 -0.55927582571866508 -0.72792920948197515 1.5466969210567429 1.4571166069284938 0.24980453567266836 -0.68924966624445305 -1.1457452810522466 -0.7051840231311165 0.70657184765467396 -1.200399203410049 0.27978844457947277 0.3685797898929204 0.14133359781811433;1.8031434930628967 -0.54213413434123503 1.2240583441371709 -1.0741587840238562 -0.72166704089985068 3.476525062151858 1.1828528924071398 -1.7872239027360886 -3.023823986526649 0.36499279054095607 -1.2478546353116871 0.33485109555729525 -1.9168967312523761 1.7936158833661673];

% Layer 3
b3 = 1.5581053409295478;
LW3_2 = [0.42300460479004237 0.92512280131132951 -2.3025152792786092 1.191489958864467 -2.318062085315586 -3.0958288615463396 -1.2609329088894723 -1.3839983309311721 -1.4024670151675829 -1.2948521021118173 -0.39699024723982734 1.711328126022392 -0.89362533463351157 -1.5184224017770052];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
