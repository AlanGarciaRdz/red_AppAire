function [Y,Xf,Af] = SOXLasPintas48(X,~,~)
%SOXLASPINTAS48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:48.
% 
% [Y] = SOXLasPintas48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.0179856115107914;95.2380952380952;0.0558659217877095;0.00576368876080692;0.212765957446809;166.666666666667;45.4545454545455;29.8507462686567;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.8844263353674811;-0.00087685301833330398;-1.5719857201875471;1.6561954340793572;-0.80111527207732658;-0.18003593614760749;-0.81654468322616647;-0.90849096036724752;1.3048759568752919;-1.6036990497306611;-2.816672570856896];
IW1_1 = [-2.0417685498062204 -0.095761849394669168 0.55305850440487569 0.066623957233756415 0.27155201020873598 1.5812704254250272 -0.060012778893547732 -0.058652301110805667 0.089069834663005193 0.34830041774891646 -0.81668413702748521 0.050081727148997716 -1.5545663651731934;-0.57244070522764867 -1.1396904722034504 -0.31831875620135752 -0.68510104819214379 -1.0723305940663335 0.30029645689373086 -1.3642323347588385 0.98902998147047227 -0.70315750170691926 1.6550092100346872 1.6696055538791015 -0.95906473507954715 -0.86436328351317226;1.1824471673923189 -0.58690996037920884 -0.64639873912432666 -1.7305263788616805 -0.25255347496309682 3.1839930665731315 -0.031577166973252357 0.343776867827502 0.30439826652888591 -0.1696311498757466 -0.66069223277225531 -1.0520403650445138 -0.62660110467798791;1.5670061729080018 1.8057701358456084 0.90172789654635643 0.056270498299133692 1.1386759262217039 0.17939115369764902 -0.06307915568062239 -1.5129272581225914 2.2071735714368135 -2.2189600261373061 2.9658655780173659 -1.3154282032319833 -0.58179455993560425;3.1198316857738133 0.16511060119367243 -0.94557358115555257 2.2933568544200131 1.0457848949507629 3.1865356217370127 -3.3199548243116737 -0.54900829622609948 0.054671998772798436 -0.52885326766772667 0.37071033074670817 -1.4270473776678509 -2.0865826106384566;4.3080991354460938 -0.5553468813592648 -1.1317189224197175 0.64689679177319837 -0.15281554220431415 -0.77897074586063475 -3.6932278913912571 -0.57728310810150163 -0.27505536221151783 2.2492875681422775 -0.24162806993340277 0.84259903353910059 -1.1110416739478568;-0.53411678168832921 -0.56672904229734666 0.89891408544130946 -0.13888768563375725 -0.3574273482435566 -0.20112876282367187 -0.23142651646335091 -0.32239429216475574 0.82543020398714506 0.23446974450265062 0.69543165668035156 -0.17357067716798497 0.66214851403669994;-0.28989498440274364 0.37441021354467274 0.34492095255562127 -0.12323445724578326 7.694750545914758e-05 -0.048160762036446092 -0.53425771305565561 0.44864862192319932 1.0042752922517602 0.18726685528822179 0.3572763392339301 -0.31301145335747343 0.86788434891212984;-0.56970101574675613 -0.40515879453909237 0.048798716810358606 -0.55349542217668346 -0.44866042146846224 0.13491225320770384 -0.85043219816526672 0.32625501780270766 -0.22056946403487979 -0.47970654757650205 -0.62486374551694557 -0.21697319554287064 0.060011973826324727;0.18860302625147377 -1.0313576019623574 0.02744352569103712 0.42971647542577024 0.90783079370541508 -0.11295622240753238 1.451968801199182 -1.9663508045465323 -1.2892672255166588 -0.5974774359865036 -0.99208657261356437 0.68795765903621064 1.5698927993700122;-3.378887105159178 -0.214344378824775 0.1110653958945685 -0.031826139110859526 -1.0145646593122042 0.45867611763363558 -0.81548185848634547 0.19050859723546668 -0.50956374463352683 0.047003773919475307 -0.39264395480367076 -0.50889638475090693 0.65669579410807233];

% Layer 2
b2 = [1.3245951460044623;-1.4183070267525875;-1.0050056957286175;-1.0740071741079149;0.32867108066099626;0.1756013252227146;-0.21918644377438098;-1.0515410825203275;1.5114041234179301;-1.5159816388191434;1.9211916143227035];
LW2_1 = [-0.34487045679949191 -0.22105366580539171 0.16831923166304275 -0.16992761370226331 0.07938152389021183 0.35105666809998243 0.28729223806917381 1.0080461798331404 -1.0919041075226517 0.049381470304850635 -0.0043845465083593577;-0.25023355780050027 -0.92784179519313648 1.3965848488130259 -0.6705407579641971 0.52467742649034055 0.89197248895422443 0.54103142042490915 -0.26964724694473896 -0.17028743945327449 0.083316137325128062 0.71599112104820972;-1.4851341513564607 -2.6536816913896004 4.4655304236229814 -3.6343531129501856 6.5581639300288774 -6.0707289587000766 2.5169600261818821 2.7144284521888324 -1.7732846335423005 2.6581852616390762 0.75824586078719058;1.7973044905134248 0.46771802217344471 -0.86168342479833226 0.24161354977607596 -0.39624403582402606 -0.45670934685583731 0.17065013817376709 0.30167524089026854 0.47796707587966991 -0.035119425348825395 0.28989953220611264;1.8239707997136643 0.46732141137745792 1.9248596485384546 0.52914217560617693 0.68373944807211817 -0.78352544690204984 -1.2466006001121333 -1.2205164046121022 0.12932673624148666 -0.24044584778913447 0.4098835358027948;0.92306709132002229 0.68918585677187605 0.085109836563979122 -0.024163371771861127 -0.54884783330936349 0.31885044462663625 0.043070036655761826 -0.66712065848696822 -0.021998272457410623 -0.59233797683339706 -2.1942646593541881;0.48630054591287919 -0.44309980809227451 0.75217905977385691 -0.31464770985798285 1.5898692767506752 -0.75641961154213644 1.1620641272591337 1.2144904124584885 -0.6944338510359469 -0.66574187533291773 1.0778818870898699;-0.24987056949429742 0.27879454343096888 -0.94729114552492377 -0.13671470144758358 -0.92546769247422089 0.3887515456581605 0.28723030577925868 -0.098808277209924106 -1.5465714958060861 0.21163910477297931 -0.9118150459204335;-0.073950605862942109 -0.041532506894827431 -0.68653899736917368 -0.016921774437339471 -0.17737660703750108 -0.046890577612379129 0.12482406591645853 -0.69894195544291104 0.09849387372015686 -0.087329327722773742 0.67665346872589105;-0.47585068444898243 -0.73221502895316048 0.2574970204155016 -0.74785412916325122 -0.43182938187510495 -0.16713571044299527 0.54438043737865893 0.58418415124151324 0.43387591929487579 0.29668676875292777 0.24261223049917979;0.53161821036869872 -0.051104326470699998 0.58644210349139803 -0.054450078329702022 0.76540898016654046 0.50366223089598483 -0.62786697020042714 -0.034027581305654815 -0.01306880477484982 -0.34101663807843913 -0.5493165328108599];

% Layer 3
b3 = 1.26344413932634;
LW3_2 = [-1.0595468724852835 0.24580473712213505 3.6353951204720287 -0.22522151496497578 -0.81528621172709037 -1.3920078753610767 -0.96608471335689394 0.16668578797305461 0.56399906734404082 -0.89977918542626401 0.81230345734971321];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
