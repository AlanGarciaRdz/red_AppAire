function [Y,Xf,Af] = SOXTlaquepaque12(X,~,~)
%SOXTLAQUEPAQUE12 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:59.
% 
% [Y] = SOXTlaquepaque12(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 15xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;3.03490136570561;14.7058823529412;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;35.0877192982456;117.647058823529;27.7777777777778;5.12820512820513];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.4938952020600409;0.16888444268877312;1.3954674630424928;0.70210087005979083;0.13163460549922157;-1.7381959321744935;-5.8887089085282076;5.8506281872354933;2.5027209127797789;3.2262880590626173];
IW1_1 = [-2.7527157380831597 -0.21569729181702443 -0.1516619722109204 2.0509305062731893 0.81740991918949335 -1.0682195906266341 1.0944515306654645 -0.66359276304192982 1.7808436441433597 -1.9939446488602306 -0.12815447598068386 0.25482666399878728 -0.62524217771528767 1.2428063790775674 0.13639444937875977;-3.4600813640125869 -2.2051892020363475 0.64070228119686712 -0.094558885951134444 0.72703275924697619 2.2421297154166586 0.10578452221804233 -2.1832580779038597 -0.82962010171326306 -0.19473605789250903 -0.22583095579896162 -2.6252244944672043 -0.16378654595483938 0.5474331815565241 -0.93330484466234465;-0.57388419728513496 0.33592414648039604 -0.037177041132790453 -0.87581002958976684 -0.51228565047311581 0.39300051270483383 -1.3886245272271873 -0.48472471854675425 -0.27121566631437299 0.37267717463516803 -0.39034196509924851 -2.2502035069469617 0.13148540651017457 0.24347040640873219 -0.69822581768601222;-1.2931908301582229 -0.019725733133176899 -0.41246647723831015 -0.65815644011257124 -0.085811122033458323 2.0961721169408025 -0.070172842766680676 -0.64984164839849434 0.68154072959581813 0.61477468832564119 -0.3670579203527416 -2.6225241737352061 1.201273536787447 -0.32806598913192553 -0.87390086112895882;0.3164441824322336 0.12990991614350059 -0.56452513892029743 0.48568192933164434 0.4246347448055679 -0.78650787067359773 0.3245208842700969 0.19113049775794563 1.0882169803573007 0.18606407190181815 -0.17181134611882184 -2.0290651348500419 -0.11238282237391511 1.4546342683708886 0.37639415356212846;1.4793199026710757 0.15938512874306401 0.41896588865292467 -0.79654277673086427 0.40050716235888106 0.12683979247937324 -0.53782831689052901 -0.57457393602973406 -1.8704588404780176 -0.36462248650923568 0.12142327311835924 -0.48825832155823773 0.26623641198907333 -2.1269124586914483 0.320345499015878;-0.11501663973241713 -0.11520149194672427 0.51159932160441335 -0.38411069331081354 -0.23999088081933156 0.67381128014538916 -0.32243342259654101 0.042847273476255388 -0.89739718840171245 -0.10188039485032985 0.12273865020650851 -4.3819517324957129 0.10737078228231724 -1.1133217449804262 -0.4045131922140765;-0.74492911542236973 1.6713125872890593 -1.0160989423721989 0.13654265233966587 0.11770076378353179 7.2557318033775635 0.37812797612164983 -1.3473974001493438 -0.23672461034063705 -0.43108757083337784 0.23538832459570042 0.12960983357396919 0.2881276888139998 -1.9149433623099525 1.071912565363097;3.1811001977143776 -0.8368885156110133 0.47209550183056886 0.13592243584091646 -0.77243232427940922 0.28371732264325777 0.4420135454482621 0.31628573351487849 -0.98310017411835993 0.37615127230256956 0.072500907458470251 -2.8533118634909651 0.783811461043875 -0.32895680822140061 0.32018256901302117;1.5564694101894907 0.044131768306488461 0.37349357135781858 -0.66413879078573701 0.301249943937899 0.35284763843675809 -0.62712086016869595 -0.18257432727058345 -1.9736795209367233 -0.28411929765461619 0.14845353378786849 3.9864264156596607 0.33601072820139 -2.1617786140118169 0.082735623519603396];

% Layer 2
b2 = [1.7241039790851853;-1.7335101253786296;1.5628379925540563;-0.63417923105957441;0.36148764123930183;0.41648999956313232;0.13066409356214337;-0.14571498782888631;1.521351119551841;-2.372557517833271];
LW2_1 = [-1.0864361128115791 -1.1805885384961603 0.13187932746818753 0.36845609932428475 -1.063835865520929 1.2008588510769658 -2.3172217026647757 1.0670163131228594 -1.2236942990623305 -0.5120995106466143;1.0090232191920576 0.19734460101712922 -0.35461361692282173 0.84193577911187667 1.1143329637351591 -0.98253770796965478 2.4190635237826612 -0.87584937013332054 1.3539214992138036 0.29506433542164356;-0.77204177454369394 -3.707742894838356 1.9148582620025725 1.8692550350734318 1.0127833287636876 0.84569315649292631 0.18935190832163906 1.7475208179535062 -1.619889368534321 -0.22714640945872719;0.35072089906413134 -0.71783821568613937 -2.3343297044983022 -0.1804601914713069 1.1374390521451638 1.6306696800448037 -0.93081985139194201 0.49004532546733198 0.81400331449648455 -2.8289520972314777;1.5875474960453873 -1.2383955769410124 0.52291149929121816 0.080174617588011476 -0.79183249869318562 -1.443999936337653 -0.59626623140443136 -2.4139239696554107 0.060418694237996499 -0.03007009472531065;0.22533686749198822 0.058187096203214959 0.3512059315334542 1.2916358350782782 -3.4342631779376065 -2.9286913133846451 -3.2933260641419713 0.11666119772397317 -0.26389945346031451 3.533055632861259;6.5850634146679594 1.3692475306775429 0.94678938712590033 -0.31507848815984751 3.0836492920119198 3.0895653183343716 -0.80313377704188493 2.7169483810809187 -0.3696745523368663 5.2812035658181333;0.72362909026572608 0.018857300884291495 -1.9944289489539446 0.72377960588999102 -1.2790010566598982 -0.75159823724487185 -0.52370050676120117 -1.774891333919894 1.4011283920185407 0.12495248413273793;-0.11636081267498927 0.30173307957427897 1.0416621641365269 0.69408390927581176 -0.32058096753871251 1.1188913368186519 -0.64036740132393732 -0.31383940724587089 0.69573046271916272 0.27560890792419585;-4.4365409166426986 -0.18686360641216293 -1.1655702972557465 -1.2400087444494776 -1.8888799954937825 -2.2283004154058101 -1.4498502003208957 -1.8473355343279614 0.51518836983790728 -0.34020671236563294];

% Layer 3
b3 = 0.34372001494746196;
LW3_2 = [-0.77297294794689109 -0.66842093126292168 1.4958119467875768 0.151166172777848 -0.063792776522420422 2.0916005692269515 -3.875458136999629 1.4171321486176522 -0.18662207793901417 -0.81667249007316201];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
