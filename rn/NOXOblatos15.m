function [Y,Xf,Af] = NOXOblatos15(X,~,~)
%NOXOBLATOS15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:33.
% 
% [Y] = NOXOblatos15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;-10;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;4.05679513184584;0.195790504160548;0.00618238021638331;117.647058823529;0.141843971631206];
x1_step1_ymin = -1;

% Layer 1
b1 = [-0.11403755342152926;3.2585608112143625;1.5103532913742412;5.0051176710739549;-0.31653164556879093;1.6158002239293914;-2.3371523496793345;0.45494718240810889;1.5363704636396991;1.9434036108757076;-0.43911515982749388;-1.8850813424101893];
IW1_1 = [0.1957936820803195 1.3129627618328603 -1.060742644737465 0.60552244961309765 -0.64285847419098596 -0.15467487164775048 1.5926949721941184 1.9428144293198535;-3.3866014647837273 1.4172661887779581 -0.89007447707314236 -1.1218023235795986 -0.44916846738784266 -2.9217895199805564 1.9497683072409173 1.4881614073158007;0.049132154307253685 1.2860752367653678 1.316155994193243 0.70632190626485891 -0.07712508517172087 -0.31445314468627567 0.41692660757635774 -0.16101661131666808;-6.380452760109768 -0.15484257168281962 -1.2563052904808909 -0.51441997289556785 0.3000273846783062 1.7437517250792114 -0.035721050989896211 -0.10597310951907649;0.077168094401616497 1.4463085523839294 -0.010701357121474596 -0.4678158677571479 -0.023963205461722602 0.20382888289724618 0.61427841890075663 0.18747682739722391;-2.1600841190955635 -1.8469112780063495 1.2989937687959072 -0.7860202369954542 0.15126594079394243 -0.27699214655598797 -0.45974160762214644 -0.65563942265896924;-0.58625224682483135 0.33783098177951737 0.64507805980498234 -1.1676237260457025 0.60099495822850835 -0.3549404906271118 -1.61906544107901 -2.0495561592252218;0.72832953765419994 0.96714654431399139 -0.62848088030511484 -0.6006817438772416 0.15153635544675362 0.18586946623405429 0.17772673349542917 -0.15203609268767607;0.63206585248704705 3.2336980173066339 -0.84687841838664668 0.93143600808916593 0.058225912828815667 0.12942414641852021 -0.29973920881845645 0.24056630241983457;-2.0287982030721592 -2.8993433530330326 0.57964959398786287 0.92026068727696775 -0.10400769519769959 -0.041605857839030938 0.32467655724141142 0.072329705435640004;-0.76749279173499441 0.97353492097552086 -0.81201869659844073 1.5607617314602122 0.079561193360987978 0.042335410049768124 -1.0544237442604674 -0.087360267260669755;0.15073343471497222 -0.1323819440626344 -0.30198234247919215 -0.078454083775343311 0.70598719263732868 -0.12773667924824272 2.4849029961030769 -1.0196382213005901];

% Layer 2
b2 = [-1.0036494659042983;1.0297612465387975;-0.50338709280580396;-0.016762357788761929;-1.6133434032636138;0.96965044132875633;-2.1820007495439477;0.054253457296254873;-0.67088267925297651;1.0656700809813806;0.71806456693379517;0.89440559584016799];
LW2_1 = [-0.15199368193263876 1.2928901204584238 1.4505312157448318 -0.56637102507697712 1.2993527641797382 -0.84644459705061781 -0.49871508658122299 0.88485137031402916 0.4123209411281375 -0.56497186481944617 3.3466715394210036 1.1375924417982404;-0.32827407806718711 1.0659774848040813 2.9976922034908533 2.9981554962138284 -1.8742453104754091 0.84762468712529637 1.2769496177778097 -0.73834868902112383 0.41835411648329202 1.5341994973222959 1.7247923912424976 0.80108606639526914;1.5272914991358273 0.10800556329172772 0.92390199438202614 1.0104737088263154 1.5260355098261169 -1.9590369275818773 1.3225483195537089 -0.62960950197765353 0.54079930235760731 -0.76144477260203647 2.0841770584150412 0.29002041656224359;0.589393514645839 -1.3452680136008153 -1.0461536826872078 -1.1410366327289767 -1.5496269102338078 0.673765278970059 0.34710784921580173 1.3346543023569752 -1.7271381145376978 -1.4086087377540895 2.2210958548994864 0.79557846794292142;0.20528437393511512 -0.69215878087696936 -0.19628099128403423 -0.54789802574010571 0.83761152313752596 0.2460953729854799 0.40261182473944218 0.23991335518283541 1.322059282221443 0.42854373416928865 -0.49227492108943433 -0.073488483933496981;-0.37087694677235755 -0.90894078217487217 -0.21002163808853924 -1.6067288967093982 -1.8182091555715878 -1.169488781718959 0.27174070545264234 -1.3316005543359408 0.41562490526507184 0.20983988312167196 -1.0567579243596388 0.28936798595052626;0.032158624328262643 0.80747363950187201 -1.4855069951757964 1.0394031542329472 -1.0255351556147301 -0.81808230607349874 0.23356161416400223 0.29206334286769664 -0.29704489766866826 -0.51913225602771174 1.4836775387088799 1.074818250672458;-0.65642271901192895 0.73355925099124908 2.3168175113521361 2.0223998026084855 0.3038233459965437 2.369633128724332 0.39736848024869703 0.25917284550324071 -0.60861252089667661 0.27804299192142634 1.8272578067821719 0.09186551161324466;-0.8720518352009653 0.63870506818689154 1.7852677170001261 1.2822251187222642 2.0959549480393069 3.4716001106297414 -0.57745422926933943 0.92830871976697737 -1.2776209749191585 -0.55536452900612576 1.995980745058215 -0.52269080188631223;-0.084728361417303097 0.67391652043397454 0.077503054229731944 0.60394270382261772 2.4451124362438725 0.59273998324616228 -0.012205465361663406 0.28288343517058318 -0.33280279490250303 0.51712768037113244 -1.1198721292383378 -0.22137987608953574;0.57078632711760213 -1.5578390570001472 -2.4161066721058995 -1.6204687020220732 0.27516652398607949 2.0840765741248131 0.18562745511578937 0.073582860562947328 -0.80005708102796824 -0.49698891066343254 1.9585411622186877 0.95200999422843546;1.5701963100118073 0.14575886427218593 0.63770506077741007 0.74908311824177976 1.4303586570462576 -1.8864902733657267 1.2699672812860927 2.2094686491020195 -2.4888758187420192 -0.46813415283568083 2.3231821117421809 0.70813394754167769];

% Layer 3
b3 = -0.97698967135638437;
LW3_2 = [-0.39432804249889414 -1.6050053019570936 -1.7328954212581107 -1.3160567416626168 -0.62512564780039237 -0.39758541322353497 -0.69577252066189588 2.7913125248661985 -1.5856004686138983 -1.4903901009548981 0.95452472775093322 2.1446810097860869];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
