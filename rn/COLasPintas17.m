function [Y,Xf,Af] = COLasPintas17(X,~,~)
%COLASPINTAS17 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:02.
% 
% [Y] = COLasPintas17(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.241545893719807;14.7058823529412;0.0179856115107914;0.0558659217877095;0.00576368876080692;0.212765957446809];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.487483413030303;-4.083938955731969;0.80051629913606126;2.233468604658984;1.6027027995557961;0.43788484922762322;-3.2836493752921667;3.868820267171313;-0.64228805009835432;2.8848717226487941;5.3268162371185683;-0.070334111315712933;0.84384977720584042;0.52643183678234007;3.6593673632536841];
IW1_1 = [0.94333678185016356 0.59720888154551943 0.48103383435548297 -0.25255778607199153 -1.3993921319460934 1.5047220146715963 0.38808441072381233 0.40443784052518389;3.8555726821997727 -2.6296070586540763 -0.40061276703499488 3.9461333170748474 3.0062823717540637 0.013026026560637538 -1.2385986552327679 0.2498688577459722;-1.3623917756594057 3.1925625177926866 0.41913651357754172 -0.21921293340514922 0.70190289014677087 2.4540769545206449 0.29494194818988795 -0.66019894153036085;-2.1153969747004959 0.54483752203511826 -0.22024210480611003 -0.15493245489824728 1.6616381104367315 2.8231298511678085 0.72924274594698724 0.28662787559470004;-0.52011910357152213 -5.7349231983453581 -1.0492652461009646 0.33169373870722363 0.27949126475907604 0.09400829492177018 0.17729224982445674 -0.18297293238136036;0.17363152191029241 1.5252546511564218 -0.085262150356951907 -0.58683868158431474 -0.27491965034061155 0.17948033798468943 -0.23952376527970251 -0.063939670682348584;1.3038661026483722 -0.63795808266876874 0.81768812372465827 -2.9431090575471641 1.657077739370608 2.5432280610797098 0.13352712887409937 -0.92029934293517224;-1.0164174608301277 0.64215508661839871 -0.827935872139689 1.2452482588150056 -2.5030679564221461 1.5931892203856675 -0.74468055409739597 0.71144912136738725;-0.16458737282390226 3.3739910884811466 0.11917632608516854 0.53500027412100448 0.82914748479342637 1.7052815614705774 0.080512298182252195 0.38664155585201754;2.6009895569530381 4.513548818589177 -0.24394982868998574 3.6110329832701615 -2.6837022470151863 -2.130288139829303 0.11186644132500873 -2.6420242650914805;8.6368903092289511 -1.5613618025441269 -0.51710869907763224 -0.78215973344782841 0.21736648461309382 1.7006168700278812 -0.20566453900459175 0.0017047283152605225;2.2877882309903201 -0.90118900789739953 0.0221382724894887 -0.52296290552870262 1.3568379286329115 2.88567867049442 0.35119467904853341 0.74890365095763589;-0.012777841208226495 -0.60635891773666739 -0.20388592343737943 -0.32993282907425353 0.059788728254081214 3.4135052289775127 -0.24694500690905982 -0.54453794812543865;0.19760135527812819 3.6290098000307398 0.75203131156445124 -2.5115134687693392 -0.84024250779998322 1.6070666468105996 -0.26894702075627747 -0.53597879991077257;0.080643917017971856 1.7658882782830778 0.46820340375675862 2.6683828694102014 1.050983474967937 0.34078083475214344 0.60301819090230613 -0.35206692275468976];

% Layer 2
b2 = [0.73307577296984128;2.6413700961768565;4.2436689684532292;0.098151890140494968;-0.053309197734714257;1.8523610201736698;-0.77764743825571503;-0.52006513068891147;-0.44140014796834498;2.2552388075531606;1.5488028136303913;0.46429562588827689;-0.25510541912658347;0.77628125154342231;1.4319190839736875];
LW2_1 = [-2.0258607195922784 0.60252029850014432 1.2220227337475078 1.1639955639393049 -1.292726469172498 -3.5150217166686706 -1.3521354503053022 0.53257623914466379 -1.4721617971956293 0.58433069232129298 0.50646383762431324 1.7557845902837488 -1.0113207606264287 1.7299117728570355 -1.045103266808876;-0.69212248897112805 0.44615792765019763 -0.009978371610100855 -0.15158272387383148 -1.5168893465717197 0.18695876114939347 -0.14241130661486121 0.018493888206611721 0.35661239613666401 -0.078199747167197894 0.76164097951784959 -0.50576613998099995 -0.81793535405300055 0.22018498877469833 0.35978782197362924;-1.9508044211155267 0.32045452121690365 -0.82860140761491929 1.8096998907280049 -0.32090469795122833 0.17594812919324018 0.24902680324596504 -0.73654872433444885 -3.7076611656262468 1.9111664116943352 0.064522363349485412 -1.4821153617558891 -2.9105197987764821 -0.43406081466436863 -0.66780398214421255;-1.009656373998151 -1.2685936966307518 0.28425514910576194 0.81095701062752656 0.19749173940665732 -0.64160413515081616 -0.19566053984151902 -0.58848079771423745 1.1995430331292547 -0.18618152284145431 0.7293026888798505 -0.65997896613834928 -0.46064430955430002 0.25402454275785491 -0.60695789098822206;2.0114430566793411 -0.28668136820243478 -0.01551790461761423 0.1279692201954315 0.4524287111280802 0.655705093194352 0.38323963184200804 -0.21279220258268797 -0.92976964837138087 -0.13120696742640398 0.17031873084027188 0.92594897760718209 -0.93895112196545094 0.050958983384525196 -0.12513028159070486;-0.034162023708160717 0.82116291208975389 -0.38631253609926791 1.0821679827465773 0.57640922460735411 -2.1880112008010513 0.065050049937196208 0.45323584285822288 -0.66275894984274075 -0.74322422346030403 -0.14098802950175668 0.046361196043945216 1.8029129661847465 1.590319857233341 -2.3987779935841491;1.1119186760033628 -0.92072041433933427 -0.11674247325887943 -0.5908378654234212 0.56169106780699862 0.66635361174482322 0.32793704364679843 -0.13151547199323307 -0.69326877313632407 -0.18460802821117694 -0.36529655548843559 0.99397596366381413 -0.47967724176872051 0.23170820831547304 -0.13473096661688796;0.061205584695799412 -1.7932621788394993 -0.63403802795774411 -1.0467323932033556 -0.64935200900927903 2.6027767929812948 -0.040574363731900071 -0.97378026091205272 0.99533728968444513 -0.44593988216558389 -0.52178330717162136 -0.21150211705476346 -0.012873207652414455 -0.96716806457994831 0.34711539108197037;1.8393602928268089 2.956052812003314 -1.2961062708222837 -1.3105853703446662 0.24887830994833748 -0.371537555002944 -0.087578001117246368 1.5880097448493333 3.4378160307656809 1.5176730276469341 -0.89175837966844484 1.356947714733419 1.6792613709901174 0.07235562896598384 0.17197153874602858;-0.40824425094779176 -0.11415433125095793 -0.11902035388295698 0.66414574868569221 -2.1822125943778539 -0.57089793656469379 -0.46206754816894546 0.55051567612943575 0.69224150577268595 0.0023741372281075243 0.228724904561808 -0.89192307606501087 0.01846722058954535 0.60152714342834557 -0.05325129523095485;-0.64207949086701965 0.34511802488799093 -0.0056395707006085521 -0.70919380111011465 0.35466247198032302 0.3292610966139185 0.032930679454241871 0.1289391078250417 0.5070369856017295 -0.055882099823704907 0.91071935944163795 -0.45709468417041926 -0.95215570243830572 0.058421258886922039 0.37841226339098771;1.1647339654571227 -0.53191009975094239 -0.7608973075381591 0.56158400642237183 1.1534015156054163 1.6454070545518873 0.50949396374089806 1.2579626386687484 0.44302193631076858 0.27863726034091313 1.4327900719351327 -0.76217196652016139 -1.5711907059073749 -1.0237951250277464 1.0337221372994994;-3.3972012792608335 -0.95614608356036679 0.22083070455583081 -0.55942197360079804 -0.51351825698110387 -0.24444949058229171 -0.3295918308172448 -1.0147274750484601 1.2141657700009283 -0.18395202823947571 -0.76349730667330418 -0.33147749368640911 0.58884804925295575 0.17527259665657108 0.00051953848536202135;1.3814957798742389 -0.80963653005213654 -1.2677948854247663 -0.15876384914120095 0.8888666982643787 -0.22604939841503593 -0.61438402775101564 1.1048464609515298 0.24359019138160681 1.9548833019839986 0.98790708486152623 -1.5297789993760142 2.7661582539720926 0.73191153753965121 0.69713379517383811;-1.2641025228538176 -0.73427616214370239 0.80797392642445653 -1.9995275664789647 2.0358074350285715 0.40155116073744818 0.19933800585855618 0.33130179950801147 0.72692467415755802 0.097718555042500543 0.46330599218473512 0.099301406935644543 -0.16492393429393606 0.36095132016352166 -0.17659381845826949];

% Layer 3
b3 = 0.053565599352931398;
LW3_2 = [-1.4899959152827205 3.9098965302801156 -0.88525629073687495 1.1207288519543308 -2.8894741807853879 -1.2822909823244892 2.1852014674956166 -1.1733746490656776 -1.0241623184270423 -1.422185125935667 -4.1780537085273872 0.57911725795786839 -1.2459390684176843 -0.84833528527753843 1.795430836091737];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
