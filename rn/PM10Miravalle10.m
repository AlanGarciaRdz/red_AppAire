function [Y,Xf,Af] = PM10Miravalle10(X,~,~)
%PM10MIRAVALLE10 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:16.
% 
% [Y] = PM10Miravalle10(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00382043935052531;0.0208986415882968;0.056980056980057;0.0063552589768033];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.5057814259114433;-0.94333910793791764;-0.98595562950008597;-0.35599607126078903;-1.5649821279384848;1.3620852236275867;-1.8397516366886648;0.64851033392652424;2.1808552286687433;0.51891886964155798;-0.50086837290077846;-0.11741709824229574;6.0922970087198722;2.945997687095395;-7.1905820220354819];
IW1_1 = [0.19911183761926135 0.56601879230478569 0.62149040941022715 -0.51383692216971477 -1.1548700647482177 0.51649627669985709;1.2590524693607492 0.14575329152725994 -0.68624067033924274 0.53221759735426821 -2.5810235454073869 0.034457983375946341;-0.4160247295822424 -1.0046720648866696 -2.2875743382831439 -0.25480513469765115 -0.077782807031580831 0.077073002869089816;0.30708499698813269 -0.50076734635821052 -0.52894083284976634 0.017684435755531282 -0.95385003636369303 0.029301122445537491;0.85222326231477452 -1.0326315953327447 1.3318592509120193 -0.43049732564599896 -1.8338392423844296 0.97089561572906813;-0.17111445150759988 3.2347593420973939 -1.8271283279792003 -1.341764385488603 -0.11429014613592442 0.32080056094717119;-0.22385250859005748 -3.0631333051846275 1.2074196241699278 1.130464746237241 0.4932351922677799 -0.3083233570867126;-1.8768871026459031 0.62258444154594972 -0.65365225937164195 0.76179365525699072 -1.5757042753675319 0.36506146652561228;3.2176591806670229 0.18835575873016949 -0.65309538711172443 -0.24664558384893065 -0.50517924493746624 -0.03753830076028674;-0.057323128982201252 0.21498157058864281 1.9786101742869142 0.57462145371524409 1.3477154710265467 0.14938000145297775;0.5341816064724848 1.3058841302417863 -0.76904845177248848 -0.13525367401222391 -1.4601045837134614 -0.095481374829411284;0.030193126191866183 -1.6632446193126265 -0.24274489994242665 0.25293577548881485 0.40545149904446165 -0.30590247970643419;-4.182597887762455 -0.090227783326594965 -2.9511312371364253 -3.1927415934615948 -4.7868035018018951 1.6776371318122438;-0.42024597309335004 0.84232977422600341 1.9197044298592374 -0.48879744152156435 -0.8271689830774418 1.3251615548841629;-3.8176632659037013 0.039630270137758342 -0.18328938169482262 0.28356960312905805 0.029708383150643225 -6.0172525461100648];

% Layer 2
b2 = [-6.4275716126325602;25.780826629732324;-0.865438455904459;3.8262296525941362;-1.9111473145476932;6.8818904770415292;3.5308699170941242;-4.8060837026636474;-7.0250181999488781;-4.9797986758690449;1.515935907926738;0.43290434743441225;-0.33177238046024893;3.0328505372283647;-9.6480360592973682];
LW2_1 = [2.0003230525894899 -2.6125828689045072 0.40043237260169862 -1.3056199299844577 -2.2458456359987453 0.88676867152387362 5.8102478989053736 8.987962594677775 -2.5728915259700749 2.4916622557697656 3.5357616402952639 -3.7307544580123011 -3.875965129766294 3.1582856017435597 1.1279343915050541;8.3153705396222346 -5.8046929067255739 43.311568503152913 -16.311579719573292 -27.366501992929372 26.349447170004396 -57.053429373805649 -58.248942017741285 17.355214199421198 28.472250314198728 -56.647066001733336 -8.5964689808733485 -26.056438524489632 -1.8444698361142033 27.425460737487196;4.9371022651624035 2.7805643981091146 3.0537777020447483 -1.7979484201723894 2.8194757306773992 1.4265724673399296 2.9540838584240992 3.0292901256310452 -6.078497211195744 -12.778869201991485 3.134154302851869 -1.5224362892044638 1.6701786089061266 -2.8660559244433528 0.93212840504908412;-5.8824343158740877 -2.5869585100349703 -2.3134525374228971 -2.0413975249099297 3.3624831679585085 -31.345782290001619 -28.139479057183735 0.3451533641961208 3.2672358638292076 -0.41295780070274429 2.8108128969208117 1.7407631349254207 5.8128925711015773 2.3315992419867246 9.3071831361414059;3.4791922926538366 1.4553102595501795 0.95921737003094587 -1.3838292693682119 0.37303566994029969 7.2182339765925754 8.5174839783988521 1.628865799940191 3.5839319119205633 0.61178003780174217 -1.0112898770195378 -1.0619297656879978 -3.2222606990562839 -1.2664042811945841 -0.89703960499750912;-12.916303743950756 6.6213454634091029 32.930636750435042 -36.614760674554319 20.565842210313782 -14.197599593328636 14.972039426219634 -9.4576936913512846 -10.302488394965611 1.696671649072528 52.574371275326683 -28.726661405142856 11.673691859411738 13.177504582418667 28.544157728885576;2.9596309409070125 12.220727320852946 -0.22212997386150046 -3.9563564057789247 2.3807704710367408 -17.740190499084608 -4.9470126103985113 -7.0805226724295123 5.3301424203197358 -7.938249638392211 -14.67910360289666 -3.0587055148593763 -1.8663773303923727 2.1438552228978458 -4.0339853769139769;3.9533968557572097 1.5756799822410152 0.79864434158821918 0.38954611014859097 -1.9555323599539443 -5.4130694633960106 -3.0228783588342432 -3.8893593419073302 -2.2213334455957279 0.0007837933116065926 4.7457854702287534 3.002240512033981 -1.3837716056744858 1.5025562408690658 -0.68357322144404342;-6.7853620883121755 2.5994357994320052 -13.799705028272474 4.9360043439048189 16.835810489585853 16.483646712551316 26.314575995937719 4.7624591540737509 9.176858523839158 -18.072704395963054 -11.900723692195855 -15.770691906867778 12.666982051210374 4.0341673385928978 -4.4344021025039888;-6.0057619729211407 15.945925995223625 -7.7149057086728883 -11.008196060600431 1.1780397064083732 -3.1584303487210517 1.5735294091905239 -10.297337646707705 3.6795748332721945 4.6147075535815887 13.483684331092057 -0.94529517581160805 5.7393067791506924 7.9262369341239536 -15.063968767772577;-6.3355400660784618 0.50064292046209191 5.0027253950057151 6.2338723482824285 -4.0247845027461757 -10.773518756853218 -10.706668142479726 -1.0946877377893798 -0.06795196031710482 4.6592937684778315 1.2873071026546259 -5.2149006837810417 -2.8159198181697538 0.98420843005381264 -2.8063741221724241;-4.5093185373771059 -0.58536760960535694 -0.1504211530726004 2.7950206641939515 8.5159442402984009 -3.9378445811904528 -4.8367141043400164 -0.88196161192419553 9.0658840332620443 2.362671049323763 1.9784127279515635 -0.84408381308698643 -3.0824674370962821 2.4584667062637346 -3.5418374436799369;-3.2630990230941821 -2.7301320419455624 2.2679817776668676 4.6669006547686358 -4.1505664878241912 -0.021985585033369649 -0.070710435303576388 1.3226077957087652 -5.629359818349708 2.9911191792167386 -0.21238230737294975 -3.9082106821969664 -1.7888531352158568 3.2439855363512677 0.17267696149925474;2.3346595720517183 -0.46994067669007761 -0.23451300835546113 -1.338332346393744 2.7920992649999019 2.3420928013300526 2.1274204054674777 2.3298777900027723 3.2812662067730716 -0.76445532234202407 -0.73934093154988234 0.42102736867920204 0.5193147528453933 -3.6501624034507807 4.1556356541602435;-2.142796116018947 -0.38332127965609469 2.0486860709814239 -6.4308542115632701 -3.6315013710979716 1.051310143865823 3.0286630959572816 -1.0303980750923103 0.55253955994101678 2.9861035422733173 4.5531963852415398 5.5606816510989736 2.6026069983335614 1.7190399488163923 -5.2310409759563337];

% Layer 3
b3 = -0.72269092242219846;
LW3_2 = [-0.012303598398002432 0.021372872016212741 0.019759655950200461 0.015634119871747249 0.14410103707081645 0.0087682989242952505 0.031471632311361422 0.083268694709250912 -0.026871616033553824 0.023315063652602525 -0.099489118898710024 -0.13703667795510124 -0.10597441911117939 -0.10748556726452445 0.090075604484150529];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
