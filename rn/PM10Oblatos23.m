function [Y,Xf,Af] = PM10Oblatos23(X,~,~)
%PM10OBLATOS23 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:26.
% 
% [Y] = PM10Oblatos23(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;0.00618238021638331;117.647058823529;0.0560224089635854;0.00280033604032484;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.4204553030156615;-1.7547089760030758;-1.4103418120386113;0.13342251292079865;1.4544632440061902;-0.47640187722618321;-2.249744421162903;0.027598645722578877;-0.085094116574145562;0.69601124669701853;-0.93881641166021879;-0.94204714053319805;1.8183325503405812;1.8730111541731487];
IW1_1 = [0.085695433354643455 0.46673713171025377 0.99511209454237359 -0.15406797378511197 0.22348045475139097 -0.49255865735462651 -0.015247262824363877 1.8437928627973468;3.1210405436895443 -0.01386916015504349 0.4544705555497886 1.8870542602896054 -3.7674721318876703 -0.19769654433388745 -0.56738585683938947 -0.72641720976296709;1.0470462179340183 1.7050737776575793 -0.32127858699433359 -0.24637853229592244 0.69027138426669188 -1.0995670080488096 0.13580095949236742 -0.63582791608649136;-1.5858840753929968 -0.074922762178633431 -3.322891891337902 -0.26300046274361982 4.8807266545490853 -0.45525634137464449 0.32590242683329385 -0.34189616496973046;-0.27105092890460691 -0.90485044646628887 2.1409591322525956 -1.9389331101387501 -1.2423095118996061 2.8939186733167053 -0.10927313904532523 -0.48506705270342221;0.43143301393835914 2.2446353038321067 -1.2972644364699391 1.3946373322059238 0.21032633090662503 -0.82998239634044957 -0.038461935656274329 -0.42534597743612262;-0.055067380337513176 2.2451614799175319 0.76352962010768388 -0.23447600882230735 -1.2118076018194803 0.63418755816948857 -0.46189652847438278 -0.53569505292871922;0.61679485041123783 0.10563958921398775 -0.65753848323763964 0.060404617028143134 -0.022906679638297539 2.0852188272006518 0.59203574269358017 0.80930889750658552;0.54233383436366212 0.098646566256427093 0.41830823997895306 -2.3336059856618276 0.5216516734386587 -1.0926458322366965 0.43863651574860163 -0.34071175285923083;0.70872339496731596 0.52396943382291938 2.3504706090696645 -0.58576637340389837 0.083065676218951251 -0.23138418436719582 1.6763456814878113 1.7986204761625659;0.21733676887228182 1.5688247327265543 -0.19226622121605338 0.30759197874720856 2.581947419221998 -1.5466866668505563 1.0216323791590696 1.5872182170185924;-0.38059424221335958 0.3248276030708333 1.2446587893101302 -2.6537425887945627 -0.13662416582602638 -0.92856697338903549 -0.040052598026931847 -0.43412513746573822;0.010962524139068841 2.0379673699538463 0.1642830191023181 -1.7459823122200209 0.1644195891709806 0.069387979973478953 -0.72044397100131929 0.11172516794696119;2.9392316388746762 -0.43713110087991425 0.2382759588651327 0.92493862629813683 -0.15101862271731137 1.0195347413420848 -0.27659620058557505 -0.043561312859126275];

% Layer 2
b2 = [-1.5965837729200238;-2.2324590448644437;1.4935027996871215;0.56860568670346523;-1.3701948780649178;-0.67995414217247219;-0.6399569385913948;0.31995452923123413;-0.76766384698194667;-1.1535594510929637;2.1135146895262116;-1.3938596218135635;-3.3913245342282563;0.90640863164551955];
LW2_1 = [0.63319566131906146 -1.1351326445104395 1.7652793843216403 -0.97967214099298827 0.55746859664537296 -0.46680150371789186 -1.7582478756411293 -0.43224136669669233 0.30545568426299097 1.0456782101615663 -1.3538965383728512 -0.65911818179259085 0.059141067185435936 -0.34776773236510461;1.0049219993326144 -0.084396731022249469 -0.37377931101337591 -1.9714010531470438 1.9416784160631853 -0.61654211897595657 0.4707041990591444 -1.0468806258118579 0.51935290424357528 -1.2568912083070849 -0.063196317309386962 -1.0984870851496737 -1.0413373814013447 -0.53531456360061713;-0.75568878402652417 1.0545186824252251 1.6765664395115583 -0.60841007780127232 0.39368580115119944 -0.15950828866988823 -1.2122284510587373 0.57176434701664414 -0.84760677248285532 0.052438172341758973 0.88237260113508342 1.7193527662987869 -0.3639817109910336 0.35296819916200545;0.33726539644424008 2.0704064498273178 0.55988650298616238 0.22291530911844504 -0.059570929436424891 -0.2613267604824131 0.49840204373906083 -0.39824869015046221 0.84732706648192535 0.61014738912705491 0.55104760776033301 0.42649469285929548 0.79993365901749791 1.0401171249768246;1.2643857344998155 0.81702190916304174 1.4747214749081863 0.41996562540096644 0.47111206226723601 -0.47169005494355393 1.1881672545918711 1.4364920239982928 0.43808475777974321 -1.2293487873432511 1.8463275584259664 -1.3185949257814122 -0.28435270884985897 0.1466058398699166;0.52335093287866163 -0.35887329662047379 -0.64880707818475325 -0.47936354288845417 0.056597955694202819 -0.10861315459822306 -0.3735466909393359 -0.74001479119071445 -0.29813859577867913 0.048851822429507488 0.12605451571204979 0.7523177714988446 0.9281931743388363 -0.020661735260560712;0.80973626062661042 0.38966987057141134 -0.64100515030382954 -1.2179181473430463 0.50598851062053174 -1.1195207923020143 1.2895602945609614 -1.2600632201191211 -0.054552796688823138 0.3090419634855629 -0.47825701071587201 -1.1560664140624073 0.76734650864704324 -0.91315656135656742;0.22619970591881694 0.58332835852619791 0.56582115151981149 1.2228499566079125 0.077098279065228287 -1.5913850612046458 2.6709568456027974 0.22511453828553921 -0.28895928893871692 1.6137634075297518 -0.64986405915064471 -0.59201026923292155 1.9341571618179074 -0.37527698778745716;0.64246609537747823 2.2826082742586067 2.0344548418208985 0.32136641899365814 -1.4692502445663873 1.8386240677064281 -2.9783712482839242 3.0049610138891936 3.1854967033018724 -0.50154691167450838 1.3184240823046438 -0.41500100027722336 -2.3536697987427169 -0.39325215208282344;-0.54195063698429102 -0.38979941049079342 -1.3916535309342462 0.45590878029021742 -0.58201000061643904 0.52681042317003768 -2.0380372152798034 0.19759193536646402 1.0927989746957119 0.77651705767719836 1.5510279900059993 -1.4902535937832126 -0.074061803560552072 -0.9239029231002055;-1.1917819649789012 1.525648343649342 -1.7677582662940041 1.1414485732190909 -0.39191031825762024 2.2480046958287643 -1.5062533634218878 0.3716986356495886 -1.5793627083661022 -0.33165077817101496 -0.79674760378479104 -0.42718942251836511 -3.4473601402221301 -1.3298958030229775;0.24980487523371131 -0.64072755659439184 0.37341595376021786 -1.3149257099210196 0.87125957376794017 -0.51760267737543852 1.0898505673316854 -0.45731202444304453 -0.73141679788204805 -1.6593235053996642 -1.9314528811685729 -0.86532942129706858 0.81335494830265342 0.98760873778506075;1.9121709334871859 -1.3288343471206001 0.40316250762398309 -1.487869673633655 -0.39948949452680549 -0.49769539440133481 -1.7196314898570164 -1.1829995301533605 5.2348791598319755 -0.54322513621992385 1.4501179356914529 -1.6289013269021095 -2.0731385095476642 0.31305155734016793;0.72375160930531524 -0.82241613475732689 3.092998183666499 -1.0870894222446892 -1.8966811322722792 0.0048943584096313572 0.95493974237767631 2.4000623714794722 -2.4624733514271275 1.300125385505088 -0.81213653257599761 -0.11647422496664378 -0.28293481933911363 0.17145655200673326];

% Layer 3
b3 = 1.0013718696159555;
LW3_2 = [-0.26371586801458097 0.27339194948772916 0.37791316893725357 -0.23248640350807193 -0.38915256590921105 0.18365272687436257 -0.29614199046347844 0.19041101613974865 0.10057884488182618 0.26787331791221447 0.1238055512542611 0.24727423329098575 2.1379233745142585 0.26688466560559837];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
