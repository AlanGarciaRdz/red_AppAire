function [Y,Xf,Af] = COTlaquepaque3(X,~,~)
%COTLAQUEPAQUE3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:57:12.
% 
% [Y] = COTlaquepaque3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.171659085057077;14.7058823529412;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.448430493273543];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.0845248381288402;1.1319909739088299;-3.1960949718932894;1.3779009420059083;-1.2462977046280499;0.90649363377727521;1.332332055389861;-0.4870496561133687;3.5513230507401321;0.48383982979431484;-0.33077243590489508;-2.6212194101117321;-0.58521338698684056;3.5607552850366058;1.6382214155079915];
IW1_1 = [0.68993219175924847 -1.3628927779222111 -1.0375617909671837 0.10637843609810763 0.37450301401401731 0.6240630543229837 0.71083949480116915 -0.12049482958658435 -0.21280729865930637 -2.259092415038547;-0.64163274840702456 -0.64577001891332397 -0.57703947768510555 -0.11309470537083843 0.12217730540625049 0.30322209653056648 0.27924703090855307 -0.5806679276900899 -0.17576558679226401 -0.52048994195390297;-0.34583672129571236 -0.28298122998879227 -0.29791752537074728 0.30461939144946859 0.59123166668080085 -0.86878931903208978 -1.9311100994120776 0.08446114742759539 -0.2188140329266734 0.15867468155730485;-0.68096201571136294 1.1007851628379801 0.70191333630912611 -0.1621917881286751 0.42888328493098127 1.3321341057333891 -0.074273255835907395 0.45562133040126918 -0.19499594765707026 -0.1515998196047279;0.056648915574687195 0.87840908480694413 -0.074667077063011372 -0.59421524604341192 -0.50157437396522853 -1.3911629170326905 1.4479040630918045 -0.29459417535211102 -0.1906683043733248 -0.81408446917565247;-0.11592078168386891 -1.0297012619635557 0.2605826396866206 0.31532147683376943 0.74390515735811391 0.32512585436653718 0.6397746812564441 0.45177576003670722 -0.049133903095310738 0.15153796228603456;-0.44246254943836938 -2.0690025900906708 -0.35930531290680923 0.50398289451679623 -0.32350701082474825 -0.40373073300291362 -0.038737688853913467 -0.10340836444345798 0.099181599662533038 0.41379836355341093;-0.31299310155503729 0.025727398175492036 0.81656476507648423 0.59957566336859724 0.091614552877774869 1.7558931786374667 0.25871433509163105 -0.23068595141999793 0.98343207003032884 0.43707118479717344;-0.092395364435667024 -0.31395133812248915 0.1434006523489828 -0.047676148392764135 0.039598903122985557 -1.0966709762851843 0.41985968333596663 -0.2324931564400976 0.11624203094965307 4.022655831858863;-0.78833874124769865 1.1950239117505681 0.30238761766310351 -0.053666469452978219 0.67165602678429726 1.1096451897337265 0.79357863847418164 0.15116371928893541 -0.24996539252599484 0.18199509260956237;1.8529437094100307 -1.227593851566996 -0.32086512675962076 -0.60556433467195436 -1.6249300190762961 2.6676443978219053 -0.093820397896521954 0.4014865605536429 -0.528019575500148 -0.78424423592981085;-0.19033255029404381 -4.6474672639855346 0.46557400398831489 -0.33904313207055159 -0.27154971009303525 -0.41787904105964252 -0.16023087552408258 -0.12248521780860992 0.18063215681107031 0.21112925076238048;-0.051808412823806771 0.9878450407427608 1.6942672504684029 -0.25919476824511434 0.013626834109859161 -0.54518785311526652 -0.00027120928942457687 0.092872264020284201 0.30577510602125496 -0.57701960995986368;1.0233400255246925 -0.2868011830006012 1.6749399771365139 -0.11229024811060476 0.073216567390780155 -0.58754782414645612 3.3859175371554953 -0.048208013546625635 0.47531630332091868 0.083696443716354568;0.054234791540024016 -0.0098117541322764665 -0.083284622702578581 0.11824677224428662 -0.046174716286279588 0.0058938195891478622 0.42591164001310022 0.10948108791579442 0.34364361873871951 0.10398525451410406];

% Layer 2
b2 = [0.78240178826377715;1.1297390672725962;1.6276859073589507;0.95168969210767651;0.95693842689281916;0.63614210718279351;-0.34259160137257882;0.19931892589345224;1.0123442603273558;0.13430472797983825;-0.68645769931320721;0.75505421518279625;-1.0884578258050412;-0.90918062504985153;-1.8245512066958367];
LW2_1 = [0.064371344379120135 -0.75374941544881791 -0.20659664972181632 0.4840927234075329 -0.23396129222631046 -1.1969308048858847 -0.55583364677431879 0.7113963784923073 -1.0928758709224775 -0.043847837891929177 -0.29830813625105945 -1.872286089960107 -0.62198539084481519 0.052503730985128061 0.97222201136858233;-0.71013061470947625 -0.64424645298837147 -1.4048894716602824 -0.071591260040016827 -1.1523037830282097 0.45621655478919371 -1.2309558197772579 -0.07296109429792863 2.0103195013869373 -0.34970781532165746 0.53904270819890776 -0.13463702528283275 -0.22101840232461112 0.12600438115282336 0.2975811973919209;-1.3227730845984544 -0.72390247090251003 -0.96536550764437645 -0.84008625469220866 0.5049226040083129 0.38971924443152001 -1.8367089801373828 -1.0109617936027167 1.8967296957986672 0.38121276869480447 0.13427478136614218 1.6622296662151788 0.11843303040374267 -1.1544644230022456 0.69404819340685875;-0.12384969541351626 0.10271457984953059 0.70363120910437438 0.41925027131435788 0.14489256929180921 0.16681367086452625 -0.53515181554785041 -0.32355315613408153 0.45911431559761884 0.37638730367001139 0.09073266176073172 -0.93316691249163752 -0.79253189110385502 0.77070155765844395 0.21530115405088301;0.23839651765721229 -1.2564718458384507 -0.56972344663344654 0.17026980882997231 -0.46553851283373582 -0.37112061456199519 0.17072941518773888 -0.091974541151446362 0.029001854075620503 0.2849262080854435 -0.38992827080754372 0.013051744019558206 -0.26765937585991162 -0.63421424482907862 -0.64515815671712107;0.17964242627482871 -0.23975412381725308 1.3083818709599895 -0.98099399072356053 -0.076626106844602498 1.0098422126766493 0.26822433391293721 -0.14251496682929815 0.68883663837179498 -0.5669529421138203 -0.24624250860136629 -0.037997366281770868 1.1238808819820063 -0.93668926052878065 -0.72155638056259763;0.072222021206202289 0.66569492824415966 0.63320574450007516 -0.82883773268795113 -0.11162239053092214 0.60655612681119464 -0.15033746718980345 0.36586480296631885 -0.57702503320510767 1.3045994354436095 -0.13579858773643372 -0.59948089450096187 -0.20089315821780568 1.2821374635931222 -0.028127465075282611;0.22554349961949055 -0.81080227113605763 -0.49895027464197639 0.50403728182637719 0.39972373729406818 -0.64102435747315967 -0.48794841582318838 0.067339670904472543 -0.1111925826557308 0.024304939301603896 -0.61987703997150612 0.062982052198850974 -0.14647306093051848 -0.17291251894831081 0.34460459491813039;0.014358100336618865 -1.1577869799301403 0.90767808435455521 -0.86162181962071482 -0.37415033055054775 1.0429841977033469 -1.5701629541549171 -0.88962049193835169 -0.33373678933557532 0.15066602609402979 -0.35246767700737913 1.2662932358470149 -0.30924964641349917 0.14471058683921864 1.4743965735857392;0.33341757768061708 0.29115773589818406 1.2479112779475794 -0.54830842925608159 -0.32033148934537714 -0.026490117336188331 -0.89027285300512771 -1.1122979871680927 0.30193389481714694 -1.0332276712200363 -0.7087461048082877 0.57326116188103193 1.4256155488733622 -1.0289121627374553 0.22293904412774812;-0.3566680143121852 0.61247946408721465 1.0080631818169086 -1.2121418694124499 -0.42881312487353812 0.4594855249797915 0.13140394111717035 -0.032463857786666939 -0.63276774337637165 1.8742316361720988 0.042314401949970382 -1.2956509226461279 0.26045612190035616 1.5171490883625667 -0.10066140199775926;-0.34035304421242074 0.28918361960471056 0.23436502089296923 -0.89697367984574572 -0.18240372401572347 0.92471028628481899 -0.89121432544702717 0.33198152295533856 -0.35537043796597306 -0.14785084983497981 0.61175917308790007 -0.30555007072811791 -0.29300036785354883 0.32287300704380428 0.14748083084061239;0.015026614180589329 -0.21592143991833659 0.93890207174634666 -0.14217239478310181 -0.95331535633833275 0.6755667715133683 -1.5288354399391004 -0.56381678141643166 -0.020136536876025984 -0.23142697048278285 -0.99672208557112207 -0.60140384236370581 0.68357270054685149 0.51135886549248621 0.28868836908226503;-0.1250076954877366 0.13719221399175613 0.38506767898907573 0.034385792219087448 -0.22710480075971096 -1.0853880227005555 1.5853933380342433 0.11878907519684796 -0.69691182509992433 1.7141107247293252 -0.0017889634649161431 1.6302744394794695 0.050919391688501417 0.72990245923466579 0.13853794020215165;0.074518471266128483 1.0943989522916695 -1.4245530211631015 -0.12086586943506891 0.057362719071123683 0.65944172612470209 0.34916853178774887 0.82484265060971496 0.14794966831020651 -0.3789761172349313 -0.064304819585953063 -0.85601276112220703 -0.16348074141648819 0.43658836074021845 -0.91711144271220923];

% Layer 3
b3 = -1.0210040747462947;
LW3_2 = [-1.2892430337420739 2.1410988146436223 -0.48159167337383602 0.68762531690673356 1.2132756639525921 0.88363825343449243 -1.0775097860182268 1.5374826345074513 -0.84175808317945089 -0.52939666992127909 0.80501066019773149 1.2618669390587924 0.60412289902179916 0.81350516810413964 0.75592244185461821];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
