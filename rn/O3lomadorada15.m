function [Y,Xf,Af] = O3lomadorada15(X,~,~)
%O3LOMADORADA15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:41.
% 
% [Y] = O3lomadorada15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;17.6991150442478];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-1.4220675149676831;-4.5368916716656829;2.1177634232754894;0.90242863525953365;-1.0547808501385396;1.3418803835744615;-0.15156565751592682;0.20642665732140542;1.3990483638866533;2.0555393892926443;2.3554199138161227;-2.563575847924854];
  IW1_1 = [0.71376684180700856 1.4217090242160135 0.39055548908794774 -1.9150505266944582 -0.86366453149780986 0.93290255798143995 -0.030187264660282126;0.0058801356342762295 0.41424615671589976 -0.11453558848416735 -0.27872737674358139 0.038120248083357164 1.0333244394954018 -4.9566923836199051;-0.80798617674619999 1.6618336436929042 -0.35262873878997425 0.31948712352600822 0.94100121530624337 0.77957260203329726 0.073804056634740559;-1.241644060779977 -1.832040084069597 0.37932103222652408 1.234970398943505 0.16672165242139261 0.59520742481252253 1.537369758144846;2.5547735538302034 -0.43701836725076804 -0.19285129722967667 0.28132722928397336 -0.13521617302872793 -0.16565603404669041 -0.0067642863809552478;1.675811678989686 2.0290838382578422 -0.451475590089914 -0.14014475669349608 0.64958889536833653 1.8072797049471689 -0.21388034370742928;2.3958902358252097 0.054404281038118077 -0.38288252764716396 -1.0483741006584868 -0.33470815184969577 -0.17096061799211584 -0.66993836162654841;-0.37707290800206134 0.51516485052292882 0.26042708201247128 -0.18880500311586021 -0.49475218749179234 -1.0141232572337446 -0.53561710160425102;1.2775190329195041 -1.3890627737537617 -0.68597610965249134 2.1243654823023164 -1.6860788889137135 1.7267043344339614 0.061636445949687535;0.67753534354219869 0.71263800752434237 0.26441074289313887 0.79855924078571805 -0.13790128579448335 0.65740368857178522 0.074015891179063542;0.13503711138972224 -1.1255877198890503 -0.3260852477745369 3.1038101148228554 0.17769904605889342 -0.15696762548496715 0.58714486674973798;-0.89538815119929671 -2.1986060666208376 -0.022519305312352286 1.2258922109734796 -0.17517734837513863 0.11291040905371061 -1.4325466872652821];
  
  % Layer 2
  b2 = [-1.8468385252902269;0.58676570441625198;3.0920314293036437;2.8105661065002612;-0.010387361254000339;0.13605652526252859;-1.0203648456151151;-0.5435607792703665;-2.2029342943487;-1.4747214558070205;-2.4209424821846461;-0.79850844646155539];
  LW2_1 = [0.11977671913687557 0.77622530725994465 0.76777610778915206 2.4271173982379941 -0.2733993142596855 -1.1647260433616218 1.3976572664434006 -0.45141292173222536 -0.40876920357432722 -0.48397476679479384 -1.6108650408785865 0.2913457600379093;-4.3151568026437888 -0.43743504649343845 0.63943489399307574 -1.2529001726156535 -0.2595573583957218 2.0517759727972362 0.88964267578186362 -1.5697349740680451 -0.69320707943593995 1.6886148067032858 1.0276625784305233 -0.57329689185689436;-0.37857149266312873 -0.20729610159713965 -1.6183882264861433 -1.1320850361052923 -0.62525674503966389 1.3366446790751962 -1.8771397898444129 -1.2097809302230003 -0.34072095536496216 1.8609384486729061 1.3571886390581702 -0.24527339855722305;-0.53877394080473262 0.85730070125624935 0.33282140628410256 0.17682249989623361 -1.1614628309644699 0.67886333134319254 1.1339826733493827 2.0996865810729255 0.41005923958251539 -2.7502607796233569 -0.75055943172430639 1.2043124043794549;2.4477001910163891 0.99754031228098983 0.52428162836101888 -3.3118692687140943 -1.2375965234365363 0.33446590565764728 -0.5450872043728755 -2.1296864592766567 -0.55816208817372681 -2.5742853474119745 1.6803339985801518 -1.5664869274167357;0.796806069769736 0.95432186973057764 -0.5905357345039558 -1.917405141927186 -0.085881284158098314 0.4236904862909503 -1.1357943466484559 0.35887212397270557 -0.60515315266541558 0.2670146890947393 0.37953051620710482 0.40988037230040192;0.16612367352711346 -0.069816065365156235 -1.8828194200650616 0.83399216510785334 -1.5904800084855759 0.43836946920370734 3.5083361678876761 -0.74791833506950811 -1.4051088763704289 3.7270344467530503 2.2958830200685578 0.12169399957723859;0.52046763135058027 0.66981554770459306 -0.84884420576129449 -0.9019765116430063 -1.4485830137516489 1.3928717418759506 -0.18951045570352595 0.6884620355038692 -0.2449862139926697 0.55007770389695487 1.6093641652676054 0.053360535844875726;0.24718937209759487 -0.50386375706959807 -0.52675024305129381 0.0081985095799044522 1.9226926483339259 -0.39296480724918409 -1.8889592549634602 -2.105261345339787 -0.53620466370528241 3.0747745539151832 0.46885756469277079 -1.4204206878601278;-2.2400874976972114 -2.7644802414542058 -4.0470338057046549 -2.1038503150968539 -0.90767076051335172 2.7366580797647977 -0.33137100203378389 0.27298834440054748 -0.60602781533400041 -1.2277577472970052 0.96366864658307527 2.4719484843681014;-0.016055456984468214 3.9459378922008232 -2.7331102531809899 1.7470933386470535 -2.906204914257501 -1.1722735402031346 0.13059732085319692 -0.84341038278698088 -2.3725130885623069 0.046937662818489684 1.2021511092423181 -1.8137294566426867;0.58502987297528819 0.71086399170590153 -0.84998502936157194 -0.84368322529392936 -1.1836529398889675 1.2747416302156609 -0.31394075129820126 1.3541837756504767 -0.29017453918118341 0.29960154115819704 1.5691703834377713 -0.04984081220963428];
  
  % Layer 3
  b3 = -2.3394907398326947;
  LW3_2 = [2.3676258834924182 0.50311843015833535 1.0252657604860478 3.4791436088427221 0.36527720068200253 -0.69798301295938592 -0.29588090186094657 -1.6885733362928383 2.5958962093108133 -0.15053690317688348 -1.6148748950727867 1.8846545792094549];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 17.6991150442478;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
