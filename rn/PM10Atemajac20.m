function [Y,Xf,Af] = PM10Atemajac20(X,~,~)
%PM10ATEMAJAC20 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:19:59.
% 
% [Y] = PM10Atemajac20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00968992248062015;166.666666666667;0.0561797752808989;0.00614628149969269];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.61116046336027285;1.363604278924659;1.8263308248842731;1.3675302688189743;-1.3223208629786256;0.32990383465897466;0.44885390695336264;-2.0836219560965885;0.38124789357556654;-1.1171407332813241;0.19684465721689753;-2.5947647336444124;2.8403765635322493;5.5714907922878929;-7.9339934171669917];
IW1_1 = [0.33554884445536481 0.63901238365760948 -0.17336783329165764 -0.56837740145570026 -1.6488913862618617 -0.018041295740643459;1.3924026905537208 -3.5425118519206018 -0.67515585696483338 0.81095469462965974 2.6455892371144878 0.24880641718047353;-1.346783050855255 -0.57004288802491387 -0.3546355813597144 0.98074194753900434 -4.7457329912155046 0.21998290934185016;-1.4942346353608913 0.71964363620156613 0.54283615656476747 -2.44659718586575 -4.0515579763696135 -0.90066107097588888;2.0895816455528591 0.56887007983498827 -1.483550473573358 0.41877123262728011 -1.8020102799721625 -0.04281178683902255;-0.25547541504812649 0.46741039000442364 0.62378565191120805 -0.69006008154719412 -1.1694924428960762 -0.10024061224292738;-0.95594013421839008 1.2679873981825422 -0.97997414090903689 0.71697389473441242 0.07977267030040594 0.15639909349980527;-3.041023996302652 -0.43430668341139095 0.44674248780449727 0.10331744603574038 1.6814208967665201 -0.025839142977609322;0.349633114821574 4.4487993005859305 -0.33668070110865228 0.83806742244155785 1.8318617151892838 0.064394989548877124;-1.0265351759925225 -0.52375648515339024 1.2654909579711378 -0.25672027187366647 -1.4861226901683626 -0.84590811544512434;-0.64346871620565116 -0.38377273347522001 0.38157970207402714 -0.58759062869633261 -0.82601789524632574 -0.046769730514643046;-0.47318752875467551 -3.3696342743344703 -1.2613647499678202 0.12935545314907429 -3.8306347510985055 -0.94884106028681159;5.1911387113125969 1.4131982384497774 -0.38651017426598905 -0.17398741391092395 -1.0251155096108093 0.12103849092797191;-0.54967513432031978 -0.6111907368407018 -0.33739479229247804 1.2407234185168976 2.5320921617153096 2.2672537178582566;-0.10356338950494899 0.50524722554667401 -7.133727225455984 -0.73717882627512843 -0.95466843156937031 -0.13290106354111889];

% Layer 2
b2 = [-0.46846321324668677;-1.8746738890399854;-0.18118298104067135;0.37214300806161615;-3.3889536109084899;-1.2855007325290972;1.4098852438477651;3.3843102804282608;0.86149734495499486;-1.8364877337145558;0.7584976146356277;0.21855159035529789;-4.7547179220838496;-2.6573582695889115;-1.5905939581302229];
LW2_1 = [-1.2254108144253457 1.7058185363468523 -1.5601571356824573 0.77036028544846491 0.27203529858750097 1.7491102711474544 1.1979472785400314 -1.3683406474008522 -2.1655688871180763 2.3884461991363528 -0.66001293718560816 2.5148109038692259 3.1650783755999026 1.3170748880782595 0.49040971248154336;-2.2685791751786271 -3.1150004414558317 -1.5610231348442767 -0.75108731718437716 1.7748442293314144 -2.4145722418082292 -6.0873157151408028 2.9934592781515219 2.8181615138208982 -3.9225856085586197 -1.5666520283912713 0.60832796424671076 1.3016980477095643 -1.075029714482501 -1.6476500597220689;-2.7322507531122016 1.3367425143114424 -5.5970352661505602 -1.0545322741135996 3.5594850353294749 4.4434216557912434 1.898475258426952 2.3464911889338169 -2.6693060448706674 -1.3241131893885423 1.6463242087842656 3.0197911860025926 -1.4768945386115673 -1.4775970046276448 -1.075525477447923;1.1868965971712437 0.10883881220504787 -0.44875966464128525 -0.51725041201623023 1.0933560033916552 -1.9953150277638354 2.0968649000949831 -3.1836590182324449 2.1111453946841636 -0.37410430678709605 3.9727031687230583 2.4305262831303693 -1.3083422184241251 -0.059007309119180007 1.4053670689434994;0.28231900837572954 -0.47363089217759063 -0.29747725278235781 0.10770131836306125 0.048265044366928495 2.1682713856405558 -1.4904324954846269 0.31194964515769857 -0.31857730733198542 -4.3305699129224982 -0.50442202370079126 -1.376263521738879 -1.1270241537899341 -0.36847495572619976 -1.0895602003711291;-1.3109272599456228 -0.6736304602505051 -1.6710617506164382 0.56674249251081288 0.70255951329349442 0.08806066140173005 0.99022046381797668 -0.40495394947185975 -3.1622758514095053 0.4095216458900362 0.47126843134562879 -2.0785353780514502 0.32726155624079745 0.95514084019481249 -1.8125481861029171;-2.2869235394989609 0.25460541315898322 -0.36158346978411743 -0.095844743650674261 -0.0097366027324843098 -2.4117571090047676 -1.0545849896447026 -2.7671995152135906 -0.16362019115150062 0.19879097992243966 1.3040882810495629 -1.6567602506874328 -2.1193028332956909 2.2304686258010578 2.1645188344553534;-0.30723079010204807 -1.1371355811888775 0.55146171996882354 -0.8117075011416669 1.1274451975527664 -3.9453730294376874 -0.072983886196819794 1.3408040504641165 1.9722167079542894 2.6101043331761828 4.0879922103508095 -2.2802007633297303 -1.5827616560106763 0.61543496939835451 0.81310899321850694;-1.3984890539820301 -0.012484797554220387 0.76618281065330496 -0.55469392409423868 0.10273757723537184 0.60379770669976163 -0.73222024808479247 0.18951708676078105 0.40001887684513104 -2.7197741798367274 -0.92467582630556833 -0.2513524611754015 -0.86254349371024763 -1.0534666181410679 1.2041544543537517;-3.7692712876136363 -1.3404079235690793 -0.91160859079901047 -0.74650292992585177 1.805463596432916 -3.3406746873815369 -3.1328270973363672 -1.1499192415393338 1.5675100342360928 -0.016798638323212267 1.7204659935606079 -1.8826991869805063 -0.57477923192997005 -1.8288398611625216 -2.5367517070748393;-0.94852769240099166 -1.2216537103176639 0.45854286961994895 -0.55378511413652776 0.5607717187225939 -0.68062176489086412 -0.49575502591103981 0.17886267655881866 0.80393056609835067 -0.26066190438680775 1.5549655357404482 0.47846190461793664 0.31544926985057592 0.56775249790505511 -0.55236070370917745;-0.73697869222500412 -1.3306908235412787 -0.44298058246487299 -2.9479023064111431 1.084035993019568 0.35646066510430452 -1.8941181296067902 -0.83943186358987387 -0.56451491706802082 1.5149533566966766 1.1166635601871724 2.7287961281499995 -1.0877236079249577 0.86589677202411719 -1.7079560142215366;1.9952036869397349 -4.3963206537872566 3.0019734968174552 -0.30893743211429903 -2.5374544660537199 -0.81359466929247493 -4.1016328450117232 0.68082818159734382 -2.5076817962080367 -3.9399496374970937 -1.7989791398102761 -0.97935599719254796 -2.3818465305105931 -0.26530751383547591 -0.6359541776393427;0.18254591973705006 -1.3944630965664622 -0.47445677148625104 -2.1209581778711968 0.062320582598185806 0.60010737751652132 2.2744863107998379 -3.2597213212647875 2.3426444872202672 2.5909636256584259 2.4887462816055175 0.54788144253323057 -3.0402212118312217 1.5521550174614271 0.400249331826662;0.37519441052872154 -0.80433201571324919 0.11500400960727891 -0.25629309435106706 0.33705542012332501 -1.979791289391188 -0.39600832657442336 0.023853878578328977 0.8943628418918208 0.68913146003415715 1.9338803228699748 0.44825349584437602 0.087638201345442354 2.5894504345448008 0.56094987420026776];

% Layer 3
b3 = -1.0418229680441808;
LW3_2 = [0.11495645148437141 0.21485479758545345 0.17286605460744703 0.10391259485019934 0.13112149949059995 -0.12536036541975162 0.28658293972650389 0.16098606731555484 -0.27655256761045749 -0.18649867817351065 0.56682085220684764 0.1323841006368259 0.10305811390153433 0.18202747459083876 -0.96588771396022599];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00968992248062015;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
