function [Y,Xf,Af] = O3santafe10(X,~,~)
%O3SANTAFE10 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:49.
% 
% [Y] = O3santafe10(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.172786177105832;4.16666666666667;10.752688172043];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [0.21585462001857958;-2.3338343142146445;-4.7752454549657939;-1.3558031145848704;1.5433778300654444;-2.4166284365450457;1.6498502687717698;0.66642719680313278;23.657463896697024;4.3684798989331215;-1.6633005372475977;15.06894021430959];
  IW1_1 = [0.98899327849306373 2.0382036448518721 0.20892849086712409 -0.19995841127595129 0.49121389206760735;-1.333295770164677 2.9301802635071255 0.15557237947491825 0.21174228893255884 0.22211296655264195;-0.12480377144113039 -3.5991937335490327 2.0848597728183127 -4.0835646884720109 1.575995796770385;-0.67661201248408043 -0.77643143480593957 -0.19399431078347454 0.28695991756586403 -0.46026192148328277;0.65297603941544269 -0.04161600670066154 -0.13036727885697166 0.051809564361696037 -0.27309705631827014;-1.3446778242800317 -1.276829242942116 -0.81986615833535925 0.81814929640534972 -1.3065273666217727;3.2659014585454855 1.6204448442996857 -0.1623410255213257 0.4908161909846292 -0.31234074216676522;3.0155001042424909 -1.686898970786503 -1.3648643526478283 0.88165294226102608 -0.049214811125220533;0.65063775911593746 -0.69566928117016569 -0.029217056513272048 -0.13017528756860583 22.380074883950297;0.40830928498738234 4.7752037267173675 -0.2131150262645842 -0.2735483589648518 0.27435930936207825;4.7047080684720521 -5.0619237869101754 4.1413776770700208 -2.7448543168318182 -1.6484164099435885;0.85105346246616365 3.1764843549985691 0.95053739885912281 10.036312701596444 1.4540172910680345];
  
  % Layer 2
  b2 = [-1.3616698133876801;-2.5072991342086333;-0.048779478822233061;-3.700315842371428;2.9259355283994344;1.4398127816233759;-1.5920863629266582;3.0240717626642302;4.4299043802688098;-1.5726895196032937;-0.29962573101372209;7.3862916027692807];
  LW2_1 = [-0.18112725182853062 0.49568119546525818 -1.5805631916241429 -0.19268571859935829 2.375816914055966 0.58482877900859864 0.24897952470308693 0.32623125309216827 2.2327811322348743 -3.2706492698517184 0.029234120754371078 -0.061632214332094211;-0.051099392610588115 -0.50914081053270521 1.5648287619738825 -1.4075237200997999 -1.1614363423216891 -0.39446995472804913 -0.39403892432371473 0.22235439669468643 0.45996357939257565 3.3088930434247086 -0.048682460064407559 -1.6768237043148275;1.1419358135346644 0.86366566893127628 0.38997901793632561 3.0524922215829049 1.6629203679752733 -0.88957017821330442 2.1919697996594061 -0.98535391988565491 -4.362156490760805 4.0170660746536626 -1.813759045676395 3.4180417413553017;0.69099357528862515 -0.82812921279624463 1.1376249287441287 2.6940311257611849 1.537656987640158 -1.8221085514615749 -0.7885914361757983 -0.67005019076067962 -2.7144774555805018 3.7585335634065427 -1.0135327981413575 0.13645382772149936;-1.0759412787403941 -1.3545371676373092 -0.51250601367121407 -3.5476508037697969 1.1602116918861114 1.1279778163164547 -0.98858754492628742 0.13323899227679259 1.0652345717875888 -1.7262362699589304 -0.59520221906932858 -5.7072821522642103;-2.7456911327131257 0.80289947518748339 0.63582547418378932 -3.634605175089463 0.83589116195530799 1.2973032671612357 0.42808804487623642 -1.3702847128593543 -1.9974030021456246 -2.996570480229396 0.15707994856040033 0.74220721631091713;-0.07378252321643701 -2.4764401694848144 -1.7473185683068948 2.003563688431004 -2.9704393533538602 -0.83392024564414657 -1.313123280502243 -0.95988626797751297 1.6764241633654511 1.4521389535786888 -0.41543047912834052 -0.69027679096145644;1.4052701501671596 -0.30278650431764653 -2.9756040257896674 -1.9678680063696217 1.0454630589163567 0.84241276903678763 0.76755549565520931 1.2288839648133942 2.9264332126020562 -3.9268487122064086 2.5416110365517071 -3.1548807422705196;0.69072892347939929 -0.68739887357718454 0.6782542803076379 4.2015820907492261 3.132881204354335 -2.246883587630732 -0.6642388769515124 -0.39035779333985776 -1.9926208229005975 -3.9239653553245359 0.59142048246673262 0.39969589056414795;2.5477592265621998 -2.0729323888231193 0.50689754063161518 0.86322834856659569 -0.96590259860842365 0.69585449958130674 -1.5832273561324575 -1.4249726348403156 1.1825390594724228 -1.2375289874568434 -0.020197880180045862 0.20957568531471746;2.9354183900272592 -1.0210028250216887 -0.83505752096287134 3.3590878441761061 -1.7370869404327658 -1.3205728641619141 -0.66363186660972584 1.4409590647934072 1.6136749322864465 2.6857314816891211 -0.096855462920038035 -0.78498414502729497;0.49881912541781992 -0.84801205218672082 0.50506514525890844 3.1205535687423942 -0.34179500535005169 -1.9153359564646162 -0.48549448535670975 -0.43729478469462524 -3.0475193303767654 -3.6511251092258372 0.46636688204577775 0.63380618620161766];
  
  % Layer 3
  b3 = 3.0738715224956392;
  LW3_2 = [4.3352817122689391 4.2810325240633604 -0.36528947842483378 3.3691641564068036 -0.71803339329057914 -2.9787135673536147 0.4933021786619135 -0.34994701070218115 -3.5414034497170079 -0.47698933076081351 -2.7485651390491719 3.7477735602433992];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 10.752688172043;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
