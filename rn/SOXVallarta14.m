function [Y,Xf,Af] = SOXVallarta14(X,~,~)
%SOXVALLARTA14 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:30:06.
% 
% [Y] = SOXVallarta14(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.412371134020619;10.4712041884817;0.00782778864970646;0.0208333333333333;24.390243902439;0.02710027100271;0.00630517023959647;90.9090909090909];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.3558274724567916;0.82332457338217879;3.0528089396416029;2.2646395217167212;-0.65575260206669683;-0.23016698870764593;-1.2131653850301223;-1.0864647261911793;-0.45232362805287901;-2.7622399881556965;-3.5540485417632395;4.0334480184901862;2.1702397447737263];
IW1_1 = [-2.3554257605423987 -0.24508522480220118 2.4967291883851308 -0.1817405871474326 0.51092018216792545 0.56188078386448248 -1.5176249473954835 0.73562596527140489 -0.17341095395583611 -0.21931391280007029;-2.7049508818696673 3.2873491138320499 -0.64887784263511894 -1.2474663256517498 -1.0593788893941845 0.5329430976215791 0.67447865124415141 -0.83954002949660922 -0.29580553470316173 -1.9269215622064244;-3.123360886013915 0.1041088578753204 5.4648608866470818 -0.71249682668202907 0.67685768483880882 0.46143023687962847 -0.67723322489002902 -0.14030498147945866 0.04831896067295062 -0.65070081884979658;-2.4568018818949322 -0.28945022702675793 -5.2793321380966898 1.2107304310498543 -0.19755955167206851 3.6344697245968391 3.0716045852725795 1.8772432525476181 -1.0773898585039849 -2.148133280000696;-5.6857192281373559 0.0035863701158255898 2.1415539050154853 -1.820826249301396 -1.1827568632290293 -0.3547544607153279 -0.64271444378664544 3.8359479998168173 0.43448851516192571 -0.45877201810761947;0.77641330204286207 0.23696719190208362 0.31039858869261472 1.5175524789731427 -1.7826391921570992 1.5241225822728373 0.16474354137925232 3.4782890163230631 -0.054515094537766179 -0.18701742321049017;2.8917133250415437 -0.2023535277453308 1.8003161184635592 0.72190336399602262 0.3517060821756785 -0.24641759657766366 -1.4965992947863458 -0.58028091014333905 0.26886723885246883 0.64209605383102819;1.5773811065860293 -3.2642991988430756 -0.94781474109432284 1.6590390988656429 1.1619758167042904 -0.37381055913674788 0.99497142191598364 -0.27641444090993139 -0.12815008398281302 1.3241866766327788;5.7299000155546382 0.069660717709335171 3.1350715894005998 2.5839643119568976 -2.3119696866557549 0.80428754256844237 0.14822589973549571 -3.9705098120508127 -0.65905655168257682 -0.59151336941196742;-1.2167284204589948 0.011381200319118275 -6.1447160494699942 -0.017498440127321796 -1.2736898389751881 0.63017132170256307 2.4699819147992192 2.5880113222316825 0.08619237366598384 1.2350199610044157;-1.955801882418496 0.056873483518602691 0.079934319484346233 -0.35143691277396932 0.037404614056804675 0.52363034927154362 -2.9949512727275165 0.4897283034067928 -0.0022555798833022644 -0.052125731413789879;-0.95459265985332586 -0.12190639911184094 0.0012595618291286054 0.67039676397490333 0.18940880109808228 0.74197388362622352 -1.3561708279500675 1.3791103135629377 0.17756802042719 1.8986798402610259;2.3304801843093745 -0.11725340035646434 -9.181631543498554 0.71400055305530796 6.0896411102577286 -0.50356279461793474 -1.6540808035193291 -2.5515694845121359 -1.2882728870513596 6.197230997864092];

% Layer 2
b2 = [0.43724165794684045;0.51462613305074456;-0.50798804533323383;0.31590646020312718;-0.71531653857346222;0.14206758910749417;-2.1925732052447158;-0.68091330117635396;0.63355488814865779;-1.2664377402378033;-0.5513246110791159;3.6309155412669649;2.6498715088973888];
LW2_1 = [-0.5567075942047599 0.11689978723595515 -0.73997449287016959 0.53127095858010709 0.07600683493045228 0.80753862383322683 -1.625491881588808 0.64807024353184028 0.028611914600295205 -0.70393295037431036 0.13275431449370756 -2.1540852632503116 -1.4109364740856047;0.35696082698521747 -0.19298543445646224 0.37119464069334895 -1.5066319248527977 0.42105852103123764 -0.7791718198994646 1.2976654630009679 -0.6242156766271858 -0.70318224729259871 0.18379033352012594 -1.6505512585468745 1.9691271608191809 0.6608275316960075;0.12277117920760472 -1.4329712407591528 0.19607277412523907 -0.66535087668091086 -0.46265809405059521 0.48586092086293231 -0.24466480914421126 -1.6875431589350114 0.58190982507263589 -0.20550414924569743 0.28984191631231337 0.16353813256394126 0.10391330604873057;0.39673425945632784 -0.87239436233530798 -0.82498740716944785 -0.17445469496145397 0.53336819351791231 -1.1595189948750466 -0.75108362374628168 -0.69418875939976266 -1.4746183951869927 -0.7298384580106787 0.56799905171762832 -0.64759338614639894 1.0746358398506537;0.23283990163916929 -1.9400028123407378 1.5215725871986272 -0.28930339906136071 1.8823406422919284 1.3010065354621825 -4.6624565571007279 -1.2261853047043678 0.98648957409927096 1.6884317001429436 -0.83750198374000451 0.66495095438797314 2.3545147418386438;0.27731574594262504 -1.408760794480012 1.4134353864695164 0.052081627263234773 2.1521693577119918 1.2585727755110152 -4.3369483908290105 -0.65086480494999366 0.8676243662142693 1.854529308357342 -0.94241440153704503 0.19250721899551937 2.130348625544205;-1.1779265489771544 -0.21340371484220538 -0.47942486077596425 0.68858142080058415 -3.6613738290186104 1.5385786336064267 -1.6295100182721587 1.6343801052059701 1.6425852444641837 -0.13882998126269522 6.8101163638194517 0.36790228083608256 -1.1599889171475584;-1.0036315532211801 -0.44869934149404023 -1.326596757887669 0.44976190694496088 0.16809732829395335 -0.48999471440557157 -1.2657731440483078 -0.36273189890823626 0.32018303434509771 -0.35315533984132053 2.0312300897372837 -1.8220942480666165 -0.34859437169734347;0.36603636481192281 -0.35388999437494917 -0.76274020373792217 -0.20778902499953683 -0.017835598200979165 -0.94907402141103325 -0.72684548585495357 -0.10387667267381925 -0.93015640984552372 -0.43671985763802873 1.5100425058127789 -0.14055475019099203 0.64243067903586049;-0.88160774910351114 -1.0162484311899409 -1.1309290340889979 0.45887777554914905 0.075445613447298152 -0.024442033698604634 -1.8784689294437751 -0.91470332598962312 0.026251081878241551 -1.0493280482923253 0.41917538246593611 -1.7744443387605597 -1.4673090368763726;-0.33207339275715136 -0.00011517080510590333 0.23713897917069354 -0.36139907416438172 -0.086618868957400869 -0.18442695985740915 -0.3695414692148255 0.18962487971521114 0.45300536573287054 0.013585302582540253 0.39283473882268571 -1.1766008714215488 0.10613562052004941;0.21593766575995912 -0.965967433561848 1.172054752022105 -0.63605868339232852 1.0099400867034736 0.63730764486875957 0.60718151422558897 -1.0612956715877959 1.9929417191160548 1.0040952968482579 -0.56566862873767376 1.264196602585772 1.9224103522517275;-0.079390988652761896 0.36396631993508566 0.64794643865315449 -0.61823370827165169 0.32826905466869583 -0.60066521492750546 1.008265877278034 -0.13471032668932481 2.2282424329376345 0.47351954313625183 -0.1554063633588661 1.5991282213345623 1.2864193548422667];

% Layer 3
b3 = 1.140412052759187;
LW3_2 = [1.3253392259626735 1.4336023594673954 0.13752200212892327 -0.5178151445363457 1.9408775355814871 -1.9830895526347849 3.6864233820562622 1.4239852000032456 0.63489356618016535 -1.3540436432981022 -1.9484795011573459 -2.6495250401029242 2.2953836552792257];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
