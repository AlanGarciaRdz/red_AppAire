function [Y,Xf,Af] = NOXSantaFe8(X,~,~)
%NOXSANTAFE8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:50.
% 
% [Y] = NOXSantaFe8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.686509270033731;-0.56103727664269587;-3.3101435308922156;1.6422953016417479;-0.27475340068680992;0.84906552232469068;-1.1658637193415116;0.48317204477063774;-2.7237856381779832;2.6813647295486516];
IW1_1 = [0.58288980134453783 -2.6455029456674191 -1.1259628393058483 1.1259469936641664 0.40694921994988498 -0.14574311201668155 -0.066273507918941696 -0.11501695764016009 -0.097023358058267492 1.2348819819176724 -0.074753066293561238 0.40915267204852213;0.41275524678391712 -1.3630979007288837 0.911874221780691 1.1602313007831555 -0.0045643092318864119 -1.1877665172470755 0.063613737255298924 0.76194895665546103 -0.77245530632173021 -1.840983169194669 1.5143172349484795 -1.3250483711901497;2.519139565532269 1.1470986981650422 -1.0934489936368168 1.1711253940102619 0.29032615009529722 -0.68851454259161193 0.013897203514432428 -1.322062408929608 0.11581906685023993 -0.50602219507536228 1.1673349976321192 -0.32001508885626179;0.44511880363154371 -1.558884331786081 -0.43450743407194864 0.16457151001403453 -0.27314428343889269 -0.044582521669422455 0.022174900247804056 -0.12031846203947862 0.53576012149853425 -0.40549026971557806 -0.16691645592532176 0.07480656590787671;1.811090127506036 0.75423854689307412 0.4933384832046111 1.1026092570498325 0.1514134951269499 -0.43502310790360782 -0.065429214360410576 -0.3326031716211707 -0.11804493550975546 -2.6031982774491413 0.50186884303657786 -0.72001177094206881;-1.7872390368972835 0.50990397649857822 -0.83332568674459717 -0.22436821114096728 -0.20774313451177767 0.58625191653172015 -0.031117961400401625 0.21172822005225672 0.14906133838492822 0.10588213104347975 -0.98567287657641733 0.56937821781588016;-1.7336993237461684 1.8351874819751703 -0.97986872764334465 -1.0746593501387054 0.022158454314548607 0.79458474915089539 0.0092980369659562967 -0.3154297695986974 0.34133752375860826 -0.13878832566753518 -0.52559281155277937 0.63488569723364485;0.13120303711408932 -2.8714750904386395 0.93230101959446954 -0.81368887802824041 -0.14849722171850399 -0.080831658544397625 0.22155291522325685 -0.045267679362871668 -0.0069421285252467069 0.90106798880375816 0.22137400138225552 -0.37786659481389789;0.74575091380924541 -1.471953232241423 -1.4252167592629834 2.0139145670087624 0.86830411442057931 -1.270228131391135 0.30900506009836015 -0.18953312425652502 -1.2988849539496157 -3.9269949354644891 2.8748782308682892 -1.7959108476811132;1.5499801212478628 0.87344128488556561 0.29715120418146346 0.93170828358999691 0.12555630937755816 -0.372923387562276 -0.068315302547354934 0.16770021065391258 -0.094297439606052441 0.15461581287146758 0.41801876584651387 -0.56419357622390853];

% Layer 2
b2 = [-1.3844344178236081;1.3504490662452422;-2.6825128747414357;-3.5794497564759955;-2.855396851453301;-2.8754878783984221;-0.34959395866998666;0.41432831421116884;0.97761269419508057;2.8387744101849064];
LW2_1 = [-3.6871531248804952 -3.4925516241433243 -1.3836649468748707 -2.1076623262541045 3.6711196684291791 -0.56049508672695869 -0.33004022707012542 6.3334835171025992 1.7628633712406965 4.2813472833720692;-0.88311602269772183 -3.2072129188067495 -2.4717473947174877 -2.1897738907710194 3.7085962534706076 -0.57003946678892237 -1.296540614179688 5.9453412370965628 1.2689871019615033 3.5457416729021922;-0.56222052770269992 -1.489381989504492 -1.1466619626531727 0.92480194756439227 0.56811101529207786 -1.0545638772538053 -1.1941870010918556 -1.435484507555397 0.72699227897482521 -1.9215921935082791;2.8010938999258284 -1.0230098458943779 -0.43898929203189957 -3.2856452997849903 -0.092044707170129803 -0.45292082828789082 -2.8978292178066369 7.2383799663054917 1.9546470072825795 -3.160158881676308;0.24102259672582424 0.74799139521205538 -1.7747137603183611 6.7554054859496011 -1.4500730612639814 -4.0092065445018426 1.4079383073762555 -0.95601276900889176 0.42102849225524186 2.9874827748205632;0.10362136156724505 0.92300452902588026 1.9382517002877881 6.1506081048128918 -1.290283193809959 -0.18808652239243834 2.8842943233624934 0.94686012683473042 -0.009774598431963627 3.4554839367667571;-1.6061943320233316 1.7879295817314316 1.5610230382274135 -0.87112961393906285 -1.781007617480985 1.956778040726626 1.1405509137820204 2.1990177865966261 -0.84592525157468468 3.9733631769835793;-0.91065971677047608 0.7391792084390415 1.1837097190228452 -2.2046518353688271 -7.4063299930502016 3.1536132573955764 1.0244385807614989 0.60326744965424572 -0.4126430526346444 9.0428269343539043;-0.81071188435355046 0.88649341148418181 1.3702458313236339 -3.2173501621986307 -8.0144221797337867 3.2996631066854256 0.62491715244163115 0.66095305630532752 -0.49134342955653659 9.8271364555232399;1.7472815178423846 -0.43877916093429009 -0.66504156125778258 -2.73527919607 -1.9725294571045706 3.0909679844900015 5.2225298499853103 0.76657402066063862 0.05655612529430281 7.4876266021887119];

% Layer 3
b3 = 1.4075692003965061;
LW3_2 = [1.1389017390463967 -1.1844525338328487 2.931785062229173 0.57101576593486192 -1.0131679099700681 1.0616685755614295 1.144076620135658 -3.1279916098861609 2.8519615288374824 0.28669955369126177];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
