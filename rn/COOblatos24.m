function [Y,Xf,Af] = COOblatos24(X,~,~)
%COOBLATOS24 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:57.
% 
% [Y] = COOblatos24(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;13.1578947368421;0.00618238021638331;0.0205761316872428;117.647058823529;0.0560224089635854;0.00600600600600601;0.158730158730159];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.5869044306877786;-3.4218941051894545;-0.5203634884066124;0.75173281604694597;-0.096908287991257391;0.55186740129352974;-0.29457184402944986;-1.662751678855652;-3.3350287992801566;0.096740277430056504;-1.6685701740686818;1.3493281487833528;-1.6043575739716134;-2.409274254856558;-1.4851501863801164];
IW1_1 = [-1.973724882270536 1.7923517677920309 -0.2853797442641019 -1.0509201690236101 -1.5192887772459696 -1.0171294350929689 0.68242823588824253 0.02852944734788242 -0.75539207273319287 0.65968587127155742;-2.9800236865889138 0.017579727100198624 -1.1939739756471539 -0.51261579000930868 0.38175423451601037 2.1990268910303561 -0.41630447870641646 1.7738265701731966 -0.55530485887245062 0.22517744438889359;0.33830946948009388 -0.32693031642747322 -0.35403897051769911 -0.056721515305529172 -1.1125816610982024 0.19666134360710744 -0.1123119090985886 0.87873250523732405 -0.03071321189608521 -0.19295558538458146;-0.8925728348820553 -0.7448736498386066 -0.70319305952107958 -0.14434205028908925 0.10766822841248151 -0.23292571247538466 0.66430387684394787 -0.77305284845014444 -0.58479117707284323 0.065473962705766289;-1.0602394042074954 -0.93184143810581721 0.43999807082757864 0.32189478801164639 0.21020611303879877 0.72690841631787362 0.47483107474056879 -0.7135358370567958 0.021277358306106664 0.023705624576737094;-1.142876062362896 3.3150767409513033 0.19511701867751177 -0.83575318297511769 1.372057664888708 0.2375119695437807 0.06088308518949774 -0.44605138029228225 0.23660383723583572 -0.05832811579920906;0.13458268768898293 -0.45987037170382261 0.37990298840626152 0.10815213334123756 -0.78656201734316922 0.07138844444508391 0.05861387170154745 0.55041943685267847 -0.3921140281779617 0.076817745478688831;0.74789929086331364 -1.4235741376354842 -0.55508973665433858 -0.82297109130743495 1.2995482493175927 0.84716673113246621 -1.1431635695637541 -0.022632950607855935 0.4716506087667886 -0.42281894175467405;-1.6726103918196928 -0.97000466131518226 -2.9879178449034272 -0.55310186676485662 -0.86292576271815791 -0.75006212632401748 0.066620818599924747 0.28361554244182746 1.7529352684094295 -0.10942232094705538;-0.01836296829805174 3.1086900927625325 -0.052358297717173645 -0.41318099161968425 0.3314885014310705 0.16978196171697729 -0.27154951545673572 -0.60122089590826544 0.10682606538363672 0.21186561036855947;-0.45214659737621166 0.555468684115346 0.31555679485526161 -0.088356950125815875 0.85041442938466794 0.373174248609283 -1.0333992544593771 1.2740228899211359 -0.1802662123124083 0.16867177854356663;0.012538313740419122 0.93532472217614204 -0.58662032694981692 0.011117465467583984 -0.45585094514768115 -0.65262667822433718 1.4287145506814602 -0.968833689888977 -0.70519275513575563 0.7391848459514655;-0.60765311717658921 -0.62600654268614142 -0.46041633388118808 0.15874880762521773 -0.69028398479250852 -0.20309461491593972 -1.1777643251186176 -1.1637601350685611 -0.18651196392311617 0.15779372953803431;-0.23660342068542428 -1.6565142402533646 1.0838272337835957 -0.24117940191519238 -1.1247891604984481 -1.4415839348599992 -0.98214858540394523 -0.53519264851212422 -0.63238877265418181 0.53688037802101207;0.19295043942122686 -1.1244981782034864 -1.9166959034730564 0.97032596823717598 -0.74131119420886771 -0.6783532324621101 -0.88927486814714363 -0.79609994596024924 -1.0140130369277316 0.071418859912396063];

% Layer 2
b2 = [-2.6773822580758284;2.7516602004739537;-0.17756838479640391;0.73837719433821647;0.28100847420667513;-0.44577368018901287;0.7862391303791797;-2.2000276354702044;-0.96262894631141194;1.0674543538647807;1.2872273823016076;-0.29826026839288616;-1.6975448646041431;-2.168593502861317;-3.1610156366836555];
LW2_1 = [-0.066257656665144743 0.34744995375209509 -1.212845905599657 0.93231154042944087 0.28448094519834893 -0.79458399833359949 -0.73337423777071775 -0.80516394519350309 -0.38970362926287683 0.99597310777500081 -0.54656581779056213 -1.4293551965694544 1.4630912198997104 0.28455236686126861 -0.62120085925688251;0.32437304774735132 0.54879530681928856 -0.00067659113656756698 -1.388992778583134 0.34980944815525095 0.45440283817961563 1.5248288770998828 0.52351898490525872 0.31484178061989554 0.42748703340133287 -1.5196351990024195 0.59328996254290189 0.68980461602522902 -0.23594770752035216 -1.1427942733046104;1.1228022216391309 0.11148240687903209 0.61750767721883337 -0.38063242299565114 -1.5401182775070112 1.1451906514054486 -1.6112723421365134 2.953146208323739 -0.11686639603025871 -1.8826934711107481 0.16112046141053221 0.44911014350145523 1.3645093395091876 1.8003154001471577 -1.6783017570900074;-0.31307673610466502 -0.52797652387150773 1.4589507046298853 -0.91270041769024313 0.30953308743105634 0.73399341994346523 0.12524676051434658 -0.94393822731039667 -0.16667305018237444 1.2290238349173452 0.88153267791708423 -0.51916251158536364 -0.45738093190388629 -0.43997140573094179 1.223539528428242;0.73470434808297747 -0.34623893656520854 0.73097690860891995 -0.2539310705862296 0.14991629261771136 0.45191829065678257 -0.12728289025882245 -0.87184421343062912 -0.23715066772412205 2.1591958153748885 -0.59526613796536598 -0.99200753910749229 -0.8200629274377319 0.20266608565456828 0.75005120288365679;0.49027404895637883 -0.28839443595743303 0.080695119951655625 0.069931062729896826 0.62780226044727117 0.062035195494907408 -0.39499133777638762 -0.4218038597160565 -0.63493577164497705 0.92101290779207234 0.74874414016282576 0.28926096202020801 -0.52632339819551999 -0.082803015665089894 -0.62075034195893553;-0.16566075953972068 0.96565773212629946 -1.5202004382535548 0.64077628711163237 -1.7809370372902373 -0.045528335614287797 0.5550483910605738 0.7264452936700373 0.71114540307032326 -0.90595265867560393 0.27187567799388557 0.24947456474071272 -0.94984433416158942 -0.554794217893122 0.098320276660338962;-1.5641706583762054 0.79404142129710809 2.0407985222545637 0.57395686453476435 1.5442056462768832 1.9807739596294009 -3.1587645267258644 -0.35880521446442404 -0.50172952429021089 -1.9066747496355665 -1.0677102341132114 0.73603193619982954 -1.0250793978851998 1.4388348974366729 1.7334717154267065;0.44537048634889431 0.21215592342541301 2.2229121820799516 0.28801289709555078 0.022692757051008768 -0.2873421036555921 -1.0461722799375013 -0.14675926295185665 -0.20589754489061202 -0.62324038052598163 1.3967644568380106 -0.21523443117018157 -0.43148848266930073 -0.0018612499880360338 -0.23610576590744903;-0.31987213938168735 0.36606728993725529 -1.1113331849135353 -0.53306708618264387 0.55119203587637711 0.19346188245212489 -0.90407809329267019 0.25915543996214407 0.12673162815641081 -0.36925406950528611 0.19416633333369188 0.80099949103248291 -0.6990510158120683 0.75821512381975531 0.61867630318222255;-0.029077894461073728 -0.38235664824678056 -0.64236843781487674 0.11903436393143955 1.2324446819706922 0.028815823283316416 2.3852013863324317 1.0582190961823097 0.79186078286534656 1.1848691131747282 -0.054101272084561614 1.0425175128112254 0.14784831981462959 0.33567631162786049 -0.18606246179915631;-1.6853364728477473 0.85349073602475545 -0.98634756528643219 1.0639301406700488 0.5630174902163898 0.074876148867549036 -0.45409536168923975 -1.763411035291365 0.45629522975060532 1.0953208145774234 -1.5419428926777621 -0.50224746464988068 0.058792306949913185 0.10445559834388653 0.21062826522758549;-0.69459469171096588 0.21457650143236495 -0.48564083830169252 0.32956663713323653 0.53177550720362887 -1.8120091349403142 -0.10110824803485724 0.7893539124023975 0.12683141541190576 -0.62413352148312806 -0.90226495394202511 0.81797277743327457 -0.097878697508124085 0.14569935852336272 -0.34725125962921272;-1.0602298472988803 0.48341861796608881 -1.3872868768689153 0.90168006425677005 -0.76635150977885391 -0.50015231397612492 -0.41022749961803306 -1.2898331733588726 1.1018047442192667 1.0043943855762572 0.98134375664678009 0.38867793840742082 -0.19021826778412615 0.98270001500831006 0.72965635083244917;0.7862899877875813 0.37984617590849196 0.043661817103832851 -0.53983515397574366 -0.33676215018841338 2.1940089404000411 -0.011301439018213812 0.53615003372646575 -0.034054348898838217 -0.95748573956380156 0.49548937176231916 0.18433553506912739 -0.50394554950527304 0.041169983597937373 -0.040682053959347195];

% Layer 3
b3 = 0.73796073847134824;
LW3_2 = [1.4535123717231841 1.9039532818218767 -0.12529987550792851 -0.65603706960436525 0.98720457216787194 0.073323708742146235 0.39968817283613123 0.89234173623362334 -0.88925297558340144 -0.86106285352906953 -0.37184683542761754 -0.44753160035544626 0.62477955045899491 0.62034696051955218 1.5406199364422697];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
