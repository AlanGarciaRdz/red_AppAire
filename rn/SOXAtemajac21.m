function [Y,Xf,Af] = SOXAtemajac21(X,~,~)
%SOXATEMAJAC21 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:25.
% 
% [Y] = SOXAtemajac21(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;16;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.097873476882855234;-1.868805049152696;-3.9832367828042079;-0.089198482401685097;-0.98588089005187052;1.0142127539100241;0.51957571404136993;0.82461957543353159;1.8127571120340782;0.29269024920397824;-1.6406121024736782;-1.2110253093318399;1.0504150674193273];
IW1_1 = [-1.8545269017174231 0.32796946148234146 0.12044143640716569 0.049072778714916207 -0.65993075940468193 -0.38137977781455429 1.0457285339082856 -0.73938221473750487 2.108229076127794 0.17871208929390578 0.79589287102648643 -0.74660040275208539;0.067923817121158733 -1.2736733208796309 0.18705920836401949 -0.4901473782956835 0.0028179344306610982 -0.37565947343338341 0.34214482228038229 -1.5384728152122438 -0.40682714027331113 0.17760938877126314 0.77266281844538931 0.27616658238890079;0.49140014216084266 -0.09701258588812077 -0.97487191033155007 -3.6917918996010703 0.26715244158551726 0.078059527702206227 1.0596167923277122 1.6494291738230469 0.75559000305343849 -0.11676402058388435 0.39302946441720937 0.43512945177028201;-0.32406335434130124 -0.4004666959287802 0.01645790870925672 0.035848813731930135 0.34264325391540107 -0.004349803916364978 0.12088099264087745 0.35455886837821188 -0.10940391756260834 -0.027668405935352088 0.39859227226310684 0.19563525927449618;0.61158895326806961 -0.15359829651790141 0.087815813552042293 -1.3069137010423368 -0.51920947484662572 1.3838415055622946 -0.34346807670572294 0.52533929190418616 0.58812744695115104 -0.52715878782756942 -1.0944920216580767 1.0616528184461238;-0.44466389733919226 0.14694938124249604 0.18884513550375681 0.05302162659773732 -0.60907210975683856 -0.17362877115136136 0.021770914047844273 0.69387566527552214 0.3430926009526617 -0.31965355666054174 1.0555851864272199 0.49978384473131393;0.13125051320354811 -1.8713701982982385 0.066748713739045354 0.27877267910519754 -0.78266320140707979 0.35410970957978255 -0.21628431632108455 -0.065222874441754855 -0.56371016072951341 -0.1720379197675819 -0.48324773176562441 0.28483160948681241;1.1963654895236877 -1.3949025242088258 1.1846488033841291 -0.2913450835490432 -0.11309710926064684 0.063487655214039401 0.042460740325472465 -0.3825699092475095 -0.62012879018381983 -0.17379524575737509 0.59436167798239381 -0.4924852528906416;0.18066740807189172 0.049767300794227955 0.47117411237458756 -0.23599848858474912 0.37177097738933734 -0.1101826168952808 0.30272516544953537 0.26216031442924914 0.35143393915744431 0.21416287304391457 0.55041925888146093 0.40991164416080361;-0.10209170598695891 -1.4137092023936513 -0.057031729639686661 0.051298669467337424 -0.75381836990664364 -0.022401773976322228 0.38368806403293837 0.90505023088324688 -0.32050376136135778 0.28501942034725597 0.36785648384634617 0.43387050137468952;-1.3134172662829007 -0.3000101479438228 -0.6189253731881158 -0.26168288242989846 0.47465478564901342 -0.16874870303093628 0.17717372348605651 -0.36517201061363991 0.55567187901169346 0.2306641503302026 0.27948158159618003 0.35019181205575278;-0.69056644293633596 -0.61526033260410162 -0.019083579656650737 -0.11304174454082913 0.77884715686385997 -0.67905968923267135 1.1746067981748622 1.1453667635231817 1.0720100837887041 -0.78992670691335798 1.314599351576655 0.15510083466351876;0.2041541439500443 0.021291771586911548 1.3365218457097416 0.14008721933611548 0.3239531607370546 0.22175519682684897 -1.3000016546249027 -0.40768714212754076 -2.0871224837506031 -0.083684377093294016 -0.45981488086825217 -0.86197209412664899];

% Layer 2
b2 = [2.4272456117875678;-1.0462622388078231;2.285136307396856;1.8685188089424116;0.94303086575668449;-0.65907604256445684;0.31112152198906085;-0.83247999064336287;-1.4247202100147982;0.7535068743787795;1.6150376953965568;-1.4705718082707147;-2.52095385579557];
LW2_1 = [-0.09783797532142223 0.47410978100194578 -1.0979538589745934 0.75039689565051571 0.11678877358061347 -0.44146135053139068 -1.5043878391578336 0.75385796095234292 -1.8642704246319894 0.91545575652089761 -0.56509587683663576 -0.43534364110791146 -0.22174997545497888;0.19013674948395376 0.039855627557476708 -0.78385021371534624 -0.057898215829474395 0.87924539077980013 0.24593760701855336 0.87714069822043395 -0.98919099020045076 0.66663572499797474 -0.10268628192501036 -0.21876299305692845 0.29090019935687744 0.36234057594666519;-0.65869037248204432 -2.4092205986378463 0.051948336084370494 1.4715331676246748 0.67786350877845625 0.64201142460001459 0.67416366082402135 -0.3713047132683831 1.6248939623895347 1.6877484931792091 -0.056032057985498013 -0.9004202114270542 -0.52780339484461503;0.17989293519949784 -0.051424235170971673 -3.0372448046762153 -0.27056645501314697 0.97835619209545044 -0.36161554806237006 0.51087233842026536 -0.57784726486481097 0.13229299514604442 0.34208253318444293 0.7176634427014208 0.83255708593249778 1.6023645727205094;-0.80382664707643092 0.28243478660176763 -0.7670622435964406 1.5748194090655712 0.47463859032130506 0.84141385539057656 -0.36127007729665961 -0.61195405055874874 0.50541609812683519 -0.5133848986175652 1.2607904585022629 0.31411234841966568 1.147448197875333;0.46249641353457899 0.0080047273019739906 1.8160141748925869 0.5664066159870127 -1.02358758468666 0.94216977111091282 -0.086584297414368266 -0.55314191512125843 -1.4173369217849756 0.60773495282405177 1.0099062595605632 0.39817670624491175 0.78631303990067158;-0.23806471293461248 -0.12222380014755793 1.5723582636489033 -0.98194203741326025 -1.206533249607896 0.14743493490611395 -0.11551907071908779 0.69393277706831602 0.5448094636570554 -0.23579109261952833 0.044885354054771245 -0.64361244067823375 -1.1409085089825537;-1.4152149140007406 0.658510667222725 0.41874663360929698 0.32008832708344376 1.098558308365349 0.0089126695368649603 -2.1222654361031243 -1.5146761750489313 0.68946139277078089 0.95006927340514968 -0.25556204950987327 0.08668025708584523 1.0605002286787828;-1.4800406455569166 1.010133372379963 0.014824991783192548 0.13887566283998365 -1.2294474549249474 1.4513048119016871 -0.58089910877964979 -0.47940369702793229 -0.99298555165686186 0.17726904907758809 -1.090937964716763 0.37624763136553818 -0.11848477611066544;0.22733262338302332 0.61363763890639522 -0.54726511296517744 1.2591675017733983 0.17958443040276037 0.067831272233061152 -0.60596207792650103 -0.42955380722497977 0.68521665961176437 -0.31255681523089962 -0.90660675954150916 -1.3923869468597643 -0.53893568616472132;0.59769176062484619 0.36808699930280647 -0.49977219035834519 -0.10491298121686039 -0.065634224265048308 -0.86665517998094244 1.5736527547904093 0.26195363074356814 0.66180761427451518 -0.41860907939144326 -0.49463315427565785 -0.081407029436668665 -0.75487277406368825;0.10283277942292915 -0.080902019610821385 -0.51375724551036039 0.15907120142762221 -0.87980471524751258 -0.38303611128992543 -0.4199167533149426 0.88481776912811883 -0.27655964714261549 -0.21963585709230748 0.24091222610194277 -0.39140686428973781 -0.77367482933707055;-0.85425715414048775 -0.71724299263201396 -0.79854249239503372 0.60642703654240071 -0.09301693901100852 -0.21411299874096268 1.6848206701393973 0.14798746886076802 -0.077875321676040582 -0.22789370717694032 0.5307489208539462 -0.045854219969273823 -0.092214199989358495];

% Layer 3
b3 = 0.31705964511587575;
LW3_2 = [-2.5264101640170722 -1.1961554800234915 1.8573005764426627 2.0100732375586055 -0.3344228121585392 2.1803103765662164 -0.77599218435428363 0.42093001711959693 0.56384120866036092 2.2549038816653186 -0.73489502577386101 -0.38324457532839717 1.0720017854114041];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 166.666666666667;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
