function [Y,Xf,Af] = NOXOblatos1(X,~,~)
%NOXOBLATOS1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:30.
% 
% [Y] = NOXOblatos1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;-10;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;4.05679513184584;0.195790504160548;0.00618238021638331;117.647058823529;0.141843971631206];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.1416956466085382;1.0270173942239433;-2.5032833530578067;0.865723132408864;-1.4973258916104148;-4.7831458238140776;-0.03331938649451361;-0.15743183627376053;-0.6515398916125863;-0.31725636062590157;-1.4632714225125973;0.0039653351377881702;-1.4853567887409154;-2.3238380329698352;-2.0255445175987328];
IW1_1 = [0.47530189939753159 -0.094344533960709076 -1.9108016842029747 -2.2623496691368854 -0.13459308713895843 -0.15215503220664828 1.2036062070674078 0.14343102849676462;-0.79280132049194996 -4.2404098866220172 2.0493316586805101 -1.869536152864276 2.50755035407908 -0.19390085152921788 0.55086090752201244 -0.14298480873333125;0.44338469963095062 1.5042233679789014 -1.4623186077718762 -0.37171109846532185 -0.94558549500994959 -0.12376894690130663 0.12759323153996194 0.17788930961073188;-1.0044815974321473 -0.52074162746560493 0.36530886086075265 -1.0882245345554649 0.39094241477639469 -0.76969518736747722 -1.3444789872935745 0.10709656323416709;0.35526126731870156 -0.36773912675184578 -0.53970677746643969 -1.8212546370279845 0.87012497041964021 -0.24497125658224778 0.48757014968888202 0.088145087914275444;5.6437345227520321 -0.093810490493193927 -1.0102974806179172 2.1781661299142248 -0.2135495328433106 0.43702263043610301 -1.1296584066645652 0.12837201955529459;-1.0528186687946377 -0.26375315717239273 -0.14490977864791513 0.8613984941582381 -2.3480142411785718 1.2933313257098045 1.0493118277660056 -0.24742507955361032;0.042089763915204234 -0.23147525467831107 1.5281196309281875 -1.3632380983769243 0.6212248938197491 1.033505694484933 0.68600703168890353 -0.25119685144206649;1.0465548467734747 -1.129122118721271 -1.1393475722814217 1.1998863336611287 -0.11312009241294395 -0.30490363845714702 -0.54307143062787255 0.21650511512017834;-0.93534998509851774 1.4710606515294467 1.8486023480611116 -2.8961758725335476 0.83521299592434561 -0.60755538165273548 -0.44710283209623947 -0.13222764895510808;-0.23562771277837599 0.26673325872840598 -2.0529711263572472 -0.37131850451019133 -0.85003513928448671 0.031343473701299626 0.1234258674916784 0.011604480466318278;1.0725183550103345 0.36700072388736804 -0.60169744761913424 -1.5596367829309561 1.6404976159409099 0.27661988655371295 1.6061639096360343 0.14621745357288846;-0.61341673876574954 -0.165532645507347 -0.59994165243778641 -1.2018662134780433 0.15435778204442105 -0.26771019599157686 -0.094175247143047314 -0.039712757549034611;-0.74173093805248991 -4.9479383043232206 0.55783989816136403 -0.04175183325681165 1.2074530541071342 0.16163329568995688 0.70888938944042668 -0.34405670047321757;-2.8873411900335628 0.89838950761133152 -0.60741103884292236 0.12010323326601741 -0.59857547640759312 1.1826683711996513 1.3895865160846945 -0.62523510457541454];

% Layer 2
b2 = [1.379281305921332;-1.5241638788277281;-1.3267055401063024;-0.5015291875030583;1.4489907383819922;-0.32886673314799647;-0.25776434072530086;-0.016337793624597394;0.037060736679179015;0.26410557158310005;0.06706995076222215;0.73756151516297841;1.3071134094696946;1.8826037520599024;-2.0985409394325751];
LW2_1 = [0.22162763688615184 0.30419676277447388 0.54396571957175521 -1.2151352413149155 -0.6511558565883786 -1.2759151972460838 0.24996063517079462 0.6858639078860429 -1.9859389168534354 -0.57107527466899721 -0.44878209963321763 -0.96519854884197942 0.50154737109491965 0.81035916221529203 0.39990765532518557;0.82883862429061228 -0.33858975320219276 -1.5452914136915927 -0.076305388701661661 -0.59795768896221435 0.95017372556884139 0.2784844817657835 -0.32539332772140434 -0.84515406529227055 -0.12632874488240231 -0.48339934527831607 -0.81850692348319598 -0.026012277493342201 -0.26102051391744263 -0.68273613001370925;-0.49463275061199163 0.70560149760659119 0.45511514372166678 -0.18893512289700773 1.3849106418500456 -0.90513267715104306 1.1876647131444362 -0.19317402246138932 0.59867295060319137 -0.25396635358677921 -0.071611619215666555 0.74711945059294749 -1.2244219607590392 -0.85901792801252508 0.031235009096293509;1.6879271753623413 -0.18989264747513571 0.71984192616754683 -0.039475359383321612 1.6019708957888379 3.4932378788944107 0.21417369024304808 0.18659551165987343 0.6910402847202044 0.037106631265114244 -0.67933095536579891 -0.21779873818557696 -1.6005008987275684 -0.24778600553307875 -0.29815168989045471;-1.2994076176263623 0.79602721504415663 -1.7351971118031535 1.0800516766015726 -1.4556196196540909 -1.3795678421862829 -0.31003814180051886 0.14386279557291953 -2.4990147647931495 -0.29301134400331141 -0.65465992062713196 0.094707202958655895 -2.201575714283579 0.82649518884583895 -0.6465577694170549;0.74882954122353318 0.74780542404953998 0.2157973570951752 -0.21426172023592133 0.34229025187864481 0.99808856038930238 0.2544724719665547 -0.81689160932813343 1.5478792906018954 -0.22320442897282383 -0.51465243498048063 0.28846666315071351 -1.9505424224593786 0.78110556115927865 -0.51799516480519359;0.53176527971471432 -0.24371572958711132 0.97348447329603494 0.24637115351787034 -1.0192316065637383 0.8008613435445614 -1.7369598641266424 0.52704151786408027 1.33540237561769 0.33327246175457081 0.17334149502276558 0.1923533885728855 1.2409064483700358 -0.25762382098123965 -0.8785921394953754;-0.59034555726284399 -2.0335574954446063 -1.2473107175604006 0.48017025539815744 1.4136502794100965 1.0602938769371426 0.054582526408436867 1.534022986603673 2.4019118800812778 0.18193786332484829 -1.1683707462342887 0.80820552107956334 1.1919240910448909 1.2444884460527712 0.062844868372822535;-0.069032977894719447 0.75863871603951816 0.53985270130164587 -0.19682654904113794 0.58865919320121562 0.057820049429076682 0.76903760785386521 -0.20774230549924436 0.68564008587882774 -0.20777926600320137 -0.68110694198329735 -0.23327620789828279 -0.4338568123260928 -0.88861145282496901 0.12033190234363957;-0.52299025455796866 0.57820205441852324 0.29389949122089942 0.75911692736993563 -0.33057810312924751 0.89302147775590834 -1.2317159466425389 0.31107912179395059 -0.92949400595735898 -1.0282313831768097 0.81379650635641954 0.77226525143434366 0.67015036239242021 -1.2078138866863029 0.65113849753527764;0.73658381694417219 -0.075814972750676043 0.13308607253720203 -0.06288663036908218 -0.4788366837793368 0.18600090894458726 -0.43461773399206505 0.77171216511290142 -2.3543999442290846 -1.3984635151716891 -1.1321375463762986 -1.653515934465833 1.3415248475028034 0.79670515795291819 -0.56666012533345445;0.65097898478304828 0.35667016136667218 -0.19200748016722183 -0.80056892750279041 -1.5249012272133238 -0.61196567407455471 0.22467575330768996 0.82554890784112811 1.370186506518368 -0.85783885765502255 -1.6112446383792944 -0.18828409182389125 2.1313819159291154 1.1220246580837581 -0.022411902592592785;-0.21357758224418788 0.85869508879159706 0.93191964435292785 0.2825723787922238 -0.17573289980136872 -2.1996127279068576 0.19538376059347207 -0.052140370594683266 -0.28463496169881014 -0.032739869536914067 1.3466763967722428 -0.95766845116483579 0.27901297386293683 0.23417484579684764 0.6557459783733085;0.27553123059474849 -0.33746727803183785 0.54440287516020602 0.52066589121546425 0.11075604696526119 1.7567686422498541 0.33264250272314849 0.82694825962497664 0.90825148815235357 -0.023429155132892624 1.2351596585624418 0.86856256099741946 0.17768628413574378 -0.089474537930436984 -0.85476583653261895;-0.97517190977701362 -0.82742622936098842 -0.53352957786212207 -1.3096310678315413 -0.92125782709154858 0.27694668142820605 0.16470854027901416 -0.39502447379864336 -0.30691824857746941 1.0021436548231901 0.41388392194878693 -0.66941300108723512 -0.096459557161654233 -0.1766240828269427 -0.59740679319107703];

% Layer 3
b3 = 0.50711975449771352;
LW3_2 = [1.8517084013314447 1.9135697921018031 2.2224745362753402 -0.89763933654843131 -1.2875123428897901 0.43951199140753394 2.4169058932800498 -0.39627337605320123 -2.4262288058134653 1.4415353793948116 -1.3583393061060736 1.4704611959625764 -1.476598636602966 -1.4530614909082129 -1.3118134907067271];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
