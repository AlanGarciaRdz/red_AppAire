function [Y,Xf,Af] = PM10Tlaquepaque48(X,~,~)
%PM10TLAQUEPAQUE48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:43.
% 
% [Y] = PM10Tlaquepaque48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.00462534690101758;0.0212539851222104;29.8507462686567;0.0523560209424084;0.00624804748516089;0.185185185185185;0.00773694390715667;0.00572573718866304;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.2001358980640748;-1.0756702942006591;7.1889338146489097;-1.2475700802202048;-0.74909130121607315;0.39218480205115491;-0.19964031046450287;13.64886399870133;4.0071082868398111;-2.062744326694685;-1.6230259131759315];
IW1_1 = [-1.3361439756032965 -0.0065576983805758389 -1.0996833219035458 0.40967613122217511 1.0079439097137186 -1.2918092857720251 -0.24000905566779757 -0.013242082633883823 0.26343674184772159 0.040043757184885086 0.20680175272293169;-0.77373306439926315 -3.0761843089988656 -0.39973253035483308 0.12607569594323131 -1.1531456091261265 0.04611453614789196 0.016765623542579954 -0.038817357110623368 -0.017070738918624179 -0.50676945767218518 0.48938248125323502;1.2006603957379582 1.2852645598015446 -1.8648930230859126 -0.11372447008820966 8.6155664163256436 2.4417402832175483 -0.090081625693718234 0.050365140151513541 -0.35082678094037428 1.1020294647603408 -2.0828028758037465;0.27345437872133499 -0.31736564441475479 0.12340928354238367 0.15094058210056843 -2.0247600871366189 1.4298338006578459 0.16031704558533783 0.10266260281510955 -0.10090332565890608 -0.90258945392372791 0.53586018226640653;0.24218917312919225 0.21079062842119295 0.49915991093257461 0.32172574243411683 -1.9270389766788472 1.3683110452430851 0.22271562271813342 0.14205202435329967 -0.37156912392031566 -0.87642522635362674 0.28302624643126617;-0.43696077672581513 1.6248942822889973 -0.86800611382408122 -0.21528498127837417 0.55021085569977668 -2.334683716541921 -0.23695295119314952 -0.14140069651283776 0.26674746010818928 0.71335065344501036 0.081494804715744662;-2.0704786448536177 0.43836107994529078 -1.0513412320273372 -0.96996217120733597 0.97352814970495927 -1.8782290177049832 0.23227838572701182 0.17899203947619832 1.7699072741221933 -1.0482099398578093 -0.008338836059783793;6.2048638837251131 0.11770171974443452 -0.9318363665161713 1.1588223810234097 0.034111366098448323 2.9767032808295757 0.011728534940576475 -0.21964885493731279 10.89881901557888 -0.94644922671757159 0.72511121148100166;5.4715085409937796 0.86287423656260587 0.24493252933528989 3.0817646536833561 -5.3375641776548655 -0.63963081112117637 0.9796570754022611 -1.6803460651239535 0.27527468515742531 -1.2311296602170543 2.6585180948018214;6.3466081810366637 -2.5923177355071298 3.7558480347635541 -0.53070971515123377 -4.2917750230131082 -1.191808146704521 -1.6945094694621818 -0.34995110485783376 1.9433589768791841 5.4023373518626885 -8.5428002150781079;-1.8896074989943152 -0.18952517133601532 -2.6039347746892951 -0.76252212894342419 1.7723810044773567 -2.1879978488164138 -0.20089647493819568 -0.2736213608136685 1.5564386327538846 -0.90464902947520787 0.13129135813361403];

% Layer 2
b2 = [3.3261867455377319;-0.73263418639665212;1.319402735893918;-5.661020716723411;-4.5890411586060518;0.28730419463115697;-3.2876001580673879;-0.20821896669010143;1.1535870615587589;-6.0056906430750701;0.50807374027632279];
LW2_1 = [0.66418234938387066 -4.6566142724591515 -0.28938507281676257 -1.0972940079735645 5.8404395337976522 3.6761680558252507 -2.9303279359076271 1.2569614320035192 -4.6186580050915111 -2.4281352324730903 3.0789726594808671;2.2295040578012562 -3.5682806141905994 -1.214509849003361 4.6676363211547738 -2.1036917859732363 0.21641347703439814 1.5673327958323358 -1.0714565763755846 1.9938509437604102 0.35448038691809025 -1.5380822412027462;-0.74799090283578362 -2.4384107228548038 2.6683667092636805 1.194847676467345 2.2889114798505981 2.6029854120015292 -0.0098011810600322768 -3.040445980334145 -1.8524044892214169 0.53165093241672912 1.8933789027233274;5.5773700255753695 -2.9745514927291632 -0.7275409797752741 -9.3789672081409261 5.1612891672203203 -5.9897762645377775 3.0482136640078652 -1.1029725906978165 4.9972169891168035 -0.58052871735812139 -1.3810421570246343;0.5843244516011521 0.67803597442240937 0.60753132703800672 9.5370183626803779 4.8651477853383946 3.4834236597949313 -4.4600648857042824 -5.0885880980692537 -4.300707272736461 0.41767293371440062 0.052607575031379888;-2.7828267600266416 1.6680359495201127 2.0138295600908589 -0.14900283684688598 -1.3202360762291947 1.1308513043519244 0.90115534985608459 -0.45384454715474892 1.1856978445032493 0.17875035428458452 0.13224217032656849;-1.0687736504899685 1.2301975692239491 1.7342028307304027 2.2189994554714905 -1.3836354150812502 -0.27880179924628079 0.59612280380012606 1.4926757583424071 1.8632901192844056 0.54611744559237985 1.7756903266628179;-1.7182730521553111 3.6732061074488302 2.5409613587935183 -2.6860349696641181 0.75901112588916408 -0.88124772411536523 -0.32120641312295706 2.4645798917609349 -2.981103480794673 -0.14487167553365068 1.8978563158465871;0.16834441228263836 -0.52445185790360416 -0.33568838047709559 -0.61033791364915813 1.7273533850871057 -2.7391998140552309 3.5338765422504714 0.50605944346248277 -0.88820522750692887 -0.79833453136363564 -0.40732067508050585;1.0445827945872932 -0.5962503549572471 -2.3586738029681347 3.4387559324168051 -0.86441698405600342 3.514336207145289 3.081479341983981 7.0738101057153964 -2.7206938427092808 1.4416851926993388 -5.9915374650354352;-4.8731497754160875 -2.7960187911635073 -1.2446774442317272 -8.2766680279918212 -6.830987292510561 -0.66396471890156394 -4.5783408464302768 -5.5179981351013003 1.769725346373094 0.17137739899253501 -6.2844479683349412];

% Layer 3
b3 = -0.77747558280945994;
LW3_2 = [0.030633121544823491 0.1362328873553123 -0.06456476097995005 -0.10711894246819643 -0.067684237240327752 0.1137105517138948 -0.11977847604030673 0.17746459373531567 0.064346251883476049 0.060999198991888798 0.050874522741140654];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
