function [Y,Xf,Af] = NOXAguilas16(X,~,~)
%NOXAGUILAS16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:13.
% 
% [Y] = NOXAguilas16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;17.8571428571429;0.00666000666000666;0.02;0.0561797752808989;0.00588581518540318;0.125;4.5045045045045;2.48447204968944];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.7249120488566569;-0.90546270216663627;-0.1759689797248703;2.8310534381774235;0.33115045228144574;0.11200032674774947;-2.0669977639055439;1.7715725388996668;4.0088704425986288;-2.5096259912096737;-1.2611213395952408;2.0033319935732798];
IW1_1 = [-0.18665896791724795 -1.5464409047866929 -2.7595199978308296 2.3114213737891469 -0.27768621461300269 2.0818818753813386 -0.89444383951045936 2.3060129871001043 0.29559562974820647 0.76519313947815781 -0.39473398521322056 0.69856037921246683;-0.12799759580011202 2.945961177657511 -0.12293499659579063 0.56117058533323372 0.13237091817038146 -0.095062721721461629 0.12442393544446294 0.061139521235572994 -0.078716308001173893 0.077590892551896523 0.074321948076566252 0.025214324684583012;0.69741080664878019 -0.054207943681641294 -0.47208371290230966 -0.97002039279204133 0.71837025192957771 1.0504357900163446 0.31758431092085304 -0.19438500182344956 0.44578558041134148 0.6540836692773192 -0.92555900041121197 -0.2442061601558751;-0.19466565213153272 0.10046583727170888 -0.73268992244712561 0.18057591281509433 3.2326692249476143 0.13068193357562782 0.033408267814435247 -2.0525639437673786 -0.17091918457114932 -0.85609997505768809 -0.9664099297914106 -0.31339238614182635;0.097960234633878471 3.5613999883938874 -0.49110985503695903 -1.4569057240441492 -0.8917610262469865 -0.2031377204790159 -0.56586935373040359 -0.10061550242387549 0.15618686951088262 -0.037161196404622607 0.016109028635859515 -0.14993768137965829;0.45958827334163971 -0.70290240434178486 -0.63428360973477627 0.37446258910675762 0.178304994646627 0.39168486271938835 0.14497248367004809 -0.2268317966724932 -0.70112228439524737 0.010300279831877143 0.36776736167179086 0.099336000811154568;-2.2581292780896032 -1.6750066193154964 0.24923286922102234 -0.78376664707676769 0.075136291135231487 1.3032008069964576 0.041946306315108282 -2.3758814470978717 -0.5648290680029433 0.63636012053937352 0.21678871865654886 -0.074145318277359873;-0.69570746838477449 -0.38829080920149167 -1.1180065493424538 -0.42188366222463297 -1.1285655493942617 0.62161368823162166 0.62392633965914857 2.6224893082349063 -0.98186684324894857 0.47412268474339159 1.1141006152886552 0.56694286964149709;0.0016369048187886547 0.22561911412255245 -0.41124055384930874 3.8002853888588497 1.1580657276930852 0.58088025509504748 0.043969311695902132 -0.51601774041739534 0.2738375367489097 0.37396947473490294 -0.71844362586457922 -0.36391209309217787;-0.13356209715556763 5.0528108177146462 0.27963072778347442 -0.61303422153123122 -0.10116274191478324 0.023357041602568705 -0.074527340123939925 0.008509920893208317 -0.21344142581072006 0.046961348640841546 0.10201167401724157 -0.70689885081869941;-2.0338274981949178 0.35127859904912256 0.62117202038814279 -0.43931228711376652 0.30783324394432249 -0.65762717583116637 -0.18037736796930859 0.18770109337899227 -0.33373073790628821 -0.47368881008444336 0.29065902813012645 -0.091352762632995396;-0.012522294302280388 -0.72414022867353367 -0.083366605605135646 -0.70007989320066277 -0.69536447784930022 0.33425582261732728 0.73703996568554708 0.44861687584952548 -0.90999351149779018 -0.72631867878063738 -0.62148381661886321 0.66867637737187546];

% Layer 2
b2 = [2.1558385100507178;-1.7452823257839976;-2.1150277205709616;-0.78444523008302247;-1.9477356238573893;-0.37217985558444278;-0.17203245859222172;0.36213770870142215;-0.088769994130650481;2.3953644132586844;-1.4503111753717024;-3.454390771856235];
LW2_1 = [0.12559519231650679 -0.22010282893226524 0.12969065447955067 2.6413458762265809 0.76662637298836678 -0.33621743484727451 -0.04349672381020208 0.23155182517810502 -0.1974546172311995 0.36645125649693266 -1.0762717161853619 -0.23699211393807124;0.93978313762618693 -0.5330862529771333 -0.080636660581934388 1.8741596517020593 -0.76631155649041971 0.76583188405078451 -1.3376153798368571 -0.9708966636546944 -0.69146329514454463 0.063526189090303095 -0.895614349340077 -0.35092172875622091;0.45151125777956252 -1.1637629228458561 3.4473925404805779 0.75390590256978796 0.9584392943123059 -0.5240961065112878 0.57786434947285703 -1.3114667805582081 -3.7879808218826212 1.4477415804500429 2.0491303477553946 -1.3405294047580045;0.80746493758334215 0.89437062993890271 0.078376178685916939 0.7117901929960766 -0.99321099074044117 -1.2129419954103444 -0.29107304611715445 1.4263846968075762 0.053559357011147994 -0.32914587957146518 -0.43680065159738324 -0.70519197311996928;0.57702587358631896 -2.1327754124212661 0.19484896915788794 -0.44811704842198274 -0.076669645456899999 -2.2105157030319904 0.74962171262182065 -0.68938107585613317 0.21959419892447457 2.0257168946783946 1.1209844287359738 -1.7790444727172396;-0.78856149818568333 0.1800385745929885 0.091070469221719408 -0.54115692492040557 0.47792727084254066 0.72411020950326388 0.43227626159261873 2.0216690007022731 0.48494881174500543 -0.34232554989028385 -1.0382656849732277 -1.5302065196081795;0.059009478240248991 1.3534126658989929 -0.3537644908132801 0.1060932042537184 0.64116882020903343 0.30593835699168787 -1.6980995198766291 -0.8514804475000618 1.0483429644150593 0.37707188320455087 -0.38659071137194428 -0.099849577533109107;-0.84633391470342212 -0.32309630907041009 0.011533347404379012 -1.242353275364354 0.85756522045312178 1.1899253821033142 -0.058190204081601346 -1.0401513910219682 -0.17408654885110336 -0.13758573893047987 0.49093077283065484 1.1544218129991806;-0.24019536801817268 -1.5493036945089209 0.093503638782332629 0.4375036189016337 -0.16394800610088142 0.2078664787875695 0.08053815674713781 0.40033532053329041 -0.082147447918310815 0.30147591489940806 -0.36073050084815367 -1.0269680116740807;0.52917673388163378 -1.1505232224425153 -0.43476591233547934 1.8011660259038338 -0.47738596757670215 -1.6362940798769201 2.8281750359734574 0.77266921487634088 -0.34672839723326448 1.9266358358290863 -1.1607512923641929 0.84506071923036175;0.023702330909421129 1.5299946262491471 0.25229588792005048 0.41089213315013157 -0.73641134776995498 0.51711844004608343 -0.58094133931550973 -1.0756353922199666 0.39244338899075393 1.0733630341806075 -0.45485818720557347 0.63431472563338576;0.11668060683454103 -1.55657989560073 -0.20772381545227461 0.64697753974759953 0.00056910086784282138 -0.1221399648592708 -1.3130088703530673 -0.17550106200790749 0.082487561643831614 1.1991328649976174 -1.8203794563585685 -1.9775634292280313];

% Layer 3
b3 = 0.8869570752958158;
LW3_2 = [2.067432186665322 0.052156725752998824 -2.667491717175674 -0.58046632625961436 2.2101757430748958 0.15048770615012783 -0.1285644557765292 -0.56805381774280195 -0.44555348188967908 -2.2373858345295425 -0.21936889217890287 2.1013541307724335];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 5.42005420054201;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
