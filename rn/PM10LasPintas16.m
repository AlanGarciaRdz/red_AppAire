function [Y,Xf,Af] = PM10LasPintas16(X,~,~)
%PM10LASPINTAS16 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:30.
% 
% [Y] = PM10LasPintas16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;5.0251256281407;14.7058823529412;0.0179856115107914;0.00280033604032484;0.0558659217877095;0.00576368876080692;0.00618238021638331];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.52294363963981449;2.8144899099388492;-0.20122923255467884;0.59348004158409351;-0.80502737924904566;0.16989678943462114;-1.6302805852395343;-0.30338738337282617;-0.41566572626464682;0.15236358706013073;-4.2610559840368119;0.75455066231140189;2.8771893523640215];
IW1_1 = [0.46434565528904687 1.6594622068964748 -0.14614283996989022 0.099833992130433799 0.65000399546946674 -0.27614623293942708 -0.45277477394213739 -0.24214490566421901 0.40258632560236979;-2.0897338658418896 3.0531303016307398 0.76614995253458529 -2.8033755038899879 -0.82766812730047423 0.76713863902994828 0.43682599626647389 0.3854021350005335 -0.49657606627790446;-1.584220028190283 -0.521656735415156 -0.46555617870471261 -0.037581788172600127 -0.42662047210919468 1.4627470586188984 -0.45230347141044391 0.19970679944354744 0.13121218868000839;0.36485877743915762 2.8509883891210985 0.85644190887644778 -0.22432995531398586 0.29442133464041192 -0.96613812582066638 0.35517861158561376 -0.10007593550691639 -0.018281701961224674;0.58987376320052998 -1.4993495413618869 -0.67097131151186318 0.58009360979856395 -0.903403198298387 -1.6686805850358275 1.1462713154253059 0.46075464866127819 2.5233857585642943;0.114441247100662 1.966333779373687 -0.063791596930533295 -2.2288214270122855 0.16902020424387465 0.9359345266829302 1.9231077597493185 0.088192285884501578 -0.33750127538202657;0.53735797580076206 2.2789760619470179 -0.51557156766812784 1.3882387199266502 -0.71731265635153485 2.0534603229246287 -0.85707794742032206 0.30976272881362193 -2.3831846409378143;0.35586164899363676 -0.49267008749917501 0.38919364949789431 0.066132275240955149 -1.4009783956231747 0.23921278619598255 -0.15149820430292857 0.25127384520434826 0.025900332794076296;4.7424921403861324 -2.0491572461679999 2.0684785396420073 0.63081524213789331 -1.7345831430004872 -0.95489834669622664 -2.0828643105315261 -0.21816792400655857 -0.81617249419556459;1.7726516336819844 -0.031350735822434944 -0.16135863962582325 -0.25058399024410943 -0.73735872296350558 -0.77000192731271677 -0.85437324737027853 -0.037464280317584323 -0.34534934800325906;-4.1975151387135412 -0.57556821752133502 0.48768616477445026 -1.9037241927284665 -1.4397191388630781 -0.8588602244011585 0.068576074684965918 0.43231508413978631 0.63507690324018684;0.42409260404327775 -0.14712697734742453 0.29980794571509661 -0.20977007034997636 2.5665243016213783 -1.3035775041982571 2.2766082729202868 -0.35265361022677855 2.6487111380280353;1.1411962120534294 1.937360335225714 -1.0254297475941341 -2.2082573276515727 1.1823472659661243 -0.61375060952413207 4.0946494037844348 1.9917259550970121 0.22428497353993854];

% Layer 2
b2 = [-0.58151697534313707;-0.66018830347951829;0.85929523056683788;-1.6401094353396608;0.25998900103955458;-0.033684740422418279;-0.062314182302139934;-1.4025505835773391;0.69685413533225993;-0.33411629881913407;-0.5706405913876379;0.49399383856720996;-2.6682799036608214];
LW2_1 = [-0.27713807964682236 0.30917377238081339 2.9563677617636741 0.94830922966092013 2.0438095807313457 -1.2269895046529993 -0.74952680421898332 -0.24683538776479405 -0.074518896383765104 0.48432303817207067 -0.014763471611279406 1.0728270611950521 0.79891975946847194;2.0922407376896928 -1.3867412622355595 -0.39890543578499932 -1.1455910726540461 0.18289642583736376 0.84455336162922645 -0.90199512149797179 1.6349931651672858 -0.88812192828201164 -1.9507964364103041 -0.61821371162449179 -0.26680980334854176 1.1582049338501126;-0.36742075199719054 0.17876015231944203 -0.32451114967741773 -0.47918329575212054 -0.61125151402506894 1.231235687641044 0.028961575792517187 1.6387975655977691 0.76630173696664472 -0.63736309607165975 0.59168976469927759 0.82638638121336749 -1.2458894790197175;-0.57998979790488103 0.086384374844465206 0.87895051893178966 1.0345929724597001 0.46370753789172992 -0.15575806819269464 -0.55675980881628062 -0.62568457067373173 -0.35390276658058806 1.3731086165322037 0.83014072354255386 -0.15918681577293395 0.79284255964301109;1.7350338591159415 -0.12427551856524771 -0.50439540006609507 -1.0254987734633041 -0.018264933415533577 0.64395021399247099 -0.56720329724107077 2.2149459940183158 0.1862914637560466 -1.721126441957437 -0.25390806617370959 -0.025679274071770748 0.67449893062581179;-0.75607037901474217 -0.46948225700180218 1.0387695528310499 1.1731158899867242 0.22247189047419297 -0.084505820151918876 -0.80173654554358809 -0.18577589449741694 -0.6673255897212268 1.6804967174425225 0.70973161508513016 -0.20199222275702963 -0.63515200272366079;1.1930979114742537 -0.44216697402823479 0.69496960524565643 -1.4430448645179792 1.7537545277409574 2.0247181151300162 -1.5676152897075197 1.7980707284033333 -0.98890016191365715 -2.6139849981589469 0.84652515137135531 0.19217095744144119 -1.5066482722070407;-3.2076527495418907 -0.41207574047720208 0.56275794458888573 1.6953873297676292 -0.27518661052633053 -0.18903431221044203 0.38655525995116441 -1.6026109724049271 0.74020309836505016 1.4816347611282892 -0.75454306280926575 0.17048870968116389 0.67450603400242781;0.053079031077234218 1.2328664670740033 0.10311035703212357 0.21713268995213708 -0.20335558553414251 -1.2191247247139507 0.57463226392259059 -0.546153381739935 0.47030672856188216 -0.91171530234344578 -0.4283805012329216 0.26252959562101374 0.95912865946609438;-0.26612943396140071 -0.49919690958479845 2.0565047468776596 0.53679166392744493 -0.32103423329707076 0.48477434482381759 0.14674153330675388 0.39657933719631228 0.78635898342342747 -0.29228859393690948 -1.5500612174694244 0.031303891513286913 -0.37004486243473228;-3.1492383212819259 -0.48314622460744833 0.26829519136814772 1.3140342350864112 0.24083551708114098 -0.54337821479941839 0.40613892203803797 -0.62455240832512982 0.23001423782314162 1.391319851993714 -1.1429691371743425 -0.15477832883574258 0.32334320108899167;0.47606935256752325 -0.72147438960122334 0.38520816161969801 -0.1240403644625532 0.67402245698282504 0.93534590909274262 -0.022387846762879041 0.48784000432021163 0.20318692331419561 1.9036276884691499 0.71362432813134458 -0.64650116013168024 -1.5371776638385928;-0.54106522298897575 0.68195957313328104 0.9564145249517263 0.14568494208648175 -0.248456612703157 0.90254230630913301 0.70119765897220809 -0.13870323371229021 1.2043230909493143 -0.71159117912549474 -0.41701024406228654 0.55307967263380209 2.2138725705817857];

% Layer 3
b3 = -1.0300623190096156;
LW3_2 = [0.055635500849627637 -0.43369483358836491 -0.45290225996906686 -0.78163123876909169 0.46961179049136609 0.63839468044434655 -0.12992992976397522 -0.36207610921844907 -0.69450617166231077 -0.34396058338078034 0.20414811619378337 -0.38375498897547144 0.39347125127137655];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
