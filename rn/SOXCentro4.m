function [Y,Xf,Af] = SOXCentro4(X,~,~)
%SOXCENTRO4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:27.
% 
% [Y] = SOXCentro4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.74531835205992;15.748031496063;0.00773694390715667;0.0203458799593082;45.4545454545455;0.00627943485086342;0.132450331125828;27.7777777777778;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [4.8771349987040695;-2.3042923516261582;-6.7745398107601362;-1.3606852721732499;-1.8510263146480137;2.2763547899308714;1.0057769918318451;0.60850253502151164;-3.9408984620232408;-0.42442586683824013;-2.2591073519712888;5.6093272245199204;2.3893562013924137];
IW1_1 = [-1.3300385575670786 -2.5753985050747605 0.081829716062838398 -1.1567741282737807 1.477315753392126 -1.9596999232457799 -0.98088341675281787 -0.036173365435202942 -0.48021875295122723 2.7906398790275868 0.58604766948081244;6.2411358256158813 -0.10446995054921053 0.73450443251872877 1.2857525368173177 0.99903827891246655 -0.29426569139825987 -0.51796333556298302 -0.26560636667342052 -0.26049747307039212 1.2285857796671118 -1.1206504172468901;4.1789907761428227 -1.2463881510586214 -1.5270943221395625 -2.5300653323368207 -1.6752678547057347 1.1039080229076152 0.80787954727417799 1.608352939004384 0.82370589518065818 0.35917491094451875 0.23073868864590646;0.13195590249887398 -0.16249367334850864 -0.15102022952115168 0.14423310550941637 0.43391546043990864 1.161734637515031 -0.26432715679122581 0.56619828946327211 -0.081073894326480905 1.5476012968062458 -0.12913462439988427;5.32507566465181 -0.35935065926104776 0.54089516634985146 0.49963970679204162 2.2827483397860364 -0.92298423675733399 -0.22681297826049707 -0.89602413453095031 -0.37890220188499785 -0.09106536510826134 -0.051126227377636661;0.69256480719984592 -0.05966703632508169 -0.24399127749950678 0.54784354037498617 0.31780245279955799 0.24533715538626888 1.3172944182895141 -0.20479970795183047 -0.087588913445181299 2.4865255426410147 -0.68452671688614908;2.3389048035542217 0.66435749310384251 -0.0032115905357996462 1.2535591300851741 -1.4027696158347462 2.259312451646422 -0.34215680223444339 0.18819682764193796 0.040507965954394362 -2.2456175953486261 2.7338690279705671;0.50387070878998474 0.036197791477951678 -0.21189562353464353 0.24575104158991462 0.094530230267279788 0.04874730299232867 0.66436008310240835 -0.076134921168718631 -0.079585548210824322 0.33886905803135869 -0.16335365407705527;1.7008374329399194 0.42677382989051843 -0.078912094480158235 1.1679975163058061 -0.57060272864268768 1.1054850574271886 -0.17760727869576029 -0.073228089798014401 -0.21761711276428841 -6.1983432831457606 1.5429869342055618;0.13660619031919582 -1.7173423678312996 1.4583519735778792 -1.0205520515503315 1.4444151992268832 -2.0832583330279251 -1.4089674115719506 -0.37353047617941892 -0.31003286709079136 -6.6764443745831663 3.8751425072215673;-2.0090582634165299 0.054802356735688534 -0.17015670932814364 -0.38069755937957195 -0.056661113359088515 0.1088907016581772 0.59605079677454298 0.031668609951331014 -0.10654153615066302 -1.8100267816066393 0.030713172344893378;0.17076741444636556 -0.14498915614708713 1.9106529829911769 -0.46360412111099902 0.26318274845246314 -0.57041348722854446 5.9477846203726754 -0.022148339651661658 -0.13164921150562109 -2.3994291819078044 -0.55307222615455309;4.9998955739730118 0.14204884047247551 0.88742211756746892 1.1281850026663567 -0.71770404042753932 0.7697856405335789 -0.57841675204826881 -0.069364347423796019 -0.084462862998908927 -1.2985209920137131 0.20383853408313551];

% Layer 2
b2 = [-1.6823597205427547;1.5692794052139065;1.5010010884766685;0.76070428587322714;-1.5225987368775877;-1.1904486430398673;0.92297126244119609;2.1920584199042925;-2.1395540969043325;0.95638811616773634;-1.209924643262333;1.3763671449028092;2.656027055346728];
LW2_1 = [0.02887431638501408 1.1014003213358974 -0.026789947246972701 -0.68584194145793842 -0.62712229487915883 0.7122391779772328 1.0777269593966134 1.2286345968252919 -1.1401772853777412 -1.1624000918742527 0.7759981560431789 0.21229165711157538 -1.0821044492342236;-0.58201067467881884 0.90184158442192275 1.0299640669725791 -0.19630634998604921 0.059579445901443748 -0.88345692447399604 -0.83839762979973442 0.18275271085216035 0.35090032136136112 -0.46788677507956672 0.0664030872176746 0.059582563466731311 0.68205226173814093;0.35994399235977742 0.34623076426597621 2.0705082728765589 0.032159833692723426 -0.17071439402321592 -2.976785772575028 -0.24720295572781731 -0.5360649291026135 2.024452092307639 0.58976711627005241 1.1185910378711483 -0.33328003404080436 -1.6479631021870298;-0.65275648901298411 -0.11689148521884382 0.84028176639777163 -2.0842674071432579 2.3386179048910845 -1.7623599675800317 -1.0729941064155111 -1.2091280753940792 0.42700450930705808 -0.88718103238703694 0.16427930435219887 -0.36328677903310341 1.9148043135498103;1.0130084215492066 -0.87529799602551883 -0.96896803297788281 0.56301821395762541 0.095627753748096428 0.48235311426934718 0.84931970229713072 0.30119726805703662 -0.45679289108267324 -0.12178930860338107 0.042604747725000142 0.455993685007205 -0.53088890972313774;0.75022504019556535 -0.73297865243806559 -0.84799120070199629 2.0293904763591626 -1.8169248467140862 1.9729431638882444 1.0739601507581669 1.1102483575353899 -0.20314761124544567 0.81809512871024714 -0.21223264457496391 0.54435104364903186 -2.1193575787445091;0.18394430171208573 0.55768567637138888 1.8032632123693442 -2.2296722595444063 0.90149218824651112 0.7887920493766325 -0.93245187929077133 -2.4617460153041062 1.3288204790197229 -0.49368068223519745 0.31522052886057828 0.34883814727100082 0.57546816336137185;0.72567999232595259 -0.73920057228381131 -1.7023406133058454 -1.454354637999637 -1.4179739841167724 1.1619946583986351 3.4319904533132228 1.1426044309500958 -4.4430133869431954 -0.85034910906768013 -2.2048299491661232 -0.26683615522966631 2.5137832586187066;0.35321112044563385 1.0804175575541481 -1.9527565095295358 1.5188441409810647 -1.5002032912278711 0.87429458982866137 0.12009379027350738 -0.87601927956375836 0.59146157858402493 -0.38730869813459767 -0.63140242667076485 1.3680886947816302 -0.81714222015931703;0.45423652891710981 1.3586690003094148 1.3388845390029778 -1.527695673351267 0.23427641163090093 1.0661132811537655 -1.0978046399845249 -2.9710292254954083 1.6709387724830851 -0.89380243393081327 0.19390129383666815 1.0075889370347892 0.46050060164089096;-1.0467218558354321 -0.67851425238531993 -0.46403814543798738 0.10080894602724419 0.71043159349763707 -0.4281267817998346 -0.035214699073209857 0.12789082487750023 0.053367839227975139 0.87890036917311698 -0.52818958454093379 -0.83362740044504868 -0.63276706483390344;0.70744003288706925 -0.18280185267828911 0.89915102692430704 -0.64538903222567434 0.14289820018901792 -0.044611636251171594 -0.15031440655151007 0.10784673596153817 0.15102575665149248 -0.59044261118909058 0.85259708822853875 0.082821416464907482 0.68355571092821954;-0.016375670110374583 -1.1283356276793564 1.4286877947783314 -0.65513812070364907 1.1550762670367911 -0.61892026520518018 -0.14259329771249027 0.71771856241892673 -0.33661792820303404 0.098623142911118428 0.57432182417161959 -1.183595274002446 0.57636616785694184];

% Layer 3
b3 = 0.36127089023730791;
LW3_2 = [-0.15004850518870466 1.0586453235787816 0.068857891518510891 -1.5979741913018091 0.88207760988856532 -1.483880827955433 2.381273896800657 -1.8076763188935829 1.8258996540640211 -2.0593836335911546 -1.196482125471799 -1.8598901053875776 2.3827795238482827];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
