function [Y,Xf,Af] = PM10LomaDorada1(X,~,~)
%PM10LOMADORADA1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:08.
% 
% [Y] = PM10LomaDorada1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [0.33488433741802048;2.2391824544985108;3.1669312998236721;-3.1087388607265765;-1.9949795255671459;-2.1865048108395557;1.3760905819215212;-5.3328392035623304;-0.16991164994731328;-0.51035006709715669;-2.1014760363360119;1.6107332719031637;0.5074244048871549];
IW1_1 = [-0.31770594947945446 3.2511669746544936 -0.15277188639976214 -1.3166127346614012 0.44389766510001322 -1.4369426951835247 -0.0091735090161894628;0.81458537786146412 0.75489610247544825 -0.38853088096452265 0.046578696936372482 0.33480476180884633 1.9187963912614774 0.019871203000507105;-2.5399840251780326 0.20490929390705551 -0.776622012042679 0.72848220306880407 0.2253556471695517 1.0287454955488744 0.56133653831112196;2.361878209732831 0.21978750276639844 0.27407095031883522 -0.088744449573486164 0.20891993154922683 -1.9620078946225739 -0.46120697702678753;0.31425317940406261 5.7742140154659714 6.1913129195049361 -3.5187017943741892 -1.5925453339778735 3.0253312211591075 1.7827832616564123;-0.29102442374785403 0.63697967544732947 -0.48566082015863127 1.0041181595735988 -0.36109278576974685 -2.9874312851388094 0.68187597083395501;-0.41476918131510276 0.18718344413884183 -3.6343375363425521 1.5904783294493758 0.19599698889473832 3.9816181372275481 -3.2177869990378327;-5.2140205615800088 -0.016527212714781015 -0.76984781957353376 1.3268030562195055 0.40753573737396387 -2.5557534920610943 -0.20949149276528686;1.0593618680111729 0.055911758693559591 -1.2452544974178283 0.23267648695640814 0.46077484628103393 2.5161982241850924 -2.7719839110323305;-1.8744212957865811 -1.1652482859938502 2.4806261719615859 1.9373088751271867 -2.9143782836651129 4.0993579169514636 3.5466382107927439;-1.4238078444677471 0.92143585979058429 -0.72322842025313538 0.88080421545228715 0.9038486723039465 1.5012462617188695 0.58755739273897889;0.68157735281398568 -0.025853891268191556 -0.8192565496667078 0.75144015209618686 0.9417824330274881 1.7838041981862776 -0.10501548543775432;-0.63627518014504414 3.4389251705880346 0.61203514863574648 -3.2598969232161474 -2.0363160765127937 -1.5748821382036735 3.57422293080639];

% Layer 2
b2 = [3.5994782446151348;2.9554915704782658;3.7108498843406967;-1.5664110411068846;-1.0341747947866078;-0.43650379087343499;0.77738214875824674;-2.9804597684114373;-1.4847317538927516;-1.1877243200738428;-2.9342455062257939;-0.95043235311220542;0.0019525409503182642];
LW2_1 = [0.43051777530456509 -1.5191038098710079 -4.1424499933784897 -0.73427208840153413 -3.4577898149707913 2.0018159352604141 3.8719490997344899 -0.67324049700620148 -2.7646704800492272 -2.0402337020106138 -2.9337716690958842 -4.206207364458538 2.088960239142998;0.97837571578886251 6.3596262402034807 1.8044771040571594 -0.20652835022853719 0.92028730724969154 4.4806217524407872 0.42619657700717212 0.54805429402279848 -1.0409309443157422 -0.89097088337187424 -1.5460268929912855 -3.9495917437812071 -2.1226440814033016;0.80930325878323206 -4.7305787755327806 -6.3203346956985369 -6.8523187095884746 1.3392896384921225 4.9536159963644639 0.066152172534348755 -6.6332610477654184 1.4590574685432669 5.4545149799229167 -2.3607890427469238 4.6412487229194124 -0.40746803303191947;-2.0407363765961239 0.82624585599633815 -2.7258965873325898 -4.9659323264843955 -1.6006901999140086 0.62320062017284616 2.8465261718803685 5.3357126458689033 -2.9004467606456492 -3.2138445278038086 0.3249437467148541 5.3493663640985805 2.78424577226584;0.23381006570722312 1.1719269869968005 1.2133861364517322 1.9346356864047194 0.13687283572787323 -1.3977297530845192 0.13821190728408098 0.26615238167092325 -1.3322264345225849 0.11928093666496364 0.50956484191899087 -0.6478582468007591 0.2194433229888724;2.110804706265029 4.8971684072612849 3.0957153242421249 -1.6190242716641623 1.751010080284146 3.2633481251250918 -0.88976379663161442 0.4344039561720251 -1.978173944176606 -0.47286139564488311 0.1353050338116572 1.3406997611189919 0.60617665302338253;-1.1969506433380346 4.4969700667486396 7.0246594008027516 2.5970715321159989 0.10282232877412967 -4.2149425002599799 -2.1849300745490883 5.3356681466381808 3.0877024290823449 -0.36682731137378816 -0.89093713330968272 -4.3754219570543471 -0.47479966299929421;1.3567074835164223 0.93321293306642539 5.9651131366754608 3.9215338724916111 -3.3298138192436886 2.9555258540033478 -2.7348248223224192 0.55353901040229803 6.0518592656891812 1.0106141516287592 2.8385382629456415 1.2848407432098483 -1.0068445562547592;1.1969778965994959 0.2211469840832217 -3.4115358728802319 4.6576050997406471 0.75584715779097256 -0.38720964005911646 -4.1193420858824119 0.94827902581164014 -0.1057224986641402 3.1956890245595906 0.31064000704184641 0.55725584430502839 -0.76154907662057825;-1.3014125941988892 -1.2516051583082064 1.2857840385159165 0.45337982834659568 -0.39908586923340844 0.89996072032802954 -0.40890012459670622 1.1186971052134007 1.507106981249871 0.82717752132606071 0.42593773520452211 -2.3981870557103937 1.0221511020887428;-0.10345285859019011 0.42328774769991429 -0.19995729393694808 2.4492506312788191 -0.13511882901589309 -0.45250992204119939 0.50820647275494157 1.6089288488056908 -1.0452491050419364 -1.937386742635143 1.2155290795720051 0.47628731655232542 0.18457095175861951;0.90319185229481713 -2.0008193529188487 2.5389697204504973 2.5123926978714652 -0.51222290645792357 4.6198182334670186 1.172745133715754 -2.9279357708767195 -2.6374821196839338 -5.0788393197353532 0.019124947138030868 -2.7927256625532464 -1.2859859096336403;0.7275608251542105 1.628423582665921 1.5207394357990762 1.4739126475470361 -0.72891932970236206 -1.8189853889033245 0.46798568262079032 -0.60246855863789017 -0.80427326417721867 0.33751635572690741 2.2887983464084076 -0.83687008693462517 -0.96449127660210954];

% Layer 3
b3 = 0.78385081713591642;
LW3_2 = [-0.17289876275146798 -5.1683696148245151 0.12040208524954862 0.083186446671554989 0.22187931622945939 0.015192075974008765 -0.17400782269408652 0.071153062147672419 0.080319954932285484 0.067741027770896689 -4.1245499189657169 0.1067939339765098 0.17919854164475119];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
