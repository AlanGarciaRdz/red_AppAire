function [Y,Xf,Af] = NOXOblatos48(X,~,~)
%NOXOBLATOS48 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:35.
% 
% [Y] = NOXOblatos48(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;-10;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.100381449508131;4.05679513184584;0.195790504160548;0.00618238021638331;117.647058823529;0.141843971631206];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.4059719948899272;-2.8526223190182236;-3.4906147921744473;9.3026498048184969;-1.2890617756032907;-0.7221124301436187;0.48223013481655003;-0.6186161184528266;-0.34566198951930782;1.3897972294311525;3.0698223316978934;2.5042296227204348;-1.6686403078811383;-2.0853110900004328];
IW1_1 = [-4.5199142822945158 -0.15367008484938566 -1.4395299419136329 0.38436941240476868 3.4824404451077808 -0.10844872276430981 0.8955670340134485 0.26476921381929258;0.19672563341998781 -2.5818883542380253 -2.2531110528247646 -1.7474880764654304 1.1541040236510067 0.22449101243097985 0.71046814486606658 -0.24508960642284494;1.3034636360450393 -6.2009021871841812 -2.5075190361175528 0.7363019600131282 -0.74811285739957356 -0.28450424655008072 0.60597902995060904 -0.36525924182395719;-13.272454304949163 1.1545701907298125 -0.68833973685360428 0.015878852266688795 -1.0026860715744104 -1.4392056681833052 0.88699468496764933 -0.85733316056406406;-0.34960770734922275 -1.1689338068311688 1.1238851210130809 -0.19138100979352463 0.11020478051046977 -1.6912289816939812 0.56293171212000781 0.043777700091457025;-0.47757353721467122 -1.225834124772309 -0.27489244784397071 -0.050735918382768114 0.086134655340667138 0.32175912502073617 -0.48183805240581279 -0.22295480052360664;1.2121327249233778 -3.9428934176203856 -3.1043980171000829 4.0836550545884478 0.53996414041165763 -0.17136469349872538 -0.48948884259613856 0.18044580717064315;0.98644015802311857 0.086330742244723743 0.37894898159110607 1.0897046832494388 0.9292325598345994 0.18443522985176153 0.54746641575678456 -0.069209687562163794;-6.565173166254465 -0.38597513830426033 2.0465123459076828 3.3078083250000097 -0.3481347034552138 -1.8444714947347121 -0.49315861009254452 0.16159467789870124;2.9759629764274091 0.49415078386312672 0.92604174755958957 0.22218853524344673 -2.2297198307923485 0.42069751788416554 0.32497787472520628 -0.10770289987847935;-0.36370967201654469 4.1588204845904411 -0.033899227335545845 0.5086235002512528 -1.6778272814308572 -0.46430531037395739 -0.43895847164362345 0.1455965889707776;0.024065838039534982 0.38703459286548492 5.3513440988833567 -3.7008540281476523 -0.65412512757376096 1.2693082953715575 -2.279946126656184 0.39302322884320512;0.21168957998030119 2.1736692688955279 -1.370591216763771 -0.43047450184002228 -0.50674783391499545 -0.6386753156680518 -1.3333209674668915 -0.2562216508855043;-0.085655317508937207 0.84215422519092831 0.53147485430134633 1.3748285686180297 -0.39743579993096217 0.34093797282273902 0.96185426240451621 -0.50704942146367149];

% Layer 2
b2 = [-2.471740356825523;-0.16980034925702611;0.85353921429792223;0.79136210409900609;-1.4408052886292844;-0.30350785642520384;0.22773268634475222;0.92309528959281362;-0.43964260938263866;-1.7880765166593218;-1.2948657220751554;2.5741677182538529;-3.8108340962269969;2.2679899383478599];
LW2_1 = [2.2420269264917216 -2.3247792531254348 1.2534079675962266 -0.85375732833058859 0.67012148558248941 2.4623034394499759 0.61206551374464935 -1.8117783456258862 0.070643348248126098 3.8902444339321969 -0.41743053770620758 -0.70299578121255624 2.3106774371325693 1.2197065750909892;0.31425343611345835 -0.056509366123202093 0.10473923903962361 0.03581134209939571 0.56384012494889846 0.84255661880137411 0.12296573323747285 0.42733195951240954 0.45444855889333113 -0.27130522848206179 -1.5721877913366618 0.63084690110124753 -0.52430567594492761 -1.1137449591913871;0.9260937929914278 -1.937773206229839 -0.37333213790952896 -0.51396888459707746 0.96740587197650962 2.4091527269258761 -0.4711214437986142 1.4610029122879904 -0.69623663314605566 -0.54939875153950679 2.1552726347910034 0.42228101140954721 -1.4021092613610857 1.1687718529323026;-1.5954076039460878 0.81903669720151084 0.36717711287545168 0.26364223166420842 0.98107115561033786 1.3263062655889457 0.79548262864738284 -0.40865920372667675 -0.082915277406922075 -0.018838321024890917 -0.77438648716948399 0.55654735126253752 -0.83740910336907537 0.74545089621070848;-0.015359681767978148 -1.623112818709652 0.24744215814385534 0.87870652514416059 -0.55850960158789187 3.2086702081585883 -0.10511576100769222 1.4544937547959234 2.0094755864865999 0.32188626004714704 -0.3496449574119524 -0.77207148793815195 0.73168834479952616 0.12664215747853247;1.5015198933254754 -0.39805082767146038 -0.45991551463400238 0.31775828650394805 1.142686617916606 -1.3332452997663189 -0.01730976705927123 -1.6547512523928622 -1.5559196260352528 -0.45176035416510291 -0.81229284416949543 0.2034034563488053 1.0562956561351566 0.4045730800770424;1.2053346240597989 1.1655699310688636 -0.97095475507909335 0.069882613032243926 1.1477240181964601 -1.8208343009592365 -0.60565143979475422 -0.38449028117512396 -1.9793549774726591 -0.072439309832701346 -1.2362290618074905 0.39113257009026464 0.20832210800191656 -0.44956591895509407;-0.7669384621960571 1.8757944652790168 -0.01948868333587472 -1.7517484460443098 -0.74415477532414587 -2.338282598322829 0.36843857786212925 -1.2068423999196685 0.53506881919690863 0.63634361709669618 -2.3821914248183558 -0.43249021893082584 1.2269473899698147 -1.7545714202581644;0.33252346502656893 0.020458112821215048 -0.86360406734045891 0.63989130827217788 0.012090151767607478 2.5379472213295036 -1.5081093888020958 0.16518852272053092 0.77260514565162908 3.0466670362618244 -1.5469148177194181 -0.44291410208564269 -0.19785280221448598 -0.31146995050515497;1.3048990799595523 -2.3211337278376938 -2.2057980348342121 0.043429510096691604 1.5357417649985539 3.3685459244369 -1.4614887597916599 -1.2220051143859521 -0.6065239128159845 1.2558982419653755 0.39653557101124515 0.17726971626035434 -1.3564057869084432 0.89225034671055592;-0.61449371143116749 -0.32157534189816039 0.29714026666054683 -1.0954163766072422 0.23939955751911507 0.4879864915075835 -0.017997340809853882 -0.76842000518644626 0.16421245052808792 1.2072119047144423 -1.5193783117327555 -0.72972322916413423 1.7243104842243 0.68069983943158141;0.27419558192391708 -0.29806226005196551 -2.2164037125353238 0.76999318549856477 2.8262922849223657 -1.1044900471254566 0.19764498569270558 -0.15426992064366368 0.32764347227324553 0.2866632324690479 -2.5883361331213131 0.47688319483656405 0.52595763956013963 -1.3977275646532337;1.1609012861573749 -1.0127586582097516 -0.0017453994627038769 3.4739254383766607 0.44345165431767719 1.5675350448311904 -0.5436983188713822 -0.71710308853471616 0.64858242181817682 0.99212500421848981 0.41434351670156883 0.40762075247392765 1.2019010090078277 2.8551131665714218;-0.051679893774894334 0.54206553113906275 0.93330699362112035 0.15068398930557456 -0.17960309747272057 -1.0367622594778387 0.27591026161270721 -0.90162428097386627 -1.0620777357356632 -0.74935605640135539 -0.53748640606941434 -0.37068843848765914 -0.99256590285922897 0.18721391396972409];

% Layer 3
b3 = -0.25996300303350939;
LW3_2 = [-1.594231382710152 0.70950046457462168 2.6422297838659006 -0.72948902825057449 -1.1727283119907526 1.1248324886342442 -1.8447651420869762 2.4701799814249434 0.97615938241887334 -0.59011275043955969 1.581720780024209 -1.1280627481821686 2.1555471941936042 2.7002706246861923];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
