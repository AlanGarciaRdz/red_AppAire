function [Y,Xf,Af] = SOXLasPintas3(X,~,~)
%SOXLASPINTAS3 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:44.
% 
% [Y] = SOXLasPintas3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 13xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.0179856115107914;95.2380952380952;0.0558659217877095;0.00576368876080692;0.212765957446809;166.666666666667;45.4545454545455;29.8507462686567;24.390243902439];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.8256875763507043;1.7954056776115941;1.1016786713810218;-1.246298486697015;-1.198895888941087;0.33013711178237326;-0.18095886250978993;0.075198439168459086;-0.90260151228898455;0.7076119400233023;2.1284776113900756;-1.986695494119088];
IW1_1 = [-0.82308865182019708 -0.0095203589892848533 -1.1805224796038507 2.6340700143497102 0.53368326892919882 3.0660510188022361 0.66397351612057753 0.2963410882164495 -0.72556600724956466 0.24183857500185171 0.79616110822859043 -1.7075427546863606 1.5312406499334983;-0.54716831615168871 -0.2268107603075647 -0.43089723336709762 -0.64660345727326118 -0.30384358542765538 -0.078930530393095 -0.5257455899860457 0.03902610260969569 -0.34316587742871835 -0.66389087426531168 -1.0404795324760923 -0.18948199214830036 0.0016495068503224386;0.1694514237509322 -0.19399927009294946 -0.048760542148175379 0.7777751467641254 0.30692766851059272 -0.47036672230675286 -0.53962850854655153 -0.050042662728090229 -0.26002896460070413 -0.39541295274890742 -0.36146777211325165 -0.27020273699319203 -0.32605355924944035;2.9658088029225667 1.3283906889532842 -0.94243620744844891 -1.0843280303623855 2.4859692950178007 -0.66907316456192445 0.094212818807508383 0.83341459120864625 0.2669448713147255 0.53515366140890841 1.117859765518199 -0.74992763927426409 -0.33118585289335162;2.456348427372546 0.24336354959145515 -1.0206832204621226 0.32753819961234665 -0.7026267746795114 -0.29919194744978816 -0.09557885526641835 -0.070962108963496376 -0.38957068437482012 -0.82494058197137599 0.25489406095461364 0.035536193060140116 1.8650198956772643;0.91094848713417198 -0.98253277874092737 -0.82181414414669773 -1.2039342913017153 0.37264708645750816 0.74834949516976534 -0.30668157098769144 0.308314243667481 1.2352094454967057 -0.48601511156066057 -0.18073280050113666 -0.57683149142459467 0.68950604024201823;2.8785989678654578 -0.011566576599092642 -0.30961834202992145 -1.3192034148467482 -0.69525883582933556 2.4875602075287979 -1.3818409755484826 0.51265054182066827 1.3563955346991681 -0.54400467995251445 0.011069741170878541 -0.39738413299443204 0.17289336347093048;0.58861363318194349 0.3144774652308458 0.44573699493935143 0.36283971149725353 0.080603859800521691 0.84117497144570108 0.01085812498693781 -0.0053627957493028421 0.27922525171291712 -0.25608176703410035 0.055486562723325396 0.85363679522093205 0.35667200020963419;-0.25351492454161534 -0.55430264660307194 0.18764118395152971 -0.31508726996123954 0.18341972553756053 0.15053816259687061 -0.12093039360768645 -0.44406681437538387 0.35098545002682197 0.72132918040313332 0.16451836412361087 0.61721878361304106 -0.33536253584411252;3.5693393386594789 -0.056502777278081034 0.84256188662025489 1.3468809792119334 -0.37740031229386445 -0.16710458472375933 -1.6648612036858697 0.72410464104562045 0.37270006501378461 0.89906164241031261 -1.4117194549666208 0.68657164838146423 -1.0211664408729901;0.53444030676018128 -0.24652606426409013 1.2095201689146629 -0.12287995889955595 -1.390892715801997 -1.689458439964417 -0.018408875629406921 0.78139350929910589 1.3285896540751294 -2.0191465949695835 0.070778307383349365 -0.28599147240350897 -0.093148841190993634;-1.6391914506983747 -0.99925170607764469 -0.73169465182459204 0.22735940787554898 -0.82499613423594176 2.4395177602993914 -0.12873808088992428 -0.42320303277512583 0.94065731772896954 0.94942309176958073 -0.64220769317515458 -1.3312126938550299 -1.8299215617348805];

% Layer 2
b2 = [-2.1304506612116416;1.1707109917649938;1.3265290338817308;0.92143710045441529;-0.44449474394838001;-0.53729118305220669;-0.23187668204880946;0.10641089874450771;-0.59235593082726112;-1.5717543506114826;-1.016659396665949;1.5253150894113303];
LW2_1 = [0.093050805733621317 -0.074121029041173847 -0.6136156802345234 0.4575540489630236 1.5378696848374935 1.1789429143827963 -1.0933414130148851 0.97194705676010029 0.49512687022686375 -0.15808081534524226 -0.38483893954791382 -1.6909307285243569;0.22767907881182084 -0.44659768157598134 0.56885189443382211 -1.1271951661488486 -1.1722238654607768 0.73166827211365704 -1.825035523708709 0.14856781227485594 0.74122089428485827 1.1067910938013537 -0.38496031963181893 -1.5550320781300657;-0.69068781509082122 0.19978195579978555 -0.31157073200567048 0.28928225984983957 -0.99766021160328999 0.2045804760337786 -0.57454946709778043 0.37024886100945159 -0.56079191808130124 -0.0083195540686525488 0.78344345273803051 0.090890800553564619;-0.0047215097439836564 -0.68164268718054966 0.074974927617486919 -0.39525016311360067 0.046248015376317557 0.58159186913066674 -0.41133983887317005 0.05120563850211092 -0.98813396666906872 0.45783808199792253 0.55733362043146828 -0.41849181595333973;0.16897903191473909 0.85482558636771733 0.22774851642117802 -0.6965540739854964 0.1746537587690922 0.17542841785635827 -0.089575379436678537 -0.6694359270265684 -0.28765175734879783 0.22100942571904733 -0.43843943311869332 -1.1912609048081331;0.37287358745881971 -0.26037200052549991 -0.87413853521009122 0.25706787036592638 0.045651493816882646 -0.64369751030673561 1.7069852787021238 -0.25295782073232731 -0.02230510126491398 0.18342175308678416 0.38664277673058423 1.0966502667085083;-0.48530723664210063 -0.10619503483843884 -0.56568807870951532 -0.34109702647025064 0.53227027795315318 -0.32030940192285068 0.71302642452888187 0.050043732984463379 0.92397028118076818 -0.44651431864605151 0.68058741147908408 1.1774881972644744;-0.029252628253473467 -0.35610368350165417 -0.62532259812087854 1.2096649278808624 0.36775022902104815 -0.14769924851199304 0.174567565230004 -0.22777346769684076 -0.30665025381079652 -0.31316213631867018 0.32451731200678358 1.3116931808446184;5.253975866205054 -1.9072287783152475 -1.1049241640253959 4.0127448084580459 -1.4367728785163369 0.85899732417958219 -1.5789599026577097 1.2079517332190355 1.4587427395040573 -3.8380915027789597 -3.6989261558687501 -0.48163135533180118;-0.36033167941978639 0.30034765730384005 0.48128609954121127 0.58288194658035175 1.2096640257510203 -0.99314074096591265 1.6526317390729435 -0.38691787368893149 0.32478053369168886 -0.50733308967860413 -0.15341313962982414 0.55996885029416577;-0.03383329734346513 0.038059358865749029 -0.49354883257164961 -1.6874760732102112 -0.63489192184188092 0.32780481545819912 -0.51320289622764215 -0.5905611452081363 0.17206769917146528 0.29730649690231431 0.4426533044883077 -1.2240435994243799;-0.090530875682728107 -0.89314971335610782 0.18905776845883432 0.14723105537693798 -0.63339733017039823 1.2385627454798869 -1.4729422644866181 0.77443513017756405 -0.6721098921272276 -0.56108542658619553 0.28043121510112073 -0.76422012631516689];

% Layer 3
b3 = 1.5415416311669503;
LW3_2 = [1.2546101955325282 -1.3927625064081057 1.4113174584502655 0.42792394905587006 -1.3486736276280307 -1.1597364366395373 -0.48827761816023207 -0.88425308996167562 2.8293702695941341 -1.4787330445745759 -0.2909783689840848 -1.2327710821344404];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
