function [Y,Xf,Af] = NOXLasPintas15(X,~,~)
%NOXLASPINTAS15 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:48.
% 
% [Y] = NOXLasPintas15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.96825396825397;18.6915887850467;0.0175284837861525;0.0546448087431694;0.00640204865556978;0.138888888888889];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.2756422717358853;1.9648446442977743;-2.1659763604295583;-0.58234841348685362;-0.91814399879405295;-1.7024999805726229;-2.5557939405688503;0.058283916665470677;-1.2673568272516682;-2.3679799264885975;-0.11050245395848424;0.43016355529587236;0.55664695847182377;2.0311267277753062];
IW1_1 = [-1.4361760248858131 0.082718169118784532 -0.92409314134506271 -0.7213592033741737 -0.34227769651594553 3.8909592175013876 -0.069414818242340678 -1.4622466141290185;-2.5020414019031239 1.6407618454972985 -0.59201960608496418 0.20689532849324849 -0.93911182070183752 0.90014752790892105 0.7586105974366063 -1.4135013373202316;0.023139786135090705 4.1952467659619561 -0.14552925667159813 -0.023383987772839343 -0.7717482222003077 -0.029949622491760936 -0.061057915077452861 -0.014661955573412194;0.36290195480576687 -2.8556189823783056 0.088810959940480341 0.60948450633127993 0.26707119918229105 2.3110259185704072 -0.056811750537587344 0.093017832545277609;1.0878271755770741 -2.2373761470642402 -0.78655571559904147 0.72983993326216057 -0.77172012432091575 -0.13659167618437773 -1.2875579933412657 -0.26007641918266172;1.8814496678476107 -0.51043619894707071 -0.38223624133990175 -0.34844371539660368 -1.4839958166334284 -1.394540351381472 2.1204284954029404 0.9514322822788347;3.4188698776101969 -0.31495805761051887 0.036011814908898085 -0.8533730930320963 0.93200068550043358 3.2006850731004781 -2.0860600916338154 0.68013564996870335;-1.5768983056542563 0.69899290757117516 0.47209664877860774 0.38198800120430809 -2.0295791342646625 -1.7114371354248823 -0.3269430466670723 0.23579816081734203;-0.44621002335010973 1.4111824864727129 0.21632899636927466 -1.1615008357887708 0.27248395990246349 0.63893807108158729 -0.61441847889732792 0.58611939835453253;0.32046560451543277 0.26535264841714984 0.36680579848752271 0.99420807771216324 -1.3720894714487906 2.3711576703439556 0.62981875401199527 0.42607144086480764;-0.43434689209339444 0.29350340738443204 0.48783968583571435 0.65121195563809209 -1.209805993403783 -0.93959391692443683 -0.1034756412818154 0.23568372412564192;-0.36539049661791889 -2.0227476128065147 -0.32470055432387174 -0.19124593912630591 -0.43796486238649118 0.32038195182210949 0.060449154441066764 -0.10659940291310332;1.3304914549883438 0.065364137737179945 -0.0061257369947722504 -0.52519261063758294 -0.38132978407155249 1.7370104440082286 0.5243300286212641 -0.75835070540245386;0.77740406509755977 0.032594176496185429 -0.87584376590715673 -1.3299607015741741 -0.27659266958410644 -0.87180662162688438 0.020495836262455089 -0.48176387951725008];

% Layer 2
b2 = [-1.2743122917164571;1.7450737995754118;1.7220697754316463;1.2346235862541897;0.35736653894972176;0.7629187851128274;0.040548142424900485;-1.1626782373245905;-0.27268641213807021;0.26524183440380278;1.0375084136218098;1.1109042815186629;-1.3561981801301408;-1.7914763282280501];
LW2_1 = [0.50819328530942121 1.7353271029848691 0.51115503819311758 0.35085001195184851 0.49126833012060589 -0.62523271212470388 0.4621303666063481 -0.47299115609476411 -0.44688560012406553 -0.19118922739737448 0.723494076234246 -0.80676806235817478 -0.31270416257124373 0.81861229949888104;-0.53081358088812025 -0.20547489423220527 -1.2450022436182691 1.3134027009362579 0.29172380900277073 -0.32607586969854524 0.11783168809951629 -0.80972364951807585 1.1111694044690972 0.59469325995257483 0.86329584905234058 0.61638708581281021 1.7528707503180203 0.86896859764432732;-0.47344857508310956 -0.2097063580182344 -0.040730297335334682 0.67650567626517233 -0.38004914822685759 1.1672760457980764 -0.21766735216309552 0.61860428048137373 -0.10579180139264821 0.0098450186414440338 -0.33170522740822117 -0.40294434329867396 -0.30576087434266047 0.57375281324149419;-0.77535082424591728 0.84086546934873918 -0.89504955736351965 1.926037289520466 -0.80181217519767556 -1.2552536562301044 -0.096171642373246866 -1.1312081327836003 0.58189953441468822 -2.0922525859127403 0.83149935503010286 -0.89030946635144237 -1.9142072307021591 1.7504136310037031;-0.88741566213935874 -0.25465441619884299 2.0547726577434342 -0.62820258445972654 -0.35338471668673438 1.152846099418386 -0.11391628524088332 -0.017106855451390818 -0.30985982072082174 1.7958605135804158 -0.9153792933331194 3.1996589767971795 -0.80575323444183244 -0.62178598354819947;0.19839620843153741 -0.85104387985053676 0.99060702709843795 -0.19519943787210198 0.63832766385278961 -0.76185293282579325 -0.74643764892300257 -0.43256265140038014 0.61082465128787022 1.2528463873150542 -0.73203178950374748 -0.92832192038913686 0.13402430970082216 -0.27010736078244213;-0.050706681166553857 -1.1561825731984476 -0.4795593473743674 1.0848939558567137 -0.5476126673823567 1.1450801661707422 0.48215980706876177 0.14177642136930629 0.38790138428221355 -0.39418621974475193 0.012158378070935718 -0.81886323718922749 0.26830055205148462 0.062650334989339307;-1.6107123247895476 -0.4855371579295768 0.93844998462926432 -1.4979903916932367 1.0118604048596802 0.34736144708787164 -0.40459190606570805 -1.0179853403986814 0.27929646128917951 1.5736144450748561 1.439277841513835 0.8751132314875445 2.6172449369081541 0.21141712701004131;0.043144711411491177 0.32841299015912928 1.0367748429236863 0.3559215017329681 0.5554043663804521 -0.13668090947261333 0.20240319139899768 -0.42160354727406113 -0.91451883845359516 -0.085104031932929619 1.5653961834338614 2.4006406117142904 -0.54989362720415969 -0.6397934843255928;-0.28958125911352411 -0.098936859748352327 1.1789065085973069 0.1405384819103436 0.17443636220129119 0.36723767486136499 -0.20204258921088628 -0.096991497195283632 -0.060981310294804345 -0.50205534624607306 -0.49925084445606982 -0.9737961056108243 -0.13552413975170677 0.34602576402429563;0.67680503489735888 -0.47784611344227684 -0.23097466715612242 -1.0972165511404219 0.16983910464279883 -0.42527184851868505 0.13674077820580038 -0.52145990067940906 -1.8524884671442812 -1.8712596079856523 -0.79317078126229645 -0.45516844510314891 -0.87298656615405434 0.32850807424355516;1.3481518134314165 -0.37545944866767406 -1.2207574854623084 0.097386338635242653 -0.51397547317668968 0.33675716385526738 -0.1057095150475655 0.68070918505491596 0.29799615041855082 0.74250107162560197 -0.6635142677708552 -0.93152392152127506 0.21105919421483982 -0.19955290273631612;-0.26273552450187848 0.19682296955342565 -0.44490498911185528 0.5576353084076574 0.55644969819833778 1.3649576625465794 -0.3550462364121218 -0.18271887358248737 0.21464398568994605 0.76461521592315573 0.27285874418731565 -0.42361406164706417 0.57966498465925942 -0.046254717781916727;-0.74533921471618581 -0.5070784210246686 -0.063230861358881479 -0.68267735854435807 -0.29135385567183347 -0.10927016758241771 -0.9068880329136827 -0.91629993547672195 0.38682558671306855 -0.40788788131287929 0.2511494182673879 0.24445277819906774 -0.94649474072554241 -0.45030544398852423];

% Layer 3
b3 = 0.54953375012941086;
LW3_2 = [-0.37660093091077157 -0.20486526788303808 -0.40772594856261923 2.8913250903230949 1.8284714999542879 -0.59048519778795749 -0.32942770645821312 2.9578946144594949 0.33287693780403332 0.73842110758550261 -1.2521704055440308 0.94359070087340657 -0.54809546282469201 -0.54964562870823563];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
