function [Y,Xf,Af] = COAtemajac22(X,~,~)
%COATEMAJAC22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:27.
% 
% [Y] = COAtemajac22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.201288244766506;9.52380952380952;0.00968992248062015;0.0210748155953635;166.666666666667;0.0561797752808989;0.00614628149969269;0.0213447171824973];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.6944527548194925;3.2183892618989738;0.2359437936959482;1.942552737267407;1.6156665321470409;-0.76446831930942305;-1.1437524175704834;2.5866397593861139;-0.44544640460442075;-1.2846463612000814;-2.9199744831004786];
IW1_1 = [-0.76682692242921136 -1.1447077777447232 -3.2902413219440629 -2.2640334939990594 1.4205319721770726 2.2366514506966095 0.27049950301798198 1.1902796105074192 -0.2476868575681922 -0.11670089206442671;-1.9185062693199895 -1.201080112192225 -1.3504117042293857 -1.3689737186519708 -0.27189544230213469 1.6118748189154251 -0.0039286802216677366 -1.2972478184816481 -0.41644528178883428 -0.49722024307056129;-0.44479270381394842 2.0309166747917282 0.30067868035889544 0.448059040602102 0.057280924009830182 -0.81322864342077261 0.048061093135897674 -0.90192577902962034 0.013791319837687176 -0.43778912082611066;-1.0579029696839992 -0.7467756973029871 -0.49066340376764844 0.3551970837719331 -0.11608475084567565 0.11091071245269205 0.0042830564203379488 -0.26927469292145845 0.010645732025055985 -0.03174285637304352;-2.0980285999777366 3.0685860889181189 -1.0835828265862075 -1.1443307088462906 0.36137085679333347 -0.36985690834065393 -0.4099759901964577 1.3446037820936618 0.11393664267001152 -0.15816992423744955;0.31906129117138499 -1.4279078918973838 0.59928366133573963 0.0047657840483756528 0.28929869656422247 -2.5599845626405084 -0.35493025419273055 -2.7335915835322182 -0.098922557146352924 -0.58571516090563203;-0.33331486419229911 2.4462646103701937 0.42200695174488889 0.82456386258837855 -0.057424452275222936 -0.22391720105481527 -0.078305188215866045 -0.6171654883277401 -0.08085257510848945 -0.071075651154473438;3.0109640717176096 -0.068337426082403646 -0.21874814674957824 0.58631926977105586 -0.21886342366203657 0.21855811545236983 0.20552631662371088 1.818139294144701 0.33048561325956755 -0.75693248845853867;0.2243448215630679 3.9027525349071159 -1.2141103773995918 -0.38840177084960092 0.05596481124207478 -0.0024368483336837977 -0.017796006299197569 0.39499256030874491 -0.059080717848168492 0.49488660941477908;-0.5164252747290351 -1.645543505512896 -0.36532040151250855 0.57291196478143891 -0.07077758714247083 0.82851637841965609 0.42455547325456311 0.091491052566042147 -0.0085067280825609354 -0.17445130993276547;-2.3106121971685414 -0.40061623963905313 0.57015399886690898 0.87031287049070116 0.30272724135341339 -2.0792096485325247 -1.0888351387020434 0.36591246523387183 -0.22469031365979172 0.20197429864701835];

% Layer 2
b2 = [1.8923648164319686;-0.33987069231969291;-1.0408756113789785;-0.76585661968256424;0.63118619330609482;0.96716749965779392;1.4631858479920661;0.16716436972002632;-0.66210489574023845;-1.4109589079380918;1.7519054892152361];
LW2_1 = [2.6170026641614696 1.3811616989427893 1.338838091931797 -3.3664597350314893 -1.3076031638923082 -0.4692782320669121 0.59243813440264748 0.65880306412685707 0.75769621665841635 0.4107801870618204 0.47868477378351171;0.046852308508702256 0.80799992563504253 0.97311090028389802 -0.51553822348396072 -1.1434713317252752 -0.77640201357368643 -0.71971890641723646 -0.67474638479830862 0.009547027245880366 -0.020200731131846842 -0.57266767572469757;-0.58117979701556632 0.21348530320647163 -1.3240881233734392 1.9087946004606051 -0.01676384736149425 -0.86658090974545143 0.80004185924110238 -0.06141210767235368 1.5095184575744609 -0.064907614051392309 0.59663646225556144;-2.8810845180028437 0.046509217322223774 -1.1648682471292593 0.97981398706919387 1.3368139963538663 0.68713825165899212 -2.5435532680531443 -0.69905301053134383 -1.1406061184481588 -0.17530007335889983 0.013329994084613848;1.0987876033329664 -2.4689160599614022 -0.99782457852875972 0.94226791897949025 0.65573090692656133 0.58829776810252998 0.76139091766396116 0.61095128185222747 -0.15066268612530787 -0.11125080794656243 0.44008049398844451;-0.30176369672610276 0.80673837186200947 -2.0747511461010886 -1.7318614528136977 0.15975867515211034 0.44004097393130576 2.0675608380572568 -0.7457420630603202 -0.52667776159747992 -0.83358304861215105 -1.0408511715116358;-1.3685098261433815 1.8220490859488061 -2.3686327451608213 2.0995565160017251 0.15686340224395437 1.2004000763938598 1.8757370706011036 0.47402263045719967 0.71904101392202946 -0.61994531653171336 -0.25636162273810842;0.39022890796468929 -0.14859793116291337 0.77821302093781586 0.74712473614980834 -0.72076455796745398 0.73411855420655503 -0.23560560968948593 -0.44922820503502248 0.54885859884271304 0.65938849562933843 0.41094148214815124;-0.74461855498187135 1.6585503049822921 0.7525111624859987 0.090737626375810343 -0.51216900272890609 0.53219406368049238 -0.35134625568396149 -0.32527953398029569 0.49374288821828433 0.43891706514512385 0.25967156107877232;-0.58159398060819956 -0.36773503248178502 0.11191501679057821 -0.81119517186294565 -0.36310453380025887 0.71152779996154791 0.65980306751181073 -0.18792347135122034 0.041600218560299322 0.52332703991027307 0.72316942685274344;-0.72175548634830267 0.27357156192927512 0.6646146563540839 3.6725623306956066 -0.00016288832728073716 0.25736955139733642 1.6538331100050128 1.329964641472611 -0.044465981668363838 0.78455092869104448 1.3511766708117448];

% Layer 3
b3 = -0.9880504008253167;
LW3_2 = [0.7054106906575468 -1.6277519514721739 -0.091647867414621262 0.5189062836591638 -2.2222056529484289 0.41481145417857862 -1.5764933959826339 1.4354164019068838 -2.2048507320921047 0.70798303120661399 1.8932701451990417];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.201288244766506;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
