function [Y,Xf,Af] = NOXLasPintas22(X,~,~)
%NOXLASPINTAS22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:49.
% 
% [Y] = NOXLasPintas22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;3.96825396825397;18.6915887850467;0.0175284837861525;0.0546448087431694;0.00640204865556978;0.138888888888889];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.1220609094837797;-2.2222402686375728;1.4823678870318646;0.95092307216612149;-0.42591900745502648;-0.73580092255697438;0.62909978978578596;0.077964377025919546;0.039565797980125106;-1.1111561986532943;0.57552123195314353;1.8384598014416771;0.9114102011048576;1.1220455522938051;-2.3415081219105933];
IW1_1 = [-0.54436853607499136 -2.0154714666850699 -0.28113721031087102 -0.9823911837588245 -0.38569655419572568 -0.063455023350055526 0.23270857837258963 -0.0069772853398961943;1.0020727440173747 -1.6553347970731374 0.21546013762215249 0.094179356255656321 0.93475171992937967 -0.24721415162752292 -0.4342959471552445 -0.45737541022058509;-1.6181473010892937 -0.68745603902840802 0.32911954291776224 -1.068475504196849 -0.3708722412583268 1.0184730874732184 0.053566250469135823 -0.033212072455907397;0.63327951561266194 -1.724315575511971 -0.022017601740431901 1.8668564539001049 -1.1278742917230389 0.25527803249000836 -0.29587875263525959 -0.49682597509924875;0.91234953626339887 -1.2310787166991684 -0.84537413058038446 -0.9101807924476597 1.0440776120170063 1.0637978559085399 -0.78083463007676834 -0.23068663958076319;-0.86946704488148319 -1.8387568730488408 -0.81824122339506999 1.1903312888968152 -2.5788957497754801 -1.3491069657954236 0.43885606251559989 -0.22583843598097852;-1.2073476577584754 0.21612743881910335 0.13371095781746026 0.034560406581013746 -0.48920197425795742 0.049274918951933519 0.40384479699991094 0.21016670452513914;-1.490156816323511 0.64995878203098489 0.49969604306474052 -0.10720460714940461 -1.605804872662222 -2.1192153596773173 0.13086340771722338 0.049073971926104687;2.491314553237483 -0.57525624382691587 -1.8841484422904697 -0.49435415605797806 -0.47157580623502082 -1.427790064099786 -0.62071547626967771 0.61092792696686848;-1.914842522427697 -1.1183320545757245 1.2310687556573263 0.2169617787636248 0.65195738830511973 0.92262608094967014 0.22084661951177464 0.14354110571499193;0.8613675986730418 1.1397855344581149 -0.8246090938863605 0.79239540428070987 -0.41323145559818641 -0.41440850186347289 -0.74996640311130425 0.031045237895852382;1.2073596298336711 -0.37220492565635388 -0.63518658692504004 1.3785908729459029 -0.10116958655224428 0.51404021513206011 -0.88922241371874 0.56059594890145925;-0.040225835428022397 5.6670848134828464 -0.10922911833656798 0.065474145091637029 0.71757143376284072 0.06458249117203721 0.1487047571182521 0.67868221301396714;0.41204563444164399 1.9620602793597295 0.17540881217101717 0.80221809863157378 -0.93206918584064258 -0.0092731087551775372 0.57616512752240912 -0.35053490263847914;-1.1264161009137663 0.80481493114316283 -0.11627023997031839 0.049750992657627266 -0.30479055195514659 -0.88180453155796013 -1.5683331045970004 0.27064662823239422];

% Layer 2
b2 = [-1.9697687252852327;-1.2038742070102362;1.3861733376819161;0.80139100409590269;-0.36396591205974288;-0.33150045313551146;-0.1884589809644146;-0.36196999756817738;0.90933444167325073;-1.1851257045323931;-1.9016919477882068;-1.04060568240092;1.7488056986946992;1.8960828450655296;-1.6102324226164177];
LW2_1 = [0.14983490298952132 -0.22661922646110039 -0.23479092971169616 0.74242730822465697 -0.11075649117586782 -0.035770833259065174 -0.19348900921472223 -0.16670457446625125 -1.4810434371732402 -0.59396104990223209 -0.84987430034542333 0.64403708191817044 -1.2600095172730705 0.34034199980199092 0.39611233277662961;0.21292629962587095 0.00059469493592331519 0.55055956157900554 0.11708969046139259 -0.60968607367781114 -0.50685309001072731 -0.60581686415546099 1.2597159753162521 0.66165917337406255 0.39308681683160351 0.27089405583588083 0.63021745862950851 -0.71579107837451306 -0.44291324513074387 -0.012592211983632938;-0.49806871411918807 -0.58247551494503402 0.083967486195177549 -0.19393169428618515 0.04177544470361199 1.0466238874486884 0.2600954924745052 -2.1723022116867905 0.21505906087508189 0.031327529759644146 -0.26171611856105809 0.24965335070106534 1.6829879091869571 0.87313543303140551 -1.2769216183491205;-0.8001606857574326 0.31405986203718039 0.4469431287838847 1.0055278892121942 0.56917947786766621 0.74994740059452192 -0.31350184299312456 -0.28770685918036321 -0.24982114502855321 0.82594798726265706 -1.6951836515685732 1.0857797705849559 -0.66078610362418011 -1.5588544314799164 0.007176629799249476;0.30358013562265512 -0.38685627199766914 -0.42486118774830384 -0.14533216867114077 -0.99797494516935115 -0.60817445196186271 -0.77335278480748515 1.4458133410182274 -0.52323228768105035 -0.16709617437306096 -0.87864792977676731 1.5415292195409476 0.066703471232108069 -0.60655075927284907 0.030386901131772226;1.1773250395705939 0.10651512214797598 0.25273730138462547 0.60202480027912098 0.54125364593313074 -0.092202478129025336 -0.62674993116977817 -0.5756046235250416 0.1947155998112424 0.33135607731250294 -0.052085658140559626 0.040374793854380531 0.90390236228587362 0.4347263384759637 1.3623011390356174;-0.11975848183905589 0.010831393178359655 0.12495089920399388 -0.6613990546760885 -0.75089348750321927 0.85330671843855554 -1.0873383537876919 0.35346929306598884 0.33482776225268751 -0.65759417913777574 0.30487180681058662 -0.47307644036357061 -0.42520396110058178 1.1970341735812862 0.74436517904774069;-0.0055593162796791218 -1.2808155837171518 0.13155755982544209 0.0020451094987339229 -0.72414186430033889 0.21117590233925135 -0.119554905678654 -1.2847772180212143 0.56127212440809371 -1.0097882045310131 -0.56545310939787918 -0.85333427761835823 0.35289769488178591 -0.12012732927114597 -1.5910136854000012;0.94227409844132826 -1.2330039138069011 0.80152287531245459 0.23576110923367175 0.62212356053977935 0.44027023439440338 -0.74135055470794731 -0.63222407450667917 0.022131654797806051 0.85187902095702339 0.34964328062714278 0.65424476964330991 -0.48210744603024935 0.36491103143275572 -0.60209854013284003;0.43759552367401006 -1.1739743187052467 0.45961485181637496 0.5536484066978159 0.75321633871804095 -0.1144629928209696 -0.13959687085281122 1.0443988604470036 0.45737052406126422 -1.0891107293489741 -0.66718933539551073 -0.1593395531388653 1.3054204251470727 -1.0232295808717875 -0.28066068398412192;-0.12390777481570633 -1.3010679467895683 -0.13763476180068199 0.70123869779836911 1.0057079470626291 -0.98782072351344596 1.2786732828586267 0.062988529382627487 -0.23982613792708549 -0.056797063531301581 -0.56078807237103945 0.5186546583709496 1.0419142640655754 -1.9970887163401227 -1.3484592286999302;-0.13801584186902743 -0.017883038731141963 0.042524284657680114 0.050856787469800144 -0.56091258922773235 -0.096070478031024503 -0.020838405506999988 0.058861853979290633 0.69821016247360979 -0.12164700448229729 -0.84507699307014494 0.08016131080176149 -0.13059263677185498 -0.12349544536252356 -0.28948818335761711;0.2219756941708515 0.28329890307534777 -0.87377389904881175 0.014737393398519375 -0.2410332152655546 0.2267168407981304 0.23279026091234686 -0.72525524564155275 -0.9085030880902929 -0.012181821459018128 0.30570634599465502 0.0010793436581128333 0.55071895432596618 0.20096100152954041 -0.47632302510035973;0.31739971414339307 0.45231820032460612 0.10800839425801495 0.44393860072488217 -1.3237137076187995 -0.39204003171628216 0.33669740244599949 -0.60753390793215056 -1.0904212756513121 -0.63884348458030016 0.46563983333109721 0.37696284719835887 -0.72372729859609064 -0.2086968541552757 -0.51710659237180989;-0.81164141935605971 -0.73741579021919579 0.12939065322238824 -0.48450766180282479 0.029933046228991497 -0.13937193903787912 -0.32944424968748065 -0.16983020012827416 -0.61470229935891496 -0.36936433012494951 -0.60153791360303899 -0.80972814367007995 0.62196832678226732 -0.18307080589517544 0.39888610087918214];

% Layer 3
b3 = -0.45201671466252114;
LW3_2 = [-0.55899585411261277 1.1927478049955174 -0.34104516672799473 -0.60130695315773741 -0.67646949485524954 -0.92298252065700204 -1.4114127306986064 -0.53452768281321683 -1.2440021588156713 1.5870819778883858 -1.0885571608801934 1.3778236012803082 1.8397291017607249 -1.1177443483862106 -0.58065821864753553];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
