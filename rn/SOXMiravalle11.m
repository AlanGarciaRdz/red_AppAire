function [Y,Xf,Af] = SOXMiravalle11(X,~,~)
%SOXMIRAVALLE11 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:29:36.
% 
% [Y] = SOXMiravalle11(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 10xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.0208986415882968;90.9090909090909;0.056980056980057;0.0063552589768033;166.666666666667;45.4545454545455;117.647058823529;29.8507462686567];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.1266222104761789;2.7064208001431531;-0.66409475685207431;-0.28643182369320885;-2.6575065323379805;-1.432976741944624;-0.25968192128630785;-0.076316082723239947;1.0199292021031621;-0.30902678873933614;0.70323826914619403;2.7472582521661875;1.544654912381785;0.92390512643154254;-3.7848175740682759];
IW1_1 = [-0.28999580421899146 -0.096952268647860856 0.16442262351363809 -0.48450063925503228 -0.39471522451865854 -0.63879683482028926 -0.16605982413747819 -0.28160681554397621 -1.0102898001769796 -1.3677722874993732;-5.1384691637400639 -0.024791968740040277 0.89903796186127971 0.08854444333426606 1.8079152607886924 0.1329285458410342 1.2772614496048431 -1.6688491683439872 -0.38705529605161465 0.53888765619738943;5.6740908044537459 0.11819299496398195 -1.5016588313666706 -0.026819327719591432 1.2491367445965429 -0.13941964068607171 0.47302106508493513 -0.55359172235074983 -0.099516366959595412 0.012202105061807758;1.839591019634794 1.5061891162338559 0.25056822506698767 1.1993261466284135 -0.85591923530267966 0.55482452616915667 -0.75684994905664871 0.28598609621058807 -0.2781084434943823 1.0335353312019682;0.033318728553678748 -0.32011523389556096 2.4226954506487708 0.39700624676741225 1.0177426213792793 0.094454660515311553 -1.1454926860689751 -0.44118561344448426 -0.65940428172402588 0.68403450709168812;0.90051171489628545 -0.16455679005397936 -0.76902199396896698 1.0617592872087718 -0.5240588108571842 0.61054306634163125 -0.52421239789298446 -1.1646411742430745 0.23748459494262955 -0.60117339741635234;0.022710091898339675 0.014621734241219441 0.87985972090390774 -2.1786929001778703 1.1504244411558184 0.33295862836463275 -0.41853711308310199 1.3206986553304634 0.52646765909340243 0.18002014988337917;0.086258357997958029 0.18853578057067308 1.4193724221043251 -1.9053821284935379 1.1322879427034434 -0.67136752211296757 -1.834648165355742 1.5364309669858931 0.56740717260357576 0.63070529405617048;0.31916732910027384 -0.29096868654551761 -2.8273345003014954 -1.5179702223443683 1.5978375483147118 1.372923909681534 0.83128859976298597 -0.70672743409139327 -0.84766172513122795 -1.0752082559995366;-3.1685236726732544 -2.1344124919806613 -0.55470715192324616 -2.0373366857109567 1.7417511962999954 -0.7301810960717936 0.3712203398237699 -1.3059896299763345 0.90982937452071311 -0.44315811105541059;-2.1200164944350015 -0.024420821970024792 -0.50591304572447471 1.2551681382295552 -0.13603287039806738 0.63953217274243379 -1.5940683929433217 1.4211353369177622 0.21699986686028144 -0.15540135026176669;1.7374291048532775 -0.13955882544845288 -1.4326690809624962 2.4571643917352843 -1.3059460335613715 0.6230272313302947 -0.54992046228919389 0.62171663531382215 -0.69507829447567671 0.074996738023025367;0.67103667279244272 -0.066159402562880859 -0.21040762866885215 -0.43728127924529203 0.11943229947139711 0.01648360933696532 -0.22179596263305532 -0.88199587214340369 0.16727732900041956 -1.1152783619924751;1.4211647643799914 0.066998490037544101 -0.36349786703533726 -0.51096023259737033 -1.8227408639506311 -0.79725036002863925 1.0230929944098959 0.69330317880916481 -0.43792839157070695 0.21907168688502338;-6.0033457612172167 0.11120359053856962 -0.18144965362245602 -2.2496573132973028 -0.86976219247169873 -0.35030599319749534 0.4178756706102742 -1.9602599332234849 0.47802178332672535 1.4107781971009181];

% Layer 2
b2 = [2.0909510382094583;2.1499427364397645;0.62677206983749267;0.005529764258457158;1.5560675916719802;-0.17359291735352123;-0.64030229590535637;-0.50698160744384702;0.55870251074189614;-0.63626567553597957;1.1736315981903231;-1.005482868454052;1.4076155021581862;-1.3152140521375426;1.8921449438558957];
LW2_1 = [0.13812753249124698 0.45905939178749877 -0.88535771240601369 -1.3410022225483749 0.48648740912518262 -0.21861743297053093 -0.18121697182003321 0.16999198246678185 0.45387451550911034 1.0575806300802431 0.38217572332365563 -0.49143569981124352 0.41021649764014828 -0.042778173326405433 -0.20135880820968066;0.48875598960029121 0.11603308199115946 -1.4139256032836041 0.010441437852704016 -0.18190534173405337 -1.0098523708232559 0.036223016228607727 -0.18338251025579097 0.35460773904759391 1.8997072767928644 0.6346984639629748 -0.49593150877836023 0.98935798787967166 -0.034817042868730289 -0.43360347534497917;-0.85100388820858675 -0.37822734329690944 -1.0420209267367653 -0.77769371655423514 -1.1820657573234821 -1.9291362039324673 -0.63607694136928339 -1.5386018503594612 -1.0383129184811317 0.44247794074535246 0.80972921356323646 -1.1215452806717061 -0.96475816685279114 -1.5538289403519712 -0.75182827422170995;-1.614934050820958 -2.6937655381179315 1.3236718422046823 0.23743455917002232 1.1083480844841738 0.77790294399175242 0.37166747390294275 -1.4946235929655844 -0.52894763145528179 0.85607935966460114 0.2033067540187608 0.38543913668411622 -1.4847776313518335 0.6002028391197175 -2.9132545130773218;0.53808043093581581 -0.7462385758772252 -1.338409282852671 1.0627778001121189 -1.6247228683599404 -2.0295127409297264 -0.17329730112432273 0.42731533104652836 0.39663947975033959 0.31131441345302718 -0.74997390629124805 0.89190741783707794 0.15151079783041593 -1.1168631753152547 -0.35876283467590148;-0.9398097857045824 0.1176999693473362 0.86537717337800291 -1.028074307925456 0.89144970613197982 0.38682752126370268 -0.069446991058570134 -0.64000841564730915 -0.35446528675834099 -1.0281613748776579 -0.98605614264293218 -0.77702629756424735 -1.4087088418839184 -0.54620673569767886 0.37332735621074697;0.021918894319170087 -0.32791398604025218 -1.0640508771250634 0.61317344156220932 0.20368942324476993 0.51021783312078217 -0.58552791841440277 0.49151952411664007 -0.013369952434214537 0.35387344058344516 0.13416509713116787 -1.647563532206151 -0.68149315222439844 0.11999108534130137 0.039371042735958962;-0.9137841213636545 -2.7064980602955533 3.9844239337335816 0.27751098007214514 1.0701519843062322 0.76782954420575633 0.40285682448964516 -1.5136903894695868 -0.61833909727239578 0.87761838946604642 0.1839295632135268 0.39067296064348456 -0.45704437849171126 0.60964581474599344 0.91772338420155164;0.47840950263845078 1.1262442969033426 0.632814325543685 -1.6241175133306083 0.57912506017114496 -0.1583023304824937 1.0510832884720482 0.96807381993157549 0.28757096631355089 -0.3913396931395654 2.3828744423158006 0.21460728094530285 0.75731910504726685 0.6790573925906439 0.37379232347511754;-0.5134108426463998 -0.49322220953592616 -0.24905115451598162 0.49811113482403341 0.040413804088635652 0.41421750269336344 -0.18162452890725125 0.51836074665696452 -0.37267885130695816 0.14728383794746869 -0.87135019871783781 -0.98664611899077193 -0.048710294332378591 -0.46097249854630895 0.57154607390320222;0.92184327178237746 0.63968081283579836 -0.015015344550624976 -0.90574736627952568 -0.17293360450030698 1.1074293885280448 0.13498651235027243 0.53741262046382521 -0.37775856687389014 -0.33626485286128832 -0.55823212151926749 1.044239252157382 0.21582870990763867 -0.15033415889886825 1.4396070101074452;-0.32643418076008412 -0.89904975114054753 -0.2585346327334172 0.51278078586552323 0.077070303157481507 0.71404868634276697 -0.77047939120946296 -0.2590498252986404 0.88665886089235524 0.31718476403931134 1.9120948989951447 -1.9372471731820751 0.21751825923590576 0.85567780153542472 -1.6174510715326342;0.60586463889910325 0.82642438148965669 0.15113850152957078 -0.31230773420816077 -0.12006213933734386 -0.77693252947291258 0.7962005675620647 0.22430405368219258 -0.91587975479507489 -0.22473697093665507 -1.8765332318288617 1.1147752715165178 -0.029831128174033411 -0.84658521910817486 1.5480510201378261;-0.10894943984256625 -0.77546123672308054 -0.74762331486050859 1.1007997825246794 -0.52717713848709435 0.71168328736827657 -0.77001440258614273 -0.66587843213254183 -0.098863581927707861 -0.13186990734561296 -1.4559197493337754 -0.20172086801312852 -0.38489372594849142 0.072054140885387474 -0.57675263194870374;0.49446648448981728 -0.34827038523968185 -0.89036222678676669 0.864558465089734 -0.68418141607165073 -1.0932681926322787 0.55992788798267712 -0.51779948789673591 -0.49008540629684472 0.91777802714865864 -1.0227507699866583 0.71069143709601013 -0.36704760372795131 -0.99733363901556116 -0.38057474822511095];

% Layer 3
b3 = -0.084003213018986236;
LW3_2 = [-0.19517427905246648 0.36640431452542904 -0.034135586076435707 2.8532503536464278 1.3825921282904143 1.6003216665660409 -0.25120536652557057 -2.8701811546013527 -0.38538291375656181 1.0669603015897544 0.73228705459335885 1.1533274183311468 1.1493831635403253 -0.36074579935972662 -0.74807054746096235];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 35.0877192982456;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
