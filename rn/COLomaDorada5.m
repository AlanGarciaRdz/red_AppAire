function [Y,Xf,Af] = COLomaDorada5(X,~,~)
%COLOMADORADA5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:36.
% 
% [Y] = COLomaDorada5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;17.6991150442478;0.00572573718866304;0.0175284837861525;0.0546448087431694];
x1_step1_ymin = -1;

% Layer 1
b1 = [2.9346767909111309;-3.3330230794387337;-3.6406673578591584;1.2360783668929733;-1.1820588408448294;-2.5910869144618651;-1.8214915806547813;-0.65300172395057432;-3.2623097012406865;-0.65674105554559969;-0.85823995935557384;-5.3385045174239778;-2.3397349610930265;2.3612921436399716];
IW1_1 = [-0.15290686748794569 -1.1854326590884268 -0.25127932914914453 -0.26600172051881854 -0.35800772920149587 2.4218905558338961 0.17578305010975204;4.6939240114824132 -0.20179827934789155 -0.16043696883584704 0.1589468691175438 1.0458885052077704 0.78197922762048877 1.8369760812087066;-0.14257843633367243 -0.90353153072540482 0.011989742739042391 0.56882551287921101 -2.9042426162179589 0.04542436703865891 -2.4404508539203138;-0.51867228250395081 -2.4970619551123439 0.55468832998691187 0.1112351176590011 0.18996743153915019 0.46376540492880119 0.32993958144779706;0.65145515782519448 -2.3632563307760339 -0.37247197760366058 -0.11965122294432795 0.31055075699794366 -0.32892370997144416 -0.68580172859483179;1.8766959557282403 -0.30325152579445896 0.070389300896109175 -0.64088861785731432 0.43845661086278487 0.51018387486801697 -2.4547656549415198;-0.55752828136743893 -2.4942107512596721 -0.36700403951488442 0.16316360782841358 1.2259602676487269 -2.0655058411168219 -2.5991680675915485;-0.10740930396995614 -1.9173428151814649 -0.64364568909415654 -0.84380040889598851 -0.51887667881767263 -0.05575766857864365 -0.91238243338252401;-0.4188472711069835 -4.8076267184475174 0.73681637510559528 0.18581217005844061 -0.43718297922994576 0.29960244562543942 1.002661539703716;-0.010090496811174098 0.29759064283709313 -0.55747356705211148 1.7068788008140228 0.68687772167911376 0.037487902780898197 0.93863003392163391;0.099538729923791064 0.77152902485536845 -0.95142689701319605 -1.4202423565041002 0.016233027005559817 1.9227791946589392 0.63854809624848763;-6.0273719063146531 0.065193689627603815 -1.6598973930489656 -0.50913666545176606 0.94662358117415635 1.247676788916851 -1.6082793874286623;-0.03833360658496849 -1.504520969913965 0.13974190076949033 0.67802922722303649 0.77722039271544308 -2.3633422872523915 -1.099292924342151;0.94114413596217805 -2.9460109702313324 0.26769208461446325 -0.045628791141509736 0.05184375541300007 1.0025012726314588 0.68288860051466616];

% Layer 2
b2 = [2.2052335872093725;1.4283217684372709;-2.8653814794249177;-2.6061561231191201;0.28188690377918812;1.1240343770287118;0.046655473291619336;0.13607511207217729;1.2401588142885338;1.0182409842995648;3.6846086987350222;1.3403939764688084;-1.6280055304415637;1.5032770532944095];
LW2_1 = [-0.33253177039545428 0.29996147746975943 -0.63918455906912186 0.73311127435632895 -0.019380795557445544 -0.47297777196302992 -0.27127254342528689 0.33681953608358206 -0.057248473205243802 -0.53000525225453188 -0.96447619074847779 -0.793956516557075 -0.033541357195901372 0.44192026145009594;-2.0592941508862195 -0.029864463185045834 -2.7339302700753696 -0.093030834800657422 -0.035930347815109072 2.2480789537789421 1.9319656439080333 0.79847269659735354 -0.81391141537357159 -0.72330926774770532 -1.0180309911233738 0.87446893522796021 -1.5566683554799872 -0.14121324117619152;-1.5892394798761935 -0.49724752424365587 -0.17638016906567669 3.6023102749723761 2.2256118375258906 0.092470246585808477 -1.2639558933623658 -0.59222121116961668 -0.61865674506633184 -0.01974225023641319 -0.27978606506573162 1.2750395551431308 -0.19851416058710269 -1.5151069021526746;-1.1011401732552522 0.31989721760075729 0.041575144557510005 -0.19811521061680207 0.97901073423454466 0.28254141736570298 0.90030594355274207 0.39581694915347138 -1.1472445440261576 -0.063788495896477282 -0.22755844418692769 -2.8495404799638147 -1.2967694606428524 -0.017025304254030878;0.83292807404323421 0.2923036433225803 0.23456796563670493 -0.33981404827634287 0.88862675881066422 0.60834281233519494 0.28195998295623287 0.032282152648270168 1.0810830777076994 0.43527791062351401 -0.16690321504828293 0.15958468511259441 -1.1544668570325438 -1.2632767226077113;-0.46809454333013922 0.53208924432206917 -0.056882379162094945 0.42568153596463254 -1.8423321099657288 0.059404414610695941 -0.90528269306434284 1.5289512429276664 0.7045767107733556 -0.11520977312424639 0.52967965051282528 -0.21748210621307751 -0.63978187763795369 1.0665556209361657;0.27565388614982844 0.36637894026190793 0.12244402794875237 0.43842258337529183 -0.10579840946654775 0.12555532207504835 0.30137885064351072 0.18513105026539906 0.22547177419773473 0.34710055510284915 -0.042621102116962205 -0.15762142576346866 -0.57204252628563812 -0.69749503428969206;0.28207954038808114 -1.0410343215190476 0.55228131371195699 0.050435700810257875 0.41239193490943493 -0.58350291316461067 -0.54680747052183409 -0.59442726507115506 1.2970228131053954 0.12936726397211931 0.91376760403768587 -0.13715326943308911 -1.1953445274940384 -0.72700963235672533;0.16903067534612176 0.43411959919482157 -1.3049167503191763 0.58380206723925898 1.9473830367758198 -0.98680661250909307 0.49111859434487243 0.05006561288698605 0.23681975985200371 0.43672755658171047 -0.60038738651926604 -0.16783746278830489 -0.96783969813481641 -0.31012196720635099;1.0447584449398513 0.52558744578342542 -0.23806221755496279 -0.91846981758768065 -0.96298618537289471 -1.398006449123403 1.3429059464588602 0.53540795773521743 -1.9181594761102587 1.053307859766472 0.2460717602576819 0.031455689379726662 -1.4743321520349322 -0.20828387900250994;1.6906805274343579 -0.15373751958208937 -0.13928376872930834 0.38005018500208559 -1.2050827866606062 0.15951285605736842 -1.0392571854958299 0.10256634287204333 1.3168026228740364 -0.045094056415258009 -0.13153371908346126 4.1461003748428125 1.179952794321286 -0.70853074026588125;0.57460638761582672 0.22221418643909041 -0.81092967959335527 1.5391380429366357 -0.064849390064510501 -0.51178792724319333 0.41514801361172377 0.25156439213974419 0.43168531214255756 -0.63169019048731967 -1.3902309757297702 -0.82435073153904859 -0.71648441503452431 -1.1492076311876467;-1.0456007881056795 0.80690733704973916 -0.90523640715070175 -0.69196152157910107 -0.30356667826237338 1.0041165326801891 0.51920353409890241 0.80017538359193907 -1.1632836760476921 -0.6016232862294052 -1.3984078008231262 0.20974081245332452 0.0052693221263369686 1.8017347468784071;0.48468793857464748 -0.20146017873208899 -0.62310702409704655 -0.41132954550121642 1.4045034631976336 0.60108599517374728 -0.33544143485719863 0.70598503521472655 -0.10673860053134994 -0.26542381592256847 0.24204766603994948 0.045211237485282892 -0.37903604920004091 0.75489714883803116];

% Layer 3
b3 = 0.45872723265563348;
LW3_2 = [-0.79509351073868173 0.31181056797828283 1.7064254360406961 -1.7672605843115379 -1.0788199708837263 -1.4110372697271321 2.1952885747274093 1.4307575610097552 -0.67967881887486326 -0.42367640779387478 -1.6100308517705653 1.5719255621044823 1.1254049957294421 1.7354768643696252];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
