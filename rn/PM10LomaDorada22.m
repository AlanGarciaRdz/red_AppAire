function [Y,Xf,Af] = PM10LomaDorada22(X,~,~)
%PM10LOMADORADA22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:20:13.
% 
% [Y] = PM10LomaDorada22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.290275761973875;3.96825396825397;0.00572573718866304;62.5;0.00462534690101758];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.9049433769078492;0.9141144232005658;-7.5598819527634191;-1.1321973614008345;-0.36179949131499739;-0.98154324365946066;-0.54676157820442073;1.6406181364050432;-7.9303723831801936;3.4650332952902145;0.48246326096090619;-3.9613662766961952;1.7945494834119093;-0.52940309663784235;0.46621288435508101];
IW1_1 = [5.7239624528467878 0.26076274492227469 0.94441348734385855 -1.560262243023093 0.1530310218886306 0.77182648258485775 -0.96844725282240818;-0.98260222269445496 0.47534138015369981 1.0874285193427329 -0.66342901251923048 2.5550209396332044 1.257441018701847 -1.893826269465668;2.4283768969175994 3.0747951231796344 3.5930556352032252 0.28974912814499848 -0.67101790111490556 -1.0083806084464249 -3.8658503702106728;-0.82789195304202035 1.6270840685358099 -0.67187302323357168 0.9502418410899075 -0.51778276065477091 -0.413173731034988 0.36117732356400178;-0.43772406661750329 -2.7040037479869539 -0.069919729385533244 0.20167645985945526 0.15700149266231614 0.059773913403058973 0.23884768186920949;0.36566002073993642 -0.78449537133216407 -0.20498013123797301 -1.4941992712328385 3.8539605470361784 -1.0981944371551902 -2.1613837163532144;0.33108073331719334 -1.2904734788720595 0.00089943503907653766 -1.0979216439585391 1.7319094671884128 -0.77656053192584795 -1.3463202515451802;-0.15078706556844754 1.2947428169683952 0.95169530713576111 -0.53235028239408477 2.7091179043606681 0.063767390433269705 -0.47795429915184268;-0.94700577197143954 0.061381790181810524 -1.4874631181846176 2.0003649970910291 -3.1950928453946306 -1.5370826958973713 -3.3738939256187948;1.5613630369589333 -4.5041517151714672 0.95807800040801361 3.7051937510394977 -1.5701441988105527 4.1638498004768101 0.49377364097928006;-0.17740232884369581 -0.027383023885006068 1.3140113638297448 -1.7089140405958085 -0.44503682695929991 0.18764444856295107 -0.373925376987853;-2.5902897604429702 0.40106038258018101 -4.6168520492251126 4.2939013616274533 1.5303783207151338 -4.2251925688247045 0.59806666350104754;3.7389668408403645 0.35866787347615792 -0.093359461153093196 0.54360339859442774 0.01161587683933632 0.87887478227765992 0.41955690070301294;-0.85955110870661611 0.33831025270546228 1.0405883541654344 -0.7292208206286388 -0.53763951025404699 -0.11839998527409412 -0.44469859570952963;-0.17896561170331179 0.56310840556945629 -2.2026296832296279 3.4101626374990657 -1.3114197758481789 2.2632945711328243 1.9453677097135638];

% Layer 2
b2 = [-4.3762215889503526;-10.15704995664685;-1.6603971483453797;-10.849471352995369;-3.5487077155962803;-5.1633491275536851;-0.88290835936907452;-1.3379469677528832;-1.7603899420957578;4.6717576615130314;3.5831471751806481;9.8669740642159667;-6.1550816487622564;5.2321042945487193;-1.624317221515154];
LW2_1 = [-0.60210073032699885 -0.869453048227943 6.2070757529304519 -4.8640766656464525 1.5702600673014027 1.9830899218590123 -5.9136672698068447 -0.019469264632037797 -4.2757821855455509 0.53851824962765205 6.5156144369434017 3.2807831931880806 4.6506812493105105 6.6060427345161772 -3.2950278209310917;1.9847958768461322 -0.10305730742851282 -2.6682798704274511 -2.5070095366955654 -9.6682325647475214 -9.1743986654336247 13.717685377172849 4.0039410520512027 -14.159995290394278 0.4094932189355745 -2.4596099354520233 1.5719086466320042 -6.0535095845157674 -3.3568572903731964 15.569586140154334;-5.7263009727626244 -1.9102439033590359 -7.0945615729377325 -4.3451470811906656 -6.1611177119336444 -4.5870967864781811 7.4727969944779069 5.142499192607966 1.0417166697948115 0.041467072653214983 -7.1916999932230929 -3.0602390853858426 8.9825750458436069 2.3794680365770038 -1.3567462077497356;-0.31158371719706135 -7.2164850820546551 1.3444222827001566 1.9967393751427875 1.207982469699421 -0.86715522930799005 7.3293034074857548 8.7158934028633777 -6.2934078509854698 -1.2210464865199269 -4.6559180809616976 -3.0453997856024633 -3.5053223940014733 -4.3448968299585946 -1.8321570003585961;2.6315271984736683 2.4265431687642316 -2.498202132969396 -7.2364609263853223 -11.64077928322847 7.0521634456473672 -12.005965312461472 0.078463016555140666 0.96671852957908311 13.706914403590863 3.53910232980415 -2.2083058267410198 1.8019245360157901 6.5722851724474625 -3.9778038191295493;-2.4680748203758673 1.710042513823637 0.40609191249428617 1.2298590742968416 0.46397174236008193 -2.5242365135118687 1.6383632278605018 -0.80573097068120847 -0.80324431798023599 -0.12820951819473628 11.114706380492876 0.87884672127646302 1.5671630023317187 -4.5247268835705041 4.6154462520029327;-1.2895317596194895 -3.9627749551790794 -4.9254980131828408 1.7163718369978389 -1.512004342733912 -1.2122170688134017 6.2103462274195591 2.7323602965417195 -0.13940732097968567 0.23858918701222329 -12.420707901694158 3.9394652069941247 2.8066809395417542 3.4943245044104017 -2.3096740508494267;9.1912450312514569 -2.2039540435326788 -4.1637708515247356 -4.0906661692673669 0.63234936908071959 -10.286747335991789 0.60140586291511522 3.988109702441859 -6.4353867756773804 -4.9025834520279652 -1.8037960601926128 -0.20850028051664474 -4.1694821031707985 -11.76608569726961 -1.725700918820932;0.77189625012907648 -1.6992774126858805 0.7008712756143004 4.031592552330971 3.2593339999567679 2.5638300973674029 -2.9835240780079575 2.5256475739389068 0.78819121217714194 2.5469686776315785 -0.75807149624349335 -0.64582837689281802 -1.0926213555269992 -1.724827112163456 -6.2808502847910637;-1.9984900287062732 -2.1097169607607409 7.4659442964529408 3.2226329798073934 -3.1483161426335275 -1.1998221085739653 6.1254599751877912 1.8393405242124332 -2.6368431554304537 1.5087236401697173 -5.9082191375093869 0.71403576648601597 0.18567515510579236 2.8701238304745282 -1.9262335573994409;1.4282275332135292 -1.6589103027299927 4.6761204994497412 1.2959299128401112 -0.46225360013857386 2.1204124526044228 -5.0334767168552856 5.6205358442903259 -3.2295570578208781 3.3164631009309793 2.2572656075615529 -4.734670228473135 -9.7468678622446259 -3.0692271026282554 4.9424934138101539;11.390326798167878 3.1654054369801941 0.78096536189010579 4.2238653157116959 0.2150806092791418 -1.0039139316292249 3.704536721496984 -2.0313649121955266 -5.0051519410323371 0.085129046557969185 -11.689649403447794 -5.9892461509908745 -0.26734445522335404 3.7573831457765188 -5.2550867254613731;3.0490558426455565 1.4326497031893073 -10.331880228657123 -0.56267420216116859 12.229368046298156 3.3763536968740175 -2.8315237148209511 -4.35529050604839 -2.6879768769412453 -5.6977813220253068 4.7682544912145248 0.061059481902858995 5.0888176412744546 1.5014835704156715 -2.4773960425013626;7.4909377000414841 1.2298736345002255 -0.16518558298122629 4.9083386070161916 6.1325081891977939 2.9679328330246229 -3.6022783084035899 -3.8722864399024748 -3.6370236729058831 -6.3383097469884992 -0.74157526624852288 1.8709002633089931 -2.0982501135933189 -6.8853978062441499 1.5805648333539861;-0.35565496766089699 -4.4075363245285768 0.64138545192854635 0.78680290068862913 1.0055907506031567 -2.9183811933185879 5.2261585927907914 4.1083088352356301 8.9811035003713329 1.9015956887576622 10.238209166727337 1.4835368022567486 -3.5138695851262542 6.2088848801510723 -5.6933246488195595];

% Layer 3
b3 = -0.70011797596034275;
LW3_2 = [-0.069492262845922803 0.035429798579195121 -0.036352849137974465 0.042193405590286018 -0.033274882943110554 0.10269323995704359 -0.047979028273791691 -0.020153889070529191 0.05455602376095562 0.078657062153954668 0.035233236748440915 0.068564354326688073 0.063115850553280589 0.038695400617433769 -0.045844688950866956];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.00666000666000666;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
