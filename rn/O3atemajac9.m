function [Y,Xf,Af] = O3atemajac9(X,~,~)
%O3ATEMAJAC9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:36.
% 
% [Y] = O3atemajac9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.201288244766506;4.04040404040404;166.666666666667;0.0561797752808989;0.00614628149969269;9.52380952380952];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-0.81438652816497104;3.9085672127748046;-0.9954376590920927;-4.615447455921772;15.669519666349004;-1.9920793651754107;-0.28372187352258532;0.5650651778804;0.69442031252547376;-4.4893612201603714;-2.4190524866516445;1.3878219490529664;-0.15208104205670769;-0.528119857749899;-2.7838069537786758];
  IW1_1 = [0.3642644468599735 0.15480912683472381 -1.6071954034225882 1.3774290509358706 -0.063765983571227564 -0.30684844196227262 0.15299762348604209 -1.2410627568586239;-0.29527233028014555 -3.7398463463547342 -0.20693997159389885 2.3750082495587952 0.31225002074009101 -6.0955347429139675 0.84179696554325489 1.3229590827448101;0.34304945569699763 -0.013300023244253915 1.4723811097230528 0.43849815247914792 -0.63715663738460915 1.4074492743997471 -1.5305485829376302 0.50642991976036611;-1.0368633764272868 1.9955384054208949 -2.8468233527069646 1.5400985678231103 -3.7925790166492952 1.5216443032961611 1.737741667977843 3.2060882739629344;0.2185663988786837 1.099864872885145 1.0947650969198588 -0.99791865336418351 0.078474672667549122 2.7105189115305834 -0.11384544982669603 13.202767049251388;-0.14445470799984436 -0.24950681519268181 -0.41387622782068767 0.070546521974343759 -0.12958273469576584 -2.5754507040381895 0.050363439480374486 0.11441423361080112;-1.3621824953726076 -2.4575964848292995 -1.5028527850635733 0.66321557801155884 0.20718226021363842 0.59186002809570248 -0.21472149383967015 -1.0437148055255863;-1.342546603781424 2.7384325400816869 -0.29982830653969389 0.56288192209758636 0.13722314800255092 -0.080362809197668125 -0.013614570246260971 -0.018838179066944218;-1.3759589140175807 -0.99124569947380925 1.1711600117670569 -1.3454332729023974 -0.15351018084887821 -0.55251599689601394 -0.064146354330263125 0.56850580643207715;-1.5075142670209467 -0.77400074166205024 -2.0287928185150901 -1.8606269620722455 -0.73954046600466949 -0.71667297818662534 0.1518203510192446 1.3788998923971381;-0.98968893486306786 -2.6983400545316645 -0.14150222551662262 0.2241929956958468 -0.0037481192223157845 0.95481642791925836 -0.08734340455722242 -0.18606042184348331;1.3113113896442052 0.43858298499441889 0.039283150555928084 -0.043160859412002379 -0.47737658651393761 0.13716009365878204 0.079816520872428978 0.72056165474305733;-1.1375716722799114 0.34644727954627935 0.36015803912319733 -0.17003420044689754 -0.056923062203906902 0.66684815615591508 -0.089861031566744562 0.0017498612724212177;-1.4149053384532588 2.480655052716239 -0.37396119527825233 0.88097086112991507 0.097482632498783889 0.94863834073401365 -0.10232752952227937 -0.50211016793171226;-0.27562334926773341 -0.12572568400381534 0.80677152451057499 -1.7648561062708743 -0.26253324828956992 -2.2860981270336764 -0.02483482579600263 -0.29040432047815073];
  
  % Layer 2
  b2 = [-2.2323712551014165;2.3012630422849383;0.18348762492093168;0.77893688515987791;-3.123396890233193;-0.035221091648433372;0.74591372220892371;-0.39916386528588543;-3.5720999637068713;0.50115584927410517;0.6959385875737566;-1.0394271901162335;-2.0254046368543301;1.9118274661148091;1.0984511118675626];
  LW2_1 = [1.0150462134095743 -0.28473113346582662 1.6728194562471459 0.054328590743980436 -0.79563032140377976 -5.5888592825104206 -1.145653597993304 3.0093120215801208 0.66286677447909392 0.67574268059258957 -3.080373745233671 -0.46270410082206259 -0.22863057886566771 -3.909863753085812 2.3793903668335159;-0.34850570561078559 -0.054051373382069931 0.19536451925307796 0.27455831293128152 1.6165438688777312 1.2047007007688628 0.31202087583417698 0.80434406914028411 0.36568607838619654 0.26110977534595875 0.48394813851072149 -1.2625656981180295 -1.6463920209931076 0.28988494226453265 0.099090681313455012;-0.00934021403006461 0.2343009870957628 1.1303287669908266 -0.20221729494008209 -1.4044932997560979 -1.6894897444182102 -0.64529717152155053 0.34757764455957674 0.63967970070294433 -0.23258870104121041 -1.2814603043285697 1.146221991070429 -0.65645512609230749 -0.81018938219481473 -0.29302884865900236;0.59038985085141804 0.76619294739816379 0.57832235862917947 -0.078104060280476145 -0.84493135933108654 0.76295036976088693 -0.98510393696131537 0.68481644995579605 -0.49651131513803193 -0.22670468083990181 1.6692012273436025 0.39826067320783382 3.133222531621322 -0.40229611997091408 -1.0285505307950698;-0.076003158350712072 0.4031190176121639 -0.33802814284474747 0.03852111653692622 0.8917027616397295 0.49737238221341257 1.1690646288912958 0.92135257146791338 -1.0961013371744786 -0.87847912008820728 0.64431625212914545 1.230369108838002 4.1983564089967231 -2.3875245335266508 0.44589995845605052;-0.023972922185938324 -0.31491388704303219 -0.87591404904370007 0.22072642628054981 1.3235309474647958 1.2572068175987019 0.28682273306466621 0.60596565892421794 -0.20874245468236011 0.24194542338904076 1.2457823079874804 -1.069639281251759 0.13443102821327554 0.096314771189694476 0.54111090813038687;-0.023046045559057059 -0.59413442185508702 -2.4584535389979534 -0.88895467924488913 1.2856046485000481 2.8827355250866926 -2.0961056541007115 1.2808050677024596 1.0543754682056101 0.79103194613986338 -0.58535395116040601 -3.3150739861554284 -0.066797603069271863 -0.81766950186912246 -1.0555387668605973;-0.47891168708733395 0.0689959201265537 0.16174015479655734 -0.19261567275648048 -0.93588215620357529 -3.6316687807124368 -0.18631206449642598 0.2842034047081749 -0.52050736671359732 -0.25189010581199878 0.92796193307376607 1.3298369568331248 -0.91633249876677791 -0.22378895333130003 2.1984820491731698;-0.2546786538844435 0.07568524437320974 -0.14574425963118243 -0.29450036174402905 -1.2083625782824701 -2.2459249724491515 -0.66554059039571878 -0.58610573737672977 -0.59844182029256376 -0.86999574316856987 0.047622583364500225 1.0970762277289039 -1.248024698836683 0.48887610774486678 1.6371528071193635;-1.0156461309654761 0.54419784679315131 0.051323020354615348 -0.063986822799592988 0.41232235077480095 0.17208623164086478 2.4445968461461356 -0.50035651457596808 0.022871446430245225 -1.5819971173155831 3.8201718260105499 3.449481371633691 -1.5805488967417696 -0.67285890925045599 -0.042315752984981303;0.64533327888936443 -0.067580319391391502 -0.26716062962051379 -0.30532069006266488 2.6086500358044593 1.5720643571235651 -1.4340768465552778 -2.1614652426847991 0.26421036438172402 1.4097195164884841 -3.3229139840418229 -0.96057562326008594 0.49546155509169765 1.1192759897484263 2.1974945520007205;0.41443826314458199 -0.45617293775286943 -1.2471801230839252 -0.51985523557398006 -1.2135577936595936 0.78213429859622019 -1.7918690626657086 0.8515889596734626 0.70788282228295973 0.18304899443600728 0.72159661032945732 0.92763692341187054 0.58272756972210804 -0.4041363711593205 -1.5851703262596109;-0.3458984939918992 0.23586077497899036 -0.36910877253572322 -0.13018206209407243 0.64940934232421543 0.31344909303204005 -0.89262666682277259 -0.038909924742009411 -1.1493797090442837 0.38321667698490952 0.47761526152521994 -0.050731820629349653 -0.34880978709812843 0.52340238461584021 0.67088196132313549;-0.70733242897372151 0.056068137985393424 0.12484134973694264 0.25802673226018319 2.8053636021861039 2.97449645940815 0.10438731603847198 0.84254435687697171 0.1093375668065886 0.087676681810604049 0.93262556238439653 -0.69382202902610079 -1.9021272918986538 0.39900355829360429 -0.43827848752394016;-0.16445503066187983 -0.24782572915923723 -0.015120954903249174 -0.13372559439993961 -1.0895136533706415 -2.1267801634842494 0.13904486161244875 -0.55922703290417608 0.29210875099701972 0.55620541427230996 0.13908365283715265 -0.11283342187144407 -2.3922250638874902 0.44927663104755883 2.5209485025688032];
  
  % Layer 3
  b3 = 1.1815040990496526;
  LW3_2 = [0.60631279094474655 -3.2004952711906389 -3.118838019343082 -0.45481420739600353 0.70372629335997472 -3.626630271152 -0.44507788423728445 -1.5972953191542083 -1.6655559239385747 -0.26130242841780388 -0.46831458638870838 0.69514108164982291 1.8000797534529756 2.2506933127259479 0.83561476618679409];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 9.52380952380952;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
