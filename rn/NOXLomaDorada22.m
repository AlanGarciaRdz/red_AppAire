function [Y,Xf,Af] = NOXLomaDorada22(X,~,~)
%NOXLOMADORADA22 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:25.
% 
% [Y] = NOXLomaDorada22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;4.5045045045045;14.7058823529412;0.00280033604032484;0.0179856115107914;0.0558659217877095];
x1_step1_ymin = -1;

% Layer 1
b1 = [1.1965273259089304;1.3658701236685487;-1.2886818195437248;2.3564716756156456;0.51376954738329117;0.7171818441591129;-0.88304971995939185;-0.38593913436593724;-2.2750320121029306;0.46231710725311059;2.436298838316787;2.0742736003723192];
IW1_1 = [-0.19573813912931293 -0.84285754792876644 0.11934401699294063 -0.88590039086561656 0.73780945398746756 -0.58677629592214442 -2.6896522170934509;-0.76642895300131064 -1.704799785581246 -0.0083318954913295089 0.28499829589270798 -0.86261944251870848 1.2714632053552715 1.4724179791959064;1.5024845058085015 0.35541530683209183 -0.21637220320748385 2.2445729890695478 -0.841742931556277 0.2938489960186742 0.9944975662724701;-3.248624988794345 0.55354233368503658 0.12993857603554984 -0.29337411544467951 -0.77326397671579228 0.66157928698256863 -0.32177500830080258;1.3977502936074313 -0.088797958980964015 0.0130491636988221 0.18390629995551847 -0.6642599506071486 -0.55801539228565222 -0.91094027636261443;1.1791703575333352 -0.87753501477021945 -0.27963468688711712 -0.047376823487782507 -0.29708544679772347 1.9042957911196789 2.2031063947986183;-1.5313215730500294 -0.40793010758164805 -1.2162729234006167 -1.0749841361999328 0.14751540557658285 1.3573707130665669 1.327845040756072;-1.8838044426149314 -0.10108375980763817 -0.054190481466128981 -1.3886938969068265 0.24195842286249647 -0.60005107100861077 0.16034656012280948;-1.2462535882640868 1.8476019006062105 0.7180034490032291 -0.096827431145245446 0.50946915185891806 0.20691744770360881 -0.32417943495940582;0.49554207980605369 4.6992290209627319 -0.43764654322531582 -0.055814043487485941 0.024664573951527231 0.23704700904772147 0.063518757886610711;-1.9564594164344673 -0.55960853143119593 -0.77353552921512048 0.2425107825929313 0.65560516850283501 0.051143521186704725 1.4335567593130507;0.38979232151290105 1.7159024188802383 0.070482538971672101 -0.50270181939695791 0.31880980315777413 -0.33769114818373352 0.78308954624836213];

% Layer 2
b2 = [1.0493534818930164;1.3573090115350785;1.3198596675804841;0.14286473641500724;-0.3741738846518351;-0.035634355524869536;-0.46901899986403844;0.2093195290584646;0.73576931616365349;-1.3002249267958483;-2.027239526731317;-1.6600019186464205];
LW2_1 = [-0.5811921071150058 -1.141037786514288 -0.035378100199515067 -0.18929940772383544 -0.83011031388085466 0.94901452893327165 -0.60467842688120577 0.09516397061662886 0.86246155536583935 -0.94050360382605491 0.81840613785352867 0.36694582627247679;0.41660053900251814 1.0804025559359678 0.12365962945974679 0.36584737784851507 -0.72180939461974603 -0.94372916672976892 -0.53384958199003296 1.351480597825818 -0.093855640472292598 0.25101817207156285 -0.88752174312073662 -0.93965862812861778;-0.022824919865998598 -0.66943186553621503 0.87054841478823941 0.19677299743592447 0.1636125841503977 -0.3667232631971834 -0.038401776405813826 -0.17266489389731321 -0.30538182552625392 0.78627242868523717 -0.6292998060612619 0.46621949450577016;-0.17344699794763432 -0.68745738010953406 -0.32828540619825486 -1.2289456268643577 1.111549326126821 0.63453559744783394 1.2144327177085308 0.66138615330091644 -0.79916538602946141 -1.4585784779508717 -0.82672210800731549 -0.25787765746092722;0.58293696332909606 -0.30142082862512465 0.84048447443125673 -0.72473245045549817 0.9712582852633066 1.1032556923193266 0.88598611901815283 0.63948300576274597 -0.15605639114068251 0.76006111678519428 -0.29360928005828546 0.50525217448641069;0.1498245649779032 0.39579829323684118 0.76453941736984965 0.658533545963495 -0.63200056985048703 -0.82858092596385213 -1.0568656702295378 -0.78475873751641279 -0.6746582293621306 0.92477539047282153 0.3366886164438323 0.4365657552933167;-0.95248722686671139 -1.2204647343256181 -1.4275200887645545 0.41586726254597206 -0.2851532212155965 -0.80480931440785985 0.21035807375519397 -1.487982534362394 0.38003831722691783 0.3843743254658914 -0.45849398394368113 -0.77294042916388428;-0.8798968033876382 -0.22633275017528129 -0.89434643243685841 1.4776503030140198 -1.1234641129695861 -1.3105213422325874 -0.72216406547286915 -0.507407964006239 -0.40887017990781505 -1.0573695426227199 -0.27679784651895933 -0.81277786943967445;0.3117501726980102 0.3462401754155065 -0.6391312449049168 -0.90844879935751588 0.99070612527148472 0.35089220598572451 0.68508834689151521 0.26233928792881145 0.82308301083921842 -1.1930775873958277 -0.54811295312277775 -0.39855045255603061;-0.034476930487745451 -0.33392723050474915 0.063979713928487655 -0.56312356062309077 -0.15270841676437305 0.51861628106531354 0.13643837591975055 0.77863525706157255 -0.93935043014852182 -0.21341914810320162 0.51059177690100666 -0.31128757928798478;0.23305789813439765 0.90301363481594554 -0.65537168783700051 0.690236737334321 -0.20224508350796319 -0.12735169474814106 -0.23811413134304471 -0.32521943475925613 -0.38152609190747994 1.6263044332590804 -0.52729938480702165 -0.3913345071731284;-0.15992369994302527 -0.79853939681488251 0.99571442006927269 0.45600350725425465 -0.42548134085807859 -0.52694711088356894 0.34869448556211841 -0.13358826281018826 0.4237820158720797 0.42438306302711953 0.67650471711491533 -0.61845719967859547];

% Layer 3
b3 = -0.39799087054169152;
LW3_2 = [-0.59528907952546684 -0.49371961137002573 1.0275918215301654 -1.5480590934408944 -2.0880379556429443 -0.71328597830108442 1.0197258436624512 -1.5293706275686338 1.0819043784743196 1.5744724404979957 -0.5870490672991755 -0.80118614032997881];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
