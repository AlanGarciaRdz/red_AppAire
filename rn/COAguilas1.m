function [Y,Xf,Af] = COAguilas1(X,~,~)
%COAGUILAS1 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:14.
% 
% [Y] = COAguilas1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;0.281968137600451;0.304971027752364];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.7109898887389594;1.0177269814135614;0.80565960375920709;-0.45785646589241691;-0.84337203677561612;-0.1641245158918716;0.13327848009493384;0.24576155123907509;1.7868936123285422;-0.73015466626281589;1.4250505254043424;1.7946369471002912;1.5300701199913409];
IW1_1 = [0.076125500946535196 -0.21815830361261332 -1.815448561281203 0.10673525889764772 -0.13855643197334028 -0.016245802968860613 0.091556514882002824 -0.046238608088131392 -0.07787566571051785 0.098166987376825179 0.12693664591553483 0.084712895948458294;-0.075350561814397657 1.5962481391191961 0.37625261235059687 0.88930927766982026 0.14226825950850819 0.10014736893811821 -0.30452876659705347 -0.29090401933002014 0.039962152003675588 -0.0098550284484559495 0.22695001690957192 0.12626197876010845;-1.1807464821022799 0.28150298536235502 -1.3171369799144219 -0.2375276581253328 0.6876644544119539 -0.3326845591715934 -0.027639223703264736 -0.74521716889335443 -0.20861570614463201 0.35002642070979267 -0.53938117398764318 -1.1087060562103461;0.19115303167819581 -0.013010647863504587 0.75150298258757342 -0.10153391144276683 -0.34718311326753354 0.057583372338445328 0.2232476826306844 -0.19059926581544201 -0.26538250966779647 0.0014334786375570533 0.13678030505812747 0.48134906027127405;0.8397455251924274 1.1283670257854101 -0.61214418270799331 -0.98142832664159596 -0.15758461081714742 -0.23581691742689459 -0.47638041065928188 -0.5995474389710892 -0.38830109908155186 -0.24232670448691884 -0.28798201145642333 -0.3501781827692258;-0.29860058472676176 0.27071907362542552 -0.26080317908390815 -0.4100389963807024 0.57224639168190261 0.45643112810786179 -0.3382762167244695 -0.18959050208585643 -0.36030657200893451 -0.54687788419018957 -0.046866185853116929 -0.61750035552824845;-0.88881125174387787 1.2185921227420105 -0.4941619363949698 -0.40658141007548965 -0.74392165781034436 -1.2603588274990389 0.56917920505071684 -0.27860235865640326 0.11383793331566125 0.87311681954600284 -0.41326188142789544 -0.018112559307036685;0.027070288745352826 -1.0206902612214266 -0.22338565508626856 -0.53328011373389428 0.43508914893745049 0.1776803897168443 -0.805190282250969 -1.1594047530020943 -0.5059323947139619 1.0523644458733197 -0.080456858341090357 -0.57449064009814377;0.046625650006658588 4.7612501026644667 -0.14122105187486453 -0.11158360951371937 -0.010497381575176951 0.17852291542058549 -0.072210081120102798 0.059528983975682022 -0.086478729953196984 0.014881496717473658 -0.080853772366222765 0.059828999187211671;-0.070068797554427673 -0.50282399870374805 -0.86345161255855862 -1.1507370255412095 0.3809340040275549 0.4573246661185546 0.033067267816845956 0.48923840344189645 0.22969607773634634 0.042726024551750973 -0.091555906467835069 -0.27893729873675049;-0.40969837753042665 0.12468421047637077 -1.0837126449257766 0.4023472994447343 -0.086245223424927769 0.003473395557007067 0.58918343944573226 0.087161286246668093 -0.22510237098005917 0.65772490227347646 -0.20918781298648292 -0.16367166157824342;0.040017896540077973 -2.3477504881679452 -0.22265307716627886 0.15349190151922049 -0.30300911077201098 -0.2559191591320204 0.12641485036089459 -0.23869259478827293 -0.14004560887574896 -0.11668227573733089 -0.13738771492611782 -0.30887356354983148;-0.21779106313725671 -0.22313286696387952 0.73358136799913554 -0.099767664454367785 0.29597729180153848 -0.0028760998156918231 -0.42873003263695852 0.98032999151712696 0.42656186060609258 0.59430004157456406 0.18796021792195525 -0.89910052961592213];

% Layer 2
b2 = [-1.816174871125803;1.0709563215762488;1.4887980644782937;-1.1577136743503103;0.75667964539276822;-0.07105266756961548;0.060113704350042804;-0.41118694562692015;-0.92011392738773456;0.60131983396426059;-1.37404756508433;-1.0844652385738713;1.4536244372985929];
LW2_1 = [-0.38953062399925525 0.39292973473849996 -0.49817970359900526 0.63215485110449443 0.75619320900392439 -0.47193198012963344 -0.12845063159240744 -0.15550620207486995 -0.14278930955111965 0.37844098948518534 0.81355146966890435 0.91772915473640415 0.29524533540123815;0.20538856522408216 -0.5219215968251294 0.70237869496784577 0.21771218834166353 -0.7062353427625242 -0.32667147570409749 -0.32245383380743409 -0.14251232369758643 1.1020862437907033 -0.45093316367350622 -0.27658593777591484 -0.4967373543309046 0.47323869178814881;-0.21908852882011606 -0.53772905456725706 -0.59485295426439722 0.35162992171713725 0.38888516794173095 -1.0346525541295331 0.48024502664076263 0.73430221053698264 -0.24661576935839802 0.68919540476349106 0.80810569406243882 -0.74885704303526135 0.40020232312897536;0.24132063696337216 0.29980848211239858 0.15837368026504889 0.23196349103331723 0.16046809687525732 -0.76137020321072602 -0.93445844153481217 0.14392975663374802 0.54989970692673096 -0.58951930920074702 -0.44760817047258261 -0.73619766616389637 -0.6346052422473204;-0.9708904937313495 0.56800053508710602 0.45089464433313459 0.58299188669563096 -0.039982351736581712 -0.44697296154349658 -0.044878337172390675 0.048688189203457861 -1.6056882519373294 0.72764104908266014 -0.21727366004973353 -0.23395227510499336 -0.60917455451920599;0.15137723280246376 -0.04285960175889178 -0.67521846674442754 0.70459980793618149 -1.28497381653445 0.98461738480268168 0.74655663946969719 0.73626845989013223 0.54509214411905527 -0.086346709187953424 0.009807148618227653 0.67607525165069715 -0.68672550338804017;0.092110293134513493 1.1499047247253129 -0.021402066800178136 -0.56853584657542255 0.09688874821103198 -0.14515206344626322 0.59072827271153427 -0.58865115684807645 -0.77349637466853127 0.0047710401684987191 -0.048966143691901311 0.48846771428423624 -0.01869523743785053;-0.30118318038320407 0.72209252031647664 0.57045185515214314 0.67282904394278409 -0.069389084101209891 0.44109520370329658 0.68267608499224053 -0.82920703115895633 0.050092271250465385 0.3686143944930319 0.67408566504031742 -0.17189541637173383 -0.41302446689207223;-0.12130775545708131 0.21108767680245466 0.93374724092613548 0.63361201308630732 -0.14376916748738433 -0.43713543947528899 -0.36990779616766928 0.82447444464237196 -0.014183353147182694 -0.29884595753578475 -0.18429724856707358 -0.52376325106907606 -0.51124472968351009;0.196221440138929 -0.40297849916587347 -0.57073081817817262 -0.54415605053072125 0.026873037411569385 -0.46749814107271453 -0.66727111089712876 -0.38276637513354339 0.55097720563888741 0.35853693795535596 0.63980752322528145 -0.4878736335794121 0.037228001511773273;0.079638195766556327 -0.59333779700636602 0.46403092404908497 0.20654266133193047 -0.83933346854019142 -0.35260922468496186 0.09232924530184515 -0.89680222481108995 0.32177747939883272 -0.29897445708592763 -0.76171833322783133 -0.78466553827847219 -0.020360297657486894;-0.52728786051214727 -1.7953865533684443 -0.27465520098349006 0.031561424088529362 -0.91851860873553048 0.35392867731917804 -0.30943532554474124 0.49599837322845225 -2.0794607807609022 -0.21465934645087545 -1.175298407081905 0.94783267395006199 -0.17230195323487485;0.23672279600169688 -0.41447196224052774 -0.85793127368620437 0.83096335163886759 0.40506958703552182 -0.19134939048534261 -0.049433515542543695 -0.72513009099980075 -0.22760811264635153 0.030913575264701416 -1.061119787179204 -0.31233026486626181 0.2324585006399735];

% Layer 3
b3 = -0.23871667116739848;
LW3_2 = [0.55156018442362231 0.58769880797694629 -0.46888863085870097 0.31685606481986905 0.89791794231665112 -0.17951772288291148 -0.53666667979254057 0.2643805318905133 -0.99437865588720131 -0.73893377776202152 0.090165009956205161 -0.4334441289048438 0.31534093666272617];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
