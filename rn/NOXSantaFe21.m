function [Y,Xf,Af] = NOXSantaFe21(X,~,~)
%NOXSANTAFE21 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 14:08:52.
% 
% [Y] = NOXSantaFe21(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.172786177105832;4.16666666666667;22.7272727272727;0.00341273633199099;0.00632111251580278;0.294117647058824;5.42005420054201;4.04040404040404;3.03490136570561;3.96825396825397];
x1_step1_ymin = -1;

% Layer 1
b1 = [-4.1854292113090272;2.5335220183637648;5.1125758956673435;0.32399995050095826;1.550819279786807;-5.1291244829247775;-3.681531313366508;0.48891025659520765;0.38897247301914267;2.2554495474326446;-1.0370954202626188;-2.5093991529869801;-1.3887456149681918];
IW1_1 = [1.3375477884178819 -1.086377561224884 -1.6055684093374092 -0.040246422302787729 -0.31101466226561897 1.3633232742608159 -0.25299240134876694 -0.35013845077631817 0.78362390875087329 -0.67280087299319002 -1.9112150884242087 0.82744580816837032;0.29323970271468436 3.837239707922051 0.3619016633035369 0.24796915992509122 1.5913335098933086 -0.27642389815704876 -0.017304945603857876 0.1361815428039552 0.081985038021538337 -0.28203897598341687 0.043882361559996766 -0.45492267583289842;0.32077869713156765 -0.0058100455702419403 0.14328364553872369 -0.031612285314062752 -0.10819765045439562 -0.39763991684471567 -0.037245430956650935 0.30117227025690663 -0.19484602894588479 4.489734491979533 0.072582925332633635 -0.24625105720268484;-1.0756502341932626 0.8726320218329342 -0.27022540172302856 -0.017585358528610179 0.69467225064609361 0.48953094084226145 0.15486116197124083 -0.20444650722102181 0.44465794788926072 0.30651792927420363 0.19512394612815603 0.029403808998733384;-0.030676875149556394 0.36940155155536997 -0.33056413497493847 0.15434047619596547 -1.0537511074131789 0.053293450954780691 -0.12943843171261832 0.44653199136428445 -0.29001863569075764 1.0089873401892873 0.091616361605954655 1.1994891173284539;5.3117934531004902 -0.66042929969439867 -0.10293431340599389 -0.10276810507440494 -0.75429215851214859 -0.11741363741497642 0.036340735818227797 -0.21888208888077543 -0.021901276444121223 0.37442592809711633 -0.12609108398229302 0.50971847516332425;-0.03854521653714571 2.8805791777327916 -1.120712464399324 0.48908409339404857 0.14739644945722646 0.18675944686230322 0.10970711213475329 -0.21281254002292632 -0.22826638210366235 0.4680030200016585 -0.021626355551846069 0.28194961845482103;-0.73827517540620069 -0.28987559917185579 0.30377553465597174 -0.43277355846739013 -0.47563794867727932 -0.17197820268353559 0.045567516163545561 0.23583071678834169 -0.027748588589988188 0.099457436015587833 0.26868830501960689 0.13585458597740799;0.21764620768124324 6.2105357542908104 1.0632246250080699 -0.77823716057682735 0.046616950292551418 -0.35411595494374254 -0.32680411575934709 0.39950475427735416 -0.40313320979027611 -0.44787403390446268 0.51255256136051364 0.27368023138953357;2.3193774865144792 1.2197095393864863 -0.84027506535271268 -0.97861464150737121 -1.9245832713095679 0.3893576234801252 0.62103340370507987 -0.63441091289349205 0.16804088348517085 -0.66665761873017837 -1.1293323576520673 2.8054632386871954;0.026159033091437661 -0.85807971103963154 -0.31484500850663127 -1.0061518370904501 1.017064516146571 -0.47828295273569632 0.93101317003741813 0.44262847540743977 0.15549497532513465 1.6085498328216656 0.90982733224628365 0.60757625974044216;-1.2207821603799449 0.10517793886865529 -1.3994413820395644 0.31141890505627789 0.33509614483047079 0.94064905510334984 0.36319414408030265 0.13437102578265692 -0.92141102087388971 0.53687035165774055 -0.18948818884315952 0.54678295955435052;0.28441099920889618 -1.4284325483252991 -1.9512914488574491 0.3773627276983319 0.16924709122539955 0.051401572015629088 0.016749459968598484 -0.23412770601054525 -0.34396818375735877 0.85758276205949524 0.49954895631507146 1.1457728426589919];

% Layer 2
b2 = [-1.4382363165039178;-1.6784598905527748;-0.27051766504463487;0.4099148295640121;0.76016333329975216;0.61441209142324993;-0.66535857658096154;-0.47894351911909849;0.32060126176082515;1.0687783080480637;-1.5305447363622617;-1.2872533083328486;2.4264701991410802];
LW2_1 = [0.61586472598861397 -0.23787982740126104 -0.32994936635424132 -0.48862195142654297 0.072694808958828461 -0.65791575952962034 0.48815788806381788 0.53105763426672714 0.74937313232586245 1.0864649579822796 -0.42188243558513661 1.1439127268788971 -0.70812968633843576;-0.032728067706672817 3.3908419655687165 -2.3582781708047302 -0.11406394491114399 2.0974597064991927 -1.129510659918106 0.99712349908561992 -2.7783388566454379 -1.5461254570344232 0.52148331645881707 0.73187302947945088 -0.4983737401394252 2.5521934645477176;-0.78340555687904112 0.38831508858844316 -1.7416986321883241 -0.95606915149161187 -1.0054975399088024 0.99649682526986205 1.3354586367483541 0.84898426786456838 -0.32953886230727719 1.3978678572172172 -0.56374152904905528 -0.54056682943326506 0.36965706806161119;-0.7574740894208627 0.31006370943196943 0.44841420365963014 -0.25001577668956387 -0.44763542357706676 -1.3356907192748242 1.6012164753027562 1.17516469463537 -0.78625670095462108 0.06407764926307731 0.81634435387556115 -0.09483304190811262 0.7871853281507516;-0.69509876798575621 0.88814271253193511 -1.8107862396804728 -1.1864753996019943 -1.5000496427728729 1.3620903716823016 1.0380781606342442 1.3109537624807415 -0.52103769117106891 0.82003828621541242 -1.0891210008307732 0.13878842920844767 0.88538409548859121;-0.18822717935549371 -0.39100856381349741 0.32473784065526601 -0.18789089372418205 0.54422116798149189 0.77954452313692557 -0.18139164000580246 -0.37603206708421222 0.71667608175103126 0.69461076561256452 -0.11168501219443598 -1.0026165308227197 -0.041132480170917335;0.66673057282249637 1.5822390964559732 0.25471016961322124 0.22486904033525967 0.24757316354577241 -0.57297286124399815 -1.237342466454646 -0.35495140814763654 0.84325888348145095 -0.31328047786392199 1.0962344542038487 0.99706723958727039 0.10128204137054692;-1.608600014433426 0.22207598530398001 1.3269343300262288 0.93030160494657388 0.22947566356201743 -0.40195277434449977 0.2100375445388003 0.41072027847977255 -1.4444730692605448 -1.6665908776890501 0.7436050458414587 -0.2733363178779582 0.60830738955800456;-0.16939432262311416 -0.050715475412849792 0.92590491157116794 0.072544743226599873 0.91020753620467076 0.24926000178367139 0.38280040799671411 1.0845513049981121 0.49194538384469927 -0.58581739655542986 0.17860298843514932 0.098527865259875058 -0.1059372685278685;0.73334757132590545 3.0170614314021638 0.31164481224257645 -0.07197167351193505 0.038344568297164795 -0.77697775615568565 -0.7253745396685416 0.59685624565224049 0.65571878496017266 0.8386429010553218 -1.2270601841310984 -0.22130407055981965 -0.10079749585731884;-0.48367174834776461 0.38511718769779252 0.092465461986708256 0.17541496053595154 -0.52892151092754858 0.11846656869393599 -0.57511521019301326 -0.11203584565447088 0.67179416933151315 0.48872243223323764 -0.21829190667580431 -0.079860886518390184 0.0618091289769424;-0.34288115183838008 -0.26843117862102062 -2.6409729131067059 -1.3121493402207358 -0.63492813777053325 0.63154343810823477 -0.9632013125601957 0.91328507158052097 -0.87717923642013562 0.70393645256607396 0.40800653056234715 -0.30941699068656553 0.031293296806616577;-0.0039936818449677197 2.3581881806334049 -0.32100303815539333 1.5266101485486463 -0.49968942627112201 -1.2369226019122892 -0.49621341753267817 -1.1191973550973418 -0.1987878629236004 0.28799176991145464 -0.30039049654473632 -1.4453168300504839 0.14004665050300297];

% Layer 3
b3 = 1.1851793829603097;
LW3_2 = [0.97869145954990566 3.3213606396796274 -2.4873651581711149 -0.52144840150634075 1.3069927239649339 2.1092675579171201 -1.8057300731412502 0.43153348402606034 -0.16479721957673055 -1.2444878673723021 1.4004231391139281 0.7612476474588793 0.68724823968544824];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 4.04040404040404;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
