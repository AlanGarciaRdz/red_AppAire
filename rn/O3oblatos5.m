function [Y,Xf,Af] = O3oblatos5(X,~,~)
%O3OBLATOS5 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-May-2016 13:05:44.
% 
% [Y] = O3oblatos5(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [1;1;0;0;0;0];
  x1_step1_gain = [0.0869565217391304;0.0384615384615385;0.100381449508131;117.647058823529;0.0560224089635854;13.1578947368421];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.8731165690588421;-0.073871162375947652;-4.2162182035481468;-3.0300077384083148;0.77270743507314277;5.7118249740669143;-0.23615535421128867;-0.38546131587443044;0.28012916390056852;-0.25351181621865826;-0.98101632205006739;3.4655088340277591;-0.010152949919536577;4.8910542652853568;0.75432636722550972];
  IW1_1 = [0.50847480063349393 1.5304252720580562 -0.68649401244298469 -1.3296319101942355 -0.7842524255695561 -0.35928696490659906;2.9012441116228525 -0.27811077486549723 0.46360277953061474 -0.055353196264510317 0.78411011081111948 -0.42259331789891386;0.87421811984593811 -5.1937955403762848 1.7446779492010711 -0.076811721158662055 -1.6520282486072095 -0.69253797606066836;-1.5075337762683778 6.7321007653915101 0.38653569329361553 0.044749605620515234 1.6639902901348815 0.90253181688691386;2.3614519175755055 1.3214318383085653 -2.0087877601864204 0.13369101409933651 0.12131261803544671 1.0360732259889942;-1.1503103716798835 -0.12527587653156438 0.232963451079364 -0.060451965788947307 0.058199693934666764 6.0664208239009119;-1.2547660859953635 -1.8104702938485226 1.0354988517827544 -0.085531280767433188 0.50118947973199524 0.067743695582623928;0.67239010816506573 0.057462493414969597 -0.91195151663501239 0.2457384359624524 0.027796098434488117 -0.28992973310934705;2.0637097929610806 0.22646340105170068 0.11297877533566079 0.11870257943597336 -0.25903718844692852 0.069719891505283169;-1.884115183840789 0.20411017122940586 0.58216307061719075 -0.069892619187878216 0.13905239281605164 -0.18603636449612015;-1.747345555615071 -2.1080257807909821 -0.69555649929492347 0.064096514229429413 0.44019010622293808 -0.59721725982361828;-0.14305385919491873 -0.32390963390522359 3.1021151239396536 -0.83662454368726691 0.27127735886255822 1.7033104557698611;0.45787467357627393 -0.36415381347347847 -0.21041182103016856 0.10048869132385677 0.14966940317972513 -0.75640558177646022;1.4454202472952156 -3.1581858135743124 -0.75630905184443287 1.1977148037157759 1.5549969156990868 2.2125525310004628;2.9914797522524177 3.0114045483545269 2.2226375261234126 -0.061848846537046719 -0.76093027566472682 -3.3875655779582416];
  
  % Layer 2
  b2 = [3.6329366716080855;-1.6623899482094719;-0.70097375165373865;0.45117223563239672;1.3937530823785322;-2.3976324287848745;-1.4811320994334185;-0.87775586339478529;1.96946405077068;0.34487808885671667;0.6438794229137037;-1.2700032921297471;-1.1791125191282559;2.0330601582681749;1.6114645465114144];
  LW2_1 = [0.89991845004383331 0.21408352355878804 0.2182786335083558 0.40052792145532934 1.8717645225566646 10.383099828492718 0.071740773756954743 -0.15939148802310601 3.6027168156989631 -1.819986035723163 0.065196947337855179 -0.060093861498232752 0.55775977558270085 0.06547995489691294 -0.21391359582574984;-0.17213020020730313 -1.1190007550610772 -0.62886354819403023 -0.67053100126401688 -0.77590767052275256 0.0070563180665072986 1.5211051117292074 1.2525367080142169 -0.74479987895460276 -1.2131775618403304 -0.61638187612407991 -0.062473250503724528 -0.38076705611672901 -1.1696042958152162 1.107995171690725;-0.24788825109236445 -0.30936401847245076 0.11621766618372779 0.21458623166167415 -0.44577706491812352 0.67466789509494851 -0.15778469137097906 -0.29659065205573804 -0.51604496690375656 -0.97145104839579621 -0.42943854593979736 -0.38790710249756027 0.34290711268953583 0.32023299898799329 0.11229944180599578;-2.0078366009884543 1.1209446907499518 -0.20401458331764882 -0.67839443240646025 -0.47655047765176112 0.47333710041306443 0.10757436210967658 -1.8962606729271505 0.48649431687292893 0.12819749389392238 0.099691457746601944 -0.41659558344554187 -0.39042959582548742 0.43109424271542846 0.25489956053212964;2.3007289175422589 1.1021926528992658 0.5059292354728282 0.23465485227143018 0.56902546537973753 -0.028199255701407702 2.042951126098056 0.13962984323625782 0.63250575380847895 1.5598736441209382 0.035081657261190884 0.40670360101131453 -1.013210395113094 0.9632066306207524 0.35092221510793475;0.44709182378801837 -0.27329269831138503 0.014683579934770105 0.68802851154501721 0.036814157616734122 0.19018137819049327 -0.55395800413463647 0.12433579381696847 -1.3628523796881484 0.23956370104193481 0.42825098417273694 -0.086323389821126209 1.8609867567155023 0.18517995786910363 -0.71837448988495312;-0.52875569121340826 0.27874371867341474 -0.45010171496073281 0.28845952765180999 -0.54688709121240098 -0.4040478961114638 -0.39355465614116208 1.5329776559845896 -0.47923119392154651 1.111003105448535 0.18448183790114284 0.52221103194836638 0.94955532847650248 0.15366824771509055 -0.48560292698527546;-1.2676513493180281 -0.90219170917017055 0.18830375379067263 0.18463597350149083 -0.8984587641694447 0.45592428047396655 -2.0424344033560509 -0.18014305208515047 -0.89104978694488668 -2.5753576651921621 -0.058422905030838079 -0.10366185883981623 -0.75535405717283899 0.24936149918200781 0.37666359584077702;2.1309105567344777 0.11943121221004577 -0.82035322396385779 -1.1465594833379109 -0.39987204899700857 0.41600173029300602 -0.58499396565451589 -0.87878255773449354 -2.1309593259476256 0.32568383156131053 -0.1447155858996485 -2.935023755322026 0.32885851440211095 1.9212690083204524 -3.4539933604130959;-0.44408646292143211 0.09616369849044866 -1.0604598429121064 0.46629384727529827 -0.18948185412115234 -0.33999300109674391 1.0437094789434527 1.5639593127211961 -3.2576000305845483 -1.1740615024012431 -1.5327022604989382 0.81766339562637913 -1.3205512152659895 -0.047912627842222139 -0.29792972035704224;1.2891950244272967 -0.49797758996744346 1.0954000233914927 -1.3488825210409328 0.85480997945526838 0.16473564093746751 0.5329608748841087 -1.171346216040509 -0.44396194274529821 2.1266930001101256 -3.4647800566573554 -0.93651012747562445 -1.641923556858635 -0.79076408960042543 0.30743532054320533;-0.31715110589480056 -0.57901232841776362 -0.18298891487054503 0.34142856856626697 -0.45128164622615724 0.56472942359290601 0.90347569808731343 -1.170521668206328 0.55395219988990307 -0.37766250648931743 0.050946585240781828 -0.41166659563830815 -1.1195559356745761 -0.23053570730304079 -0.045731681566304652;-0.21387294490453224 -0.029325354890524274 -0.7763956655869706 0.16403336856790968 0.36229463032453618 -0.2606259195663716 -0.21204931210628808 1.7699663510725974 1.0301704846999316 -1.3444777663162568 2.8004108764380815 0.72748018864566355 -0.60449720954944242 -0.16677304977564178 0.27973449115108101;-0.020802059143816998 2.0323618785273556 -0.036626615441987621 0.047717602517337719 1.6620913670399524 0.39104170847362152 -0.58968780047501734 1.5161493998615101 -0.0054005637661534295 2.5968883999616743 0.19172563615504926 0.19189479964760975 0.50582681215186542 0.085545223686585917 -0.68931551546331626;0.048375751237949967 2.7434451197489818 -0.14602902484608041 0.9383723973780731 -1.4487955051084429 -0.10602497711137708 0.90115201300730297 1.971420758728146 -3.0247901926092684 -1.7676323612279521 -0.87229592510235321 -1.6175178816814051 1.0538106490467243 -0.99341902975339469 -1.486534388274211];
  
  % Layer 3
  b3 = -0.70785797837502118;
  LW3_2 = [3.0032045688091307 -1.6985511511492823 1.8071990278976839 -1.3117161987439006 -2.2384913314744339 -1.0141795076727806 1.6354486350040984 -1.4537822245437781 0.17968797797579045 0.4285110580826032 0.54268637373792183 1.651928790150506 0.99090004657192154 -1.4168514216196566 -0.26370239340396157];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 13.1578947368421;
  y1_step1_xoffset = 0;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end
