function [Y,Xf,Af] = COAguilas10(X,~,~)
%COAGUILAS10 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 20-May-2016 13:56:19.
% 
% [Y] = COAguilas10(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1;1;0;0;0;0;0;0;0;0;0;0];
x1_step1_gain = [0.0384615384615385;0.0869565217391304;0.448430493273543;5.42005420054201;0.00666000666000666;0.02;35.0877192982456;0.0561797752808989;0.00588581518540318;0.125;0.281968137600451;0.304971027752364];
x1_step1_ymin = -1;

% Layer 1
b1 = [-3.0235671407869038;-4.6081789146180734;-2.2954989568760542;-0.32922247966529183;-0.44279526002405639;0.90072843701472805;1.1934378084210826;-1.1247714938846383;-0.10562535660384137;12.018475418945437];
IW1_1 = [0.63867024201250489 -0.96504675313027743 0.68546941467480615 -1.5309880326917309 -0.2203034995747894 0.71127688565291092 0.031403296546810316 0.89763010778376762 -0.057702077081265173 0.28217411137416709 -0.241673996729041 0.14503643876942005;5.1743102960657312 -0.83211413993072958 -0.56425927996508629 1.6224767452771283 -0.11362209806756743 -0.47982399137748288 0.70008029616137846 -2.796679785192147 0.81374013650195187 -1.5110711901116931 0.71010152647078895 0.31644771140364125;-0.082177414918337854 2.4725823385182517 0.20785291980373397 -0.40321446945676193 -0.058494081563366822 0.50183225085691185 0.23901806987365642 -0.27745638277031381 -0.13353944564068812 0.47373978360929708 -0.60072751855199891 0.37388656784107388;-0.14414560147567951 -0.23906684008981494 -1.0116551063583195 0.22270207725614422 0.4152444952133616 0.010777032144709743 -0.18435028808386034 1.771794149314402 0.10724942648933607 -0.68353622245028489 0.38646990169857282 0.093583510603352973;-0.93067775081853577 -0.43886681894842966 -0.24050100413769143 1.1462862841800576 -0.0051676101764766402 -0.70375400724402271 -0.52362895467126602 -0.096554265588947447 -0.11810662864448161 0.077063698021106727 0.72845119719619322 -0.48155584121918021;-0.63707528579907069 0.45484904360157186 -0.14884200792494895 0.07344391328858528 0.074825685926801222 -0.25573832226136245 0.29098639762954887 -0.094865455843712324 -0.027806283907489744 -0.17213988001304051 0.12449619832328652 0.0046425852440029848;-0.056638130060479241 1.2610202443198282 -0.38378466919024634 0.32884889035595721 0.31924197501611801 -0.29490036642077894 -0.10873116311747057 0.18426067556936102 0.07122873302401464 -0.34026809636180233 0.36035349017424828 -0.07952800405330164;-1.376018702475829 -0.43219699254493543 -0.21151336744569887 0.78044780188358032 0.13234341097079608 -0.2675057257665826 -0.73955874655253306 0.59016860644917501 -0.40183750896245979 0.28122936958571693 0.3879051724415416 -0.17679909830832563;-0.40994198337780935 0.053951749316319436 -0.042302293310989551 0.14595451432847636 -0.04551377875227279 -0.065571029838719111 0.19484073232663032 -0.15118291142995599 -0.058893821378212433 0.061689668722988172 -0.028377494729228889 0.016937776488504443;0.33771704633032967 -0.52602434075163251 9.2437199852398972 2.5677521940057462 1.7499206163713663 -0.15213674687963591 -0.31929103827357191 0.035982983909805311 0.45990370956433707 0.24033154761071174 -1.5642019415085222 -0.14379286460921639];

% Layer 2
b2 = [0.066928959368189878;-2.0318200377510447;-11.582629924091952;8.213440447655854;-2.0495785048535029;3.0677140482823142;-4.4924922267510681;-1.9567447720431081;4.3159025005862199;0.94480330026965109];
LW2_1 = [-3.6166323158467177 2.442326901782959 -4.6664192511454452 -5.232850291777086 -7.1895139823517944 -1.3163539491987062 3.7726833353246714 8.1888191934238694 -15.288897084387878 -1.4012785957183655;0.22873832506776365 1.1653706745480397 4.6196966947826601 1.7997324860845092 1.6639099319192534 -2.3259417570165639 1.5570216008496944 -3.1765623777272105 -0.64079563130944395 4.0121590281267974;0.54891679063277865 1.3620300339548201 -0.99403853846886991 -0.13478072111282569 0.0042847316073860477 1.8942860477026355 -0.93863263195819491 -1.9073070715873346 -4.2955461632174581 6.1907192627370833;5.5967566019102915 0.66751677110608321 0.72215703367145379 0.69485896393867153 1.8306470726960684 -1.237579412238599 0.62380610964838179 -2.0475261008147272 -0.42290775871374015 -0.62484717919752097;1.2803067484894719 0.95226248705251004 0.29538647512625726 1.2880481567672875 -0.67889128118358322 4.4721746324510301 -1.8936539413633926 0.24031331581181806 5.9757332424497394 2.113996285855789;-0.31561631291395575 -1.1041602659668173 -1.9050444756728324 -0.11847351760521099 -0.26952237099994736 -2.6159257453403977 1.7563884267069563 -0.15799881269222554 4.2344992906247789 -3.189488055143781;1.6166320244897843 0.15200340341895247 -2.0898926942307736 -0.82494737520267747 -1.3121300388157888 0.16557849317437853 1.4151339463885841 1.4349412294752684 -0.399504708585458 1.3748490279925625;4.8077329187873019 1.0118368496974204 1.5924288533081132 0.28107867486184468 -1.5715872771305535 1.0832876181485638 2.4628825000122023 0.35653131880146982 -1.1957735216311387 2.9937764583104083;6.4639935397402901 3.3141229238571452 0.14592825963649875 -0.1168483479728665 -2.2816888900904164 -5.9577095205664063 6.8087120272097872 2.8024295101375354 5.3325406957867614 3.8340591577749641;-3.6238732037309247 0.0052102248813193849 0.38493890563270328 -2.1850968024807478 0.54420457891835916 -1.5826842290613792 1.2048610231685057 0.18935283899399544 -9.0100601088931516 -3.6048846973826514];

% Layer 3
b3 = 4.6207062576201849;
LW3_2 = [-0.35460121579043635 0.22572600538581933 -1.5795239124051623 0.45724658507367261 0.88682422926241 -1.814512417357302 6.9402530522876296 -1.7890019657164533 -0.24337173950993979 0.55065799302153973];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 0.448430493273543;
y1_step1_xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
